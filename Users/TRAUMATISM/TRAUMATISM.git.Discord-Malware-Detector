======================: FILES :======================
======================: README CONTENT :======================
# Discord Malware Detector ðŸš™
### _make discord skidz angry_

DMD is a program that reads the content of a given file and looks for common things that are found in token stealers.

![](./imgs/1.png)

## Features

- decodes base64 strings
- looks for malicious regexps
- looks for suspicious words
- looks for webhooks URL
- looks for pastebin.com links

## Create your own grabber

Grabbers are stored in /grabbers/.
To create your own, just create a file (ex: my_grabber.py).
Then just copy this template:
```python
import re
from typing import List, Tuple

from core.abc import Grabber

class My_Grabber(Grabber):
    def __init__(self, content: str) -> None:
        super().__init__(content)

    def analyse(self) -> Tuple[str, bool]:
        self.regex = re.compile(
            r'()', # your regular expression here, do not forget the ( ) 
            re.IGNORECASE
        )

        return (
            'Grabber name', 
            self._analyse(self.regex) # self._alalys() is a bool value, so you can use other ways (checksums, 'string' if self.content etc.)
        )
```

for sure in `main.py` you need to import your matcher with `from grabbers.my_grabber import MyGrabber` then add it to the matchers list:
```
grabbers = (
    ...,
    MyGrabber
)
```

## Create your own matcher

Matchers are stored in /matchers/.
To create your own, just create a file (ex: my_matcher.py).
Then just copy this template:
```python
import re
from typing import List, Tuple

from core.abc import Matcher

class MyMatcher(Matcher):
    def __init__(self, content: str) -> None:
        super().__init__(content)

    def find(self) -> List[Tuple[int, str, str]]:
        self.regex = re.compile(
            r'()', # your regular expression here, do not forget the ( ) 
            re.IGNORECASE
        )
        
        return self._find(
            regex=self.regex,
            type='' # result type (ex: discord webhook?, suspect word? etc, can be whatever you want)
        )
```

for sure in `main.py` you need to import your matcher with `from modules.my_module import MyMatcher` then add it to the matchers list:
```
matchers = (
    ...,
    MyMatcher
)
```

 ## s/o to...
 - [Vichy](https://github.com/Its-Vichy) for the idea
 - [sql](https://github.com/sql69) for the new webhook regex.
====================== GIT HISTORY: ======================
6283919 HEAD@{0}: clone: from https://github.com/Traumatism/Discord-Malware-Detector
commit 62839198bb2ac8cb56a58dd68a1a325e52755d39
Merge: c584469 c354c5e
Author: toast <58362380+traumatism@users.noreply.github.com>
Date:   Sat Nov 20 22:37:06 2021 +0100

    Merge pull request #7 from IlluminatiFish/main
    
    better webhook regex

commit c354c5eef92c42d48d86e472cf685ebdd01eb003
Author: IlluminatiFish <45714340+IlluminatiFish@users.noreply.github.com>
Date:   Sat Nov 20 20:15:48 2021 +0000

    better webhook regex
    
    better webhook regex

commit c5844690e8cedb5bdafe7db1115312e75bea79a8
Merge: c8878af d7f613c
Author: toast <58362380+traumatism@users.noreply.github.com>
Date:   Tue Oct 5 06:22:41 2021 +0200

    Merge pull request #4 from IlluminatiFish/main
    
    Fixed spelling mistakes and fixed my regex edit

commit d7f613ca714a1fb322320a60b44747f668825e86
Author: IlluminatiFish <45714340+IlluminatiFish@users.noreply.github.com>
Date:   Mon Oct 4 23:31:33 2021 +0100

    Woops wrong quantifier
    
    Woops wrong quantifier

commit 4496b50a005314e45ecd3c3c3b11a01799e04e1b
Author: IlluminatiFish <45714340+IlluminatiFish@users.noreply.github.com>
Date:   Mon Oct 4 23:22:07 2021 +0100

    Update README.md
    
    Fixed spelling mistakes in the README

commit fedac1dc2df91e5e9eb7127fe1f1ec53026cbf35
Merge: 7132ab0 c8878af
Author: IlluminatiFish <45714340+IlluminatiFish@users.noreply.github.com>
Date:   Mon Oct 4 22:37:29 2021 +0100

    Merge branch 'traumatism:main' into main

commit 7132ab09e5e24d27e2fb33d70a1369b5d8a9ebf8
Author: IlluminatiFish <45714340+IlluminatiFish@users.noreply.github.com>
Date:   Mon Oct 4 22:36:01 2021 +0100

    Update grabber.py
    
    Update spelling of function name

commit d051a47a9388d39e7a626bf78d6d4189a00c9880
Author: IlluminatiFish <45714340+IlluminatiFish@users.noreply.github.com>
Date:   Mon Oct 4 22:35:35 2021 +0100

    Update wodx.py
    
    Update spelling of function name

commit 1b210d3e098628e413558760bdc611013e7ac5a2
Author: IlluminatiFish <45714340+IlluminatiFish@users.noreply.github.com>
Date:   Mon Oct 4 22:34:46 2021 +0100

    Update wodx2.py
    
    Update spelling of function name

commit 38f01c7770c5ac87f937515668c6b624bd392e89
Author: IlluminatiFish <45714340+IlluminatiFish@users.noreply.github.com>
Date:   Mon Oct 4 22:34:25 2021 +0100

    Update fgrabber.py
    
    Update spelling of function name

commit 1d1f6482e0de4134d1b4cf25370911540cfce7aa
Author: IlluminatiFish <45714340+IlluminatiFish@users.noreply.github.com>
Date:   Mon Oct 4 22:34:05 2021 +0100

    Update discordhaxx.py
    
    Update spelling of function name

commit 000df2e13ead0ec6f69460c5eb34d4bf88f8b07a
Author: IlluminatiFish <45714340+IlluminatiFish@users.noreply.github.com>
Date:   Mon Oct 4 22:32:26 2021 +0100

    Update main.py
    
    Update name of function to proper spelling

commit c8878af9f92d2355ea258e7ccc2d89deaebaaddf
Merge: 0dfc10f d7b642d
Author: toast <58362380+traumatism@users.noreply.github.com>
Date:   Mon Oct 4 18:04:29 2021 +0200

    Merge pull request #2 from IlluminatiFish/patch-1
    
    Update webhook regex

commit d7b642d30957c6447a61792bf787209d005bca12
Author: IlluminatiFish <45714340+IlluminatiFish@users.noreply.github.com>
Date:   Mon Oct 4 16:23:46 2021 +0100

    Update webhook.py
    
    updated webhook regex to include cases where the webhook has the api version in the url

commit 0dfc10f730d1e04f06fde357eb1abad71e919546
Merge: 3e1ba0e 7caf017
Author: dps <58362380+traumatism@users.noreply.github.com>
Date:   Mon Jul 26 10:01:08 2021 +0200

    Merge branch 'main' of https://github.com/traumatism/discord-malware-detector into main

commit 3e1ba0e22c0c19f91d2d0480bad7d6303aa828e2
Author: dps <58362380+traumatism@users.noreply.github.com>
Date:   Mon Jul 26 10:01:01 2021 +0200

    .

commit 7caf017d864458f5aa817ca621f3964e1c6a2ec9
Author: toast <58362380+traumatism@users.noreply.github.com>
Date:   Sun Jul 25 10:12:29 2021 +0200

    Update README.md

commit 596a74703c68397c21686807d0640f14e3d5bf97
Author: toast <58362380+traumatism@users.noreply.github.com>
Date:   Sun Jul 25 10:11:58 2021 +0200

    Update README.md

commit 2a6a22044cd10e89cec0f97c772c2ca3e30d00cf
Merge: 60abcc2 ae9d2e0
Author: toast <58362380+traumatism@users.noreply.github.com>
Date:   Sun Jul 25 09:47:48 2021 +0200

    Merge pull request #1 from sql69/patch-1
    
    better webhook regex

commit ae9d2e070035253e7af30ceccfb263ac0470e2d2
Author: sql <68092911+sql69@users.noreply.github.com>
Date:   Sun Jul 25 03:54:09 2021 +0200

    better webhook regex
    
    ```
    (https?:\/\/(ptb\.|canary\.)?discord(app)?\.com\/api\/webhooks\/\d{18}\/[\w\-]{68})
    ```

commit 60abcc281ea1fb9cb2159d7ac13fb7e086908970
Author: dps <58362380+traumatism@users.noreply.github.com>
Date:   Thu Jul 8 13:47:20 2021 +0200

    .

commit 9b32f0bd240be0b1d2835b0e7ff9e66c39b4647b
Author: dps <58362380+traumatism@users.noreply.github.com>
Date:   Thu Jul 8 13:14:25 2021 +0200

    .

commit 46edd24329b80a06d9898a575e85ebff7e8a721e
Author: dps <58362380+traumatism@users.noreply.github.com>
Date:   Thu Jul 8 11:32:42 2021 +0200

    .

commit 37a3e3683e4dcebae7b94bd9c32b33d0860d34f1
Author: dps <58362380+traumatism@users.noreply.github.com>
Date:   Fri Jun 25 19:53:51 2021 +0200

    .

commit c63292303d7233da21f2873682c716094a6f8d03
Author: dps <58362380+traumatism@users.noreply.github.com>
Date:   Fri Jun 25 07:04:46 2021 +0200

    new things

commit 8a5248b52a2c51f9ff45fcaeca8bf142f12d803b
Author: tst <itstoastztoast@gmail.com>
Date:   Thu Jun 24 15:37:27 2021 +0200

    Update README.md

commit 01807d18ce0e47341fa07f1cf5cf1c7cee9e8a11
Author: tst <itstoastztoast@gmail.com>
Date:   Thu Jun 24 15:36:30 2021 +0200

    Update README.md

commit ea1a960a7172f09fe70030aba2a73b272a467a71
Author: tst <itstoastztoast@gmail.com>
Date:   Thu Jun 24 15:33:58 2021 +0200

    updated readme

commit 936d1df2380d9349f94c3cfb59f10c108090d169
Author: tst <itstoastztoast@gmail.com>
Date:   Thu Jun 24 15:22:36 2021 +0200

    added somes grabbers

commit d8520069355c3b0b9c5b21f67bb88d822a0e7d58
Author: tst <itstoastztoast@gmail.com>
Date:   Thu Jun 24 14:33:02 2021 +0200

    banner update

commit 9f2120ed027a6d035f245ee79225405d66474839
Author: tst <itstoastztoast@gmail.com>
Date:   Thu Jun 24 13:32:55 2021 +0200

    somes shits

commit 6c9def903d0669153f883b6a3d17d0f50e7d4931
Author: tst <itstoastztoast@gmail.com>
Date:   Thu Jun 24 13:06:48 2021 +0200

    added custom grabbers support

commit 7caa5948133c8e8ede39a7672e916e1844a507d8
Author: tst <itstoastztoast@gmail.com>
Date:   Thu Jun 24 07:11:22 2021 +0200

    Create README.md

commit 07f249b4f93e5190ae7f7d87cbc7f55b57180915
Author: tst <itstoastztoast@gmail.com>
Date:   Thu Jun 24 06:54:35 2021 +0200

    .

commit 9805babd9d3daafe78381ad15f46166c6fc14034
Author: tst <itstoastztoast@gmail.com>
Date:   Thu Jun 24 06:22:45 2021 +0200

    abstract class recode

commit a2c864c572ea333673db75d312816628a0a072f4
Author: tst <itstoastztoast@gmail.com>
Date:   Wed Jun 23 19:05:02 2021 +0200

    now the table expand to the whole terminal

commit c745b0678efbe9fe4567e19f131d1252beb09864
Author: tst <itstoastztoast@gmail.com>
Date:   Wed Jun 23 19:02:14 2021 +0200

    removed a test

commit 252926905738316efb9f678d30308b0f4f33fa61
Author: tst <itstoastztoast@gmail.com>
Date:   Wed Jun 23 19:00:24 2021 +0200

    added quite thingz

commit fab403f79b4cb6c3beec45fab01d22568e35d962
Author: tst <itstoastztoast@gmail.com>
Date:   Wed Jun 23 18:28:27 2021 +0200

    removed useless re.Ignorecase

commit 4e1b693f6c03dfd96989ea5a727cb637f1cb0fe0
Author: tst <itstoastztoast@gmail.com>
Date:   Wed Jun 23 18:23:31 2021 +0200

    added "Local Storage"

commit 9703f67aba995ea568748dbdcbbb6223a43151b7
Author: tst <itstoastztoast@gmail.com>
Date:   Wed Jun 23 18:22:58 2021 +0200

    moved .core.matchers to .matchers

commit b265b242210ee690fd07181dcdfa504d0526131b
Author: tst <itstoastztoast@gmail.com>
Date:   Wed Jun 23 18:18:56 2021 +0200

    .

commit cc05e1ffe7c315966fa6fddb0b2e6c53ed67c02b
Author: tst <itstoastztoast@gmail.com>
Date:   Wed Jun 23 18:17:00 2021 +0200

commit 40e723966ac76e95f1edc83db3849bc38be6a10a
Author: tst <itstoastztoast@gmail.com>
Date:   Wed Jun 23 18:05:40 2021 +0200

    Update main.py

commit 95ba59a004900ee97e9ed9be927a98be9d41c950
Author: dps <dropsql@protonmail.com>
Date:   Wed Jun 23 18:03:33 2021 +0200

    ðŸ˜³

commit 0ce6ab1650f4a067d7250fad2023cd703b9fc765
Author: dps <dropsql@protonmail.com>
Date:   Wed Jun 23 13:06:10 2021 +0200

    Initial commit
