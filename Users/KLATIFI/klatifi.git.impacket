======================: FILES :======================
======================: BRANCHES :======================
======================: LOGINFO :======================
commit 03c5bc63bc8bf98cff84770f1231a0922fcbebab
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 25 09:35:09 2017 -0300

    Giving some hints when target is enforcing SPN validation

commit f0b5b8f6174ba9cfebef66d1bdaab8a776773c61
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 24 16:10:29 2017 -0300

    Be more flexible about the target SPN to use
    
    * When connecting to target systems
    * Also, don't give up if the SMBConnection didn't work, we might be still lucky at the DRSUAPI layer

commit 6a49832e2b8fad4e5238b7d35bc8eb057e31eef8
Author: martin_uy <m@rtin.uy>
Date:   Mon Jan 23 18:56:32 2017 -0300

    In the context of #69:
     * Import missing

commit 37e40a732e5592b43f5678ef8e8bed7ffff66e81
Author: martin_uy <m@rtin.uy>
Date:   Mon Jan 23 18:53:32 2017 -0300

    In the context of Issue #69:
     * IPv6 interface aligned to IPv4 interface.

commit f2d6f634d20cab10db9635e95f2398ba3e65943f
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 20 12:32:03 2017 -0300

    Retrieve the username based on the specific TGT/TGS retrieved from ccache
    
    * In the case where there is more than a single ticket, there could be different client names. Especially if there are tickets with delegation
    * Improved debug info to identify mismatches in the future

commit 4f5154ab2602cf5e9d5da993324def1cd78538d2
Author: asolino <bethus@gmail.com>
Date:   Sun Jan 15 17:03:34 2017 -0300

    Include 'KRB5 - Kerberos 5' OID inside the GSSAPI MechToken
    
    * We were just including the mechTypes, but looks like it is also needed inside the MechToken
    * Windows doesn't care about it, but Samba / NetApp servers do.
    * Should address https://github.com/CoreSecurity/impacket/issues/247

commit fb280b1213b505b5dba4ce6f9099be28cfe489ad
Merge: 1a12a2d a86c480
Author: martin_uy <m@rtin.uy>
Date:   Thu Jan 12 14:24:01 2017 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit 1a12a2d88f3f63c39c765c9fa6373818c50cda00
Author: martin_uy <m@rtin.uy>
Date:   Thu Jan 12 14:23:43 2017 -0300

    In the context of merging pull request #92, we removed the code on UDP decoder that does DHCP decoding based on port numbers. Even though it's a valid heuristic to determine the layer following UDP based on port numbers -and it's going to work in most of the cases, as DHCP services usually run on a well known port that it's not used for any other protocols-, we still want to handle the cases in which those well known ports are used for a different protocol. In this later case, the decoder has to be DataDecoder instead of DHCP Decoder. As a result, is up to the ImpactDecoder client to decide which decoder has to be used for the layers following UDP or TCP, as there is not an unambiguous way of determining that.

commit e978eca9e2b3d455ca73b8291772746e5fa41075
Merge: 0ff281f 9879f1b
Author: martin_uy <m@rtin.uy>
Date:   Thu Jan 12 14:12:43 2017 -0300

    Merge branch 'c0d3z3r0-feature/dhcp'

commit 9879f1b676e0620b4a1b2e95e71e64d29f8290cc
Merge: 0ff281f c8aabf2
Author: martin_uy <m@rtin.uy>
Date:   Thu Jan 12 14:12:19 2017 -0300

    Merge branch 'feature/dhcp' of https://github.com/c0d3z3r0/impacket into c0d3z3r0-feature/dhcp

commit a86c480d64f84ca2b6944068f82119a39e5f049d
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 11 13:24:14 2017 -0300

    Restoring commented structure items
    
    * Problem wasn't padding related (thanks god) for a definition of an EMPTY NDR structure.

commit fc65d6b475c077806493028d6ae4bdd71e321824
Merge: e5b1968 6ca48d5
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 11 12:56:13 2017 -0300

    Merge branch 'martingalloar-virtualenv-friendly'

commit 6ca48d58abafc2816696549f0b06157eda982b1c
Merge: e5b1968 4152e12
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 11 12:55:35 2017 -0300

    Merge branch 'virtualenv-friendly' of https://github.com/martingalloar/impacket into martingalloar-virtualenv-friendly

commit 4152e128b8c1e435f04eb88775c290a86ebf266d
Author: Martin Gallo <mgallo@coresecurity.com>
Date:   Wed Jan 11 12:43:54 2017 -0300

    Replaced shebang with a virtualenv friendly one
    
    Replaced all instances of `#!/usr/bin/python` with `#!/usr/bin/env python` so impacket's examples and scripts can be run inside a virtualenv without having to call python.

commit e5b1968abcf2ed8cad2eef6d38531cc38ad98baa
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 11 12:42:11 2017 -0300

    VARIANT is already a pointer
    
    * Might solve https://github.com/CoreSecurity/impacket/issues/245. Testing needed

commit ea9f61d02ee4bb742313c2b90f6fb8bb7b237266
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 10 23:15:41 2017 -0300

    Quitting MMC when executing a single command from command-line
    
    * mmc.exe was still running at the target server

commit f4596a1b03e28eac4006288d07fd7c0662c29acf
Merge: a0f5bd2 0ff281f
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 10 21:24:23 2017 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit a0f5bd265df61d1ba89901f93435eeb71242f045
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 10 21:23:22 2017 -0300

    Adding mmcexec.py example
    
    A similar approach to wmiexec but executing commands through MMC.
    
    Original discovery by Matt Nelson (@enigma0x3):
    https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/

commit 0ff281f00e2f563a8d5b68ef46ed375067d21fea
Author: martin_uy <m@rtin.uy>
Date:   Tue Jan 10 13:44:24 2017 -0300

    In the context of #244:
    
     * We are now cleaning up open files from the corresponding session structure in SMB3 when disconnecting from a tree.

commit aa1158726b75a74f62f76f8fde674547bd201ad6
Merge: 0ec5c1f 72b5c5c
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 9 15:28:56 2017 -0300

    Merge branch 'contactr2m-smb_com_nt_transact'

commit 72b5c5ce7894caac80539377596efb5cfdb163ed
Author: Rohit Mahamuni <contactr2m@gmail.com>
Date:   Fri Jan 6 13:05:19 2017 -0500

    Add support for SMB_COM_NT_TRANSACT and NT_TRANSACT_QUERY_SECURITY_DESC
    
    [MS-CIFS]: 2.2.4.62.1 SMB_COM_NT_TRANSACT request.
    [MS-CIFS]: 2.2.7.6.1 NT_TRANSACT_QUERY_SECURITY_DESC

commit f78c5e1731ceeafaaa9870a4b1b381e8ad1ddf20
Merge: 268a79a 4c2a5b9
Author: Rohit Mahamuni <contactr2m@gmail.com>
Date:   Fri Jan 6 11:14:50 2017 -0500

    Merge remote-tracking branch 'CoreSecurity/master'

commit 4c2a5b98e54046e3dc65ce5410c35b63f27e4a70
Author: martin_uy <m@rtin.uy>
Date:   Tue Dec 27 13:49:51 2016 -0300

    In the context of #241:
     * The VCNumber field in a SMB_COM_SESSION_SETUP_ANDX binary packet (SMB login standard) is 2 bytes long. Truncate the os.getpid value if greater than 2 bytes.

commit 0ec5c1f0269415f54ff3cacfd6c495377e16b1bd
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 27 10:57:25 2016 -0300

    Adding SMBConnection.close()
    
    * Committing patch by @martinuy
    * Logs off and closes the underlying socket.
    * Should fix https://github.com/CoreSecurity/impacket/issues/227

commit c0610ef0c23cfcadaa8c861bc79089abc4400390
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 26 09:36:07 2016 -0300

    Hexdump for LSA Secrets not printed, if callback set
    
    * Small little trick to verify callback was not set (if there's a better way let me know)
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/240

commit d910f375973d5fff048cd12be720012b6b0a7be4
Merge: 2e9c5c2 ddf172b
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Dec 12 10:24:44 2016 -0300

    Merge pull request #239 from CoreSecurity/dhcpoptions
    
    Adding 'default-url' to the dhcp options list.

commit ddf172bb13ace50794209f0603293b06bae1e127
Author: jgermano <jigermano@gmail.com>
Date:   Mon Dec 12 10:13:39 2016 -0300

    Adding 'default-url' to the dhcp options list. While not defined in any RFC, is assigned by IANA and accepted by, at least, Linux's dhclient.

commit 2e9c5c2f30b5fefb52c3db7f194ec57e7fbc31e6
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 10 15:25:55 2016 -0300

    Adding -csv switch to output format in CSV
    
    * Partially addresses https://github.com/CoreSecurity/impacket/issues/237

commit bf745b0e34124dabb5d1e7a4752160721fc2b06f
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 10 14:58:26 2016 -0300

    Adding PasswordLastSet, USER_DONT_EXPIRE_PASSWORD, USER_ACCOUNT_DISABLED and ScriptPath attributes
    
    * Partially addresses https://github.com/CoreSecurity/impacket/issues/237

commit bf0ecc6ff893c3fe8e84d0d87f9e58e7c2b806d3
Merge: 2681d1f 268a79a
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 10 12:01:47 2016 -0300

    Merge branch 'contactr2m-master'

commit 268a79a6de8c4c0913520793422e65dbd28611b3
Merge: 18e90dc 6a21c7e
Author: Mani <contactr2m@gmail.com>
Date:   Thu Dec 8 14:01:35 2016 -0500

    Merge pull request #2 from contactr2m/#238-test_createdeleteDirectory
    
    Covers test for #238

commit 6a21c7eae2e5d099a4625e0456cc859ad75f23ed
Author: Mani <contactr2m@gmail.com>
Date:   Thu Dec 8 13:45:56 2016 -0500

    Covers test for #238
    
    Test case test_createdeleteDirectory extended to include #238 case.

commit 18e90dcc26c317a742d66edb1ab52d8a7c53a89c
Merge: 2681d1f 6750aae
Author: Mani <contactr2m@gmail.com>
Date:   Thu Dec 8 09:56:39 2016 -0500

    Merge pull request #1 from contactr2m/smb3.rmdir
    
    Implement SMB2_FILE_DISPOSITION_INFO in SMB3.rmdir() method.

commit 6750aae49067d063bc386f1c26fe7a6f538b7936
Author: Mani <contactr2m@gmail.com>
Date:   Thu Dec 8 09:52:23 2016 -0500

    Implement SMB2_FILE_DISPOSITION_INFO in SMB3.rmdir() method.
    
    Right now SMB3.rmdir() does not throw error STATUS_DIRECTORY_NOT_EMPTY when directory to be deleted is not empty.
    Instead it silently continues and returns success.
    Note that if the DELETE_ON_CLOSE flag is specified on a directory with child files or directories, the create operation will succeed, but the delete on close flag will be silently ignored when processing the cleanup IRP and the directory will not be deleted. http://go.microsoft.com/fwlink/?LinkId=140636

commit 2681d1f5de5c6122883a947bc57d431071f0beb5
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 6 12:53:34 2016 -0300

    Parse domain_name and TargetInfoFields based on their offsets and not after the Version field
    
    * This applies to NTLMAuthChallenge.
    * According to [MS-NLMP], Version field: 'A VERSION structure (as defined in section 2.2.2.10) that is populated only when the NTLMSSP_NEGOTIATE_VERSION flag is set in the NegotiateFlags field. This structure is used for debugging purposes only. In normal (non-debugging) protocol messages, it is ignored and does not affect the NTLM message processing.'
    * We found an instance of a server *not* setting the NTLMSSP_NEGOTIATE_VERSION and still having 8 bytes of random data as part of the version field.
    * At the same time [MS-NLMP] also states that: 'The Version field is NOT sent or accessed by Windows NT or Windows 2000. Windows NT and Windows 2000 assume that the Payload field started immediately after TargetInfoBufferOffset. Since all references into the Payload field are by offset from the start of the message (not from the start of the Payload field), Windows NT and Windows 2000 can correctly interpret messages with Version fields.'
    * Hence, we're using the offsets from now on to reference domain_name and TargetInfoFields
    * This should address https://github.com/CoreSecurity/impacket/issues/235

commit 2b61eedc6e2f58da8000faf3d49585273d02eade
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 5 18:32:16 2016 -0300

    Initializing self._Connection['Dialect'] to integer
    
    * Instead of ''. Dialects are numbers in SMB > 2 world.
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/233

commit a446089a3f3dcac393dcfdd2e0b0a71a420ed9be
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 5 09:37:48 2016 -0300

    Don't count on CreditCharge to calculate SequenceWindow, when dialect is SMB 2.0.2
    
    * This should address https://github.com/CoreSecurity/impacket/issues/233, pending testing from the original
    reporter

commit a298662c7bc7afcf342839968d92a0e00e015ae3
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 2 11:36:53 2016 -0300

    Don't send a SMB2_NEGOTIATE packet if we already know the server's chosen dialect
    
    * Only sends it again if we receive a SMB2_DIALECT_WILDCARD dialect.
    * This hopefuly addresses the situation where the target server supports a single SMB2+ dialect so it doesn't need to return SMB2_DIALECT_WILDCARD. I think this would only happen for those SMB Servers that only support SMB2_DIALECT_002 (not entirely sure tho).
    * This should address a part of https://github.com/CoreSecurity/impacket/issues/233.

commit 38f7bac1fcb3a91eb3571566ea1ffca6d518fbc7
Merge: 563b757 72f3a7c
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 24 14:11:44 2016 -0300

    Merge branch 'fox-it-ntlmrelayx'

commit 72f3a7c974f8e4868a07908c3b2bdafd1ec6ea84
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Nov 23 15:39:51 2016 +0100

    ntlmrelayx - relaying to IMAP

commit 563b757fba3af32655941edf5a35343300b173b2
Merge: 990e80b ab584ee
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Nov 21 13:25:11 2016 -0300

    Merge pull request #231 from fox-it/ntlmrelayx
    
    Fix ntlmrelayx httprelayclient to support HTTPS urls

commit ab584ee81df86d17027f2d429b732205fd934793
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Nov 21 17:01:35 2016 +0100

    Fix httpclient to support HTTPS urls

commit 990e80b065688002de8ffb0b977a4bffd304c003
Author: asolino <bethus@gmail.com>
Date:   Wed Nov 16 14:13:59 2016 -0300

    When processing a WCHAR_ARRAY, add support for unichr()
    
    * In case we find Unicode chars
    * Might help solving https://github.com/CoreSecurity/impacket/issues/154

commit 2bc68df37e5689deb2c46c9d47c37011c49e714d
Merge: 07e2377 43dde14
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Nov 16 12:42:52 2016 -0300

    Merge pull request #229 from fox-it/ntlmrelayx
    
    Ntlmrelayx bugfixes

commit 43dde14fd126b615516fd13956f66bd18500f4c4
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Nov 16 16:40:11 2016 +0100

    ntlmrelayx compatibility with ldap3 v2 and newer

commit 0da9b84f9f8935271b35a0e12e1d04b868e55ae4
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Nov 16 13:06:16 2016 +0100

    LDAP attack improvements

commit 07e2377c790da8180ecafd1bdff9cb735d6c0a6c
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 24 21:42:16 2016 -0300

    Adding -user-status support for DRSUAPI mode
    
    * Completes what was done at https://github.com/CoreSecurity/impacket/pull/222

commit 6c44e5bdd4dd3299c8966de6a7b57e019ccca1fd
Merge: d62efb7 036e5bd
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 24 21:21:07 2016 -0300

    Merge branch 'shab4z-master'

commit 036e5bd77852eb2b4152eb463eddc5e2b2bfd11d
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 24 21:19:24 2016 -0300

    Adding a -user-status display option
    
    * Changing the (current-disabled) to (status=Enabled/Disabled)
    * Moving that data to the end of the line, in alignment to the pwd-last-set display option
    * Only supportted in VSS mode. DRSUAPI coming soon

commit 5aab86a05918cbcbf8fcd5204a11e425693e0e52
Author: Slim MERIAH <smeriah@lexsi.com>
Date:   Mon Oct 24 13:52:24 2016 +0200

    Little check for enabled/disabled users.

commit d62efb7c8c87c9393caf33877e1cd9d21732e5f5
Merge: 2485f16 9c94160
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Oct 20 16:18:30 2016 -0300

    Merge pull request #220 from the-useless-one/ldap_utf8
    
    Don't try to encode the LDAP filter if it's already in unicode

commit 2485f164fd67ebf957df7082f4ad50f5018c807d
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 19 13:34:43 2016 -0300

    Fixes anonymous connection flags.
    
    * We shouldn't specify we're sending username / password when we're not.

commit 8cef002928ca52be4e9476a87a54d836b5efa81e
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 18 15:22:21 2016 -0300

    Adding MQTT basic structures and example
    
    * Minimalistic MQTT implementation, just focused on connecting, subscribing and publishing
      basic messages on topics.
    * Simple MQTT example aimed at playing with different login options. Can be converted into
      a account/password brute forcer quite easily.

commit 9c94160fac1c2547aa92e8553efe89247999a5a8
Author: Yannick MÃ©heut <yannick@meheut.org>
Date:   Wed Oct 12 11:50:49 2016 +0200

    If the ldap filter is already in UTF8, leave it as is

commit f35117e184438e747c0ba372ea3ef8f41d9a5d73
Merge: 10b94e4 40e6471
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 7 10:11:02 2016 -0300

    Merge branch 'fox-it-ntlmrelayx-interactive'

commit 40e6471434f849fcbab769a668a8ff5cb45fa068
Author: Dirk-jan <dirkjan@sanoweb.nl>
Date:   Thu Oct 6 22:33:12 2016 +0200

    Added interactive SMB console via local socket

commit 13843229ab90236742124330c72fd931cb5d06b8
Merge: 9739ade 10b94e4
Author: Dirk-jan <dirkjan@sanoweb.nl>
Date:   Thu Oct 6 19:15:29 2016 +0200

    Merge branch 'master' of github.com:CoreSecurity/impacket into ntlmrelayx-interactive

commit 10b94e4e20570a168e2e60c9b91e3a454de69a23
Merge: 0afacbe dadc4eb
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Oct 5 11:19:09 2016 -0300

    Merge pull request #218 from Gifts/master
    
    Small fixes for NTLMRelayX http client module

commit dadc4ebc227f1ad976730bbe3dbbab6dda2437e1
Author: Gifts <giftsungiv3n@gmail.com>
Date:   Wed Oct 5 16:52:27 2016 +0300

    Fix parsing NTLM challenge when multiple WWW-Authenticate headers are sent

commit f5a59ac408c683409a1db6ded51c3b92dafc338e
Author: Gifts <giftsungiv3n@gmail.com>
Date:   Wed Oct 5 16:29:35 2016 +0300

    Fix paths with multiple "/" in them

commit 0afacbea5a13f3bf5fb9e860ab3d3c712ef8a315
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 4 19:58:43 2016 -0300

    Adding GetADUsers.py example script
    
    This script will gather data about the domain's users and their corresponding email addresses. It will also
    include some extra information about last logon and last password set attributes.
    You can enable or disable the the attributes shown in the final table by changing the values in line 184 and
    headers in line 190.
    If no entries are returned that means users don't have email addresses specified.

commit c1e5842c2105490a5c9f763a700cd4b8e87274ec
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 4 16:04:51 2016 -0300

    Fixes NTLM anonymous issue authentication against W2k3
    
    * It might solve https://github.com/CoreSecurity/impacket/issues/216, although not sure yet since I cannot reproduce the full issue (I still get ACCESS_DENIED after anonymous login)

commit 9739ade5747018b45a9ffe425374d8d620fa4dde
Author: Dirk-jan <dirkjan@sanoweb.nl>
Date:   Mon Oct 3 21:26:00 2016 +0200

    Some more leftovers

commit 8af1ed5715756cfbd2ec6b81c12e1b87dc7b524b
Author: Dirk-jan <dirkjan@sanoweb.nl>
Date:   Mon Oct 3 21:22:38 2016 +0200

    Fix legacy config inconsistencies

commit f9652789d405557c782a1fd7c31add6b526c5c7d
Merge: bcd75b0 42165dd
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 21 20:06:10 2016 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit bcd75b080edcbf090ac95e8b96d73d4f2d52dd7f
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 21 20:04:33 2016 -0300

    Attempting to address situations where TSO (TCP segmentation offload) is present
    
    * I'm not entirely sure this is the right approach to solve this use case. Testing needed.

commit 42165ddee85832810ff3fc282ac8aa4560b0e3a5
Merge: 0c8e792 66e28da
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 21 15:23:54 2016 -0300

    Merge pull request #209 from blark/master
    
    Update ntlmrelayx.py to fix domain dump bug

commit 66e28da76f4c022e518ffc3274d2969a05e998ee
Author: blark <info@baseggio.ca>
Date:   Wed Sep 21 14:22:29 2016 -0400

    Update ntlmrelayx.py to fix domain dump bug
    
    The boolean `dumpedDomain` was being assigned after the completion of a domain dump. This can take quite some time on a large domain, meaning that every time a new request is processed the domain dump starts again (until the first dump is finished). This minor tweak should fix that.

commit 0c8e7926d1474f18d653cad543ded6917cd37394
Merge: 5227974 81ffe50
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 21 15:21:18 2016 -0300

    Merge pull request #208 from blark/master
    
    Updated requirements section

commit 81ffe50cbecf64c165fb8a264dec2cb2420578ae
Author: blark <info@baseggio.ca>
Date:   Wed Sep 21 14:17:13 2016 -0400

    Updated requirements section
    
    Added ntlmrelayx requirements and tweaked lines to match style

commit 52279744e8bf9c5895fc3339dc8fa4541840f45b
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 21 11:13:53 2016 -0300

    Fixing typo with PCAP MAGIC and Structure

commit 0e68c7ecc37c7b702168db75fcf6f1f041ca9e43
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 20:11:15 2016 -0300

    Honoring SMBConnection.myName parameter when doing NTLM handshake
    
    * If you create a SMBConnection object and specify a myName parameter, it will be populated in the NTLM_AUTH_MESSAGE
    * However, it will NOT be sent in the NTLM_NEGOTIATE message since modern Windows clients don't populated that information.
    * DCERPC connection are not yet supported
    * Partially addresses https://github.com/CoreSecurity/impacket/issues/207

commit d2cbe3c2606bd16e628858baae6483e8dd48ed3c
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 14:40:30 2016 -0300

    Adding code to handle IGMP packet
    
    * Applying patch from @nixotic
    * Addresses https://github.com/CoreSecurity/impacket/issues/30

commit bc05ee3522af7854400b00df40d421a0838a9a59
Merge: 7694e67 db8d291
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 14:28:20 2016 -0300

    Merge branch 'xelphene-master'

commit db8d291490e77685dd7abcd06f4b99dbf5c0feb9
Merge: 7694e67 8dbf234
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 14:25:14 2016 -0300

    Merge branch 'master' of https://github.com/xelphene/impacket into xelphene-master

commit 7694e67a9fab4de3cfb13b6924718d69af8e2979
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 10:26:11 2016 -0300

    Minor cosmetic changes

commit 42b447229fe9ed887d91d75df17c57f422963e24
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 09:55:16 2016 -0300

    Checking password field is not None when calling getNTLMSSPType3
    
    * If so, we convert it to '', hoping hashes were provided.
    * Indirectly addresses https://github.com/CoreSecurity/impacket/issues/206

commit 8dbf234ba38030e2914379015db743ac828a2bb3
Merge: 0de3c24 c049506
Author: Steve Benson <steve@xelphene.net>
Date:   Fri Sep 16 00:11:12 2016 -0400

    Merge https://github.com/CoreSecurity/impacket
    
    Conflicts:
            examples/wmiexec.py

commit 0de3c24e058c36a2db8173da94be3af88f0fdfca
Author: Steve Benson <steve@xelphene.net>
Date:   Wed Sep 14 06:59:48 2016 -0400

    Added a -A option to load credentials from an smbclient/mount.cifs style
    authentication file.

commit c049506e43ffa4c76dca7c676822ada7182f8288
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 13 23:54:50 2016 -0300

    Minor cosmetic changes

commit 01b0ae8e936ec4ead94fbd55d739603fd6f46f34
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 13 23:15:23 2016 -0300

    Better error control
    
    * We should re-write ServiceInstall tho.. It's kind of messy

commit d103ea7d0e50c7096d4f038d90d9162e302636b4
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 13 22:06:12 2016 -0300

    Removing uneccesary imports

commit a483bfbca950e1b205543fd28452b0cc5e68bb2c
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 12:00:31 2016 -0300

    Printing NTLM hashes as we get them and we keep the rest to the end
    
    * Basically NTLM Hashes printed as they come
    * Kerberos keys and cleartext password as printed after the NTLM hashes
    * Aimed at making the output more readable

commit d2e4aacf477387a2a3efb4ee359aecf79505e1ee
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 11:32:39 2016 -0300

    Adjusting variables to the naming convention already used

commit 473f3f107582347fd4df82d736ad68e5d71c88e6
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 11:17:57 2016 -0300

    Importing classes from the library instead of the example
    
    * In case the example's not present

commit e79b5e26cf387e94a50c1d51c9a65b5e11895870
Merge: 3e194c6 372b7e2
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 11:06:28 2016 -0300

    Merge branch 'martinuy-secrets_dump_refactoring'

commit 372b7e25749464785f2488c1a41323c30d0e3893
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 11:04:22 2016 -0300

    No need to convert argument to string
    
    * In fact it might trigger an exception when dealing with Unicode strings (e.g. an user with non ASCII chars)

commit b4c819b99f758419f13884a72d6ad15c96b9c1f3
Merge: 3e194c6 8701c37
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 10:41:12 2016 -0300

    Merge branch 'secrets_dump_refactoring' of https://github.com/martinuy/impacket into martinuy-secrets_dump_refactoring

commit 8701c37bb09e491e2264ad3664be367dd4cedb3d
Author: martin_uy <m@rtin.uy>
Date:   Fri Sep 9 10:22:24 2016 -0300

    Resources cleanup (files closing) when dumping NTDS hashes.

commit 1ca14b97f478789ea2405946022fab6f9bd31f5a
Author: martin_uy <m@rtin.uy>
Date:   Fri Sep 9 10:12:44 2016 -0300

    Constant replacement.

commit 5819161f6846d3cbd8295d81373f014bd1b0ab84
Author: martin_uy <m@rtin.uy>
Date:   Thu Sep 8 21:10:18 2016 -0300

    A callback per secret was added to extract information out of Secrets Dump library component. A "print" default callback keeps the previous behaviour by default.

commit 3e194c6540d41f7d231e0de28f305572cae541f7
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 8 11:52:00 2016 -0300

    Removing references to deprecated SMBBackwardCompatibilityTransport class
    
    * Fixes https://github.com/CoreSecurity/impacket/issues/203

commit 87dd64e4da23ee9af838ef181f591b2309003ede
Author: martin_uy <m@rtin.uy>
Date:   Thu Sep 8 11:09:49 2016 -0300

    Secrets Dump library component is now using the Impacket's logging idiom.

commit 3d4944afc76a145643595d4f825e247ed8ee0ba8
Author: martin_uy <m@rtin.uy>
Date:   Wed Sep 7 20:45:48 2016 -0300

    Secrets Dump example split into 2 components. Secrets extraction component moved to Impacket library as an example. Command line interface component remains out of Impacket library.

commit c8aabf2810857032c2f944edfb8ca931ecf3889a
Author: Michael Niewoehner <mniewoeh@stud.hs-offenburg.de>
Date:   Thu Sep 17 15:52:12 2015 +0200

    Adding Decoders for BOOTP and DHCP

commit 2a4195d416aa67771bbe27aec629076bfe1e0253
Merge: 609ddf3 488fddd
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 7 12:54:20 2016 -0300

    Merge pull request #89 from DiGMi/master
    
    Adding ERP and Country elements to Beacon

commit 609ddf3e5626ec32e42ba8826ed4bb8b7d7955a3
Merge: ce72d09 a934c89
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 7 12:51:55 2016 -0300

    Merge pull request #91 from c0d3z3r0/feature/eap
    
    Add EAPOLDecoder to EthDecoder

commit ce72d09cbce787839584b2566cf9d6323048872e
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 6 17:49:00 2016 -0300

    Minor class refactor
    
    * Created LocalOperations class to encapsulate some offline registry specific operations.
    * Now DumpSecrets is cleaner, and just handles the instances created based on the scripts parameters set by the user

commit bac6ad7f50ffe894d64055b4fc1eeff48051b059
Merge: 7801e11 3221e34
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Sep 6 12:27:42 2016 -0300

    Merge pull request #202 from fox-it/ntlmrelay-fixes
    
    ntlmrelayx improvements

commit 3221e34440e2ab09f46baa3005f1c923a66983f0
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Sep 6 16:50:11 2016 +0200

    ntlmrelayx improvements

commit 7801e11d9906e105f0ec369cf0fe88f5d131afc5
Merge: af697dc 0325289
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 5 12:27:44 2016 -0300

    Merge branch 'kacpern-ldap-dev'

commit 0325289b45feb28d7cbc21324dda14945c202c27
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Mon Sep 5 17:24:09 2016 +1000

    changed default classes to a mixin

commit df5b231da10ff84a506905d442256e987d7103ef
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Mon Sep 5 15:16:38 2016 +1000

    minor changes and refactoring
    * slightly changed search method definition
    * added pretty printing of control values

commit a934c89ea2badc89f8c5e5175a49e6e199cf36a6
Author: Michael Niewoehner <mniewoeh@stud.hs-offenburg.de>
Date:   Wed Sep 16 10:21:16 2015 +0200

    Add EAPOLDecoder to EthDecoder to get the decoded EAPOL packet from child()

commit d63ff2368791e415aca73922174b9a762157c32c
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Fri Sep 2 10:42:21 2016 +1000

    reverted str.format() to %s
    reverted str.decode() to unhexlify()
    fixed my primitive obsession
    additional refactoring

commit 7799329097a2b825ca75e3ebe4223ce74c9a4478
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Sep 1 15:13:10 2016 +1000

    formatting fix

commit da8c405e008a358aa6514bd317602b5f1dc7bc63
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Sep 1 15:00:15 2016 +1000

    rudimentary checks for simple authentication

commit c652c0f7a733861784bd6cfbd90d9deebaa7e999
Merge: 8aba596 af697dc
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Sep 1 14:26:52 2016 +1000

    Merge branch 'master' into ldap-dev

commit 8aba596bf329e87a7260deafec012dc2fdcad77f
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 31 16:13:49 2016 +1000

    working on ldap and ldapasn1 cleanup

commit af697dcf9550684f05f6ea50037910a825c8bc10
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 29 11:57:31 2016 -0300

    Avoiding infinite loop when opening some ESE databases
    
    * We're giving up if FirstAvailablePageTag is <=1 (as opposed to just == 1)
    * Fixes https://github.com/CoreSecurity/impacket/issues/199

commit db125046eda94f75051a28ef83fce24b5ca98bd5
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 25 21:32:51 2016 -0300

    Adding Author Attribution
    
    * Based on the amount of code committed on those files.

commit 6ecaa8a7bcb065f6f7ffc007e9dda2705aa6baeb
Merge: fc4d2a1 81fe930
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Aug 25 21:13:22 2016 -0300

    Merge pull request #197 from kacpern/ldap-approxmatch
    
    pretty handling of unsolicited notifications

commit 81fe930ea69a237a109268da58e2ef49319ace30
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Fri Aug 26 10:08:34 2016 +1000

    implemented handling of nnsolicited notification

commit fc4d2a15d35cb06a1949f1ce95c01a96f9d289a5
Merge: 311b5ba be48469
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Aug 25 21:05:52 2016 -0300

    Merge pull request #196 from kacpern/ldap-approxmatch
    
    fix tagSet for approxMatch (#195)

commit 311b5ba09454098c6a3441aa082e05269ea1ef03
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 25 14:04:51 2016 -0300

    Removing unused imports
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/187

commit be48469e18efa39b8a1b911029bca159aa1b3fca
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 25 18:57:44 2016 +1000

    implemented handling of nnsolicited notification

commit b4808fcca418b66395edb830e86492767c06f1bd
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 25 18:56:36 2016 +1000

    implemented handling of nnsolicited notification

commit c523e9462932190139d3067d20ba3c9f1959f2ef
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 25 18:25:11 2016 +1000

    formatting

commit bed4b2db64e804dbfb14c04169903e48e49a2cbc
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 25 18:13:28 2016 +1000

    * fix tagSet for approxMatch (#195)
    * add extendedResult to ldapasn1
    * add fix for AD nonconformity with RFC

commit 8af9271f656b6d420466f8bcaec8b81253388340
Merge: da6086a db48476
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Aug 24 09:46:39 2016 -0300

    Merge pull request #194 from kacpern/ldap-paging
    
    changing names

commit db48476f523a2f7509f2736cd16bb564bd4d5663
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 24 16:21:25 2016 +1000

    fixing bad names

commit 3484373aca5fceb2866b1ea455678e04c5b02533
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 24 16:18:30 2016 +1000

    fixing bad names

commit ecccf3b26bfa71ddca6dad6e84beb50866dd4a55
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 24 16:13:40 2016 +1000

    fixing bad names

commit da6086a4a40e7349c36300496d56493ebdff696f
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 23 12:55:50 2016 -0300

    Removing unused code
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/187

commit b8ef63da351cc24e812624e1294d930f89b3578c
Merge: f330e78 0c9b64a
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 23 11:48:31 2016 -0300

    Merge branch 'kacpern-ldap-paging'

commit 0c9b64a592ceb01925af1d3cca8a05301724bfac
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 23:27:21 2016 +1000

    ready to merge. please test. take 2.

commit 402f334984a01d75d07b495afd49335eb453eca6
Merge: f8dd738 bace3f1
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 23:23:44 2016 +1000

    Merge remote-tracking branch 'origin/ldap-paging' into ldap-paging
    
    # Conflicts:
    #       impacket/ldap/ldap.py

commit f8dd738c9749244d0f37e493cb43641a79f86eb4
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 23:17:22 2016 +1000

    ready to merge. please test.

commit bace3f176aa10dec567482a8fe5dc877791b0290
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 23:17:22 2016 +1000

    ready to merge. please test.

commit 4f0bef666ba35ffe1fbf277d5d0b2901a4b1a901
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 22:55:48 2016 +1000

    minor changes

commit 557944359e169c8144e3bfbcaa738baca6692a89
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 17:48:15 2016 +1000

    changed control handling code to accommodate the fact that some controls can have different controlTypes for request and response

commit 090bc35e86d7910f0ebae6209457235de5bf9ef8
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 17:00:33 2016 +1000

    removed unused variable

commit 92e34128669f219269a6b8bb2a1fa7b10af2cade
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 16:24:09 2016 +1000

    fixed broken logic (could have impact if new controls are implemented in the future)

commit 7069281cb7328d2508c8edd178d74d0ff87c18c4
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:50:16 2016 +1000

    fixed a dangling break

commit 34da4acc5a9c9dabbfb7415bb69a76a4a7a59a56
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:48:59 2016 +1000

    removed unneeded enumerate

commit f0c1b016c9b6d4d03a3c1226eefe6606594affcc
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:34:19 2016 +1000

    changed tagFormat in Controls()

commit 50258a8b77f9b68d647c7c7ccaa2715c1c6d9c60
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:26:52 2016 +1000

    removed unused imports

commit 46507c703e95050497cb7938a8392f06d0d31e7d
Merge: c25a8b5 f330e78
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:25:28 2016 +1000

    Merge branch 'master' into ldap-paging

commit c25a8b5b93047f14945c6f3426b1ebd4b58d801f
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:19:25 2016 +1000

    added simple paging support
    changed defualt search filter to '(objectClass=*)'
    changed decoder to BER
    added extra non-capturing group in NUM_OID
    removed manualFilter in search as _parseFilter should deal with anything now, just use the string version of your filter in the call

commit f330e78bb2f94b503b3a0e887c0b6cbb96489f5b
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 22 09:20:49 2016 -0300

    Adjusting those fields where a default value is predefined
    
    * Also, changing ASN1 encoding from DER to BER
    * Linked to https://github.com/CoreSecurity/impacket/issues/190#issuecomment-241341614 discussions

commit 1630821cae97eb4905b64aa629a0bc0a7ef9b5c2
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Sat Aug 20 14:19:23 2016 +1000

    changing code for consistency

commit cee61cd53298930a43a1ed2e423d9b15826cb28c
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 18 10:04:45 2016 -0300

    Getting rid of manual search filters and using just strings
    
    * Way easier after @kacpern awesome PR!

commit 8ea9ebc2d05d4f76b656fa7a2d60dcd74e15f7dd
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 18 09:56:45 2016 -0300

    Adding manualFilter parameter to LDAPConnection.search() in order to mantain a way to specify directly Filter objects to be used when searching.
    
    * Will make transition easier for those projects used to the former search API.

commit 8efc4a2f7e7196b0c5fe63d996fcbebe290f28df
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 18 17:24:50 2016 +1000

    minor fix in regular expression

commit e2379346a0ddc2a2217c7ef292c7d8dc2cda12e8
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 18 16:40:21 2016 +1000

    added extensibleMatch string filter parsing

commit 427ad258cf45c767015ff0e92e7fe33aacecf780
Merge: d17cf6f 01b7762
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 17 10:48:30 2016 -0300

    Merge branch 'kacpern-ldap-filter'

commit 01b776231ad7bdf1c1a801e93214caddd4a3078e
Merge: d17cf6f 6989a3c
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 17 09:19:59 2016 -0300

    Merge branch 'ldap-filter' of https://github.com/kacpern/impacket into kacpern-ldap-filter

commit 6989a3cb41e002233435c37417fbd50e6c2a7a9e
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 17:57:38 2016 +1000

    minor fix

commit b6f25451abb5e858cdeb34120b83089ae4784802
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 17:52:54 2016 +1000

    minor changes

commit 519bda4bf0b1a1721a9711e11ae9c80ebb742829
Merge: 92682d7 b1502a3
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 17:52:22 2016 +1000

    Merge remote-tracking branch 'origin/ldap-filter' into ldap-filter
    
    # Conflicts:
    #       impacket/ldap/ldap.py

commit 92682d777fae189d008fbc9fc130effe438af5fa
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 17:47:46 2016 +1000

    fixed 'not' filter

commit b1502a32738e6ed7ae76206d3b0146f832298c82
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 17:47:46 2016 +1000

    fixed 'not' filter

commit c4eda9d91e9ce07c15ab49905d13b3457e188ede
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 12:35:49 2016 +1000

    added parsing of ldap text filters into a Filter() object

commit d17cf6f587718c794afe229e10bbb72560fb1c79
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 12 23:09:57 2016 -0500

    Forgot to restore to its original state

commit f8ed7640afd74259fa5079a4db612e35a3bc5103
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 12 23:08:31 2016 -0500

    Minor cosmetic changes
    
    * Mainly variable renaming so it's easier to understand their meaning
    * Further testing is needed since I can't make it work the attack part. It gets stuck when searching the target LDAP

commit bf4dc4f6ed28e16727a283582e2ba7cf714a5392
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 12 11:10:50 2016 -0700

    Adding -duration parameter
    
    * By default ticket is valid for 10 years, you can change that now

commit 90a91045139659d83409af1771dcaf697c00de99
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 11 21:29:40 2016 -0700

    Whenever there's an exception triggered when searching the PEK we skip the row
    
    * Hopefully addresses a privately reported issue

commit 8c45d98bba08503088405c00cde9f2dc1f30d5a7
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 11 21:24:02 2016 -0700

    Adding MSSQLAttack() class.
    
    * Now you can specify a SQL statement to be executed after a successful relay is done
    * Addresses a part of https://github.com/CoreSecurity/impacket/issues/188

commit a37d352c0b7fc2fd416d2723f84400a05498bf4f
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 10 22:27:52 2016 -0700

    Customizing some code

commit 4a10ef4603308ce1bc1d9b9cf7d1fb7eb14a86d4
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 10 19:56:52 2016 -0700

    Removing -save option. Saves ticket to disk by default
    
    * Can't find a use case where we would not want this

commit 007c50e871bd55c2e029fa507247404ede5a8415
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 10 19:50:36 2016 -0700

    Adding help examples

commit 5812bee6f60b1cf4aecad46d304c197ef7e7b051
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 10 19:22:18 2016 -0700

    This script will create TGT/TGS tickets from scratch or based on a template (legally requested from the KDC)
    allowing you to customize some of the parameters set inside the PAC_LOGON_INFO structure, in particular the
    groups, extrasids, etc.
    Tickets duration is fixed to 10 years from now (although you can manually change it)

commit bfeb31ab7eab58c3f47392b587b794d4d4ada783
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 7 23:19:22 2016 -0700

    Changing PAC_SIGNATURE_DATA['SignatureType'] type allowing negative numbers

commit fea99f7493030ec76b1b9cb260b715ba4b5bcd12
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 7 22:46:14 2016 -0700

    Adding [MS-KILE] 3.1.5.9 Key Usage Numbers constants

commit 053cb994d683d9cc8a4228a2662ab58e420fae2b
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 2 10:28:38 2016 -0300

    Removing PAC structures and using the ones located in the library
    
    * Now located at impacket.krb5.pac

commit 4e56a32350076759b03ffaa34fbdc541f8da7f5e
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 2 10:25:23 2016 -0300

    Adding [MS-PAC] implementation into the library
    
    * Too many examples already using it, simpler to have it in a single place

commit 5d6879242b46d06095694ff2cee891b2379311f0
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 2 09:42:02 2016 -0300

    Adding the enumerateMethods() helper function
    
    * If you pass a IDispatch derived interface, it will return a dictionary with the methods and parameters supported by the interface

commit 002d4c33ec94c22017ce7411bcefa00f94131b3c
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 30 15:32:36 2016 -0300

    When a NDRUNION doesn't have any items we still need to return the bytes processed

commit 07723c6f124e087ea0c2f36ce18b3cbc568bf3b8
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 28 15:20:48 2016 -0300

    Adding HKEY_CLASSES_ROOT query support

commit 5a3ae389099a046ffc93daf657ec4e2499636e59
Merge: 801a54a 6b579a4
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jul 27 09:06:03 2016 -0300

    Merge pull request #185 from real-datagram/master
    
    139 support added (lookupsid)

commit 6b579a488a98fda670c249741ea0c3a7e58dc261
Author: dg <datagram.locks@gmail.com>
Date:   Tue Jul 26 15:41:31 2016 -0700

    139 support added

commit 801a54a6aa94ec32fc38422dc516875cb6e8fae0
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 26 16:03:34 2016 -0300

    Fixed typo

commit a50fdda283f6e4bf906a2076d191ab870869c9a5
Merge: 4a26102 01cb24d
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jul 26 15:57:03 2016 -0300

    Merge pull request #184 from real-datagram/master
    
    port 139 updates and SMBTransport rewrite (samrdump)

commit 01cb24da0e815e894c3b7953319a8ae81bce24cc
Author: dg <datagram.locks@gmail.com>
Date:   Mon Jul 25 17:21:20 2016 -0700

    removed extra comments

commit 2bc0b7aaa4b29c806eb2f6c185e8ab6e4fa384bd
Author: dg <datagram.locks@gmail.com>
Date:   Mon Jul 25 17:19:38 2016 -0700

    139 support added

commit ed0a6a4ada866277dfef6d3f1d9bd7f7ef082c0a
Author: dg <datagram.locks@gmail.com>
Date:   Mon Jul 25 16:12:03 2016 -0700

    tab vs spaces typo

commit 75344b0c74a59204fdfd21064b6f2986d8ae5db0
Author: dg <datagram.locks@gmail.com>
Date:   Mon Jul 25 16:08:54 2016 -0700

    port 139 updates and SMBTransport call to generic DCERPCTransportFactory constructor

commit 4a261022f078983c6d016a23c545dad803764877
Merge: c7f66e6 3c1959c
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jul 25 17:04:17 2016 -0300

    Merge pull request #182 from real-datagram/master
    
    added port 139 support and related options (smbexec)

commit 3c1959ceda0c00e402820fd875cd9e3515d87686
Author: dg <datagram.locks@gmail.com>
Date:   Mon Jul 25 12:36:33 2016 -0700

    added port 139 support and related options

commit c7f66e6793a4a99b70fd0ac2155b7022b5ad8c10
Merge: ee30e66 5835f61
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 19 14:50:47 2016 -0300

    Merge branch 'real-datagram-master'

commit 5835f61c2d7d7e630c95ea1614d088d12fae9b18
Author: dg <datagram.locks@gmail.com>
Date:   Tue Jul 19 10:13:27 2016 -0700

    added port 139 support and related options

commit ee30e662d3189f239cde8491d18eda39a53e815c
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 18 14:02:40 2016 -0300

    Fixing typo

commit 4f792fb9f1457af302727a06da783208562fb25f
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 18 13:58:23 2016 -0300

    Adding -request-user parameter
    
    * Requests TGS for the SPN associated to the user specified (just the username, no domain needed)
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/178

commit 7c144867073a279d3e2c6fb878383d1d16c8b97b
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 18 12:15:33 2016 -0300

    Replacing ':' for other character when building the JtR output
    
    * If we don't replace ':' JtR gets confused.
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/179

commit 5ae1231c4d4a01492484d3f2c9ad0dc068fd066f
Author: asolino <bethus@gmail.com>
Date:   Sun Jul 17 19:37:46 2016 -0300

    Adding query -ve parameter
    
    * Queries for the default value or empty value name
    * Some code correction

commit 24c4921a2d7051b9d9cff76ef03f6074a347e572
Author: asolino <bethus@gmail.com>
Date:   Sun Jul 17 18:34:03 2016 -0300

    Minor fix in name_registration_request and updated test cases

commit e351505837d7d8547f9754628c9d8eee296d9eba
Author: asolino <bethus@gmail.com>
Date:   Sun Jul 17 17:40:00 2016 -0300

    NetBIOSError exception redefined, added name_query_request()

commit f73a97ee81a318bc2f6ccf24bffac76a4089143b
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 13 18:33:08 2016 -0300

    Adding test case for nmb.py

commit 0808e45b796741aea4162bd756e3f54522e8045b
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 13 18:26:27 2016 -0300

    Renaming and recoding of some classes + test case suite
    
    * Many changes to many classes. Much needed for a long time. Aiming at simplifying its work and addding Structure whenever possible.
    * Most probably will break backward compatibility for those using impacket.nmb.

commit d15d01c2fa8c5a0201a121215b7413b7b90a2358
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 8 22:04:41 2016 -0300

    Bugfixes
    
    * Changing logic for __print_all_subkeys_and_entries() method
    * Striping NULL character when printing lpNameOut
    * Better error control when an exception is triggered

commit 91aab87e135806427ae9e7aabda98535542a6437
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 8 21:03:14 2016 -0300

    Changing default value for hBaseRegEnumValue
    
    * Also optimizing the way we craft the packet to minimize trafic
    * Raising exception if trying more than once with the modified size received from the server

commit 04310006e4641c305642c25d48f4ca45f5c1e560
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 22:01:29 2016 -0300

    Restoring the right order in enableRegistry() and adding a warning message
    
    * In case we cannot check the RemoteRegistry status. We'll continue and hope for the best

commit 1a29f0ae3c0098d4f5b5b22b900549f05512e133
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 21:14:55 2016 -0300

    Fixed bug where KeyName wasn't printed correctly when -s switch used

commit f27c39da235ae23ac50af3cb92ca5bb1adef3915
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 20:58:01 2016 -0300

    Continuing if there are keys that cannot be opened

commit e08966ef10edcf696137280c938c6b934a42018b
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 20:36:30 2016 -0300

    Continuing if we cannot connect to SCMR to check RemoteRegistry state
    
    * Maybe a low level user connecting? :-o!

commit b2413d25a50a5d5c09c8c8317d069c092178785e
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 20:12:38 2016 -0300

    Setting socket timeout when connecting a new NetBIOSTCPSession
    
    * After connect(), we're restoring the previous timeout (should be None most of the times) because we handle timeouts later in a different way
    * Addresses https://github.com/CoreSecurity/impacket/issues/173

commit e8764446b54193292cc88973ba7965eea5c945f8
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 09:36:46 2016 -0300

    Making sure we return an ascii encoded string after performing first and second level encoding.
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/172#issuecomment-230631476

commit f04398f2e331330cc18e97208e0ae5bb639252c1
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 09:01:44 2016 -0300

    If SMBConnection times out, reconnect it

commit f8c19620ea0685421a5400d7869e20d196d0682c
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 5 20:22:01 2016 -0300

    Adding SMBConnection.reconnect() capability
    
    * reconnects the SMB object based on the original options and credentials used. Only exception is that
      manualNegotiate will not be honored.
      Not only the connection will be created but also a login attempt using the original credentials and
      method (Kerberos, PtH, etc)

commit 103ea978fa6d580367f42aca6aae2678c5cbefa0
Merge: b13acf3 d246ae5
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jul 5 11:47:40 2016 -0300

    Merge pull request #175 from fox-it/ntlmrelay-fixes
    
    ntlmrelayx bugfixes

commit d246ae5751721dc71b89c944e4345e6d723b9015
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Jul 5 16:36:13 2016 +0200

    ntlmrelayx bugfixes

commit b13acf3e64a8cef11537f6e6820ce5221b93069d
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 4 19:10:59 2016 -0300

    Automatically enables/starts/stops/disables the RemoteRegistry service when needed
    
    * Also part of https://github.com/CoreSecurity/impacket/issues/127 requests
    * Commented actions yet not implemented

commit e5c4bdaa04d8bc474f35186f78a06fca32d311b0
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 4 18:43:10 2016 -0300

    We remove the session resume file if ERROR_DS_DRA_BAD_DN error was triggered

commit 75167141137133248276f5458dc8d86ad10d2b8c
Merge: 5acf2b4 4e3ebc4
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 4 15:48:30 2016 -0300

    Merge branch 'manuporto-master'

commit 4e3ebc43c09d0b4b07c89429234e4c54ff991b67
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 4 15:47:05 2016 -0300

    Minor cosmetic changes
    
    * Copyright notices
    * Variable renamings
    * Reusing library code
    * minor logic flow changed

commit 421d390555d89fd86fc4a8b0084321d3c3cff917
Merge: 5acf2b4 e950f15
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 4 13:19:18 2016 -0300

    Merge branch 'master' of https://github.com/manuporto/impacket into manuporto-master

commit 5acf2b4579ff0a19c4115eaa0b489557ac3e9f62
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 16:29:20 2016 -0300

    Adding debug logging output for the exception

commit d824905276dfd2a1863e82136b5eed9fd6ba20cd
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 16:28:56 2016 -0300

    Undoing an unnecessary change

commit 267ee5e0657b29fe8b3c05160b3e27365fafe572
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 16:07:33 2016 -0300

    Adding -port parameter to support 445/tcp and 139/tcp as destination ports
    
    * I create a new parameters group called 'connection' where you can specify the destination port, the domain controller IP and the target IP (if needed)
    * We should propagate the same schema over the rest of the scripts (whenever applicable)
    * Aiming at addressing https://github.com/CoreSecurity/impacket/issues/172

commit fe705da38e1448819ecd83762cd979950e5e8468
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 15:57:25 2016 -0300

    Improving support for connections using NETBIOS_SESSION_PORT as target port
    
    * We're trying to honor the remoteName whenever possible.
    * If user asked for *SMBSERVER as the target name, the library will try to find the target's netbios name on its own.
    * Could potentially bring some incompatibilities with previous implementations, so please test this as much as possible
    * Aiming at addressing https://github.com/CoreSecurity/impacket/issues/172

commit 833943d26d76999a612a1cf38e4cfc26a8ad20d3
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 12:33:14 2016 -0300

    Adding Called Name when NETBIOS_SESSION_NEGATIVE_RESPONSE is raised

commit 7fbfde35dfd1ddccf520060977e5ba452d19cf36
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 12:24:13 2016 -0300

    Adding getRemoteName() method.
    
    * This is what the user specified when creating the SMBConnection object.

commit ef2ed82977ac746fe44ac19356f9c923d3d67215
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 12:22:46 2016 -0300

    Renaming get_dip() for getRemoteHost()
    
    * Why? Because not always the target is a IP address

commit 0b71f6532b0f448278b8049e860921ed2088055b
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 11:05:48 2016 -0300

    Adding more UUIDs based on updated protocol standards

commit ebd9fa4cb01b844984abb63e3fd272b9fc14773d
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 10:43:27 2016 -0300

    Simplifying dynamic imports
    
    * Used when building a RPC Reponse
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/126 (I couldn't reproduce it)

commit 20b661efd234973a560b71d6743f47800f2a3c3f
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 28 14:29:12 2016 -0300

    And now coming back to dev :)

commit 7b0bfb763e80e6cc3f1bbc902ccc3fbcfad1b5d8
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 28 14:20:27 2016 -0300

    About to tag new version 0.9.15

commit 0481f3356c8c4ce9deccc0be2d718d11404b97c1
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 27 13:45:29 2016 -0300

    Forgot to set the tag for SubstringFilter
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/170

commit c3f8d9a7d58146093ca6fc08526b42951401c905
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 27 13:44:19 2016 -0300

    Don't fill up the attributes item if there are no attributes asked

commit 014928c48e1bbeefae34163beab807f86b809ea7
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 24 15:49:20 2016 -0300

    Fixing imports
    
    * We don't like import *

commit e950f158f3e198bb561496d31fc70b83c86a661d
Author: mporto <mporto@fi.uba.ar>
Date:   Fri Jun 24 12:23:18 2016 -0300

    Typo

commit 6f999e5756b89b49de6079621f8490cbdad1fcac
Author: mporto <mporto@fi.uba.ar>
Date:   Fri Jun 24 12:20:43 2016 -0300

    Reg example with partial query functionality

commit 16a321228cabf577f4e74daa242373d425e4d3de
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 23 19:28:29 2016 -0300

    Adding changes for the upcoming version
    
    * We're tagging as soon as we verify https://github.com/CoreSecurity/impacket/issues/168

commit 84252ae98dec44141ab82561b72202988ff2e376
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 23 19:22:12 2016 -0300

    doAttack() now keeps a list of target successfully attacked
    
    * Then we read it in the main thread and decide whether or not to attack again based on the -one-shot parameter
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/168

commit e9e639a267eb87aabe1f5fb7e2ce4481eaed5ec1
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 23 17:45:22 2016 -0300

    Flags2 adjustements to avoid some stacks from whining
    
    * mazel tov! :)

commit ccf9c2b4451bfe9244e62ef49d44d1b0f5c05c75
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 23 12:18:57 2016 -0300

    Automatically adjust buffer size for hBaseRegQueryValue

commit 66111c8271c318fa4032efb6d6634441664857d8
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 23 12:06:28 2016 -0300

    Automatically adjust buffer size for hBaseRegEnumValue
    
    * If the original one didn't wasn't large enough
    * If you know the size in advance, you can specify it through dataLen parameter
    * Adjusted test case to trigger this situation

commit 9aeee403ca3e40bfef91b9099f100e2e68fd09ed
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 21 15:36:31 2016 -0300

    Adding the actual SPN to the JtR output produced (and saved via -outputfile)
    
    * Now -outputfile automatically selects -request

commit d6c065a820dc3dd90cb1bf91bb81be22f8f93102
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 21 14:47:35 2016 -0300

    Adding exception handler when processing each record
    
    * Handling pwdLastSet if it was never changed (hopefully)

commit 60f9fa627b3553e0330cbe543571a9db9ef672f1
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 21 14:25:26 2016 -0300

    Whenever we receive sizeLimitExceeded exception, we still process what we've got
    
    * Will give you some results until we implement paged searches

commit 55d1f3ff27b527cc00f66281993002058f5568dc
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 21 10:06:41 2016 -0300

    Extra checks if login didn't succeed

commit ffe7e92afdd8395d24986781da5eca42b2b0b05d
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 21 09:57:29 2016 -0300

    We shouldn't process cipherText if it wasn't processed before
    
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/167 although it needs to be verified

commit 33794acbfa73c33e436354f635fcc9f7ae0a887f
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 15 09:27:49 2016 -0300

    Removing unnecessary dependency package

commit acc7a046727ea81bb27fafcb90e95bb359eb5ad4
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 14 13:02:09 2016 -0300

    Using httplib instead of requests plus error fixings
    
    * httplib comes by default, much better than requiring another dependency
    * Removed debug messages
    * Fixed minor errors

commit a769fbca94a5c85ed58cb0e5650f2d621ed2c435
Merge: f618a5f adb01d6
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jun 14 10:53:26 2016 -0300

    Merge pull request #166 from fox-it/httprelayclient
    
    httprelayclient for ntlmrelayx

commit adb01d65df8315f9de6e09dfcc8cce6c5632b1a6
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Jun 14 11:10:02 2016 +0200

    Added optional path support to target specification, fixed port parsing

commit 467ad252d4701a9a4bb050b99f5d74c961d3fda8
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Jun 14 11:02:57 2016 +0200

    HTTP relay client

commit f618a5f1e10d5f893907ad85b65b3c8d759a3537
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 8 20:16:51 2016 -0300

    Setting DRSBind.dwExtCaps accordingly so Win2016 TP5 with PAM is happy about us
    
    * Plus any other possible thing
    * Fixes https://github.com/CoreSecurity/impacket/issues/165
    * Thanks @gentilkiwi and @MichaelGrafnetter for your input

commit dd557b9a79f535ffae0dc8bedc37a9b873a9b20e
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 5 19:09:22 2016 -0300

    Adding DRS_EXT_GETCHGREPLY_V9 as a possible DRSGetNCChanges answer
    
    * Now we access the structures for both _V6 and V9
    * We added we support this feature in DRSBind().dwflags
    * Addresses issue found by @MichaelGrafnetter (https://github.com/CoreSecurity/impacket/issues/165)
    * Still needs to be tested but don't have yet a TP 5 propery configured.

commit c5dd3b86f0d0c21636f23a6a6905e3a53092e53e
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 5 18:56:53 2016 -0300

    Adding also the flag to support _V9 replies
    
    * DRS_EXT_GETCHGREPLY_V9

commit 27ed488d2786b5c66d844237fe797b2167841681
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 5 18:49:59 2016 -0300

    Adding new structures added for 2016 TP5 PAM support
    
    * In particular DRS_MSG_GETCHGREPLY_V9 and everything that depends on it
    * This is needed for addressing https://github.com/CoreSecurity/impacket/issues/165 (also detailed here https://github.com/gentilkiwi/mimikatz/issues/47)

commit 04c66e588083dbcff855c1b476f0cdad98141435
Merge: 07f1981 7b2f942
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 3 21:43:04 2016 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit 07f19817d6ca2a819265814b519d271c30657d5c
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 3 21:38:48 2016 -0300

    Adding one-shot parameter
    
    * After successful authentication, only execute the attack once for each target (per protocol)

commit 7b2f942121e15c690463e988e1f1e84ed07963d2
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue May 31 22:42:38 2016 -0300

    Update README.md

commit 1bdba4837425a9546380b0962649fa114140496c
Author: asolino <bethus@gmail.com>
Date:   Tue May 31 21:22:54 2016 -0300

    Adding -dc-ip option to examples
    
    * Allows to specifying the IP address for the DC/kdcHost
    * Collateral for https://github.com/CoreSecurity/impacket/issues/160

commit 19f7fe90edfd4e651b63c14d8f125f17416fef2f
Author: asolino <bethus@gmail.com>
Date:   Tue May 31 21:15:16 2016 -0300

    Adding ability to specify kdcHost for DCERPC/DCOM layers
    
    * Adding kdcHost to the classes constructors (when applicable)
    * Through DCERPCTransport.set_kerberos() now you also can specify the kdcHost
    * Added DCERPCTransport.get_kdcHost() that will be used by DCOM and DCERPC
    * Aiming at addressing https://github.com/CoreSecurity/impacket/issues/160

commit cea19373434b808ae62d362af3bac360d2488ba8
Author: asolino <bethus@gmail.com>
Date:   Mon May 30 18:49:11 2016 -0300

    If ldap:// fails, we try ldaps://

commit a813b202ad45b990cd79bbd17dd9b4e8e7cf168f
Author: asolino <bethus@gmail.com>
Date:   Mon May 30 18:48:13 2016 -0300

    When setting a value, we pack it depending on the data type

commit c1cce7636cc7b201caa2a9bd8a71a33e4a3d17b1
Merge: d96a537 0bb0b2b
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:51:44 2016 -0300

    Merge branch 'fox-it-master'

commit 0bb0b2bf2843ea493223553f9542a4b971a6c327
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:47:33 2016 -0300

    More fixups and cosmetic changes

commit 5b31f9c26768552ff3effdbc139b62dcea219194
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:46:17 2016 -0300

    Forgot to change setup.py with new ntlmrelayx location

commit a1912824eb99ccf48b561d7ad716c92abf43aba3
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:44:28 2016 -0300

    Moving impacket.ntlmrelayx to impacket.examples.ntlmrelayx
    
    * Minor fixups in imports and cosmetic changes as well. There's some more code cleaning and variable naming left.

commit 8fa21746e4395b38664f5bbb4700357a95daf489
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:33:08 2016 -0300

    Imports fixups and minor cosmetic changes

commit 806ce6905a5c669300e8ce315ae1198242372151
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:13:21 2016 -0300

    Empty file

commit cd97e0f8226b819a76e67e822e2dc2320b9c595e
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:03:06 2016 -0300

    Fixed wrong structure sent to SMBClient preventing SMB Relay
    
    * Instead of rawtoken (didn't exist) it must be SPNEGO_token
    * Import fixups and minor cosmetic changes

commit c5c50bf2085d07b36b15af31e2187bd92a4ed68a
Merge: d96a537 24dfd3a
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 16:41:22 2016 -0300

    Merge branch 'master' of https://github.com/fox-it/impacket into fox-it-master

commit d96a537059e47131dd79ce05585a41e01aad3b13
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 16:39:35 2016 -0300

    Adding lastLogon to the output as well

commit 24dfd3a4226469f37cd889bef90ba76bd3d60916
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Fri May 27 12:35:10 2016 +0200

    ntlmrelayx

commit 6ab19e5fbe6e4fd4f4c793c69b7bdb0ae887d1a9
Author: asolino <bethus@gmail.com>
Date:   Thu May 26 22:20:45 2016 -0300

    No need to close the SMB Connection

commit f5a053ac38f079787d6d65797d129cbb38286bf2
Author: asolino <bethus@gmail.com>
Date:   Thu May 26 22:17:39 2016 -0300

    Improving the LDAP search filter to minimize traffic
    
    * We're now asking for:
    (&(servicePrincipalName=*)(UserAccountControl:1.2.840.113556.1.4.803:=UF_NORMAL_ACCOUNT)(!(UserAccountControl:1.2.840.113556.1.4.803:=UF_ACCOUNTDISABLE)))
    Basically will return the normal accounts, not expired, that has an SPN set.

commit 855561685eefa837c875ab7b45e6db0f1221cb4a
Author: asolino <bethus@gmail.com>
Date:   Thu May 26 22:10:32 2016 -0300

    Changing Kerberos auth mechanism from GSSAPI to GSS-SPNEGO plus minor fixed
    
    * Solves the issue of kerberosLogin still not working after pyasn1 upgrade (https://github.com/CoreSecurity/impacket/issues/162)
    * LDAP search accepts sizeLimit now
    * Better error descriptions
    * Fixed some LDAP ASN1 definitions

commit f978950f33e712459c0f08d07a98fbecb02096f8
Author: asolino <bethus@gmail.com>
Date:   Thu May 26 22:08:46 2016 -0300

    Socket more meaninful information when socket operation failed
    
    * Good for realizing there's a DNS resolve issue

commit 46bbd3ddee56ea39d3796e8581ae8eb01f631b88
Author: asolino <bethus@gmail.com>
Date:   Thu May 26 22:04:29 2016 -0300

    Parsing MSRPC_FAULT as probably response during bind() operation
    
    * Win 2012R2 sends MSRPC_FAULT instead of MSRPC_BINDNAK

commit 2408f3aed454f6c42a5ccb7b09526ef88941481d
Author: asolino <bethus@gmail.com>
Date:   Tue May 24 23:38:38 2016 -0300

    Making it work with pyasn1-0.1.8
    
    * kerberosLogin still doesn't work tho. Don't know exactly why
    * Partially address https://github.com/CoreSecurity/impacket/issues/162
    * Works with pyasn1-0.1.7 as well

commit a8576c017295b39915af1b2ff2874d19a3b83a77
Author: asolino <bethus@gmail.com>
Date:   Fri May 20 21:16:15 2016 -0300

    Reformatting some code

commit 0b1a28bfdd53466b9bed502a0740d6fe8aab8b6b
Merge: caf47e5 bc83d98
Author: asolino <bethus@gmail.com>
Date:   Fri May 20 16:24:37 2016 -0300

    Merge branch 'mgeeky-master'

commit bc83d9870f3d8e255a563cf481c9351730bf7542
Author: asolino <bethus@gmail.com>
Date:   Fri May 20 16:23:59 2016 -0300

    Using argparse choices to specify -s options

commit 4b81a6a4ed53621ae7322e6775538f9ab909f8e5
Author: asolino <bethus@gmail.com>
Date:   Fri May 20 16:14:50 2016 -0300

    No need to create the dictionaries with STATUS messages
    
    * We have them in nt_errors.ERROR_MESSAGES

commit d7bcae1c08a32e3bc4718f87ca440ba312754b12
Author: Mariusz B <mariusz.bit@gmail.com>
Date:   Wed May 18 18:35:26 2016 +0200

    Forgot to add default return status values in case setReturnStatus was not invoked.

commit 23e44f1869de5f04a23ba1c910f2179dd60b51e7
Author: mgeeky <mgeeky@users.noreply.github.com>
Date:   Wed May 18 17:44:03 2016 +0200

    Added logging of the status code returned to the connecting client.

commit b1af0b52cb54a5ecfb5968e5b69e83049f3846c9
Author: mgeeky <mgeeky@users.noreply.github.com>
Date:   Wed May 18 17:43:19 2016 +0200

    Added some comments and input parameter value validation

commit a8354a1b7424a0bac07a520870f957a8dffeaa6f
Author: mgeeky <mgeeky@users.noreply.github.com>
Date:   Wed May 18 17:42:31 2016 +0200

    Added option to specify return status code after connecting client's successful authentication (relayed). This will be useful in cases in which we do not want to let connecting client store credentials that succeeded (i.e. remember them and proceed with successful authentication). There are some cases in which we may want to inform the client that his credentials were invalid (STATUS_LOGON_FAILURE) where in fact they went through. Also, we may mislead the client with information that the Access is Denied when authentication to e.g. ADMIN$ share at the server.

commit caf47e5f76d27b8e2c23ad40a75bc96920ea8434
Author: asolino <bethus@gmail.com>
Date:   Mon May 16 09:23:23 2016 -0300

    Fixes broken connection if -dc-ip is not specified
    
    * Introduced in latest commit. Should work now

commit 5fa74d87f2e5df69fb71e6d81b312b46c9801dfd
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 20:44:00 2016 -0300

    Reformating code

commit d4d6de0edf373322bddeef8b571eaa2f7da8b64e
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 19:54:28 2016 -0300

    Making DCERPC/LDAP/Kerberos IPv6 compliant
    
    * Looks like IPv6 is still not used much ;). These tiny things were preventing IPv6 from working at the DCERPC/LDAP/Kerberos layers.
    * SMB was working correctly

commit 2a36f54dd8b767113fc42d3117e8a3a30deb9959
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 19:23:27 2016 -0300

    Adding more statements into the try: execept.
    
    * It wasn't behaving well when no stringbinding was chosen for target

commit 01ad6ac79d344a0ba2c69f6c8893ce8ecfd2ccca
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 19:17:57 2016 -0300

    Warn if we couldn't find a valid string binding.. Shouldn't be common

commit 8d8aab419fa17ce7d922a307f1c7ed0ed8e0b130
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 18:47:15 2016 -0300

    Empty domain check fixed

commit b6f28459970a4fc0a63dce9323da97287ada1322
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 18:46:20 2016 -0300

    Reformating code
    
    * To keep it within 80 chars wide
    * Empty domain check fixed

commit 21a58e81d95a9b6e609290fdb7640d341025139d
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 18:29:34 2016 -0300

    Improved stringBinding selection
    
    * As reported in https://github.com/CoreSecurity/impacket/issues/158, there could be some instances where the wrong stringBinding would be chosen.
    * Testing needed to verify it's now working well

commit 061917c20430908b702a707e0c5b200375cc1c7d
Author: asolino <bethus@gmail.com>
Date:   Sat May 14 16:30:41 2016 -0300

    Adding -save parameter
    
    * Saves each TGS downloaded in ccache format. Why? If we later on crack any password we can just edit that one and make it silver

commit 75c647513bc124d7a8a7664ff161e04774e00172
Author: asolino <bethus@gmail.com>
Date:   Sat May 14 16:29:34 2016 -0300

    Replacing class variables for instance variables
    
    * Don't know why I did it this way to begin with. Not needed

commit 14010a4142004e5a048481b99f5911bfe03c0a92
Author: asolino <bethus@gmail.com>
Date:   Sat May 14 15:47:16 2016 -0300

    -dc-ip parameter moved to the authentication group
    
    * makes more sense. Should do the same for goldenPac and probably and this option for all scripts

commit 9d717a318a888aa1659385f724e0f90c7fa8a62e
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 20:35:09 2016 -0300

    This script should now work w/o requiring DNS resolution
    
    * Even if Kerberos authentication is specified

commit a1117e84ff2c300773d2faed72262f4558a03ef0
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 20:20:56 2016 -0300

    Fixes small typo
    
    * It was copied from goldenPac.py

commit 0d73b2c858ca3e46ad6b89ef4dcb1f76920b03d7
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 20:17:07 2016 -0300

    Adding -dc-ip command line option
    
    * Allows specifying what the IP for the domain is.
    * It assumes the DC and KDC resides in the same server
    
    e.g.
    ./GetUserSPNs.py -dc-ip 172.16.123.170 -request freefly.net/normaluser

commit fcf0c2ad8f52c277bd9072da93b7028607d6ba97
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 19:24:46 2016 -0300

    Fix when dumping CLEARTEXT password for machine accounts
    
    * We won't utf-16 decode them, we will just print it in hex

commit 162b23bf0b8c24d2ce7388793a79b428780ea617
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 19:18:01 2016 -0300

    Fix error when passing NTLM hashes for authentication

commit eaf8a03251e4fb87af289e9ba33eaebaa6617a0f
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 19:07:30 2016 -0300

    Adding -request and -outputfile options
    
    * -request picks SPNs for unique usernames and outputs JtR/hashcat format
    * -outputFile, well.. outputs to a file for later cracking :)
    
    Sample usage:
    ./GetUserSPNs.py freefly.net/normaluser7 -request -outpufile /tmp/hashes.txt

commit 2a185c1ecc0b0a56467f12dfccbd5672ed95adaa
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 12:47:08 2016 -0300

    Adding GetUserSPNs (part of Kerberoast attack)
    
    This module will try to find Service Principal Names that are associated with normal user account.
    Since normal account's password tend to be shorter than machine accounts, and knowing that a TGS request
    will encrypt the ticket with the account the SPN is running under, this could be used for an offline
    bruteforcing attack of the SPNs account NTLM hash if we can gather valid TGS for those SPNs.
    This is part of the kerberoast attack researched by Tim Medin (@timmedin) and detailed at
    https://files.sans.org/summit/hackfest2014/PDFs/Kicking%20the%20Guard%20Dog%20of%20Hades%20-%20Attacking%20Microsoft%20Kerberos%20%20-%20Tim%20Medin(1).pdf
    
    Original idea of implementing this in Python belongs to @skelsec and his
    https://github.com/skelsec/PyKerberoast project
    
    This module provides a Python implementation for this attack, adding also the ability to PtH/Ticket/Key.
    Also, disabled accounts won't be shown.
    
    ToDo:
    [ ] Add the capability for requesting TGS and output them in JtR/hashcat format
    [ ] Improve the search filter, we have to specify we don't want machine accounts in the answer
        (play with userAccountControl)

commit 501ef71b737ebef4928d655eeb21e52ceba859af
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 12:44:36 2016 -0300

    Adding ldap directory to the setup.py for library installation

commit 53477252e67bab62d86e571b04d91d7ff8d74917
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 12:39:59 2016 -0300

    Adding a minimalistic LDAP implementation
    
    * Supports ldap and ldaps
    * Supports Pass the hash, ticket and key
    * Only search is available (and you need to build the search filter yourself)

commit 375b9972dc5696a1967df56a3cec3d87c64b9a47
Author: asolino <bethus@gmail.com>
Date:   Sat May 7 16:54:43 2016 -0300

    Changes the output filename based on the share specified.
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/156
    * Debug message added

commit 34e5a814ce37fa43aae6168b423185cc6b9347cd
Author: asolino <bethus@gmail.com>
Date:   Fri May 6 15:39:23 2016 -0300

    Updated test cases

commit f8b900f2a8adae3dbfb79c123f76f2b57a2022a3
Author: asolino <bethus@gmail.com>
Date:   Fri May 6 14:56:46 2016 -0300

    Remaining fixes for ERROR_DS_DIFFERENT_REPL_EPOCHS
    
    * Test cases and raiseChild were also affected

commit 106934377c2ea4d41458d97f42807057b97250ec
Merge: 5b92375 4ee5c84
Author: asolino <bethus@gmail.com>
Date:   Fri May 6 14:44:17 2016 -0300

    Merge branch 'skelsec-master'

commit 4ee5c841263ba5c7ecab2a542cf064180931b183
Author: asolino <bethus@gmail.com>
Date:   Fri May 6 14:43:05 2016 -0300

    Creating new cipher based on received keytype
    
    * This was preventing pass-the-key attacks to work

commit ea0a1e364aa863cbe8fba772ec0036d873c6ed58
Merge: 5b92375 63c4aaf
Author: asolino <bethus@gmail.com>
Date:   Fri May 6 13:29:28 2016 -0300

    Merge branch 'master' of https://github.com/skelsec/impacket into skelsec-master

commit 5b92375f9f0143fbc5cef49294d86ae2c6aa788c
Author: asolino <bethus@gmail.com>
Date:   Thu May 5 11:35:54 2016 -0300

    pwdLastSet is also included in the output file
    
    * According to @mubix this won't interfere with JtR :)

commit b6b2b1db7cd4ffbf38ed2e905b047daa8d6bc19a
Author: asolino <bethus@gmail.com>
Date:   Thu May 5 11:23:52 2016 -0300

    More debug messages added

commit bcff6bc38cf8441723f06c307e68aaa6f40b31dc
Author: asolino <bethus@gmail.com>
Date:   Thu May 5 10:54:15 2016 -0300

    Adding more debug information for helping troubleshooting

commit 63c4aaf5f4ea38ff9218fdf231c098a5026f49b9
Author: skelsec <info@skelsec.com>
Date:   Thu May 5 13:05:32 2016 +0200

    TGS Request sessionkey type update
    
    Here we should use the type that we got back from the server.

commit 5db6cf60cf3acd8c55136da33c6d7a68389787a5
Author: skelsec <info@skelsec.com>
Date:   Thu May 5 13:01:34 2016 +0200

    TGS Request ETYPE field values
    
    etype field here MUST contain rc4_hmac in a windows environment, or the response will be KDC_ERR_ETYPE_NOSUPP.

commit a489c032f2cc2748bb91ae6b24d28308ea210a2b
Author: asolino <bethus@gmail.com>
Date:   Sun May 1 21:21:14 2016 -0300

    Extra line removed. Cosmetic

commit 7c34db9948dd48275d85b6cee7675a2ac1d079b9
Author: asolino <bethus@gmail.com>
Date:   Sun May 1 21:14:45 2016 -0300

    Fix ERROR_DS_DIFFERENT_REPL_EPOCHS when running against a domain with dwReplEpoch != 0
    
    * By default we set dwReplEpoch to 0 when calling DRSBind(). If this call's answer specifies a different dwReplEpoch, then we call DRSBind again with the right one. Otherwise calls will fail later.
    * Thanks @gentilkiwi for reporting it in impacket, @MichaelGrafnetter for reporting it to mimikatz and @rmbolger for reporting it DSInternals :)

commit b05feb2f5aefb1d434f48727785b16b07fd518a5
Author: asolino <bethus@gmail.com>
Date:   Sun May 1 20:32:56 2016 -0300

    Updated test cases
    
    * Added test cases for packet fragmentation and session security (both Kerberos and NTLM)
    * Simplified the structure of the test cases

commit bba72c234ba694cf7b70c94ce1a3a240990d3b1a
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 29 19:58:17 2016 -0300

    Packet fragmentation review
    
    1) Checks the right PDU len based on user input (if set using set_max_fragment_size()) or BIND_ACK answer (max_rfrag)
    2) Fixed wrong signature/encryption calculation when using Kerberos and fragmentation enabled.
    3) Header flags renamed based on C706 standard
    4) Will probably address https://github.com/CoreSecurity/impacket/issues/137

commit 7c49b28ff5a18702f87684d844fdfce127a451a1
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 15 13:14:01 2016 -0300

    Few fixes to SMB Test cases
    
    1. Fix readwriteFile testcase to support large reads
    2. getServerName converting to upper case when comparing
    3. Credentials are now taken from dcetests.cfg (we should change the name in the future)

commit dc4606822e489e62d276bc3c928af31cd860f4a0
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 15 13:09:42 2016 -0300

    STATUS_USER_SESSION_DELETED when downgrading from SMB2_DIALECT_30 to SMB2_DIALECT_21/SMB2_DIALECT_002
    
    * Since we're not supporting multichannel, we're taking the approach described at http://linux-cifs.vger.kernel.narkive.com/WffA8Jw5/status-user-session-deleted-auth-problems-when-downgrading-from-vers-3-0-to-vers-2-0-2-1 by simply randomizing the ClientGUID when negotiating the protocol.
    * This code was triggering the issue:
    
    from impacket.smbconnection import *
    
    USERNAME = 'Administrator'
    PASSWORD = 'admin'
    TARGET = '192.168.1.1'
    
    s1 = SMBConnection(TARGET, TARGET)
    s1.login(USERNAME, PASSWORD)
    
    s2 = SMBConnection(TARGET, TARGET, preferredDialect=SMB2_DIALECT_21)
    s2.login(USERNAME, PASSWORD)
    
    print "ALL GOOD"

commit 49a07a5fa7372abd7a6b5eeec8d039b1add4e86d
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 11 10:58:16 2016 -0300

    Retrieve user principal name from CCache file
    
    * When https://github.com/CoreSecurity/impacket/pull/144/files was merged we forgot to also add
    that support to the getKerberosType1 method.
    * Will probably fix https://github.com/CoreSecurity/impacket/issues/149, needs testing.

commit 19d7cfca5797635abc251324449945ead65c4052
Merge: de8b255 e42d8e1
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Mar 30 09:29:27 2016 -0300

    Merge pull request #146 from byt3bl33d3r/master
    
    UnboundLocalError in smbconnection.readFile() when recieving STATUS_END_OF_FILE error

commit e42d8e183a8766d49c799348db17b9d0e656ec0a
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Mar 29 23:43:31 2016 -0600

    Fixed while loop in smbconnection.read() when STATUS_END_OF_FILE is received

commit de8b2556789a2e78cd0a16e38f40bc567a6873c9
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 29 16:54:17 2016 -0300

    Fixes offline dump of SAM hashes (no NTDS.DIT)
    
    * This was broken at https://github.com/CoreSecurity/impacket/commit/bbff44d1fc555e2de2ffeef1e9f7bb89afd2946b
    * A proposed solution was PRed here https://github.com/CoreSecurity/impacket/pull/145 . This is basically the same with samller changes
    * Thanks @MrTchuss for finding this!

commit 3b819e2fdea5161d664f9b04cdb89d4a0e8179b5
Merge: 0df0100 9430507
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Mar 28 11:51:26 2016 -0300

    Merge pull request #144 from MrTchuss/master
    
    Retrieve user principal name from CCache file

commit 0df0100998736d949ca9cd8c7e7b2d829952afdc
Author: asolino <bethus@gmail.com>
Date:   Sun Mar 27 15:18:18 2016 -0300

    Honoring extended_security parameter in SMB.neg_session()
    
    * When we did the SMBv1 Unicode support (https://github.com/CoreSecurity/impacket/commit/328caf150446658ec2621e7a2cd28e6c39cc8da0) we changed the default flags1/flags2 from `0` to `SMB.FLAGS2_EXTENDED_SECURITY | SMB.FLAGS2_NT_STATUS | SMB.FLAGS2_LONG_NAMES`. We forgot tho, to change the behavior en SMB.neg_session() when `extended_security` was set to False. What was happening was the `FLAGS2_EXTENDED_SECURITY` was never removed.
    * This was preventing establishing negotiations with `FLAGS2_EXTENDED_SECURITY` set to False (aka standard security). In particular this was breaking the SMB Reflection use case.

commit 9430507030c931d4edf2465e4411e43719c344be
Author: MrTchuss <mrtchuss@users.noreply.github.com>
Date:   Sat Mar 26 21:07:54 2016 +0100

    Retrieve user principal name from CCache file
    
    If needed, retrieve user and domaine information from KRB5 CCache file.
    This simplifies examples command-line, as user only needs to export
    KRB5CCNAME environment variable after a successful authentication using
    kinit and do not need to specify user principal name on command line:
    $ export KRB5CCNAME=/tmp/krb5cc_1000
    $ smbclient.py -k win2012-dc1.vulnerable.local

commit 04d392083a8621e1f81449f73599ec2238aaf1c6
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 25 23:01:47 2016 -0300

    If we cannot decode Unicode let's print the data w/o decoding
    
    * This could happen when SMB Reflecting against old OSes.

commit c6fb099ba27f978ab762226dffc688f034c3754c
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 25 22:59:41 2016 -0300

    If NT ERROR string is not found just print the error code

commit a71e6bb0f9b04251009f3b995571c03a1dfcb0f8
Merge: 6d42da9 ed375b9
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Mar 24 19:51:01 2016 -0300

    Merge pull request #142 from rrerolle/master
    
    SMB3.create: use proper method to determine SMB2 and SMB2Create headers sizes

commit ed375b97d19575970e6c1d873f28620238488053
Author: RÃ©mi RÃ©rolle <remi.rerolle@gmail.com>
Date:   Thu Mar 24 16:53:51 2016 +0100

    SMB3.create: use proper method to determine SMB2 and SMB2Create headers sizes
    
    This prevents from needing a commentary to explain what those hard-coded values
    stand for.

commit 6d42da9003d28bd6ab3446396c65d9f60de16848
Merge: 518abf3 df4c955
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Mar 23 14:31:00 2016 -0300

    Merge pull request #140 from rrerolle/master
    
    SMB3.create: define CreateContextsOffset and CreateContextsLength when applicable

commit df4c95522d406455011e9f77c699fb84db891d1d
Author: RÃ©mi RÃ©rolle <remi.rerolle@gmail.com>
Date:   Wed Mar 23 17:54:45 2016 +0100

    SMB3.create: define CreateContextsOffset and CreateContextsLength when applicable
    
    When providing createContexts in a SMB3 create call, the buffer is set
    accordingly, but not the offset and length fields. This causes the createContext
    data to be ignored by the server.
    
    This patch tries to fix this by specifying the offset and length. The offset is
    determined by adding the size of the SMB2 and CREATE_REQUEST headers to the
    name length.

commit 518abf375538f0ed80b84b95fa26e211f78bf80c
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 11 13:19:43 2016 -0300

    Reverting back previous commit. Problems with some Windows clients
    
    * More research needed. OSx clients now only works if GUEST connection set.

commit b05b4703e702a6e6c48b423d2a7fea05fdab3768
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 11 13:09:50 2016 -0300

    Setting GUEST flag only if username is 'GUEST'
    
    * This is OSx specific in order to make it work when an OSx client wants to log in with a username/password

commit 3e768cc89080a06b735eed05c0e36e354cd8a86e
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 11 11:49:48 2016 -0300

    Clear NextEntryOffset when SL_RETURN_SINGLE_ENTRY is received
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/136

commit 1f98352aa1b51048e55ea8ddfa356cdde1c30b06
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 8 15:58:26 2016 -0300

    Fixing https://github.com/CoreSecurity/impacket/issues/135
    
    * LOG line left there just in case logging is active already.

commit 9494af8cd8bdb0eb44b20840aaf3f1b67dca49e1
Author: asolino <bethus@gmail.com>
Date:   Wed Mar 2 18:01:35 2016 -0300

    Better controls strip leading '/'/'\\' when running the server in Windows
    
    * Regardless of the share configured, it was always showing the root drive contents (when ran on Windows)

commit 682ce151ddda2f2fd713546cbbec2ce28f79d032
Author: asolino <bethus@gmail.com>
Date:   Mon Feb 29 16:59:04 2016 -0300

    Exposing SMBSERVER in SimpleSMBServer class
    
    * registerNamedPipe, unregisterNamedPipe and getRegisteredNamedPipes
    * Might be helpful if you want to create custom named pipes handlers thru the SimpleSMBServer

commit 1ef7978fe9d0d3baecb702ed2a77e55925e46821
Author: asolino <bethus@gmail.com>
Date:   Mon Feb 29 16:32:51 2016 -0300

    Replacing NTLMSSP_NEGOTIATE_NTLM2 for NTLMSSP_NEGOTIATE_EXTENDED_SESSIONSECURITY
    
    * Makes it easier to understand [MS-NLMP] when you're reading alongside our code

commit 79dda7fcbecb3e7d3e744ae5e4c181871f7ad212
Merge: e8dc587 2e914bb
Author: asolino <bethus@gmail.com>
Date:   Fri Feb 26 10:38:35 2016 -0300

    Merge branch 'gadio-master'

commit 2e914bbbf3cafcf82942a637111a4a39a81c9a81
Author: asolino <bethus@gmail.com>
Date:   Fri Feb 26 10:37:24 2016 -0300

    Changing -auth-level-pkt-privacy to -rpc-auth-level
    
    * By default it just let the runtime to decide what's best
    * Added option to enforce packet integrity as well

commit 49b9631104faa508e94496144b33771d462b3c89
Author: Gadi Oren <dbaspdp25g@snkmail.com>
Date:   Sun Feb 14 15:23:03 2016 -0500

    Allow setting packet privacy authentication level

commit e8dc587dab030787f2b2a23afebebae785e8018e
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 3 11:29:23 2016 -0300

    Minor improvements
    
    1) When ran With no parameters, now it runs in reflection mode and dumps target's hashes
    2) When relaying to 127.0.0.1, it's ok not to have a username. Especially important for hot potato attack
    3) Better control of exceptions when authentication succeded

commit 22313cc590b33218a4344e7c7ea48983f00ba89f
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 28 19:07:39 2016 -0300

    Adjusting NegotiateFlags to [MS-NLMP] 2.2.2.5 description
    
    * Check out your code if you were using these flags since names got changed
      according to the standard

commit a358566c98010fc0acc0779fd87980ef4adaac93
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 27 18:08:26 2016 -0300

    Adding -just-dc-user switch to download just a single user data (DRSUAPI mode only)
    
    * Similar to @gentilkiwi's DCSync functionality
    E.g.
    python secretsdump.py Administrator:admin@172.16.123.1 -just-dc-user krbtgt
    
    Impacket v0.9.15-dev - Copyright 2002-2016 Core Security Technologies
    
    [*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
    [*] Using the DRSUAPI method to get NTDS.DIT secrets
    krbtgt:502:aad3b435b51404eeaad3b435b51404ee:bf11f756a7cd1a29a9abd8ccc918a805:::
    [*] Kerberos keys grabbed
    krbtgt:aes256-cts-hmac-sha1-96:44b77486dd383d7177207bb7393f4ec4176fb80be7dcf5c598221a7a039bc2e9
    krbtgt:aes128-cts-hmac-sha1-96:2eb877b16640e7f60adb362c8e482f11
    krbtgt:des-cbc-md5:4610ea7024fff562
    [*] Cleaning up...

commit 1645f43ccf676ddb234c231816bf22d5ceca3c61
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 12 16:36:58 2016 -0300

    Upgrade Copyright

commit aa8bda15ebd49ce3aebb2691ccd1e8221aa7d885
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 11 18:29:46 2016 -0300

    Typo fix

commit 1cdc5ce8afff9236140edab1229a15e02cbf09d6
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 11 18:12:15 2016 -0300

    Adding support for Win2016 TP4 in LOCAL or -use-vss mode
    
    The main things that changed when raw parsing the NTDS.DIT are:
    1. The encryptedPEK header changed from '\x02\x00\x00\x00' to '\x03\x00\x00\x00'. Instead of
       using MD5 / RC4 it now uses AES to decrypt the PEK lists. Right now I only support 1 PEK
       key until I can repro having more than a key on this OS. Maybe @s0crat can help here ;).
    2. The decrypted PEK list is different from previous versions and the PEK Key sits in the
       middle of the decrypted buffer. I still need to understand what the other bytes are for.
    3. When decrypting NTHashes and supplemental information, the structure header changes from
       '\x11\x00\x00\x00' to '\x13\x00\x00\x00'. Instead of using RC4 it now uses AES. The
       structure here is a little different too, whereas the buffer for decryption starts 4
       bytes after a similar buffer in pre Win2016 TP4.
    
    Lot's of testing needed. Later on I'll work on simplifying the code.
    
    * Big thanks to @gentilkiwi for telling me about the issue and also giving me important info to come up with the solution.
    * DRSUAPI mode (the default one) worked out of the box
    * Moved __descryptAES to CryptoCommon since it's used on a few more places

commit f33daa056fd7cee38c2d65fdb42624ecaae09704
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 7 13:11:55 2016 -0300

    Going back to dev version

commit 67fc19e9996148add1b1e2a8b912fe8c95b51692
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 7 12:35:14 2016 -0300

    Updated Changelog

commit 0d34fd9365765c8c1d25e77393646d91d84da28a
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 7 11:12:01 2016 -0300

    Upcoming version

commit 8c04d9697939172c9159af92ddd0eded221f2106
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 14:08:30 2016 -0300

    Updating copyright notice. Welcome 2016

commit ac31fea5c1578e37eace0df83f1c2bf05350140e
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 13:25:31 2016 -0300

    Removing old DCERPC runtime files.
    
    * Scripts still using this old runtime should port to impacket.dcerpc.v5 classes
    * All examples should be using V5

commit 118688065e062e5f28307015d120b4ef4b1a3dd3
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 11:25:32 2016 -0300

    Moving KNOWN_UUIDS to epm.py before ditching the old dcerpc runtime

commit a4dc7d52f6ad3851ea29bbcf8938611df061eec1
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 11:21:47 2016 -0300

    Moving KNOWN_UUIDS to epm.py before ditching the old dcerpc runtime

commit 638a235b47157183cdc1cba940dfc9cb94c7fb28
Merge: 1140d51 e4d4863
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 10:28:54 2016 -0300

    Merge branch 'byt3bl33d3r-master'
    
    Thanks @byt3bl33d3r!

commit e4d4863430279b8b744e830a96bcddc8a0698562
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 10:27:27 2016 -0300

    Grabbing and printing command output when using -c switch
    
    * Also removing temp file

commit 5c6a3aee8ca6e506d2f4f4ebfd3c0fc6693e7ac5
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Jan 5 19:28:04 2016 -0700

    added option to execute commands in smbrelayx.py

commit 1140d519495e6d797d40e2b6db206f02e683b7d0
Merge: 1ef6af5 cb69715
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jan 5 13:00:06 2016 -0300

    Merge pull request #123 from mubix/patch-1
    
    Add Domain Admins RID

commit cb697154c084c265ad9f9537c62590dd46e41e1b
Author: Rob Fuller <jd.mubix@gmail.com>
Date:   Tue Jan 5 10:47:20 2016 -0500

    Add Domain Admins RID
    
    Source: https://msdn.microsoft.com/en-us/library/cc223144.aspx

commit 1ef6af5ac2493a93bcaee42f2af79df39b98cf6c
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 17 16:40:09 2015 -0300

    Minor cosmetic changes

commit b4c43aba5cdb8edc21a046263eb902885bfdc547
Merge: 270dcce 88ccb48
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Dec 17 09:00:55 2015 -0300

    Merge pull request #120 from sjitech/master
    
    smbclient.py: "cd" command failed to enter JUNCTION or read-only direâ¦

commit 88ccb48f2758caf2ff6e145da5bab426ab588ea2
Author: q <osexp2003@gmail.com>
Date:   Thu Dec 17 19:20:16 2015 +0900

    smbclient.py: "cd" command failed to enter JUNCTION or read-only directory

commit 270dcce3f2ff50106adab3c7a299d8549f67112f
Merge: 0999641 08caa1d
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 15 12:02:45 2015 -0300

    Merge branch 'sjitech-master'

commit 08caa1d6ee153af83ab02b87ba017450a429a985
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 15 11:51:07 2015 -0300

    Small change to decide when to disconnect a DCE connection

commit 616bdf952d7cc299d1dd4585ed4b6452fcb7f8bc
Merge: 0999641 264ac83
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 15 11:43:27 2015 -0300

    Merge branch 'master' of https://github.com/sjitech/impacket into sjitech-master

commit 264ac838c5c75a28cddaa5956c8e68fa419ff496
Author: q <osexp2003@gmail.com>
Date:   Tue Dec 15 09:50:05 2015 +0900

    let hept_lookup use existing SMB transport if specified, instead of always use TCP 135 port

commit 0999641aea3633c3a80407424178b2496ab4fc4f
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 14 14:36:32 2015 -0300

    Extending NdTable's data to more than 16 properties
    
    * NdTable is an encoded table that represents the behavior of the default value of properties in a CIM class. ([MS-WMIO] Section 2.2.26
    * The implementation I had was limiting the amount of parameters to pack when marshalling a class/instance to 16.
    * Now it should support the amount of properties defined by the class.
    * I'm still not sure tho, the encoding I'm using is the right one. [MS-WMIO] does not specify this.
    * Found this while addressing https://github.com/CoreSecurity/impacket/issues/117

commit e13e0baa1ac9973eb4df85e6be0af2a2e975bdd3
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 3 10:09:58 2015 -0300

    DCOM INTERFACE Connections are not reused by different threads
    
    * Reusing them could trigger out of sync issues. Instead, a new connection is created by each thread.
    * This aims to fix https://github.com/CoreSecurity/impacket/issues/114

commit 1f8370e56b01cb183dee03e2a150302810a81925
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 30 15:49:07 2015 -0300

    Applying @jammer3d patch to fix https://github.com/CoreSecurity/impacket/issues/108
    
    Thanks and sorry for the delay!

commit 5851bd0cb903a91db0db8d225ee85be8cf2b734d
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 26 14:55:19 2015 -0300

    Applying @0xsauby fix for password with '@' to the rest of the example scripts

commit f1d5337aae359615aa891fa2f83d49ad349540de
Merge: 836463b 6913c13
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 26 14:48:46 2015 -0300

    Merge pull request #112 from 0xsauby/master
    
    Broken auth, thanks @0xsauby!

commit 6913c1327005cc49067f2974b9d7c95046d0d15a
Author: Saurabh Harit <0xsauby@users.noreply.github.com>
Date:   Fri Nov 20 02:52:20 2015 -0500

    Fixed the issue where a password with '@' breaks authentication
    
    Since impacket scripts use '@' as delimiter between the password and the IP address, a password with '@' (eg. 16char@Password) breaks the authentication.

commit 827a5594bf00ab54d447fc7b793c4165a15885c3
Author: Saurabh Harit <0xsauby@users.noreply.github.com>
Date:   Fri Nov 20 02:51:17 2015 -0500

    Fixed the issue where a password with '@' breaks authentication
    
    Since impacket scripts use '@' as delimiter between the password and the IP address, a password with '@' (eg. 16char@Password) breaks the authentication.

commit df661f4c145dbc3d861fce222d931446f602e8b6
Author: Saurabh Harit <0xsauby@users.noreply.github.com>
Date:   Fri Nov 20 02:48:27 2015 -0500

    Fixed the issue where a password with '@' breaks authentication
    
    Since impacket scripts use '@' as delimiter between the password and the IP address, a password with '@' (eg. 16char@Password) breaks the authentication.

commit 6e4a78a33d502ebd23fb5f6b27c281179a5d6fd1
Merge: 86c0743 97f0412
Author: 0xsauby <saurabh.harit@gmail.com>
Date:   Fri Nov 20 02:37:47 2015 -0500

    Merge branch 'master' of https://github.com/0xsauby/impacket

commit 86c07438310d360156d14c2c0edbd04dcd772531
Author: Saurabh Harit <0xsauby@users.noreply.github.com>
Date:   Fri Nov 20 02:19:15 2015 -0500

    Fixed the issue where a password with '@' breaks authentication
    
    Since impacket scripts use '@' as delimiter between the password and the IP address, a password with '@' (eg. 16char@Password) will break auth.

commit 97f0412f3e0a658703fd33e5dd6111d40cb191b4
Author: Saurabh Harit <0xsauby@users.noreply.github.com>
Date:   Fri Nov 20 02:19:15 2015 -0500

    Fixed the issue where the password with '@' breaks authentication
    
    Since impacket scripts use '@' as delimiter between the password and the IP address, a password with '@' (eg. 16char@Password) breaks the authentication.

commit 836463be6bf19c6e2207d054153570cb112ab42a
Author: asolino <bethus@gmail.com>
Date:   Wed Nov 4 11:40:24 2015 -0300

    Default `SMBConnection.readFile()` to a single SMB call attempt
    
    * That means it cannot be guaranteed all the bytes requested will be read
    * I'll leave it this way until I figure out some incompatibilities with other use cases (e.g. psexec)

commit f544da0e78af708e45c20af6ae7f450ed773e473
Merge: 3e5f763 1677bcf
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 18:54:02 2015 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit 3e5f763e55ed884e841aeeea93fbe277269e7123
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 18:49:35 2015 -0300

    SMBConnection.readFile() now tried to read the amount specified by bytesToRead parameter
    
    * Before, if `bytesToRead` was greater than the protocol's `MaxReadSize` buffer
    (dependant on the server's configuration), it would only read that amount of bytes.
    Now it will call `read_andx`() many times until it reached EOF or read all the bytes asked.
    * See https://github.com/CoreSecurity/impacket/issues/94

commit 1677bcfc7cdc1af264a2a970a9878063e95b8934
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 18:49:35 2015 -0300

    SMBConnection.readFile() now tried to read the amount specified by bytesToRead parameter
    
    * Before, if `bytesToRead` was greater than the protocol's `MaxReadSize` buffer
    (dependant on the server's configuration), it would only read that amount of bytes.
    Now it will call `read_andx`() many times until it reached EOF or read all the bytes asked.

commit 97cb9791326304d7ec6bd1d4c47a7df11950af75
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 18:35:40 2015 -0300

    Adding getIOCapabilities() method, used by SMBConnection object

commit ecb7981993066968d61907e5f723f449f378796e
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 12:27:45 2015 -0300

    No need to specify anything when calling getNTLMSSPType1
    
    * Less prone to encoding errors.

commit c960a8d031280cf07305bd3e28b1df7aec43e94f
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 12:07:53 2015 -0300

    Encoding domain field using utf-16le, as specified in the flags field.
    
    * Fixes https://github.com/CoreSecurity/impacket/issues/107

commit 4da024267f99b20f853d771697c57580195b91e0
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 2 13:45:06 2015 -0300

    Fix for https://github.com/CoreSecurity/impacket/issues/106

commit 35ff60efb14d1259a250d766d7663a90e0419a54
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 2 10:08:30 2015 -0300

    Extra checks when stripping leading '/'
    
    * Well.. let's verify there's a '/' there ;)

commit ad215d32df3ad21ebfa6086f20c236ecd17f3842
Merge: b6716a0 a45ff24
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 29 10:45:39 2015 -0300

    Merge branch 'scriptjunkie-ntlmv1fallback'
    
    Merging @scriptjunkie PR adding fallback parameter to SMB object. (See https://github.com/CoreSecurity/impacket/issues/102)
    
    thanks!

commit a45ff2426c39b9a90364bde02e40f2e36f369f21
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 29 09:46:23 2015 -0300

    Adding ntlmFallback parameter to SMBConnection.login()
    
    * If True it will try NTLMv1 authentication if NTLMv2 fails. Only available for SMBv1.
    * Defaults to True

commit 248aae3234d296605427000bd4d1beebd35f5022
Author: scriptjunkie <scriptjunkie@scriptjunkie.us>
Date:   Wed Oct 28 21:46:24 2015 -0500

    ntlmv2 enforcement option on SMB

commit b6716a0a164c1636fb578e6232320e903e1ab55d
Author: asolino <bethus@gmail.com>
Date:   Sun Oct 25 19:19:13 2015 -0300

    Cosmetic changes

commit 5842d99d7432df94f5adb006e09ab93485591d5e
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 22 15:17:53 2015 -0300

    Whenever -resumefile is specified, that filename is also used to keep updating the session state after resuming.
    
    * Why? If for some reason the connection is closed again (or you Ctr-C the script) the session
    state will be saved in the same file provided. So, in order to resume the session just execute
    the script again with the same parameters. Should be easier.

commit bc25c967d9f062a1445cfaa529286c1e32b187c7
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 21 15:16:16 2015 -0300

    Fixing raise misuse

commit f4be4a6844d04cd3d5a30e851469f5f0a639c881
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 21 08:53:05 2015 -0300

    Raising exception instead of returning None

commit 72b4ca5fdf873d44298d08a0c279f62e56d61047
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 20 12:40:09 2015 -0300

    Removing +x perm

commit 1a525ebb86b09929f37dab85c9bd58fcf8e49e5e
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 20 11:16:50 2015 -0300

    Logging and exporting (optionally) captured NTLM/NTLMv2 encrypted hashes
    
    * Use -outputfile switch
    * Format is John the Ripper compatible
    * It will only log encrypted hashes after a successful authentication and before the actual attack (-e switch or default behaviour of dumping hashes).
    * Developed in the context of https://github.com/CoreSecurity/impacket/issues/100

commit d2abded84ae59594aaabf56311b91c36cd05ad42
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 13 16:34:15 2015 -0300

    Asks whether or not to keep the resume session file if you hit Ctrl-C during DRSUAPI

commit 004c350f2e704e92646bbc4e9b162cf42d42fce2
Merge: 5da9fae 0350006
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 13 14:13:15 2015 -0300

    Merging @s0crat PR #98 adding NTDS.DIT multiple PEK support (https://github.com/CoreSecurity/impacket/pull/98)
    
    Thanks Pierre!
    
    Merge branch 's0crat-master'

commit 03500067d36eac515282ea26748596b2f2b05018
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 13 14:12:05 2015 -0300

    Minor cosmetic changes.
    
    * Just to align existing coding convention

commit 39a0919143d4fc1452e47bfcffdec88acba2bd4b
Merge: 5da9fae 40d2e91
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 13 12:52:07 2015 -0300

    Merge branch 'master' of https://github.com/s0crat/impacket into s0crat-master

commit 40d2e914bdf53a9914f8bd6ae49b57899550ad50
Author: unknown <ptaiani041812@FR09285928D.dsk.eur.msd.world.socgen>
Date:   Tue Oct 13 16:51:01 2015 +0200

    Add support for multiple password encryption keys (PEK)

commit 5da9fae9c0cf77a55e57b805ac79a33e206a1067
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 9 17:46:35 2015 -0300

    Adding queryInfo()
    
    * Queries basic info about an opened file descriptor

commit 8fb3768940e01e74c57274c1748375507905e3be
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 9 17:09:44 2015 -0300

    If UNC is specified in connectTree, we do nothing for SMB1 connections

commit 098296b4ef67fd9281a04f04a7ca7bee0adb8e4c
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 9 16:57:04 2015 -0300

    query_file_info() returns a buffer based on the fileInfoClass parameter
    
    * This is to match smb3.queryInfo()

commit b9b85004e17819fdf302e1177a46c791f09c5c81
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 5 15:32:00 2015 -0300

    Minor fixes for resume capability when using -use-vss flag

commit 18a3c42927dadeec90fc83dc55cfa8614b961fdb
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 5 15:18:19 2015 -0300

    NTDS.DIT resuming capability also works with output files
    
    * If you specified -o xxxx and you suspend the script, everything will be saved.
    * If executed against with -resumefile, the output files will be appended with the new data
    * At the end, you should have the complete set of data in the output files regardless of
      how many times you resumed the script. (assuming you're using the same parameters).
    * This commit is in the context of #85

commit bbff44d1fc555e2de2ffeef1e9f7bb89afd2946b
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 5 09:18:16 2015 -0300

    Keep trying all the secret extraction approaches even if some of them fail.
    
    * You might be able to get hashes w/DRSUAPI and not being able to read SAM (e.g. using a DC machine account)

commit 10a5c954eea1f9c419ca5104f5619386fff7034c
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 2 20:29:30 2015 -0300

    Adding Primary:CLEARTEXT Property from supplementalCredentials attribute
    
    * [MS-SAMR] 3.1.1.8.11.5
    * Available both for DRSUAPI / VSS
    * When using -o a '<outputname>.ntds.cleartext' file is created

commit ae5b1dce67a3d3171b198b769fd89dc7b33892af
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 1 18:27:39 2015 -0300

    Adding resuming capability for NTDS.DIT dump (first try)
    
    * When dumping AD user's hashes/keys (DRSUAPI only) a session file will be created in the current directory
      having the latest SID successfuly processed. Filename is called `sessionresume_XXXXXXXX` (8 random chars)
    * If secretsdump finished succesfully, that file is automatically deleted
    * If the script is killed, or stopped (e.g. hitting Ctrl-C) that file will NOT be removed
    * You can resume the session by running secretsdump with the same parameters and adding the
    -resumefile <filename>parameter
    * You cannot disable secretsdump saving its state to a temporary file (would we want it?)
    * If you specify a resumefile for a different target, you're insane ;). I'm not checking that.
    * This commit is in the context of https://github.com/CoreSecurity/impacket/issues/85

commit c26f17fa00320cbd2ed7ea9fcefb3f0142aac8f4
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 28 12:24:02 2015 -0300

    Enabling dumping hashes/keys for WORKSTATION/SERVER/TRUST accounts by default
    
    * This was disabled in the past since I've got some decoding error reports. After
    all work in the NDR runtime I haven't seen any error again.
    * Please report an issue if some error pops up.

commit 02b083730bc207deacc939347b9495c297f7d14a
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 24 10:42:32 2015 -0300

    Adding debug message when connecting to the KDC

commit 9d4ea5f312229cc7bcb07ed4e674015a9fb261f7
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 23 11:01:33 2015 -0300

    Forgot to disconnect the portmap connection.
    
    * Should fix https://github.com/CoreSecurity/impacket/issues/93

commit 48a97f723a786fd3f0c65f921e9a6d40960e263b
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 23 11:00:30 2015 -0300

    Catching and showing error if lcd fails

commit 1a1e770bf89fac382195f308cdfb2a4daf76abf2
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 23 10:58:57 2015 -0300

    Adding cp437 encoding/decoding
    
    * Still not a final solution for will work much better on some foreign OSes

commit 2af5448b9b556e2071d01c507c2e0bdfe2e47883
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 22 21:43:45 2015 -0300

    Adjust referent data offset by 4
    
    * Since we're advancing 4 bytes first

commit fcbe4fd914250adf89d1d1bad178ae67e1de6a3e
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 18:01:28 2015 -0300

    Removing some debug info

commit e48e2d6c144c073706f9af12f569c0ac30dbf1b7
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 17:53:51 2015 -0300

    Explicitly changing the stdout encoding format if the script's output is redirected

commit 5ab22cf8c06b421f2518c571bad948170e2437c8
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 17:13:32 2015 -0300

    Trying give it a second try if there is a decoding issue happening
    
    * Especially important when dealing with international characters

commit c64a9c565f12668c523cf49e68195ea7445e0b3c
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 16:23:25 2015 -0300

    Using sys.getfilesystemencoding() instead of sys.encoding.stdin

commit b3b0407acb8bd1bf5b2584b782d2d5013a5cfcf6
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 16:09:34 2015 -0300

    Using sys.getfilesystemencoding() instead of sys.encoding.stdin
    
    * Works much better on Windows

commit fafbff2034c9930aaf1f9ea77521f6ccee3ae899
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 15:22:57 2015 -0300

    If the script's output is redirected

commit 1afb844b4b2460ecaf12c20bc99b36e8e6c82e98
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 14:12:33 2015 -0300

    Explicitly changing the stdout encoding format

commit 93b61a6c168daec0ca6dc6e761021ba5b3391612
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 14:06:38 2015 -0300

    Better way to detect no pwdLastSet was set

commit 594105211699835120b45bdcdc0335de96d02975
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 14:00:45 2015 -0300

    All files written are in utf-8 format.
    
    * Might have some consequences on Windows tho.

commit 879a2cf30bcf37632ad21eae76383dc935f88c83
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 17 18:32:52 2015 -0300

    Trying give it a second try if there is a decoding issue happening
    
    * Especially important when dealing with international characters

commit a893be5850b0abab92c9cb1493cc370550034dac
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 17 11:21:28 2015 -0300

    Adding optional -pwd-last-set switch for NTDS.DIT accounts output
    
    * Shows pwdLastSet attribute for each NTDS.DIT account. Doesn't apply to -outputfile data
    * Added a display options group as part of the scripts options (this will likely grow)
    * Some code simplicity change to cope with so many switches

commit 0524363e88f11355b974ebb66a7002bb7b8b3653
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 16 13:38:38 2015 -0300

    Applying same modifications as https://github.com/CoreSecurity/impacket/commit/1f3cbff8df56344ba4d5552b0ddb8f3cb095194d to goldenPac and raiseChild

commit 1f3cbff8df56344ba4d5552b0ddb8f3cb095194d
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 16 08:55:01 2015 -0300

    Fixed error when targeting a 2012R2 DC with AD Recycle Bin enabled
    
    * DRSGetNCChanges() was returning ERROR_REVISION_MISMATCH
    * Problem was in the dwFlagsExt and dwExtCaps of the DRSBind() method
    * Thanks @carnal0wnage for reporting and helping debugging this issue.

commit 8f209f0731b0dff06ab5eb725e53aa8f0562ed68
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 15 22:45:23 2015 -0300

    Adding more debug info to help diagnosing issues

commit 488fddd1221fcf454e8bced7c9d034a1a40945fb
Author: Or Dagmi <or@digmi.org>
Date:   Sat Sep 12 15:15:31 2015 +0300

    Adding ERP and Country elements to Beacon

commit d46cb154e8dd2c1028e717a2e77059605a2ecfeb
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 11 14:39:46 2015 -0300

    We have to add some SMB flags just in case the original client did not
    
    * Why? needed for avoiding INVALID_PARAMETER when calling FIND_FIRST2

commit 37ebbbbb7d219edc099ab77b62b7855d24868956
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 11 13:47:57 2015 -0300

    Testing all DCs in domain and adding forest's enterprise admin group inside PAC

commit 501482862c7c8d561b2ee28c309cccd12328e8b1
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 18:41:56 2015 -0300

    Code optimization
    
    * Taking advantage of previous NDR.fromString() work done (https://github.com/CoreSecurity/impacket/commit/da05308c042c737d64311c336382ae99b25da1a5)

commit 5c6df1b20a488ef80c6b40784aa784b96d343529
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 18:32:54 2015 -0300

    Looping over the GetNCChanges until there's not more data
    
    * This test could take a lot of time to complete, be aware

commit 3cfe3912159be7c938a5eccd3da112e6e127391a
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 17:31:39 2015 -0300

    Removing dup setArraySize() call

commit 6e25540f0d9e8a2ba875b5b0a37f677faf1ef25d
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 15:44:06 2015 -0300

    Code cleanup

commit c6d57a5aed6f3e8da119d2083a50d52762806ea1
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 12:44:16 2015 -0300

    Moving calcUnPackSize() into unpack()
    
    * Makes code way easier to read

commit da05308c042c737d64311c336382ae99b25da1a5
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 12:18:11 2015 -0300

    NDR fromString() now returning bytes processed
    
    * Instead of returning self. Makes things way easier. No need to have getFromStringSize() and arraySoFar.

commit 59af4903bc1ea3f1346a2fc6ea9177c85a8c68a6
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 8 20:36:07 2015 -0300

    Being consistent with what we put inside the try/except clauses

commit 6cebec00f7cf3f09d4112a8df5f021af7f912784
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 7 12:10:24 2015 -0300

    Adding TCPTransport test cases

commit 7c08162c4f508113eec10348c48caad5cad663a0
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 7 12:04:27 2015 -0300

    Adding NDR64 tests

commit 4c8470e20e74591e4478dd1327b720852bb76a1b
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 7 12:00:00 2015 -0300

    Adding the NDR64 testcases. Working now

commit 9b1a71443267f561ecd581684ab8fcd51f2a23a4
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:28:28 2015 -0300

    Adding more test cases to this file

commit 9e98a6803ada9ff1aff3437c2bb8ae404b3de145
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:22:23 2015 -0300

    Wrong branch

commit 144c1f81f604b9c71f5429661c1ee790a8b28f93
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 31 09:19:23 2015 -0300

    Adding NDR64 tests

commit 39c641478d075021e4b3334672868c0a9daef850
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 30 23:52:36 2015 -0300

    NDR Runtime test cases

commit c0c233b17e8a8908cae013e7b9caaf685ee584fc
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 30 23:52:15 2015 -0300

    Adding new testcase for GetNCChanges

commit 7ee5bf3138f85a8b2c48c54742579371ab5fb45a
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 30 23:48:16 2015 -0300

    debug attribute not used anymore

commit 8a265c0c4885c8b5cd2d5b4f8465646e5ebbb68c
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 30 23:47:40 2015 -0300

    Removing some debug messages

commit 15d75ec8a315b0c2570b72a594fdb109fba50bc5
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 30 23:33:31 2015 -0300

    getArraySize() also used in NDRSTRUCT.fromString()

commit 8d53ff2b6aba4b829a0fabe34e73039145ca1c1e
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 19:44:24 2015 -0300

    Not counting arraySize when dealing with NDRUniConformantVaryingArray.
    
    * MaximumCount could be larger than ActualCount

commit ce404d4a791aec3e744fed9732f98a3a472af3df
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 17:44:11 2015 -0300

    With the new NDR runtime we don't need this workaround fix

commit 6dd24d89592e2691097540bf0aca05497332bcf3
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 17:33:39 2015 -0300

    Adding UNKNOWNDATA data type

commit fc2bdb8f3ba7f2d882cb9ea784d636f6715eeaa0
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 17:10:57 2015 -0300

    Enclosing more statements inside try clause

commit b14a7e35af95006d294f29400857a38e18df1c5b
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 16:59:52 2015 -0300

    Missed alignment before the size data

commit 95844c75b3a8aea1ad9a28c048a091b2c80195b3
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 16:22:32 2015 -0300

    Adding getArrayMaximumSize() as a way to manage those situations where MaximumCount != ActualCount

commit 2824cd79fff937c06d6306affb3dd6ee1fc9e188
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 14:24:04 2015 -0300

    Replacing code that is already in NDRCONSTRUCTEDTYPE.getArraySize()

commit abf6511655e5aa0562ab1f84621abb0a85ad355c
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 13:31:31 2015 -0300

    NDRUniConformantArray and NDRUniConformantVaryingArray don't unpack arraySize anymore
    
    * This will need to be done manually and later on update using setArraySize/getArraySize
    * Why? It is more straighforward since the arraySize in structures is always at the begining of
    the structure rather than before the array stream. We had to make some calculations that are prone
    to fail.
    Still not all test cases working tho.

commit 2362e6ae03aae5b3224960bece598d4810e0b73d
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 15:36:54 2015 -0300

    Leaving a single getData/fromString for most of the arrays

commit 8a8fa1691c79c3c6902b81a6a39de73f8de55da1
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 13:28:38 2015 -0300

    Added restrictions for packing/unpacking referent data from arrays

commit 74ced655f40729f9232f1715d4fb43d907e5f142
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 10:31:51 2015 -0300

    Aligning NDRUNION structure when packing/unpacking

commit de0807b5c0d942f86076a2d32d5a46e8fb98be3c
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 09:35:12 2015 -0300

    Adding getAlignment to SCMR handle structure

commit 51c7f2ab07f211fe149259a875645946e8b84454
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 08:57:15 2015 -0300

    Properly prepare the data buffer when dealing with a pointer to an array

commit 423645e04797e0e6a58c07029809b74f4d77f6fc
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 23:16:15 2015 -0300

    Checking arraySoFar inside NDRUniConformantVaryingArray.fromString()

commit 5acd135958aca30157394c7862f0b2656e232a18
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 22:00:59 2015 -0300

    Removing debug message

commit c303ab3ed85708eb1652576f20df0a0c4fca6589
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 21:42:00 2015 -0300

    Adding the now required getAlignment to string structures

commit 71fdd7e7eb313c00321b81b3d05c580c768223ad
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 19:15:45 2015 -0300

    Adding alignment for SAMR_HANDLE

commit 09c325bebd0b71b3bd0d80ea876497b83572b6f8
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 19:09:36 2015 -0300

    Code cleanup + NDRPOINTER strict alignment
    
    * There's some code I won't use for now. If I need it again, I'll rewrite

commit b57e4b515e3fcd1c84ac029aca0a6376d8f8c490
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 16:44:05 2015 -0300

    Code Cleanup

commit e3a6d266a650ceb7ba4ed89bdaaea32f67171027
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 16:30:45 2015 -0300

    Code cleanup
    
    * Removing fromStringOld and calculatePadOld
    * Moving calcPackSize and calcUnpackSize array stuff into NDRCONSTRUCTEDTYPE. Not ideal yet but much better
    than having it inside NDR

commit a50f7ff2f1028b1094dc74069f2df4c5da3342ef
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 16:17:22 2015 -0300

    Code cleanup
    
    * Moving isUnion()/isPointer() to NDRCONSTRUCTEDTYPES
    * Removing array packing from NDR.pack(), was already in NDRArray.pack()

commit e63345bc0cac03a1d70bfe8a4e9b480bd3cb00ee
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 16:12:47 2015 -0300

    Adding a NDRCONSTRUCTEDTYPE class
    
    * Helpful to better organize methods
    * NDR class is only meant for NDR primitive date types
    * Changes some interfaces data types from NDR->NDRSTRUCT

commit 72264b8b8a0c4016f1d12e620366756911288a1d
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 15:56:26 2015 -0300

    Moving NDRCALL down in the file

commit 8c4601c2708c4355eaf6074f0afcadb6f4a27e44
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 15:23:33 2015 -0300

    More padding adjustements
    
    * NDR trailing GAP padding disabling for now

commit 756043352acfd2d0b7dce9b5aa54179f918f489f
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 13:23:13 2015 -0300

    Forgot changing also the data available

commit f44a9eafaa165d8462073110ba192a4c704db3e9
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 13:16:31 2015 -0300

    Checking NULL Pointer correctly for NDR64

commit a1dfdbbf4b6edecd7cb5cc0b7fecead301f1a4a8
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 12:22:26 2015 -0300

    More code cleanup
    
    * Removed CONSISTENCYCHECK code
    * calculatePad redefined
    * NDR is our Primitive Data class
    * array pack/unpack moved to NDRArry.pack() NDRArray.unpack()
    * Alignment is being done only in the places needed
    * getDataArray renamed to getData
    * fromStringArray renamed to fromString
    * NDRPOINTER needs to align itself before moving on

commit 26e9d08e455e622bf0a25670d24ca4cfc70d19b7
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 24 18:42:44 2015 -0300

    Removing unused variables and code cleanup
    
    * self.data, self.rawData
    * switching to @staticmethod for isNDR, isPointer and isUnion
    * Removing some debug messages and changed expections

commit 5a81fa918322b1fb0a84b2fe11cff06ff77501bf
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 8 17:58:38 2015 -0300

    Updated doc

commit de53731514e6d78dbdae4f2c35eac1e08950ceb0
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:24:41 2015 -0300

    Fixed typo

commit 8f2499e94a73be7148abf3f8d153c593bb4d9244
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:22:55 2015 -0300

    Disabling some test cases that are dangerous against a DC.
    
    Use them at your own risk.

commit 46c2dffbda9d83af9bc11f8d982bee5728bdfebd
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 14:30:40 2015 -0300

    NDR64 for drsuapi still not working

commit 9494c2693f7c5e3f5029791c4d8fc4c80222ebbe
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 14:27:01 2015 -0300

    Adding extra debug information

commit be5ad45851ced0859bbf6fa29bf69afa3bc0db73
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 14:05:43 2015 -0300

    Checking DRSCrackNames's rItems status answer as well to verify everything is ok
    
    * Thanks @gentilkiwi for pointing this out

commit f8959be0354857e1658e34e183be05b04c4e49eb
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 3 20:37:19 2015 -0300

    Reliability fixes
    
    1) Using getDNSMachineName() instead of getMachineName() so we have higher chances to resolve the target machines
    2) If the ticket we're making golden doesn't have an ExtraSid already, we need to state ExtraSids are being present in validationInfo['Data']['UserFlags'].
    3) 'Administrator' is not always the name for S-1-5-21-domain-500. Shame on me and all non-us folks
    Thanks @gentilkiwi for your feedback!

commit 3062d8d44e07bec08ede11022815f961e1a46347
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 3 18:55:37 2015 -0300

    Child domain to forest privilege escalation exploit
    
    This script implements a child-domain to forest privilege escalation
    as detailed by Sean Metcalf at https://adsecurity.org/?p=1640. We will
    be (ab)using the concept of Golden Tickets and ExtraSids researched and implemented
    by Benjamin Delpy (@gentilkiwi) in mimikatz (https://github.com/gentilkiwi/mimikatz).
    The idea of automating all these tasks came from @mubix.
    
    The workflow is as follows:
        Input:
            1) child-domain Admin credentials (password, hashes or aesKey) in the form of 'domain/username[:password]'i
               The domain specified MUST be the domain FQDN.
            2) Optionally a pathname to save the generated golden ticket (-w switch)
            3) Optionally a target to PSEXEC with Enterprise Admin privieleges to (-target-exec switch)
    
        Process:
            1) Find out where the child domain controller is located and get its info (via MS_NRPC)
            2) Find out what the forest FQDN is (via MS_NRPC)
            3) Get the forest's Enterprise Admin SID (via XXX)
            4) Get the child domain's krbtgt credentials (via MS_DRSR)
            5) Create a Golden Ticket specifying SID from 3) inside the KERB_VALIDATION_INFO's ExtraSids array
               and setting expiration 10 years from now
            6) Use the generated ticket to log into the forest and get the krbtgt/admin info
            7) If file was specified, save the golden ticket in ccache format
            8) If target was specified, a PSEXEC shell is launched
    
        Output:
            1) Forest's krbtgt/admin credentials
            2) A golden ticket saved in ccache for future fun and profit
            3) PSExec Shell with Enterprise Admin privileges at target-exec parameter.
    
    IMPORTANT NOTE: Your machine MUST be able to resolve all the domains from the child domain up to the
                    forest.

commit 81b92d4f3ce6308e45b5e40ab765575660a85cca
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 2 17:01:21 2015 -0300

    Adding some Kerberos crypto constants

commit fd455a6baf1378e50434a1e1a755e981bd0b6f5e
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 31 17:14:38 2015 -0300

    Keep asking TGS until we get the one we want.
    
    * This should only happen when jumping from one domain to another.

commit d7a7950d972cf9721c03796094af7b015e3fc77d
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 27 13:35:15 2015 -0300

    Adding -just-dc and -just-dc-ntlm options
    
    * -just-dc -> Extract only NTDS.DIT data (NTLM hashes and Kerberos keys)
    * -just-dc-ntlm -> Extract only NTDS.DIT data (NTLM hashes only)
    * Fixes https://github.com/CoreSecurity/impacket/issues/84
    * Also fixed a silly logic check that was preventing to parse NTDS.DIT files after we added DRSUAPI

commit 745e6d5f681c5060ba5b8c0cdc0d1b1cc4dc8ab2
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 27 10:47:09 2015 -0300

    DRSGetNCChanges only asks for the AD attributes we're interested in.
    
    * The attributes asked are:
     userPrincipalName(1.2.840.113556.1.4.656)
     sAMAccountName(1.2.840.113556.1.4.221)
     unicodePwd(1.2.840.113556.1.4.90)
     dBCSPwd(1.2.840.113556.1.4.55)
     ntPwdHistory(1.2.840.113556.1.4.94)
     lmPwdHistory(1.2.840.113556.1.4.160)
     supplementalCredentials(1.2.840.113556.1.4.125)
     objectSid(1.2.840.113556.1.4.146)
    * Lowers traffic generated
    * Helps minimizing parsing issues
    * Supposed to fix https://github.com/CoreSecurity/impacket/issues/83. Retest needed

commit e6ec7297eb4b4799a6e048222a7e27dc03a2d1fa
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 24 13:37:24 2015 -0300

    Added support for Windows 2003 DC
    
    * Turns out EXOP_REPL_SECRETS and in fact not supported in w2k3:
    <24> Section 4.1.10.1.3: The Replicate Single Object including Secret Data extended operation is supported by Windows Server 2008, Windows Server 2008 R2, Windows Server 2012, and Windows Server 2012 R2.
    * Forgot to add DRS_WRIT_REP to the ulFlags.
    These two changes made the trick!
    * Tested against Win2k3/Win2k8r2/Win2k12R2
    
    Big thanks to @gentilkiwi for pointing out this wasn't working and help finding possible solutions (e.g. the ulFlags issue).

commit 7b78da36b986f0ff33f1f0c9a212870196144cfa
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 23 17:39:36 2015 -0300

    Cracking users using their SIDs instead of their name.
    
    Why? There could be problems when dealing with a forest with multiple subdomains in there
    and referencing the accounts by names.
    Thanks @gentilkiwi for pointing this out!
    I haven't been able to test it but this should solve the problem.

commit 8865ea30f247547d30465a5958225ac71074f085
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 19 11:34:13 2015 -0300

    Not processing machines' accounts for now.

commit 5aeb8ed5bf624c83327445e9265371d0aa111861
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 17 20:29:02 2015 -0300

    Restrict the amount of data to dump when an unpacking expection is printed.
    
    * Handy when we're unpacking a huge buffer. (i.e. DRSGetNCChanges())

commit e514994de1a841358c8ff707e1600e3f9fd7ad63
Author: asolino <bethus@gmail.com>
Date:   Sat Aug 15 18:30:33 2015 -0300

    Disabling parsing rgValues (PREPLVALINF_ARRAY).
    
    * It was reported unpacking errors with that field. Since we don't use it,
      and it's the last pointer, we can discard unpacking it, until we figure
      out what's going on.

commit 8dd7e36e922e1f049163abcbed295dcee25cc4e2
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 14 14:41:00 2015 -0300

    Inside smb3.logoff() we clear the stuff we used in case we want to authenticate again
    within the same connection

commit c8a8e442cb1e24af0eb1ed88ed97b0cd55118e64
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 14 13:01:55 2015 -0300

    Changed requested permission when opening users
    
    * Now we ask for samr.MAXIMUM_ALLOWED so we get more information
    back in the samr.USER_INFORMATION_CLASS.UserAllInformation structure.
    * Fixes https://github.com/CoreSecurity/impacket/issues/81

commit c22b3f6958e02252d4a71eaad308fe661bb7a6ea
Merge: 66901e7 3dc9df2
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Aug 14 11:38:43 2015 -0300

    Merge pull request #80 from byt3bl33d3r/master
    
    fixed __init__() error in smbrelayx.py and added .gitignore

commit 3dc9df20a6083cd9ce4e701c6024508fed116f14
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Fri Aug 14 15:50:34 2015 +0200

    fixed __init__() error in smbrelayx.py and added .gitignore

commit 66901e7dd81c9a9ca602438a1e7bafcee707a74d
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 12 18:16:17 2015 -0300

    Adding support for CIM_ARRAY_STRING unpacking and...
    
    * Aiming at solving https://github.com/CoreSecurity/impacket/issues/79
    * ENCODED_STRING() now calculates the string length
    * Fix small typo with CIM_TYPE_ENUM.CIM_TYPE_UINT8 and CIM_TYPE_ENUM.CIM_TYPE_SINT8

commit b0294f3a1af46d307ba5c39d8da10dec384ceb33
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 11 15:30:30 2015 -0300

    Adding DRSVerifyName() test case

commit 008f3eafcd914ec97d8b7166af5ab15fbb4a29e8
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 11 15:27:11 2015 -0300

    Returning the string representation instead of the pyasn1 instance

commit 46448f9440a1ff68661737cccc8f2cadd648e113
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 10 20:02:24 2015 -0300

    Added 5.16.4 ATTRTYP-to-OID Conversion helper functions
    
    * EXOP_ERR.dump() now prints the hex number if no item is found

commit dbd7c993bf5fe9a681453c7f3abdd620d065f2ec
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 10 20:01:15 2015 -0300

    Initializing arrayPadding variable

commit 0f5f7ca3057a5b5bf8845f27b982fd7d5261b624
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 9 19:46:37 2015 -0300

    Change PAD patterns for debugging purposes

commit ec7688c3e14cdd96c8e0d125e092fe2f5917e04c
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 22:36:08 2015 -0300

    Unit tests now work if the target machine has many accounts available

commit 1bc241638d4d1a5b4a2abc00f9ca69b8df86f8c3
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 22:15:58 2015 -0300

    Removing unnecesary try: catch: clauses

commit 2f6911155e0a61744dc53dfd5627962db9af4b38
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 20:26:35 2015 -0300

    Adding EXOP_ERR Codes and adjusting DRS_MSG_GETCHGREPLY ulExtendedRet field
    
    * ulExtendedRet is now type EXOP_ERR so you can see the string result
    when you dump() the DRS_MSG_GETCHGREPLY union.

commit fb7e250d75c269ad1754bf5e52950bff5e9cdb64
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 20:11:12 2015 -0300

    Fixing hept_map() so it works in Windows 2003 AD
    
    Under Windows 2003 the Referent IDs cannot be random
    they must have specific values
    otherwise we get a rpc_x_bad_stub_data exception

commit e87b25f319553861d70c47a567565c38d5758bcd
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 17:19:09 2015 -0300

    Adding USER_SERVER_TRUST_ACCOUNT and USER_INTERDOMAIN_TRUST_ACCOUNT when listing target users

commit 116e8a5f457cf716fcfa2aa5e7786cdc52409575
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 17:06:34 2015 -0300

    Oops, forgot one comma!

commit 5abd32150fa2767543e6f5edc6a8b780052ce802
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 16:55:39 2015 -0300

    DRSUAPI support for NTLM hashes history and Kerberos keys (Sup. info)  added

commit 506431dc1ed8fc052616149eda43a9f8f1e7916d
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 4 22:52:47 2015 -0300

    OldPwdHashes, when empty, are '', not None

commit 12e6ca483473f1596554b82135db125d17684642
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 4 08:12:46 2015 -0300

    Fixing typos in methods and variables

commit d194b86e8ab58725d7583b7677e00b5f12905799
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 4 08:03:05 2015 -0300

    Setting alignment explicitly for this array until we fix it elsewhere

commit 7fb4fe2b8b9af6de42402f5b2a40406262f060c4
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 4 03:03:05 2015 -0300

    Fixed typo in variable name

commit e5af7102ee145ba6e0977c24e32c572335d1f127
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 4 02:45:16 2015 -0300

    Adding [MS-DRSR] DRSGetNCChanges approach to download users hashes
    
    * In a nutshell, we ask to replicate a single DSNAME instead of the whole NC.
    [MS-DRDS] "4.1.10.5 Server Behavior of the IDL_DRSGetNCChanges Method details"
    the steps you need to follow to be able to download a single DSNAME.
    Check also "4.1.10.5.12 ProcessFsmoRoleRequest"
    This approach works way faster than VSS and it's also a cleaner implementation.
    * Should work ok with pass-the-hash/ticket/keys
    * Pending history and Kerberos keys dump
    * Old VSS method is still available by using the -use-vss switch.
    
    A lot of testing needed!
    
    Kudos to Benjamin Delpy (@gentilkiwi) for publishing first his tool dsync which
    implements a similar approach (I think). Always rocking:
    https://github.com/gentilkiwi/kekeo/tree/master/dcsync

commit 455260e700e2469d66075849e87ee175b6d4517d
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 3 15:46:56 2015 -0300

    Adding get_session_key method to retrieve the session key from RPC runtime
    
    * This is used for example, by DRSUAPI to decrypt some secrets

commit d5cc2752da68228e24c16b7b0d52e26f77f6301a
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 3 09:41:47 2015 -0300

    Adding example for obtaining the target user's hash.

commit 5d1c29b91c191f629d2108caee75c98411ade44e
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 3 09:40:35 2015 -0300

    Adding the ability to decrypt secret attributes

commit b4677668a28bf604dc914adcd6412f2b87a28e5b
Merge: bec9abc cf97e9d
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sun Aug 2 17:21:42 2015 -0300

    Merge pull request #76 from Hexadite/raise_ioerror
    
    raise socket error instead of exception

commit bec9abc722afb9f071474e3a474f6490d8927700
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 2 17:17:53 2015 -0300

    No need to align before unpacking array referents
    
    The alignment check is performed later in the process

commit cf97e9deda89207c60bdf323c0a77e4419ee3932
Author: Omri Kantor <Omri@hexadite.com>
Date:   Sun Aug 2 10:49:24 2015 +0300

    Exception is to general, should catch socket.error and couple it with additional information.

commit bd54fbfaf9946496082dd9c9581e6ec168a2b81c
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 31 19:51:55 2015 -0300

    Fixed linked list issue with NDR in REPLENTINFLIST.
    
    * Minor changes and typos from the standard document
    * DRSGetNCChanges() finally working great!

commit b24c039d4d8e0a84c5b84b82e6ca54dc5ba38429
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 31 19:42:03 2015 -0300

    Adding lcd (local Change Directory) command
    
    * Wondering why it wasn't there before

commit 21a94333c69737099e7551f7a8ca4fa888ee5597
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 31 19:37:17 2015 -0300

    NDR performance improvements and alignment changes
    
    * Now we're counting the bytes we're advancing through the buffer at the same
      time we're unpacking data types, instead of packing the whole thing back to
      check its length. This should increase performance substantially, especially
      when dealing with big arrays of objects.
    * Fixed some alignment issues when dealing with arrays, especially with the
      size item that preceeds the array.
    Test cases are passing the same way before this commit. However we should
    test this a lot since screwing up with NDR alignment means an unpacking failure.
    Testing needed!

commit 8532e1ee7b28c58c308a5063f9f7792f42919264
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 29 21:32:34 2015 -0300

    Fixing some alignment issues in the NDR.
    
    * It was being triggered in high loaded arrays
    * There are still some issues pending to solve

commit 1fa4e23c0601edb61e28a50c1882e71c5c302688
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 27 20:53:04 2015 -0300

    Removing debug message

commit d724dd6bbf8d4ef46b924c284dc017109c8a662a
Merge: bdfc9d9 f181e6d
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 25 12:25:01 2015 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit bdfc9d9ac994e1be84bed8b9379b858b4a8b74b6
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 25 12:23:16 2015 -0300

    [MS-DRSR] Directory Replication Service DRSUAPI Interface implementation
    
    - Just starting
    - Test cases added as well

commit dee68bc06e2839e2d6c820d6cc4ace6de95545c1
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 25 12:22:38 2015 -0300

    Adding ULARGE_INTEGER and PULARGE_INTEGER types

commit f181e6dc006f3f85bf5b971d51dbf70732e7200d
Author: 6e726d <6e726d@gmail.com>
Date:   Fri Jul 24 14:53:48 2015 -0300

    Extended present flags support on RadioTap class.
    
    - test_RadioTap.py PEP8 compliant.
    - Modified dot11.py to add support for extended present flags on the
    RadioTap class.
    - Added Radiotap extended present flags tests on test_RadioTap.py.

commit 67ff4f5ae3d5b60fc133d98c34e8523109809c7d
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 23 12:26:50 2015 -0300

    Don't call finish() when there are no instances created.

commit 2d189d58cc0aef1521d13bb4af8be16160ff0a6e
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 23 12:20:14 2015 -0300

    Cleaning up RemoteOperations() activities as well when job's done.

commit 322a3fdc2e4ad37098ce09a27d1a6cc11baa3e93
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 23 12:11:46 2015 -0300

    Dumping target's host hashes if -E switch not specified (only admin).
    
    Be sure secretsdump.py is present in the same directory as smbrelayx.py
    (default if the library is installed using `python setup.py install`).
    Have in mind you can put any code you want in the `doAttack.run()` method.

commit ebcbd20aefb6cab3f9e4afe333cee8e04b7485e6
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 20 09:45:43 2015 -0300

    Added extra check when parsing FIND_FIRST2 responses
    
    - Samba 3.6.9 doesn't set record['NextEntryOffset'] to 0 for the last
    record. Don't know exactly why, 'cause [MS-CIFS] clearly states that:
    
    `NextEntryOffset: (4 bytes): This field contains the offset, in bytes, from this entry in the list to the next entry in the list. If there are no additional entries, the value MUST be zero (0x00000000).`
    
    Now we're checking we reached the end of the buffer, just in case.

commit 5adde556af86317cf8c80a33446fb27ef69ed9ff
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 16 19:38:54 2015 -0300

    Commands are now executed using ITaskSchedulerService interface
    
    * We were previously using ATSVC Interface
    * It now should work with Windows 2012 R2, fixing https://github.com/CoreSecurity/impacket/issues/70. We should test older Windows versions.

commit 3c78caaaf86dd4739e0a18ea6961c7c8c4340da3
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 16 18:59:20 2015 -0300

    Adding hSchRpcRegisterTask helper function
    
    - Fix the definition of PTASK_XML_ERROR_INFO

commit c2f3ca55d7436ddd2c9dfadbf11bf3e067fada04
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 15 19:30:48 2015 -0300

    Upgraded to DCERPC.v5 runtime and Kerberos support added.
    
    Still does not solve https://github.com/CoreSecurity/impacket/issues/70 tho.
    Most probably the atsvc interface is deprectated in Windows 2012 R2.
    We have to try now using ITaskSchedulerService.

commit 5f2ffd3ad6ed96242c4ee57403c7cc3607ec7964
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 15 19:29:48 2015 -0300

    [MS-TSCH] ITaskSchedulerService Interface implementation and test cases.

commit 271f1dc3945724eb992cb74452bb019b3ac2bf3b
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 15 19:29:07 2015 -0300

    Adding [MS-DTYP] 2.3.13 SYSTEMTIME

commit 41c1dcd7c0ec7808ef249c3f31b7e2bde5e7ace5
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 15 19:28:41 2015 -0300

    Minor cosmetic changes

commit 6203d3fa1fc532b12c7409594c35b48d088bb85c
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 9 18:29:24 2015 -0300

    [MS-TSCH] SASec Interface implementation and test cases.
    
    ITaskSchedulerService left.

commit 3e1f7707677a95098c4e6426d726f2f8b98ed496
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 9 17:17:35 2015 -0300

    [MS-TSCH] ATSVC Interface implementation and test cases.
    
    For now just the ATSVC, now going for SASEC

commit 292621b1e807d3395021d88d66faac708fb3b4d8
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 9 16:37:03 2015 -0300

    Capturing output from stderr as well.
    
    Applying patch from @sshock described in https://github.com/CoreSecurity/impacket/issues/73

commit 7ac7b28bff5865c47ea833812b9dbd6a65c2c3a4
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 30 15:30:58 2015 -0300

    Using self.get_target for DCOM StringBinding calculation.
    
    If we specify a FQDN as the target when initiating a DCOMConnection,
    we replace the aNetworkAddr with self.get_target(). This is to help resolving the target system name.

commit ee53b2a39052d79c2812f9712badb0eca452b348
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 26 14:19:16 2015 -0300

    Adding LOG.debug message for the string binding chosen

commit 04518d7ae183af04b65719ec5d5ab60f4ac5635b
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 26 14:15:18 2015 -0300

    Improved DCOM StringBinding calculation
    
    1) When we need to connect to an interface, a list of possible string bindings are sent. Now we're trying to match self.get_target() as much as possible.
    (e.g. self.get_target() is IPv6, then we'll try to get an IPv6 binding, etc)
    2) DCOMConnection.disconnect() now clears the INTERFACE.CONNECTION dictionary
    3) Minor cosmetic changes

commit 6e9024f6b165754b7d31cba27a4e3aa8fedb55e5
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 26 11:49:20 2015 -0300

    Missed break would loop forever when passing a ticket for TDS auth

commit 8c094b79987401a850a03e9999753bc283dccae9
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 25 09:50:19 2015 -0300

    Adding eXecute permissions to the scripts, fixing https://github.com/CoreSecurity/impacket/issues/71

commit 5befbacb4f89fc1539b1fc9c4302ff777c26c770
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 24 18:02:34 2015 -0300

    Adding ULONG_PTR and DWORD_PTR data types

commit 6dfc966bf694e9ec80fab0a23ac01e150ff63b91
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 24 18:01:48 2015 -0300

    Adding debug message when fallbacking to RC4

commit 6ff37c74c975b6940a2dd81d8a57143c39b9fff2
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 24 18:01:07 2015 -0300

    Catching exceptions when login in.

commit b28a55bc4d65fc4da24701b13984ccf008c7b6ab
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 24 17:29:25 2015 -0300

    Adding Kerberos support to TDS (MSSQL)
    
    - Pass the hash/ticket/key support
    - mssqlclient.py: added -k, -aesKey flags

commit e66337e99e9668086b90039df5140b9439625249
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 16 18:55:16 2015 -0300

    Fixes queryFileInformation() bug for SMBServer (SMBv1)

commit 148c0debcc33ce2888b96d5049bb0a998cacc400
Merge: 8a1239f 7d2dbe5
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 16 16:46:30 2015 -0300

    Merge branch 'rdubourguais-master'
    
    Adding 'Flags management inside SMBv1 stack' and in particular allowing to have UNICODE support for SMBv1
    Thanks @rdubourguais!

commit 7d2dbe5044daa595a8067d002e7cf9f961968aaf
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 16 16:35:59 2015 -0300

    Fixing code for failed test cases for SMBv1
    
    1) test_smb.py: flags2 MUST include smb.SMB.FLAGS2_LONG_NAMES otherwise FIND_FIRST fails
    2) smb.py: check_dir(), remove() and rename() weren't having UNICODE support. Added.
    3) Replacing tabs for spaces

commit b6ea954cc3c9473b6c4100b9a63696903435bf37
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 14:45:35 2015 +0200

    bug fix: check version length before setting __server_os_* in smb.py

commit 7319e5fef6733c3a5f1277e01ba6aa45e58f4324
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 11:20:54 2015 +0200

    Will be managed during negotiation.

commit 2b0b994fddf825941f37391f14d756013dd73816
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 11:18:58 2015 +0200

    Remove duplicate code.

commit 57b119454ed604c2024db4143c1dabbf569721cd
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 11:16:27 2015 +0200

    small bug fix.

commit 328caf150446658ec2621e7a2cd28e6c39cc8da0
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 10:49:24 2015 +0200

    Improve SMB header's flags management and code refactoring

commit cd1d22f392d881b7a4917d16b0fdddf5583bd03e
Merge: cc96628 8a1239f
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 09:48:25 2015 +0200

    Merge remote-tracking branch 'upstream/master'

commit 8a1239fd8b7c123e2e743a33cfab3d1107b2b0e0
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 15 20:22:34 2015 -0300

    Adding a new test suite for Unicode Support on SMB1
    
    Feature still not there but the idea is to implement it using manualNegotiate
    and setting the appropiate flags using SMBConnection.negotiateSession().
    Check https://github.com/CoreSecurity/impacket/issues/51 for details.

commit cc96628d0d94d230d67cbfbffc8f965ad44cccfc
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Mon Jun 15 19:37:20 2015 +0200

    Start unicode integration using self.__flags1 and self.__flags2.
    Removing talk* approach.

commit a345fc1c8c94499a455cf59b2c9b757a41aec60d
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Mon Jun 15 10:35:05 2015 +0200

    Bad attribute name fix.

commit 292960fe97a824ef76322eb6a54cc2083755f9c2
Merge: e3fe436 6bb86b2
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Mon Jun 15 10:30:49 2015 +0200

    merge master upstream.

commit 6bb86b28bba6ce2f0adc3a5e6d6398b48628a93d
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 14 17:47:08 2015 -0300

    Adding @rdubourguais getServer* methods
    
    1) SMBConnection: getServerOSMajor(), getServerOSMinor(), getServerOSBuild()
    2) smb.py and smb3.py related methods to support 1)

commit 675310a11bc3461676afbdc0e21e6d1e57d46dcc
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 14 17:18:20 2015 -0300

    Renaming method's parameter name
    
    data -> negoData

commit ed1d4792c34b1b317426fa013264a808c37fb93a
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 14 16:53:53 2015 -0300

    Detaching protocol version negotiation from SMBConnection constructor
    
    1) You must specify manualNegotiate = True when creating an SMBConnection
    2) Then call SMBConnection.negotiateSession() where you can specify dialect,
    flags and data.
    3) By default everything works the same.

commit 0632c8c48f074380b821202207d28bb52607c6d2
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 14 16:14:33 2015 -0300

    Log the AbstractSyntax when DCERPC Bind request fails

commit 695cbf7049a86e18744e946bac2f701e440c78c4
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 14 16:09:36 2015 -0300

    Porting remaining commands to Structure
    
    1) Added SMB_COM_CHECK_DIRECTORY structure
    2) check_dir(), remove(), rmdir() ported
    3) Removed unused __send_smb_packet()

commit e3fe436cc21b5921a130b088eea4e65d8d2cb0c9
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Fri Jun 12 20:55:07 2015 +0200

    small bug fix.

commit 60abf05d0e83478e14489712bc7949fefa92a8c4
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Fri Jun 12 20:42:53 2015 +0200

    bug fix (calling the wrong function)

commit efa78d6a616619c583aba9ee48c9dacaf39d96b1
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Fri Jun 12 20:35:49 2015 +0200

    adding isTalkingUnicode to smbconnection.py

commit e2512b9e96841a9bcdfc9089e3b528557a35416f
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Fri Jun 12 20:25:34 2015 +0200

    Allowing smbconnection to get the unicode configuration.

commit 25214231b1de8ab1fce6aff2b01cf754f0c05375
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Fri Jun 12 20:00:43 2015 +0200

    Start unicode integration inside SMBv1 stack.

commit e12685ebbdc69c67b0012277f44be4a71eb31b0f
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 11 19:53:31 2015 -0300

    Replacing tab for spaces

commit 299bb6a4d2b74dfd7e1acdb801561b9d9dc158ed
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 11 14:55:03 2015 -0300

    Merging patch by Renaud Dubourguais exposing SMBConnection.isSigningRequired()
    
    The meaning of it is self explanatory ;)

commit 16d5162795dd6cc2a1dfea37a6fc42c395524c0f
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 18:11:20 2015 -0300

    Adjusting test cases for success against a w2k8 DC

commit 457eee71facde00d311af8f6d762f2be969e27fb
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 18:09:58 2015 -0300

    Adjusting test cases for success against a w2k8 DC

commit 270aadd40132fb06b46a339332e590ab9f6f6198
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 17:57:42 2015 -0300

    Code cleanup and improvements
    
    Removed:
    * SMBPacket class
    * recv_packet(): not used anymore, replaced for recvSMB()
    * __raw_retr_file(): (SMB_COM_READ_ANDX should be used)
    * __raw_stor_file(): (SMB_COM_WRITE_ANDX should be used)
    * list_shared(): we list shares through DCERPC, not using the LANMAN approach anymore
    * copy(): not used inside the library
    
    Changed:
    * trans2() renamed to send_trans2()
    * send_trans2() ported to Structure, and proper reassembly in place
    * query_file_info() now uses send_trans2()
    * list_path() rewritten to use Structure, much easier to read.
    * all instances of recv_packet() changed to recvSMB()

commit 91113242b3f79f0399bfbae9a913d265319e28ca
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 17:55:49 2015 -0300

    A better way to test whether the target file is a directory
    
    And also works against an OSX Yosemite SMB Server

commit 8f3592c561452c7b60cf29cc0e8acf9a46cab455
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 17:52:29 2015 -0300

    Adding support for connecting to an OSX Yosemite SMB share.
    
    Yosemite's SMB implementation would complain if the following flags are not
    part of the protocol negotiation:
    FLAGS2_NT_STATUS
    FLAGS2_LONG_NAMES
    FLAGS2_UNICODE
    
    If the first nego packet does not have that, the connection is closed.
    We don't really want to announce UNICODE support for all servers (especially
    against a NT4/SMB1 server), so we're changing these flags only if the
    former flags were rejected.

commit c1e6887b0bebf4aa02c56f48896dbdab5e7939a2
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 17:44:32 2015 -0300

    Setting the minimum privileges to remove a file and directory
    
    Previous setting was broader, and was having issues against a OSX Server

commit a28d3d01921a58191d12e37a21fc0a66e696df63
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 7 23:00:13 2015 -0300

    Catching DCERPCException instead of Exception
    
    More realistic since we're then calling get_packet()

commit 0d9f1cec5c8c83377672fd9d1692a625a653c15c
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 7 22:42:07 2015 -0300

    Unifying DCERPC exceptions to impacket.dcerpc.v5.rpcrt.DCERPCException
    
    You should catch that one for all DCERPC related requests.

commit faac79a54ecd30c1d5804be3ebf2562713f255dc
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 7 20:34:25 2015 -0300

    Adding support for answering DCERPC NetrWkstaGetInfo calls
    
    Why? If you have a SMB Server and, at a client Windows, you execute
    `start \\host` from cmd.exe,  what happens is the client Windows
    not only connects to the SMB Server but also calls, via ncacn_np,
    the WKST DCERPC server NetrWkstaGetInfo function.
    
    If no WKST server is present no Windows Explorer window will pop up.
    
    Currently that's the only call supported, so some testing is
    needing to be sure it doesn't break cases where other calls are
    done (maybe OSX clients).

commit fb439fa9d06690a8f7a79b32429d9b84fae53ffc
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 7 20:31:25 2015 -0300

    Fixes DCERPC Server when a bind to an unknown UUID is requested.
    
    If we have a DCERPC Server bound to an specific UUID and a client
    requests binding to a different UUID (not registered) the server
    was launching an exception due to 'SecondaryAddrLen' not set.

commit 1418dd11c3eb09eca6b90a5680fe71840275a0f3
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 7 20:28:58 2015 -0300

    Fix in SMBTreeConnectAndX_Data to support Samba's smbclient4
    
    Samba's smbclient4 behaves weird when connecting to a tree
    It specifies password len to be 0 when there's actually one NULL byte.
    We're taking care of that situation when acting as a SMB1 server.

commit fa63f520abc550811169d3a29183bdde31cf8acb
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 4 10:21:07 2015 -0300

    Fixed issue https://github.com/CoreSecurity/impacket/issues/67. Thanks @MrTchuss

commit 1994a5c7626fb655bfdaaf328d13a813a42d23b5
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 3 21:22:19 2015 -0300

    Code cleanup / switching to @staticmethod when suitable

commit b1eb2723646fd68c98d338dade72b9f3a7e9a5a5
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 2 16:21:24 2015 -0300

    Fixing typos and indentation errors

commit 39fde4705c9eb77d9df6ac8123d08cf680a87661
Author: asolino <bethus@gmail.com>
Date:   Sat May 30 14:01:06 2015 -0300

    Fixes https://github.com/CoreSecurity/impacket/issues/66 reported by deniskhodus.
    
    We're now testing the `securityBindings` buffer is at least a two bytes long.
    This shouldn't happen in theory, but maybe there are a few remaining bytes
    left (probably padding bytes) in the last round of that loop.
    
    Maybe we should also check if there could be 3 or more bytes left on that buffer,
    but not long enough to fulfill a `SECURITYBINDING` structure.
    If so, then there will be an exception trying to build a `SECURITYBINDING`
    struct. However that error hasn't been reported.

commit 1bec6c9126705c27706c6a9cfffb10a49e782319
Merge: 8ab2079 6a88eb0
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri May 29 10:22:00 2015 -0300

    Merge pull request #64 from lgriner/master
    
    update setup.py: merging change from lgriner, thanks!

commit 6a88eb0720b659056855ecaac76c8b0a1a293c08
Author: Tyrannosaurus Vexed <leegriner@gmail.com>
Date:   Fri May 29 08:30:56 2015 -0400

    update setup.py
    
    typo in the shebang line

commit 8ab20793a00db9c64bbf90d3812d108b9d1ddcbf
Merge: 138b9a1 6085a1a
Author: asolino <bethus@gmail.com>
Date:   Thu May 28 14:21:34 2015 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit 138b9a16390d5f2d655f119b8ac0362e052bdabf
Author: asolino <bethus@gmail.com>
Date:   Thu May 28 14:10:20 2015 -0300

    Fixes NDRUNION unpacking inside a pointer to an array of union elements
    
    An example of such scenario is [MS-DHCPE], `R_DhcpEnumSubnetElementsV4` call
    (section 3.1.4.31).
    The returned element is a `LPDHCP_SUBNET_ELEMENT_INFO_ARRAY_V4`:
    ```
    typedef struct _DHCP_SUBNET_ELEMENT_INFO_ARRAY_V4 {
      DWORD NumElements;
    [size_is(NumElements)] LPDHCP_SUBNET_ELEMENT_DATA_V4 Elements;
    } DHCP_SUBNET_ELEMENT_INFO_ARRAY_V4,
    *LPDHCP_SUBNET_ELEMENT_INFO_ARRAY_V4;
    ```
    each element of that array is a union like this:
    ```
    && (DhcpIpRangesDhcpOnly <= (E)))?(0):(E))
    typedef struct _DHCP_SUBNET_ELEMENT_DATA_V4 {
      DHCP_SUBNET_ELEMENT_TYPE ElementType;
      [switch_is(ELEMENT_MASK(ElementType)), switch_type(DHCP_SUBNET_ELEMENT_TYPE)]
      union _DHCP_SUBNET_ELEMENT_UNION_V4 {
        [case(DhcpIpRanges)]
        DHCP_IP_RANGE* IpRange; [case(DhcpSecondaryHosts)]
        DHCP_HOST_INFO* SecondaryHost; [case(DhcpReservedIps)]
        DHCP_IP_RESERVATION_V4* ReservedIp; [case(DhcpExcludedIpRanges)]
        DHCP_IP_RANGE* ExcludeIpRange; [case(DhcpIpUsedClusters)]
        DHCP_IP_CLUSTER* IpUsedCluster;
      } Element;
    } DHCP_SUBNET_ELEMENT_DATA_V4, *LPDHCP_SUBNET_ELEMENT_DATA_V4;
    ```
    
    Trying to decode a structure like this would trigger an error.
    
    Main problem was the NDRUNION constructor was interpreting all the
    pointers inside the structure as NDR top level pointers, which is
    not always true (only true if UNION belongs to the NDRCALL directly).
    
    Changing this behaviour seems to fix this issue while mantaining
    the rest of the test cases working. More test is needed tho.

commit 6085a1a2a52a7247c1e9822d2abb66d6f3c81cb5
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed May 27 15:14:49 2015 -0300

    Update README.md

commit 9471616548bb6845c6e4a71ef174ec4f24b9c6e2
Merge: 6ef8ae6 e8253a6
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed May 27 12:27:41 2015 -0300

    Merge pull request #63 from CoolOppo/patch-1
    
    Syntax highlighting and copy-edited README, thanks mate!

commit e8253a62c78b1850ce91d7b8cd17b9c28a7abd0d
Author: CoolOppo <CoolOppo@users.noreply.github.com>
Date:   Tue May 26 21:53:47 2015 -0400

    Rename README to README.md
    
    This enables syntax-highlighting on GitHub.

commit 6a130cc05d4059efe87b55b6ad0aefa02547bcb6
Author: CoolOppo <CoolOppo@users.noreply.github.com>
Date:   Tue May 26 21:52:36 2015 -0400

    Syntax highlighting and copy-edited README

commit 6ef8ae60bb2d436175b0c125b8ab1abd2e1c6ca5
Author: asolino <bethus@gmail.com>
Date:   Tue May 26 19:41:31 2015 -0300

    Replacing decode('hex')/encode('hex')
    
    for binascii's hexlify/unhexlify, mainly because of http://bugs.python.org/issue7475
    and Python3 not having it.

commit 4e32a0d4983d7480e5fa94546ffbe5fc83ca88a0
Author: asolino <bethus@gmail.com>
Date:   Mon May 25 20:40:17 2015 -0300

    Removing some pyCharm's erros/warnings
    
    More scripts/libs changed. Hopefully doesn't break a thing. Test cases are passing

commit 0fc523de873f9f2085d90533d428a4f156a6d422
Author: asolino <bethus@gmail.com>
Date:   Mon May 25 20:37:57 2015 -0300

    The examples theme won't be applied if the init() function isn't called.
    
    In short, in every example you should do:
    import logging
    from impacket.examples import logger
    
    and later in main()
    
        # Init the example's logger theme
        logger.init()
    
    then you can write to the logger using:
    logging.info()
    logging.warning(),
    etc.

commit 0785c5afd30a23d6c622823d31f4391c18eb7e46
Author: asolino <bethus@gmail.com>
Date:   Sat May 23 18:31:08 2015 -0300

    Removing some pyCharm's erros/warnings
    
    Hopefully doesn't break a thing. Test cases are passing

commit dbcacbfaf12bba537f13330cf111cecb68b42da7
Author: asolino <bethus@gmail.com>
Date:   Sat May 23 17:23:36 2015 -0300

    Fixes https://github.com/CoreSecurity/impacket/issues/62
    
    Error on import cause by https://github.com/CoreSecurity/impacket/commit/8b8f8a694703858b217117cffad83c6a61b38065.
    Hopefully it's the only one.

commit 8b8f8a694703858b217117cffad83c6a61b38065
Author: asolino <bethus@gmail.com>
Date:   Sat May 23 11:56:59 2015 -0300

    Pyton imports fixups
    
    1) Removed unnecesary imports, avoid import * whenever possible
    2) Copyright updated
    3) Minor typos fixed
    4) File formats to Unix (LF)

commit b4f2d768f75b1836fca1452d8ed9dce349228917
Author: asolino <bethus@gmail.com>
Date:   Fri May 8 16:39:12 2015 -0300

    Changed unsupported mech type behaviour.
    
    If SMB client wants to do Kerberos or something we don't support, now we answer
    STATUS_MORE_PROCESSING_REQUIRED specifying the NTLM MechType again. Seems that's
    the right way to do it instead of answering STATUS_NOT_SUPPORTED.

commit 9c980a7304a423c8849d035db13badd28cc4fade
Author: asolino <bethus@gmail.com>
Date:   Tue May 5 19:07:39 2015 -0300

    Fix some typos

commit c6a6790c55b0b5e1b24eb136e07b971d165d438e
Author: asolino <bethus@gmail.com>
Date:   Mon May 4 14:11:04 2015 -0300

    New dev release...

commit 02b4ab82708bfefaa638e92d15aad5998026210c
Author: asolino <bethus@gmail.com>
Date:   Mon May 4 12:18:43 2015 -0300

    Changing version also at setup.py

commit 60a0c5b126a8a42121852de7ef5354beb8e631e3
Author: asolino <bethus@gmail.com>
Date:   Mon May 4 11:59:25 2015 -0300

    Adding Changelog and changing dev version to final.

commit a3b11bcef0c0ead6b7d844e0b2b94656453f58db
Author: asolino <bethus@gmail.com>
Date:   Sun May 3 22:23:18 2015 -0300

    Some corrections to make these tests to pass

commit 535a44f69b68062218b2dced82456ec93562f1a4
Author: asolino <bethus@gmail.com>
Date:   Sun May 3 22:01:59 2015 -0300

    Some corrections to make these tests to pass

commit 6fc56f05b9867db72f8e0ef32e888e883c924bf0
Author: asolino <bethus@gmail.com>
Date:   Fri May 1 18:53:22 2015 -0300

    `psexec.py` now defaults to executing cmd.exe if no command is specified
    
    I don't know why I didn't do this before but more than one of you
    fell on that little detail.
    There might be a reson tho :s.. testing needed!

commit 8a96b280c92020e8fafc034646f72ce515b81346
Author: asolino <bethus@gmail.com>
Date:   Fri May 1 16:43:24 2015 -0300

    Removing these files. Outdated

commit 9c85ee047a8be00ae22858b43bd13516a261e18a
Author: asolino <bethus@gmail.com>
Date:   Fri May 1 13:31:32 2015 -0300

    No need to encode the serviceName. It fails on some XP versions
    
    This was left from the old RPC runtime where we had to manually encode things.
    Now it's all handled by ndr.py

commit 352816b37f01e9d6240cc21753eb9336644e6199
Author: asolino <bethus@gmail.com>
Date:   Thu Apr 30 18:05:37 2015 -0300

    Adding log level message format and adding try/catch to fail gracefully
    
    Small fixes. Almost ready to tag new version

commit 925aa52c1640be19657f117ad9fb4534e9b16210
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 29 10:26:27 2015 -0300

    Added `from __future__ import with_statement` for older Python versions

commit 3f0585a2b832815daeeb03de5af9356fd2d81244
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 28 16:12:07 2015 -0300

    SMB2_QUERY_DIRECTORY and SMB.TRANS.FIND_FIRST2 information levels updated
    
    Plus now it returns STATUS_NOT_SUPPORTED (only in SMB2) if the level
    is not present.

commit 34a490e2a694c2636e2f83ef439aacc3129b2b51
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 28 11:12:41 2015 -0300

    SRVSServer.NetrShareGetInfo() fix when non existent share was sent.
    
    The SMBServer has a mini DCERPC server serving a minimal subset of
    [MS-SRVS] calls used by clients.
    The NetrShareGetInfo() method was assuming the share asked for
    information was always existing, something that could not be true.
    Calling, from the client, 'start \\smbserver\SHARE', and SHARE being
    non existant was triggering this problem.
    Now if the share doesn't exist the method returns WEE_NET_NAME_NOT_FOUND.

commit fde21c2b810db4efbdcb75ab7593664872677e4b
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 27 22:41:35 2015 -0300

    SPNEGO MechType check
    
    We now check the selected MechType is for NTLM auth. If not, we fail gracefully with STATUS_NOT_SUPPORTED

commit 816a950b2a94e66596fd1396cdf4ee9f6b6b0442
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 27 21:13:17 2015 -0300

    Updates to SMB2 Server
    
    1) We need to store the new filename inside the connData['OpenedFiles'] dictionary
    when renaming a file
    2) SMB2Lock wasn't unpacking correctly, producing an error.
    
    BTW, OSx SMB client implementation sucks.

commit 53306c9c8926cc67ebeb620dd27701ee85d4a80e
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 27 20:11:56 2015 -0300

    Updates to SMB2 Server
    
    1) Dummy SMB2_LOCK, SMB2_CANCEL added
    2) SMB2_FLUSH added
    3) SMB2_FILE_INTERNAL_INFO level added
    4) Getting fileID from previous compound request for all functions that apply
    5) Fixed path calculation when renaming a file outside the root tree dir
    
    Looks like it's working OK from Linux/Windows and OSX (guest login)

commit 94b141881bc076303ff6b7e635a807b37851b163
Author: asolino <bethus@gmail.com>
Date:   Sat Apr 25 16:58:36 2015 -0300

    Added SMBSERVER() support for renaming files/folders through SMB2_SET_INFO.
    
    This is what explorer uses when renaming files/folders.

commit 4c2e64ad3add7e40609834a7a8f046ca86304e56
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 24 18:42:12 2015 -0300

    Second round of logging change.
    Now there should be a single logger called 'impacket' the library uses.
    By default is has a NullHandler so nothing is printed, but messages are
    forwarded to the upstream logger.
    
    If you are a script using the library and want to set the root logger
    with a custom formatter, you can import impacket.examples.logger.
    
    After some testing I'll merge it into master

commit 7e99da87f92244fce5caa659bb122dfe2c4f4991
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 24 13:18:26 2015 -0300

    Adding debug parameter

commit 119e4438dd8227a138d5ecc2052646c3a81b9e4e
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 24 12:52:32 2015 -0300

    Changing logging mechanisms everywhere.
    Full details coming soon

commit 0730a3428af8bd1625a205420dbdc5e2af892bda
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 22 14:58:06 2015 -0300

        Playing with logging, trying to get to something useful to finally have a decent logging inside impacket.
    
        1) We basically define a logger called 'impacket' at the library's __init__, set out a NullHandler for it, and
    
        2) All the logging stuff in version.py removed
    
        With this we have a single logger called 'impacket' for the library.
    
        Now.. what about the example scripts?
    
        1) Move the impacket/logger.py to impacket/examples/logger.py, since this is something that is used just by the
    
        2) Example scripts should import that file in order for the library logs to be shown right (from impacket.examp
    
        For third-party developers that want to disable or change the logs generated by the library:
    
        1) They could, inside the scripts, logging.getLogger('impacket').disabled = True, or add handlers, or whatever.
    
        Testing needed..

commit c2b47d34365d81c8d7de1e445da3999ea2e8a342
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 22 14:49:19 2015 -0300

    Playing with logging, trying to get to something useful to finally have a decent logging inside impacket.
    
    1) We basically define a logger called 'impacket' at the library's __init__, set out a NullHandler for it, and assign a global variable LOG that will need to be imported from all the library modules. From now on, ALL library modules LOG through that variable. All modules should have 'from impacket import LOG'
    
    2) All the logging stuff in version.py removed
    
    With this we have a single logger called 'impacket' for the library.
    
    Now.. what about the example scripts?
    
    1) Move the impacket/logger.py to impacket/examples/logger.py, since this is something that is used just by the example modules (yeah, shouldn't be inside the library itself, but oh well). Inside logger.py, we modify the root logger and change the format of the messages (as set by @lanjelot). The root logger is held in a global variable called SLOG (scripts log?.. another ideas welcomed).
    
    2) Example scripts should import that file in order for the library logs to be shown right (from impacket.examples.logger import SLOG). Plus if they want to log themselves, they can use SLOG.
    
    For third-party developers that want to disable or change the logs generated by the library:
    
    1) They could, inside the scripts, logging.getLogger('impacket').disabled = True, or add handlers, or whatever.
    
    Testing needed..

commit 10c54429c22e0277934108b520684b24f3f60bc7
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 24 12:55:35 2015 -0300

    Fix SMBSERVER error when no challenge was set in config file.
    
    https://github.com/CoreSecurity/impacket/pull/57 added option for setting
    a custom challenge in SimpleSMBServer class. However, those modules that
    would instantiate an SMBSERVER directly (e.g. karmaSMB) would fail if the
    challenge option wasn't set.
    I've added a the default challenge to be 'A'*8 at the SMBSERVER class level.

commit 8b359e16252c59caec093e13cd76e906fd6f5c0f
Merge: dc1b648 3352733
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Apr 22 09:23:11 2015 -0300

    Merge pull request #57 from byt3bl33d3r/master
    
    Added option to set custom SMB challenge in smbserver.py

commit 3352733f434bff1f929f3bcc5135bdab9a769f60
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Wed Apr 22 07:38:36 2015 +0200

    added missing )

commit 4a54672034cc9a8ae1dec124d803292b6b6b67a9
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Wed Apr 22 07:37:11 2015 +0200

    modified comment

commit 028dcdb90cdcd78747d47a94ecdca86546e97867
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Apr 21 23:50:33 2015 +0200

    have no idea what i was thinking at the time

commit 9c7b50e34f5276332e632d5534da0a852b21e887
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Apr 21 22:45:51 2015 +0200

    corrected a comment

commit 7d532eef967666b4e11024efd7a74a12e809303a
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Apr 21 22:27:36 2015 +0200

    removed debug print statements

commit 73fdb533dd2835c2996e4d392384bde053a459c2
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Apr 21 22:25:40 2015 +0200

    added option to set smb challenge in smbserver.py

commit dc1b6487edb3a35284ce50ea6a9c47bd55aad69b
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 21 12:57:10 2015 -0300

    Adding SMB2 support for karmaSMB
    
       The SMB2 support works with a caveat. If two different
       filenames at the same share are requested, the first
       one will work and the second one will not work if the request
       is performed right away. This seems related to the
       QUERY_DIRECTORY request, where we return the files available.
       In the first try, we return the file that was asked to open.
       In the second try, the client will NOT ask for another
       QUERY_DIRECTORY but will use the cached one. This time the new file
       is not there, so the client assumes it doesn't exist.
       After a few seconds, looks like the client cache is cleared and
       the operation works again. Further research is needed trying
       to avoid this from happening.

commit 809b2c89208d204bc6daf68500afebc665a33548
Merge: e961473 c7d1786
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 20 21:02:06 2015 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit e96147381b170b701a2f82203214a3392ed88358
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 20 20:57:57 2015 -0300

    Adding initial support for SMB2 (SMB 2.002) dialect. If not explicitly specified, it should all work still the same (SMB1).
    It can be tested running the smbserver.py example with the -smb2support parameter. Looks like it's working from
    Windows clients and Samba clients (Samba 4.2.x).
    A lot of testing needed!

commit c7d1786bc27f92186b41bafdd85bcd5cccdd783a
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 17 15:35:10 2015 -0300

    Updated README

commit f0cf1be7b4ee64f0f3cd65d27df6af998d6e4b26
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 15 13:26:25 2015 -0300

    Replacing google.code links for github

commit 91763930805347767590d750d2a7681cd4b2861d
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 15 13:17:34 2015 -0300

    Replacing google.code links

commit a186ff111d68237ef46e81ecaf83f85fed5e0aa4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 14 16:56:25 2015 +0000

    Adding S4U2Self structures

commit 8ab5bffc9487c129a217df47d78240da87100924
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 21:13:17 2015 +0000

    Adding keytype. Not documented by MSFT, but it's clearly the NTHASH
    0xffffff74:'rc4_hmac'

commit 4d6b5cebb82dbb6c7694ccea4616c3b43debd244
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 21:01:52 2015 +0000

    If we don't know the KeyType's string name, we just put its number

commit 04fd08a4a4269286b33a97dad97983350bc4b6e6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 19:53:09 2015 +0000

    Fixed a typo and clarified the examples

commit 1f377339ff4a00ae0b3ae923a812b3e7c5c19af6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 19:00:37 2015 +0000

    Adding -target-ip switch in case you cannot resolve it

commit 2961a45867f97529b8099647a72b93b85df7d1d9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 18:20:13 2015 +0000

    More checks to verify the target ETYPE is supported. The domain controller functional level might be another situation that can trigger AES not supported

commit c444e653f59720fbb2ebb3fec0ad37c352be3528
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 17:53:37 2015 +0000

    More checks to verify the target ETYPE is supported. This could be triggered on a Windows 2008 R2 SP1 (SP0 accepts AES).

commit 0c4fe32fb1969d3cf9fc1af5dac3612dff817b30
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 9 20:50:13 2015 +0000

    Synchronizing with impact's internal repo

commit a46cad19552a4fe72dfab31ba2dcbb6f1fb6f1ae
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 9 19:19:47 2015 +0000

    Adding more checks in case we get a KDC_ERR_ETYPE_NOSUPP error. We try to switch to RC4 and hope for the best

commit e78a860d38be3744b04aba7646ed0862b207d029
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 8 17:50:10 2015 +0000

    Updated description:
    
    # This script creates/removes a WMI Event Consumer/Filter and link
    # between both to execute Visual Basic based on the WQL filter
    # or timer specified.
    #
    # Author:
    #  beto (@agsolino)
    #
    # Example:
    #
    # write a file toexec.vbs the following:
    #       Dim objFS, objFile
    #       Set objFS = CreateObject("Scripting.FileSystemObject")
    #       Set objFile = objFS.OpenTextFile("C:\ASEC.log", 8, true)
    #       objFile.WriteLine "Hey There!"
    #       objFile.Close
    #
    #
    # then excute this script this way, VBS will be triggered once
    # somebody opens calc.exe:
    #
    #  wmipersist.py domain.net/adminuser:mypwd@targetHost install -name ASEC
    #   -vbs toexec.vbs
    #   -filter 'SELECT * FROM __InstanceCreationEvent WITHIN 5 WHERE TargetInstance
    #            ISA "Win32_Process" AND TargetInstance.Name = "calc.exe"'
    #
    # or, if you just want to execute the VBS every XXX milliseconds:
    #
    #  wmipersist.py domain.net/adminuser:mypwd@targetHost install -name ASEC
    #   -vbs toexec.vbs -timer XXX
    #
    # to remove the event:
    #       wmipersist.py domain.net/adminuser:mypwd@targetHost remove -name ASEC
    #
    # if you don't specify the password, it will be asked by the script.
    # domain is optional.
    #

commit 29ef8f394a3e340ca318d64bbee1f5dd5f8420d9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 8 17:45:34 2015 +0000

    Clarifications on the scope of the script

commit f4819fa9ba38c355d863838ec0b1ce9c29673242
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 7 13:25:11 2015 +0000

     This script creates/removes a WMI Event Consumer/Filter and link
     between both to execute Visual Basic based on the WQL filter specified.
    
     Example:
    
     write a file toexec.vbs the following:
            Dim objFS, objFile
            Set objFS = CreateObject("Scripting.FileSystemObject")
            Set objFile = objFS.OpenTextFile("C:\ASEC.log", 8, true)
            objFile.WriteLine "Hey There!"
            objFile.Close
    
    
     then excute this script this way, VBS will be triggered once
     somebody opens calc.exe:
    
      wmipersist.py domain.net/normaluser:mypwd@domain-dc install -name ASEC
       -vbs toexec.vbs
       -filter 'SELECT * FROM __InstanceCreationEvent WITHIN 5 WHERE TargetInstance
                ISA "Win32_Process" AND TargetInstance.Name = "calc.exe"'
    
     or, if you just want to execute the VBS every XXX milliseconds:
    
      wmipersist.py domain.net/normaluser:mypwd@domain-dc install -name ASEC
       -vbs toexec.vbs -timer XXX
    
     to remove the event:
            wmipersist.py domain.net/normaluser:mypwd@domain-dc remove -name ASEC

commit 82ec2f4f0d436626304416fb6efc3173a071f538
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 6 15:42:42 2015 +0000

       The idea of this script is to get a list of the sessions
       opened at the remote hosts and keep track of them.
       Coincidentally @mubix did something similar a few years
       ago so credit goes to him (and the script's name ;)).
       Check it out at https://github.com/mubix/netview
       The main difference with our approach is we keep
       looping over the hosts found and keep track of who logged
       in/out from remote servers. Plus, we keep the connections
       with the target systems and just send a few DCE-RPC packets.
    
       One VERY IMPORTANT thing is:
    
       YOU HAVE TO BE ABLE TO RESOLV THE DOMAIN MACHINES NETBIOS
       NAMES. That's usually solved by setting your DNS to the
       domain DNS (and the right search domain).
    
       Some examples of usage are:
    
       netview.py -target 192.168.1.10 beto
    
       This will show the sessions on 192.168.1.10 and will authenticate as 'beto'
       (password will be prompted)
    
       netview.py FREEFLY.NET/beto
    
       This will download all machines from FREEFLY.NET, authenticated as 'beto'
       and will gather the session information for those machines that appear
       to be up. There is a background thread checking aliveness of the targets
       at all times.
    
       netview.py -users /tmp/users -domainController freefly-dc.freefly.net -k FREEFLY.NET/beto
    
       This will download all machines from FREEFLY.NET, authenticating using
       Kerberos (that's why domainController parameter is needed), and filter
       the output based on the list of users specified in /tmp/users file.

commit 56727f344501fd4091aab1adf60dafef2c43f055
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 1 21:40:02 2015 +0000

    Adding pyasn1 as requirement

commit 0df6b23153648f24768c79e1dbc7b96a6c2e4c94
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 1 17:45:22 2015 +0000

    Fixed wrong definition for LPDWORD

commit 7c3ca072b5de80606edf753ac9eaec533f71780b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 1 17:18:28 2015 +0000

    Synchronizing with impact's internal repo

commit 03cfbd23f1681ed5354def0a1d7fc28e9717b94b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 1 17:04:23 2015 +0000

    Changing padding from 8 to 4, seems to be effective when using RPC_C_AUTHN_LEVEL_PKT_INTEGRITY and RPC_C_AUTHN_GSS_NEGOTIATE

commit 50b59ffcdf56e6ba88f77bafe40af096287e4b83
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 26 21:52:00 2015 +0000

    We're just showing that CCache file was used if debugging output is chosen. Hope it doesn't confuse ppl, but it's kind of annoying to get those messages all the time.

commit ff6a318df35004db8e4efcfc1bda7e49f3f118b6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 26 21:15:50 2015 +0000

    Adding -debug flag

commit 957ab8586419b7884e4ba5acf5f002e34cbc2de0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 24 22:29:29 2015 +0000

    Changed the who command so you can list the active sessions w/o the need of being Administrator. The whole trick was to use a different information level

commit 25188dad4ba894cf80061f794c96a0247cf32e92
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 20 19:46:52 2015 +0000

    Fixes kerberosLogin calling way

commit a4f6260676492ea196d675c1440d623e6404bf0d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 20 19:28:20 2015 +0000

    Typo

commit d5238f0817ca144f2a3f0074835ce94677c8dca6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 20 19:25:53 2015 +0000

    Adding small description when calling the scripts w/no arguments

commit 5a2a246f3da8d7d4d5977a10078dd3639a9489b0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 20 19:21:09 2015 +0000

    Adding TGT, TGS when receiving get_credentials() data

commit a64365dcba4b1ac8a0092616219406e1480790a5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 19 22:19:30 2015 +0000

    getCredentials() now returns more data

commit 0fcf9d3780e570e99a3bb1ed6001aca50acfed68
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 19 22:18:08 2015 +0000

    This changeset allows passing TGT/TGS tickets to the DCERPC runtime. Check krb5/ccache.py toTGT()/toTGS() methods to see what the expected format must be.
    Main changes were adding TGT/TGS to the getCredentials()/get_credentials() and set_credentials() methods in the smb*/dcerpc/rpcrt/dcomrt/transport* files.
    Testing needed!

commit 192ab359b4c84c9043588109583d2952f9882b87
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Mar 18 19:56:53 2015 +0000

    Adding the following types:
    LONG64, WORD, OBJECT_TYPE_LIST

commit 185bdbbb49875a7157d10bae67afac59818e50fb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 17 14:30:21 2015 +0000

    We extract the domain name from the authenticateMessage instead of the command line. This will increase the chances of success since request['LogonInformation']['LogonNetworkTransitive']['Identity']['LogonDomainName'] must match the authenticate['domain_name'] field.

commit 872c656a74d0c61fb2b2b6ed80ca9224ba31d663
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 17 12:54:34 2015 +0000

    Fixed a bug that would cause DCOMConnection.PINGTIMER to be set to None when there were already active connections.

commit 734fa44b90cbf4cea6c7824fb84a08626adab8c4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 16 16:45:07 2015 +0000

    removed traceback prints

commit 5ca4e2278008b1ceaa8f47eaf8a504cf3b455cfb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 13 05:40:10 2015 +0000

    Fixes LSA Secrets decryption on NT5 x64 systems as described by Sebastien Macke at https://www.trustwave.com/Resources/SpiderLabs-Blog/Dumping-LSA-Secrets-on-NT5-x64

commit 7f041090f35004022b4e5cb8ea0b34e13fa96b60
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 10 17:06:06 2015 +0000

    Adding support for CVE-2015-0005

commit f79acb0a3928ce76cab104815b241a47f926e054
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 10 17:01:55 2015 +0000

    Adding support for CVE-2015-0005

commit 84568806cb9e18d71647341a8b4b36ff3b4a24c6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 9 16:29:43 2015 +0000

    1) Fixing definitions for opnums 21/22 and 23
    2) IEnumWbemClassObject_Next lTimeout should be ULONG instead of LONG
    3) ExecNotificationQuery() result is casted to a IEnumWbemClassObject()

commit 1f2e2bc501643b4484de00ab825177882a76e1a4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Mar 8 14:35:28 2015 +0000

    Always comparing SPNs in uppercase

commit 5cbfd48e039a1f9ff87d75bcb2e9e4a4be2b0dfa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 7 22:40:43 2015 +0000

    Casting the return values for the methods called

commit f538b88a34ad56a3d24e665d369d26012fde1dc2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 7 22:18:40 2015 +0000

    Better error control

commit 7d6cf3f174497e1da584edf36f53f4acaff85965
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 5 15:42:51 2015 +0000

    Fixes an STATUS_INVALID_PARAMETER response against some Samba Servers

commit 49926d6e389b00625387b61a9772d938985e7fef
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Mar 4 19:12:10 2015 +0000

    Changing some default values for these strucs.. mimicking what Windows is returning back

commit d4c9d1a6314d4f971d4141fd037199728c16c4e4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 3 21:17:14 2015 +0000

    Adding a few structures and constants for the smbserver

commit d6d3f89f7c3a822e0e9c4f788a6d07eb8475759d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 24 15:16:54 2015 +0000

    Using PyCrypto's gcd implementation

commit 8596051e4bc2a23e3706362404b2381dd0f58846
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 18 19:59:33 2015 +0000

    Fixes https://code.google.com/p/impacket/issues/detail?id=53 reported by crlawrence. I applied the patch provided. Thanks!

commit 0ba062b88c607f1c6d82e19de9a715363348bd86
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 13 17:51:40 2015 +0000

    Unregistering commands we don't really need

commit 67b4e2d2ca3611b13d7dc5e0ad2efcd78a9c7b0f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 13 17:51:14 2015 +0000

    Adding unregisterSmbCommand(), unregisterNTTransaction(), unregisterTransaction2() and unregisterTransaction().
    Useful if you want to provide a constrainted SMB Server.
    Note that if the command asked by the client is not registered, the SMB Server will automatically return STATUS_NOT_IMPLEMENTED.

commit f96cae5f6f47ee4b5f71a1e73925d5b5a7992b26
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 13 16:19:28 2015 +0000

    Let's try to avoid allowing write requests from the client back to us
    not 100% bulletproof, plus also the client might be using other SMB
    calls (e.g. SMB_COM_WRITE)

commit f12a89c3656a7a490df201c4284d73e9ef03ca5f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 13 14:26:56 2015 +0000

    One important ToDo:
    
       [ ] Disable write request, now if the client tries to copy
           a file back to us, it will overwrite the files we're
           hosting. *CAREFUL!!!*

commit aed578854fff86653e4129c49d341d4a04c19784
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 13 13:45:29 2015 +0000

    Adding NETLOGON, SYSVOL shares (fakes), in case they are asked

commit 004371f5d04345bbb999c256a92973350b9d005f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 12 12:24:19 2015 +0000

    The idea of this script is to answer any file read request
    with a set of predefined contents based on the extension
    asked, regardless of the sharename and/or path.
    When executing this script w/o a config file the pathname
    file contents will be sent for every request.
    If a config file is specified, format should be this way:
       <extension> = <pathname>
    for example:
       bat = /tmp/batchfile
       com = /tmp/comfile
       exe = /tmp/exefile
    
    ToDo:
    [ ] A lot of testing needed under different OSes
    [X] It's not working for first level directories
        (e.g. \\IP\share\file) - DONE
    [ ] Add support for other SMB read commands. Right now just
        covering SMB_COM_NT_CREATE_ANDX
    
    I'm not sure how reliable this approach is, so I might ditch this in the future.. hopefully no!

commit ccc3f55f2aee09dade22513201e64c8c33a2879e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 11 21:42:06 2015 +0000

    Fixed bug in transaction hook functions

commit 67bdc297120c5f3c96ec5c0710aa90352cf75a74
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 21:10:55 2015 +0000

    Fixed wrong calling of SBMConnection.readFile()

commit 2f3e335f13e8a7bcfd929d1fd09691cc050e9e1e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 21:02:53 2015 +0000

    Adding kerberos test cases

commit 33e17a79e73f93b9a8c396d06b772ae4442eec33
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 20:59:12 2015 +0000

    From now on, when doing ncacn_np communications, we're not using transactions anymore, now calling directly to writeFile

commit 06b8b563e15553b2380a8462ecf7a09f690f6373
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 18:08:22 2015 +0000

    Adding Kerberos test_cases

commit feec49e6d4235256d6924e2ca390efdefb67e918
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 14:20:54 2015 +0000

    Better error checking for suplementalCredentials. It was failing on some old XP systems

commit 7634f3e526f5b0c1028914a227ef8395cf11606d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 13:47:50 2015 +0000

    If we receive KDC_ERR_ETYPE_NOSUPP, we give it another try using RC4 (if not
    used before) and hope for the best.
    Seems to be a decent way to make kerberos work against some old Windows XP
    boxes. Still having some problems at the DCERPC level tho.

commit aa048d45f15b5fc57a58f718f4776d56ccba7a09
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 8 22:07:23 2015 +0000

    If we receive KDC_ERR_ETYPE_NOSUPP, we give it another try using RC4 (if not used before) and hope for the best.
    Seems to be a decent way to make kerberos work against some old Windows XP boxes. Still having some problems at the DCERPC level tho.

commit be4980960c0b158b5e82f50fdc6ba9e2e30c90b5
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 8 00:17:37 2015 +0000

    When calculating the stringBinding.. convert what we receive to uppercase.

commit c39c79c889d861e2c670f0d1ae13587d1a380932
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 8 00:17:13 2015 +0000

    Trying to decode a KerberosError if it happens.. still not perfect.. we should interpret the krb5_blob here

commit 38a915a0541ff0c8edb2f28eb8bfc7f044378859
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Feb 7 23:51:38 2015 +0000

    Forgot one raise ;)

commit 9a9b40225276a0f19abf7a021f9218ff786b8aa8
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Feb 7 23:48:28 2015 +0000

    Attack might have worked, but when asking for the cifs TGS we get KDC_ERR_ETYPE_NOSUPP. If that happens, we try all over again using RC4

commit 2d119b71cee41eff851d374e1e1ea2b534559fbd
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Feb 7 22:40:50 2015 +0000

    Fixed typo

commit cc3e726c764519a52a8386226348cf9703e05d63
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 5 20:23:26 2015 +0000

    Replacing Crypto.Random.get_random_bytes for our own implementation

commit 1765c3984a0821ebccb3c31f6893680dac192c34
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 2 14:49:33 2015 +0000

    Kerberos support added

commit 1f6095f0133992a68f695066fbba80fd4ca926a5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 2 14:32:21 2015 +0000

    Removing traceback

commit 72fd4ec15aaac83932a960a282cae989b1f9cb5e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 2 14:31:39 2015 +0000

    GSSAPI_AES128 support

commit 0c4d21c073a665513e1abbff6264946023d1ba1f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 2 13:52:43 2015 +0000

    Credentials are now passed by command line, aligned with other scripts. You can still logoff/logon inside the mini shell tho.

commit 2d04544c44d5e0c7cd9fda43a237849757ccc8e9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 21:21:36 2015 +0000

    service install ported to the new dcerpc.v5

commit 32e10b80271185597a3ea4579787495b140c73ee
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 19:56:17 2015 +0000

    Add domain FDQN whenever possible

commit f2ff812d3b347d0ea4144fb5122fb99652d3d069
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 17:52:36 2015 +0000

     Adding support for pass the key

commit b3c614ab6b38ae6446fb898fd44a967ceedf4336
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 17:28:37 2015 +0000

    Adding support for pass the key

commit 27f0b5b43d7b970f84e2f7ddfac6e125e6fca834
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 17:19:12 2015 +0000

    This changeset adds support for Kerberos pass the key, originally implemented by Benjamin Delpy (@gentilkiwi) in mimikatz.

commit 2fd3bf2289f30d0cdf1c81cb930484b1f43d7240
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 00:18:21 2015 +0000

    Adding parsing of [MS-SAMR] 2.2.10 Supplemental Credentials Structures. I'm just grabbing the kerberos keys, just the "new" ones. I could grab the WDigest data... but still don't know how to use them effectively.
    How to use these kerberos keys?.. coming soon.

commit 20ea3c498546289378ab51f45cf54e2c395491d8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 00:06:38 2015 +0000

    Adding [MS-SAMR] 2.2.10 Supplemental Credentials Structures structure

commit 38c59dd9977c456daa1ac3054af601c31cadd1f5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 29 19:34:23 2015 +0000

    Adding capability to export to John The Ripper format files

commit 32ec8ab90fff2717ebeef33bdb25b1ada49b8315
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 27 15:10:29 2015 +0000

    Adding support for SMB Encryption. It will be used if the target server requires it either at session or share level using AES_CCM. Current stable pycrypto does NOT support this mode. For this feature to work you will need to download/compile and install the experimental version. Currently it is https://ftp.dlitz.net/pub/dlitz/crypto/pycrypto/pycrypto-2.7a1.tar.gz

commit e7ff108eced16286ceeb1c8c57845e08289e4819
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 23 12:54:36 2015 +0000

    Updated description

commit 51215ea8017dacc1d0617dc05243fe3271a56437
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 21 21:35:25 2015 +0000

    Ported to dcerpc.v5

commit bdaaf07616d6f954897a5056ca31444df3906a9b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 21 21:06:21 2015 +0000

    DCE [C706] MGMT Interface Implementation

commit 98b5269290487362e6cf02fdffcbe746672e90bf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 21 21:02:38 2015 +0000

    Ability to avoid checking errors in the DCE RPC answer (needed for mgmt interface)

commit 5fd8e8753dceaefe94cd54c5e54cc86fb8f9b395
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 21 20:34:15 2015 +0000

    Changing pad calculation for arrays when TS is NDR64

commit 90c38e248f7e111704375e71109fe2c7c21955cf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 20 23:35:57 2015 +0000

    Added deprecation warning message to all non dcerpc.v5 classes

commit 29d18e8cfde391cd5d5194bce5d236a585642425
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 20 22:53:16 2015 +0000

    Updated copyright

commit 6957420118347d698496e75ff47196d3c0fdc248
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 20 19:59:06 2015 +0000

    Removing -port parameter. Not needed

commit 3c2e430b6dd3e09305a892cf6718fda3a50dcecd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 20 17:12:26 2015 +0000

    1) kerberosv5.py: Fixing typo in error message
    2) smb.py: When building the principal name, the remote_name should be used instead of remote_host
    3) smb3.py: getaddrinfo should be done on the self._Connection['ServerIP'] variable

commit 15228f4563f24be92872faf99de5fc3f3204a4aa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 20 15:07:34 2015 +0000

    Adding get and put commands to the semi-interactive shell. You can include drive letters as destination pathnames as well. It'll use the drive letter as the share (plus '$') to connect to.

commit dd1500e65f457b15f9baa9545c073d153bde5e4a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 14 18:30:14 2015 +0000

    upgrading to dcerpc.v5

commit d7a4be2ef84a00c16e4be5b145184c304294112f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 14 18:26:53 2015 +0000

    Removing unnecesary imports

commit 14515391aa5b3ca8c24a5929373c72fd094e5636
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 14 18:25:56 2015 +0000

    Getting rid of the old dcerpc library.. now using dcerpc.v5

commit bbce63a34a6b14e434cb35d7e881f975ea10242a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 14 16:32:03 2015 +0000

    Clarifying target could be an IP address or targetName

commit b4cacea6afc6dc5c7e03aa4d55cf6520e21837b1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 13 21:01:41 2015 +0000

    Sending ServerName = '\x00' instead of NULL. Older Samba implementation fails to accept NULL as paramenter.

commit 747f8848beb43572a47826d53fbfabb117ac77c4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 12 14:22:33 2015 +0000

    1) Better error reporting when we cannot resolve a hostname and when domain is not specified
    2) Improved the way we calculate offsets inside authData for WRAP structure parsing

commit 6439379c7c24e72a67187a5b02035eff09bbc008
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 12 14:17:27 2015 +0000

    Added debug output flags. Nothing much is outputed now but migth be useful in the future

commit a5d7e7dad7b71aff82690e17588c3421b1ebf142
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 12 14:16:10 2015 +0000

    Since targets can be IP addresses or hostnames, I'm changing some internal variables/methods names to be consistent.

commit 107b3bc6a162e5494fb3242be06161fc6c92a68c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 21:55:22 2015 +0000

    Copyright update

commit 661145e669185f5baa255def308ac56b1896b81b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 21:52:47 2015 +0000

    Updated documentation about AES256-CTS-HMAC-SHA1-96.

commit 1334f7bd4b5b170c1300166c38f74bfd75224428
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 21:44:50 2015 +0000

    Enabling AES128-CTS-HMAC-SHA1-96 support for all Kerberos operations (including goldenPac.py). RC4 would be used only when hashes are specified or KDC_ERR_ETYPE_NOSUPP is returned when trying AES.

commit 17e23eaa527baa7a503a238505d032b3fafee9f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 20:50:32 2015 +0000

    GSS_Wrap and GSS_Unwrap for AES256.. finally.. closer we are..

commit 27bbf85a2d42f97adb3d0837a392fa8a4045cb0e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 00:11:07 2015 +0000

    Kerberos support added (incl. ccache)

commit ad1959a0258ad158a5234949aea57660757d2752
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 00:07:49 2015 +0000

    Kerberos support (incl. ccache)

commit 700bbb6d9f9d5b2198976367686c0645142b542b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 00:03:02 2015 +0000

    Kerberos support (incl. ccache) for psexec.
    
    jack:examples beto$ klist
    Credentials cache: FILE:/Users/beto/ccache
            Principal: normaluser7@FREEFLY.NET
    
      Issued                Expires               Principal
    Jan  8 20:11:32 2015  Jan  9 06:11:32 2015  krbtgt/FREEFLY.NET@FREEFLY.NET
    jack:examples beto$ python psexec.py -k -no-pass freefly.net/normaluser7@freefly-dc cmd.exe
    Impacket v0.9.13-dev - Copyright 2002-2015 Core Security Technologies
    
    Trying protocol 445/SMB...
    
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    [*] Requesting shares on freefly-dc.....
    [*] Found writable share ADMIN$
    [*] Uploading file oaZRkqjh.exe
    [*] Opening SVCManager on freefly-dc.....
    [*] Creating service gpvj on freefly-dc.....
    [*] Starting service gpvj.....
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    Using Kerberos Cache: /Users/beto/ccache
    [!] Press help for extra shell commands
    Using TGT from cache
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    Microsoft Windows [Version 6.1.7601]
    Copyright (c) 2009 Microsoft Corporation.  All rights reserved.
    
    C:\Windows\system32>whoami
    nt authority\system
    
    C:\Windows\system32>

commit 8953ece80adc91c3bc0bb5bee6c3c7e8c6afa129
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 23:26:02 2015 +0000

    We're forcing connectTree to use the target's IP address instead of its name. Might bring some issues.. not completely sure yet

commit fa6950ede474af5a4862d0b1c84d65d3bcae7bc9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 21:28:44 2015 +0000

    Adding -no-pass switch, uniform with the other scripts we're adding kerberos support to

commit ed89b315b74aa8a564ec6d27b0d5b5a0f922dce6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 21:24:29 2015 +0000

    removed import that was not used

commit 5b8e9981d929bc0ce2c59deaf95af497cb0ada8c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 21:22:41 2015 +0000

    Duplicate import

commit ebeacd25ca1a409c805b3b07281be60b9ac023a6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 21:18:27 2015 +0000

    Adding kerberos get/setter to the base transport class so we can do kerberos through the transport factory

commit 1d8f3a9a83a02092b75719d252ac29ca578dcdca
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 20:22:59 2015 +0000

    Better handling of NTLMAuthChallengeResponse.getData()/fromString(). Still not perfect since it's not possible to know whether the MIC field will be there or not w/o inspecting the Challenge message's AV PAIRS.

commit 5c6005027673c34101df58d18bfb44018453cde5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 16:17:55 2015 +0000

    Adding  getActiveConnections()

commit a170f7a02c1d65a506e0563655282e2841af5563
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 13:28:46 2015 +0000

    Added -dc-ip option, in case you want to target an specific domain controller or cannot resolve

commit 015c4efd28d960d9dbd2d0c6f5392368c3dac1af
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 00:57:32 2015 +0000

    1) Sequence number needs to be reseted when altering contexts
    2) Removing CCache status messages for RPC since it generates a lot of noise

commit 634aac146194c8076b2466c38e3811e56277e253
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 7 21:56:32 2015 +0000

    Happy new year :)

commit 5372825c7f4855f0d19ce7d7b25dccb388a66b04
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 7 21:56:08 2015 +0000

    Kerberos support for secretsdump.py. Matches the same usage of wmiexec.py (e.g. -no-pass switch)
    
    Examples:
    
    jack:impacket beto$ klist -v
    Credentials cache: FILE:/Users/beto/ccache
            Principal: Administrator@FREEFLY-2012R2.NET
        Cache version: 4
      KDC time offset: -1 second
    
    Server: krbtgt/FREEFLY-2012R2.NET@FREEFLY-2012R2.NET
    Client: Administrator@FREEFLY-2012R2.NET
    Ticket etype: arcfour-hmac-md5, kvno 2
    Ticket length: 1155
    Auth time:  Jan  7 18:43:10 2015
    End time:   Jan  8 04:43:08 2015
    Ticket flags: enc-pa-rep, pre-authent, initial, proxiable, forwardable
    Addresses: addressless
    
    jack:examples beto$ python secretsdump.py -k -no-pass FREEFLY-2012R2.NET/Administrator@FFLY-2012R2-DC
    Impacket v0.9.13-dev - Copyright 2002-2015 Core Security Technologies
    
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    [*] Service RemoteRegistry is in stopped state
    [*] Starting service RemoteRegistry
    [*] Target system bootKey: 0x22d7b24d8eb4032e9ba9baaf0f4f6b93
    [*] Dumping local SAM hashes (uid:rid:lmhash:nthash)
    Administrator:500:aad3b435b51404eeaad3b435b51404ee:ebd8ac3ca25e615c406c2c15b44a6ca6:::
    Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
    [*] Dumping cached domain logon information (uid:encryptedHash:longDomain:domain)
    [*] Dumping LSA Secrets
    [*] $MACHINE.ACC
    FREEFLY-2012R2\FFLY-2012R2-DC$:aad3b435b51404eeaad3b435b51404ee:0f88dee50c20e5a7c479df5c0ed94297:::
    [*] DefaultPassword
    (Unknown User):ROOT#123
    [*] DPAPI_SYSTEM
     0000   01 00 00 00 FC 8A 2B 5A  CE F6 FF 89 5D 0A C9 08   ......+Z....]...
     0010   62 60 22 29 D3 C0 19 41  B1 4D F7 B5 D7 68 72 75   b`")...A.M...hru
     0020   DE 37 EA 67 1B 20 FA D5  A8 1A F8 C1               .7.g. ......
    [*] NL$KM
     0000   9E B3 1A 1B C7 7F 28 87  9D D3 23 EB 9A 13 D6 FC   ......(...#.....
     0010   B8 E7 41 DE 8A F6 2B 4E  57 91 36 0D AD B5 39 8A   ..A...+NW.6...9.
     0020   86 4D D8 30 ED 0E 97 68  0B 0A 87 E5 D1 03 E5 8F   .M.0...h........
     0030   A2 ED 0C 75 C5 F3 DB 69  2C CD BB 1E 4C 82 C1 29   ...u...i,...L..)
    [*] Searching for NTDS.dit
    [*] Registry says NTDS.dit is at C:\Windows\NTDS\ntds.dit. Calling vssadmin to get a copy. This might take some time
    [*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
    [*] Searching for pekList, be patient
    [*] Pek found and decrypted: 0xe2f4cbb594d082e5ddc8bf0fb9892746
    [*] Reading and decrypting hashes from \\FFLY-2012R2-DC\ADMIN$\Temp\oBqCwVyB.tmp
    Administrator:500:aad3b435b51404eeaad3b435b51404ee:eba8ac3cb25e605c606b2c15b43a6ca6:::
    Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
    FFLY-2012R2-DC$:1001:aad3b435b51404eeaad3b435b51404ee:0f88def50c20e5a8c479df6c0ed94297:::
    krbtgt:502:aad3b435b51404eeaad3b435b51404ee:98fceba6f84d49a9837e6cf992c926ec:::
    FREEFLY-2012R2.NET\user1:1104:aad3b435b51404eeaad3b435b51404ee:2f5de3f35895d71d9cf16e52511cb692:::
    [*] Cleaning up...
    [*] Stopping service RemoteRegistry
    [*] Cleaning up...
    [*] Stopping service RemoteRegistry

commit b58f9379e50e0a3a7bdf80f73d09075b3371ed5f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 7 21:45:09 2015 +0000

    Kerberos support for wmiexec. It can use cached tickets or specified credentials.
    
    jack:examples beto$ kinit Administrator@FREEFLY-2012R2.NET
    Administrator@FREEFLY-2012R2.NET's Password:
    jack:examples beto$ klist -v
    Credentials cache: FILE:/Users/beto/ccache
            Principal: Administrator@FREEFLY-2012R2.NET
        Cache version: 4
      KDC time offset: -1 second
    
    Server: krbtgt/FREEFLY-2012R2.NET@FREEFLY-2012R2.NET
    Client: Administrator@FREEFLY-2012R2.NET
    Ticket etype: arcfour-hmac-md5, kvno 2
    Ticket length: 1155
    Auth time:  Jan  7 18:43:10 2015
    End time:   Jan  8 04:43:08 2015
    Ticket flags: enc-pa-rep, pre-authent, initial, proxiable, forwardable
    Addresses: addressless
    
    jack:examples beto$ python wmiexec.py -no-pass -k FREEFLY-2012R2.NET/Administrator@FFLY-2012R2-DC
    Impacket v0.9.13-dev - Copyright 2002-2014 Core Security Technologies
    
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    SMBv3.0 dialect used
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    [!] Launching semi-interactive shell - Careful what you execute
    C:\>whoami
    freefly-2012r2\administrator
    
    C:\>

commit 83f871605ddd4f716ad4c1cdaf3293caabce4d00
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 7 21:42:36 2015 +0000

    Kerberos support for DCOM.

commit d9f6c98941c90dc3035c669c52df2cfa9d9c8e92
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 7 16:49:49 2015 +0000

    1) Replacing NTLM_AUTH_* for RPC_C_AUTHN_*
    2) String binding calculation now has in mind the target_ip can actually be a netbios name

commit 81598e19bc30274cd0e05102175bbc83ba343e60
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 6 19:26:15 2015 +0000

    More GSSAPI stuff. Right now, RPC SIGN/SEAL should be working for RC4. AES still not there

commit 6ce21783a4bb3ed018d56e7c5158aee3fe460551
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 4 21:52:54 2015 +0000

    typo in constant name (not value)

commit 41a2a0f64297c2cd4a6d75546cb5e1fb1f2591e4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 4 19:48:28 2015 +0000

    Support for RPC_C_AUTHN_LEVEL_PKT_PRIVACY for Kerberos. RC4 only so far

commit 17323a5f8d344a7abc96d28292b480bb1025b2cb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 22 21:01:34 2014 +0000

    Kerberos support for samrdump

commit ed1eaed9825a370df9c2d1c445f5949ff91c7cbf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 22 20:54:59 2014 +0000

    Adding RPC_C_AUTHN_GSS_NEGOTIATE support for DCERPC. Not yet functional, although I can now bind using Kerberos as SSP. Still needing to work on the authenticators for signing/sealing.

commit d3d623ffe70c3dc025820850863400fc3e41ec73
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 19 16:54:14 2014 +0000

    All domains in uppercase.. just in case

commit fd638816dff817d16bd567913bda46f28ce0eefe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 19 16:31:51 2014 +0000

    Adding -w ability to save the goldenPac y CCache format

commit 82fed57e303166408ad8613a7806ec170c57d784
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 19 16:30:58 2014 +0000

    Adjusting to new getKerberosTGT, getKerberosTGS output

commit db0c491213179798f309a619564083e8bdafc34a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 19 16:28:57 2014 +0000

    1) Better parsing of ETYPE_INFO and ETYPE2_INFO
    2) Better handling of etypes
    3) Support for writing CCache files

commit dd7516b9e36e754d7e8b6fa3def1134da69dc1bd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 20:06:15 2014 +0000

    opening the file with 'rb' for our Windows friends

commit 4386b864ba3845d1302c92f2454c8fbdba15694d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:44:13 2014 +0000

    Improved getMachineNameAndDomain() in case we can't get the data the normal way. Now it will try RPC against wkst. This is needed when authenticating using Kerberos.

commit 11a3ac8df300d13b4989b73e085641e447ef0fd1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:20:01 2014 +0000

    Disabling AES256/128 until I figure a bug out

commit 0e7f2bc32ad8528fb62b01c03b864aad2da6e7cb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 16:12:40 2014 +0000

    An example added for the -c flag

commit 4b54788c2b4c97aa59bcad8eeb6bf1936196d5fe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 16:09:06 2014 +0000

    1) kerberosLogin will never use cached tickets (useCache = False)
    2) Added -c flag, uploads a binary and executes it

commit 8d4fe046ebdd35fe038cc0d9c49863978ed3a924
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 21:33:33 2014 +0000

    My first take on Kerberos support for secretsdump.py.. Two ways to use it
    1) Have cached tickets in your ccache file (pointed by KRB5CCNAME). E.g.
        kinit beto@FREEFLY.NET (my password will be asked)
        klist -v
        secretsdump.py -k FREEFLY.NET/beto@FREEFLY-DC
    
    2) Use the specified command line credentials. e.g.
        secretsdump.py -k FREEFLY.NET/beto:myPassword@FREEFLY-DC

commit fe290c618005344a785f3b16c98ee507e9c5fa10
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 19:21:27 2014 +0000

    Printing out the domain+rid = userSid.. might be useful for some ppl

commit 0a84907c4562fcf2455ae0959bbb042256a11b2f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 16:44:10 2014 +0000

    Support for AES128 and AES256. If hashes are specified, RC4 will be choosen.

commit ed4e2c35d952bd526edec00e9f309c2f64b0e275
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 16:42:03 2014 +0000

    1) Now Kerberos should work with AES128 and AES256 as well.
    2) If there's a cache, it will look for valid credentials and use them if possible

commit 2c2ac326db71c9c118a2f6a2ba905e6b7439e03c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 15:14:51 2014 +0000

    Making it more general, not tied to RC4

commit 8cd229d7e6623004f76aa3c462062ac74026481c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 13:13:54 2014 +0000

    CCache initial implmententation.
    The idea is to be able to use the cached tickets to automatically log in. Still not activated.

commit 285aa21c4547c8cfad147c630828f3ccb80e9f39
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 12 14:12:38 2014 +0000

    Missing import (thanks juan!)

commit f37d3dc9613589a2274b1e5baec563ce0fc96284
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 12 00:48:26 2014 +0000

    Minor change, we don't really need to set the amount of groups staticaly :P

commit 3b7bce75e004346c0e7d5fcd7daa82a9fb2486af
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 12 00:44:34 2014 +0000

    More documentation for getGoldenPAC(), adjusted some values based on [MS-PAC] description.

commit c858ba572eb1b0fb7bd43b1ec7aa304a676efcfc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 19:31:27 2014 +0000

    Minor changes to the hashes code

commit 75dffd7619cd890faccd3178c13d4546a2a1e154
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 19:24:10 2014 +0000

    Hashes support for Kerberos (will only work when cipher == RC4)

commit 6d76dea61b8f634f1d80a412adbac784f01a90de
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 19:15:32 2014 +0000

    Hashes support added. This only works with RC4

commit 519060a53cbca0151f31651b14b339d7de07404b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 14:59:45 2014 +0000

    KERB_ERROR_DATA data type added

commit 4a4d053e0687eb696dd5cd432efb8c502cf700de
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 14:58:43 2014 +0000

    Requirement's update

commit d3cf806ca088a1719c6ee633e8e84e2d1d5daa00
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 14:51:20 2014 +0000

    Added commented lines for MD4 and CRC32 unkeyed checksums if somebody wants to use something different than RSA_MD5

commit fa55414498e00d8d607a3deeba16098cb4eab4ff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 13:28:47 2014 +0000

    If we receive a KRB_ERR_GENERIC error we try to extract the NT_ERROR from it.. might fail sometimes..

commit 8ddd84d0507fb2c53f6ba8d5cf5d9fdb7d588f1f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 19:31:58 2014 +0000

    Added smbconnection.getServerDNSDomainName()

commit 6a89785203bfc7af9f064592681514fae65af057
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 16:17:12 2014 +0000

    lcd fix in case os.chdir() fails, improvements to the TGS request

commit 43376416668bdcc6aaca8b31cdf691c2d4a25a04
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 14:41:52 2014 +0000

    PUT and GET weren't working. Hopefully now that's fixed. I wasn't starting the transferClient connection with the forged TGS ticket, and were using the normal user's credentials, hence getting an ACCESS_DENIED.

commit 0719d451b65c31903f878c15132910d649877ee9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 13:17:50 2014 +0000

    1) epm.hept_map doesn't work well against w2k03, so we're sticking to the ncacn_np stringBinding
    2) Minor cosmetic things

commit 5e9d7b0031e341a2df578ebd49e32d646fb93252
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 9 16:05:52 2014 +0000

    1) Added Kerberos support for SMB1
    2) When asking for a TGS for cifs service, domain is not needed, could potentially bring problems if the target includes the domain FQDN

commit d869a24fc49a0116cbc16de4d3d57638c4d935bb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 7 11:26:54 2014 +0000

    Fixes https://code.google.com/p/impacket/source/detail?r=1278

commit 23505695b153da6a683d81c86185383c3cbee798
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 7 11:25:32 2014 +0000

    Cannot execute as a script w/o this! ;)

commit d914b02710d0d3e6d5dbc57ef7fd4f066ebd4044
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 6 13:10:42 2014 +0000

    My take on MS14-068. Credit goes to @BiDOrD since he's got a PoC out first. Well done!

commit e9b4176f9c58e4617a70589861b97ea7e3e69350
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 6 06:05:11 2014 +0000

    1) kerberosLogin: now you can specify a TGT/TGS if you have one
    2) fix a bug in smb3 when calculating the signing key

commit 94bcf46ebebb100f06cd5c4831b05dde56ee37ea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 6 02:12:35 2014 +0000

    typo in AuthorizationData()

commit 166c7b0d364cae10e67816e78db9e6962eca5655
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 5 16:32:59 2014 +0000

    Removing debug dumps.

commit feb172ebc9bbd0da69870e9abf4062a840ec0215
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 5 12:45:37 2014 +0000

    Initial support for Kerberos (see previous commits for the libraries).
    From smb_client use:
    kerberos_login {domain/username,passwd} - logs into the current SMB connection using Kerberos. If no password specified, it'll be prompted. Use the DNS resolvable domain name
    
    It supports RC4 as of right now.

commit 7ed183aa48ced1e58581ece82cebcea12935ac6f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 5 12:43:45 2014 +0000

    1) Added kerberosLogin() to SMBConnection. Only SMB3 dialect supported so far
    2) Simplified Kerberos structs using dicts

commit 02ef6075f7c37da7239646f5dc63b65671854569
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 4 23:58:30 2014 +0000

    recv() doesn't always return the requested bytes :p

commit fe609d9444982d74e4b53d848962dd8729db2f60
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 4 21:35:43 2014 +0000

    Reverting previous accidental change to this file

commit b0fa3071d340083d291c33838e672d741c6495c0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 4 21:33:38 2014 +0000

    1) First attempt to support kerberos. Right now it's kerberosLogin(). Might be different in the future. Alpha code
    2) Start signing at the second packet sent (this is important for Kerberos signing)

commit 80faca5f6ea8ac62fffae6626abc47b3b4beb7a1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 4 21:31:44 2014 +0000

    Initial Kerberos implementation!
    asn1.py, types.py from https://github.com/mhorowitz/pykrb5 with some modifications
    crypto.py from XX
    Licenses should be OK

commit a023d3ffc6d879b2412c4ef485df7799194c2ddc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 13:43:31 2014 +0000

    Since share names can be UNC or just the name of the share, we should check them accordingly.

commit 8903e1211bbdf7424f902d588cf348832e9455b7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 24 13:53:18 2014 +0000

    adding a connectTree test case, with abs path and UNC path

commit 37af2379981a56d663010c2c96754566a0a61054
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 21 21:51:48 2014 +0000

    These fixes should allow using smbfs from Ubuntu to mount a share exported by the smbserver, e.g.:
    mount -t cifs //192.168.1.1/sharename /mnt
    
    1) Fix in the extended authentication mechanism, when a GSSAPI token is not received, and just a straight NTLMSSP structure.
    2) The smb.SMB_FIND_FILE_DIRECTORY_INFO structure wasn't completed when asking for a FindFirst2 with that level
    3) When calling NTCreateAndX, we weren't paying attention to GENERIC_READ and GENERIC_WRITE attributes

commit e9fb70adf5fc83470223d9fbf862b7667f940b6c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 17 18:31:29 2014 +0000

    switching to unicode before processing the actual command. This is needed in case directories/files are unicode encoded. Thanks renaud for the fix. This is part of the bigger https://code.google.com/p/impacket/issues/detail?id=51 issue

commit d746e86b8d51c74acbd851768fbcc03eeb49aff7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 15 23:09:31 2014 +0000

    Only parse the version field if we have some data. Just connected to a samba server and it is supporting SMB3, so this is not only Windows anymore. We should check in the future if Samba servers are returning something in the version field.

commit 2456145b8b7244ec7bc6231ca1c9414634ac7706
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 8 19:17:02 2014 +0000

    Clarifying one message..

commit 0ee8a7043414a015a2d9dbdc58c1729d1d6df6d5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 8 16:05:23 2014 +0000

    Fix trying to work correctly in the scenarios where NTDS.dit is not located in the default location.
    Thanks to mubix for pointing out the registry key to read for NTDS.dit location

commit df4d41c7fb5b56a0cb52408d2cee0534c197dc03
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 30 20:20:31 2014 +0000

    Fix for https://code.google.com/p/impacket/issues/detail?id=47 reported by carlruth

commit 9d9e3d73b23c688e411707898b695cf1c4370094
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 29 17:45:40 2014 +0000

    Fixes https://code.google.com/p/impacket/issues/detail?id=49 reported by mykesh

commit 2021a4072141aa4d1a2eb36003aa4c097e4b5d85
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 26 17:35:02 2014 +0000

    Fixes https://code.google.com/p/impacket/issues/detail?id=48 reported by Renaud

commit cc78dffc12384b7c13fa3bc921ac5e0f4e267acb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 26 17:33:53 2014 +0000

    Fixes https://code.google.com/p/impacket/issues/detail?id=48 reported by Renaud

commit aaf5ec1c266e5b444d15fec1fa363898af0de570
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 13 18:45:42 2014 +0000

    Typo when parsing the SMB2_SESSION_SETUP data.. It should be packet variable instead of ans!

commit 8115cff6e3d82bdda79e0b16b3e5b02bf5f6ed5c
Author: 6e726d@gmail.com <6e726d@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 3 00:15:29 2014 +0000

    Fixed minor bug when using -hashes parameter.

commit 2b6de58c7e7aac7858b33a0aba6b214963c5ccc1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 31 15:38:19 2014 +0000

    Temp fix for https://code.google.com/p/impacket/issues/detail?id=46 until we figure a better way to solve it.
    We're setting the Max*Size to min(0x100000, value-sent-from-server), which we know it works (Win7/8 sets it to 0x100000).
    In theory win8.1/2012R2 sets it to 0x800000 and for some reason the connection gets closed. However, my tests serves doesn't set the Max*Size to such big number, although a user reported it. More research needed.

commit a7672e4580c66242376045cbe2468b54be01a869
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 26 22:09:44 2014 +0000

     - Added file that contains pcap linktypes.

commit dc80285984cff34a988a34815902c0d256507f2c
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 26 20:30:07 2014 +0000

     - Moved pcap MAGIC outside the pcap header structure.

commit e672dc07950165b7a0f21198ae0415c6b32bcf9e
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 26 20:27:58 2014 +0000

     - Added frequency channel dictionary.

commit 6f94d4e43ebb697efb690bcc6684d50f6b010b11
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 17 16:21:37 2014 +0000

    Moving up to the next dev version

commit 5628648353a977a96c9f06b9dd2f39fc1512a3a6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 17 16:01:46 2014 +0000

    version change

commit b72c5eeea0b52fe1d9492c6ec2de4fcc4911f093
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 17 15:29:23 2014 +0000

    new version

commit 7075ae880609afb4598276dfbb86d358c60775ce
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 17 15:03:34 2014 +0000

    New features added

commit 893542cbce582b0c26ebdfd41a7e0db0849877d9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 26 13:54:47 2014 +0000

    Updating reference to testcases

commit 7d774b59a092340874ccfcbdebf19f62201625f5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 25 21:00:28 2014 +0000

    Bye bye

commit 82f4a4d4df76c5d0db6eecf8335acff5dff9e4e8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 25 20:58:48 2014 +0000

    You shouldn't be here

commit 669509ec11d07585f1ae2758f2128b14cc8fd1b5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 25 20:55:38 2014 +0000

    1) Moving SMB-RPC to SMB_RPC
    2) Changing inside dot11, test- for test_

commit e07ed49851310c75e3849a077e99b8a3d1656bfd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 23 18:14:15 2014 +0000

    Added command line arguments to set up a share. Now it should be really easy to launch an SMB server :)

commit 9065577d6b2cda0acb1a43441a87ca4c2a4dd68a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 11 15:36:00 2014 +0000

    1) smb.py: added SMB_COM_FLUSH structure
    2) smbserver.py: added SMB_COM_FLUSH command (not active yet)
    3) smbserver.py: added outputJohn call, everytime someone logs in, we output in John format the challenge/response, for further cracking

commit 9d74b68931e5cedb89dd2e9d0a3cbf2fc2d0205c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 19:46:08 2014 +0000

    No need to restrict the max packet size in Windows anymore :)

commit 1246c46784c92597bc89eaf01873fd677b0414a3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 19:33:13 2014 +0000

    infoRecord['EndOfFile'] can be zero, we gotta check that

commit 5b8d2dc2682c770514e27fe4b1e2ad3c1bdecc58
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 18:59:47 2014 +0000

    Adding config option to turn CAP_RPC_REMOTE_APIS on when negotiating the server's capabilities

commit e8453eb12d2ff450c67cb1c47f8a3086031a009e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 18:27:39 2014 +0000

    This changeset adds a minimalistic DCERPC server that is used by the smbserver.
    Why? With modern OSes connecting to the SMB server, you need to have a DCERPC server to serve MS-SRVS and MS-WKST (this last one for OSX clients, not yet implemented), otherwise they will NOT continue the connection.
    1) smbserver.py: added the SRVSServer class, that answers for NetrShareEnum(), NetrShareGetInfo() and NetrServerGetInfo() requests
    2) rpcrt.py: defines the basic DCERPCServer class, as the base class to be used for interfaces

commit b36eee904d2de9cbcdbb8e677101abd51b883460
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 18:09:57 2014 +0000

    Fixed hNetrServerGetInfo() when setting the now non existent InfoStruct field. Test cases updated as well

commit 67e3a13cfbf4824c4135b7df8dcd6fdf5489e0e7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 17:32:53 2014 +0000

    fixed NetrServerGetInfo() structure.

commit abb9d9bb05cf79cc3e3a019a0d11b60f83a2ff0a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 14:00:56 2014 +0000

    1) Docstrings added to SimpleSMBServer()
    2) Trans2/SMB_SET_FILE_END_OF_FILE_INFO now actually works, lseeking to the proposed allocated size
    3) I'm commenting  os.O_APPEND when opening a file, I think it is not needed and prevents 2) from working. Testing is needed

commit 48412a928c269325d0e473d23c9702f75aba2c38
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 9 17:07:34 2014 +0000

    Setting 127.0.0.1 as the address to bind and connect to the MS-SRVS server

commit a3ba4bbff2565734f0697d83546fcc41d32e5aa4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 9 16:51:07 2014 +0000

    1) Removed the smbserver directory
    2) Now a single smbserver.py example, that contains everything needed to run a simple SMB server and share files

commit a41382de3b12dbe1d0d4044db673716596021ffb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 9 16:49:43 2014 +0000

    1) smb.py: added CAP_RPC_REMOTE_APIS
    2) smbserver.py: Added SimpleSMBServer().. An easy way to launch a SMB Server and configure shares.
    3) smbserver.py: MaxMpxCount is set to 1 now, we don't want to deal with multiple connections from the same target.
    4) srvsvcserver.py: Now works with logger, some methods for processing config files refactored.
    5) srvsvcserver.py: Secondary address now points to \PIPE\srvsvc, this is needed to OSX clients.

commit 943286fa287203498dda1cab5da37aea52b49eec
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 5 22:28:55 2014 +0000

    Fix for https://code.google.com/p/impacket/issues/detail?id=44.
    SMB.retr_file() calls SMB.nt_create_andx() that was trying to open the file RW, which would trigger a problem when trying to read a file from a readonly share.
    I changed SMB.nt_create_andx() so it will accept an accessMask parameter (by default the same it was before, to minimize spash damage). SMB.retr_file() now calls nt_create_andx() with READ ONLY accessMask.

commit 99a3592eebc3a4e9827041ae4ec6891bb8fd4285
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 4 18:11:36 2014 +0000

    Stripping useless fstat() calls.

commit 92f1388318293ff2dfe4e2b3a6c46be932cf4f1c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 2 17:13:48 2014 +0000

    1) Added warning message when trying to CD to a directory
    2) StdErr is now also being included in the answer

commit f60357d512fda3b8f07da966be637cd69e357c76
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri May 23 18:51:05 2014 +0000

    Solving the same problem described at https://code.google.com/p/impacket/source/detail?r=1145&path=/trunk/examples/secretsdump.py, this time for esentutl.py

commit a0b82a054c53bdc3b54bb39461ea0d77a1b8800c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 19 14:57:30 2014 +0000

    Sync with Core's internal repository. Several fixes on nmb.py. This file should actually be rewritten, it's still using the old pysmb approach.

commit 77df3c13439869ede5b92bc9d035696634efb957
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 14 20:11:52 2014 +0000

    dcomrt: added set_objRef()
    wmi.py: added IWbemClassObject.SpawnInstance() and IWbemClassObject.marshalMe() (the method's naming convention is intentional :) ). PutInstance() and DeleteInstance() seems to be working well

commit 3a397dcdfef1dbbeab1c8de6abe69f1563cacf36
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 12 19:59:38 2014 +0000

    Fixed bug triggered when maxRid was a multiple of SIMULTANEOUS (thanks mubix!)

commit 3c79905a1ad4b24809791219a8a7fb4667b3cf27
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 11 22:59:12 2014 +0000

    type of default share parameter (should be ADMIN$ instead of C$)

commit ce015b25f3e14a6f5062438d57bae9ca56085838
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 7 19:03:42 2014 +0000

    Waiting for the thread to finish.

commit 2e9e0f3988e1bd934b259f3c036f5e93feb3a9c6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 4 22:49:02 2014 +0000

    1) Changes in the .py initial comments
    2) comev.py: Added specific IID used to self the request to
    3) dcomrt: Now we parse and store the minimum auth level required for the interface, used later when binding against it

commit b59b696c5c641b04309a607901c4d21d264b6908
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 17 15:20:44 2014 +0000

    Added -nooutput switch. You won't get the output of the command, but at the same time it doesn't open a connection against 445 for reading it (plus doesn't write any files at the target). Only works when specifying the command to execute through command line

commit 6214791a1257ebbef100ac665be7ce8099047be4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 20:33:05 2014 +0000

    Fixed https://code.google.com/p/impacket/issues/detail?id=42 reported by mubix.
    This is not the best solution so far, but until I figured out where OrderedDict is installed on different Python flavors i'm using this approach.
    I'm also applying the same fix for the ESE database parser that also uses OrderedDict. (used by secretsdump.py and esentutl.py)

commit b731389fe61b77f67ad7ee05ac3dbb769b256ec7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 18:35:19 2014 +0000

    Removing traceback and exception messages

commit c4421dac880966683df5fa4ad67b8325f5d0a50b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 17:59:24 2014 +0000

    Adding propset ID

commit 1cfe0970213c06e576fb70385b24d3be01a93c23
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 17:57:44 2014 +0000

    Reverting previous changeset

commit 78845a0c2d0b4ef3a5d6667df26737872ecc5fae
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 17:48:38 2014 +0000

    Adding propset Id

commit ace7aa33ae2bef083371071ac1ab0a283e488fa6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 17:46:10 2014 +0000

     A similar approach to smbexec but executing commands through WMI.
     Main advantage here is it runs under the user (has to be Admin)
     account, not SYSTEM, plus, it doesn't generate noisy messages
     in the event log that smbexec.py does when creating a service.
     Drawback is it needs DCOM, hence, I have to be able to access
     DCOM ports at the target machine.

commit e0bbf550c6c6a8ac21463bc66fe4342fcdb1ff04
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 15 16:57:22 2014 +0000

    Just a cosmetic fix so column separators are printed the same way as headers

commit b5aba39e3351d5720ec989aa1d2ab0c8fd1a43a9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 14 20:40:31 2014 +0000

    Getting better..
    1) Changes on names for structures (all upper case) from all the WMIO part
    2) Now we're generating the methods for a class or instance on the fly, whenever they are called (check the ExecMethod example)
    3) wmiquery.py updates

commit 040a723ba0aee4278d26f43cf0361b0ce2e18b99
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 11 21:14:11 2014 +0000

    DCOMConnection by default doesn't launch an OxidResolver thread. Not needed in most of the cases. Wmiquery.py needs it ;)

commit b85197c12afdfe8e8d72cdfacae618995c7183a7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 11 21:12:39 2014 +0000

    More advance.. ExecQuery is starting to work. When calling GetObject, it will dynamically create the methods :)

commit 430b46ef3b25c6584a6931b6d50c49b4c12b3abf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 9 20:42:50 2014 +0000

    Updates for testcases to work with DCOMConnection

commit 21365a76e4c20f83609e8ed2d69d3ee084e54200
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 9 20:07:23 2014 +0000

    typo on one method's name, it should be test_hSamrQueryDisplayInformation()

commit 431bce6543e5b2309872a851f04cb1c7852fd32d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 9 19:54:21 2014 +0000

    1) Implemented DCOMConnection() to encapsulate all the initial DCE/RPC connectivity
    2) Implemented a ping mechanism to mantain the objects alive in the target servers

commit 54af60449015e51786a5846042a34cb8c021a514
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 9 19:50:43 2014 +0000

    1) Adding support for CimTypeEnum.CIM_TYPE_OBJECT
    2) Fixed some typos on structure/methods definition

commit dc66234b2b9440bc8535c78b2986e7d957c958d4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 8 15:05:39 2014 +0000

    Fix for https://code.google.com/p/impacket/issues/detail?id=41

commit 7c5cc44207cf805662be55e19f14180b5cce9b95
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 7 17:02:18 2014 +0000

    Ability to specify an oxid when creating an interface

commit fa863a80fec27afb9e56de4ee8675286192103f3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 7 16:38:42 2014 +0000

    dcomrt.py: dcomrt now uses a single connection and performs alter_ctx to switch between rpc bindings instead of creating a new connection for each request. Big boost in performance.
    wmiquery.py: RemRelease shouldn't be done against the WBemObject, but against the Enumerator one

commit 8e523b437db038e028d7bb8e8e5b8ebf38793653
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 6 22:06:36 2014 +0000

    Missed RemRelease for the iWbemServices instance

commit 45511be2193ab29f078cf805f9301684204042a4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 6 20:54:40 2014 +0000

    wmi.py: methods for parsing the class for later use
    wmiquery.py: script to test wmiqueries easily ;)

commit 040da58b3dd115d7b1eb77b37cffc1d6664914c4
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Apr 5 19:27:43 2014 +0000

    Now method parameters are parsed/printed when calling GetObject

commit a86fde1a4cd01aff38f16d6e0ad41ebd9922b5a7
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Apr 5 16:11:38 2014 +0000

    Improvements to getProperties() and getValues()

commit 925e3f80776fbe96b34d880440d9ef907e4d6b42
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Apr 5 16:10:59 2014 +0000

    Setting up a high timeout for requests

commit 4ffcdf840c1337e53451abed2515acca2ff3bb3c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Apr 5 01:47:54 2014 +0000

    [WMI-IO] is ugly.. but anyways.. almost there.. There are some errors triggered that I still gotta find the solution for.
    the updated testcase output is promising :)

commit f651ad06cef4b6ffe429c0085f45432761e67015
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 23:56:25 2014 +0000

    Adding the [MS_WMIO] part

commit d6c7c28f2c5065807a0cf83be1f8882cb151cfc5
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 21:11:56 2014 +0000

    test cases for wmi.py

commit d9a9cbbd7923fdee76b85c79f6a1f4afb97f9b29
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 21:10:41 2014 +0000

    [MS-WMI], just starting

commit b4461fa7bdeb8775aa63cf835a626d2812e28bbb
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 19:23:40 2014 +0000

    INTERFACE.process_interface(): iPid and Oxid is not present inside a OBJREF_CUSTOM

commit 4d1eb6191e1a08931486d528f7a79f0336d28bea
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 19:12:55 2014 +0000

    Adding PPMInterfacePointer()

commit 12570727931db2b1854728c37f7c927506c583bd
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 17:02:09 2014 +0000

    When calling alter_ctx we must update the ctx for the subsequent calls

commit df25a527624d30b917cbc50cef2a783dab1c5354
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 16:48:49 2014 +0000

    Fixed wrong constant value for DOMAIN_GROUP_RID_CONTROLLERS

commit 7e2f8a437156e417937ad28ad80d72839bebcd80
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 15:01:43 2014 +0000

    Added 2.2.32 LPCSTR

commit 78fb61599b2db8c8c4976764fc13afb7e3efabd5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 1 18:58:56 2014 +0000

    Just changing some variable names

commit 2e91ea1e1674a86b7e907c06af15e1c281d6f4ec
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 1 18:57:56 2014 +0000

    Added:
    1) IDispatch::GetIDsOfNames()
    2) IDispatch::Invoke()
    3) ITypeInfo::GetNames()
    4) ITypeInfo::GetTypeComp()

commit 3cb52bcae189e09d5547c86c39c15ecdb348889e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 1 14:19:29 2014 +0000

    Added:
    1) SamrLookupNamesInDomain/hSamrLookupNamesInDomain
    2) SamrLookupIdsInDomain/hSamrLookupIdsInDomain
    
    Test cases also included

commit 18b92f63f4ae04c9ded1f38d25cb895ec3578752
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 29 23:53:10 2014 +0000

    fromStringReferents() and fromStringReferent() now returns the amount of bytes they consumed. This makes it easier to update where we are reading at the packet buffer, instead of calling getDataReferent/s() methods, saving some time and making it more efficient.

commit 43df600cec844470ace66905f507f102f78b2ed2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 28 20:55:07 2014 +0000

    Added ability to not align an Union in between the tag and the data itself. This is not the ideal solution, but I can't understand how pads are calculated there. More research needed, but for now the dcom runtime is back working.

commit 88e72104ae7db9fde13c13bd3646e67a092597d3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 28 19:25:43 2014 +0000

    Reverting the change in alignment I did before. It breaks my test cases (just figured when dumping the responses), but reverting back brings other problems to the dcomrt. So... everything works except dcom, which is brand new.. so can't be still used until I figure things out.

commit 7e23ae31b009a658a728c92401020bc998df5b5e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 28 19:24:17 2014 +0000

    Comenting one request that doesn't work (was commented before)

commit d8da122268142ae7c05bb8b31c7e9ac121d564a0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 28 19:20:01 2014 +0000

    Uncommented all the dump() calls. This is an extra check to verify the data comes/is parsed the right way.
    
    When running these testcases, save the output to a file (or /dev/null) so you can see the normal test case output

commit 1de7787b0d2a6c73b0a7b5401a0741aefc156b66
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 27 15:50:35 2014 +0000

    1) Added 'default' clause for NDRUNIONs
    2) Changed the alignment calculations for NDR32 in NDRUNIONS

commit b2155a2eef33273e4d70aaf1326b240f77cb0a2b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 23:54:19 2014 +0000

    1) Added ITypeInfo::GetFuncDesc()
    2) Finished ITypeInfo::GetTypeAttr()

commit 5bdc9cb3a0ede74af566ae13563a7113bbdd9c04
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 23:53:02 2014 +0000

    We don't want an extra CRLF when dumping enums

commit 376efb9462255275ec9e8cb96972d39c40c63ea6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 23:01:39 2014 +0000

    RemoteGetClassObject() now returns an IRemUnknown2

commit 669813e55d830bd9b68da4e82d74536801960bdb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 22:53:16 2014 +0000

    Bye

commit b25baab9cd7077d30dc28c195e3aaf31f5e746e6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 22:53:00 2014 +0000

    Added test case for RemoteGetClassObject()

commit 9e03d5d3cf66caca6790ac145814e243f13c4ee3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 22:51:44 2014 +0000

    RemoteGetClassObject() now working

commit f50c86d9930e304646824aaa6f0ff7ce02b794fc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 19:33:57 2014 +0000

    New name, since we changed the module as well

commit 72ab89dccba6897f489e9e09702dac1f9ad2e236
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 19:33:25 2014 +0000

    Test cases more organized.. only using the helper classes/methods

commit 80265aa1c9da1916f031f9e369c1dfdb7882df29
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 19:20:56 2014 +0000

    1) self.__marshalled_iid not needed anymore.
    2) fixed IIDs in comev

commit 358f82afd6d001368ee886f25e929bb205e49e6b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 18:50:40 2014 +0000

    1) Added IObjectExporter::ResolveOxid(), IObjectExporter::SimplePing(), IObjectExporter::ComplexPing(), IObjectExporter::ServerAlive(), IObjectExporter::ResolveOxid2(), IObjectExporter::ServerAlive2()
    2) Added IActivation::RemoteActivation()
    3) Added IRemoteSCMActivator::RemoteGetClassObject(): Still not working

commit 2847a229267bb460efb1b7af36e780207de8ca9e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 18:45:56 2014 +0000

    Moved some definitions into the class constructors in order to get away the forward reference need

commit 2b4b6c5be0c60c6420db60a0f25ff2d8523b691d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 00:37:06 2014 +0000

    Added targetIP to the INTERFACE constructor. This is needed for now, when parsing the stringBindinds in order to connect to the right machine

commit eb94713d28584cb99b50c736705b34f64845928d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 00:36:11 2014 +0000

    Added get_rpc_transport()

commit 9023cfd7046cc3b338535e91836e0afeb197c1f4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 22:23:58 2014 +0000

    Adding dcom directory to the install path

commit c31b00a7407410bdb8515e9e3faec90c739c2c62
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 22:22:54 2014 +0000

    Stuff with various test cases while I develop the dcom runtime

commit 28cbc46779011d5c56937d5a00bdfc7f67e5dd39
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 22:19:59 2014 +0000

    Bye

commit 388c8fd730bc061348de5ae22b62eb4045131d9d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 22:19:07 2014 +0000

    DCOM Interfaces implemented (not complete).. Further testing needed, still way to go

commit 16c2781cbc2fe415591977a54aa54ec1f6c27573
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 22:15:31 2014 +0000

    If it cannot find the module in the current directory, try the subdirectories

commit 70c75f245984909e232378e027dd08e9c3535dea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 21:56:40 2014 +0000

    Moving it to a different name. DCOM runtime

commit 7a69be9bb22b4410b5afcb5a2b0fcb4e1021e251
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 21:36:59 2014 +0000

    More data types added

commit 55faa58b91e2b2ced18aa0256ed3c07940da0d7b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 22 04:20:29 2014 +0000

    1) More dcom stuff
    2) added BSTR to dtypes

commit 44aafc96d933a121ce8d1451ec1ed6c3231a8445
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 21 19:35:48 2014 +0000

    Added an extra check trying to find the right error code when something goes wrong

commit 1d2a92e181d8ed1e72157f3eee7c8705df6fb420
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 21 19:35:03 2014 +0000

    Adding SHORT type

commit c96c2c08749a548fba869f2d870b3126ec95f580
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 21 14:49:10 2014 +0000

    Fixed bug in getServiceAccount() method. It wasn't using the parameter received pointing to the serviceName to get the running user from, instead it was using self.__serviceName!

commit acc0d50ae130c2c2409cdcd4798452ff6966c793
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 20 21:34:34 2014 +0000

    more stuff on the DCOM saga.. still way behind doing something useful.. but getting closer

commit 6d04c633259124e7e2a485afc369b397ca00122a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 18 15:18:21 2014 +0000

    1) Added ability to specify an UUID inside the RPC Header (needed for DCOM)
    2) Whenever there's an RPC Error, it will look at HRESULT errors when printing the exception

commit e0ba0fb3b856b335947022a005b87ddb3863dac2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 18 15:16:54 2014 +0000

    HRESULT Errors from [MS-ERREF].

commit f631e988934d8ca1d67bf58e2c0f691ecbe084ff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 18 15:15:22 2014 +0000

    Added LONGLONG

commit 31b4fac3a448cbd67f4ce5a8a9650ba936842c05
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 8 16:48:26 2014 +0000

    Adjusting some data types

commit b5140ea1261ea64a21d570c3dd36e6aa71d82734
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 4 19:00:45 2014 +0000

    Fix for https://code.google.com/p/impacket/issues/detail?id=39. Under Windows 2000, the NoLMHash registry key does not exist, and we weren't catching an exception under that situation. Should work now.

commit b262d7e8747a7e10390789525f6e4b9101db3db0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 27 19:33:36 2014 +0000

    Fixed typo in hSamrEnumerateUsersInDomain(), the userAccountControl parameter was not being included in the DCE call

commit 35c4edbc74dbceadc708a3abff82380afaa2135a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 26 16:20:19 2014 +0000

    Fix for https://code.google.com/p/impacket/issues/detail?id=38&thanks=38&ts=1393431491
    
    The lpClassIn buffer must be completed both at the MaximumCount and MaximumLength level, in order to work on WinXP

commit ddf21422925b068aa2519117b7e9e0cca6b7e09a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 20 16:06:30 2014 +0000

    Added some try: except: clauses when parsing ntds.dit, since based on feedback from a user, when dumping a huge amount of accounts (over 1MM) there are some rows that might be corrupted, hence triggering a decoding error. This fix will report that problem and let the script to continue running.

commit bcfcf50ccdff1f3e165801b629c4d7dc59a16c02
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 17 20:27:11 2014 +0000

    Sync with CORE internal repository

commit 79442b597d1dbd30057f3a45b90fd619af750788
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 17 20:23:22 2014 +0000

    Sync with CORE internal repository

commit d806d50191a0a97c8bc17b8779caf9315d1621b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 17 17:56:43 2014 +0000

    Sync with CORE internal repository

commit f7d9b6bbe6bdd1baa66febedd9f9fcadcefd5d4c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 12 16:39:51 2014 +0000

    If we cannot open the SCMR, let's raise an exception so the target file uploaded is removed

commit 12202d942e9e1c488ff0c6e69ea546220890eb8f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 11 15:13:03 2014 +0000

    Whenever we detect the target system has signature required, we print a warning message stating the attack will fail

commit eb07deaf0ddb21ce990a24376b0bbba0aa780bb7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 3 16:19:04 2014 +0000

    Updated home URL

commit 0a230f6097c8ab7fb1adebf505a12e28b8eac544
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 3 15:52:45 2014 +0000

    Typo at ScmReplyInfoData()

commit 5800faa508d9654ab1dae5b0a01f17184c239a3b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 3 02:28:10 2014 +0000

    Replacing evals() with getattr() :)

commit a5c52d22a9391cbb530b307b730c068efad56562
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 2 20:45:10 2014 +0000

    dcom test cases so far

commit cf101a0c378780ba4c340693f2b58ca72ebeb409
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 2 20:44:43 2014 +0000

    [MS-DCOM] Interface Implementation, just starting, way long to go.

commit 6b9d77576cdc5e1984432b73b054c564f28c0f0a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 2 20:41:25 2014 +0000

    Forgot to marshal the referents for the Type1Serialization

commit 65049cdd1614f9140ca586716fa3fd8d2125a142
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Feb 1 18:06:37 2014 +0000

    Adding [MS-RPCE] 2.2.6 Type Serialization Version 1

commit d970afc2fe558f56adeb59f9da89320e5d5a4e54
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Feb 1 18:04:33 2014 +0000

    Adding HRESULT

commit 0cb3ac833c2feefac3569e57dbb85a0c52821c42
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 30 17:00:04 2014 +0000

    We're adding the UDP Transport back.. not yet fully functional

commit f81e61a94520680b35e237ce0ec7ff6c27d222dc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 30 16:59:20 2014 +0000

    Moving to next version 0.9.12-dev

commit 0d7f0f2710f16537c80b7679f75f0af3650e87f2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 22:01:46 2014 +0000

    We'll be storing testcases inside /usr/share/doc/impacket

commit d04394011056e1c99c4faefef105f7ea769f83ea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 21:00:37 2014 +0000

    Adding testcases to the source distribution

commit fbef39b5ef354e4b6b604a0298a81376a5519c7e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 20:22:33 2014 +0000

    Added setSessionKey(), we'll need it in the near future

commit 439791f587d58cfb5903956a853ed7d9f197f711
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 19:58:16 2014 +0000

    SMBConnection.listShares() ported to the new rpcrt

commit 5e31023011b49da2699a2eb6621d7053f15a5523
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 19:38:32 2014 +0000

    Another place to find ordereddict just in case it's not present

commit 42eb8721fca32b39004f56e02d5fe6cd38be405f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 19:00:46 2014 +0000

    Added experimental for some features

commit cb1b2e5a8bf51bdf61b5305a6ade8b9b38f7025b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 17:51:05 2014 +0000

    minor changes

commit 40b9cfab1e12c4ec211ede68a3936cf23edb7524
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 17:41:25 2014 +0000

    Typo with numberings

commit 7b6a75d913d686330fff041e5022d0ab30a69bab
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 17:40:19 2014 +0000

    Updated changelog

commit 9d504f8b5c486714a2c4e69d680bad623f05f90c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 14:24:59 2014 +0000

    No need to declare ndr.*

commit 753ca996807cead7e696c00d13abc952e8517056
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 25 22:38:46 2014 +0000

    Updated

commit a92d9dfa01db679fcf085bc7ff480b9b41459224
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 25 19:04:39 2014 +0000

    Wrong array set.. defaulting to RPC_UNICODE_STRING

commit 1d487efd944e296bdeb35bd444abe0a70c63adb6
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 25 18:38:23 2014 +0000

    1) Added more helper functions
    2) Checking whether NULL strings were sent to the helper functions

commit bf681a5ada6c018a37913fc9302b7863a64b3ec2
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 25 17:47:06 2014 +0000

    Adding LOCALTransport()

commit e2c10ac619c1bae5cb73bba6575f349aea2438e5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 22 20:08:04 2014 +0000

    dcerpc.v5 must be installed

commit 6fc2a346facc69fe01209034075fc7dc91b1b5bd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 21 20:58:34 2014 +0000

    ntfs-read: stripping CRLF
    registry-read: forgot #!/usr/bin/python at the beginning

commit 0aa53f2175d1335f7431b7ad2824487512125a89
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 21 20:46:43 2014 +0000

    In preparation for new version

commit 4f522b22d0afd1e5e73c788de11c87f84a83e5ec
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 21 20:45:51 2014 +0000

    Stripping CRLF

commit 3f2237c3fa658331c13a1806b864fa07e78023b1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 21 20:40:06 2014 +0000

    Not needed anymore

commit 8763dbb2fa26d7c0e2f1927a122c6c28ed8dc359
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 21 19:44:16 2014 +0000

    Cosmetic changes

commit cbd52b52efb71862c13834b3b67c351ff31f2d10
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 20 14:13:58 2014 +0000

    test cases updated

commit eccfeb32cfd1abcd75f605a4c3a89f054c75f89b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 19 14:25:32 2014 +0000

    Ported to the new RPC runtime

commit 349116e6960275079d4dc753ffa833351ca3ef4b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 19 14:17:01 2014 +0000

    Notes added

commit bf1f93000a9f40c61e5c8377d9f25d5fa4d08050
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 19 13:56:06 2014 +0000

    Added checkNullString() to some helper functions to make it easier for the caller to consume them

commit b444686f028acbc6a2b7da585d5341af3658b50c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 19 13:55:08 2014 +0000

    Some helper functions added for nrpc

commit ec0ccde4985d143bd4d5c9c3b1b273fd8b807ecf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 15 15:14:46 2014 +0000

    Helper functions for wkst + updated testcases

commit 62de6d31c2e072a94c1ab428bcc678205fc13319
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 15 03:21:05 2014 +0000

    1) helper functions added
    2) smbclient updated to use the helper functions

commit 850b6c7e3b8a7f5f344b4478117256335009038e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 14 22:15:30 2014 +0000

    Migrated to the helpers I just committed

commit 18fde7133d7c2329a858a7bf29187264bd64f68c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 14 22:08:43 2014 +0000

    Helper functions!

commit 94227f56a1bc9ed58f3efd7dc2acade54d83e5d4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 14 18:55:39 2014 +0000

    Helper functions for LSAT

commit 34451db6b8ab07967215688b9d62028cedbc4d53
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 14 17:12:31 2014 +0000

    Helper functions in place.. done!

commit 7ce38023e8a70d995c58ff9b16140b29d4d57f97
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 14 01:38:30 2014 +0000

    1) [MS-RRP] finished.. just need the helper functions
    2) Added another derefference to ndr setitem to help setting NULL pointers for RPC_UNICODE_STRING like structs

commit b568b5ada2b7cfe6729c640e7f931a082f916dfe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 13 15:26:42 2014 +0000

    More work on RPC_UNICODE_STRING

commit 3bf1172426be13b8c0c1e72aa723276329cf720a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 13 15:26:01 2014 +0000

    SAMPR_ULONG_ARRAY was wrongly defined

commit fce7bafadde72b567cd8dc733b86ff554ffd88f9
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 19:27:07 2014 +0000

    [MS-RRP] Interface Implementation. Not yet finished

commit abe6deddb89cbe4d3a92c488133a18789a2d3a5b
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 18:40:15 2014 +0000

    RPC_UNICODE_STRING() dump method is actually needed :s

commit b177e2b6bc955394b88ecae7864f97da5996c6fa
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 18:04:34 2014 +0000

    A much simpler RPC_UNICODE_STRING

commit 1d6263f59d4213ac3b7b66b39f54aec2538b1567
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 17:39:22 2014 +0000

    NDRBOOLEAN now prints True, False when dumping its contents

commit 35fe0f3ab4c3e45e0de9b06579faf73779b00156
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 16:04:21 2014 +0000

    Adding some more data types

commit a3fc72eeaafe7955dfc33a51b99efaabf3cfc25f
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 13:38:58 2014 +0000

    Moving the SMB-RPC test cases to a different directory

commit df18d1b0427c0d43bd6814636b7f6505e1f726f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 00:14:14 2014 +0000

    Added OPNUMS dictionaries

commit ed8aae1deadb585256c9d87407c3a6776c80c5b0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 22:27:02 2014 +0000

    Forgot to comment the tracebacks

commit 041c53a0f77084a4baca91d1ef896166f23432e7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 22:21:13 2014 +0000

    Migrated to the new RPC Runtime

commit d23a5aa6685e891bed0af40b46e3ac06415bf8a3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 21:53:59 2014 +0000

    Not needed anymore

commit aef50c4edd28c6d979dd49665ee43b108d64143a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 21:51:47 2014 +0000

    Adapted to the new RPC runtime

commit 258481c96bc4cdbbd69323d4dd8e6af0409b3ed0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 16:29:15 2014 +0000

    Updated test case + fix response structure for NetrUseEnum()

commit f650500fadbc5f4dba7cc64317e5424a14e25a3b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 15:30:00 2014 +0000

                # The RPC server MUST ensure that the RPC_C_AUTHN_NETLOGON security provider
                # (as specified in [MS-RPCE] section 2.2.1.1.7) and at least
                # RPC_C_AUTHN_LEVEL_PKT_INTEGRITY authentication level (as specified in
                # [MS-RPCE] section 2.2.1.1.8) are used in this RPC message.
                # Otherwise, the RPC server MUST return STATUS_ACCESS_DENIED.

commit 0180f6afd880e18a7dd481005ede320dac38b697
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 15:03:36 2014 +0000

    calls made to SamrSetDSRMPassword using NCACN_IP_TCP are rejected with RPC_S_ACCESS_DENIED.

commit 5d6eef41744b7f744e4907640ee7c0cf2eaa28a6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 14:57:41 2014 +0000

    NDRPOINTERNULL must be created again based on the NDR transfer syntax in use

commit 4bc2b68c6aee5c59b8be818a0cc5bc8c5805ab7f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 14:16:23 2014 +0000

    Moving some methods to the base class

commit bf980c3240553701d5d389a762cbc9025fe3ee2c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 13:48:41 2014 +0000

    Change in MSRPCBindAck base class

commit a3c810cd852ba1d9d29452c1b883c5e94f0cf9c6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 23:25:44 2014 +0000

    Updated to the new RPC Runtime

commit 4496a4658fd2651902564804b614d03023a1cb90
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 19:17:14 2014 +0000

    Ported to the new RPC runtime

commit 7f431841b60bdfcb09112db784072e0643ecb644
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 19:12:51 2014 +0000

    Same functionality as before, but ported to the new RPC runtime

commit 98b07863670ebc3c4201c48070f5e0fb7483b8e1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 18:46:43 2014 +0000

    Typo

commit e74e6e9d548c40f2ffde50afe8ff6749a0c18440
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 17:35:50 2014 +0000

    Bye bye.. we don't want you anymore.. replaced by nrpc.py

commit 3ad62a7d37994c82c0156637ca6639189e73c50e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 16:17:48 2014 +0000

    Enabled the TCPTransport testcase

commit a539ce6209d65e5f5b8409467a800a2c6832e84c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 16:11:21 2014 +0000

    We should respect the transfer_syntax previously choosen when doing an alter_ctx

commit 0a138a62127e4a56950fc97b45686529f082ca0c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 15:21:39 2014 +0000

    NETLOGON RPC_C_AUTHN_LEVEL_PKT_PRIVACY and RPC_C_AUTHN_LEVEL_PKT_INTEGRITY support. Right now just supporting RC4, not AES.

commit 01f134ed25eeebe2d81029c0cb7eddc972390971
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 15:20:45 2014 +0000

    SIGN() and SEAL() refactored so it makes it easier for users to consume these functions

commit 9f9db801214048c5754578c61e27d73b2f564a0b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 8 16:34:29 2014 +0000

    1) Fixed typos on som calls reponse's structures
    2) Added a dictionary with the opnums and their structures

commit d33a5c8ce7c562202e18ab58612d91aa4fc863f5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 8 14:54:02 2014 +0000

    changeTransferSyntax() needs to recreate some data types whenever we change to NDR64

commit 57cf1ce036c4b2dad503321548a9e869a4b07d73
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 8 12:35:19 2014 +0000

    Added NDR64 tests.. still some failing

commit 2f033cdb65078933b7f5290a8b0b1537c06b0c76
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 8 12:18:42 2014 +0000

    The alignment saga continues

commit dfff6f25e92da505d6ee671c43aed727c031d626
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 7 20:08:28 2014 +0000

    More alignment stuff + fix in nrpc DsrGetForestTrustInformation()

commit ca1d78743f10f9ffe194a15477aadbd867ddbd93
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 7 17:27:42 2014 +0000

    More padding and alignment stuff, in preparation for NDR64.

commit b5f65486bfb6747633c806697893ab1c08d25af3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 7 15:47:25 2014 +0000

    Forgot to change the call to NDR.getData()

commit 044653431fa9884b65f809a048f840cd979df8d8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 6 22:02:40 2014 +0000

    Fixed bug inside fromString when NDRUniConformantArray and NDRHYPER was present.
    This code wasn't working:
    from impacket.dcerpc.v5.ndr import *
    from impacket.dcerpc.v5.dtypes import *
    from impacket.winregistry import hexdump
    
    class Puta(NDRSTRUCT):
        structure = (
            ('Nose1', NDRLONG),
            ('Nose2', NDRLONG),
            ('Nose3', NDRLONG),
        )
    
    class Conformant(NDRSTRUCT):
        structure = (
            ('Item1', ULONG),
            ('Item2', USHORT),
            ('Item3', NDRSHORT),
            ('Item35', Puta),
            ('Item4', NDRUniConformantArray),
        )
    
    
    kk = Conformant()
    kk['Item1'] = 0xaa
    kk['Item2'] = 0xbb
    kk['Item3'] = 0xcc
    kk['Item4'] = ['a']
    kk.dump()
    
    hexdump(str(kk))
    nn = Conformant(str(kk))
    nn.dump()

commit 37bf2aad330ab2b6c4ea579db74d627aeaf40051
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 6 20:40:58 2014 +0000

    Getting rid of unnecesary align attributes

commit 0989d49f1d2eab4ca479b243073752cf0fcf8872
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 6 19:25:04 2014 +0000

    ept_lookup_handle_t redefinition plus simpler way to represent arrays

commit de18fe12b7df30a8c473b4529b1a2a6906abfd0e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 6 16:32:19 2014 +0000

    NDRSTRUCT data type created

commit 6876b8c3a76275ba8a3c89805e6769495d334d0e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 6 14:25:57 2014 +0000

    NDRCall -> NDRCALL
    NDRPointer -> NDRPOINTER
    NDRPointerNULL -> NDRPOINTERNULL
    NDRUnion -> NDRUNION
    
    dtypes.py now imports the datatypes directly

commit d2e796761834e4f2231361f1fc2d1759cb295e7f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 28 02:50:59 2013 +0000

    More NDR64

commit 14da66783f222f28fd9d5aec7fd33156f83310fe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 28 02:38:47 2013 +0000

    A much better RPC_SID using NDRUniConformantArray

commit 011d7be60495f4db72e5c8b2bc50bf1346901476
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 23:52:24 2013 +0000

    More NDR64 stuff.. not there yet :s

commit 2c4e5b65f93a800ffd1bc5d24efd509c010a653f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 22:29:12 2013 +0000

    Fixed bug when not initializing array items with the isNDR64 parameter

commit 57a8209546b2b0c76094b241b52ad3789a164a7a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 21:26:55 2013 +0000

    Better worked out the ARRAYs unpacking

commit 6009570a47dc81417f5eec5998889b3e16c4be63
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 18:37:31 2013 +0000

    More NDR64 work

commit 60aaf5cec4f0337378c6a07fc91862b967c3894c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 15:54:49 2013 +0000

    Added password command, so the users can change their passwords easily

commit 537f7850692fc5baccfb00f79ef37f77164d5c98
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 15:54:14 2013 +0000

    hashes support for hSamrUnicodeChangePasswordUser2() when changing passwords

commit 6a64046123c7669e8b3e9e703ee17befc18c25d5
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 26 16:41:55 2013 +0000

    Some updates related to NDR64, not ready yet

commit d4de2e49e2172f9667e03e4d453b96e5e933babb
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 26 13:56:47 2013 +0000

    Helper functions finished

commit a84ff937822b134e1849fb4a0afdaca14f376218
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 25 07:15:12 2013 +0000

    some helper functions added, more to go

commit 95e7501dd6af9a94aa5a08b562d7be065340d58e
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 22:40:35 2013 +0000

    More reliability

commit 617162125fa8b2c0e1c41763aa4f5391d14106e1
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 21:48:49 2013 +0000

    Wrong NDR type for some fields

commit 48769da4e195bf9a93f10b01d91f2d5bef411ed9
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 19:31:03 2013 +0000

    Fix problem when setting a NULL pointer for an RPC_UNICODE_STRING

commit 58384e1949eedb2a5d7b4b1f5fdcadb8f778f518
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 19:30:33 2013 +0000

    STRING changed for LPWSTR

commit 3bd8921848fd93036207baac17657ceafbe69933
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 19:29:53 2013 +0000

    Fixups

commit cf1168f665a822aa465366ff1e7e3efbd0640480
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 19:20:20 2013 +0000

    PSTRING not needed

commit ce37270597e3ce6f12260dcfc8206c6c3a3be5b4
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 19:19:58 2013 +0000

    Fix 8s for FIXED_ARRAY

commit 58253332de23bbb92179026e4000d20b89dda3f3
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 23 20:11:38 2013 +0000

    [MS-NRPC] Interface implementation + testcases... a few still to be solved

commit edd23dfb4119c55a13ef4cb80ae60fedeea38921
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 23 18:29:15 2013 +0000

    PSTRING replaced just for STRING

commit 0e46b5146373fea0d03562a15966d40aec13b269
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 22 20:50:42 2013 +0000

    The *Change*Password* methods are creating a temp account to play with the passwords

commit a41d2a9650f796d8b316bbea5428c43906f6e4c5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 22:02:25 2013 +0000

    I created primitive data types with signed / unsigned types.. and changed all the interfaces.. It should reflect what the docs say

commit 15ff10843ba8a985d91c8fb6c53e548d9795c8ad
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 20:56:09 2013 +0000

    Added more calls

commit 12d033e275d4a8d8cfe0d3d46001f103d7966565
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 19:51:38 2013 +0000

    1) No more UNIQUE_RPC_UNICODE_STRING
    2) RPC_UNICODE_STRING Length/MaximumLength put in the right order
    3) RPC_UNICODE_STRING generates a random ReferentID

commit 331106482a18b82d74c75361e468b24ec61b8337
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 19:41:15 2013 +0000

    I don't need these files here anymore

commit 6855b6e1ee35e000b68cd1f26a81c80d193aa20c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 19:38:08 2013 +0000

    MS-LSAT Inteface Implementation + test cases

commit 6b2950480a7d643b2c9400f50d4f2baf44c67305
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 18:11:31 2013 +0000

    Moving RPC_UNICODE_STRING_ARRAY to samr.py, small changes on lsad.py

commit dc5038c765af160fc94a966a782b0481fa0012d7
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 02:25:42 2013 +0000

    Added more tests

commit 060984cb55ec1d79105b6ab1b1f06d39450fb263
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 02:25:11 2013 +0000

    Slightly changes to make it more general

commit cc5ff3a8d5d974dafcce3adea8786fa83f617d74
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 00:15:51 2013 +0000

    Fixed testcase when closing my pipe

commit 2f791e4dc4f506ee198ac7b911c60d039c7f1915
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 00:15:24 2013 +0000

    Commented resp.dump()

commit 24a719a1c593cd369c089d4e37ee6d580b79ff8c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 00:11:14 2013 +0000

     aimed at testing just the DCERPC engine, not the particular
     endpoints (we should do specific tests for endpoints)
     here we're using EPM just beacuse we need one, and it's the
     easiest one

commit 77f7efee37b209d708b5ccac911316f29e40cdfb
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 19 23:58:05 2013 +0000

    Modified some test cases to be more general and not dependants of the targets configuration

commit 99881090ed9ee2682284a6ee1dea264f6dc7d984
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 19 23:31:29 2013 +0000

    MS-LSAD partial implementation + testcases

commit 08b18a117d7e6c6d460faf887efae4683a35a916
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 19 21:30:58 2013 +0000

    Added PLARGE_INTEGER and LPSTR

commit a36ccf071408c97d64045e6e16f2c71c9d9c4041
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 19 20:48:48 2013 +0000

    Fixed a bug when trying to pack/unpack a pointer to a pointer of an array (yes :s ). This code wasn't working:
    from impacket.dcerpc.v5.ndr import *
    from impacket.dcerpc.v5.dtypes import *
    from impacket.winregistry import hexdump
    
    class PLPBYTE(NDRPointer):
        referent = (
            ('Data', LPBYTE),
        )
    
    class Conformant(NDR):
        structure = (
            ('Item1', NDRLONG),
            ('Item2', NDRLONG),
            ('Item3', NDRLONG),
            ('Array', PLPBYTE),
        )
    
    class Puta(NDRCall):
        structure = (
            ('Nose1', NDRLONG),
            ('LaCuestion', Conformant),
            ('Nose2', NDRLONG),
        )
    
    kk = Puta()
    kk['Nose1'] = 1
    kk['Nose2'] = 0xffffffff
    kk['LaCuestion']['Item1'] = 1
    kk['LaCuestion']['Item2'] = 2
    kk['LaCuestion']['Item3'] = 3
    kk['LaCuestion']['Array'] = list('BETOBETO')
    
    kk.dumpRaw()
    hexdump(str(kk))
    
    nn = Puta(str(kk))
    nn.dumpRaw()

commit ba8c62a7fe5f81c31d94dbce7ae06a4daed0baf4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 19 19:00:29 2013 +0000

    Added support for [C706] 14.3.7.1 and 14.3.7.2

commit 18b98a496def8c265ff6a6a63147652f8178ff1d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 17 22:46:17 2013 +0000

    Finished.. only helper functions left to do in the future

commit f60c95aea8e7bc5bf5a432033d68a1251e9c103b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 17 22:45:11 2013 +0000

    Added LUID

commit 814ca693838cb24f7571e4c9e4ec35b5dd27798c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 16 21:45:16 2013 +0000

    [MS-SRVS] Interface implementation + testcases
    
    Not finished yet

commit b137c471c39bae4711b3ce1b06a73498e21253f0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 16 21:43:15 2013 +0000

    Added 2.2.26 LMSTR

commit f2586cb8cd6308c6ca7fdd0a1b82942ec3c08424
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 16 21:42:49 2013 +0000

    When the pointer is NULL, just print NULL ;)

commit 03791ebf59d0559dcc76dd359c42ce1b013f3ce8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 16 19:21:49 2013 +0000

    Forgot to add the pad to the soFarItems

commit 427bdf028028b7f8bb11eee6a1965bfb529c4634
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 13 20:25:27 2013 +0000

    1) Added ability to specify the transfer_syntax when binding. NDR64 still not fully supported but this is useful for some stuff
    2) Fixed a bug when reporting an exception when binding

commit c87d8f394e1f1f703ccf00662bb9abd1b23d359a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 13 20:06:53 2013 +0000

    [MS-WKST] Interface implementation + testcases

commit 45e0e5576f472852cb6219f9c0c1d1d741d2caf8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 22:07:06 2013 +0000

    1) Target's data is taken from a single file. Easier for changing configuration
    2) Added TCPTransport test for all testcases

commit d5763bb77e7c7d2bed2a5218e82ad0451c248cbd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 22:04:21 2013 +0000

    1) More padding fixes :s
    2) NDRUnion should behave similar to an NDRCall. The pointers there should be top level pointers if the Union is part of the main NDR call structure. This could be done more clean, work to do.

commit 9dcee30aa41c00da7a731adde1c71d1941fc170a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 22:02:45 2013 +0000

    class LPLONG added

commit ffe83685fb5873da93d9550f9424789606cefd16
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 22:02:29 2013 +0000

    Changes to the exception handler based on previous commit

commit e144c2dd86d0206dc16efc00d3f7df3372730aeb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 22:01:54 2013 +0000

    If we cannot unpack the error packet, we just call the exception with the error_code

commit 727d747c8b2a73bcb429d2659f53cae94d5a6e9f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 00:45:47 2013 +0000

    fixed typo for ncacn_ip_tcp

commit 97e632e0a8dac20b2fc196bbbdb64e914f2c9c17
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 11 23:50:32 2013 +0000

    Final calls added.. all SAMR calls in place. In the future we should craft some helper functions to make it easier to use the calls. See testcases for example of use

commit 30f896fbf8d2730732b70f1d558e91cb9efe3837
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 11 23:49:12 2013 +0000

    1) __setitem__ set on those classes that calculate the length of a string or array so everything is recalculated when packing
    2) fix on getData where soFar was wrongly calculated

commit 61379744c8c81ab2074b2ba3ae333fd83d416a6f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 11 23:48:15 2013 +0000

    1) __setitem__ set on those classes that calculate the length of a string or array so everything is recalculated when packing
    2) Added ACL()/PACL() and SECURITY_DESCRIPTOR()/PSECURITY_DESCRIPTOR()

commit 456f370f3ed339e7a7e4d7fc2d527ec56486706b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 21:11:46 2013 +0000

    Based on previous commit, on those places where the NDRUnion tag is different from NDRSHORT, we gotta declare it

commit 76166893f141cfc2001ff5a940c80fc85b664bc4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 21:11:08 2013 +0000

    1) Making it cleaner the way we carry the bytes already processed for pad calculation
    2) NDRUnion default tag now is NDRSHORT
    2) NDRUnion default tag now is NDRSHORT

commit a16238259a75d8a92816847a0f1e2ba42c4c3137
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:20:54 2013 +0000

    Updated test case

commit 2d75c98ebb8f8fa89ca64df1a109982c4e3efed1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:20:16 2013 +0000

    Updated test cases

commit f9769af25980c88a44d3a14e78f33c38d6983eaa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:19:24 2013 +0000

    Items reorganization + more calls.. close to finish

commit f77e5c528ae35f5d66fbadcafba6495b074bb16f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:18:08 2013 +0000

    changing getData(), fromString() according to previous changeset

commit 60a38cb5312b5cc724d64a52d454829214520596
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:16:52 2013 +0000

    changed fromString(), getData() according to previous changeset

commit fcd9755f00febdd999b5f38f830058e6a13cac98
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:15:31 2013 +0000

    getData() and fromString() now received a soFar variable that specified the bytes processed so far so PAD can be calculated over the ENTIRE octet stream

commit b9a89791b6f4fd08bde5046b881ce1660f1b720d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 20:58:09 2013 +0000

    Added
    1) SamrDeleteUser
    2) SamrDeleteAlias
    3) SamrDeleteGroup
    4) SamrGetMembersInGroup
    5) SamrRemoveMemberFromGroup
    6) SamrAddMemberToGroup

commit e2c2f4efba187e4c6486236caa3f365a7344179c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 17:24:10 2013 +0000

    Fixed bug when encryption/integrity was used

commit f5273bda186d6d6286ebb402debea2215149675c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 17:19:03 2013 +0000

    Fixed bug when encryption/integrity was used

commit 23de460767e55df02b321a63a38798c462f94b02
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 17:01:00 2013 +0000

    STR() added

commit 9b9d2be372bdfe99831972b0833bed912d10ad7c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 17:00:34 2013 +0000

    NDRENUM() added

commit d85273cd9df4bcc618bcd9a1f976ccf1b3300c8f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 17:00:18 2013 +0000

    Python 2.7 backport for Python 3.x enum data type

commit 0f5d93acde107526e5bc162af090b9f6b2454a03
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 16:59:21 2013 +0000

    Loooots of new calls added.. still more to go

commit 1e6794fd547eda8b2ba0870a97eea4a819f60b7a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 16:58:44 2013 +0000

    updated testcases

commit 7bf3f47525b76dce5ae2d4ba1683280e8ade73ab
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:55:49 2013 +0000

    samr test cases I have so far

commit 31e2229cfadba0502d7978c6606b6fdb1c27bd2f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:53:19 2013 +0000

    Changes in NDRUnion impacted test cases

commit f54dcca791fca9fa926c9dac19d6e89262498acc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:52:15 2013 +0000

    Samr implementation from scratch.. just starting

commit bb982afe1bdabfa6f63fe1edb978481aad6b9a99
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:51:12 2013 +0000

    I finally understood the difference between RPC_UNICODE_STRING and LPWSTR, setting up the right values here

commit 4164d32b4f1fecfa26c520532ff30f3b460834d8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:50:15 2013 +0000

    1) Moved Common data types to dtypes.py
    2) NDRUnion SwitchValue not needed anymore
    3) Added align for NDRSMALL
    4) setitem can now assign NDR classes if they are similar
    5) NDRCall.getData() and NDRCall.fromString() now also call getDataReferent() and fromStringReferent() (not sure about this, testing needed)

commit 9e8f7eae7077060362f1080f61f8ee3a912beee0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:46:57 2013 +0000

    Added more data definitions from [MS-DTYP]
    1) RPC_SID
    2) ACCESS_MASK
    3) RPC_UNICODE_STRING
    4) WSTR

commit 4b3ecf24b6c7e72b5161519d343b97634a803213
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 4 20:47:18 2013 +0000

    Opps.. first line dissapeared somehow

commit b8edb894bd29d75b02c15bae25cd1c72ad8d7b3a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 4 20:36:13 2013 +0000

    Since rpcrt is now handling some exceptions, the right one to catch here is rpc_s_access_denied

commit 0e9de8a1c24321b1dbd305fd5408c394591c42c2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 4 20:14:44 2013 +0000

    1) hept_lookup() helper function added
    2) removed exception messages that are handled by rpcrt
    3) fixed PrintStringBinding()

commit f8f4a77e4e1cf792d099290732373da3b7462e96
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 4 20:12:45 2013 +0000

    Added DCERPCException()

commit 310d0ca1fe6dacf02e4aecf6d329fa14267a0a30
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 3 22:34:27 2013 +0000

    UUID/PUUID types added

commit 42bb487432bfdd56604021fe9386f00c0b29a945
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 3 22:34:03 2013 +0000

    Endpoint mapper implementation for the new dcerpc v5

commit 7ce09112b76a4a4de3844fe6073bc118b39bc4fe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 3 22:29:46 2013 +0000

    More errors that can be triggered inside the rpc runtime

commit d6706d9fb0a5509fe29e3fa3f00adb8763eaeb5a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 3 22:29:04 2013 +0000

    UUID is MSRPC_UUID_SCMR

commit e01dcf408fbbc58f954a92ca61874b4dfbcce955
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 3 15:24:09 2013 +0000

    ErrorCode is not always the return code status.. so, we're just grabbing the last 4 bytes of the answer

commit 9656bed16d40134a01e4dc82f03072bcccf41b43
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 2 23:18:43 2013 +0000

    1) Fixing calculation of array items when packing (len(itemn.getDataReferent(''))
    2) Setting up default alignment to 4 (let's see if it works... testcases good so far)

commit 17c57ff592d57f1c94ec9e3aa8da539e1a89a97c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 2 21:04:19 2013 +0000

    More padding issues solved (hopefuly) inside arrays encoding/decoding

commit 92978fceb2e05b939e52f216a7b1bc6f28cc2e4b
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 2 00:33:16 2013 +0000

    Cosmetic changes

commit bc0359470bcda6f94415e4a870e1da2c63985b89
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 2 00:02:12 2013 +0000

    SCMR errors taken out.. now they are grabbing everything from impacket.system_errors.py

commit 796e6525779cd0f2e8e4770f8be6bdbf577b654f
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 1 23:44:48 2013 +0000

    SYSTEM Errors from [MS-ERREF].

commit 3159f7bcb115b595709e0588cfbdea7cb69d673b
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 1 22:58:16 2013 +0000

    propset ID

commit fc71e1f88f831668d5eb6e02ada3f75911dd8289
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 1 22:54:44 2013 +0000

    1)Better default parameters for the SCMR helpers
    2)Changed Exception name to DCERPCSessionError

commit de5d1fcdaa392f6820cca5e6c7a6dd281426f59f
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 1 21:01:00 2013 +0000

    Fixed NDRArray.dump() for fields that are not a list

commit 3b4370546261441707080bd6daeac403580bb698
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 29 23:00:19 2013 +0000

    1) All helper methods start with h<method>
    2) No more need of a SCMRDceRpc class
    3) Requests are handled by rpcrt.request()
    4) SessionError exception returns the packet for further inspection

commit 2069e1a07cb5367c0e4334a26fd2c9116399f38a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 29 22:58:40 2013 +0000

    1) Added request() method
    2) Transfer syntax is now stored for later use

commit 07e4c0368c271a474a46f7de646e5b436b3c42e4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 28 17:11:24 2013 +0000

    Based on https://code.google.com/p/impacket/issues/detail?id=34, added password history dump (for NTDS.DIT) based on lanjelot's patch. Thanks mate!

commit d08c9c6a13a95858cd3a2ca3ac09bb0d588ac617
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 21:27:08 2013 +0000

    Changing SVCCTLSessionError for SCMRSessionError

commit cefac1e8f3e766bc86013924293c72a577ca58b0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 20:56:53 2013 +0000

    Changing NDRPointerNULL() for NULL, easier to read

commit ec4bbb24630df2833ee398d3e0b86fca3e48446f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 20:53:36 2013 +0000

    NULL = NDRPointerNULL()

commit 4d0a3b24efabcfa5f892deb56d7de58d7cc1993e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 19:26:14 2013 +0000

    Getting rid of isNDRCall, and adding topLevel parameter just for NDRPointers

commit 4e74593cae241194e254aa5e878a6bca4a6a3a23
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 05:11:23 2013 +0000

    Importing from v5

commit b4e05b5ad1d8f665d54b9a3a833bff498c10c3fd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 05:08:15 2013 +0000

    Importing from rcprt.py

commit a5b54adba5502f2adf87c931dde40c17a1d1e1aa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 05:03:36 2013 +0000

    Adding rpcrt.py (old dcerpc.py) + transport.py.
    
    Modifying the rest of the sources

commit 674d74852eb15c6e61b1ef95ea1b7aca685ee43e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:43:39 2013 +0000

    Adding headers

commit 964982e3f8b599780c13ee2c5ef594485fe63318
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:41:57 2013 +0000

    dcerpc.v5.scmr test cases

commit 44a2edea5da666c641effda4db97320a3548e45f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:38:38 2013 +0000

    Changing imports to point to dcerpc.v5

commit 441edf6d6542944ba2431f63befca363bf69ab3c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:34:06 2013 +0000

    This is the right name for [MS-SCMR]

commit 00513e1732e77ce224126c2e8815d7e32e2eb8bc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:32:59 2013 +0000

    Bye Bye

commit 73dddeb365ca59fed31e9f1fddab695561b16586
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:28:36 2013 +0000

    Adding the files i'm playing with here. Again, no more development in impacket/dcerpc

commit d57847b4f75a8ad0818190a141e7afc0784bcd6e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:26:09 2013 +0000

    Moving experimental to dcerpc.v5
    
    I'll be working here from now on.. Not touching impacket/dcerpc anymore.
    
    Too many changes going on!

commit 7a03cfa6ec6d67cd98fc53b4f681af9e035abfd7
Author: aurelianocalvo <aurelianocalvo@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 26 17:50:36 2013 +0000

    Changed the appearance of self.child().__str__() to str(self.child()) in order to show child packets that did not implement __str__

commit 60a757e29e5046ed22bdbbfa2bc301154d0deb6a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 22 21:58:48 2013 +0000

    Changed the Pointers stuff based on previous commit on ndr.
    
    Plus, for svcctl added:
    1) RQueryServiceLockStatusW
    2) RStartServiceW

commit ffdc8e1f5d1f36aa8f5e9324d2249b609d443c1f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 22 21:57:47 2013 +0000

    Chaging the NDRPointer referent name to 'Pointer', trying to make it easier for coders to understand dereferencing.. we'll see.

commit 82a9940a50cb4353ecc49673814af87a97a7a714
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 22 21:31:45 2013 +0000

    Fixed padding for Arrays

commit 876ec9c525a9cf5a3ca82a98d19a0efa90bb268b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 22 02:39:24 2013 +0000

    Fixed ChangeServiceConfigW()

commit 02108d261c7c1cd2bd52665074509ce10a02f9cd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 22 01:01:10 2013 +0000

    These are interfaces i'm playing with the new ndr engine so I don't mess up the current ones. This directory will be removed once they are ready.

commit eaceacad99382ea14f88bf0ed89a36f4349a3407
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 21 22:17:36 2013 +0000

    1) RPC_UNICODE_STRING now accepts regular strings, and takes care of encoding/decoding them
    2) More NDRPointer optimization to make it work when receiving/sending NULL pointers
    3) Fixed wrong UNICODE_STRING() base class (it should be NDR, not NDRPointer)

commit ea7137d818bcd55d420b43912c9c68616cb1eb78
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 21 14:06:59 2013 +0000

    Removed debug message

commit f5c860da186aca978ad3cc5e2c07d95966fdf52a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 21 13:40:42 2013 +0000

    Adjusting NDRPointer, when it's null, depending on whether we're under NDR64 or not

commit 8364edb2529e4430e42b083c7bcf83c4683dc9c0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 21 00:13:14 2013 +0000

    edefined UNIQUE_RPC_UNICODE_STRING for consistency.. Yes.. we will need to do a ['Data']['Data'] to assign a value, but it actually makes sense.
    Added check inside NDRPointer if we receive a NULL Pointer, so we don't keep unpacking the rest.
    Added consistency check, which bassically does, for every struct unpacked, checks if the packing matches the original data. Just for debugging purposes (turned on now).
    netlogon changes based on ndr.py changes.
    
    Don't use netlogon.. I'm using it to test ndr.py

commit 9f69c9927716b8a0c7f09df97437c5e1768567c2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 20 02:12:42 2013 +0000

    Okey.. We're getting closer.. although this might not work.
    I'm taking out the embeeded pointers and top level pointers. According to [C-706], top level pointers are the ones that are in a DCE Call (and their referents are NOT represented later), whereas the other pointers are embedded pointers (with deffer the representation).
    
    So.. in order to make it easy to define NDR types, i'm creating a single class NDRPointer, which will act different when it is part of a DCE Call or it's inside a structure/array/etc.
    
    We'll see.. wort case, we come back to the previous revision

commit 72bcfb39195501a50b0ccac56256618aee77b829
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 19 21:40:52 2013 +0000

    getDataReferent must return the actual data even if there's nothing to process
    added PNDRUniConformantVaryingArray()

commit fe655e46f81416a0a35bc898a2befc83bab30a1e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 19 14:48:45 2013 +0000

    Based on feedback from Renaud Dubourguais we're changing some behaviour when retrieving/storing files, allowing to set th
    e share access mode, aiming at making this change dialect independent. This involves:
    
    1) smbconnection: changed getFile() and putFile(), adding a shareAccessMode parameter
    2) smb3.py: changed retrieveFile(), storeFile(), adding a shareAccessMode parameter
    3) smb.py: changed nt_create_andx(), retr_file(), stor_file(), stor_file_nonraw() adding a shareAccesMode, and using nt_create_andx as the way to open the files, so we keep the same shareAccesMode flags across the different dialects.
    
    Functionality shouldn't change if no shareAccessMode flags are specified

commit 4082fd1d312ccff27207ef6dd7ee2193c094d724
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Nov 18 16:12:05 2013 +0000

    Fixed arrays marshaling/unmarshaling where the referent data was not processed

commit b8be1d76ea90e9b191a11d52e0e5112aa2289b70
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 18:52:42 2013 +0000

    PNL_SITE_NAME_ARRAY is a toplevelpointer

commit 9576e329b05e454223127aef201967bf5dceb6d3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 18:52:14 2013 +0000

    Still have to solve the situation of nested arrays with referent data. Leaving it commented for now

commit 76cef7696e8ff4e455c697a8b5cecd4b12cfb571
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 18:24:59 2013 +0000

    Removed debug msg

commit 6cfdb9f99fd8429bfde18a25d76b206216f5c7e5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 17:56:55 2013 +0000

    LPWSTR2 is actually a PRPC_UNICODE_STRING. Still, [MS-DTYP] contradicts other documents describing such structures. Hence, there might be changes in the future until I figure out of things actually are :s

commit b091961a9e78278d688dbb2cb93c6ae92232aff9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 17:45:31 2013 +0000

    Redefinition of RPC_UNICODE_STRING, UNIQUE_RPC_UNICODE_STRING

commit e383907b462c1bb2e3a6fc1ba56786fe8705f159
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 16:39:00 2013 +0000

    Fixed bad definition of NDRPointerNULL

commit 8040cb5997f82b4ff8ce145bc8fec9f09223173e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 15:55:38 2013 +0000

    Added NDRCall(). This should be the base class for every DCERPC structure call. Still testing

commit cb1095ac0c0e76921ecdc8270f4c9ebf3c183c62
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 15:11:42 2013 +0000

    Minimal changes.. still pending managing the representation of referents correctly, according to [C706], 14.3.12.3 Algorithm for Deferral of Referents

commit a44f796a67d8fd5566b1ea858a222b32387a4046
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 01:27:52 2013 +0000

    Better handling of arrays and referent's data

commit 3b4b460ec1a509010d163b67922770c18f8afd9d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 15 21:13:07 2013 +0000

    Continuing with r992, testing the new NDR lib. Still lots to do

commit 1c4689255c92242c77f5730313c6b939b4003a35
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 14 21:45:52 2013 +0000

    Since I added this a few days ago, I'm experimenting with NDR inside this interface. Marshalling gets much simpler.

commit ec52aa727309b57648097749658d0c795c199d62
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 14 21:45:00 2013 +0000

    [C706] Transfer NDR Syntax initial implementation.
    Needed for so long. The objective is these classes to be the foundation for all NDR encodings. ndrutils will be gone eventually. Testing needed

commit b7964844564f51f2aceb5903e08cff7546110f8e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 12 16:26:58 2013 +0000

    Don't stop at the first share w/o write permissions. keep trying

commit 02120781d31f8305da8178d4907308040a4d4880
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Nov 10 23:01:51 2013 +0000

    Updated test cases.. dummy passwords for my lab

commit 9c235ca5360212ed9438ff8a3094caad5a33694b
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Nov 10 22:38:49 2013 +0000

    Added NetrLogonGetCapabilities(), NetrLogonGetDomainInfo() (not finished yet)

commit 1e416549b281072ba332a2485be0aa6685742560
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Nov 10 20:47:57 2013 +0000

    More changes here. I'm adapting the code so another SSP (netlogon) is supported by the dcerpc runtime. Still work to be done (not working at the moment), but shouldn't interfere with WINNT SSP at all (crossing fingers)

commit 092d41aa15c26745bf4790df231f03c8012968cf
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Nov 10 20:46:19 2013 +0000

    Added ComputeNetlogonCredentialAES(), ComputeSessionKeyAES(), ComputeNetlogonSignatureAES(), encryptSequenceNumberAES(), decryptSequenceNumberAES(), SIGN(), SEAL(), UNSEAL().
    
    In short, all the cryptographic operations for netlogon SSP should be there. Now we gotta test them more

commit b9ada53288be978faeda630d4fbd6c6ef0f49f9c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 9 22:47:13 2013 +0000

    Moving some crypto stuff into netlogon. They shouldn't be used by anyone else, so it makes sense to be just inside netlogon

commit 5e7d57d87410efe2134d665406dc8131a93a8b36
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 9 21:24:21 2013 +0000

    Only the first 8 bytes are the ones that matter

commit 79793bf9156feb01090cb34636e4a29b01565fdf
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 9 21:18:52 2013 +0000

    Added getSSPType1(), SIGN() and deriveSequenceNumber(). I'm not sure this will be here in the future since this is the netlogon SSP

commit fa985fffcce27a7891385b9812ea155928e27881
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 9 21:17:30 2013 +0000

    Added encryptSequenceNumberRC4() decryptSequenceNumberRC4()

commit ec14f20550f688d922d3f6739c155a36ee9d758d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 8 19:16:04 2013 +0000

    Adding some structures and functions for the NETLOGON security provider. Still not used

commit 50e5f50df0fe7471ed01a7d49c7215fff1ed58ef
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 8 19:13:10 2013 +0000

    Big changes on DCERPC Runtime, aiming at making it more flexible for future stuff to be added.
    
    dcerpc.py:
    1) Security Provides and Auth Levels added
    2) Changed most of the structures in such a way that they work not only for creating packets, but for parsing packets (before it was just one way).
    3) MSRPCArray() and MSRPCNamedArray() moved to samr
    4) SEC_TRAILER() structure added, following the recommendations of [MS-RPCE]
    5) Calling to SEAL/SIGN changed, isDCE not available anymore
    
    ntlm.py:
    1) DCERPC_NTLM* structures are gone. Didn't make any sense in the context of ntlm.py. Now ntlm.py crafts the same structures
    regardless of who's calling them (smb or dcerpc), and it's up to the caller to treat them in their language. This is aimed at making ntlm.py as general as possible as a security provider
    2) the isDCE argument for various functions is removed. Not needed anymore, based on 1). Special attention should be kept for thos using getNTLMSSPType1(),getNTLMSSPType3(),MAC(),SEAL() and SIGN() in their implementations since the amount of parameters changed
    
    srvsvcserver.py:
    1) ntlm.DCERPC_NTLMAuthHeader not available anymore, replaced by SEC_TRAILER()
    
    test_ntlm.py:
    1) Changed SEAL() call since isDCE is not there anymore

commit cacffb703830b9f1f5cacf9d0596fed64aa9b356
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 8 18:57:30 2013 +0000

    Test cases for the DCERPC runtime.

commit adba0fb24ffc5a0967f603ec461d34169f4ca11c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 8 18:55:58 2013 +0000

    We don't need this anymore

commit e3859e47443be9d41213d94c1cbd91ef4bc2c298
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 8 17:42:11 2013 +0000

    More test cases added. Except for the named pipes methods exposed by smbConnection, we're testing the rest of the methods, for each dialect we support

commit 1141246543e176de67413c53ee0a61d08ce4c782
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 7 22:20:26 2013 +0000

    MSRPCNameArray() and MSRPCArray() are only used here. Soon to be erased from dcerpc.py

commit 989f6b17f550b0404e9005c4b2b531a45a4174bb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 7 21:45:38 2013 +0000

    Added ::: at the end of the credentials grabbed so it's compatible with ophcrack

commit 44ec59cc26aec6d4b4bd5e53efdb667dd5f24bfb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 7 21:21:13 2013 +0000

    No need to send isDCE parameter. It will be deprecated soon

commit 25c451cd577bcd1f8f607600e2a3d0baf51c5acb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 7 21:10:06 2013 +0000

    Don't fail if we don't have a smb.log

commit ff1bfc86fcb3a686d63ff5bd724b3d705af43189
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 7 20:46:16 2013 +0000

    Removed raise when an exception is triggered

commit 147791a176454e280efdd0d816e701e80c6d72ed
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 6 16:40:15 2013 +0000

    Auth levels should actually be here, not inside ntlm.py

commit e79fafc5af03f4bf90134804879ad47927fcda53
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 6 00:37:41 2013 +0000

    Adding set_auth_type() for future use

commit e36492a489756bf1a84981b5b463924e4d581d19
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 23:47:41 2013 +0000

    Changed NETLOGONServerGetTrustInfoResponse(), in particular PNL_GENERIC_RPC_DATA. I'm still not sure it's right since I can't get enough tests yet.

commit 5c2bf2b500495e0a1d6e26c4189bb40b9f10be7a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 23:38:21 2013 +0000

    using commonHdr instead of structure, easier to include in other structures

commit e4772b97bd07e2d37830073a2c31cb3c6459f9e1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 23:32:12 2013 +0000

    MACHINE.ACC secrets printed out much better.. including the machine name and domain whenever it's possible

commit d14765341a7edfaeeee3b0bd99af94b6c81fd633
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 21:49:35 2013 +0000

    Added NetrServerPasswordGet()

commit 78b1b7cc0cb54bf4b536c1be875c7df3dfabd63b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 21:03:34 2013 +0000

    Added NetrServerGetTrustInfo()

commit c1b4688f02368d9e22d9090687a086b1e6a3e7a8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 20:54:58 2013 +0000

    Added [MS-SAMR] Section 2.2.11.1.1

commit cd3b3db7679700e3e2999d45dd3504ac3f0eea77
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Nov 4 21:00:50 2013 +0000

    updated KNOWN_PROTOCOLS

commit f25c099fae201e78f876fa068d4b713192c1f4fa
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 2 20:59:37 2013 +0000

    Added NetrShareGetInfo().
    Removed unnecessary structures.. moved soon to be removed functions to the end of the file

commit 7ea54718cd2165b8431a0d4f769dcb01835fedff
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 2 19:55:57 2013 +0000

    All structs from srvsvc.py that were removed copied here. They are still being used. I'll port this whole file later

commit 7b6a63f81cd8bc7c500b940a72b3bcda64d6f597
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 2 19:20:02 2013 +0000

    get_share_enum_1() stuff removed. Just left it calling NetrShareEnum for compatibility reasons. Might be out soon. Use NetrShareEnum() instead.

commit df5b504beadc5d9f957eb9e27108f4552b66bebd
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 2 19:04:20 2013 +0000

    Changed my mind.. strings returned are UNICODE (NULL terminated). It's up for the client to decode them. Mainly to maintain same behaviour of other functions

commit d44e3e0b6f371af5ea4db3af42ef1caaac4ee1e1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 23:23:22 2013 +0000

    smbconnection.listShared() now uses NetrEnumShares(). Changed smbclient.py to reflect that change (difference is unicode decode is not needed)

commit 4eed74ea83cda3fc1a512005a1c4a20f025b7a6d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 23:18:57 2013 +0000

    Added NetrShareEnum(). get_share_enum_1() going away soon. Don't use it anymore

commit d90de89bd072975cfe93a9b7fb2052285db8f5a8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 21:29:19 2013 +0000

    Added who commands, which calls NetrSessionEnum()

commit b8deea30fb4d783d2c2834e663e7a852d980b9d9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 21:25:17 2013 +0000

    Added:
    1) SRVSVCSessionError()
    2) NetrSessionEnum()
    plus minor cosmetic things

commit 73ad64af2fee827d268c94ac97d0c0d858afec6b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 21:08:43 2013 +0000

    Forgot to increment self['Data'] for deferred fields

commit 45c53c718ff3f035f361a5d905152f6609615877
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 20:43:05 2013 +0000

    First try for a generic NDRArray.. I'm sure it'll change in the future

commit a52b612c65af81d8641a049bf701e17ec0513fbe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 20:27:45 2013 +0000

    Opps.. forgot the enclosing bracket :-o

commit 62ba258015d265b394e8b4847a231c1d2f168d4e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 20:27:01 2013 +0000

    Fixed indentation bug for extra items created on the fly

commit 1976d4eda35d23167c5c1fe8d3f486009d72d380
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 15:38:33 2013 +0000

    MACHINE.ACC converted to nthash :)

commit 1936ea0e495e59ee14c00a82528fe7038bbaf73e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 31 21:37:41 2013 +0000

    Added:
    1) DsrGetDcSiteCoverageW
    2) DsrGetSiteName
    3) DsrNetrGetAnyDCName
    4) NetrGetDCName

commit c6e47f4573e2dfb9a11cefac89fdd276396f5707
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 31 20:11:36 2013 +0000

    [MS-NRPC] Netlogon interface implementation. Just starting...

commit 437935cf9a3a59a333c9344b3294bbbaeb246fe4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 31 20:09:40 2013 +0000

    [MS-NRPC] Section 3.1.4.3.2, which adds:
    1) ComputeNetlogonCredential()
    2) ComputeSessionKeyStrongKey()

commit 51208f4ed3b6927c34d40ed76823877e0d2a51d7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 29 16:04:19 2013 +0000

    Added get_dce_rpc() method to the DCERPCTransport. Now clients don't need to cast a transport to a DCERPC_v5 or V4. That is handled by this method.
    I'm changing the examples to reflect this move.

commit 080a149e3f9c4b24401eda27a3c7e58888c26048
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 29 14:33:35 2013 +0000

    Added documentation

commit 37a1759b9bca718e7876040c43fbcdc4be350037
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 28 22:31:50 2013 +0000

    Extra logging info just to let know we're trying to grab the ntds.dit (if found)

commit 32f742404ac405ac09447e62daf40942575c6c2f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 28 16:06:41 2013 +0000

    Added a first try for autocomplete inside the minishell

commit 9d423f2a39b44f321149e0f1ede628613d537cff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 26 18:03:01 2013 +0000

    Removed raise used for debugging, and a bogus bootKey

commit 9270216e926c36632e97918e0850fcbbadaf6c6d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 26 16:58:45 2013 +0000

    Performs various techniques to dump hashes from the remote machine without executing any agent there.
    For SAM and LSA Secrets (including cached creds) we try to read as much as we can from the registry
    and then we save the hives in the target system (%SYSTEMROOT%\\Temp dir) and read the rest of the data from there.
    For NTDS.dit, we have to extract NTDS.dit via vssadmin executed with the smbexec approach. It's copied on the temp dir and parsed remotely.
    The scripts initiates the services required for its working if they are not available (e.g. Remote Registry, even if it is disabled). After the work is done, things are restored to the original state.

commit f91ad83aeb355434227f97eeac2c226e9400cb6c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 25 22:24:58 2013 +0000

    1) NDRConformantVaryingArray added to ndrutils
    2) LsarQuerySecret, LsarRetrievePrivateData, LsarOpenSecret added to lsarpc
    3) Fixed tab spacing and documentation

commit aa191e23e803db4f4c0e9ebafdd7883172b8034b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 25 19:25:57 2013 +0000

    Added
    1) LsarOpenAccount
    2) LsarCreateAccount
    3) LsarDeleteObject
    4) LsarSetSystemAccessAccount

commit 63818a88f173466afea659c88f2ab292ab2a3f12
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 25 18:12:18 2013 +0000

    Removed debug msg

commit c1be1c7fdfc09f3a761cdce5c75dc7b64c96878d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 25 17:32:06 2013 +0000

    LsarLookupNames2's answer now correctly parser, I had to redefine RPC_UNICODE_STRING as well

commit b56b881e716e2c934087ee9750a4976141f6493b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 25 17:29:05 2013 +0000

    Indentation spaces weren't followed when dumping internal structures of a structure

commit c0f175cce939d8dfd1cd6a0ba014885aa6f8aac9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 24 22:01:24 2013 +0000

    Adjusting parameters based on previous LsarOpenPolicy2 change

commit fd3526a40c952c500dd9d14b3ef9ebccfdd0aa77
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 24 21:59:44 2013 +0000

    Implemented LsarLookupNames2().. still need to parse the answer.
    LsaOpenPolicy2 parameter's names changed, so it better reflect what [MS-LSAT] specifies

commit 0e0c326474c906b15c45241f08819fddca68dca9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 24 21:55:09 2013 +0000

    RPC_UNICODE_STRING implementation with structure.. Needs lots of testing

commit b4f486c5d23e30c14faee1d015735e8c48ed18f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 24 15:52:44 2013 +0000

    Better error handling.

commit b6248aa9fb9d0bda70cd7b28699f40df1a11eb85
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 21:30:20 2013 +0000

    command parameter is not used anymore

commit 976263d0d44b02d54e55abd21364c7d43fc43a39
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 20:52:44 2013 +0000

    For local users, we gotta prepend '.\\'

commit cee60979b35bfa3aaf68a8f7b9146533e95ba042
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 19:57:14 2013 +0000

    Added information when CREATE and CHANGE are executed

commit 85b47bbb6a64b7db9e67afdca1b8e99a99b9212b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 19:36:58 2013 +0000

    Now you can specify username and password when changing service's configuration

commit f1fe308178d15737c85caea682f8fe120e1623b6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 19:25:03 2013 +0000

    1) get_session_key now returns the right session key.
    2) Now all the packets going out request NT ERROR Codes

commit 72a97411b6227312bc8a260c52e6e751ab7eef14
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 19:22:38 2013 +0000

    Compatibility for old SMB servers (NT 4)

commit ce199039001cb1b48425860e8774370fbc580bff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 18:52:52 2013 +0000

    Added getSessionKey() method.. It will still not work for SMBv1 protocol

commit 18c036d70811cc21e4ca684f9dc268ee4d6b07ba
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 18:51:32 2013 +0000

    Added ability to change username and password for the service. However, special attention should be kept by the caller. Read the method's documentation

commit 9b0c2dc60dc4f36ba1f0915442305afe818c8456
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 18:43:33 2013 +0000

    Added [MS-LSAD] Section 5.1.2 / 5.1.3 functions

commit 210cfae6ff0703451a05517e47c62a17c32c49fe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 15:17:19 2013 +0000

    Extended support for ChangeServiceConfigW().. I still gotta find out how to set a password for a service account. That is pending.
    On services.py, I added the change option

commit a722444cd69fa4a38585f504babddc3c0ce02d05
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 21 14:59:17 2013 +0000

    Fix for issue 33. The fix works with implementations that send the information elements out of order.

commit 9f317adbe1b4c8d0abc56589d95a0a1d0942f871
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 21 14:24:40 2013 +0000

    Removed debug message

commit 3f8f52023dcbba06a4bb143fd52010ebe3faedfc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 21 14:12:45 2013 +0000

    Better handling for KeyboardInterrupt. Service name and output files still static until we're sure we're cleaning everything up.

commit ef7c685d260e9fd9afb9ebb6abd4ce83f301c2c1
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 20 21:21:59 2013 +0000

    On the first run, it takes a while the remote target to start executing the job so I'm setting this sleep.. I don't like sleeps.. but this is just an example Best way would be to check the task status before attempting to read the file

commit 179ea7b157ca5d5256c627ef32b52ea1d93f62ca
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 20 20:24:25 2013 +0000

    Protocol specification not needed anymore.. it'll try the list it already has

commit 081badd2443d782cfa06bb1bdd5572914ba08a83
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 20 02:14:24 2013 +0000

    Updated documentation

commit 00a9cb4f5583bc10081266c33112709a0a8c1cc6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 22:52:08 2013 +0000

    Better error checking, adjusted to logging functionality

commit 623b9b7c8d77a00c3837d08df8784c5742d5183a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 22:20:12 2013 +0000

    Implemented SessionError so clients can use this Exception regardless of the underlying SMB version used.

commit dc0ab1c89806878b6493449c521a2346ffaea419
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 22:19:37 2013 +0000

    Removed NT errors from that code and using nt_errors.py instead. SessionError is changed to align it to smb3, smbconnection. Now we only rely on NT Errors. Pending task is to remove all the errors from the library.

commit 94e4196d3caa9b7254e6fad7bbb576c7d3c782f6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 20:07:42 2013 +0000

    Change in SMBFindFileFullDirectoryInfo UnicodeStructure, no need to have 'u'.. changing to ':'

commit 93e7c20c459f6a960f6cadc1466537cb9db0366a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 20:06:11 2013 +0000

    when doing ls, it now prints a ls -la like format

commit 26c469e6eaed89f2de204e7f5da92b14d43c669b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 17:56:27 2013 +0000

    Inside listPath, now we ask for FILE_FULL_DIRECTORY_INFORMATION so we can fill all the SharedFile structure, compatible with SMBv1 behaviour

commit 9f786f56ae77da0f7b07b558d2efcf06a4502830
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 18 18:18:22 2013 +0000

    Some improvements in the login parameters. Now DOMAIN/Username is the way to pass data. If no passwd is specified, it is prompted

commit a4d54fc34412ad81749dabe1d86401e61a4e9361
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 18 16:37:48 2013 +0000

    No need to do JobEnum

commit c2cf296566e46fff9a86a39344bd0ee899e2dd37
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:35:14 2013 +0000

    Not used anymore

commit c199697ac7e99846b96665b219db2357b36608d6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:33:41 2013 +0000

    Not used anymore

commit caf4d50a96c935a371765c74b4cf8b235286d740
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:33:07 2013 +0000

    Not used anymore

commit 676039848f72e3b68f925f543a5715681fda521d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:32:12 2013 +0000

    Not used anymore

commit 5eeeb4cf235b8cdb6886b40619b2880a1aff60cb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:21:17 2013 +0000

    Changed command line.. -windows-auth is enough to specify windows auth will be used (no need to put True)

commit 0cba1fd3cea3baaab2fb6bb2190a9e00c4436002
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:17:03 2013 +0000

    Not used anymore

commit e740dd58689f387e0928ee8a4475905ceee6a078
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:08:15 2013 +0000

    [MS-RDPBCGR] and [MS-CREDSSP] partial implementation just to reach CredSSP auth. This example test whether an account is valid on the target host.

commit 6cb08415db19af2229d4cce8c7e2e3e6f88b7a4f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 19:55:31 2013 +0000

    Removed the protocols options from the command line. It will try both 445 and 139

commit 09d7258b60835d003295361e1c0975a54e26fad3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 19:47:55 2013 +0000

    replaced for atexec.py

commit 82a8581bb80e99da3e3997e8e57643f62812447f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 19:44:40 2013 +0000

    This example executes a command on the target machine through the Task Scheduler service. Returns the output of such command

commit 1d2b85c92a9cbe96320873e229e232b44733b31f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 14:52:08 2013 +0000

    Increasing timeout for SMB connections to 60 seconds

commit d32080ea629f0b1fd1b803cbf59d4b517d7fc8f8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 21:58:09 2013 +0000

    Indentation when printing values

commit 2f153458b9433e37354e97a1881f4ef010daae86
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 21:45:46 2013 +0000

    Better handling for NULL strings

commit c8ec0b91f64920398283fd16108ae93beb535abf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 18:59:29 2013 +0000

    change in logging mode

commit 1e931f59bc5e7e27cc0e4af0c7e16648056979fb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 18:58:06 2013 +0000

    logging mode changed

commit ac4582c270dfa18976030546f599bda08315e891
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 18:56:55 2013 +0000

    Logging goes to stdout

commit ca02edf74bb14f44404cf5a2303741b2b9f36f32
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 17:39:24 2013 +0000

    findKey does not log error anymore if a key is not found.. just returns None

commit ce254ac72b26533676e8a4a6169e6ee8cb230709
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 14:11:20 2013 +0000

    Fix a bug in walk when specifing a key that has no more childrens to walk

commit fedbf75ecdb311da7ad3d6b9b2c3d64a362dcb37
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 14 06:06:58 2013 +0000

    Fix in printValue for values REG_NONE

commit e7623de969153d7f5745d0443479cd999537a89f
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 14 05:37:51 2013 +0000

    Moving the file parameter to positional arguments

commit c811f3412ed80873421bff73a06abf4ac21dc4f3
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 13 20:04:29 2013 +0000

    When creating a new service, by default it won't be interactive. New serviceType parameter added

commit 57e5c2e620a15a697a77045864f1e1a859120484
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 13 18:08:19 2013 +0000

    Next version will be 0.9.11, not there yet

commit b3a057abef6331e83bd6ba170fcdbc65fc0bea7f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 20:09:14 2013 +0000

    if conversion fails, hashed should be assigned inside the except clause

commit fe5cf512e0473440805b4bfdddb93e9e2a297202
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 19:50:39 2013 +0000

    typo

commit c380fd947592b9e22c1ebf928ce7f6bfaa90d40d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 19:37:56 2013 +0000

    if conversion fails, hashed should be assigned inside the except clause

commit c12776ab36cc6aa3c38dc95ec1a1d914588f83db
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 19:01:43 2013 +0000

    Allows DCERPC transport to get the credentials of an already passed smbConnection

commit f30407f8dea1051d01acb98b06ad7651a85d1864
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 17:51:26 2013 +0000

    Updated example

commit 6396f7508602d78cf819643963ee95b88bbdba1d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 17:40:54 2013 +0000

    Added SchRpcRun() and NetrJobDel()

commit 93325adb8af2925bf8b026d89e698f39b721f52b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 15:49:32 2013 +0000

    Now the ESENT_DB class accepts a remote file object, which is similar to a
    regular filename, but could be remote. It's up to the caller to send an object that
    will behave as a regular file.

commit 32980416f212ad9e65c45e0926ef972992ca6260
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 13:42:50 2013 +0000

    No need for that try: pass at the __del__ method

commit 6eab200c0822badddf5ecca69d92a33e83ccdbc6
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 00:00:28 2013 +0000

    Now the Registry class accepts a remote file object, which is similar to a regular filename, but could be remote

commit 6e2059a5ad626d7b1e5c7c7ec40d6ce8cf60ba2b
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 9 22:22:22 2013 +0000

    Moving an annoying message to be displayed just in debug mode

commit 1efd12623632f676fe5242fe0b02f911256348ef
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 8 23:07:29 2013 +0000

    Removed unused lines

commit 0f8a2e3cd074a6b8d01848a3166ae329458a964b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 8 20:17:58 2013 +0000

    Example to use the Extensive Storage Library (ese.py).
    Allows dumping catalog, pages and tables.

commit e934123a90df1bd65c7c3f031aeec51c5e7ad345
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 8 20:14:38 2013 +0000

    Microsoft Extensive Storage Engine parser, just focused on trying to parse NTDS.dit files (not meant as a full parser, although it might work)
    Based on the excellent paper by Joachim Metz
    http://forensic-proof.com/wp-content/uploads/2011/07/Extensible-Storage-Engine-ESE-Database-File-EDB-format.pdf

commit b1d45d5937c9744eba037a12b85d51c52d5d5218
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 5 23:14:18 2013 +0000

    Changed dump() method. Now it tried to print the structure based on the original definition, instead of printing the items in whatever order

commit 4fc6803cd0d89bc1ed5ec2e36d02adb3e6b9f9fc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 1 20:45:30 2013 +0000

    changes to documentation

commit ffbb0d20624efad3056b110c1b4b05a89bd305c0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 24 17:02:12 2013 +0000

    Added walk option

commit 4f1a66f4829acad851feb8ddf2ca78141c73dd14
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 24 17:01:08 2013 +0000

    Added ability to walk recursively from a key path

commit d74f54cd4d884f1756a4ed62acebb49863a44449
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 23:25:25 2013 +0000

    Fixed bug that was getting 2 bytes short out of a value

commit 83edd0f1f5a3127ff1822b7eba1689e711658147
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 23:13:54 2013 +0000

    Adding support for the default value in a key

commit f7d705ad1de0ef2f6586ace1f3ff02f2aabbcabd
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 22:34:53 2013 +0000

    Finally.. If no password is specified, it is asked to the user.. so you don't populate your history with passwords ;)

commit 18b581f6be1e5d7ac8b228e28ee2fcc45500dd8d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 22:05:37 2013 +0000

    Added ChangeServiceConfigW(). Right now it just allows to change the serviceType. That's all we need for now

commit e78d0dcb2f478b2ca3a34026dad95c0165a1ce7d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 21:55:16 2013 +0000

    typo

commit 95994c660dc6b8d6c12e2d393ca767c31b647757
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 21:54:20 2013 +0000

    stripped debug output

commit 7092c2431a9cb53194eaf23dace3ee621f9d5df9
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 21:53:42 2013 +0000

    forgot to set the variable that states an smb connection was provided, so the connection is not close when finishing the RPC usage

commit adaf46a2ae5445ad91ba1fd4ac2688c2aa39e935
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Sep 22 22:38:58 2013 +0000

    add the possibility to specify an connection already in place for a SMBTransport

commit f6d39cbb2fd8b683c610b19f9e5055cd16741d1a
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Sep 21 17:47:15 2013 +0000

    Added regGetClassInfo()

commit f2514421e7769dc0f0f41d76073dcc8c7a7bacb9
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 20 19:25:11 2013 +0000

    Added regSaveKey()

commit 92bd98ee6d2acc2e10ff6cf6ee043430ea8a4509
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 20 15:19:24 2013 +0000

    Example for windows registry reader.. you will need a registry file (you can grab it with ntfs-read)

commit 4e09877e7fce12a235cfefa29be227a1cf7e7da8
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 20 15:18:26 2013 +0000

    A Windows Registry Parser Library

commit 2100194333f13bb4d976387d6408d572799a28ec
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 16 17:43:01 2013 +0000

    Added PYTHONPATH var to runalltestcases.sh

commit 6d1784bf620cb167a4e0e0e68a026204f046eadb
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Sep 14 01:35:24 2013 +0000

    1) Depending on CD or GET or HEXDUMP, autocompletion will return either just files or directories
    2) Right after starting minishell, the root directory is cached for autocompletion

commit fd757133ce8703858e5330a0dec35888fd17eb50
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Sep 14 01:13:07 2013 +0000

    1) INODE.walk() doesn't print the results anymore.. it just returns a list of entries. Up to the caller
    2) FileAttributes better printed
    3) Simplification of the CD method
    4) Now, after a CD, it caches the entries of the new directory for TAB completion
    5) get/cat/hexview all call the same method

commit 23ac6774a7ce97aeedae92e0227f6f7f249119bd
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 13 20:25:12 2013 +0000

    An ugly implementation of ntfs so you could read an ntfs volume.. just for fun.. interesting for grabbing files that are locked by the OS ( guess what files ;) )

commit 248b642929910dd48dd06bc6857e7bdf481d826c
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 5 15:37:45 2013 +0000

     * Moving EAPOL, EAP and WPS decoders to ImpactDecoder to break cyclic dependency.
     * Adding copyright header to new files.

commit a3385a444e0006605ab9f105c3729c8f6a49bf71
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 5 15:36:22 2013 +0000

    Infers the PYTHONPATH to run the tests

commit 244a6d4b9528940d2d3eb7795e0fc225603cd811
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 5 14:16:40 2013 +0000

    Copyright notices for new things

commit e521d145bd7e2e3d53bffe8f6554a7c5109d9d55
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 3 19:48:13 2013 +0000

    Plug-in decoders for eap and wps.

commit 53203f53438fe6445b59877856ef6aa9481d6337
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 3 19:21:43 2013 +0000

    ProtocolPackets for eap and wps. Including some basic tests.

commit cccbc59423696f7ef2b5b1d24b2c9c626dd21aef
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 3 19:20:50 2013 +0000

    Fixing PYTHON PATH in .pydevproject

commit bb539d0f3970bae3978fbc6cff4dbbaafc0a575a
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 3 18:17:39 2013 +0000

    Adding pydev project information

commit 6d0f9bd293f755dc67da3768d1012ab9b30a13f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 15 21:31:37 2013 +0000

    TDS/SSL support should work now. Automatically detected by the library.

commit eb8b7fd30ea5d41652305edb09d4fdea6384e738
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 15 15:08:39 2013 +0000

    Initial SSL support for TDS. This is needed if the target SQL Server is configured with Force Encryption == Yes

commit 60151cf14ec7ad7add8a33b10bfdc199e2ad7c8d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 5 22:25:53 2013 +0000

    Adding third argument to ConfigParset.set() method.. Looks like it's needed on some Python versions.

commit 65abbc7f44f90d53a7b52b1d4bd721faf3a0a35b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 28 21:17:46 2013 +0000

    Sync with CORE internal repository

commit be0851486c6793909fd50ce8216a85167de55b36
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 28 16:37:56 2013 +0000

    Sync with CORE internal repository

commit f1d8f3e8365eedf46680166eb29e21d154cbeee7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 28 16:13:29 2013 +0000

    Sync with CORE internal repository

commit f0a06a147bac3e8bae19db4b1e24e71be893427f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 19 16:15:32 2013 +0000

    Just in case an *SMBSERVER is sent, let's get rid of it and put the remote_host address

commit 62cce192d3e86c73319f613ed11f33f250aff62c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 18 18:48:16 2013 +0000

    Fix for http://code.google.com/p/impacket/issues/detail?id=29

commit 1861c4f23e6f20f13fe723ab051fdb819aa08715
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 14 14:47:15 2013 +0000

    Fixes wrong decription in parameters

commit 994a5b70ef13aa9de142c63b7d2d313d960c4aa1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri May 31 15:53:50 2013 +0000

    fixing typos and escape characters for \x00.. as reported at http://code.google.com/p/impacket/issues/detail?id=27

commit 9d2c14e0d7943988b0b3698eef13c337473477e0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 29 00:38:30 2013 +0000

    dded option -c that would upload a file and execute it. Testing needed

commit 8fa4eec76b15e29d5a442026e5e4067c1c43dd09
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri May 17 19:30:16 2013 +0000

    Fix a bug in polling_read that would make the function to wait indefinitely given some circumstances.
    Fix proposed by akfullfo, check: http://code.google.com/p/impacket/issues/detail?id=26

commit c75eaebdb31e5a69f5a7c4506a00de559c587d0b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 14 23:03:31 2013 +0000

    Not using *SMBSERVER anymore, instead, using the host IP address

commit 6beb278713a767e655cb3f3f8e237d4fb679ef11
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 14 23:00:48 2013 +0000

    Fixed bug that would send *SMBSERVER when connecting against a Windows machine with SMB1 only, and also specifying remoteName = '*SMBSERVER' when calling SMBConnection. This usually shouldn't happen but I'm sure there are still old code out there specifying *SMBSERVER as the remote name. In fact, smbclient.py does that (my faul )

commit c6c1ccd2916c2019840e06a8db3c0ca281246819
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 13 18:16:52 2013 +0000

    VLAN tagging (IEEE 802.1Q and 802.1ad) support for ImpactPacket.
    This basically merges the patches and unit test sent by dan.pisi.
    
    Check http://code.google.com/p/impacket/issues/detail?id=24 for more details.

commit 70757ee97c21708b451a3179bec846fd2e81c980
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 6 16:58:09 2013 +0000

    Going back again to a development version

commit 1305350d688868a0872339ad82c0c1870636ee9b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 6 16:05:14 2013 +0000

    Updates version number before releasing

commit 01c3a1fd37c0ce18510ebdc5dc877062d670f83c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 5 20:56:20 2013 +0000

    Moving the debug message to the handler constructor so we don't log it for every request.

commit d0c8b4c377cfbc520781708a5b156dc394d211ee
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 5 15:39:19 2013 +0000

    Fixes on NTLMAuthNegotiate to better handle situations where VERSION field is sent by the client, plus correctly setting the right flags if hostname and domain are provided.

commit b4827384cd8293ed52714eca0674568cf2a4f224
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat May 4 21:44:22 2013 +0000

    Removed debug message

commit d7b174c447e0d109eee71a4fed8217c9ae3895b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat May 4 21:42:48 2013 +0000

    Now we also bind to HTTP and relay those credentials to whatever target specified

commit cf7841b35bb430a7d921a6a12fb6cb206de2f33c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 1 00:14:12 2013 +0000

    We were logging the wrong target IP when saying whether or not authentication worked.

commit 6f5a4d096e1cc4ffe3ef6491fd8490e399597b3c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 1 00:04:16 2013 +0000

    We don't need this anymore

commit fb40ee51eaf31c86fa5255aebd9c10eda39d9509
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 1 00:02:40 2013 +0000

    And moving it here

commit 7b64e4b469444169b80200770208c0509eca3f9c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 30 23:57:09 2013 +0000

    We don't need to have this script on a separate directory anymore

commit c292f77e8bda178309eef0223c0210e2f982e8ef
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 30 23:56:37 2013 +0000

    Getting rid of the need of a smb.conf file. We're setting the required configuration parameters programmatically

commit ed906102e8a9cbcbccd2667a99d59b6782f5abeb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 30 19:17:17 2013 +0000

    Some extra fields completed

commit 8a56382f413b7b21e707ae661d75adb79a9da24e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 30 15:47:36 2013 +0000

    correct the name of the package

commit d9c62492d54c72a706d0c746d799041e5cdf7342
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 30 14:59:50 2013 +0000

    Clarified requirements

commit 9c6af7834f54fa6ffcffe61be173979aa6cca6ac
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 29 16:27:45 2013 +0000

    Another alternative to psexec. Less capabilities but might work on tight AV environments.

commit 92e6b8b734321f960986420aa3d957a4856a929e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 25 22:07:46 2013 +0000

    Fixup imports, requiring it comes from impacket

commit 4da7746638dfe67b22c13860d3a78690d8255028
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 24 02:19:13 2013 +0000

    class.__str__ calls class.getData(), hence, changing stuff must happen there.

commit 82a14b22366c6881c7bbf35a1f69761b3b58895c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 16 17:52:48 2013 +0000

    Added impacket.examples so the installation script install all the required files

commit 8b6e35460f8890c514e5564a79035acf630f9db0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 9 18:40:15 2013 +0000

    Changed smbconnection so it automatically detects what SMB version is supported on the other side, instead of doing the old try: except: workaround that would take longer against servers supporting only SMBv1.
    See [MS-SMB2] section 1.7.
    
    In order to do this we had to craft the SMB_NEGOTIATION packet at the SMBConnection level, and then pass the NetBIOSSession to the smb3/smb layer.

commit 743b55c75dc7b20a02e00a854fe6031e3d82abd2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 9 14:11:32 2013 +0000

    Fix a typo in set_icmp_gwaddr() as reported by dirdi.

commit aa89d7717e5eebe87aadeab321393a9c90d0a587
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 8 21:09:46 2013 +0000

    Replace the reserved field expecting just zero values, to expect anything.. in any case we're not using them.. and some random smb servers might return non zero values

commit 6a84516583ccf5dbc78e5b33ff3bec67bf301ee6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 30 16:31:08 2012 +0000

    Fixed os.mkdir() not being inside a try/catch .. Triggering an un handled exception when trying to create a directory inside a readonly filesystem (for example)

commit 1ec29aa5df9d7081fa823329fe7c7780c7b7147d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 20 19:05:51 2012 +0000

    domain was missing when setting credentials for a DCERPC call

commit fac965731a328741ae34053bcec9c9c1561bf99f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 15 23:37:44 2012 +0000

    Fixes bug reported by Renaud Dubourguais that would make the domain/lmhash/nthash to be discarded when calling this method

commit 369dd3b69733ea6c6703c535162c5e8a27ffe5c5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 4 15:58:37 2012 +0000

    Missing space in EncryptionKey generation, it should be 'ServerIn \x00'.
    
    Reported by Amir Sela

commit 3fb6b86693d472761ff5ef667b5a970d0bcdc712
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 22 14:42:26 2012 +0000

    Don't try to read a 0 bytes file if we alreay know so..

commit 87c96be3e4a6e440c612c551d070d1d8b7aae3d8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 22 14:41:12 2012 +0000

    Log the exception instead of printing it out

commit 8b881cef15ff61e4171700d48cecc936de470cdc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Nov 19 16:54:24 2012 +0000

    When answering a CREATE_DIRECTORY request, check it starts with '/' before stripping it.

commit 2adb9e477f6c065618e264db73403206ba4b4ef2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 22 16:55:10 2012 +0000

    Fixes http://code.google.com/p/impacket/issues/detail?id=20

commit 1907cc7a8072c7326d6a8584aa09a01bb69b97c8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 7 15:32:34 2012 +0000

    SMBBackwardCompatibilityTransport needs the pipe to connect to

commit b01a6ece417fbb81f1e8d55a041263b933631361
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 6 22:18:17 2012 +0000

    No more share list through LANMAN.. now using RPC by default

commit 15de0e039b118b33d52daf804667f341fd5bc283
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 6 22:10:44 2012 +0000

    Unicode support for smbserver.
    It will advertise itself supporting Unicode, but should also work if the client does not.
    Still pending testing

commit 4037a5bd2f830545dba2ad6383b5dd0b2cd3a97c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 6 19:00:11 2012 +0000

    In REFLECTION mode, downgrade to standard security. This seems to be more effective on certain OS versions

commit b9507e47b5c3b68b637ad526c714098eb0ab86e8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 4 20:33:24 2012 +0000

    Deny anonymous logon on standard security auth too

commit a298b54ce99605ae3e69eb62a94343b485a70997
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 4 20:28:50 2012 +0000

    _dialects_data['Payload'] = '' moved up 'cause it's needed in case there's an encrption key

commit 67f7f4fec04f6f6e5a774dad7b78618e39b29d1d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 4 16:15:23 2012 +0000

    1) Fixup imports
    2) Send LOGON_FAILURE if the client attempts to connect as anonymous

commit 0eca55ea429e918c46447c24c30555bdec54dc26
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 3 19:05:34 2012 +0000

    Imports fixup

commit 4dced7beb8359b9088f9cce3c5667c2b056bcc7b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 19 20:47:41 2012 +0000

    Fixes http://code.google.com/p/impacket/issues/detail?id=19.
    
    I think I found a clever way to detect whether the data sent is standard security or extended security w/o checking the SMB Flags

commit 7e1d1d2288ed352ea93cebe32cb7896b5911d068
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 13 22:06:16 2012 +0000

    Missing setting the ChallengeLength when accepting standard security/no encryption key authentication.
    
    Fixes: http://code.google.com/p/impacket/issues/detail?id=17

commit 3450e59a2d4297dd5851ca7af95c5e4f67b6a72c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 13 14:39:12 2012 +0000

    Checking data received trying to detect the connection is closed and not throwing an exception

commit 81e603ef6da9fad9c669a2689773b40c667a24cd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 10 21:31:21 2012 +0000

    Changing the scope of the classes' attributes to make it easier subclassing

commit e610e70aa25047294e99c2fa48734117f85e73c8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 10 19:40:25 2012 +0000

    Fixed http://code.google.com/p/impacket/issues/detail?id=14 .
    There were other instances where id() was used in this way.. provoking an overflow.

commit 2a8b58cf02fd7fd4a24c2adf1cd9198f88555802
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 7 15:15:43 2012 +0000

    Although [MS-CIFS] defines SMB_COM_WRITE_ANDXas:
    
    SMB_Parameters{
    [..]
    Reserved;
    DataLength;
    DataOffset; -> Offset from the begining of the SMB Packet to the data
    OffsetHigh (optional);
    }
    
    SMB_Data
    {
    USHORT ByteCount;
    Bytes
    {
    UCHAR Pad;
    UCHAR Data[DataLength];
    }

commit f825155642e7a3cb77270fbb981a4f3cd3295ff1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 6 22:46:08 2012 +0000

    Fixes http://code.google.com/p/impacket/issues/detail?id=13 reported by Bryan.
    socket should use send(), not write().

commit 02c3d7b75151d8fa8c8ca2d59a4d3029513672b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 6 04:26:22 2012 +0000

    Reading the StdErr pipe using readFile() now.. Makes it work

commit e4ea903f3d7782f1b085baa181fd93e2bc3bee3f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 6 04:02:02 2012 +0000

    ChallengeLength must be treated different depending on extended security on/off:
    
    ChallengeLength (1 byte): When the CAP_EXTENDED_SECURITY bit is set, the server MUST set this value to zero and clients MUST ignore this value.
    
    and when CAP_EXTENDED_SECURITY is not set:
    ChallengeLength (1 byte): This field MUST be 0x00 or 0x08. The length of the random challenge used in challenge/response authentication. If the server does not support challenge/response authentication, this field MUST be 0x00. This field is often referred to in older documentation as EncryptionKeyLength.

commit e6a9c5cd3c84dc839844835d476cc4e527870805
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 6 03:06:04 2012 +0000

    We're not relying on client's capabilities based on the negotiate packet, but still looking at the Flags2 to decide whether or not extended security is supported.
    Fixes http://code.google.com/p/impacket/issues/detail?id=12 reported by Bryan

commit 5a8a6d1f2d4b749d23f30de8f6e08e7dcf39ca3a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 4 02:03:28 2012 +0000

    Adding tests for all dialects

commit 9e276c18b0f0355453f0243500a96a7e9f983574
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 4 01:33:09 2012 +0000

    typo

commit 031fc5e25415e23c520c0772facd3e3332ad0c85
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 4 01:27:34 2012 +0000

    Completing some aliases

commit f999d5336588bb2bf371a2ef8e3ca4b00c607cff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 30 20:25:03 2012 +0000

    When a stringbinding returned by the portmapper has '0.0.0.0' we should replace it by the servers IP address

commit 0306a10d24bba2cb0adb13317f6a6e37579b7834
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 28 12:39:56 2012 +0000

    If login is unsuccessful, clean all the internal variables in case user wants to authenticate again within the same connection

commit 1938dcf0d6fff52d10d861b9f8508704c4ff4ce0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 22:10:06 2012 +0000

    Initialization of self._NetBIOSSession to None. Important if something goes wrong before the connection is made

commit 7909c3292033a174ce2136c49b26fe6fc85b96bc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 22:09:27 2012 +0000

    global dialect variable added, once the first SMB connection is made, we hold the chosen dialect there, speeds up the process for w2k and xp

commit 53dfafc0f5ea2c26fd1f8c70cbd1b11262325d75
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 19:11:12 2012 +0000

    Test case for SMBConnection, still lots to do to test things right

commit 41623744c5373f19cd30b5f04631492e60d98d55
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 19:09:24 2012 +0000

    Porting smbclient to SMBConnection methods

commit f5eb286882f29d8d8950cb9aabda0314642b6212
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 18:24:22 2012 +0000

    Ported to the SMBConnection concept. Much simpler and SMB version independent. It will pick the best SMB Version when connecting

commit 633127140d6b642012bd0f1503e7d32fc0b67277
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 18:21:24 2012 +0000

    1) SMBTransport now uses SMBConnection methods.
    For backward compatibility it will try to detect if a SMBServer (not SMBConnection) was sent as parameter and will return a SMBBackwardCompatibilityTransport() (old behaviour).
    2) Exporting a method preferred_dialect() if you want to specify the specific SMB dialect you wanna use

commit 94bdb870f064d700df56df720e8be6e8c28b6d2c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 18:18:10 2012 +0000

    This helper library now works with the SMBConnection methods. If for some reason it receives an SMBServer as parameter, it will convert it to a SMBConnection

commit a10e5f8f2953d54df068700249a2d887b2707a3f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 18:16:21 2012 +0000

    Just a clarification

commit ef081f731119e9edc1789157754836a75447fa10
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 17:00:28 2012 +0000

    1) Allow an existing connection to be sent to the constructor
    2) writeNamedPipe uses writeFile instead of TransactNamedPipe()

commit 86fbb1e8b240acb4ac03cfe0efa25f879f5e2bb5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 16:59:02 2012 +0000

    waitAnswer on write()

commit 4f0f4e5fb00f7780234caa54300b90c727df09bc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 22:05:24 2012 +0000

    setTimeout() added

commit ec3581c8963d21bf086218ecea67d85a982f708d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 20:32:19 2012 +0000

    1) openFile opens the file for READ/WRITE by default
    2) Fixed bug in writeNamedPipe()

commit 570bb2414f4dce34befd6a3ab9b6c2bad2754ea6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 19:56:58 2012 +0000

    1) Added transactNamedPipeRecv()
    2) Fixed bug in openFile

commit 658d9e787ea6c6df3b31d2c499d394a83865f40c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 18:33:02 2012 +0000

    1) Added rename()
    2) Added readNamedPipe()
    3) Added writeNamedPipe()
    4) Fixed transactNamedPipe()
    5) Added listShares()

commit d15a11c2784fe07a548f2756801e39e47bd34f0c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 18:30:59 2012 +0000

    replace should be done against old_path and new_path

commit 5d75ab67bb8478fcb36d090b201da5c55e4ea7f5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 18:23:35 2012 +0000

    1) Added SMB_SET_INFO
    2) Added rename() higher level function

commit 95f2c02d09e6b82c994b504d6c3d717e23a06d5e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 17:06:06 2012 +0000

    WaitNamedPipe now accepts timeout

commit b39527293d16d6f579545bc7d2a9b4f6c87e2c57
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 16:53:51 2012 +0000

    we call writeFile for SMB/1/2/3 instead of write_andx. We have to take care of the amount of data that can be written if signing is enabled

commit 4405cdc180322b639a2ed321cba110552b95479b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 16:52:58 2012 +0000

    writeFile() added

commit 6dd5cd7b505b289476b8b039948a03c23d0906bb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 16:52:38 2012 +0000

    writeFile() added

commit b08c37bb71e270c238831aa520a8888b0c716413
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 00:50:45 2012 +0000

    Removing a debug msg

commit 57e0a87d503c3ae73950d1a110cbb8c253a5ba05
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 19 23:32:25 2012 +0000

    First version of smbconnection, not yet finished:
    # Wrapper class for SMB1/2/3 so it's transparent for the client.
    # You can still play with the low level methods (version dependant)
    # by calling getSMBServer()

commit a50394e80333328045e685b2894cc4ef554b569d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 19 23:14:12 2012 +0000

    1) preferredDialect added to the SMB3 class.__init__. Allowing to select an specific dialect to use
    2) getDialect() added
    3) backward alias get_server_os added
    4) del() added

commit 84670d2a2fbfc11802100874fa089902dc87033d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 19 23:11:47 2012 +0000

    getDialect() added
    replacing '/' for '\\' for all the functions that deal with pathnames

commit d12d7196ec4bbd9eacc7fd1b71a2f1187d3fd5c3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 21:31:43 2012 +0000

    Sign also for SMB2_DIALECT_002

commit 6f0791509e6cfd3f0f5c9a50d467294cb09d978e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 14:06:40 2012 +0000

    Added useTimeout() and remove()

commit d43162f9f393cced45a340f7a0e983992c2dd749
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 13:38:59 2012 +0000

    NT_STATUS errors are now STATUS errors

commit ae5194fc8966b6cae54d2211af96c5e8d176dd0e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 13:30:38 2012 +0000

    Removing all the spnego stuff and importing spnego.py

commit 1cadbcad06a2214757563b63133323dd911cb82d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 13:29:45 2012 +0000

    Using spnego.py instead of smb.py for the spnego functions

commit 59f47b2ccba857adafce903069e5ce0658a5787a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 13:20:52 2012 +0000

    Using spnego.py instead of smb.py for the spnego functions

commit 677f737261c5f5310368d53de6d2bc46d2668d67
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 01:39:04 2012 +0000

    SMB3 signing now working if the server enforces it. The rest of the key derivations are also calculated, needed whenever we implement encryption

commit 1954029cdffc1e30fcad39e1ccdd37de95377837
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 01:04:03 2012 +0000

    Extra crypto stuff needed for SMB3 signing and encryption:
    #   RFC 4493 implementation (http://www.ietf.org/rfc/rfc4493.txt)
    #   RFC 4615 implementation (http://www.ietf.org/rfc/rfc4615.txt)
    #
    #   NIST SP 800-108 Section 5.1, with PRF HMAC-SHA256 implementation
    #   (http://tools.ietf.org/html/draft-irtf-cfrg-kdf-uses-00#ref-SP800-108)
    #

commit 5c63d6be065faca3c1c3eb98a1ea88762173369f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 16 19:18:18 2012 +0000

    connect tree path must have be UNC like for Windows 8 to like it

commit 3f7e5da9a98d2dd7e5bcd97e7e7405311bcb47f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 16 00:29:15 2012 +0000

    StructureSize must be 25 for SessionSetup, if we want Windows 8 to be happy.
    
    So far it can authenticate.. still pending all the new SMB3 signing stuff

commit f69673c59696528d072b98336284fa5a96fb3a31
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 23:52:50 2012 +0000

    Putting all this stuff separate. we should take it all of from smb.py (not yet)

commit 964d3f208c4f729d6002e7d4845894db5e898344
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 22:57:06 2012 +0000

    Updated info

commit 80b5580dfa9a79e686d7f023aa3284e7d6feaaaf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 22:53:45 2012 +0000

    1) Added waitNamedPipe()

commit 93026c2982de8fbbfe89e5809ed67c66a7ac39f9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 21:49:44 2012 +0000

    Forgot to remove the other pair of the share inside self._Session['TreeConnectTable']

commit fb55dac69082c68f0f36246e7162443d1c2f8654
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 20:01:43 2012 +0000

    1) oopps! forgot to deep copy the TREE_CONNECT, OPEN and FILE dicts
    2) set_timeout() added
    3) working on nt_create_andx when cmd is sent

commit 0fc0a1fda1ea0c7d642add524229dc71146a77f9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 18:08:21 2012 +0000

    1) Added stor_file()
    For testing purposes.. smbclient should work with SMB2/3 with you change the do_open() to:
            self.smb = smb3.SMB3(remote_name, host, sess_port=int(port))

commit b24b15a99358f4d8baa2649588767f0cd8103576
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 17:21:26 2012 +0000

    1) Added SMB_QUERY_INFO call
    2) Added retr_file()
    3) Added open_andx() in the backward compatibility section

commit 0b253b8509b42c525250157ac444fe5eeee86493
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 17:15:57 2012 +0000

    when retrieving a file, don't create the file with a full pathname, just in the current dir.

commit 538a0bb17a51c2401c2e443d76c237273f0a2a3f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 15:05:11 2012 +0000

    When doing CD, check the directory actually exists

commit 202b0ef4139c412cf2b1d1d91281f24ed2284014
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 13:58:01 2012 +0000

    One more use of ntpath

commit 5615c25457f8fd6d1cde6a691cb82d871ca1df5a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 03:26:29 2012 +0000

    1) Added mkdir(), rmdir()
    2) If connecting to a tree that is already connected, don't connect again, just return the treeId

commit 67597966608afb38a00cf319e52d67f90e48fef1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 03:07:45 2012 +0000

    Using ntpath to join directories, much safer and clean

commit f927429eddb2ba18114a1f47bae592be8826ce3f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 01:22:04 2012 +0000

    Added list_path()

commit 275c011a4542c1e6b0e0b3b64a32367bdb5628a9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 00:53:32 2012 +0000

    SMBFindFileNamesInfo() has now a UnicodeType as well

commit d123563013e08c8be3316126ccbe5dabe39f8ff1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 14 23:47:36 2012 +0000

    1) Added isGuestSession()
    2) Added getServerIP()
    3) Backward compatible list_shared(), connect_tree, get_remote_host

commit 19840a88b2db384394de4dbc387fc886f8b79817
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 14 23:21:48 2012 +0000

    Initial implementation of SMB version 2 and 3 protocol [MS-SMB2].
    1) Signing support for SMB2 done (SMB3 not yet, as well as encryption)
    2) Commands implemented:
    SMB2_NEGOTIATE
    SMB2_SESSION_SETUP
    SMB2_LOGOFF
    SMB2_TREE_CONNECT
    SMB2_TREE_DISCONNECT
    SMB2_CREATE
    SMB2_CLOSE
    SMB2_FLUSH
    SMB2_READ
    SMB2_WRITE
    SMB2_LOCK
    SMB2_IOCTL
    SMB2_CANCEL
    SMB2_ECHO
    SMB2_QUERY_DIRECTORY
    3 left to go.
    3) DCERPC over SMB2 should work, if you change smb.SMB for smb3.SMB3 in transport (and import smb3)
    
    We'll do a SMB protocol factory in the future to make it all transparent to the user.

commit 2552e57fed56433c141fa77b9d98bb8e011d88b8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 14 22:49:24 2012 +0000

    Added TransactNamedPipeRecv() to smb.py as it's being used by transport.py. This is to isolate anything related to SMB1 from the DCERPC layer... (guess why? :P )

commit 0d76f992ce02c3e8500bd60f6f4f6c065a922e93
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 13 18:44:04 2012 +0000

    Forgot to remove the higher bits on the lower side of length field

commit 6b0b2eec7fd2c841b8d2f6f79d1b4be740ba24a8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 13 17:01:23 2012 +0000

    For NETBIOS_SESSION_MESSAGE the size of the message is 3 bytes long, using the flags byte

commit 04f6b3256049183b1150943f428507ae883a5291
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 11 16:49:49 2012 +0000

    Just ordering the imports

commit 68a36eb68a578ee1d88bcacaf5722da3b1188458
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 9 16:56:32 2012 +0000

    Binary compiled with VC2008 so it can work on Windows 2000 boxes

commit a1329d587172dba033653da58e7975772cd03872
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 9 16:54:12 2012 +0000

    Sleeps while waiting for the pipe to be ready. Set a max tries of 50

commit f5c72ebb022f3095508b86041baf1181ccacf6dc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 9 16:21:28 2012 +0000

    Increased the amount of bytes substracted for chunk_size to make it safer, doesn't look like it was enough for Windows 2000

commit 17870a41e3657b38ce220cabd1c7732991c96e8c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 7 14:30:07 2012 +0000

    If we know the serverName, use it for the path to the service, if not, just stick 127.0.0.1 and hope for the best.

commit 9ab7ae576e5bdbed7e2ce72f99279e3192fc6f00
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 6 21:49:56 2012 +0000

    Added -file option.. allowing to upload an specific RemComSVC compatible file

commit c6a052224f6d1130ff93bdc485c067935b9209e8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 4 19:36:18 2012 +0000

    Now it also print the Interface Provider (the exe/dll file holding the typedef)

commit 9dc37f96af6b6fa4eeb001b24837528aaa041ef8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 4 19:35:30 2012 +0000

    Updated KNOWN_UUIDS

commit d578b42a1c9d8b860b7d7cd54157776c4999811e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 3 14:01:11 2012 +0000

    A few more UUIDS

commit 4b0ff106fd3eb21ea6a7e80d569689abb4e794cd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 2 12:16:43 2012 +0000

    More updates on the KNOWN_PROTOCOL dict

commit b3eb3eaf9ab6df033015ddef038c08df16fd33a4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 1 19:28:52 2012 +0000

    A much better way to show and endpoint mapper output (IMHO). Now grouped by the Interface IDs

commit be278a142fcc1c4845c6cdd191db2861806e8bb4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 1 17:55:02 2012 +0000

    It now shows the protocol associated with the Interfase ID, if possible

commit 8b10b7920c2bebec6d6b3b4c24190e7a9e5c22bd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 1 17:52:49 2012 +0000

    Added KNOWN_PROTOCOLS dictionary.. I parsed all the Windows Protocol Specification looking for the UUIDs used. This could be helpful when reading a portmap output

commit 703a6815cf20652364bcde87c6e8e597eadb3f86
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 31 22:05:14 2012 +0000

    A simpler and faster version of rpcdump, using the new lookup call

commit 182545a341cb4bbfc35f8ff48966360ee7dd757a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 31 18:32:59 2012 +0000

    pump up version to 1.0-dev

commit 8eff6ce2722924c527796a555a8773c4b8090da2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 31 17:27:56 2012 +0000

    Forgot to remove forcing inquireType to be all endpoints.. now it honors the method parameter

commit 437091d68db03d1216f7f939ee2f69ba09f146b8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 30 23:40:39 2012 +0000

    PrintStringBinding() method added.. basically same code we had before but converted to Structure like code

commit 66793d1f1f7a53ce735f008e88377e49f55be54e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 30 22:15:28 2012 +0000

    Added portmap lookup function using Structure. It can work as a general portmapper, or just to find specific interfaces/objects.
    But most important, it doesn't grab records one at a time (as the previous implementation), but get them all and the parses the results. Way faster than before.
    Old code left there for backward compatibility.
    Still gotta finishing printing friendly the results

commit f8dcd5514a23eb4a9e47ee8c628b6ff4c9294161
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 30 19:54:19 2012 +0000

    Some clarification comments based on [MS-RPCE]

commit ac130e8bf0bf0b7bf98e7618d9f4420f9fd537b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 26 22:18:33 2012 +0000

    1) Fix bug when passing hashes, there weren't being converted to binary hence it wasn't working

commit 7e422881d578484d94b9ee05d46e3a0f5f504990
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 24 16:43:04 2012 +0000

    [MC-SQLR] example. Retrieves the instances names from the target host

commit 2e692c3cfb4105811e066983049ba71c3baf5a1f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 23 18:05:18 2012 +0000

    Added commands to the shell:
    1) lcd {path}                 - changes the current local directory to {path}
    2) enable_xp_cmdshell         - you know what it means
    3) disable_xp_cmdshell        - you know what it means
    4) xp_cmdshell {cmd}          - executes cmd using xp_cmdshell
    5) ! {cmd}                    - executes a local shell cmd
    
    Just to show what can be done..

commit 6c37c911075b748d97b0f6852e52930ed6c55237
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 23 17:59:25 2012 +0000

    1) Changed printRows, now it mimics what a osql client does ( I don't know if I like it more or less)
    2) ENVCHANGE now specifies what changed (DATABASE, PACKET SIZE, ETC)
    3) Added new types, dates should be shown well now.. decimal as well. Only important one left is SQLVariant

commit 47f51877eaa8367f5af2e2623b147564ab1390be
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 22 18:20:28 2012 +0000

    Now it shows TDS_NUMERICNTYPE most of the times :)

commit 1a0ed117f1a08b98d356a32508303d9beb99b144
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 23:08:49 2012 +0000

    Added -file option to specify a file with commands

commit 6a8373c79501f89febe82bbb1ae02ed2dd6af4f7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 22:56:55 2012 +0000

    Fixed bug in NTEXTTYPE, weren't adding the right amount of bytes to advance in the buffer (2 instead of 4)

commit 7c45e66a86fc174a2c8fe6856ead554b537c4a18
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 22:42:28 2012 +0000

    Added TDS_NUMERICNTYPE parse in parseRow(), still have to print it the right way. Now just printing a warning message

commit 8dde582908d9db9d1cff5cc09d3ba84574cff9e0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 21:38:10 2012 +0000

    Don't get into the SQL Shell if auth failed

commit 205135a8bb8a1c403b89eb18189f71b1c06165ad
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 01:44:01 2012 +0000

    self.colMeta must be clean every time we parse colMetaData

commit 644c6cb52ba8d4d6b1abf410ec3c55c238e14cf6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 01:21:29 2012 +0000

    TDS_NUMERICNTYPE size is just 1 byte (inside parseRow)

commit 73fa99559391f2cde06fad1e7b8a807823e8833d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 00:09:28 2012 +0000

    GUIDs can be NULL :s

commit 89484cdfe2f90874eee7fb383a70cd1260891ffd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 00:04:43 2012 +0000

    Added TDS_RETURNSTATUS_TOKEN and TDS_DONEPROC_TOKEN

commit dfeaa4e75ad891560abf5e189da072b85541db41
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 23:53:06 2012 +0000

    Support for TDS_GUIDTYPE in parseRow

commit 9c52f905279db165969d8204705b2bd472f322a1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 23:40:40 2012 +0000

    Oops.. w/o printing the error

commit c2594c95f2c03736bec07a1635a011fb9c35abe7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 23:39:51 2012 +0000

    Don't exit if something goes wrong

commit cba4a5862e5d1703071e7742f267f7d2713c4fc6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 20:53:05 2012 +0000

    Windows auth by default is False

commit 931a714a65d6b3973e6f5bb7cc303eccab936d00
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 20:51:48 2012 +0000

    A simple MSSQL client

commit 6a741a350aeeb321e258ffbcb500521ca1c19a7c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 20:50:25 2012 +0000

    Initial implementations of the TDS protocol so we can talk with a target MSSQL Server.
    It supports MSSQL and Windows Auth.
    See the mssqlclient.py under the examples

commit 1dca21e47ca242c584cc099a17a948912a2da023
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 18 13:13:22 2012 +0000

    Updated setup.py

commit 7bbd07faa998cf279a6e6af21ec48a0ef29be425
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 18 13:11:10 2012 +0000

    Clarifications on the need of using the srvsvcserver

commit 0b71d0e80de3e72f2b4ed537060ab717d0d409f6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 15 19:25:01 2012 +0000

    Support for large files in READ_ANDX and WRITE_ANDX

commit 08ea2274a7043b62d778a8e32867dd3a1a8b9492
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 15 06:26:46 2012 +0000

    Added -file command line option allowing to specify a file with commands to execute. E.g.
    cat > cmds.txt
    open 192.168.53.146
    login user1 pwd1
    shares
    use admin$
    cd Web
    cd Wallpaper
    ls
    put myfile
    
    python smbclient.py -file cmds.txt

commit 0e862171aa7c401e5deea0016bb3f53e40c853a7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 15 03:00:54 2012 +0000

    Exposing a getShare() method used by psexec

commit 9f0021ff277f08daf6000943060e92e2dc13abff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 15 02:59:58 2012 +0000

    Ability to download/upload files from the shell session. Could be kind of confusing at first but I'm sure it's gonna be useful to somebody :P

commit 66db493223f9d27b431dd0f1975569748d0b6874
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 14 23:53:54 2012 +0000

    Now smbrelayx uses serviceinstall helper library... Much simpler

commit 5d74ec93796baf422c47f36993804cb3635ec2dc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 14 23:07:54 2012 +0000

    IPv6 ping example

commit c9b8411586d2cf3e89c5188cbb2c694c7aabe7a7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 14 15:54:14 2012 +0000

    Under some circumstances, opening multiple simultaneous connections to the target host might make the server to reset some of them. Looks like opening them sequentialy solves this problem. I added a lock on each thread so once they release the lock lets the next one opening the next connection. This seems to solve this rare issue

commit da57bdc4d5b33997a54e4f9560513573a2f3cfb9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 13 19:40:41 2012 +0000

    Added a RemoteShell class that allows implementing some commands on top of the shell being running (currently only lcd and '!').
    
    Better control of some error situations.

commit 0863f23a244526343ed26134537eb0d2899f1d19
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 12 16:33:04 2012 +0000

    Don't fail if we don't specify a credentials file (we're not using it right now)

commit 26515dd76df20cc1fb657d0d76650f5bfa0033ea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 12 16:22:04 2012 +0000

    In the situation where something fails inside a try:.. finally will get the wrong tid, setting to the correct one

commit 97817fc1d10e9a20a1a09a58459cc09d756fc1b1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 23:54:59 2012 +0000

    1) Parameters are parsed with argparse
    2) Added domain and hashes support

commit c987cf7d1439aa8b40244368defd2b64309500e5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 19:39:46 2012 +0000

    Removed debug msg

commit 8bf973f914effc1e54aebc613fa663398c3a2a21
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 19:39:14 2012 +0000

    1) Parameters are parsed with argparse
    2) Added domain and hashes support

commit 02f502b266739ea475f76780863bd3cb9c0fc70b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 19:12:55 2012 +0000

    1) Parameters are parsed with argparse
    2) Added domain and hashes support

commit 5405bb444113dc330f5c418f399d3dd34fd7f74e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 17:51:30 2012 +0000

    1) Catches exception when connecting and exiting gracefully
    2) Threads honor the destination port given by the user (either 445 or 139)

commit 0e181e400b9b5166eba966f8ab376b7ec209a358
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:55:44 2012 +0000

    Showing help by default

commit 7c1e7b40efeacc760652d2078af0b8f2e1f8baa5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:48:20 2012 +0000

    Showing help by default. Default transport is 445/SMB

commit 4120e1178808a316b838cda27ff66e50363f721c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:45:20 2012 +0000

    Showing help by default. Default transport is 445/SMB

commit 557943ab22f83f9b473cce92373fba41bfbc571f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:42:50 2012 +0000

    Showing help by default. Default transport is 135/TCP

commit 3bc1bfe317a76317b02c277d3dc91ebd0a0001b1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:37:01 2012 +0000

    psexec like example using RemComSvc (https://github.com/kavika13/RemCom)

commit 0ab8226c9b412926420f7f3858e015c3ebc3bc6a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:34:47 2012 +0000

    These are helpers to be used by the examples provided.
    
    remcomsvc: delivers the binary of the remcomsvc to be used for remote execution
    serviceinstall: helper to install/uninstall services

commit cc630748b93c49ad0f3c3b43c3e9d8850d903f8c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 10 14:16:54 2012 +0000

    Added domain and hashes support

commit 821cef87b7f4faae3480143606fe31cee2ce4f1a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 10 14:09:48 2012 +0000

    Added domain and hashes support

commit f45d28d4cdae235f9aa7e4aef6a56e24740e5c05
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 10 13:58:10 2012 +0000

    Added domain and hashes support

commit 2c8a5bf41302e6289d0ea3c2fb803da8eadf847c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 8 22:19:26 2012 +0000

    Remaining was wrongly calculated.. the original buffer's size must be there (I had to substract the 2 additional bytes when sending in pipe_mode)

commit c8a651797e44c6f359c03c1af97d2d11a5f605ef
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 8 21:38:17 2012 +0000

    1) MaxBufferSize now set to the recommended by MS-CIFS (61440)
    2) Implemented WaitNamedPipe call
    3) write_andx now supports a write_pipe_mode that requires sticking to MaxBufferSizes besides the capabilities set by the server

commit c6c6a0cd3cee8f64ac5f664d8fbaf2a3deba1bdc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 8 04:44:34 2012 +0000

    Fixing padding calculation for NT Transact

commit 734b5cdfd032f25a6f2b6f68c93306efa2cc7d8a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 6 20:36:54 2012 +0000

    1) Putting deprecation warnings on __raw_retr_file and __raw_stor_file methods
    2) Raw methods eliminated from stor_file() and retr_file()

commit 53847d097ca8047e4edc20cf415bb5b8b917c23e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 4 19:49:59 2012 +0000

    Added SMB_FIND_FILE_NAMES_INFO info level to findfirst2

commit 9a2fa5c2424c1df9e9d16d50808a220ee877e1c8
Author: jigermano@gmail.com <jigermano@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 3 20:46:35 2012 +0000

    Added partial support for TCP SACK (support for 1 block only)

commit 5f5bd8b07f486a87aacb014a36e01ab5edae5c92
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 29 19:16:11 2012 +0000

    Service Type can be many types

commit f3b3017e7c6c257c5e98693f39dd0c0738a98644
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 26 16:55:13 2012 +0000

    1) Added use_timeout() context_manager method.
    2) Added deprecation warning for tree_connect(), clients should use tree_connect_andx()

commit 59b931d373e1325ee75e3bdc5fe91bd9f582e12c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 26 12:59:30 2012 +0000

    Better error support and status reporting

commit 99fa62bc2dd7fd2c90a08b7b73eff34472d9f81e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 26 00:42:49 2012 +0000

    No need to have a '-m' switch.. can be infered whether or not a host is specified.

commit c03b0707aa22f7dc690b292daf16dfaaeb36da86
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 26 00:31:18 2012 +0000

    Better error support and status reporting

commit a9a0586fe2a765eb0642eac81cea8bd328036dca
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 24 21:27:07 2012 +0000

    1) Added create service option
    2) Arguments' parsing now handled by argparse

commit 5aeb21bf41771586f3434dc57bc3c3793ee5cd31
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 24 19:39:05 2012 +0000

    Using argparse for program's argument parsing

commit 29c06e14650c5b3b69388691196a3191abb7dc50
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 24 06:21:25 2012 +0000

    1) Added reflection mode, to relay credentials to the caller host (fixed in MS08-068)
    2) Program arguments now handled by argparse

commit b236b79627b09b189e55f31ca47a83e4bc204a4b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 24 06:17:30 2012 +0000

    Added version file used by the examples

commit 1bcc9010136d3d71f46827baff19e9566b9fe285
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 23 22:17:33 2012 +0000

    Parses a pcap file or sniffes traffic from the net and checks the SMB structs for errors.  Log the error packets in outFile. Still lots to do

commit 55feb029a413ea5de9b68ce50611f18e77838a9e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 23 22:09:30 2012 +0000

    Prints whether or not a USER or GUEST session (SFS) was granted

commit 4b5a523d6f8690f018ce30bea8e72e10d30889f8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 23 22:07:40 2012 +0000

    Added LsarLookupSids3() call

commit b65d75c3950776f9949276e40aa60044b498effb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 23 22:06:10 2012 +0000

    Added rpc_fault_cant_perform DCERPC error

commit 91cdd87c4a7d290d35a85c970bf50f484d0c7f08
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 22 23:33:36 2012 +0000

    I just saw an answer from a server that doesn't have the reserved field in zero (contrary to the protocol specification). Since it's not used, we're just letting the structure to hold whatever value is received.

commit 7ddb494c04ce2867c333d48829c9751358775f4c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 21 18:50:46 2012 +0000

    At logoff, receive the servers's answer and clear the uid field, in case client wants to login again using the same connection

commit 255f7a802a05182b044b95a7c34fb873df518439
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 21 15:39:40 2012 +0000

    If we change to a different share, clear the pwd local variable

commit abf579ccd0a288ca780a23c0434e84814cf8c114
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 15 20:00:07 2012 +0000

    Added get_timeout() method to the SMB class

commit 5b6667f4a198e3114cbf14fe9cac4c9b74db6e61
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 9 05:45:33 2012 +0000

    Fix typo on all SMBSessionSetupAndX* definition. Unicode ('u') must be used instead of NDR ('w').

commit 61c7a29157fd2d2ab3683f63112e32285f1de8a5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 2 01:22:08 2012 +0000

    Just making the example to work

commit d13b6c58b49fa0e55129baa37f04eecadb222f18
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 2 00:33:57 2012 +0000

    Removed parsing data inside the payload of a SMBNTLMDialect_Data(). I added this in revision 294, but triggers an exception on some weird Windows configurations. ServerName is grabbed later on at the login stage, in a much safer way.

commit 509aa4bd585289ce69887c6b455c4304e3fea7e2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri May 25 05:17:13 2012 +0000

    1) Missing '<' in LSARPCLookupSids'd LookupLevel Field
    2) Added LSARPCLookupSids3 structure

commit 357c11ec7f02310f42832275587c7e763b1cbe2b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 13:56:36 2012 +0000

    Example now grabs the Scheduled tasks through SchRpcEnumTasks(), much better since it will grab them all (contrary to the old NetrJobEnum() ). Example yet not fully functional, just committing for backup

commit 7bae66d5edf82ca2860bf01d7fc3197066a9cd8d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 13:51:39 2012 +0000

    1) Fixed bug in MSRPCBindAck when SecondaryAddrLen is 0, SecondaryAddr should be optional
    2) When doing alter_ctx, keep track of the previous callid

commit 1ac3783599ac71e3581909630c14312c9ae42e91
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 04:01:28 2012 +0000

    if SMBTransport.disconnect() is called, and no previous smbserver was provided to the transport, clear self.__smb_server, in case a new SMBTransport.connect() is wanted

commit 82a21e94a7409fc136d61181b3821f8c05ab5887
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 03:28:17 2012 +0000

    Added Method SchRpcEnumTasks()

commit e778256d6514680657aedd4d6b48bb90b754e327
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 01:12:17 2012 +0000

    Example for the ATSVC dcerpc methods. So far it:
    1) Creates an schedule task
    2) Enums the tasks created for the user

commit ee81a9c3a21fb65525c7632df507437ee710060a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 01:10:13 2012 +0000

    First implementation of the ATSVC ([MS-TSCH]) methods:
    1) NetrJobAdd()
    2) NetrJobEnum()

commit 7a78b6a41bfcb235c723ee1dbc42ea1889e2d012
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 20 23:16:59 2012 +0000

    Small example for SPOOLSS, now it's only enumerating printers (Level1)

commit 7d526a6140f299897359bb5583f121477d6021a8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 20 23:12:24 2012 +0000

    1) Adding SPOOLSS UUID
    2) EnumPrinters now returns data

commit 73a44c7e5c5c25a82fd569790667042398d600ff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 13 17:39:57 2012 +0000

    We're not updating the Changelog anymore.. google code can do that :)

commit 6c3c1cbf475b3ad5ca64fa69243b304d869f0172
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 13 17:32:45 2012 +0000

    update

commit 060964bc775b7279d3d8b1b582329de84075c06e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 13 17:05:16 2012 +0000

    1) Added support for shell commands thru '!'
    2) Share's list first done through SRVSVC, if it fails, falls back to LANMAN

commit 3422aaa3e82c71c31d28e11ec1293d5a80026a39
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 13 01:53:42 2012 +0000

    Small fix on negTokenResp when parsing negResults with no extra data

commit 97f0b6d1b777a2d6c8322afdb7f70e032096b2b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 13 01:51:25 2012 +0000

    SPNEGO test case. We should add more tests in here

commit 2a9ab2071c5f7551f175e8fb35b2f917f2694182
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat May 12 18:58:59 2012 +0000

    Adapting smbrelayx to svcctl exception handling previously committed

commit c578f9fc2dd64122dce69b66b831528112078a29
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat May 12 18:31:15 2012 +0000

    Added the ability to use external srvsvc dcerpc server. Disabled by default. Uncomment lines in simple_server.py to test it.

commit 7165090b7860d4e0201e4a2364d1eb7d8799e8a0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat May 12 18:29:18 2012 +0000

    A minimalist DCE RPC Server, just for the purpose (for now)
    of making smbserver to work better with Windows 7, when being asked
    for shares

commit bdb995f37fb25866479a3b09c2241d37f4fdc21f
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu May 10 02:00:56 2012 +0000

    In the context of issue 7 reported by oss@divinehawk.com, we fixed TCP parser to avoid get stuck while parsing TCP options.
    Also we added a testcase to support this case.

commit cd7c71fa7bab0c374e2248ffce77b3fb6cf59c33
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 9 23:17:25 2012 +0000

    If CAP_LARGE_WRITE or CAP_LARGE_READ are enabled and the communication is not signed, we increase the buffers for read and write to speed up performance.

commit 26e70b4cd86b64e7eea35a3f313148b2ba556980
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 18:53:28 2012 +0000

    Ability to resume an enumusers call if many entries are returned

commit 19482fe37e4a7d931846c284b612829557750b1b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 18:37:57 2012 +0000

    Changing permissions when opening target LsaR

commit 134a29978dde25e959599f054c1c0becc0ded477
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 18:26:07 2012 +0000

    Where there are many users in the target machine, there should be a way to continue the search. Added that possibility to the enumusers() method.

commit 19ddf71ec1f88fafc02eacf7b14f9f113f603cb3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 13:21:28 2012 +0000

    RefId random value CANNOT include 0

commit c06870d0a8739e08338c63be0642cf3dc829bccd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 13:21:02 2012 +0000

    1) Fixed padding issue in DOMAIN_INFORMATION
    2) doRequest now checks whenever the DCE call triggered an error by default (some functions explicitly set is to False)
    3) RefId random value CANNOT include 0

commit b49cf12f72f8ae1efe9eb62ae2fd8ac142362313
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 04:06:37 2012 +0000

    Now it does bruteforce. MaxRid parameter sent thru command line.

commit 877c89e7a436c84d98cf1315e85091bd718d0bfb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 04:03:09 2012 +0000

    1) alignment in LsaLookupSid struct not needed
    2) Better handling for LSARPCLookupSidsResponse.formatDict() when some of the answers are NULL pointers (e.g. some SIDs NOT_MAPPED).
    
    That whole LSARPCLookupSidsResponse.formatDict() should be rewritten.. I don't like the way it was implemented.

commit 4549684a78288bbb9cbd968ae3de7b801f5a1180
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 00:36:42 2012 +0000

    First implementation of lookupsid brute forcing.. still not bruteforcing a thing ;)..

commit 8d926970b6e7ead17dce9abebb7387895c16ef38
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 00:35:02 2012 +0000

    1) Added LSARPCSessionError Exception, still left to print the NT Status code
    2) Added LsarQueryInformationPolicy2 call

commit 646a668790e44aada75a810f1db22d28f7efdee3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 1 23:20:26 2012 +0000

    UUIDs for each endpoint now in readable form

commit b12247b9147c2ae92e1fb8c248ea52fb4afff5f7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 1 23:11:16 2012 +0000

    Avoid opening a dummy servicename when asking for LIST action

commit a481520586f586184a08b898be6d5d2f2b299415
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 29 21:39:46 2012 +0000

    Setting svn:keywords "Id" on all files

commit dfbfabf0c55227790eaf04e9f2b6fb8d3b51e10e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 29 21:30:27 2012 +0000

    Copyright update

commit 4538240fcce1e32e878147f30296efabd5e3d7a0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 29 21:04:38 2012 +0000

    Copyright updates

commit 086817b3fc0aa8ac1180a4b17acbf0168eeab403
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 29 20:41:05 2012 +0000

    1) Added capability to get the SID Type when parsing lookupSid response (thanks lanjelot!)
    2) Fixed a padding issue when parsing the odd domainnames

commit abe7b092e7182a62a2be0e69bc0c92c5893705bf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 17 13:07:49 2012 +0000

    doRequest now throws an SVCCTLSessionError Exception when the RPC call fails, dumping the right error.
    This means all the exposed function will throw an Exception when an error is found.

commit 78c8f005522e9ba8d2a979f997292e6dbdcecae0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 12 21:51:26 2012 +0000

    Removed debug message

commit 1552df235136b657d10c939b1830b5f35e5076a7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 12 20:55:38 2012 +0000

    Fixed wrong detection of an existing smb_server, resulting in disconnecting it when disconnect() was called

commit 1fdd49d8566542cc5b199bf25992a6df1f56082f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 9 19:46:31 2012 +0000

    Adding the ability to set up transport's connection timeouts programmatically

commit 8d0deabb2600b9d4eaa1b62ae1616377c09abd4f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 9 19:15:10 2012 +0000

    Fixed previous smb.py commit bug in set_flags()

commit 5f75480b08545c2fe81b57e6949a4d4cb44f7c7e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 9 19:03:32 2012 +0000

    Fixes bug introduced in previous version triggered when targeting port 139

commit 8ac46fec6b5c302430bcee8ac1f1a7a69915d57d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 9 16:41:09 2012 +0000

    Added set_flags() and and get_flags() methods for the SMB class

commit 9d27274a2ad0f8395bb04c055b23119339e558b8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 8 21:48:29 2012 +0000

    Merge from Impact Engineering team changes to Impacket

commit 9f31cc6e39782887f0207337f1b67a67f2b9ae10
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 8 15:08:20 2012 +0000

    select_poll can be configured from SMBSERVERHandler()

commit a40db80c8cf1aa89d1578b02b151cc2b2ba19523
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 8 11:56:29 2012 +0000

    Simpler way to switch between select_poll mode and normal mode, in the __read function. Applying patch from Martin.

commit 0f8c83b083f4ce7a3641f543fd75144ed0842245
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 8 11:44:42 2012 +0000

    Fixed bug when handling old MSRPCHeader packets.. Now it should work with both versions

commit 1034ff6dea7744f2f8862bb66efa286647b589b3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 5 18:51:07 2012 +0000

    Fixed '=' for '=='.. dumb me :p

commit 5ab9271061e922f03ee27211ee62c17ce14facdb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 5 16:20:54 2012 +0000

    Added select_poll option, another way to make select of a socket

commit ee77f56d253bc9f2ab75858a368aec60b0195398
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 3 03:19:35 2012 +0000

    Added SMB_FIND_FILE_ID_BOTH_DIRECTORY_INFO and SMB_FIND_FILE_ID_FULL_DIRECTORY_INFO information level support for findfirst2

commit 5ed088613abbe491818bc8b468b7f522afd3733b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 3 01:51:57 2012 +0000

    Removed debug message and converted received share to uppercase

commit 1fed9fa238e5d148c815b363ec3bd9496deccc54
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 3 01:30:43 2012 +0000

    Added LanMan NetShareGetInfo call

commit 831c73f10758dad019cf0d518086cf1e936832d0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 22:10:54 2012 +0000

    Added support for extended reponses when client does a treeconnectandx

commit e78e84e44c39526a1a4791fc7bbb2cb637ad2209
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 22:09:43 2012 +0000

    Added SMBTreeConnectAndXExtendedResponse_Parameters structure

commit 5362f5f1ed0c42c529aec4d8d4773465fe23b383
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 20:47:21 2012 +0000

    Added SMBNtCreateAndXExtendedResponse_Parameters structure

commit 6734830b7ec96f024464c42431e991f92ed5a171
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 15:31:47 2012 +0000

    Added SRVSVCServerInfo101 and SRVSVCServerpInfo101 structures

commit 0ebf3d59f2f522ad9e7044ec79d3e69c4f239fa4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 14:04:17 2012 +0000

    Added support for LANMAN SMBNetServerGetInfo

commit 9046ab3d1548abb8cea24c8b8e2202d7d0630a2f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 14:03:26 2012 +0000

    Added SMBNetServerGetInfoResponse and SMBNetServerInfo1 structures

commit 9918b7b8fcbcbfaed493cf778fecf37b9bce11be
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 03:21:04 2012 +0000

    Minor changes on SRVSVCShareEnumStruct and SRVSVCNetrShareEnum1_answer setting some default values

commit f729ccdb964777e9ddf783e2b68356cbeb2fa4c3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 02:53:15 2012 +0000

    Small change to SRVSVCNetrShareEnum structure so it gets easier to parse an
    incoming request

commit 5fe0da82664d4b691c0bb23d8b1a00d0a7392b34
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 1 22:01:53 2012 +0000

    Small change to SRVSVCNetrShareEnum structure so it gets easier to parse an incoming request

commit 0d23860f1c95abdf58014d587407c955a590261e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 1 15:02:47 2012 +0000

    registerNamedPipe() receives an address instead of a socket. Socket is created/connected once a NTCreateAndX request is received.

commit 2643fab7d0c54ffe4d63b6d0f865f0a00130a11e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 1 14:15:27 2012 +0000

    Added transactNamedPipe() to smbserver

commit 979bc8c47b009ae9bc51ad4da461755c98608dc4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 1 14:11:35 2012 +0000

    Setting some default values for structures

commit 66868d46aec642b7744873a76f57b6bc8f1c4f4e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 29 17:49:25 2012 +0000

    1) Updated NT Error Messages strings.
    2) Changed SessionError Exception message format
    3) Changed SmbPacket (old version) structure to it also grabs the reserved field that is part of the NT Error Code

commit 1e5ee07ea0e380cb1bda83c0c13251551c0bbfdb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 28 23:18:03 2012 +0000

    Implemented registerNamedPipe() allowing to register NamedPipes (e.g. srvsvc) to a socket. Currently implemented in smbComRead/Andx, smbComWrite/Andx and NTCreateAndX (still pending transactions). Every read/write request will be sent to the registered socket, allowing to have a third party RPC Server answering those requests.

commit 88874e6765f8daba569247f83020e4309721bf74
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 28 13:03:35 2012 +0000

    Fixed bug where lm/nt hashes were cleared before sending the for authentication, actually breaking it. Thanks Bernardo for reporting this!

commit 19e479923c82f2f1e7a71180ccbc79f6af816a94
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 27 22:07:41 2012 +0000

    Fixes Issue: http://code.google.com/p/impacket/issues/detail?id=9
    
    Thanks to thebigguy.co.uk

commit b69f4d483e58d633142f33a2271c6576b6980417
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 27 20:59:10 2012 +0000

    Support for argument passing for StartServiceW(). Testing still needed

commit 7082864e8b863a16c005106915803d1cda36621f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 20:48:46 2012 +0000

    Added downgrade exception if Samba is also detected. If not some of those OSes, then raise the exception

commit 72e3e163603147323c7ab0e34a5ca5fddc8f835c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 20:39:08 2012 +0000

    Added doesSupportNTLMv2(). Now just downgrading to NTLMv1 whenever we find a target Windows 2000 (I gotta test Samba)

commit ef28649f3567ae74939da603a3987771ff3924b8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 20:38:00 2012 +0000

    When authenticating, now asks the higher transport about whether or not to use NTLMv2 (through self._transport.doesSupportNTLMv2()). This is the best effort we can do against old Windows systems (and probably Samba)

commit c69fe6587ac7de25ac63ee2dc08750ba47e6e91d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 20:35:32 2012 +0000

    Adding doesSupportNTLMv2() method so underlying RPC instances can ask for it when authenticating. Right now it would work only for SMB Transports since there is the only place we can figure out this setting.

commit 7a2c8c494691a6f3f089ff7780001a0c0f4f1d4b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 20:34:26 2012 +0000

    Using NTLMv2/V1 can now be set programmatically

commit 4a5b87d308d5e7c19e434cf94ccefbc2d7a4970b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 18:21:21 2012 +0000

    Using NTLMv2/V1 can now be set programmatically

commit 968b81c5c0b323a699ddd59f4228c4d5b4e201c5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 18:10:02 2012 +0000

    A few NT error codes added

commit e7d01b5b59b9dc8508afb21d97eebfbaaaa78253
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 18:09:43 2012 +0000

    Using NTLMv2/V1 can now be set programmatically

commit 4b7633fbb9b7242a883f37beeb29175c6b6c60f3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 23 21:24:33 2012 +0000

    If the server received a NetBios Session Request, it will answer with a NETBIOS_SESSION_POSITIVE_RESPONSE, meaning now this could be use in port 139 as well.

commit c7f4fdbfca6ea22398e6fffa743177de128afe95
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 23 15:13:44 2012 +0000

    Initial lsarpc implementation by Pablo

commit bf0225f6ef9d472481b7a39558b9aaac7c467a4f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 17 16:50:00 2012 +0000

    More custom settings if run on a win32 platform

commit 73ad20bb4ff2026866ee4237a9a79d89a2c21188
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 17 15:59:41 2012 +0000

    FIND_NEXT was missing a trailing NULL byte in the filename

commit 8abbe4b2ddd61263f758b67fbb67bd9879efbb72
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 16 20:37:47 2012 +0000

    Tweaked some methods to handle being used from a win32 platform

commit 87a412f8693da7662ed54a90ed2ff198d9480d17
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 16 19:43:40 2012 +0000

    Ability to specify and already crafted configParser

commit e7a2b6afe0cd794ce8fa38103fe053b38b9005b4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 16 15:02:22 2012 +0000

    If destination port SMB_SESSION_PORT and remote name *SMBSERVER, we're changing it to its IP address

commit 9df080feb015120c6b113bb18a28740ce81863c7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 15 21:48:05 2012 +0000

    If destination port != 139, don't use *SMBSERVER 'cause it will ask for the target netbios name, and that takes time when it's not really needed.

commit 65ea16a332a38574d4abfa82fc63e35765aad5ac
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 15 21:37:33 2012 +0000

    1) Added pipe disconnected NT error
    2) Fixed bug in TransactNamedPipe() when parsing the answer

commit 5e020bb6da9ce2891d29e41167420552bd4e6005
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 14 22:31:40 2012 +0000

    Fixed an error in StartServiceW() introduced in r455. Falling back to the original structure. Still doesn't parse commands, that's pending.

commit 60b871c3f573a92835f22a15e5d1cd56e9417333
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 13 22:04:26 2012 +0000

    GetMembersInAlias() now working.. needs some testing.. Interesting data in the answer['EnumerationBuffer'].

commit a91cc8b42a46aa749348fe5978963c9a17963311
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 13 20:10:03 2012 +0000

    fromCanonical method added to SAMR_RPC_SID() to simplify SIDs manipulation.
    
    e.g:
    
    sid = samr.SAMR_RPC_SID()
    sid.fromCanonical('S-1-5-4')
    str(sid)

commit 96521603a1ec1b616f76718f1641cb56437e5e82
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 13 19:22:55 2012 +0000

    Added:
    1) OpenAlias
    2) GetMembersInAlias
    3) SID Parsing and canonical printing
    
    Still need to be tested

commit dd7bb98ca08c8f1c4e776c8008d50fa50dbdd3e7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 13 13:55:02 2012 +0000

    Quick and dirty fix so it now supports bash like history (using cmd.Cmd)

commit 2965bb784992e62640b4304a6a113d5e8fb4ec6d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 22:34:23 2012 +0000

    Support for multiple answers for NetrWkstaTransportEnum()

commit 404d6b3d4b34c6992a0e108ace824a62ef65c079
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 22:33:32 2012 +0000

    Support for more than 1 item in the answer array (sometimes it happens, especially with w2k machines)

commit 33fbce54e6733ec28e055b6d25d95765696e8df2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 21:56:15 2012 +0000

    Forcing smbclient to use tree_connect_andx

commit 69d95c5a927354e50f6c04c3c61144162205d8c3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 21:34:54 2012 +0000

    Small script to test wkssvc.py

commit e7f4988c49c327b917207766aef9f065571410c0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 21:22:19 2012 +0000

    First implementation of Workstation Service. Implemented NetrWkstaTransportEnum() for retrieving target systems MAC address and Interface Information

commit e023c89b103c60f181e241c147df2929bed1bbcd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 17:31:30 2012 +0000

    Added EnumerateAliasesInDomain(). For now it returns a list of dcerpc.MSRPCArray
    
    We should port those NDR funtions to structure in the future

commit 836c36aa5a7aa3b5e68cea630411ab18bcd931e8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 16:06:14 2012 +0000

    adding a self.rawData variable that hold the original buffer sent to Structure, so it can be used inside the structs to calculate lengths.

commit 48f5eb3cbc5031fe9947cbbed4f152119d8c1f64
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 26 15:19:46 2012 +0000

    Not retrieving the Strings if the call returned an error. It's caller's reponsibility to check that result as well whenever printing the data returned.

commit 44e06db64aa1881c2228a5a8be69d950c3a8ac20
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 26 13:22:26 2012 +0000

    Sometime the difference between bytesNeeded and the actual packet is less than 6, it's safer to go just for len(ans)

commit b594ba55562acb7fed3ad49ac4a147fef5ceb62a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 24 18:38:42 2012 +0000

    CONFIG option finished

commit a18479949db001252395a4232f7da0991c462a96
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 24 18:38:14 2012 +0000

    Added QueryServiceConfigW(), should work now.. testing needed.

commit e4638262d85e3e2f0e5a23811e08a68f4010c876
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 23 00:47:43 2012 +0000

    Added CONFIG option. Not yet functional, just used for triggering and debugging QueryServiceConfigW()

commit a1b9eccec6d5dbd21a7e6e8d65b35f3efd040044
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 23 00:30:26 2012 +0000

    More on QueryServiceConfigW().. still a lot of work to do.

commit 066d2fea0b9e9564e4f4da84547b81c6a9430b12
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 22 23:18:51 2012 +0000

    Initial version of QueryServiceConfigW.. It parses well the response data, except the QUERY_SERVICE_CONFIGW structure. Not yet ready for use

commit 09f522823ffa381764334b7ee3ccfd0a1d1e267a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 21 22:29:08 2012 +0000

    1) Added SVCCTLRQueryServiceStatus and QueryServiceStatus from Bernardo patches
    2) Fixed wrong StartServiceW opnum number from Bernardo patches
    3) Some work pending on StartServiceW handling arguments

commit fd639af8ce97f7ae56a4098db0c67c857a5116b2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 21 22:21:43 2012 +0000

    Added STATUS option

commit fe6d3957a0a159b099a29dfea151f5f3a3cfb418
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 21 22:11:40 2012 +0000

    Ok... more on EnumServices:
    1) StringsOffset does not belong to SVCCTLServiceStatus
    2) BytesNeeded was in the wrong position within SVCCTLREnumServicesStatusWResponse
    3) The returned buffer contains TWO pointers to the strings DisplayName and ServiceName

commit 8ade7964491f46abb6f27ec5483bb7e3db73300b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 20 20:07:33 2012 +0000

    Fixed bug in EnumServicesStatusW().. Figure out previous DontKnow field is actually the offset within the packet where the service's string is hold.

commit d36ea1de33324039c1e01d3a7f054776131f2ee5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 20 18:37:20 2012 +0000

    Merging Bernardo fix for services.py

commit 54668a8ba512a8c7baada71cf51c0b0409eed50d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 20 18:33:25 2012 +0000

    Merging fixes by Bernardo... StopService() now returns SVCCTLServiceStatus.

commit 610d0d200e1fd092e19c72d01cc7c5c17a341cf7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 19 22:28:06 2012 +0000

    1. DCE Fragmentation reassembly added to recv()
    2. Added checks to ask the upper layer for more bytes in case we haven't received a full RPC Packet (especially important for TCP/UDP transports)

commit ad4cb4896a7bfb72695336c268ef340ce6bcfe9b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 19 22:26:32 2012 +0000

    Added the ability to LIST services... just specify a random servicename...

commit 68e30891ebc28a92375b183ac5d11d3e94142121
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 19 21:34:23 2012 +0000

    Adding an option to recv to request 'count' amount of bytes. Especially important for TCP transports where we cannot know how many bytes we're receiving

commit 819096c7b0fe9cb7fd393d09509932dd9c42f8bd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 19 16:58:59 2012 +0000

    Second round for EnumServicesStatus().. it's now functional, but requires DCERPC reassembly

commit 811ff57d633b01b13c6d014f22d6eb3421c51da7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 18 20:34:26 2012 +0000

    Adding an option to transport.recv() to keep asking for packets.. needed if we need to reassembly fragmented RPC

commit 6a47304a3eb59ef2af247d11766d211f9f9bbe15
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 17 22:20:50 2012 +0000

    First round of EnumServicesStatus().. not yet functional.. gotta figure the packet out..

commit 9650b60e8ada4b4141092b22d79b8207f9120418
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 17 19:55:01 2012 +0000

    Fixed padding issue on WINREGOpenKey

commit 6df23f5f54abc2ae3b3494f2c9e6c32b381009ac
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 3 15:07:44 2012 +0000

    For backward compatibility, when no server_name or domain we will return '' instead of None

commit 9ea71ed53154e47466536b7747a479d927429963
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 22:56:16 2011 +0000

    If *SMBSERVER is sent as remote_name, we will try to get the remote NETBIOS name(via a getnodestatus) to help succeed the connection. If unsuccesful, we go with*SMBSERVER and hope for the best

commit 8e93819290d9d1d1d4b371dd30d0d84f948dbf5a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 22:55:02 2011 +0000

    timeout variable wrongly passed to the underlying NetBIOS layer

commit fd0285a615693077a2ae105bd8cf102cf1b9eb90
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 22:51:37 2011 +0000

    Fixed wrong padding calculation on a BindACK packet after the secondary address answer

commit 84656f1fad43c2e7107367f14cb6c33c3a2aef55
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 22:50:14 2011 +0000

    Removed since it has been replaced the old dcerpc.py

commit a46b751075de7737e99a39c9d9fe5b4c5ff6c580
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 20:04:24 2011 +0000

    Removing bogus test credentials :-|

commit 941269eeb02531ae6270846441bffd74d0f90426
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 20:03:24 2011 +0000

    Adjusted to work with latest dcerpc.py

commit 3840a4393ac93fa61ab2336913c1ce18f5b22f94
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 19:30:37 2011 +0000

    A basic implementation of the SMB Relay attack first published by cDc

commit fae2eaa80c2ff2c4cf66eaf7a06bd7bc595b10b4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 19:18:10 2011 +0000

    SMB Server example

commit a82203d1a25905ce736b0d80f5bc737454b0a493
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 18:29:13 2011 +0000

    A basic SMB Server implementation in Python

commit 22fbf53c239f3efc4ab74aa4ead09452ac2ae99b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 18:12:07 2011 +0000

    Using the new DCERPC.py library from now on.. supporting all flavors of NTLM (including fragmentation and encryption).
    This update BREAKS backward compatibility with the old dcerpc.py

commit 612a245c4bbb615bbad65663001b63fc332d5b23
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 18:09:55 2011 +0000

    Reverting previous commit and going back to revision r428.

commit 5a095bd87576872804a2288ab2e3f5912069f76a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 18:06:02 2011 +0000

    Reverting previous commit and going back to revision r428.

commit e4dc6ca3e090b681b6abc02579ea007ed700c680
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 17:56:50 2011 +0000

    an SMB Server implementation in python

commit 1982fc10440104ca78c15b92ca372a792a7a45d8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 23 21:31:41 2011 +0000

    Fixed alter_ctx handling. It wasn't honoring the right ctx when issuing the next bind call.

commit 1f9b1c0239ffd0fb1df18a070e4a44b515081066
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 22 21:15:17 2011 +0000

    Building an old MSRPCHeader() for backward compatibility

commit 27286086447143d0d24b2ec76ae79b4748d3b46e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 22 21:08:01 2011 +0000

    Leaving MSRPC_NOTAFRAG flag for backward compatibility

commit 7adefefcbceb6c53aa490d7f91743c37c8ec58e7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 22 12:18:06 2011 +0000

    RawCall class now belongs to this file

commit 5c8327672666d1e9136280fc9316fdc4f792f127
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 19 20:25:36 2011 +0000

    Improved get_server_name() and get_server_domain(). It now gets the info regardless of successful logon

commit 9e353a0eaf3b9577b3da08d38752bb6d71f97e86
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 15 22:16:30 2011 +0000

    Due to different dialects interpretation of MaxRawSize, we're limiting it to 0xffff

commit b073736474fb6fd7c0c1cb241e65a9b31f2ab99f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 15 19:23:19 2011 +0000

    Don't break login method if hashes are sent in binary form.

commit ced703fcac8daa349597d1054c127b4790bbe1e2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 14 20:00:36 2011 +0000

    fix in uuid import forcing it to use the impacket one.

commit 9e5c9ece19837a1fdee0af5571ba66dedcf00771
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 4 19:57:22 2011 +0000

    1) Fix a bug when bogus_binds was selected (lack of a tuple)
    2) Now the bogus_binds UUIDs are randomly generated

commit aa24cdc737717404f90eaac4ce67b7ef0e4f64ed
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 4 12:34:31 2011 +0000

    A better way to solve the Deprecation warning issue in structure.

commit a1c557fb97f81b4ab28d7c9a4e3fdfabfe2dda5e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 4 03:24:32 2011 +0000

    Fixes the 'DeprecationWarning: struct integer overflow masking is deprecated'
    error produced calling to id().
    More important now that python aborts when such error happens.

commit 2a47ee73bdc9af8ed4b3cb6bed9adfc01a50cc04
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 4 02:54:30 2011 +0000

    Fixed MSRPC packets __init__() when initializing structs with receiving data

commit d321dbb664b1fe576522b1ff387662327bb62c5e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 3 23:10:04 2011 +0000

    Added NetprNameCanonicalize() call

commit cce536b773f6a7136293f4a827507bc6003d2a83
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 3 22:46:30 2011 +0000

    Added NetrRemoteTOD() call

commit c39b6c4693fd5c56a4582de775a5406488f15b12
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 20 21:40:09 2011 +0000

    isValidAnswer should check if the error received is a NT one

commit 25f37aa73fc16921b8db4a36a681d6680eaaecd1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 20 21:34:15 2011 +0000

    Fixed list_path so it now:
    1) Reassemblies transactions
    2) If FIND_FIRST doesn't return all the data, call FIND_NEXT

commit 695e1404d51b68535fb9c2ba9d92f8509e94fa7a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 5 20:12:53 2011 +0000

    dcerpc/dcerpc missing in the import sections, making some methods to fail

commit bdaa265cf5ee47022518d71420177e78f0bdd455
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 30 18:22:40 2011 +0000

    If ServerName not available when logging in, set it as Unavailable

commit 9a87a5be79348727b19056a29746bd073d151921
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 30 18:09:52 2011 +0000

    Storing server's information before sending the AUTH package

commit 075edfacf82f04a06f70265df0b25df6140ae70a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 30 17:59:27 2011 +0000

    If we created the SMB connection, we close it, otherwise that's up for the caller

commit 7058c2d9aa546d1896123659cdfeb7c39b166071
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 28 23:18:52 2011 +0000

    Lowering connect timeouts to 10 seconds

commit 9f80410c2c3a35b51e1cabf6621d8cd4b04186d9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 28 23:16:22 2011 +0000

    Replace debug stuff in signSMB with original code

commit 64f84b7b07dd35353f1e89517959a5dad47e5a3f
Author: pditincho@gmail.com <pditincho@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 8 21:15:21 2011 +0000

    Addition of support for scoped addresses. Addition of test case for scoped addresses.

commit 2371d945ade3d210553d3d76e27ab5ba0f2aaae1
Author: pditincho@gmail.com <pditincho@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 8 21:02:29 2011 +0000

    Bugfix - Constructor of IP6_Address now accepts a unicode string as a text representation, apart from just a regular string.

commit c6d0dccedae2911cf9bdc99ca48be859dc289d01
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 12 18:29:38 2011 +0000

    1. Added flags and packet types according to the standard
    2. InterfaceId is gonne, now we handle the uuids using uuid lib
    3. Added more rejection error codes
    4. Fix typo on SupportedVersions MSRPCBindNack struct
    5. Fix not checking reject reasons for bogus binds

commit ddf962fc7e0a5531388411aa9c5efc2374bb7e94
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 27 21:41:33 2011 +0000

    Remove the self._uid if the login was unsuccessful so we can try another login in the same existing connection

commit 13d082eabcd5221bd8140f28c78d64a178408512
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 27 00:49:32 2011 +0000

    Typo :)

commit ff25c78aa9823f38cd02346c713f99a44814e249
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 27 00:46:37 2011 +0000

    1. Fixups imports
    2. SVCCTLRespDeleteServiceHeader should be based on ImpactPacket.Header

commit e9968ab3e92c3c2e97e0200b02d4bd4591f53441
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 25 22:15:32 2011 +0000

    New dcerpc structures.
    1. All packets are Structures (no more ImpactPacket)
    2. Support SIGN/SEAL for all NTLM flavors
    3. Fixed bugs on fragmentation, now should work fine
    4. Fixed bugs on bogus_binds (doesn't throw error for the bogus binds)
    
    If you want to use this, overwrite the current dcerpc.py with this one.
    
    After further testing i'm replacing current dcerpc.py with this version.

commit 9ecb66eb02b43938886d643a2b3578b21f06befd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 25 19:57:38 2011 +0000

    Fixed the testcase with the new parameters to SEAL and SIGN

commit cad13332e6383535f464f1d8011e2958209239f7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 25 19:22:09 2011 +0000

    The special case for anonymous login was taken outside KXKEY.

commit a347c8992f898f3c59ac4d4df2f16d603e1bd582
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 25 19:11:29 2011 +0000

    1. Changed SEAL parameters, we need two instances of the packet, since encrypt and sign for NTLMv2 uses different information
    2. Special case in KXKEY when no password is set

commit 23f42eba04fbcf9ff80085662983cd1651974ede
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 25 02:42:08 2011 +0000

    Flags are maintained all over the session

commit 97a89e6ee430d1cb7e3fa28de716aa7e42a21281
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 23 19:26:10 2011 +0000

    Changes on the tests. The tests are actually giving OK results

commit 9cb0f1c55f11e750dcd202121ce90d1da3034acc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 23 19:25:32 2011 +0000

    More changes to SEAL/SIGN.. still not used and still not working (it only works on NTLMv1)

commit 00ba16dfcc3d142d387d644b4bd53c146895145b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 22 16:23:23 2011 +0000

    Check and report Bind errors except for the bogus ones

commit 5d91ed204df1814fe4a9217af1b871ebd5893ab7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 21 20:36:08 2011 +0000

    Small example to start/stop/delete remote services via svcctl

commit e5a2a308fdecdd3128d5c7012842e8acf5ad6409
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 21 20:29:46 2011 +0000

    Fixed typo in ACCESS_DENIED

commit c8b90a528dd363536dbf0cae22901a0c9cf64f64
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 19:30:07 2011 +0000

    OpenServiceA function added

commit 11a1db04bb96c9967f6559977c99161e073e3551
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 19:18:06 2011 +0000

    Changed 'w' for NDRString*W to make it easier to use. *W() functions expect unicode data

commit 65399eb5c22f9d575cf809a738bd91e674582778
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 19:16:58 2011 +0000

    NDRStringW and NDRUniqueStringW structures added

commit f9c0dc81b620f0444ba84ad155291e4c075c595e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 15:13:15 2011 +0000

    Removed checking for error in doRequest.. that's up for the client

commit 4d522e77e873212e3c836835a106c64fccdce744
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 14:05:00 2011 +0000

    SERVICE_INTERACTIVE_PROCESS flag added to CreateServiceW

commit 2bbc6ee6bd7d514b6bbbd6ec7bfb3905b0cbcdb5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 14:00:14 2011 +0000

    Added SVCCTL CloseServiceHandle(), OpenSCManagerW(), CreateServiceW(), StartServiceW(), OpenServiceW(), StopService() and DeleteService().
    Similar functionality was already in place, but now all with Structure (plus fixes some bugs).

commit 0bed17270e8963cecf7f53e7a2ec9fb542783c36
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 17 23:12:05 2011 +0000

    SHARED_DISK_HIDDEN type added

commit 89d4f53e287bebdd18d014a64059866fedd4be3f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 17 22:25:48 2011 +0000

    default port changed to 445
    increase timeout to 10 seconds

commit 5c96547e6fda093623ebf5a4e9d9b97d2a6f7df3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 17 17:39:56 2011 +0000

    Added isGuestSession() method.

commit ab8fb8a56dfe365e6ce49ed67c3273cb2cf6fa73
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 15 23:51:39 2011 +0000

    Added get_encryption_key() method

commit 8ef53d95f1bf71800e4a14183ad44bd7db13b054
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 15 18:42:58 2011 +0000

    Fixed NTLMAuthChallenge in the situation I sent TargetInfoFields not as a structure but just as pure data

commit ba643c0a4190e241284ad572a26a96758d9b29ca
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 13 21:17:30 2011 +0000

    TRANS2_SET_PATH_INFORMATION structure added

commit 2a7a537a1c4635a5e79e5031de356a5d06af9898
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 12 23:16:15 2011 +0000

    Fix in SessionSetup structure to be able to unpack it

commit 267633f25d61f4399973b3d1d7a318daeb6d29c6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 12 16:44:54 2011 +0000

    NetShareInfo structs added, for later use of list_shared()

commit 9ce99b85e62986e3c5609fa1d64219fb4e2edd3c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 12 13:38:24 2011 +0000

    Added Transaction_SData structure

commit 28658628b8fb55072a62897de48c0d20b901dc13
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 12 12:08:35 2011 +0000

    SMB_QUERY_FILE_EA_INFO structure added

commit 96f9507e6039ad20bc83f3785b85c01a2b00c509
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 12 00:44:34 2011 +0000

    Added SMB_SET_FILE_BASIC_INFO and SMB_SET_FILE_END_OF_FILE_INFO structures

commit 8647dd74c9cc328c6951fc39b6cdebf21562c0fe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 9 21:54:07 2011 +0000

    Added TRANS2_FIND_NEXT2 and SMB_COM_TRANSACTION2_SECONDARY structs

commit 68093fcc22a51aedfa0c98f96b07d9aa2c44b788
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 9 00:04:22 2011 +0000

    Changed *Time fileds for CreateAndXParameters to 'q' size

commit 87b3471cca4c2cbcf0e08be743312eff6942844a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 7 17:37:04 2011 +0000

    TRANS2_SET_FILE_INFORMATION structures added.

commit 5e55c844cdd65caeb170f94cf858cfede19273f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 7 15:36:29 2011 +0000

    SMB_COM_DELETE and SMB_COM_DELETE_DIRECTORY structures added

commit 39bd64942a2eaa424f7165bbfb084c55c7eefb50
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 7 13:26:51 2011 +0000

    Fix typo for smb.FILE_SUPERSEDE

commit 4ff68ca41698372a84a9b7f7dbca461494202c25
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 6 16:23:17 2011 +0000

    1. SMBWrite and SMBWriteAndX structures

commit 42aea7797cfa7bc8743842a7957c9b2e885e61f7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 5 22:28:01 2011 +0000

    1. More structures added, no functionality changed

commit 97e3bc463c2da534e5f09c0ab5ce56225f9db371
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 5 02:13:41 2011 +0000

    1. Added SMBReadAndX_Parameters2 structure

commit c1a18064572ddd85b6064f9dea89dd68d9f73670
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 5 00:55:54 2011 +0000

    1. Added structures for SMB_COM_QUERY_INFORMATION2 (0x23)

commit 988e3b5ec5f4b866bfbdbd0cce4ecece55ac70ea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 4 20:55:37 2011 +0000

    1. Added constants and structures for various transaction functions

commit e29f3ada2a03872d87902023d1c2bd30d5ab37b0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 4 00:51:18 2011 +0000

    1. Added SMB_FILE_ATTRIBUTES
    2. Added QUERY_INFORMATION levels
    3. File System Attributes
    4. QUERY_FS Information Levels
    5. SMB_COM_QUERY_INFORMATION

commit 613b3c71c737a5eabcf1f3a65c6267c57fe0f08e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 3 20:20:48 2011 +0000

    Structures added:
    1. SMBTreeConnectAndXResponse_Parameters
    2. SMBTreeConnectAndXResponse_Data
    3. SMB_COM_TRANSACTION2
    4. SMB_COM_ECHO
    
    SMB_COM_LOGOFF flags

commit 4cc88d332266c57083de3229d2a08cd4e1cd8949
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 2 19:09:09 2011 +0000

    Comment for TREE_CONNECT_ANDX

commit 521d30f9805b9f4ad63a0b4e3d1517a78dba10e3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 2 18:55:53 2011 +0000

    Added support to parse SPNEGO structures if acting as a server

commit 9c46f8b4d515a4c649b3333bf3786a23fa2a4d43
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 2 18:55:20 2011 +0000

    1. Version and MIC now handled in NTLMChallengeResponse
    2. NTLMChallengeResponse.fromString() now work as expected

commit 65b58a498afa49613db2a917b1484d3bea0cdb13
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 2 00:00:56 2011 +0000

    NetBIOSTcpSession also accepts connections already established

commit b0a20ceea688f22996a0cd6dde20a4c3216cc1a2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 2 00:00:10 2011 +0000

    SPNEGO now decodes MechTokens if available

commit c42ef0d35b129550a6441d8fe65e00096780abff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 1 23:59:02 2011 +0000

    AuthChallenge.getData() wasn't returning any data ;)

commit 9b57d86b7d9ad2e54ac79527fe8ac72ebcfefd69
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 30 21:49:46 2011 +0000

    isDCE instead of struct_type... more descriptive

commit 969a1d2c63364382e02f2cf370b9e2e657aba5f6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 29 15:19:16 2011 +0000

    get_server_name() now works for extended and non extended session security

commit fad6e704d83ac071ab70316df4e550329a3fd59e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 29 14:47:54 2011 +0000

    If port 445 and remote_name == '*SMBSERVER' -> remote_name = remote_host

commit 75402b57d8766e474807a78e791fb98a140c48aa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 29 14:19:49 2011 +0000

    Updated the testcases based on previous commit changes

commit 3a595b57ba6cb288aee22402115852d3e17fcebc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 29 14:19:06 2011 +0000

    Changes to SEAL, MAC, and SIGN to adapt them to DCE Signing

commit 5899837dfe0d347ac1e0fc3e1b052a6350e54ee5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 27 19:31:24 2011 +0000

    Adjusting the data received based on previous commit. Now it does getData()

commit 382d4324d29026bb2cdf880b8755121a0ade29c6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 27 19:30:23 2011 +0000

    1. Added classes for DCERPC_NTLMMessageSignature
    2. Commented exportedSessionKey key weakening, that shouldn't be needed (I'm leaving that on until further testing)
    3. MAC() now received a parameter to construct the right structure if DCE is underway
    4. MAC() returns the structure instead of the data

commit 0c2880a76b4f911841b449a93ce4352a30e4f6cc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 02:28:13 2011 +0000

    Done.. all the sealing/signing tests are working now.. Time to put it working in real world

commit 7d4602c1800c5a0a48d089f52cd219daa7720d3d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 02:23:44 2011 +0000

    handle_seal should be used for message signing if also sealed. Yes.. confusing.. but that's what the documentation says..

commit 5d8bc3a42c3df577d88478a7237bd530ff3a14c1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 01:01:45 2011 +0000

    Since SEAL does SIGN as well, we should set the right keys and handlers for both situations

commit c76276300efa58eab916943b026c059723f9275b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 01:01:01 2011 +0000

    Still working

commit 2c350d6dfadf6f81571620a4cdd8edc5eefa09fc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 00:52:51 2011 +0000

    those damn magic constants must be asciiz

commit a79ab822c4441f05f6afef7faac8d72f58ac9471
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 00:51:23 2011 +0000

    Still working on this

commit 0efd5976665a79e63bbd71fdead0e7056bd07d14
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 23:23:49 2011 +0000

    keyExchangeKey should be available even if no KeyExchange is performed

commit 7685479e4479f2a47f858e07937e7bc7592f409b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 23:08:26 2011 +0000

    Adding the sealing/signing stuff tests. Not yet finished

commit 757093d2deac88388b13dde779de2fb80fb2c134
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 23:07:55 2011 +0000

    Added exportedSessionKey to KeyExchangeKey if no KEY_EXCH set. Double check this with tests

commit fbeb4b66b487f75ca33fca3b14c18d781a66b147
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 23:03:47 2011 +0000

    Added functions for the ongoing sealing/signing stuff:
    MAC()
    SEAL()
    SIGN()
    SIGNKEY()
    SEALKEY()

commit a1f700b7b684bf66ad78f339910551b1c175c598
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 22:59:07 2011 +0000

    Left some commented lines for the ongoing work of supporting signing and sealing with all the NTLM* flavors

commit 6ed442d36e5c4c0aee3c7b8c5a75f818103eb4af
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 22:56:26 2011 +0000

    Lowering the timeout value in case the target host dies in the middle of the connection

commit e212f513ec24c44da2fbfa81a4a5bcc96f6d450b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 15:40:57 2011 +0000

    1. Moved all the NTLMSSP logic into ntlm.py where they belong.
    2. Created high level functions getNTLMSSPType1 and getNTLMSSPType3 that are used by smb now (and in the future dcerpc)

commit 37eeabe4d230bca843c0f1f9e1e34fac6c963223
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 23:05:33 2011 +0000

    Checking of more flags in place. Next step is to take all the NTLMSSP out to ntlm where it should belong so other modules (e.g. dcerpc) can use the same code

commit ae79e43b7d846de8c67a1f1e5d467388bc5e49d4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 22:23:57 2011 +0000

    Adding domain to get_credentials and all the instances of login

commit fb1fc0b4e7b7b493add39dcc84d08ae260875648
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 21:34:36 2011 +0000

    MessageSignature structures for future use on signing and sealing

commit 5763b0c41a2a4f06ffec272ce8df7df0b42876f8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 20:54:38 2011 +0000

    Adding domain to set_credentials and SMBTransport

commit 8dc369897c4eaeae226e6a1818ab44ea52c5e166
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 20:15:28 2011 +0000

    Adding domain to set_credentials and SMBTransport

commit 65c78e6d46c8dc6fefc19b39113a036d50016db8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 17:31:50 2011 +0000

    Changed all instances of AF_INET for a getaddrinfo() so we can handle IPv6 addresses

commit 88f886a362518a70018719192f8f97226df32ed5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 14:20:18 2011 +0000

    1. Removed md5, no longer needed
    2. Added verification of the returned flags when negotiating capabilities, so the right encryption key is generated (128, 56 or 40 bit)

commit 5fa8d125620a5812314a55bb77474ff9a1e35382
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 22:17:22 2011 +0000

    0008-Add-opdump-a-tool-for-scanning-for-operations and
    0009-opdump-handle-closed-connections-properly from Catalin.
    Thanks!

commit f6e953b9414452624435c2f3d89c94911d084cc4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 22:15:20 2011 +0000

    0007-Add-ifmap-a-tool-for-scanning-for-listening-DCERPC from Catalin

commit 84b0e4aa38d66ac55635ad34698835de0146c731
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:56:24 2011 +0000

    0006-Implement-Remote-Management-Interface-in-particular from Catalin

commit 4aff752ffb544b91087625f3647625a15db3ac47
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:52:31 2011 +0000

    0004-Make-an-Exception-subclass-specific-to-dcerpc-for-ex and
    0005-Fix-parsing-of-the-BindAck-response-and-check-result from Catalin

commit dbb6ee5415ee1999cea0eb1b19dcb5af0f5545cf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:36:20 2011 +0000

    Accidentally committed this. Reverting back. Still pending solving the issue of establishing a good connection against newer OSes where *SMBSERVER doesn't work anymore. In any case, I don't think this is the right place to patch tihs.

commit 5f5f170fe35c02aa6d0b6b27d1408419c5e82897
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:15:43 2011 +0000

    0003-Add-some-more-UUID-parsing-formatting-helpers from Catalin

commit f4c271a9616ee6aff88b0dc0d7b255f9419f6199
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:12:25 2011 +0000

    0002-Move-KNOWN_UUIDS-to-module-scope-so-other-modules-ca from Catalin

commit fe139b2ef4d323e9ddc9c3134ce2b769e92aedbc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:07:04 2011 +0000

    0001-Fix-some-typos-in-the-KNOWN_UUIDS-list.patch from Catalin

commit 8e3c1cf68bdd5c53c61b4e80c44e1d1205eac1b5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 20:13:00 2011 +0000

    1. Share's comments (remarks) were not aligned with the sharename

commit 4935f064c9862c5b62e3868ec9394b1498d1f5b5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 19:40:05 2011 +0000

    ntlm USE_NTLMv2 back to True
    2. neg_session must use self._dialects_parameters['Capabilities'] to decide extended security

commit e5ffe53c4f5b10af9b31569908fe3bd293fd0e7d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 18:53:01 2011 +0000

    Clarifications to run the tests right

commit 1feb7e9c15f1867fd68351f70522406e373dd191
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 18:50:49 2011 +0000

    Signature related stuff.
    Added the aTime to the av_pairs if not received by the server (old Windows)

commit 25a4110d0229fab8e6d6c0649352716f9184ac5c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 14:36:00 2011 +0000

    Support for SPN name validation added

commit 3a83810cf7072eb3064bfff699aa937bc33864a8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 14:16:07 2011 +0000

    Now the library signs SMB if it is ENFORCED by the server (Local Security Policy -> Local Policies -> Security Options -> Digitally sign communications (always))

commit cceb77a570548c175e31b29c224b783285b1c9ea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 14:11:11 2011 +0000

    Fixed setting the right values for the computeReponse* response

commit 6d2611f2aea73f3889a9df01cc49b403fa7de57a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 13:36:49 2011 +0000

    This was the problem why NTLM2 wasn't working. Now all the auth methods work

commit cfc32b8a328e04eb08495d9509713c98d8c3aca1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 12:33:38 2011 +0000

    Changed the arguments for computeResponse* based on the changed previously made

commit 49b24eac42d3fc5d479050e798a52388e5aff191
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 01:51:04 2011 +0000

    SMB Signature is working.. verified. I'll keep it disabled tho.

commit 6c6e96f623e412f6953cf12026ccaf58aaf59517
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 01:18:33 2011 +0000

    1. Ok.. almost done with the NTLM saga. Depending on the USE_NTLMv2 global variable, when calling computeResponse, it will either go to NTLMv1 or NTLMv2 (and calculate the different values depending on the flags set, eg: NTLM2). There's an special case when authentication doesn't work against a Win7 and it is when using NTLMv1 with extended security, I guess that has to do with the fact that the other side is expecting NTLMv2 instead of NTLM2. Further research is necesary (if someone knows this let me know).
    2. SMB signing is now working but disabled. It will be enabled in the future only if the target requires it (win 2008)

commit b8549c9a6330e6dbd02cc4c50e1afa0185d93005
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 21 23:20:16 2011 +0000

    Fixed minor things.

commit ced6159a7055ca68a093591a7a42dee724a60be2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 21 22:45:34 2011 +0000

    1. Checked everything with the MS-NLMP examples. Just one (4.2.2.2.2 with LM_KEY) to fix (not a big deal actually)
    2. Added the USE_NTLMv2 global variable to ntlm.py since that's not something to be negotiated by the client/server
    3. computeResponseNTLMv2 changed to computeResponseNTLM2 (better name, reflecting what's going on actually).
    4. Commented out a lot of things on NTLMAuthChallengeResponse.fromString(). I don't think we need it, but left there just in case (too much for today)

commit 633c27fd6d7de150b381929a2b919a6237870c77
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 21 22:38:34 2011 +0000

    added serverName with the AVPAIRS in there

commit a9a26927311e9c8f471348e0de01cb4e0aea0167
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 21 22:36:27 2011 +0000

    Test case based on MS-NLMP, section 4 - Protocol Examples

commit 5dd17c26469761865b318ace90e310ff491de8a0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 20 22:49:17 2011 +0000

    Just commented the signature check. SingSMB is correct, the problem seems to be when generating the encryptedRandomSessionKey. Maybe KXKEY is not doing things right. Gotta research more

commit 3e2c341125f177e39b3cfb6909b0f66c65d587f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 20 21:58:07 2011 +0000

    1. Added more stuff for SMB signing. Still not activated since it's not yet working

commit 4e5c71b6ff81bab243b7bf209a7293ab5d23afd3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 22:07:56 2011 +0000

    1. *_Data structures base class must be Structure (it was working anyways, just for the fact of putting things right)
    2. rename() and mkdir() now uses Structure. Added classes for those and changed functions

commit f8ed3e7fec1dd144be99ca1bc43f7fd89501be10
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 21:26:49 2011 +0000

    LogOffAndX now with structure

commit 56b827e6f6be16a24bac7237b22d9d58d51c86b2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 21:14:03 2011 +0000

    Removed unused function __decode_smb

commit 258624b87c93504e8c962b07d9847d1adbe4198c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 21:06:15 2011 +0000

    1. Removed TRANSHeader class, replaced with structure
    2. Removed use of TRANSHeader in dcerpc/transport, replaced with SMBTransactionResponse_Parameters structure
    3. Created SMBTransaction* structures in smb.py
    4. Changed TransactNamedPipe to use the new structs

commit ef72ba9a2a82ba580cd1200520c4415e7f4a31d4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 01:43:40 2011 +0000

    1. Implemented SMB_COM_TRANSACTION using structure
    2. Changed send_trans to do so
    3. Removed __trans. Old and useless
    4. Removed __browse_servers, browse_domains and browse_servers_for_domain. Those methods didn't work, and, besides, should be implemented in SRVSVC (setting a ODO there)

commit 68fcb42731637069c641de1244cb98a63166361d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 00:28:20 2011 +0000

    SMB_COM_CLOSE with structure now

commit e067cae466bec2ab0e9126254f4c11528f9b4c8c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 00:09:23 2011 +0000

    stor_file now uses write_andx with structure. Still left stor_file_raw

commit a774d94fc22a13a912a84c3d16cb482ac0ae4a07
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 22:39:52 2011 +0000

    One NT Error added

commit 0fd5072ec1671f8cbd7287c7baa2141e152cf644
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 22:36:30 2011 +0000

    Variable initialization missed

commit d45e7a5fcddc308e092a5c1a24ea3cf3a0b340ae
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 22:27:14 2011 +0000

    1. Removed NTLMDialect class. Now replaced by _ntlm_dialect_parameters and _ntlm_dialect_data (all with structure)
    2. Changed all references of _ntlm_dialect to the proper new schema
    3. Added parsing of ServerName and DomainName in SMBDialectData. Extra careful data might not be there (e.g. some Unix systems)
    4. Updated the get_server_time method now using _ntlm_dialect_parameters

commit e45987be77ad5c44677205b92e9a4e5c90295b9b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 18:22:02 2011 +0000

    removed set_key_odd_parity. Not used at all

commit 5c711c2e20d337feb25ac5f196de07f38fa45ff2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 18:16:00 2011 +0000

    Some beautifying of the source code.

commit 840cbd614195d3ed53ce7a91b96d2816524e0828
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 17:02:31 2011 +0000

    If hashes were passed to a dcerpc transport, now pass the hash is going to be performed as well (only in NTLMv1 as this is the only auth supported by dcerpc)

commit b06f86f6ec492fc59acdc3fa8cdc93a8da857053
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 00:54:10 2011 +0000

    Fixed correctly handling NULL sessions in extended mode

commit 32799720ab604db2a86d5428fcbc276f0f38b135
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 00:38:13 2011 +0000

    Fixed correctly handling NULL sessions in login_standard

commit a503056226a222db1a7d8eee40892a7d4d9238c9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 22:55:44 2011 +0000

    1. Removed the SMBExtended class. That shouldn't have ever been there.

commit 2a72b1bb7056626cdfba62c1f631f502546d5b3a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 22:50:41 2011 +0000

    1. Removed login_pass_the_hash and login_plaintext_password functions. No longer needed
    2. Turned on by default extended_security. Now the library tries by default to connect to the targets using extended security and NTLMv2.

commit a5ff88db15debdb2c3668192710f5f2c601d721a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 22:48:07 2011 +0000

    1. Added some NT Errors since we get those ones when using extended security
    2. self._dialect_data to be the default in the future, still most of the code using self._ntlm_dialect
    3. Remove an assert since now we do NTLMv2
    4. Session key generation for NTLMv1 now in place
    5. Reorganized code in login_extended
    6. login() now goes to either login_standard or login_extended, and passes the hash right away to both functions.

commit b50d20cdfe81306623e3377103545506c636b4e4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 22:42:19 2011 +0000

    1. NTLMv1 (simplified) algorithm written. It actually calls some of the previous functions.
    2. Minor changes to functions names

commit 18c6bac732bfbc141f6759db15783d3a313ce717
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 19:59:19 2011 +0000

    1. Changed NewSMBPacket structure so it now has the SecurityFeatures (signing) field (in preparation for SMB signing)
    2. Added SMB_SIGNING constants
    3. Added singSMB(), does nothing now

commit efed798f2058074eb638d6c79efe8ae9dc789221
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 19:54:57 2011 +0000

    1. Making pass the hash work with NTLMv2 - done

commit afe54eff4dae3c2d3a1dca34257612d4487febe4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 17:08:26 2011 +0000

    1. Now the client requests KEY EXCHANGE and INFO TARGET (the later needed for NTLMv2)
    2. Added the logic to call the KEY EXCHANGE functions previously committed to ntlm.py

commit b21111af0fa0f3b89f56e49d469e071a39615ec0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 17:06:54 2011 +0000

    1. NTLMAuthChallenge now correctly handles servers that don't send Version Information
    2. NTLMSSP_KEY_EXCHANGE now supported. Key is calculated and send to the target Server
    3. Generate a FILETIME structure if the server doesn't send one, to complete NTLMv2 auth.

commit c9dbcb85617853952cbef5456874686bf43aade8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 02:22:05 2011 +0000

    1. Completed the NTLMv2 support when extended security is used. Still not default.

commit ca6e0be0a36a4a0999bd5586fcbc1e9a96f8b4ab
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 02:15:43 2011 +0000

    1. Minor fixes on AV_PAIR so unpack/pack works well
    2. Fixed the NTLMv2 algorithm, now it works.

commit 861befa380623e13ebe7ebb2e11293c74f2d6f66
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 16 23:14:33 2011 +0000

    Added handling of NTLMv2 (still not working) when treating extended_security

commit 127dfa5ea29c06c3218237e6e5eb9368c0adcd4b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 16 23:12:22 2011 +0000

    Extra verifications just in case there's no TargetInfoFields in the packet

commit cab17fe14299108b156cc5be2cac6de5b15c17b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 16 23:09:20 2011 +0000

    1. Added AV_PARIS structure
    2. Added handling of AV_PAIRS to NTLMAuthHeader
    3. Added NTLMv2 algorithm (still not working)

commit a072ed355cd3e08b18651a609706d8fad0192afa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 16 19:19:49 2011 +0000

    Completed the NTLMAuthChallenge structure. We need some items there to do NTLMv2

commit 6e06bed8f7cf8c1e0aa43184ac23d3eb6581fb76
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 15 22:26:10 2011 +0000

    Defined TypesMech to map string names to UUIDs

commit c07fa29622702e85e44fdf6777aadd5a4f4557bc
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 15 17:39:50 2011 +0000

    binascii.crc32() can return negative numbers, they must be properly packed as integer (not unsigned integer)
    
    also changed to integer (instead of long) so in 64 bits platforms they are still packed as 32 bits

commit 10c548427896cf75765b715d957ed838e69c9324
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 15 02:17:00 2011 +0000

    1. Fixed the INVALID_PARAMETER issue.. the Uid was missing from the previous packet. All done.. but still disabled until further testing is done.

commit 5faa5c8864d6fa09e87f52c24fc793045ba86326
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 15 01:20:02 2011 +0000

    1. Implemented SPNEGO_NegTokenResp()
    2. Fixed bug on SMBSessionSetupAndX_Extended_Data SecurityBlobLength calculation
    3. Added SMBSessionSetupAndX_Extended_Response structures
    
    Still all the new stuff is disabled. Pending figuring out why the server is responding with INVALID_PARAMETER when sending the last NegTokenResp. Could be a flags problem.

commit 5ecff4660a1eb2ce7c114ca6d73b476dcb4ab5eb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 14 21:47:47 2011 +0000

    1. Added SMB FLAGS and FLAGS2
    2. Changed existing ones (LONG_FILENAME and USE_NT_ERRORS) to (LONG_NAMES and NT_STATUS) per specification's document

commit cb6cac766a59ab16627aa11d468ccadee83d57b0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 14 20:51:48 2011 +0000

    More stuff on extended security:
    
    1) Completed the NegTokenInit with the mechToken
    2) Started working on the login_extended, one packet more to go

commit 210fc6633f6efabb8d8c06b5002e56ad42864aea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 14 14:38:17 2011 +0000

    In preparation for Extended Security authentication support:
    1) Added GSS-API structures and functions
    2) Added SPNEGO structures, now it supports NegTokenInit

commit 355df3118e1456e97a6df3dabc70a321f60fd94b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 12 22:11:06 2011 +0000

    In preparation for Extended Security authentication support:
    1) Added Extended Security structures
    2) neg_session can be set to request Extended Security
    3) Non extended security structures created and parsed, although NTLMDialect is still used overall (to maintain compatibility)
    4) login_extended defined, but yet implemented (it shouldn't reach that code ever)

commit cf1da46024be44937939551469f7d475ccdef47c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 12 00:36:19 2011 +0000

    Flags doesn't exist, it's Flags1

commit dd7c6862d2062e57d7a569823976fe3686ac2d4d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 12 00:27:38 2011 +0000

    SMB neg_session now uses NewSMBPacket

commit 900977fba358a311abc285d5f8d8e03def493604
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 23:39:34 2011 +0000

    Added info command to display results for NetrServerGetInfo

commit e0ffd4153127fa5b495cde48b3f0089850c50ed8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 23:31:48 2011 +0000

    Added support for NetrServerGetInfo(Level2)

commit 72887f78b45c52af3ce0b539fc5ffd075b4741bd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 22:33:16 2011 +0000

    List of shares now uses srvsvc

commit 0f776b019359dfcde29617800d372e8ffc8cdeed
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 22:28:54 2011 +0000

    Added the ability to specify an already connected SMB session to the transport avoiding creating an extra connection

commit ae61854b6ca0b974908b6f37acb6efb352335c7f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 22:16:06 2011 +0000

    Copyright change

commit 32e61e8b683dba375703e1cc4663f46d35ed14f4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 22:07:52 2011 +0000

    Added get_remote_host method

commit 980dd754cfa1e4577366b4f73e2ddb70a321de31
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 21:53:52 2011 +0000

    Added support to specify the remote_name via the open command (from Vista on, *SMBSERVER doesn't work anymore)

commit 38e79050a88e3fc7fe147cdece674d2de29459cc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 20:55:59 2011 +0000

    Added support for NetrShareEnum(Level1) and NetrShareGetInfo(Level2)

commit efc2bb662d71ff720af4c1fe8076844fbe82f378
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 8 02:37:58 2011 +0000

    Updated maintainer info

commit a11cc11a999c1fcc21a0a8b32fd452cb6b9b4395
Author: pditincho@gmail.com <pditincho@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 1 15:10:32 2011 +0000

    Addition of test suites for IP6_Address, IP6 and ICMP6. Several bugfixes and typographic corrections.

commit 98ed9275de29d22a47ae9e395cd6c2de849ad7b4
Author: pditincho@gmail.com <pditincho@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu May 26 14:48:34 2011 +0000

    Addition of support for IP6, ICMP6 and NDP packets. Addition of IP6_Address helper class.

commit f3fb8846cb816e9632aee58755de7df38d7191c9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 10 16:35:15 2011 +0000

    No need to change flags when asking for shares, reverting back to the ones we had before

commit a70de4de81bcf9280af9c32e15b3289d0688e83d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 10 16:33:06 2011 +0000

    Added support to specify domain when loggin in

commit ad26f3ae9bc87399bf25742dde35e12290e7a0db
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 10 16:30:35 2011 +0000

    Added support to specify domain when loggin in

commit b8b355c79f7625ebe59dc94235151762be3d23dc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 8 01:46:25 2011 +0000

    Support for NULL login (just put login)
    Now it correctly handles open {host,port}

commit 2153773af3c0854ee22533bbda69438183adedee
Author: jigermano@gmail.com <jigermano@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 2 21:26:56 2011 +0000

    Issue 3: Bad SessionError message
    Issue 4: Copy with smb doesn't work
    Issue 5: Reference to an undefine ERRBROWSE
    Issue 6: wrong exceptions being raised

commit 1648086471439876f38bbb3a8f980b7e28c04d4b
Author: jigermano@gmail.com <jigermano@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 2 21:19:50 2011 +0000

    Fix Issue 2: NTLMAuthHeader should be used for DCE/RPC only, forgot a simple unittest checking the headers

commit f8cc713efe46088bce166b47d377493144964595
Author: jigermano@gmail.com <jigermano@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 2 21:10:49 2011 +0000

    Fix Issue 2: NTLMAuthHeader should be used for DCE/RPC only

commit f70f0604a21bd1faad2f5ba06d2f95e56ed126ae
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 24 14:39:58 2011 +0000

    at some point in time NTLM Auth and Encryption got broken when synchin stuff
    from Core's trunk. This commit fixes it, and adds something else, which we
    are not 100% sure, but works: data in a DCERPC packet can't be empty, we
    add 4 bytes when it is.

commit c346847c1ac68e99f1883576b2cc81070795a550
Author: gmoreira@gmail.com <gmoreira@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 18 17:56:45 2010 +0000

    a method for returning the reserved TCP header nibble was added

commit dd48420a715d807cebd1101ccf2c146e7c6aa3c5
Author: gmoreira@gmail.com <gmoreira@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 4 19:33:46 2010 +0000

    We modify RadioTap class to improve performance creating RadioTapField array at static time.

commit f180573798c8862202e189596345c7f7e1496e80
Author: gmoreira@gmail.com <gmoreira@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 3 16:05:15 2010 +0000

    Update to Core impact internal repository

commit d0a276794aa53c96a8d32068c3e2e3084bc3eff5
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 8 17:48:44 2010 +0000

    * Fixed keymanager problem in decoders
    * Fixed address place where the BSSID address was used. The BSSID address place is based on fromDS and toDS.
    * Fixed test-WEPDecoder.py, it used the incorrect address to add the key in the keymanager.
    * Tidy up Dot11DataDecoder, replaced individual frame control (Dot11) field setters (set_QoS, set_Addr4, set_privateFrame).
      Instead we pass through set_dot11_hdr method the Dot11 object, it's the frame control object.

commit bfb585ad64c5505b52dec4a7d8e7357269e7953e
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri May 21 14:09:39 2010 +0000

    Added DHCP INFORM contstant.

commit 7caeb7d0b1a5e99ca36e59e254ef33eef7c94d78
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 4 12:58:54 2010 +0000

    * Bugfixed in TCP encoder. get_th_flags is reading header size part too.
    * A Testcases added to check this and other methods.

commit 5cba79ba68676d1624568c01d8f556ffa920d85c
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 29 17:54:02 2010 +0000

    in the changeset [238], we made the mistake of using the packet total size instead of header size.

commit d8956789b8c1f07e5c058b5e0539080504fb8599
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 29 14:20:54 2010 +0000

    Bugfixed in RadioTap protocol encoder. The Radiotap header length wasn't updated when the packet was created from scratch or modifying by adding or removing fields to it.
    Also added a method to read the header length

commit e6e9d640b0bb5af81e9a2379540050c272edebcd
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 28 20:38:18 2010 +0000

    When we were creating a RadioTap packet from scratch, the constructor was calling to set_present method that was renamed to be private.

commit b6b1f1564a217d48c4c9ed754f4c18cae1723280
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 22 17:48:33 2010 +0000

     - Added DNS decoder and part of the encoder.

commit d89d0e603cc21c498538e46bcb619d8ff3e99b69
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 18 06:00:22 2010 +0000

    We facilitate the way that we do the auto checksum calculation in the IP class, the checksum is setted at 0x0000 internally in get_packet before doing the calculation. Before, this task, should be done manually by the user being prone to a mistake in the order they are calling set_ip_sum and set auto_checksum doing the calculation was not made or was made incorrectly.
    Added the reset_ip_sum method to IP class.

commit 552df832a919b3d36e3975a9b1e3d0416e53b3db
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 16 17:17:34 2010 +0000

    in changeset [229] We change bit endianess on getter/setter of managemenet authentication sequence but we missed to change related testcase.

commit d080f08afdb946badbff117603af439b3a868a10
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 16 17:15:11 2010 +0000

    Moved ProtocolPacket from dot11 to ImpactPacket so it can be used directly by the rest of the protocol classes from impacket without having to import dot11

commit ecdc4214281da7f2f009736bd05a75c47d0ca061
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 15 18:07:06 2010 +0000

    ImpacketException should inherit from Exception.

commit 2bb809f7cd1a85e21f8d98275864d8105375517e
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 6 02:25:52 2010 +0000

    Added get method in DHCP class for get DHCP options values

commit 463ec8c8d6e0aa38cc3cbc6ccdd67d60382b8e99
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 5 17:25:25 2010 +0000

    Bugfix in UDP class, self.parent() is a method not a attribute.

commit b8e58bf7dbc75079ba190d241f89b6205e17fadf
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Mar 3 18:17:02 2010 +0000

    Change bit endianess on getter/setter of authentication sequence.

commit 89331db947818d34f17862101cdba8678f4696fe
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Mar 3 18:03:21 2010 +0000

    In changeset [138] we introduced a bug on structure in unpack method that override fields dictionary when added inputData element.
    Fixed

commit 8c3a4400f57f0246e8fc520949ffd2ac352548a8
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 24 20:27:00 2010 +0000

     - Typo where are you!!

commit 09739d97c6a069a2352f1b3c8bab2a66e4dd17d5
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 24 20:10:22 2010 +0000

     - Changed some ugly param names i put on the last commit

commit 4e8939e68a8c4034ae5b978b162cc16de19ae0ae
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 24 16:03:04 2010 +0000

     - Added Reason Codes Constants
     - Added Auth Algorithm Constants
     - Added Status Codes Constants

commit f56b2b39e78b59c7d32d816a384dcc0ea3d2c20c
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 15 19:57:27 2010 +0000

     - Added Authentication Management Frame.
     - Added Association Request Management Frame.
     - Added Association Response Management Frame.
     - Added Disassociation Management Frame.
     - Added Reassociation Request Management Frame.
     - Added Reassociation Response Management Frame.

commit 30bb3a3de4d0a5565879b999b5626fd1da1d8ec0
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 8 18:32:43 2009 +0000

    Merged WEPIntermediate branch to added WEP Encryption/Decryption into trunk

commit 0634b5d0844f365f4870382c81ff32292bfb4f88
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 8 15:34:45 2009 +0000

    In changeset [216] we included by mistake not yet finalized changes

commit db7bcb672f0045011afeaf8e8ef1d767d484411e
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 8 15:08:45 2009 +0000

    In changeset [214], we forgot to modify exception text

commit 25e0a383fbaf0d48254724e1f8a9b42c27cfb39f
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 8 15:01:21 2009 +0000

    Bugfix: in IP datagrams, when decoding, checksum shouldn't be modified

commit 02043439eb3f0369e1ace9ecdf889fe79c240be5
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 8 14:31:48 2009 +0000

    Bug fixes in SNAP decoding

commit d8b9daa83c0cf99a0ebf1d94d17b4485f928877a
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 28 15:32:50 2009 +0000

    path for IP Options up to 40 bytes, submitted by George.Khoury@viasat.com

commit e8290f3d08fc61e090b39ae6f30b5cded3bb9e61
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 28 15:32:02 2009 +0000

    added warning message when no crypto library is available

commit 3f2f9a79deee7f4e85dae6768adf0c3601141a30
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 28 15:22:39 2009 +0000

    small change in LICENSE

commit 703a6ee5f23496c135ba4c5ed085096681720cf9
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 28 15:19:25 2009 +0000

    small fix to define POW as None when Crypto is not found and POW is not found

commit 33665a133d4faf9ef3df2f60c1829a58a15a4891
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 27 00:01:05 2009 +0000

    Fixed Typo: We forget to fix the testcases and Dot11 class

commit 50766729edf752417fe1e40728058248abf335ef
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 26 19:30:08 2009 +0000

    Fixed typo.

commit bd3de5f0f630572906db133bf8afbbe329871a63
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 15 04:38:03 2009 +0000

    Fixes in Dot11ManagementDeauthentication:
    * We incorrectly defined this as inheriting from Dot11ManagementFrame instead of ProtocolPacket.
    * We also forget the code to create a Dot11ManagementDeauthentication packet from scratch.

commit d8b30f309b599ce3dce65b235ad6358928ca2cc9
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 8 19:47:20 2009 +0000

    Added management deauthentication frame.

commit af9652a8bc3b6d4ebf6546f358a56cc802ee9b92
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 21 16:07:46 2009 +0000

    Fixed bug on RSN element parse.
    Modify test cases to work with modification on vendor specific element parser.

commit 494452cd934aa41b2ffcf810dd30cff1acb24af9
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 11 20:30:59 2009 +0000

    Added getter/setter of RSN Element.

commit d6b635d2e9b7a1f5ad78750a100275f1c13fd0a7
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 11 15:19:26 2009 +0000

    reverse and not engineering

commit 196935cc79f8da355eac496dca7637db30402bb9
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 11 15:06:01 2009 +0000

    Typo

commit 7117ecdd2b0f694c71998a042cada5a493672453
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 11 14:50:57 2009 +0000

    Added capabilities bitmap.

commit b012389f6e44c6d45f65d51c3c52896116c1d8e0
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 8 22:21:32 2009 +0000

    Merge with some bug fixing.

commit b866316784725ef860f3ad93a5e790f99a6ec09e
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 3 18:38:57 2009 +0000

    + Added 802.11 ProbeResponse testcase.
    + Add script to run all testcases in win32 host.

commit 652f0dc53fe18461490505558935b7600802dab9
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 2 22:20:36 2009 +0000

    dot11.py: Added classes to decode ProbeRequest and ProbeResponse dot11 Management frames.
    ImpactDecoder.py: + Fixed bug in RadioTap flag field when it's zero
                      + Added decoder for ProbeRequest and ProbeResponse dot11 Management frames.
    test-FrameManagementProbeRequest.py: Added testcases for ProbeRequest dot11 Management frames

commit 7afd005e5c438565b5eeec1ef3f2cbc4698cf23a
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 2 22:07:32 2009 +0000

    Fixed ident issues

commit d39a3e5831c64f97787a16c9dd5f1110d48a1b5a
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 1 19:19:41 2009 +0000

    Modified encryption handling to support keys

commit 8e2ecfb445118b37e3e23a2835a35b073e138790
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 1 15:49:06 2009 +0000

    Modified python executable path.

commit 0892e8d9068c163752b408643bfe188b63b062bb
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 31 18:56:09 2009 +0000

    I miss the method of the instance. :S

commit bb850e8f3ba1e884be214e4744316c70e783034b
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 26 19:02:04 2009 +0000

    Added Dot11ControlDecoder.

commit 35fbfc0a11b051e6f25d513d5ce95a3b235f6c93
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 9 00:30:59 2009 +0000

    Improvements in Management helper classes.
    Added vendor-specific getter/setter methods

commit 25d157b19acde9c3f81ccd93325cb6732bdc5f78
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 5 03:30:53 2009 +0000

    Improved Dot11 Management classes generalizing to the rest of the subtypes.
    Added base methods to delete elements, add/replace elements, etc.
    Added SSID and Supported Rates setters
    Added DS_Parameter_Set getter/setter

commit add55052f3638ae0b679651fd6b6c4ce629e8606
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 3 12:46:19 2009 +0000

    Deleted RadioTap unused private methods

commit 4ff8a1ec46a94ef79d980f39f97461ff87c8cbbe
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 3 04:57:44 2009 +0000

    Added getters methods for SSID and Supported Rates.
    An update related to previously commit is included in this changeset.

commit 920990bca217b2c30e79ca49491b126a9a56ce63
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 3 01:48:37 2009 +0000

    All dot11 packets have no FCS. This depends on the flag FCS_at_end in RadioTap protocol. In this changeset we handle these cases.

commit cd1569719eb463ef5d09871429baefdbc1c9a169
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 2 22:33:03 2009 +0000

    Updating of imports

commit 2a03e7a7747a6b4ca6d85d9045656b056825402d
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 2 22:16:21 2009 +0000

    Added an hierarchical updating packets mechanism.
    A packet is the body of the immediately superior packet, if it has a parent, within the hierarchy. If a package is changed, this must be reflected on the packages above.

commit 4f2bc706ecbc9c22734f8bf14b4f1cc5c068371f
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 2 00:45:30 2009 +0000

    Started writing the Management Class, its testcase and decoder.

commit fe3c7c9717a0909190212692ba511da9416394e4
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 2 00:15:38 2009 +0000

    Added long_long data type setter and getter to PacketBuffer class

commit 9c4498b4a49081581735c1657ce1d0d8c9fc7201
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 31 04:35:47 2009 +0000

    Completed RadioTap Protocol testcases and several fixes

commit 2640bba58c03ed9611de10856cc2c84b4661d7f4
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 31 01:32:52 2009 +0000

    Fixes in channel field. A test was added for this field in the RadioTap testcase.

commit c0b8d0f5d0c5663d5b0dfb13c7943c7f85737184
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 30 15:05:49 2009 +0000

    Added method to decoder base class for get a particular protocol

commit 792e8d98de3f4a6ccf34e88d143116685900e10e
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 29 02:01:15 2009 +0000

    Fixes in RadioTap decoder. Added testcase for RadioTap decoder

commit c76d8911a399831612f345a56c8072a21657a841
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 29 00:21:29 2009 +0000

    Add xchannel field setter's test in testcase

commit 83ab182957402b93c076ea29cbc562512c92e971
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 29 00:13:57 2009 +0000

    Added all the RadioTap field. Lack of testcases for this field.

commit 9b50a93f0163d7d38aee2b86c44808943b90fa8a
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 28 13:44:45 2009 +0000

    Rewrite of RadioTap class

commit 6f4ea36d14c35ea3bcdfcc9916dd56c72eff5bba
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 25 15:00:40 2009 +0000

    This was a pending change, was confusing and redundant that each class has the length of header and tail.

commit 2fc8c24fd7db418b43d09a6119ecbeca940b983a
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 25 14:33:06 2009 +0000

    The AbstractDot11 class was renamed to more appropiate name because it is no longer an abstract class, nor is it only for dot11

commit 0471f55bcffa48852f439a647c904973c0767745
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 24 14:08:52 2009 +0000

    Added getter/setter methods for flags and rate RadioTap fields

commit 43247fbf27ec69dc86e711858cc869d131385599
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 24 13:43:15 2009 +0000

    We unified format conversion to __set_field_from_string and __get_field_as_string

commit fbc6ebad062200ec76a43cb397f971087c395193
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 24 13:27:57 2009 +0000

    Deleted some lost lines

commit 50ef64c41e165f494fa0062d37b5e4a8c108b45b
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 23 23:27:20 2009 +0000

    Modified __get_field_position for return the field length too.
    Add unset_field method and tested in RadioTap testcase

commit 3528204d5ba5602908556bb7268d39737c2efef0
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 23 13:32:43 2009 +0000

    * Fixes with RadioTap header size when add a field
    * Improvements in the dot11 base class (AbstractDot11)
    * add unset_field method

commit 7b8a099cf185605d28f9838326d9c35c54125a3c
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 23 05:14:49 2009 +0000

    Advancing in the RadioTap class construction

commit 13284061dd19951bf49e14d6fe221ee6769360b4
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 6 01:51:39 2009 +0000

    renamed to more suitable name

commit 59380c7778154f49f523b23da1978a3a38403908
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 6 01:43:33 2009 +0000

    Added methods to handle WEP/WPA/WPA2 fields and their respective TestCases

commit 9fed0dea96a80ab60f601caa7f80d30d216638e7
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 4 22:37:05 2009 +0000

    Added test to check if get_packet() return the correct WEP Data content

commit 1416fe53d08a9ded0b7c284005c1e59aeba57472
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 4 22:25:39 2009 +0000

    Fixes in dot11 decoders. In this context, a testcase was added

commit 51d6333234ac5f9c95fad2b650ace13eaff479eb
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 4 22:22:53 2009 +0000

    removed debug line

commit ec8ef633bf852d5f0d25828706b09fb23e2aab5a
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 3 03:33:47 2009 +0000

    Completed WEP testcase

commit 41cf5524a15336accec29ff72439710445868ed9
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 3 03:31:40 2009 +0000

    Fixes handling tail frame part. Fixes in WEP frames

commit e77f9e457e60b44de754704a7afb0b4cbf7baf70
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 30 03:49:08 2009 +0000

    Updated WEP/WPA/WPA2 classes
    Outlined WEP/WPA/WPA2 decoders

commit 639ca77ed412935de1d7de383abbda887a43db56
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 30 02:16:13 2009 +0000

    Data Frames and WEP updated

commit 473306c15334f6560010ad30e5867a362e3f5781
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 29 11:57:59 2009 +0000

    *Adjustments to new class design.

commit 01f2a0561fbc00932554ef61cb38272d043a1d04
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 24 02:25:15 2009 +0000

    changed to use asserts unittest for this check

commit 8d3614b0953a29da856584e35a61383a181d4643
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 22 05:12:10 2009 +0000

    Outlined of decoders. Although not tested

commit 0f2777aaa1c01b2d8fa150d08b95e29a857bf3e6
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 22 05:08:53 2009 +0000

    * New design, rewritten a lot of the code.
    * Separated DataAddr4 and DataQoS from Data.
    * Adapted testcases for Dot11 and Dot11DataFrame
    * Added LLC Header class
    * Added SNAP Header class

commit bd6dcc8325fa6b5797e2f6d524c0a0a9374ccab2
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 22 04:53:59 2009 +0000

    Was separated from Header class all the protocol layers logic to ProtocolLayer class and now Header inherits from this too. This does not affect the rest of the code
    Dot11 needs inherit only the ProtocolLayer stuff.

commit 242128b7f4cb37cef8051cec1614b13d232d8cba
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 9 05:50:53 2009 +0000

    Some fixes for CFEndCFACK and PSPoll. There is still an error to fix

commit 81e5e4055bf0b220be1d86e5a04bfa908ec395da
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 9 05:47:42 2009 +0000

    This comment is no longer valid

commit 39a4fb47bc5fb310a5b8abfe8e985906e685059c
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 9 05:46:15 2009 +0000

    we must keep in mind that comments about AID (Association ID) field

commit cd35a20e77471de8d0214a5f27901d834be47003
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 9 02:55:56 2009 +0000

    Frame Control PS-Poll has AID field, and not DURATION

commit c9749f220972b5a83c6fcca3dc67f43f8097c26a
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 9 02:41:31 2009 +0000

    Removed trailing word "field" from each method name

commit 80469292e1c1a980f948df498e1178b5d048cd24
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 8 20:08:29 2009 +0000

    reordered ECN responder, and added some debug prints (commented out)

commit 8d7df3253e211fcbc6037cbfc1986e63207f158b
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 8 19:26:52 2009 +0000

    removed some unused stuff

commit 7cdfaebd08c69fc8a89f8457af61e9d483141a1d
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 8 19:13:09 2009 +0000

    added --help parameter

commit 92e98fbe63ae414cecca1fa9a02bb96ab6496654
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 20:26:48 2009 +0000

    added PcapFile.reset()

commit 79de6f63eafbab6cae83214acbfe08a97d50c5ee
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 19:33:31 2009 +0000

    added class PcapFile. it can be used to read and write pcap files

commit 0e13dfc4d916ea7209e3fda9beaf9cb380d70e2c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 19:33:05 2009 +0000

    @classmethod
    Structure.fromFile(aFile)

commit e68a9ac853ab93d15cb21afd4a6167ce4fc90f2a
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 19:17:00 2009 +0000

    Added partial support for IEEE 802.11 Network packet codecs

commit 30095536e4486b89c15f96882d9591f93cc96d13
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 18:55:05 2009 +0000

    simple label rename

commit 959631877489c85ca271b2adb6a861c62ed7d85d
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 16:17:19 2009 +0000

    bug fix: when packing "=" fields, "&" couldn't be used inside the code because "&" type specifier had precendence over "&"

commit 4a5fd5c368cb0b55def853b7158bb9bb23fd0688
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 16:16:27 2009 +0000

    new test, example of how to pack and unpack bitfields

commit a6225280737ce006d7e1c7e6c116b6db47ee2143
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 19 15:55:04 2009 +0000

    documentation fix

commit 2c74f0520b26fcd4699d9b07745700544bf23fb9
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 12 22:39:54 2009 +0000

    added fault nmapOSDB pointing to /usr/share/nmap/nmap-os-db

commit 44d1b6289013abac10065e9083c221a8f0dcea3c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 12 22:30:22 2009 +0000

    renamed wpad option to 'proxy-autoconfig'

commit 55e978a741f5431648f21bd187f98a435d26c65c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 12 21:10:19 2009 +0000

    added more options

commit a5bec1ba0ddfe992ce8eeb52961170cf574f5dfc
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 11 16:19:10 2009 +0000

    more dhcp options

commit 12c817ccac608f9d9288ebf4a89a4a5843c66e4e
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu May 7 21:18:16 2009 +0000

    added some more options
    decoding requested options too

commit 8dbe021b3b1d653a8926e16883450df5827504d2
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu May 7 16:13:02 2009 +0000

    typo

commit 1b3d4607155f65afac2a47c7a45c3d1bb574b091
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu May 7 16:11:13 2009 +0000

    added command line argument -d to specify the nmap-os-db file

commit 934278323ff7dc2a38705e58c80aa8f66f6ad59c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 6 15:30:12 2009 +0000

    some refactoring, and added udp cmd packets, can be used like:
    
    echo cmd:exit | nc -u 192.168.66.254 12345

commit 336d2e8a25fcff64de10c39a0c62ff2226690aa2
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 30 21:29:16 2009 +0000

    added some DHCP options, more to come

commit aef20feb75d89ba55ecaf05e56878567c73c2c46
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 30 18:02:18 2009 +0000

    bug fix/improvement: self can be used in pack/unpack code for _ fields

commit 20726853474ad24a26594896977f9c71cd6afc29
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 22:23:51 2009 +0000

    proxy-autodiscovery is not a dhcp option, it's a parameter-request-list entry

commit 7d0f0968bfb801285a17fd75f3cf6a868c89ec99
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 22:20:02 2009 +0000

    can unpack options, and more options have names

commit 8c440da211b7b504c86ce52aedd0d29cda256bad
Author: lskladnik <lskladnik@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 21:26:10 2009 +0000

    Applied some fixes from Impact trunk.

commit 779940396f50dd8aac691e1230cf5928ae6f1063
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 21:09:25 2009 +0000

    unpacking of chaddr's length is now magic :)

commit 410c7008c9ad590bfcaa066eb8778542a9e66856
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 21:06:40 2009 +0000

    propper packing and unpacking of dhcp packets...
    unpacking of chaddr's length is not magic :(

commit 63f1e7351f8f97b37f8adcd8adbdef41d1570de7
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 20:51:49 2009 +0000

    fixed something on the structure for proper unpacking

commit 6cfd19ad51531ded058791c7f840da97b1900ff7
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 20:51:28 2009 +0000

    fixed a bug in calcUnpackSize() for '_' fields
    added some more debug info when .debug != false

commit 20cf2b995e45ec87aacef2ec3af5cdcfe60f5c32
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 20:31:51 2009 +0000

    fixed a bug when unpacking '_' fields

commit 4dccb28bcc52997a91f3011d9fabfd42f0cd2858
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 18:43:29 2009 +0000

    DHCP cheap implementation

commit 72bf82b859b948842c705d295526074166d404ca
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 16:27:38 2009 +0000

    parser for .pcap capture files

commit 2befae75032065e766c69970cbc7ec48c1c8ee4b
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 16:27:29 2009 +0000

    no real changes`

commit 3fa7ba9ba2a0db667a6c174c01e40763c2f82601
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 28 19:55:46 2009 +0000

    an EthernetPacket can have just Data() inside, if this is the case,
    it should not ask the ether_type to the Data(), but instead use what's
    set in itself

commit 76228245df30d855b0c20e38e6fc520f73a9b30c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 28 19:06:19 2009 +0000

    default argument for msg in dump()

commit 979465e306d897f3f28a34d172c989a0455d47b3
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 28 19:06:10 2009 +0000

    bug fix, uuid was set instead of objuuid

commit 41847ccf70b337c31206b7e7a1c1a8da18c68060
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 23 20:43:13 2009 +0000

    added impact compatibility

commit fffd897ec720ee11ca3eff026b682a3ad4d01b9b
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 23 20:02:50 2009 +0000

    fixed ClosedTCPResponder and added it to the list of responders
    
    initial seq number for TCPResponders is now according to the generator

commit 1704aedb569e93458af486e35bb176b75d7bd1bf
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 20 21:17:19 2009 +0000

    # [x] TCP RST data checksum (RD)
    
    I forgot this test before, now we are really done

commit 6f798462f84f2b9a3949697e8f7a5ae784a2d892
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 20 21:16:34 2009 +0000

    small module to compensate crc32

commit 21fde00a304ca7784be72f593eda3c41982a9e2b
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:28:59 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [x] Returned probe IP total length value (RIPL)
    # [x] Returned probe IP ID value (RID)
    # [x] Integrity of returned probe IP checksum value (RIPCK)
    # [x] Integrity of returned probe UDP checksum (RUCK)
    # [x] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct
    
    and we are done!

commit c32a707b4821d6960b93d3b7d37e0374c1ed947a
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:23:49 2009 +0000

    modified a little bit how default options are handlded

commit ed262c24999ca451c0b72da949396685e456eb48
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:23:02 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [x] Returned probe IP total length value (RIPL)
    # [x] Returned probe IP ID value (RID)
    # [x] Integrity of returned probe IP checksum value (RIPCK)
    # [x] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit dae8dc625f9f5b43a17b24f532cf83ec9725fce3
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:18:52 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [x] Returned probe IP total length value (RIPL)
    # [x] Returned probe IP ID value (RID)
    # [x] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit 1f06a057216ba6f881a7520d462889c86b6c8d64
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:05:23 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [x] Returned probe IP total length value (RIPL)
    # [x] Returned probe IP ID value (RID)
    # [ ] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit f51f3777f97f60e40d25d9d97db1b533ab0ff04b
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:03:31 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [x] Returned probe IP total length value (RIPL)
    # [ ] Returned probe IP ID value (RID)
    # [ ] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit 291fdb9ca7a08cc92d26a9ee8a58af24d65b433f
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:00:24 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [ ] Returned probe IP total length value (RIPL)
    # [ ] Returned probe IP ID value (RID)
    # [ ] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit e1b8d774498052bb800a76726e58fce6693bceea
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 19:52:31 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [ ] Unused port unreachable field nonzero (UN)
    # [ ] Returned probe IP total length value (RIPL)
    # [ ] Returned probe IP ID value (RID)
    # [ ] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit 0b62023ac0808c713b114b553a6cd49a13724c1d
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 19:35:16 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [ ] IP total length (IPL)
    # [ ] Unused port unreachable field nonzero (UN)
    # [ ] Returned probe IP total length value (RIPL)
    # [ ] Returned probe IP ID value (RID)
    # [ ] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit f32434874b4f021c91d09970c6ae08aa40449464
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 19:34:48 2009 +0000

    first tests on NMAP2UDPResponder
    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)

commit 8dabad50e2b2cb50760355671e11eac5f22ba3b3
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 18:58:48 2009 +0000

    added UDPResponder, ClosedUDPResponder and OpenUDPResponder... all working :)

commit 3eca8d639abe21d325894c976be0c125c358d442
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 18:43:29 2009 +0000

    initAnswer() --> buildAnswer()

commit 497d95c90b0d8bf18bd80c55641dbf1737a4ac1e
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 18:36:05 2009 +0000

    refactored a little bit:
    
        moved initAnswer() to the top class (Responder) and
        added the logic to initAnswer() -> sendPacket() to Responder.process()
    
        The open ports are now a list of ports, and only Machine knows about it
        Closed ports are not listed, are those not open

commit 1295ddabec5e130e1d4d94af3c86e0a78a3bdc19
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 23:18:07 2009 +0000

    marked a few more things done (they were done before, just not marked)

commit 832d3466ed2d0e1fa83dcc4b9bca208e0609d048
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:59:28 2009 +0000

    not randomizing the delta for stdDev

commit e5e61030944018d3e274151386291847dc18569e
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:52:11 2009 +0000

    # [x] IP ID sequence generation algorithm on ICMP messages (II)
    # [x] Shared IP ID sequence Boolean (SS)

commit c5efeea3751abfba64b03e279b6563c33201ffba
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:28:16 2009 +0000

    # [x] IP Type of Service (TOSI)

commit f34a8edbc5da9c56958287687287e535b8fea1b9
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:19:49 2009 +0000

    # [x] ICMP response code (CD)

commit 7b9e9248270aee95fdb9ff2b8987d68b16242b73
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:08:38 2009 +0000

    # [x] ICMP Sequence number (SI)

commit 23fba4a4d8c056519e0d2bf45af8613508a8f1ee
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:01:52 2009 +0000

    some safe checking on unsupported on IE(DFI) and IE(DLI)
    we should do this on every other option

commit bc9521c8df4ead35b661585f2a175b1818ef6bab
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 21:53:23 2009 +0000

    +# [x] IP Data Length (DLI)

commit d95ae313fd5c0bc7400a8464e71e165c22ef8f64
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 21:49:00 2009 +0000

    # IE()
    # [x] Responsiveness (R)
    # [x] Don't fragment (ICMP) (DFI)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)

commit 31c0a58064441d017cc2be1ab8f25f5e2ef9d8ce
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 21:45:27 2009 +0000

    Improved a lot GCD, ISR and SP emulation!!!
    
    thanks to talking to aureliano we realized that if sequence numbers are
    generated on Timer events, then, the numbers are incremented only at this events
    and it doesn't matter how close we are sampling to the event, so we don't have
    to roung to the closes integer, but rather truncate to the previous

commit 383e915315c45681b70eb4aa6e4b7ee6cc4de7d2
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 19:40:31 2009 +0000

    +# [x] IP ID sequence generation algorithm (TI)
    +#   [x] Z  - All zeros
    +#   [x] RD - Random: It increments at least once by at least 20000.
    +#   [x] RI - Random positive increments. Any (delta_i > 1000, and delta_i % 256 != 0) or (delta_i > 256000 and delta_i % 256 == 0)

commit 5d8ea44b720a92f68b274f2716f2d7335292c8c5
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 19:39:37 2009 +0000

    fixed initial window size. it was fixed 0, and then, it was not hex encoeded

commit 6461e0937fbbbb24fe66a2f1293252a271f61dda
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 19:29:08 2009 +0000

    removed some void __init__()s
    bugfix: making a copy of the fingerprint from the machine, otherwise subsequent changes affect all references to the fingerprint (all SEQn where sharing and changing the same fingerprint)
    changed how test SP (stdDev) is computed and used. Now we are trying adding a random value

commit 08ce67bbe54e9002369d076cf7ba4a19acc3af89
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 19:26:18 2009 +0000

    set_ts_echo() was not working... at all

commit fc404cbd26ed65a40676ba3053ac10c3b833e6dd
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 16:43:44 2009 +0000

     # [ ] IP ID sequence generation algorithm (TI)
     +#   [+] Z  - All zeros
     +#   [+] RD - Random: It increments at least once by at least 20000.
     +#   [-] Hex Value - fixed IP ID
     +#   [+] RI - Random positive increments. Any (delta_i > 1000, and delta_i % 256 != 0) or (delta_i > 256000 and delta_i % 256 == 0)
     +#   [x] BI - Broken increment. All delta_i % 256 = 0 and all delta_i <= 5120.
     +#   [x] I - Incremental. All delta_i < 10
     +#   [x] O - (Ommited, the test does not show in the fingerprint). None of the other
    
    I also added simplifyFinerprints() which simplifies them by leaving only the first option when there are more than one (separated by | in the fingerprint file)

commit b9c705f8af50cfef3307f58f5749ee96a48e96ab
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 16:04:40 2009 +0000

    Added DF, MF and RF to the __str__ of IP packets
    Added ece and cwr to the __str__ of TCP packets

commit 81e730b94183f9dff86a75af4e2811a553033741
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:52:27 2009 +0000

    a few bugs introduced in the latest commit

commit cf55eb8068859f947404759ab639d0f7ff06df4d
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:46:37 2009 +0000

     # All Probes
    +# [|] SEQ
    +# [x] OPS
    +# [x] WIN
    
     # All Tests
    
     # SEQ()
    +# [x] TCP ISN sequence predictability index (SP)
    +# [x] TCP ISN greatest common divisor (GCD)
    +# [x] TCP ISN counter rate (ISR)
     # [ ] IP ID sequence generation algorithm (TI)
    +#   [ ] Z  - All zeros
    +#   [ ] RD - Random: It increments at least once by at least 20000.
    +#   [ ] Hex Value - fixed IP ID
    +#   [ ] RI - Random positive increments. Any (delta_i > 1000, and delta_i % 256 != 0) or (delta_i > 256000 and delta_i % 256 == 0)
    +#   [ ] BI - Broken increment. All delta_i % 256 = 0 and all delta_i <= 5120.
    +#   [ ] I - Incremental. All delta_i < 10
    +#   [ ] O - (Ommited, the test does not show in the fingerprint). None of the other
    +# [x] TCP timestamp option algorithm (TS)
    +#   [x] U - unsupported (don't send TS)
    +#   [x] 0 - Zero
    +#   [x] 1 - 0-5.66 (2 Hz)
    +#   [x] 7 - 70-150 (100 Hz)
    +#   [x] 8 - 150-350 (200 Hz)
    +#   [x]   - avg_freq = sum(TS_diff/time_diff) . round(.5 + math.log(avg_freq)/math.log(2)))
    +#           time_diff = 0.11 segs
     # OPS()
    +# [x] TCP options (O, O1-O6)
     # WIN()
    +# [x] TCP initial window size (W, W1-W6)
     # ECN, T1-T7
    +# [x] TCP options (O, O1-O6)
    +# [x] TCP initial window size (W, W1-W6)
    +# [ ] IP Type of Service (TOSI)
    +# [ ] ICMP Sequence number (SI)
    +# [ ] IP Data Length (DLI)
    +# [ ] ??? (TOS) Type of Service
    +# [ ] ??? (RUL) Length of return UDP packet is correct

commit 8305242cdcfe47d33fd78e3d70211b82d2557f8c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:43:52 2009 +0000

    More complete:
    
    +# All Probes
    +# [ ] SEQ
    +# [ ] OPS
    +# [ ] WIN
    +# [x] T1
    +# [x] T2
    +# [x] T3
    +# [x] T4
    +# [x] T5
    +# [x] T6
    +# [x] T7
    +# [ ] IE
    +# [x] ECN
    +# [ ] U1
    +
    +# All Tests
    +
    +# SEQ()
    +# [ ] TCP ISN sequence predictability index (SP)
    +# [ ] TCP ISN greatest common divisor (GCD)
    +# [ ] TCP ISN counter rate (ISR)
    +# [ ] IP ID sequence generation algorithm (TI)
    +# [ ] IP ID sequence generation algorithm (CI)
    +# [-] IP ID sequence generation algorithm (II)
    +# [ ] Shared IP ID sequence Boolean (SS)
    +# [ ] TCP timestamp option algorithm (TS)
    +# OPS()
    +# [+] TCP options (O, O1-O6)
    +# WIN()
    +# [+] TCP initial window size (W, W1-W6)
    +# ECN, T1-T7
    +# [+] TCP options (O, O1-O6)
    +# [+] TCP initial window size (W, W1-W6)
    +# [x] Responsiveness (R)
    +# [x] IP don't fragment bit (DF)
    +# [x] IP initial time-to-live (T)
    +# [x] IP initial time-to-live guess (TG)
    +# [x] Explicit congestion notification (CC)
    +# [x] TCP miscellaneous quirks (Q)
    +# [x] TCP sequence number (S)
    +# [x] TCP acknowledgment number (A)
    +# [x] TCP flags (F)
    +# [ ] TCP RST data checksum (RD)
    +# IE()
    +# [ ] Responsiveness (R)
    +# [ ] Don't fragment (ICMP) (DFI)
    +# [ ] IP initial time-to-live (T)
    +# [ ] IP initial time-to-live guess (TG)
    +# [ ] ICMP response code (CD)
    +# [ ] ??? (TOSI)
    +# [ ] ??? (SI)
    +# [ ] ??? (DLI)
    +# U1()
    +# [ ] Responsiveness (R)
    +# [ ] IP don't fragment bit (DF)
    +# [ ] IP initial time-to-live (T)
    +# [ ] IP initial time-to-live guess (TG)
    +# [ ] IP total length (IPL)
    +# [ ] Unused port unreachable field nonzero (UN)
    +# [ ] Returned probe IP total length value (RIPL)
    +# [ ] Returned probe IP ID value (RID)
    +# [ ] Integrity of returned probe IP checksum value (RIPCK)
    +# [ ] Integrity of returned probe UDP checksum (RUCK)
    +# [ ] Integrity of returned UDP data (RUD)
    +# [ ] ??? (TOS)
    +# [ ] ??? (RUL)
    +

commit 4cd4227c484e8015ea2eaaeed5aeba8f7128eaa7
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:42:31 2009 +0000

    a bugfix, the this fix was ported to the orignal impact module

commit dab1808ee5fca4b042fe464abb3df39d5ffbdbff
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:40:14 2009 +0000

    This version answers ECN probes, although it's composing answers as
    it will be for any other probe. It still laks a few tests though,
    and all the SEQ(), IE() and U1()

commit 1dbf41b102a43b51b6346bd6f69e54ad8ab1de46
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:38:50 2009 +0000

    nmapAnswreingMachine.py is a tool to impersonate any stack for nmap's -O (OS fingerprint) option. It only supports nmap's second generation fingerprint DB
    
    os_ident.py is a modification of the IMPACT module, we take some classes defining the probe packets from it. We may want to trim this file before releasing

commit e843556daf05270e672418058b31cc4e133fb49e
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 19 16:05:31 2009 +0000

    Fixing a bug reported by Bernd Deichmann <bd@deichmann-edv.de>.
    On some cards, and for some packets, extra data comes after the full packet.
    This fix uses the length in the IP header to cut the payload to its real length

commit b695aeed9526c3cfd5bf54c672ddfb9e3d7cb129
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 1 19:54:40 2008 +0000

    changelong for last commit

commit 0c44c61ea526515943946cc2fea0be000905344a
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 1 19:48:10 2008 +0000

    fix to TCP.get_echo_ts() submitted by Tom Coote

commit 984c3b4d62f9f80dd9f67531e6d64e2ca4167d16
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 3 20:53:08 2006 +0000

    fixed bug in display_time (reported by grutz _at_ jingojango.net)
    cleaned up code using display_time

commit a951dea81b4ea743f7882cf3d29f156b77130f20
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 25 15:33:59 2006 +0000

    fixed setup.py where doc files were installed on usr/bin
    replaced @ in changelog with _at_, as some people are archiving packages on websites were spammers can crawl them

commit 9a2571ef2a09b21aa29ed6356323a1beac5e0b43
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 6 15:54:08 2006 +0000

    __socket changes by buk

commit 43c482ef63a473cfd659ef0aad0bfe210228bf78
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 28 14:57:03 2006 +0000

    fixed syntax error

commit f7196438bee94f3f6f9af23bdbccc225df2be10d
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 23 18:33:29 2006 +0000

    fixed TCP.get_th_sum() bug reported by ranusy@gmail.com

commit 01b882774af2d070d1397077bc41f91168425a71
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 30 15:51:10 2006 +0000

    samr: Python 2.4 raises an exception where python 2.0 didn't. We need to
            catch it
    printer: RawCall() no more, now self.dce.call()

commit 65a98cfef8de4e62123c0e3a4b72b26a106b0330
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 23 22:26:51 2006 +0000

    retabbed

commit 2df6998ef99838e4b5f2bd73e6e8dc36c199613f
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 23 21:19:26 2006 +0000

    copyrights

commit 65be005f641a9e9337aa668122e8e97875388d21
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 22 22:19:58 2006 +0000

    new files aded

commit 01c4a4d45cce4c97c4d4353a6204d050473d41bb
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 22 22:16:38 2006 +0000

    new examples to show newer features

commit 2ce42b2faf6cd602eca47bd8fd4f8d4ca71d7576
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 22 22:16:15 2006 +0000

    Lots of changes.
    SMB rewriten using Structure, added hashes authentication chainable
    commands, lots of commands, etc.
    DCERPC cleaned up, added authentication and encryption, fragmentation
    and more things

commit 2722624bc190069d4da0a4e62c136a665514001c
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 3 15:52:03 2006 +0000

    New release

commit f0bacb04cf69d120d6fc85a77b75218633b2c960
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 3 15:49:23 2006 +0000

    Fixed byte ordering bug when using IP_HDRINCL in BSD systems (patch supplied by ginga@ginganet.org).

commit 83e7538d2bdc2f4568e363c4d958ebd41347cffb
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 3 15:20:34 2006 +0000

    Fixes bug when parsing ARP packets

commit 8c4a96e91e896752636772c9943004e978c9370e
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 21 19:07:55 2005 +0000

    removed old import

commit 5202a11373dc03e683a7d37d4e7a1bfbb09586d0
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 28 21:06:24 2005 +0000

    fixed bug in set_icmp_nextmtu()

commit f90e0848d3d6ffc2ebb44171699c0776e8213a07
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 28 20:41:59 2005 +0000

    fixed icmp unreachable bug

commit 2a1e35ed7421a061fce93d3c215051721e06c526
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 26 20:55:01 2004 +0000

    *** empty log message ***

commit f3c4b05728ed50c863548ff99a01e47b03206c5f
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 26 20:54:45 2004 +0000

    Fixed as_{hrd,pro} methods to not invoke the tolist method, because they were being called with array objects as input, and anyway it wasn't necessary to call that method for what they did.

commit f9c57d8cec1569c56b99fcb4da4e6d5d19d67759
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:27:57 2003 +0000

    Fixed URL

commit 4511c3234966206b2b0ce0596b5be4fbf0d24d21
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:26:31 2003 +0000

    -

commit 890d9bf3e07197b17494e1f24399d2e2911a29c3
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:26:22 2003 +0000

    Bumped version number.

commit 32ba2a07db8f251fb30eb2db05d21ff01fe13cef
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:25:26 2003 +0000

    -

commit eeb648a333040b28beff2c4e4c3715ba3f2c202f
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:23:42 2003 +0000

    Fixed wrong indentation that was causing fragmentation to go wrong.

commit 7dc3c77d4ecf6f90d91a82867b45e18e12df9c87
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 23:42:47 2003 +0000

    Bumped version number.

commit 6d86749f2e6ab3cff8d92a36415978a9729c2bcc
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 23:42:15 2003 +0000

    -

commit f86b8cc26460451cc6d723b47419d5dc8f3b265a
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 23:41:43 2003 +0000

    (DCERPC_v4.bind): support idempotent flag.
    (DCERPC_v4.send): reduced fragment size to avoid IP fragmentation on links with MTU = 1500. Added a method that allows the caller to configure this size.

commit 6d2b1a19aae53d438cbd5c3cbb05485b77705ed5
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 2 22:42:55 2003 +0000

    Updates.

commit faa6d8b3020e4f62e97cbdc532b0f23565e8f2b0
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 2 22:42:48 2003 +0000

    DCERPC_v4.bind: made self.__bind protected
    DCERPC_v4.send: fragment outgoing packets.

commit 4c35168a0e3781430054ee4b6fd7ab5521b7fd39
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 28 15:39:11 2003 +0000

    Include ChangeLog in packet.

commit 37ab5e554ebe47d88cc987012dcddc59038f6147
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 28 15:38:39 2003 +0000

    Initial revision.

commit c19c79f07308e57f65ab7d7009b721c192abbae6
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 28 15:32:56 2003 +0000

    Fixed self.bind variable having the same name than a method.
    Thanks Python for being so stupidily untyped :)

commit 4415e5a3183a85e378336095564377ec567a934f
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 14 21:26:07 2003 +0000

    Properly support Unicode input.

commit 227c6bd63e676f3e9880f9310714ec3e0d34f71c
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 14 21:01:43 2003 +0000

    Bumped version number.

commit 3a02cd9550a0769747ddac039c38fde45999f972
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 14 21:00:56 2003 +0000

    Properly support Unicode.

commit e58c84a2359197b30ba3d289ecbe09d9e0fb5d04
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 31 21:16:50 2003 +0000

    Bumped version to 0.9.3.

commit 5eafe72c26521b087899ab82771bdcdb160d70de
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 31 21:14:21 2003 +0000

    Fixed offset of handle in SVCCTLRespCreateServiceHeader.

commit 6dc9e592612796254188d8a88d863e511ad8aff5
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 21:05:16 2003 +0000

    Bumped version number to 0.9.2.

commit 45883a7afa48292323ea97da8c20dc9bf1707eee
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 21:03:08 2003 +0000

    Initial revision.

commit 611348de29fe4a3c6f9d2cef10b5c602455860bf
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 21:02:20 2003 +0000

    Fixed output formatting.

commit c273b0e33f6395231d69c8ec91a7ae45e571ce06
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 20:52:12 2003 +0000

    Added missing imports.

commit 26fdc3e16117b1b8d3ab2c3578d35dc49d81cf08
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 19:50:38 2003 +0000

    s/from impact/from impacket/

commit 324fb1078105cf2c2353ae4e9d3a42e61a6a507e
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 19:50:29 2003 +0000

    s/from impact/from impacket/.
    Protected socket.settimeout calls within a try/except block.

commit aab39d6c42dd8881248af555ddf44c7732316152
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 19:30:24 2003 +0000

    Initial revision.

commit 7065ab5979b28c5d1631bae361193f187bcf1637
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 18:45:51 2003 +0000

    Added missing imports.

commit 84b82fae4e2c736680630ef0fe9841d7bf29a3f6
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 17:46:46 2003 +0000

    Removed remaining HTML markup.

commit f9882d7bc39547c63ee12714ebe93bfbf72818a1
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 17:46:03 2003 +0000

    Initial revision.

commit cc494bc3d23ab5ce2f86ffe32f27ef3c534ad334
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 17:37:16 2003 +0000

    Bumped version number to 0.9.1.

commit 3402b5675834ee3498be3dd2b8006b5d68923d84
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 17:36:57 2003 +0000

    Changed source license to Apache.

commit 1dba4c20e0d47ec614521e251d072116f75f3ef8
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 17:33:42 2003 +0000

    Added Pysmb license.

commit dd89f918ddb0123fcd5262dbc3b1a1c6138cd90e
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 24 20:21:30 2003 +0000

    Added LICENSE.

commit 28aab9a98188adfde10c6642de2c4ea6afee660e
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 24 20:21:14 2003 +0000

    Added README and LICENSE to the binary distribution.

commit 1e1b77896b50062974fb29c68aa3c06b8c3dcdff
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 24 20:20:38 2003 +0000

    Initial revision.

commit c359ea340099a315d6886f06530268282eccfa17
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 24 17:52:06 2003 +0000

    Global rename from conspired to impacket.

commit a9aef3b4d58c5b41baa50b4fd35b68ba08f28677
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 23 19:26:16 2003 +0000

    Updated to reflect very minor changes in the Pcapy API.

commit 330218aa4ce9557a28f35cb4e96d630e4129cc12
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 23 19:25:49 2003 +0000

    Updated contact info.

commit 4ac639ef9ad58abad029f445a3261a8382a298d6
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 20 22:04:52 2003 +0000

    Added documentation.
    Fixed catch of the mysterious PcapError exception.

commit b9bc816237a9de20a64c0119f1ee5c86ad4ab213
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 20 15:49:43 2003 +0000

    Split pcap capture files into smaller ones, one for each TCP connection found in the original.

commit 2d9bee978cb19f79739597b08d4d593700a9e3a8
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 9 17:50:36 2003 +0000

    Include examples and this very file into source distributions.

commit 60b31ed69f794478c4d8ce3b4d63ef0d7d28d3f8
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 9 17:47:05 2003 +0000

    s/disectors/dissectors/

commit 6d01f6287c209bc1e406b0a03c4ff49520cfed9e
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 9 17:40:37 2003 +0000

    Initial revision
======================: FILES :======================
======================: BRANCHES :======================
======================: LOGINFO :======================
commit 03c5bc63bc8bf98cff84770f1231a0922fcbebab
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 25 09:35:09 2017 -0300

    Giving some hints when target is enforcing SPN validation

commit f0b5b8f6174ba9cfebef66d1bdaab8a776773c61
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 24 16:10:29 2017 -0300

    Be more flexible about the target SPN to use
    
    * When connecting to target systems
    * Also, don't give up if the SMBConnection didn't work, we might be still lucky at the DRSUAPI layer

commit 6a49832e2b8fad4e5238b7d35bc8eb057e31eef8
Author: martin_uy <m@rtin.uy>
Date:   Mon Jan 23 18:56:32 2017 -0300

    In the context of #69:
     * Import missing

commit 37e40a732e5592b43f5678ef8e8bed7ffff66e81
Author: martin_uy <m@rtin.uy>
Date:   Mon Jan 23 18:53:32 2017 -0300

    In the context of Issue #69:
     * IPv6 interface aligned to IPv4 interface.

commit f2d6f634d20cab10db9635e95f2398ba3e65943f
Author: asolino <bethus@gmail.com>
Date:   Fri Jan 20 12:32:03 2017 -0300

    Retrieve the username based on the specific TGT/TGS retrieved from ccache
    
    * In the case where there is more than a single ticket, there could be different client names. Especially if there are tickets with delegation
    * Improved debug info to identify mismatches in the future

commit 4f5154ab2602cf5e9d5da993324def1cd78538d2
Author: asolino <bethus@gmail.com>
Date:   Sun Jan 15 17:03:34 2017 -0300

    Include 'KRB5 - Kerberos 5' OID inside the GSSAPI MechToken
    
    * We were just including the mechTypes, but looks like it is also needed inside the MechToken
    * Windows doesn't care about it, but Samba / NetApp servers do.
    * Should address https://github.com/CoreSecurity/impacket/issues/247

commit fb280b1213b505b5dba4ce6f9099be28cfe489ad
Merge: 1a12a2d a86c480
Author: martin_uy <m@rtin.uy>
Date:   Thu Jan 12 14:24:01 2017 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit 1a12a2d88f3f63c39c765c9fa6373818c50cda00
Author: martin_uy <m@rtin.uy>
Date:   Thu Jan 12 14:23:43 2017 -0300

    In the context of merging pull request #92, we removed the code on UDP decoder that does DHCP decoding based on port numbers. Even though it's a valid heuristic to determine the layer following UDP based on port numbers -and it's going to work in most of the cases, as DHCP services usually run on a well known port that it's not used for any other protocols-, we still want to handle the cases in which those well known ports are used for a different protocol. In this later case, the decoder has to be DataDecoder instead of DHCP Decoder. As a result, is up to the ImpactDecoder client to decide which decoder has to be used for the layers following UDP or TCP, as there is not an unambiguous way of determining that.

commit e978eca9e2b3d455ca73b8291772746e5fa41075
Merge: 0ff281f 9879f1b
Author: martin_uy <m@rtin.uy>
Date:   Thu Jan 12 14:12:43 2017 -0300

    Merge branch 'c0d3z3r0-feature/dhcp'

commit 9879f1b676e0620b4a1b2e95e71e64d29f8290cc
Merge: 0ff281f c8aabf2
Author: martin_uy <m@rtin.uy>
Date:   Thu Jan 12 14:12:19 2017 -0300

    Merge branch 'feature/dhcp' of https://github.com/c0d3z3r0/impacket into c0d3z3r0-feature/dhcp

commit a86c480d64f84ca2b6944068f82119a39e5f049d
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 11 13:24:14 2017 -0300

    Restoring commented structure items
    
    * Problem wasn't padding related (thanks god) for a definition of an EMPTY NDR structure.

commit fc65d6b475c077806493028d6ae4bdd71e321824
Merge: e5b1968 6ca48d5
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 11 12:56:13 2017 -0300

    Merge branch 'martingalloar-virtualenv-friendly'

commit 6ca48d58abafc2816696549f0b06157eda982b1c
Merge: e5b1968 4152e12
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 11 12:55:35 2017 -0300

    Merge branch 'virtualenv-friendly' of https://github.com/martingalloar/impacket into martingalloar-virtualenv-friendly

commit 4152e128b8c1e435f04eb88775c290a86ebf266d
Author: Martin Gallo <mgallo@coresecurity.com>
Date:   Wed Jan 11 12:43:54 2017 -0300

    Replaced shebang with a virtualenv friendly one
    
    Replaced all instances of `#!/usr/bin/python` with `#!/usr/bin/env python` so impacket's examples and scripts can be run inside a virtualenv without having to call python.

commit e5b1968abcf2ed8cad2eef6d38531cc38ad98baa
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 11 12:42:11 2017 -0300

    VARIANT is already a pointer
    
    * Might solve https://github.com/CoreSecurity/impacket/issues/245. Testing needed

commit ea9f61d02ee4bb742313c2b90f6fb8bb7b237266
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 10 23:15:41 2017 -0300

    Quitting MMC when executing a single command from command-line
    
    * mmc.exe was still running at the target server

commit f4596a1b03e28eac4006288d07fd7c0662c29acf
Merge: a0f5bd2 0ff281f
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 10 21:24:23 2017 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit a0f5bd265df61d1ba89901f93435eeb71242f045
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 10 21:23:22 2017 -0300

    Adding mmcexec.py example
    
    A similar approach to wmiexec but executing commands through MMC.
    
    Original discovery by Matt Nelson (@enigma0x3):
    https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/

commit 0ff281f00e2f563a8d5b68ef46ed375067d21fea
Author: martin_uy <m@rtin.uy>
Date:   Tue Jan 10 13:44:24 2017 -0300

    In the context of #244:
    
     * We are now cleaning up open files from the corresponding session structure in SMB3 when disconnecting from a tree.

commit aa1158726b75a74f62f76f8fde674547bd201ad6
Merge: 0ec5c1f 72b5c5c
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 9 15:28:56 2017 -0300

    Merge branch 'contactr2m-smb_com_nt_transact'

commit 72b5c5ce7894caac80539377596efb5cfdb163ed
Author: Rohit Mahamuni <contactr2m@gmail.com>
Date:   Fri Jan 6 13:05:19 2017 -0500

    Add support for SMB_COM_NT_TRANSACT and NT_TRANSACT_QUERY_SECURITY_DESC
    
    [MS-CIFS]: 2.2.4.62.1 SMB_COM_NT_TRANSACT request.
    [MS-CIFS]: 2.2.7.6.1 NT_TRANSACT_QUERY_SECURITY_DESC

commit f78c5e1731ceeafaaa9870a4b1b381e8ad1ddf20
Merge: 268a79a 4c2a5b9
Author: Rohit Mahamuni <contactr2m@gmail.com>
Date:   Fri Jan 6 11:14:50 2017 -0500

    Merge remote-tracking branch 'CoreSecurity/master'

commit 4c2a5b98e54046e3dc65ce5410c35b63f27e4a70
Author: martin_uy <m@rtin.uy>
Date:   Tue Dec 27 13:49:51 2016 -0300

    In the context of #241:
     * The VCNumber field in a SMB_COM_SESSION_SETUP_ANDX binary packet (SMB login standard) is 2 bytes long. Truncate the os.getpid value if greater than 2 bytes.

commit 0ec5c1f0269415f54ff3cacfd6c495377e16b1bd
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 27 10:57:25 2016 -0300

    Adding SMBConnection.close()
    
    * Committing patch by @martinuy
    * Logs off and closes the underlying socket.
    * Should fix https://github.com/CoreSecurity/impacket/issues/227

commit c0610ef0c23cfcadaa8c861bc79089abc4400390
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 26 09:36:07 2016 -0300

    Hexdump for LSA Secrets not printed, if callback set
    
    * Small little trick to verify callback was not set (if there's a better way let me know)
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/240

commit d910f375973d5fff048cd12be720012b6b0a7be4
Merge: 2e9c5c2 ddf172b
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Dec 12 10:24:44 2016 -0300

    Merge pull request #239 from CoreSecurity/dhcpoptions
    
    Adding 'default-url' to the dhcp options list.

commit ddf172bb13ace50794209f0603293b06bae1e127
Author: jgermano <jigermano@gmail.com>
Date:   Mon Dec 12 10:13:39 2016 -0300

    Adding 'default-url' to the dhcp options list. While not defined in any RFC, is assigned by IANA and accepted by, at least, Linux's dhclient.

commit 2e9c5c2f30b5fefb52c3db7f194ec57e7fbc31e6
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 10 15:25:55 2016 -0300

    Adding -csv switch to output format in CSV
    
    * Partially addresses https://github.com/CoreSecurity/impacket/issues/237

commit bf745b0e34124dabb5d1e7a4752160721fc2b06f
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 10 14:58:26 2016 -0300

    Adding PasswordLastSet, USER_DONT_EXPIRE_PASSWORD, USER_ACCOUNT_DISABLED and ScriptPath attributes
    
    * Partially addresses https://github.com/CoreSecurity/impacket/issues/237

commit bf0ecc6ff893c3fe8e84d0d87f9e58e7c2b806d3
Merge: 2681d1f 268a79a
Author: asolino <bethus@gmail.com>
Date:   Sat Dec 10 12:01:47 2016 -0300

    Merge branch 'contactr2m-master'

commit 268a79a6de8c4c0913520793422e65dbd28611b3
Merge: 18e90dc 6a21c7e
Author: Mani <contactr2m@gmail.com>
Date:   Thu Dec 8 14:01:35 2016 -0500

    Merge pull request #2 from contactr2m/#238-test_createdeleteDirectory
    
    Covers test for #238

commit 6a21c7eae2e5d099a4625e0456cc859ad75f23ed
Author: Mani <contactr2m@gmail.com>
Date:   Thu Dec 8 13:45:56 2016 -0500

    Covers test for #238
    
    Test case test_createdeleteDirectory extended to include #238 case.

commit 18e90dcc26c317a742d66edb1ab52d8a7c53a89c
Merge: 2681d1f 6750aae
Author: Mani <contactr2m@gmail.com>
Date:   Thu Dec 8 09:56:39 2016 -0500

    Merge pull request #1 from contactr2m/smb3.rmdir
    
    Implement SMB2_FILE_DISPOSITION_INFO in SMB3.rmdir() method.

commit 6750aae49067d063bc386f1c26fe7a6f538b7936
Author: Mani <contactr2m@gmail.com>
Date:   Thu Dec 8 09:52:23 2016 -0500

    Implement SMB2_FILE_DISPOSITION_INFO in SMB3.rmdir() method.
    
    Right now SMB3.rmdir() does not throw error STATUS_DIRECTORY_NOT_EMPTY when directory to be deleted is not empty.
    Instead it silently continues and returns success.
    Note that if the DELETE_ON_CLOSE flag is specified on a directory with child files or directories, the create operation will succeed, but the delete on close flag will be silently ignored when processing the cleanup IRP and the directory will not be deleted. http://go.microsoft.com/fwlink/?LinkId=140636

commit 2681d1f5de5c6122883a947bc57d431071f0beb5
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 6 12:53:34 2016 -0300

    Parse domain_name and TargetInfoFields based on their offsets and not after the Version field
    
    * This applies to NTLMAuthChallenge.
    * According to [MS-NLMP], Version field: 'A VERSION structure (as defined in section 2.2.2.10) that is populated only when the NTLMSSP_NEGOTIATE_VERSION flag is set in the NegotiateFlags field. This structure is used for debugging purposes only. In normal (non-debugging) protocol messages, it is ignored and does not affect the NTLM message processing.'
    * We found an instance of a server *not* setting the NTLMSSP_NEGOTIATE_VERSION and still having 8 bytes of random data as part of the version field.
    * At the same time [MS-NLMP] also states that: 'The Version field is NOT sent or accessed by Windows NT or Windows 2000. Windows NT and Windows 2000 assume that the Payload field started immediately after TargetInfoBufferOffset. Since all references into the Payload field are by offset from the start of the message (not from the start of the Payload field), Windows NT and Windows 2000 can correctly interpret messages with Version fields.'
    * Hence, we're using the offsets from now on to reference domain_name and TargetInfoFields
    * This should address https://github.com/CoreSecurity/impacket/issues/235

commit 2b61eedc6e2f58da8000faf3d49585273d02eade
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 5 18:32:16 2016 -0300

    Initializing self._Connection['Dialect'] to integer
    
    * Instead of ''. Dialects are numbers in SMB > 2 world.
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/233

commit a446089a3f3dcac393dcfdd2e0b0a71a420ed9be
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 5 09:37:48 2016 -0300

    Don't count on CreditCharge to calculate SequenceWindow, when dialect is SMB 2.0.2
    
    * This should address https://github.com/CoreSecurity/impacket/issues/233, pending testing from the original
    reporter

commit a298662c7bc7afcf342839968d92a0e00e015ae3
Author: asolino <bethus@gmail.com>
Date:   Fri Dec 2 11:36:53 2016 -0300

    Don't send a SMB2_NEGOTIATE packet if we already know the server's chosen dialect
    
    * Only sends it again if we receive a SMB2_DIALECT_WILDCARD dialect.
    * This hopefuly addresses the situation where the target server supports a single SMB2+ dialect so it doesn't need to return SMB2_DIALECT_WILDCARD. I think this would only happen for those SMB Servers that only support SMB2_DIALECT_002 (not entirely sure tho).
    * This should address a part of https://github.com/CoreSecurity/impacket/issues/233.

commit 38f7bac1fcb3a91eb3571566ea1ffca6d518fbc7
Merge: 563b757 72f3a7c
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 24 14:11:44 2016 -0300

    Merge branch 'fox-it-ntlmrelayx'

commit 72f3a7c974f8e4868a07908c3b2bdafd1ec6ea84
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Nov 23 15:39:51 2016 +0100

    ntlmrelayx - relaying to IMAP

commit 563b757fba3af32655941edf5a35343300b173b2
Merge: 990e80b ab584ee
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Nov 21 13:25:11 2016 -0300

    Merge pull request #231 from fox-it/ntlmrelayx
    
    Fix ntlmrelayx httprelayclient to support HTTPS urls

commit ab584ee81df86d17027f2d429b732205fd934793
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Mon Nov 21 17:01:35 2016 +0100

    Fix httpclient to support HTTPS urls

commit 990e80b065688002de8ffb0b977a4bffd304c003
Author: asolino <bethus@gmail.com>
Date:   Wed Nov 16 14:13:59 2016 -0300

    When processing a WCHAR_ARRAY, add support for unichr()
    
    * In case we find Unicode chars
    * Might help solving https://github.com/CoreSecurity/impacket/issues/154

commit 2bc68df37e5689deb2c46c9d47c37011c49e714d
Merge: 07e2377 43dde14
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Nov 16 12:42:52 2016 -0300

    Merge pull request #229 from fox-it/ntlmrelayx
    
    Ntlmrelayx bugfixes

commit 43dde14fd126b615516fd13956f66bd18500f4c4
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Nov 16 16:40:11 2016 +0100

    ntlmrelayx compatibility with ldap3 v2 and newer

commit 0da9b84f9f8935271b35a0e12e1d04b868e55ae4
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Wed Nov 16 13:06:16 2016 +0100

    LDAP attack improvements

commit 07e2377c790da8180ecafd1bdff9cb735d6c0a6c
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 24 21:42:16 2016 -0300

    Adding -user-status support for DRSUAPI mode
    
    * Completes what was done at https://github.com/CoreSecurity/impacket/pull/222

commit 6c44e5bdd4dd3299c8966de6a7b57e019ccca1fd
Merge: d62efb7 036e5bd
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 24 21:21:07 2016 -0300

    Merge branch 'shab4z-master'

commit 036e5bd77852eb2b4152eb463eddc5e2b2bfd11d
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 24 21:19:24 2016 -0300

    Adding a -user-status display option
    
    * Changing the (current-disabled) to (status=Enabled/Disabled)
    * Moving that data to the end of the line, in alignment to the pwd-last-set display option
    * Only supportted in VSS mode. DRSUAPI coming soon

commit 5aab86a05918cbcbf8fcd5204a11e425693e0e52
Author: Slim MERIAH <smeriah@lexsi.com>
Date:   Mon Oct 24 13:52:24 2016 +0200

    Little check for enabled/disabled users.

commit d62efb7c8c87c9393caf33877e1cd9d21732e5f5
Merge: 2485f16 9c94160
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Oct 20 16:18:30 2016 -0300

    Merge pull request #220 from the-useless-one/ldap_utf8
    
    Don't try to encode the LDAP filter if it's already in unicode

commit 2485f164fd67ebf957df7082f4ad50f5018c807d
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 19 13:34:43 2016 -0300

    Fixes anonymous connection flags.
    
    * We shouldn't specify we're sending username / password when we're not.

commit 8cef002928ca52be4e9476a87a54d836b5efa81e
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 18 15:22:21 2016 -0300

    Adding MQTT basic structures and example
    
    * Minimalistic MQTT implementation, just focused on connecting, subscribing and publishing
      basic messages on topics.
    * Simple MQTT example aimed at playing with different login options. Can be converted into
      a account/password brute forcer quite easily.

commit 9c94160fac1c2547aa92e8553efe89247999a5a8
Author: Yannick MÃ©heut <yannick@meheut.org>
Date:   Wed Oct 12 11:50:49 2016 +0200

    If the ldap filter is already in UTF8, leave it as is

commit f35117e184438e747c0ba372ea3ef8f41d9a5d73
Merge: 10b94e4 40e6471
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 7 10:11:02 2016 -0300

    Merge branch 'fox-it-ntlmrelayx-interactive'

commit 40e6471434f849fcbab769a668a8ff5cb45fa068
Author: Dirk-jan <dirkjan@sanoweb.nl>
Date:   Thu Oct 6 22:33:12 2016 +0200

    Added interactive SMB console via local socket

commit 13843229ab90236742124330c72fd931cb5d06b8
Merge: 9739ade 10b94e4
Author: Dirk-jan <dirkjan@sanoweb.nl>
Date:   Thu Oct 6 19:15:29 2016 +0200

    Merge branch 'master' of github.com:CoreSecurity/impacket into ntlmrelayx-interactive

commit 10b94e4e20570a168e2e60c9b91e3a454de69a23
Merge: 0afacbe dadc4eb
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Oct 5 11:19:09 2016 -0300

    Merge pull request #218 from Gifts/master
    
    Small fixes for NTLMRelayX http client module

commit dadc4ebc227f1ad976730bbe3dbbab6dda2437e1
Author: Gifts <giftsungiv3n@gmail.com>
Date:   Wed Oct 5 16:52:27 2016 +0300

    Fix parsing NTLM challenge when multiple WWW-Authenticate headers are sent

commit f5a59ac408c683409a1db6ded51c3b92dafc338e
Author: Gifts <giftsungiv3n@gmail.com>
Date:   Wed Oct 5 16:29:35 2016 +0300

    Fix paths with multiple "/" in them

commit 0afacbea5a13f3bf5fb9e860ab3d3c712ef8a315
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 4 19:58:43 2016 -0300

    Adding GetADUsers.py example script
    
    This script will gather data about the domain's users and their corresponding email addresses. It will also
    include some extra information about last logon and last password set attributes.
    You can enable or disable the the attributes shown in the final table by changing the values in line 184 and
    headers in line 190.
    If no entries are returned that means users don't have email addresses specified.

commit c1e5842c2105490a5c9f763a700cd4b8e87274ec
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 4 16:04:51 2016 -0300

    Fixes NTLM anonymous issue authentication against W2k3
    
    * It might solve https://github.com/CoreSecurity/impacket/issues/216, although not sure yet since I cannot reproduce the full issue (I still get ACCESS_DENIED after anonymous login)

commit 9739ade5747018b45a9ffe425374d8d620fa4dde
Author: Dirk-jan <dirkjan@sanoweb.nl>
Date:   Mon Oct 3 21:26:00 2016 +0200

    Some more leftovers

commit 8af1ed5715756cfbd2ec6b81c12e1b87dc7b524b
Author: Dirk-jan <dirkjan@sanoweb.nl>
Date:   Mon Oct 3 21:22:38 2016 +0200

    Fix legacy config inconsistencies

commit f9652789d405557c782a1fd7c31add6b526c5c7d
Merge: bcd75b0 42165dd
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 21 20:06:10 2016 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit bcd75b080edcbf090ac95e8b96d73d4f2d52dd7f
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 21 20:04:33 2016 -0300

    Attempting to address situations where TSO (TCP segmentation offload) is present
    
    * I'm not entirely sure this is the right approach to solve this use case. Testing needed.

commit 42165ddee85832810ff3fc282ac8aa4560b0e3a5
Merge: 0c8e792 66e28da
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 21 15:23:54 2016 -0300

    Merge pull request #209 from blark/master
    
    Update ntlmrelayx.py to fix domain dump bug

commit 66e28da76f4c022e518ffc3274d2969a05e998ee
Author: blark <info@baseggio.ca>
Date:   Wed Sep 21 14:22:29 2016 -0400

    Update ntlmrelayx.py to fix domain dump bug
    
    The boolean `dumpedDomain` was being assigned after the completion of a domain dump. This can take quite some time on a large domain, meaning that every time a new request is processed the domain dump starts again (until the first dump is finished). This minor tweak should fix that.

commit 0c8e7926d1474f18d653cad543ded6917cd37394
Merge: 5227974 81ffe50
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 21 15:21:18 2016 -0300

    Merge pull request #208 from blark/master
    
    Updated requirements section

commit 81ffe50cbecf64c165fb8a264dec2cb2420578ae
Author: blark <info@baseggio.ca>
Date:   Wed Sep 21 14:17:13 2016 -0400

    Updated requirements section
    
    Added ntlmrelayx requirements and tweaked lines to match style

commit 52279744e8bf9c5895fc3339dc8fa4541840f45b
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 21 11:13:53 2016 -0300

    Fixing typo with PCAP MAGIC and Structure

commit 0e68c7ecc37c7b702168db75fcf6f1f041ca9e43
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 20:11:15 2016 -0300

    Honoring SMBConnection.myName parameter when doing NTLM handshake
    
    * If you create a SMBConnection object and specify a myName parameter, it will be populated in the NTLM_AUTH_MESSAGE
    * However, it will NOT be sent in the NTLM_NEGOTIATE message since modern Windows clients don't populated that information.
    * DCERPC connection are not yet supported
    * Partially addresses https://github.com/CoreSecurity/impacket/issues/207

commit d2cbe3c2606bd16e628858baae6483e8dd48ed3c
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 14:40:30 2016 -0300

    Adding code to handle IGMP packet
    
    * Applying patch from @nixotic
    * Addresses https://github.com/CoreSecurity/impacket/issues/30

commit bc05ee3522af7854400b00df40d421a0838a9a59
Merge: 7694e67 db8d291
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 14:28:20 2016 -0300

    Merge branch 'xelphene-master'

commit db8d291490e77685dd7abcd06f4b99dbf5c0feb9
Merge: 7694e67 8dbf234
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 14:25:14 2016 -0300

    Merge branch 'master' of https://github.com/xelphene/impacket into xelphene-master

commit 7694e67a9fab4de3cfb13b6924718d69af8e2979
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 10:26:11 2016 -0300

    Minor cosmetic changes

commit 42b447229fe9ed887d91d75df17c57f422963e24
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 19 09:55:16 2016 -0300

    Checking password field is not None when calling getNTLMSSPType3
    
    * If so, we convert it to '', hoping hashes were provided.
    * Indirectly addresses https://github.com/CoreSecurity/impacket/issues/206

commit 8dbf234ba38030e2914379015db743ac828a2bb3
Merge: 0de3c24 c049506
Author: Steve Benson <steve@xelphene.net>
Date:   Fri Sep 16 00:11:12 2016 -0400

    Merge https://github.com/CoreSecurity/impacket
    
    Conflicts:
            examples/wmiexec.py

commit 0de3c24e058c36a2db8173da94be3af88f0fdfca
Author: Steve Benson <steve@xelphene.net>
Date:   Wed Sep 14 06:59:48 2016 -0400

    Added a -A option to load credentials from an smbclient/mount.cifs style
    authentication file.

commit c049506e43ffa4c76dca7c676822ada7182f8288
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 13 23:54:50 2016 -0300

    Minor cosmetic changes

commit 01b0ae8e936ec4ead94fbd55d739603fd6f46f34
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 13 23:15:23 2016 -0300

    Better error control
    
    * We should re-write ServiceInstall tho.. It's kind of messy

commit d103ea7d0e50c7096d4f038d90d9162e302636b4
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 13 22:06:12 2016 -0300

    Removing uneccesary imports

commit a483bfbca950e1b205543fd28452b0cc5e68bb2c
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 12:00:31 2016 -0300

    Printing NTLM hashes as we get them and we keep the rest to the end
    
    * Basically NTLM Hashes printed as they come
    * Kerberos keys and cleartext password as printed after the NTLM hashes
    * Aimed at making the output more readable

commit d2e4aacf477387a2a3efb4ee359aecf79505e1ee
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 11:32:39 2016 -0300

    Adjusting variables to the naming convention already used

commit 473f3f107582347fd4df82d736ad68e5d71c88e6
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 11:17:57 2016 -0300

    Importing classes from the library instead of the example
    
    * In case the example's not present

commit e79b5e26cf387e94a50c1d51c9a65b5e11895870
Merge: 3e194c6 372b7e2
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 11:06:28 2016 -0300

    Merge branch 'martinuy-secrets_dump_refactoring'

commit 372b7e25749464785f2488c1a41323c30d0e3893
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 11:04:22 2016 -0300

    No need to convert argument to string
    
    * In fact it might trigger an exception when dealing with Unicode strings (e.g. an user with non ASCII chars)

commit b4c819b99f758419f13884a72d6ad15c96b9c1f3
Merge: 3e194c6 8701c37
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 9 10:41:12 2016 -0300

    Merge branch 'secrets_dump_refactoring' of https://github.com/martinuy/impacket into martinuy-secrets_dump_refactoring

commit 8701c37bb09e491e2264ad3664be367dd4cedb3d
Author: martin_uy <m@rtin.uy>
Date:   Fri Sep 9 10:22:24 2016 -0300

    Resources cleanup (files closing) when dumping NTDS hashes.

commit 1ca14b97f478789ea2405946022fab6f9bd31f5a
Author: martin_uy <m@rtin.uy>
Date:   Fri Sep 9 10:12:44 2016 -0300

    Constant replacement.

commit 5819161f6846d3cbd8295d81373f014bd1b0ab84
Author: martin_uy <m@rtin.uy>
Date:   Thu Sep 8 21:10:18 2016 -0300

    A callback per secret was added to extract information out of Secrets Dump library component. A "print" default callback keeps the previous behaviour by default.

commit 3e194c6540d41f7d231e0de28f305572cae541f7
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 8 11:52:00 2016 -0300

    Removing references to deprecated SMBBackwardCompatibilityTransport class
    
    * Fixes https://github.com/CoreSecurity/impacket/issues/203

commit 87dd64e4da23ee9af838ef181f591b2309003ede
Author: martin_uy <m@rtin.uy>
Date:   Thu Sep 8 11:09:49 2016 -0300

    Secrets Dump library component is now using the Impacket's logging idiom.

commit 3d4944afc76a145643595d4f825e247ed8ee0ba8
Author: martin_uy <m@rtin.uy>
Date:   Wed Sep 7 20:45:48 2016 -0300

    Secrets Dump example split into 2 components. Secrets extraction component moved to Impacket library as an example. Command line interface component remains out of Impacket library.

commit c8aabf2810857032c2f944edfb8ca931ecf3889a
Author: Michael Niewoehner <mniewoeh@stud.hs-offenburg.de>
Date:   Thu Sep 17 15:52:12 2015 +0200

    Adding Decoders for BOOTP and DHCP

commit 2a4195d416aa67771bbe27aec629076bfe1e0253
Merge: 609ddf3 488fddd
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 7 12:54:20 2016 -0300

    Merge pull request #89 from DiGMi/master
    
    Adding ERP and Country elements to Beacon

commit 609ddf3e5626ec32e42ba8826ed4bb8b7d7955a3
Merge: ce72d09 a934c89
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Sep 7 12:51:55 2016 -0300

    Merge pull request #91 from c0d3z3r0/feature/eap
    
    Add EAPOLDecoder to EthDecoder

commit ce72d09cbce787839584b2566cf9d6323048872e
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 6 17:49:00 2016 -0300

    Minor class refactor
    
    * Created LocalOperations class to encapsulate some offline registry specific operations.
    * Now DumpSecrets is cleaner, and just handles the instances created based on the scripts parameters set by the user

commit bac6ad7f50ffe894d64055b4fc1eeff48051b059
Merge: 7801e11 3221e34
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Sep 6 12:27:42 2016 -0300

    Merge pull request #202 from fox-it/ntlmrelay-fixes
    
    ntlmrelayx improvements

commit 3221e34440e2ab09f46baa3005f1c923a66983f0
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Sep 6 16:50:11 2016 +0200

    ntlmrelayx improvements

commit 7801e11d9906e105f0ec369cf0fe88f5d131afc5
Merge: af697dc 0325289
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 5 12:27:44 2016 -0300

    Merge branch 'kacpern-ldap-dev'

commit 0325289b45feb28d7cbc21324dda14945c202c27
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Mon Sep 5 17:24:09 2016 +1000

    changed default classes to a mixin

commit df5b231da10ff84a506905d442256e987d7103ef
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Mon Sep 5 15:16:38 2016 +1000

    minor changes and refactoring
    * slightly changed search method definition
    * added pretty printing of control values

commit a934c89ea2badc89f8c5e5175a49e6e199cf36a6
Author: Michael Niewoehner <mniewoeh@stud.hs-offenburg.de>
Date:   Wed Sep 16 10:21:16 2015 +0200

    Add EAPOLDecoder to EthDecoder to get the decoded EAPOL packet from child()

commit d63ff2368791e415aca73922174b9a762157c32c
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Fri Sep 2 10:42:21 2016 +1000

    reverted str.format() to %s
    reverted str.decode() to unhexlify()
    fixed my primitive obsession
    additional refactoring

commit 7799329097a2b825ca75e3ebe4223ce74c9a4478
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Sep 1 15:13:10 2016 +1000

    formatting fix

commit da8c405e008a358aa6514bd317602b5f1dc7bc63
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Sep 1 15:00:15 2016 +1000

    rudimentary checks for simple authentication

commit c652c0f7a733861784bd6cfbd90d9deebaa7e999
Merge: 8aba596 af697dc
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Sep 1 14:26:52 2016 +1000

    Merge branch 'master' into ldap-dev

commit 8aba596bf329e87a7260deafec012dc2fdcad77f
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 31 16:13:49 2016 +1000

    working on ldap and ldapasn1 cleanup

commit af697dcf9550684f05f6ea50037910a825c8bc10
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 29 11:57:31 2016 -0300

    Avoiding infinite loop when opening some ESE databases
    
    * We're giving up if FirstAvailablePageTag is <=1 (as opposed to just == 1)
    * Fixes https://github.com/CoreSecurity/impacket/issues/199

commit db125046eda94f75051a28ef83fce24b5ca98bd5
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 25 21:32:51 2016 -0300

    Adding Author Attribution
    
    * Based on the amount of code committed on those files.

commit 6ecaa8a7bcb065f6f7ffc007e9dda2705aa6baeb
Merge: fc4d2a1 81fe930
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Aug 25 21:13:22 2016 -0300

    Merge pull request #197 from kacpern/ldap-approxmatch
    
    pretty handling of unsolicited notifications

commit 81fe930ea69a237a109268da58e2ef49319ace30
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Fri Aug 26 10:08:34 2016 +1000

    implemented handling of nnsolicited notification

commit fc4d2a15d35cb06a1949f1ce95c01a96f9d289a5
Merge: 311b5ba be48469
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Aug 25 21:05:52 2016 -0300

    Merge pull request #196 from kacpern/ldap-approxmatch
    
    fix tagSet for approxMatch (#195)

commit 311b5ba09454098c6a3441aa082e05269ea1ef03
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 25 14:04:51 2016 -0300

    Removing unused imports
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/187

commit be48469e18efa39b8a1b911029bca159aa1b3fca
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 25 18:57:44 2016 +1000

    implemented handling of nnsolicited notification

commit b4808fcca418b66395edb830e86492767c06f1bd
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 25 18:56:36 2016 +1000

    implemented handling of nnsolicited notification

commit c523e9462932190139d3067d20ba3c9f1959f2ef
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 25 18:25:11 2016 +1000

    formatting

commit bed4b2db64e804dbfb14c04169903e48e49a2cbc
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 25 18:13:28 2016 +1000

    * fix tagSet for approxMatch (#195)
    * add extendedResult to ldapasn1
    * add fix for AD nonconformity with RFC

commit 8af9271f656b6d420466f8bcaec8b81253388340
Merge: da6086a db48476
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Aug 24 09:46:39 2016 -0300

    Merge pull request #194 from kacpern/ldap-paging
    
    changing names

commit db48476f523a2f7509f2736cd16bb564bd4d5663
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 24 16:21:25 2016 +1000

    fixing bad names

commit 3484373aca5fceb2866b1ea455678e04c5b02533
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 24 16:18:30 2016 +1000

    fixing bad names

commit ecccf3b26bfa71ddca6dad6e84beb50866dd4a55
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 24 16:13:40 2016 +1000

    fixing bad names

commit da6086a4a40e7349c36300496d56493ebdff696f
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 23 12:55:50 2016 -0300

    Removing unused code
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/187

commit b8ef63da351cc24e812624e1294d930f89b3578c
Merge: f330e78 0c9b64a
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 23 11:48:31 2016 -0300

    Merge branch 'kacpern-ldap-paging'

commit 0c9b64a592ceb01925af1d3cca8a05301724bfac
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 23:27:21 2016 +1000

    ready to merge. please test. take 2.

commit 402f334984a01d75d07b495afd49335eb453eca6
Merge: f8dd738 bace3f1
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 23:23:44 2016 +1000

    Merge remote-tracking branch 'origin/ldap-paging' into ldap-paging
    
    # Conflicts:
    #       impacket/ldap/ldap.py

commit f8dd738c9749244d0f37e493cb43641a79f86eb4
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 23:17:22 2016 +1000

    ready to merge. please test.

commit bace3f176aa10dec567482a8fe5dc877791b0290
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 23:17:22 2016 +1000

    ready to merge. please test.

commit 4f0bef666ba35ffe1fbf277d5d0b2901a4b1a901
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 22:55:48 2016 +1000

    minor changes

commit 557944359e169c8144e3bfbcaa738baca6692a89
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 17:48:15 2016 +1000

    changed control handling code to accommodate the fact that some controls can have different controlTypes for request and response

commit 090bc35e86d7910f0ebae6209457235de5bf9ef8
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 17:00:33 2016 +1000

    removed unused variable

commit 92e34128669f219269a6b8bb2a1fa7b10af2cade
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 16:24:09 2016 +1000

    fixed broken logic (could have impact if new controls are implemented in the future)

commit 7069281cb7328d2508c8edd178d74d0ff87c18c4
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:50:16 2016 +1000

    fixed a dangling break

commit 34da4acc5a9c9dabbfb7415bb69a76a4a7a59a56
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:48:59 2016 +1000

    removed unneeded enumerate

commit f0c1b016c9b6d4d03a3c1226eefe6606594affcc
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:34:19 2016 +1000

    changed tagFormat in Controls()

commit 50258a8b77f9b68d647c7c7ccaa2715c1c6d9c60
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:26:52 2016 +1000

    removed unused imports

commit 46507c703e95050497cb7938a8392f06d0d31e7d
Merge: c25a8b5 f330e78
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:25:28 2016 +1000

    Merge branch 'master' into ldap-paging

commit c25a8b5b93047f14945c6f3426b1ebd4b58d801f
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Tue Aug 23 15:19:25 2016 +1000

    added simple paging support
    changed defualt search filter to '(objectClass=*)'
    changed decoder to BER
    added extra non-capturing group in NUM_OID
    removed manualFilter in search as _parseFilter should deal with anything now, just use the string version of your filter in the call

commit f330e78bb2f94b503b3a0e887c0b6cbb96489f5b
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 22 09:20:49 2016 -0300

    Adjusting those fields where a default value is predefined
    
    * Also, changing ASN1 encoding from DER to BER
    * Linked to https://github.com/CoreSecurity/impacket/issues/190#issuecomment-241341614 discussions

commit 1630821cae97eb4905b64aa629a0bc0a7ef9b5c2
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Sat Aug 20 14:19:23 2016 +1000

    changing code for consistency

commit cee61cd53298930a43a1ed2e423d9b15826cb28c
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 18 10:04:45 2016 -0300

    Getting rid of manual search filters and using just strings
    
    * Way easier after @kacpern awesome PR!

commit 8ea9ebc2d05d4f76b656fa7a2d60dcd74e15f7dd
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 18 09:56:45 2016 -0300

    Adding manualFilter parameter to LDAPConnection.search() in order to mantain a way to specify directly Filter objects to be used when searching.
    
    * Will make transition easier for those projects used to the former search API.

commit 8efc4a2f7e7196b0c5fe63d996fcbebe290f28df
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 18 17:24:50 2016 +1000

    minor fix in regular expression

commit e2379346a0ddc2a2217c7ef292c7d8dc2cda12e8
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Thu Aug 18 16:40:21 2016 +1000

    added extensibleMatch string filter parsing

commit 427ad258cf45c767015ff0e92e7fe33aacecf780
Merge: d17cf6f 01b7762
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 17 10:48:30 2016 -0300

    Merge branch 'kacpern-ldap-filter'

commit 01b776231ad7bdf1c1a801e93214caddd4a3078e
Merge: d17cf6f 6989a3c
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 17 09:19:59 2016 -0300

    Merge branch 'ldap-filter' of https://github.com/kacpern/impacket into kacpern-ldap-filter

commit 6989a3cb41e002233435c37417fbd50e6c2a7a9e
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 17:57:38 2016 +1000

    minor fix

commit b6f25451abb5e858cdeb34120b83089ae4784802
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 17:52:54 2016 +1000

    minor changes

commit 519bda4bf0b1a1721a9711e11ae9c80ebb742829
Merge: 92682d7 b1502a3
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 17:52:22 2016 +1000

    Merge remote-tracking branch 'origin/ldap-filter' into ldap-filter
    
    # Conflicts:
    #       impacket/ldap/ldap.py

commit 92682d777fae189d008fbc9fc130effe438af5fa
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 17:47:46 2016 +1000

    fixed 'not' filter

commit b1502a32738e6ed7ae76206d3b0146f832298c82
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 17:47:46 2016 +1000

    fixed 'not' filter

commit c4eda9d91e9ce07c15ab49905d13b3457e188ede
Author: Kacper Nowak <kacper.p.nowak@gmail.com>
Date:   Wed Aug 17 12:35:49 2016 +1000

    added parsing of ldap text filters into a Filter() object

commit d17cf6f587718c794afe229e10bbb72560fb1c79
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 12 23:09:57 2016 -0500

    Forgot to restore to its original state

commit f8ed7640afd74259fa5079a4db612e35a3bc5103
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 12 23:08:31 2016 -0500

    Minor cosmetic changes
    
    * Mainly variable renaming so it's easier to understand their meaning
    * Further testing is needed since I can't make it work the attack part. It gets stuck when searching the target LDAP

commit bf4dc4f6ed28e16727a283582e2ba7cf714a5392
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 12 11:10:50 2016 -0700

    Adding -duration parameter
    
    * By default ticket is valid for 10 years, you can change that now

commit 90a91045139659d83409af1771dcaf697c00de99
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 11 21:29:40 2016 -0700

    Whenever there's an exception triggered when searching the PEK we skip the row
    
    * Hopefully addresses a privately reported issue

commit 8c45d98bba08503088405c00cde9f2dc1f30d5a7
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 11 21:24:02 2016 -0700

    Adding MSSQLAttack() class.
    
    * Now you can specify a SQL statement to be executed after a successful relay is done
    * Addresses a part of https://github.com/CoreSecurity/impacket/issues/188

commit a37d352c0b7fc2fd416d2723f84400a05498bf4f
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 10 22:27:52 2016 -0700

    Customizing some code

commit 4a10ef4603308ce1bc1d9b9cf7d1fb7eb14a86d4
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 10 19:56:52 2016 -0700

    Removing -save option. Saves ticket to disk by default
    
    * Can't find a use case where we would not want this

commit 007c50e871bd55c2e029fa507247404ede5a8415
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 10 19:50:36 2016 -0700

    Adding help examples

commit 5812bee6f60b1cf4aecad46d304c197ef7e7b051
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 10 19:22:18 2016 -0700

    This script will create TGT/TGS tickets from scratch or based on a template (legally requested from the KDC)
    allowing you to customize some of the parameters set inside the PAC_LOGON_INFO structure, in particular the
    groups, extrasids, etc.
    Tickets duration is fixed to 10 years from now (although you can manually change it)

commit bfeb31ab7eab58c3f47392b587b794d4d4ada783
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 7 23:19:22 2016 -0700

    Changing PAC_SIGNATURE_DATA['SignatureType'] type allowing negative numbers

commit fea99f7493030ec76b1b9cb260b715ba4b5bcd12
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 7 22:46:14 2016 -0700

    Adding [MS-KILE] 3.1.5.9 Key Usage Numbers constants

commit 053cb994d683d9cc8a4228a2662ab58e420fae2b
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 2 10:28:38 2016 -0300

    Removing PAC structures and using the ones located in the library
    
    * Now located at impacket.krb5.pac

commit 4e56a32350076759b03ffaa34fbdc541f8da7f5e
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 2 10:25:23 2016 -0300

    Adding [MS-PAC] implementation into the library
    
    * Too many examples already using it, simpler to have it in a single place

commit 5d6879242b46d06095694ff2cee891b2379311f0
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 2 09:42:02 2016 -0300

    Adding the enumerateMethods() helper function
    
    * If you pass a IDispatch derived interface, it will return a dictionary with the methods and parameters supported by the interface

commit 002d4c33ec94c22017ce7411bcefa00f94131b3c
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 30 15:32:36 2016 -0300

    When a NDRUNION doesn't have any items we still need to return the bytes processed

commit 07723c6f124e087ea0c2f36ce18b3cbc568bf3b8
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 28 15:20:48 2016 -0300

    Adding HKEY_CLASSES_ROOT query support

commit 5a3ae389099a046ffc93daf657ec4e2499636e59
Merge: 801a54a 6b579a4
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Jul 27 09:06:03 2016 -0300

    Merge pull request #185 from real-datagram/master
    
    139 support added (lookupsid)

commit 6b579a488a98fda670c249741ea0c3a7e58dc261
Author: dg <datagram.locks@gmail.com>
Date:   Tue Jul 26 15:41:31 2016 -0700

    139 support added

commit 801a54a6aa94ec32fc38422dc516875cb6e8fae0
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 26 16:03:34 2016 -0300

    Fixed typo

commit a50fdda283f6e4bf906a2076d191ab870869c9a5
Merge: 4a26102 01cb24d
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jul 26 15:57:03 2016 -0300

    Merge pull request #184 from real-datagram/master
    
    port 139 updates and SMBTransport rewrite (samrdump)

commit 01cb24da0e815e894c3b7953319a8ae81bce24cc
Author: dg <datagram.locks@gmail.com>
Date:   Mon Jul 25 17:21:20 2016 -0700

    removed extra comments

commit 2bc0b7aaa4b29c806eb2f6c185e8ab6e4fa384bd
Author: dg <datagram.locks@gmail.com>
Date:   Mon Jul 25 17:19:38 2016 -0700

    139 support added

commit ed0a6a4ada866277dfef6d3f1d9bd7f7ef082c0a
Author: dg <datagram.locks@gmail.com>
Date:   Mon Jul 25 16:12:03 2016 -0700

    tab vs spaces typo

commit 75344b0c74a59204fdfd21064b6f2986d8ae5db0
Author: dg <datagram.locks@gmail.com>
Date:   Mon Jul 25 16:08:54 2016 -0700

    port 139 updates and SMBTransport call to generic DCERPCTransportFactory constructor

commit 4a261022f078983c6d016a23c545dad803764877
Merge: c7f66e6 3c1959c
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Jul 25 17:04:17 2016 -0300

    Merge pull request #182 from real-datagram/master
    
    added port 139 support and related options (smbexec)

commit 3c1959ceda0c00e402820fd875cd9e3515d87686
Author: dg <datagram.locks@gmail.com>
Date:   Mon Jul 25 12:36:33 2016 -0700

    added port 139 support and related options

commit c7f66e6793a4a99b70fd0ac2155b7022b5ad8c10
Merge: ee30e66 5835f61
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 19 14:50:47 2016 -0300

    Merge branch 'real-datagram-master'

commit 5835f61c2d7d7e630c95ea1614d088d12fae9b18
Author: dg <datagram.locks@gmail.com>
Date:   Tue Jul 19 10:13:27 2016 -0700

    added port 139 support and related options

commit ee30e662d3189f239cde8491d18eda39a53e815c
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 18 14:02:40 2016 -0300

    Fixing typo

commit 4f792fb9f1457af302727a06da783208562fb25f
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 18 13:58:23 2016 -0300

    Adding -request-user parameter
    
    * Requests TGS for the SPN associated to the user specified (just the username, no domain needed)
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/178

commit 7c144867073a279d3e2c6fb878383d1d16c8b97b
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 18 12:15:33 2016 -0300

    Replacing ':' for other character when building the JtR output
    
    * If we don't replace ':' JtR gets confused.
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/179

commit 5ae1231c4d4a01492484d3f2c9ad0dc068fd066f
Author: asolino <bethus@gmail.com>
Date:   Sun Jul 17 19:37:46 2016 -0300

    Adding query -ve parameter
    
    * Queries for the default value or empty value name
    * Some code correction

commit 24c4921a2d7051b9d9cff76ef03f6074a347e572
Author: asolino <bethus@gmail.com>
Date:   Sun Jul 17 18:34:03 2016 -0300

    Minor fix in name_registration_request and updated test cases

commit e351505837d7d8547f9754628c9d8eee296d9eba
Author: asolino <bethus@gmail.com>
Date:   Sun Jul 17 17:40:00 2016 -0300

    NetBIOSError exception redefined, added name_query_request()

commit f73a97ee81a318bc2f6ccf24bffac76a4089143b
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 13 18:33:08 2016 -0300

    Adding test case for nmb.py

commit 0808e45b796741aea4162bd756e3f54522e8045b
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 13 18:26:27 2016 -0300

    Renaming and recoding of some classes + test case suite
    
    * Many changes to many classes. Much needed for a long time. Aiming at simplifying its work and addding Structure whenever possible.
    * Most probably will break backward compatibility for those using impacket.nmb.

commit d15d01c2fa8c5a0201a121215b7413b7b90a2358
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 8 22:04:41 2016 -0300

    Bugfixes
    
    * Changing logic for __print_all_subkeys_and_entries() method
    * Striping NULL character when printing lpNameOut
    * Better error control when an exception is triggered

commit 91aab87e135806427ae9e7aabda98535542a6437
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 8 21:03:14 2016 -0300

    Changing default value for hBaseRegEnumValue
    
    * Also optimizing the way we craft the packet to minimize trafic
    * Raising exception if trying more than once with the modified size received from the server

commit 04310006e4641c305642c25d48f4ca45f5c1e560
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 22:01:29 2016 -0300

    Restoring the right order in enableRegistry() and adding a warning message
    
    * In case we cannot check the RemoteRegistry status. We'll continue and hope for the best

commit 1a29f0ae3c0098d4f5b5b22b900549f05512e133
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 21:14:55 2016 -0300

    Fixed bug where KeyName wasn't printed correctly when -s switch used

commit f27c39da235ae23ac50af3cb92ca5bb1adef3915
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 20:58:01 2016 -0300

    Continuing if there are keys that cannot be opened

commit e08966ef10edcf696137280c938c6b934a42018b
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 20:36:30 2016 -0300

    Continuing if we cannot connect to SCMR to check RemoteRegistry state
    
    * Maybe a low level user connecting? :-o!

commit b2413d25a50a5d5c09c8c8317d069c092178785e
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 20:12:38 2016 -0300

    Setting socket timeout when connecting a new NetBIOSTCPSession
    
    * After connect(), we're restoring the previous timeout (should be None most of the times) because we handle timeouts later in a different way
    * Addresses https://github.com/CoreSecurity/impacket/issues/173

commit e8764446b54193292cc88973ba7965eea5c945f8
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 09:36:46 2016 -0300

    Making sure we return an ascii encoded string after performing first and second level encoding.
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/172#issuecomment-230631476

commit f04398f2e331330cc18e97208e0ae5bb639252c1
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 6 09:01:44 2016 -0300

    If SMBConnection times out, reconnect it

commit f8c19620ea0685421a5400d7869e20d196d0682c
Author: asolino <bethus@gmail.com>
Date:   Tue Jul 5 20:22:01 2016 -0300

    Adding SMBConnection.reconnect() capability
    
    * reconnects the SMB object based on the original options and credentials used. Only exception is that
      manualNegotiate will not be honored.
      Not only the connection will be created but also a login attempt using the original credentials and
      method (Kerberos, PtH, etc)

commit 103ea978fa6d580367f42aca6aae2678c5cbefa0
Merge: b13acf3 d246ae5
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jul 5 11:47:40 2016 -0300

    Merge pull request #175 from fox-it/ntlmrelay-fixes
    
    ntlmrelayx bugfixes

commit d246ae5751721dc71b89c944e4345e6d723b9015
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Jul 5 16:36:13 2016 +0200

    ntlmrelayx bugfixes

commit b13acf3e64a8cef11537f6e6820ce5221b93069d
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 4 19:10:59 2016 -0300

    Automatically enables/starts/stops/disables the RemoteRegistry service when needed
    
    * Also part of https://github.com/CoreSecurity/impacket/issues/127 requests
    * Commented actions yet not implemented

commit e5c4bdaa04d8bc474f35186f78a06fca32d311b0
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 4 18:43:10 2016 -0300

    We remove the session resume file if ERROR_DS_DRA_BAD_DN error was triggered

commit 75167141137133248276f5458dc8d86ad10d2b8c
Merge: 5acf2b4 4e3ebc4
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 4 15:48:30 2016 -0300

    Merge branch 'manuporto-master'

commit 4e3ebc43c09d0b4b07c89429234e4c54ff991b67
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 4 15:47:05 2016 -0300

    Minor cosmetic changes
    
    * Copyright notices
    * Variable renamings
    * Reusing library code
    * minor logic flow changed

commit 421d390555d89fd86fc4a8b0084321d3c3cff917
Merge: 5acf2b4 e950f15
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 4 13:19:18 2016 -0300

    Merge branch 'master' of https://github.com/manuporto/impacket into manuporto-master

commit 5acf2b4579ff0a19c4115eaa0b489557ac3e9f62
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 16:29:20 2016 -0300

    Adding debug logging output for the exception

commit d824905276dfd2a1863e82136b5eed9fd6ba20cd
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 16:28:56 2016 -0300

    Undoing an unnecessary change

commit 267ee5e0657b29fe8b3c05160b3e27365fafe572
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 16:07:33 2016 -0300

    Adding -port parameter to support 445/tcp and 139/tcp as destination ports
    
    * I create a new parameters group called 'connection' where you can specify the destination port, the domain controller IP and the target IP (if needed)
    * We should propagate the same schema over the rest of the scripts (whenever applicable)
    * Aiming at addressing https://github.com/CoreSecurity/impacket/issues/172

commit fe705da38e1448819ecd83762cd979950e5e8468
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 15:57:25 2016 -0300

    Improving support for connections using NETBIOS_SESSION_PORT as target port
    
    * We're trying to honor the remoteName whenever possible.
    * If user asked for *SMBSERVER as the target name, the library will try to find the target's netbios name on its own.
    * Could potentially bring some incompatibilities with previous implementations, so please test this as much as possible
    * Aiming at addressing https://github.com/CoreSecurity/impacket/issues/172

commit 833943d26d76999a612a1cf38e4cfc26a8ad20d3
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 12:33:14 2016 -0300

    Adding Called Name when NETBIOS_SESSION_NEGATIVE_RESPONSE is raised

commit 7fbfde35dfd1ddccf520060977e5ba452d19cf36
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 12:24:13 2016 -0300

    Adding getRemoteName() method.
    
    * This is what the user specified when creating the SMBConnection object.

commit ef2ed82977ac746fe44ac19356f9c923d3d67215
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 12:22:46 2016 -0300

    Renaming get_dip() for getRemoteHost()
    
    * Why? Because not always the target is a IP address

commit 0b71f6532b0f448278b8049e860921ed2088055b
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 11:05:48 2016 -0300

    Adding more UUIDs based on updated protocol standards

commit ebd9fa4cb01b844984abb63e3fd272b9fc14773d
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 1 10:43:27 2016 -0300

    Simplifying dynamic imports
    
    * Used when building a RPC Reponse
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/126 (I couldn't reproduce it)

commit 20b661efd234973a560b71d6743f47800f2a3c3f
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 28 14:29:12 2016 -0300

    And now coming back to dev :)

commit 7b0bfb763e80e6cc3f1bbc902ccc3fbcfad1b5d8
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 28 14:20:27 2016 -0300

    About to tag new version 0.9.15

commit 0481f3356c8c4ce9deccc0be2d718d11404b97c1
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 27 13:45:29 2016 -0300

    Forgot to set the tag for SubstringFilter
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/170

commit c3f8d9a7d58146093ca6fc08526b42951401c905
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 27 13:44:19 2016 -0300

    Don't fill up the attributes item if there are no attributes asked

commit 014928c48e1bbeefae34163beab807f86b809ea7
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 24 15:49:20 2016 -0300

    Fixing imports
    
    * We don't like import *

commit e950f158f3e198bb561496d31fc70b83c86a661d
Author: mporto <mporto@fi.uba.ar>
Date:   Fri Jun 24 12:23:18 2016 -0300

    Typo

commit 6f999e5756b89b49de6079621f8490cbdad1fcac
Author: mporto <mporto@fi.uba.ar>
Date:   Fri Jun 24 12:20:43 2016 -0300

    Reg example with partial query functionality

commit 16a321228cabf577f4e74daa242373d425e4d3de
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 23 19:28:29 2016 -0300

    Adding changes for the upcoming version
    
    * We're tagging as soon as we verify https://github.com/CoreSecurity/impacket/issues/168

commit 84252ae98dec44141ab82561b72202988ff2e376
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 23 19:22:12 2016 -0300

    doAttack() now keeps a list of target successfully attacked
    
    * Then we read it in the main thread and decide whether or not to attack again based on the -one-shot parameter
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/168

commit e9e639a267eb87aabe1f5fb7e2ce4481eaed5ec1
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 23 17:45:22 2016 -0300

    Flags2 adjustements to avoid some stacks from whining
    
    * mazel tov! :)

commit ccf9c2b4451bfe9244e62ef49d44d1b0f5c05c75
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 23 12:18:57 2016 -0300

    Automatically adjust buffer size for hBaseRegQueryValue

commit 66111c8271c318fa4032efb6d6634441664857d8
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 23 12:06:28 2016 -0300

    Automatically adjust buffer size for hBaseRegEnumValue
    
    * If the original one didn't wasn't large enough
    * If you know the size in advance, you can specify it through dataLen parameter
    * Adjusted test case to trigger this situation

commit 9aeee403ca3e40bfef91b9099f100e2e68fd09ed
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 21 15:36:31 2016 -0300

    Adding the actual SPN to the JtR output produced (and saved via -outputfile)
    
    * Now -outputfile automatically selects -request

commit d6c065a820dc3dd90cb1bf91bb81be22f8f93102
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 21 14:47:35 2016 -0300

    Adding exception handler when processing each record
    
    * Handling pwdLastSet if it was never changed (hopefully)

commit 60f9fa627b3553e0330cbe543571a9db9ef672f1
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 21 14:25:26 2016 -0300

    Whenever we receive sizeLimitExceeded exception, we still process what we've got
    
    * Will give you some results until we implement paged searches

commit 55d1f3ff27b527cc00f66281993002058f5568dc
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 21 10:06:41 2016 -0300

    Extra checks if login didn't succeed

commit ffe7e92afdd8395d24986781da5eca42b2b0b05d
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 21 09:57:29 2016 -0300

    We shouldn't process cipherText if it wasn't processed before
    
    * Hopefully addresses https://github.com/CoreSecurity/impacket/issues/167 although it needs to be verified

commit 33794acbfa73c33e436354f635fcc9f7ae0a887f
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 15 09:27:49 2016 -0300

    Removing unnecessary dependency package

commit acc7a046727ea81bb27fafcb90e95bb359eb5ad4
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 14 13:02:09 2016 -0300

    Using httplib instead of requests plus error fixings
    
    * httplib comes by default, much better than requiring another dependency
    * Removed debug messages
    * Fixed minor errors

commit a769fbca94a5c85ed58cb0e5650f2d621ed2c435
Merge: f618a5f adb01d6
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jun 14 10:53:26 2016 -0300

    Merge pull request #166 from fox-it/httprelayclient
    
    httprelayclient for ntlmrelayx

commit adb01d65df8315f9de6e09dfcc8cce6c5632b1a6
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Jun 14 11:10:02 2016 +0200

    Added optional path support to target specification, fixed port parsing

commit 467ad252d4701a9a4bb050b99f5d74c961d3fda8
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Tue Jun 14 11:02:57 2016 +0200

    HTTP relay client

commit f618a5f1e10d5f893907ad85b65b3c8d759a3537
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 8 20:16:51 2016 -0300

    Setting DRSBind.dwExtCaps accordingly so Win2016 TP5 with PAM is happy about us
    
    * Plus any other possible thing
    * Fixes https://github.com/CoreSecurity/impacket/issues/165
    * Thanks @gentilkiwi and @MichaelGrafnetter for your input

commit dd557b9a79f535ffae0dc8bedc37a9b873a9b20e
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 5 19:09:22 2016 -0300

    Adding DRS_EXT_GETCHGREPLY_V9 as a possible DRSGetNCChanges answer
    
    * Now we access the structures for both _V6 and V9
    * We added we support this feature in DRSBind().dwflags
    * Addresses issue found by @MichaelGrafnetter (https://github.com/CoreSecurity/impacket/issues/165)
    * Still needs to be tested but don't have yet a TP 5 propery configured.

commit c5dd3b86f0d0c21636f23a6a6905e3a53092e53e
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 5 18:56:53 2016 -0300

    Adding also the flag to support _V9 replies
    
    * DRS_EXT_GETCHGREPLY_V9

commit 27ed488d2786b5c66d844237fe797b2167841681
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 5 18:49:59 2016 -0300

    Adding new structures added for 2016 TP5 PAM support
    
    * In particular DRS_MSG_GETCHGREPLY_V9 and everything that depends on it
    * This is needed for addressing https://github.com/CoreSecurity/impacket/issues/165 (also detailed here https://github.com/gentilkiwi/mimikatz/issues/47)

commit 04c66e588083dbcff855c1b476f0cdad98141435
Merge: 07f1981 7b2f942
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 3 21:43:04 2016 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit 07f19817d6ca2a819265814b519d271c30657d5c
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 3 21:38:48 2016 -0300

    Adding one-shot parameter
    
    * After successful authentication, only execute the attack once for each target (per protocol)

commit 7b2f942121e15c690463e988e1f1e84ed07963d2
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue May 31 22:42:38 2016 -0300

    Update README.md

commit 1bdba4837425a9546380b0962649fa114140496c
Author: asolino <bethus@gmail.com>
Date:   Tue May 31 21:22:54 2016 -0300

    Adding -dc-ip option to examples
    
    * Allows to specifying the IP address for the DC/kdcHost
    * Collateral for https://github.com/CoreSecurity/impacket/issues/160

commit 19f7fe90edfd4e651b63c14d8f125f17416fef2f
Author: asolino <bethus@gmail.com>
Date:   Tue May 31 21:15:16 2016 -0300

    Adding ability to specify kdcHost for DCERPC/DCOM layers
    
    * Adding kdcHost to the classes constructors (when applicable)
    * Through DCERPCTransport.set_kerberos() now you also can specify the kdcHost
    * Added DCERPCTransport.get_kdcHost() that will be used by DCOM and DCERPC
    * Aiming at addressing https://github.com/CoreSecurity/impacket/issues/160

commit cea19373434b808ae62d362af3bac360d2488ba8
Author: asolino <bethus@gmail.com>
Date:   Mon May 30 18:49:11 2016 -0300

    If ldap:// fails, we try ldaps://

commit a813b202ad45b990cd79bbd17dd9b4e8e7cf168f
Author: asolino <bethus@gmail.com>
Date:   Mon May 30 18:48:13 2016 -0300

    When setting a value, we pack it depending on the data type

commit c1cce7636cc7b201caa2a9bd8a71a33e4a3d17b1
Merge: d96a537 0bb0b2b
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:51:44 2016 -0300

    Merge branch 'fox-it-master'

commit 0bb0b2bf2843ea493223553f9542a4b971a6c327
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:47:33 2016 -0300

    More fixups and cosmetic changes

commit 5b31f9c26768552ff3effdbc139b62dcea219194
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:46:17 2016 -0300

    Forgot to change setup.py with new ntlmrelayx location

commit a1912824eb99ccf48b561d7ad716c92abf43aba3
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:44:28 2016 -0300

    Moving impacket.ntlmrelayx to impacket.examples.ntlmrelayx
    
    * Minor fixups in imports and cosmetic changes as well. There's some more code cleaning and variable naming left.

commit 8fa21746e4395b38664f5bbb4700357a95daf489
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:33:08 2016 -0300

    Imports fixups and minor cosmetic changes

commit 806ce6905a5c669300e8ce315ae1198242372151
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:13:21 2016 -0300

    Empty file

commit cd97e0f8226b819a76e67e822e2dc2320b9c595e
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 17:03:06 2016 -0300

    Fixed wrong structure sent to SMBClient preventing SMB Relay
    
    * Instead of rawtoken (didn't exist) it must be SPNEGO_token
    * Import fixups and minor cosmetic changes

commit c5c50bf2085d07b36b15af31e2187bd92a4ed68a
Merge: d96a537 24dfd3a
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 16:41:22 2016 -0300

    Merge branch 'master' of https://github.com/fox-it/impacket into fox-it-master

commit d96a537059e47131dd79ce05585a41e01aad3b13
Author: asolino <bethus@gmail.com>
Date:   Fri May 27 16:39:35 2016 -0300

    Adding lastLogon to the output as well

commit 24dfd3a4226469f37cd889bef90ba76bd3d60916
Author: Dirkjan Mollema <dirkjan.mollema@fox-it.com>
Date:   Fri May 27 12:35:10 2016 +0200

    ntlmrelayx

commit 6ab19e5fbe6e4fd4f4c793c69b7bdb0ae887d1a9
Author: asolino <bethus@gmail.com>
Date:   Thu May 26 22:20:45 2016 -0300

    No need to close the SMB Connection

commit f5a053ac38f079787d6d65797d129cbb38286bf2
Author: asolino <bethus@gmail.com>
Date:   Thu May 26 22:17:39 2016 -0300

    Improving the LDAP search filter to minimize traffic
    
    * We're now asking for:
    (&(servicePrincipalName=*)(UserAccountControl:1.2.840.113556.1.4.803:=UF_NORMAL_ACCOUNT)(!(UserAccountControl:1.2.840.113556.1.4.803:=UF_ACCOUNTDISABLE)))
    Basically will return the normal accounts, not expired, that has an SPN set.

commit 855561685eefa837c875ab7b45e6db0f1221cb4a
Author: asolino <bethus@gmail.com>
Date:   Thu May 26 22:10:32 2016 -0300

    Changing Kerberos auth mechanism from GSSAPI to GSS-SPNEGO plus minor fixed
    
    * Solves the issue of kerberosLogin still not working after pyasn1 upgrade (https://github.com/CoreSecurity/impacket/issues/162)
    * LDAP search accepts sizeLimit now
    * Better error descriptions
    * Fixed some LDAP ASN1 definitions

commit f978950f33e712459c0f08d07a98fbecb02096f8
Author: asolino <bethus@gmail.com>
Date:   Thu May 26 22:08:46 2016 -0300

    Socket more meaninful information when socket operation failed
    
    * Good for realizing there's a DNS resolve issue

commit 46bbd3ddee56ea39d3796e8581ae8eb01f631b88
Author: asolino <bethus@gmail.com>
Date:   Thu May 26 22:04:29 2016 -0300

    Parsing MSRPC_FAULT as probably response during bind() operation
    
    * Win 2012R2 sends MSRPC_FAULT instead of MSRPC_BINDNAK

commit 2408f3aed454f6c42a5ccb7b09526ef88941481d
Author: asolino <bethus@gmail.com>
Date:   Tue May 24 23:38:38 2016 -0300

    Making it work with pyasn1-0.1.8
    
    * kerberosLogin still doesn't work tho. Don't know exactly why
    * Partially address https://github.com/CoreSecurity/impacket/issues/162
    * Works with pyasn1-0.1.7 as well

commit a8576c017295b39915af1b2ff2874d19a3b83a77
Author: asolino <bethus@gmail.com>
Date:   Fri May 20 21:16:15 2016 -0300

    Reformatting some code

commit 0b1a28bfdd53466b9bed502a0740d6fe8aab8b6b
Merge: caf47e5 bc83d98
Author: asolino <bethus@gmail.com>
Date:   Fri May 20 16:24:37 2016 -0300

    Merge branch 'mgeeky-master'

commit bc83d9870f3d8e255a563cf481c9351730bf7542
Author: asolino <bethus@gmail.com>
Date:   Fri May 20 16:23:59 2016 -0300

    Using argparse choices to specify -s options

commit 4b81a6a4ed53621ae7322e6775538f9ab909f8e5
Author: asolino <bethus@gmail.com>
Date:   Fri May 20 16:14:50 2016 -0300

    No need to create the dictionaries with STATUS messages
    
    * We have them in nt_errors.ERROR_MESSAGES

commit d7bcae1c08a32e3bc4718f87ca440ba312754b12
Author: Mariusz B <mariusz.bit@gmail.com>
Date:   Wed May 18 18:35:26 2016 +0200

    Forgot to add default return status values in case setReturnStatus was not invoked.

commit 23e44f1869de5f04a23ba1c910f2179dd60b51e7
Author: mgeeky <mgeeky@users.noreply.github.com>
Date:   Wed May 18 17:44:03 2016 +0200

    Added logging of the status code returned to the connecting client.

commit b1af0b52cb54a5ecfb5968e5b69e83049f3846c9
Author: mgeeky <mgeeky@users.noreply.github.com>
Date:   Wed May 18 17:43:19 2016 +0200

    Added some comments and input parameter value validation

commit a8354a1b7424a0bac07a520870f957a8dffeaa6f
Author: mgeeky <mgeeky@users.noreply.github.com>
Date:   Wed May 18 17:42:31 2016 +0200

    Added option to specify return status code after connecting client's successful authentication (relayed). This will be useful in cases in which we do not want to let connecting client store credentials that succeeded (i.e. remember them and proceed with successful authentication). There are some cases in which we may want to inform the client that his credentials were invalid (STATUS_LOGON_FAILURE) where in fact they went through. Also, we may mislead the client with information that the Access is Denied when authentication to e.g. ADMIN$ share at the server.

commit caf47e5f76d27b8e2c23ad40a75bc96920ea8434
Author: asolino <bethus@gmail.com>
Date:   Mon May 16 09:23:23 2016 -0300

    Fixes broken connection if -dc-ip is not specified
    
    * Introduced in latest commit. Should work now

commit 5fa74d87f2e5df69fb71e6d81b312b46c9801dfd
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 20:44:00 2016 -0300

    Reformating code

commit d4d6de0edf373322bddeef8b571eaa2f7da8b64e
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 19:54:28 2016 -0300

    Making DCERPC/LDAP/Kerberos IPv6 compliant
    
    * Looks like IPv6 is still not used much ;). These tiny things were preventing IPv6 from working at the DCERPC/LDAP/Kerberos layers.
    * SMB was working correctly

commit 2a36f54dd8b767113fc42d3117e8a3a30deb9959
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 19:23:27 2016 -0300

    Adding more statements into the try: execept.
    
    * It wasn't behaving well when no stringbinding was chosen for target

commit 01ad6ac79d344a0ba2c69f6c8893ce8ecfd2ccca
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 19:17:57 2016 -0300

    Warn if we couldn't find a valid string binding.. Shouldn't be common

commit 8d8aab419fa17ce7d922a307f1c7ed0ed8e0b130
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 18:47:15 2016 -0300

    Empty domain check fixed

commit b6f28459970a4fc0a63dce9323da97287ada1322
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 18:46:20 2016 -0300

    Reformating code
    
    * To keep it within 80 chars wide
    * Empty domain check fixed

commit 21a58e81d95a9b6e609290fdb7640d341025139d
Author: asolino <bethus@gmail.com>
Date:   Sun May 15 18:29:34 2016 -0300

    Improved stringBinding selection
    
    * As reported in https://github.com/CoreSecurity/impacket/issues/158, there could be some instances where the wrong stringBinding would be chosen.
    * Testing needed to verify it's now working well

commit 061917c20430908b702a707e0c5b200375cc1c7d
Author: asolino <bethus@gmail.com>
Date:   Sat May 14 16:30:41 2016 -0300

    Adding -save parameter
    
    * Saves each TGS downloaded in ccache format. Why? If we later on crack any password we can just edit that one and make it silver

commit 75c647513bc124d7a8a7664ff161e04774e00172
Author: asolino <bethus@gmail.com>
Date:   Sat May 14 16:29:34 2016 -0300

    Replacing class variables for instance variables
    
    * Don't know why I did it this way to begin with. Not needed

commit 14010a4142004e5a048481b99f5911bfe03c0a92
Author: asolino <bethus@gmail.com>
Date:   Sat May 14 15:47:16 2016 -0300

    -dc-ip parameter moved to the authentication group
    
    * makes more sense. Should do the same for goldenPac and probably and this option for all scripts

commit 9d717a318a888aa1659385f724e0f90c7fa8a62e
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 20:35:09 2016 -0300

    This script should now work w/o requiring DNS resolution
    
    * Even if Kerberos authentication is specified

commit a1117e84ff2c300773d2faed72262f4558a03ef0
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 20:20:56 2016 -0300

    Fixes small typo
    
    * It was copied from goldenPac.py

commit 0d73b2c858ca3e46ad6b89ef4dcb1f76920b03d7
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 20:17:07 2016 -0300

    Adding -dc-ip command line option
    
    * Allows specifying what the IP for the domain is.
    * It assumes the DC and KDC resides in the same server
    
    e.g.
    ./GetUserSPNs.py -dc-ip 172.16.123.170 -request freefly.net/normaluser

commit fcf0c2ad8f52c277bd9072da93b7028607d6ba97
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 19:24:46 2016 -0300

    Fix when dumping CLEARTEXT password for machine accounts
    
    * We won't utf-16 decode them, we will just print it in hex

commit 162b23bf0b8c24d2ce7388793a79b428780ea617
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 19:18:01 2016 -0300

    Fix error when passing NTLM hashes for authentication

commit eaf8a03251e4fb87af289e9ba33eaebaa6617a0f
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 19:07:30 2016 -0300

    Adding -request and -outputfile options
    
    * -request picks SPNs for unique usernames and outputs JtR/hashcat format
    * -outputFile, well.. outputs to a file for later cracking :)
    
    Sample usage:
    ./GetUserSPNs.py freefly.net/normaluser7 -request -outpufile /tmp/hashes.txt

commit 2a185c1ecc0b0a56467f12dfccbd5672ed95adaa
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 12:47:08 2016 -0300

    Adding GetUserSPNs (part of Kerberoast attack)
    
    This module will try to find Service Principal Names that are associated with normal user account.
    Since normal account's password tend to be shorter than machine accounts, and knowing that a TGS request
    will encrypt the ticket with the account the SPN is running under, this could be used for an offline
    bruteforcing attack of the SPNs account NTLM hash if we can gather valid TGS for those SPNs.
    This is part of the kerberoast attack researched by Tim Medin (@timmedin) and detailed at
    https://files.sans.org/summit/hackfest2014/PDFs/Kicking%20the%20Guard%20Dog%20of%20Hades%20-%20Attacking%20Microsoft%20Kerberos%20%20-%20Tim%20Medin(1).pdf
    
    Original idea of implementing this in Python belongs to @skelsec and his
    https://github.com/skelsec/PyKerberoast project
    
    This module provides a Python implementation for this attack, adding also the ability to PtH/Ticket/Key.
    Also, disabled accounts won't be shown.
    
    ToDo:
    [ ] Add the capability for requesting TGS and output them in JtR/hashcat format
    [ ] Improve the search filter, we have to specify we don't want machine accounts in the answer
        (play with userAccountControl)

commit 501ef71b737ebef4928d655eeb21e52ceba859af
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 12:44:36 2016 -0300

    Adding ldap directory to the setup.py for library installation

commit 53477252e67bab62d86e571b04d91d7ff8d74917
Author: asolino <bethus@gmail.com>
Date:   Fri May 13 12:39:59 2016 -0300

    Adding a minimalistic LDAP implementation
    
    * Supports ldap and ldaps
    * Supports Pass the hash, ticket and key
    * Only search is available (and you need to build the search filter yourself)

commit 375b9972dc5696a1967df56a3cec3d87c64b9a47
Author: asolino <bethus@gmail.com>
Date:   Sat May 7 16:54:43 2016 -0300

    Changes the output filename based on the share specified.
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/156
    * Debug message added

commit 34e5a814ce37fa43aae6168b423185cc6b9347cd
Author: asolino <bethus@gmail.com>
Date:   Fri May 6 15:39:23 2016 -0300

    Updated test cases

commit f8b900f2a8adae3dbfb79c123f76f2b57a2022a3
Author: asolino <bethus@gmail.com>
Date:   Fri May 6 14:56:46 2016 -0300

    Remaining fixes for ERROR_DS_DIFFERENT_REPL_EPOCHS
    
    * Test cases and raiseChild were also affected

commit 106934377c2ea4d41458d97f42807057b97250ec
Merge: 5b92375 4ee5c84
Author: asolino <bethus@gmail.com>
Date:   Fri May 6 14:44:17 2016 -0300

    Merge branch 'skelsec-master'

commit 4ee5c841263ba5c7ecab2a542cf064180931b183
Author: asolino <bethus@gmail.com>
Date:   Fri May 6 14:43:05 2016 -0300

    Creating new cipher based on received keytype
    
    * This was preventing pass-the-key attacks to work

commit ea0a1e364aa863cbe8fba772ec0036d873c6ed58
Merge: 5b92375 63c4aaf
Author: asolino <bethus@gmail.com>
Date:   Fri May 6 13:29:28 2016 -0300

    Merge branch 'master' of https://github.com/skelsec/impacket into skelsec-master

commit 5b92375f9f0143fbc5cef49294d86ae2c6aa788c
Author: asolino <bethus@gmail.com>
Date:   Thu May 5 11:35:54 2016 -0300

    pwdLastSet is also included in the output file
    
    * According to @mubix this won't interfere with JtR :)

commit b6b2b1db7cd4ffbf38ed2e905b047daa8d6bc19a
Author: asolino <bethus@gmail.com>
Date:   Thu May 5 11:23:52 2016 -0300

    More debug messages added

commit bcff6bc38cf8441723f06c307e68aaa6f40b31dc
Author: asolino <bethus@gmail.com>
Date:   Thu May 5 10:54:15 2016 -0300

    Adding more debug information for helping troubleshooting

commit 63c4aaf5f4ea38ff9218fdf231c098a5026f49b9
Author: skelsec <info@skelsec.com>
Date:   Thu May 5 13:05:32 2016 +0200

    TGS Request sessionkey type update
    
    Here we should use the type that we got back from the server.

commit 5db6cf60cf3acd8c55136da33c6d7a68389787a5
Author: skelsec <info@skelsec.com>
Date:   Thu May 5 13:01:34 2016 +0200

    TGS Request ETYPE field values
    
    etype field here MUST contain rc4_hmac in a windows environment, or the response will be KDC_ERR_ETYPE_NOSUPP.

commit a489c032f2cc2748bb91ae6b24d28308ea210a2b
Author: asolino <bethus@gmail.com>
Date:   Sun May 1 21:21:14 2016 -0300

    Extra line removed. Cosmetic

commit 7c34db9948dd48275d85b6cee7675a2ac1d079b9
Author: asolino <bethus@gmail.com>
Date:   Sun May 1 21:14:45 2016 -0300

    Fix ERROR_DS_DIFFERENT_REPL_EPOCHS when running against a domain with dwReplEpoch != 0
    
    * By default we set dwReplEpoch to 0 when calling DRSBind(). If this call's answer specifies a different dwReplEpoch, then we call DRSBind again with the right one. Otherwise calls will fail later.
    * Thanks @gentilkiwi for reporting it in impacket, @MichaelGrafnetter for reporting it to mimikatz and @rmbolger for reporting it DSInternals :)

commit b05feb2f5aefb1d434f48727785b16b07fd518a5
Author: asolino <bethus@gmail.com>
Date:   Sun May 1 20:32:56 2016 -0300

    Updated test cases
    
    * Added test cases for packet fragmentation and session security (both Kerberos and NTLM)
    * Simplified the structure of the test cases

commit bba72c234ba694cf7b70c94ce1a3a240990d3b1a
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 29 19:58:17 2016 -0300

    Packet fragmentation review
    
    1) Checks the right PDU len based on user input (if set using set_max_fragment_size()) or BIND_ACK answer (max_rfrag)
    2) Fixed wrong signature/encryption calculation when using Kerberos and fragmentation enabled.
    3) Header flags renamed based on C706 standard
    4) Will probably address https://github.com/CoreSecurity/impacket/issues/137

commit 7c49b28ff5a18702f87684d844fdfce127a451a1
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 15 13:14:01 2016 -0300

    Few fixes to SMB Test cases
    
    1. Fix readwriteFile testcase to support large reads
    2. getServerName converting to upper case when comparing
    3. Credentials are now taken from dcetests.cfg (we should change the name in the future)

commit dc4606822e489e62d276bc3c928af31cd860f4a0
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 15 13:09:42 2016 -0300

    STATUS_USER_SESSION_DELETED when downgrading from SMB2_DIALECT_30 to SMB2_DIALECT_21/SMB2_DIALECT_002
    
    * Since we're not supporting multichannel, we're taking the approach described at http://linux-cifs.vger.kernel.narkive.com/WffA8Jw5/status-user-session-deleted-auth-problems-when-downgrading-from-vers-3-0-to-vers-2-0-2-1 by simply randomizing the ClientGUID when negotiating the protocol.
    * This code was triggering the issue:
    
    from impacket.smbconnection import *
    
    USERNAME = 'Administrator'
    PASSWORD = 'admin'
    TARGET = '192.168.1.1'
    
    s1 = SMBConnection(TARGET, TARGET)
    s1.login(USERNAME, PASSWORD)
    
    s2 = SMBConnection(TARGET, TARGET, preferredDialect=SMB2_DIALECT_21)
    s2.login(USERNAME, PASSWORD)
    
    print "ALL GOOD"

commit 49a07a5fa7372abd7a6b5eeec8d039b1add4e86d
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 11 10:58:16 2016 -0300

    Retrieve user principal name from CCache file
    
    * When https://github.com/CoreSecurity/impacket/pull/144/files was merged we forgot to also add
    that support to the getKerberosType1 method.
    * Will probably fix https://github.com/CoreSecurity/impacket/issues/149, needs testing.

commit 19d7cfca5797635abc251324449945ead65c4052
Merge: de8b255 e42d8e1
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Mar 30 09:29:27 2016 -0300

    Merge pull request #146 from byt3bl33d3r/master
    
    UnboundLocalError in smbconnection.readFile() when recieving STATUS_END_OF_FILE error

commit e42d8e183a8766d49c799348db17b9d0e656ec0a
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Mar 29 23:43:31 2016 -0600

    Fixed while loop in smbconnection.read() when STATUS_END_OF_FILE is received

commit de8b2556789a2e78cd0a16e38f40bc567a6873c9
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 29 16:54:17 2016 -0300

    Fixes offline dump of SAM hashes (no NTDS.DIT)
    
    * This was broken at https://github.com/CoreSecurity/impacket/commit/bbff44d1fc555e2de2ffeef1e9f7bb89afd2946b
    * A proposed solution was PRed here https://github.com/CoreSecurity/impacket/pull/145 . This is basically the same with samller changes
    * Thanks @MrTchuss for finding this!

commit 3b819e2fdea5161d664f9b04cdb89d4a0e8179b5
Merge: 0df0100 9430507
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Mon Mar 28 11:51:26 2016 -0300

    Merge pull request #144 from MrTchuss/master
    
    Retrieve user principal name from CCache file

commit 0df0100998736d949ca9cd8c7e7b2d829952afdc
Author: asolino <bethus@gmail.com>
Date:   Sun Mar 27 15:18:18 2016 -0300

    Honoring extended_security parameter in SMB.neg_session()
    
    * When we did the SMBv1 Unicode support (https://github.com/CoreSecurity/impacket/commit/328caf150446658ec2621e7a2cd28e6c39cc8da0) we changed the default flags1/flags2 from `0` to `SMB.FLAGS2_EXTENDED_SECURITY | SMB.FLAGS2_NT_STATUS | SMB.FLAGS2_LONG_NAMES`. We forgot tho, to change the behavior en SMB.neg_session() when `extended_security` was set to False. What was happening was the `FLAGS2_EXTENDED_SECURITY` was never removed.
    * This was preventing establishing negotiations with `FLAGS2_EXTENDED_SECURITY` set to False (aka standard security). In particular this was breaking the SMB Reflection use case.

commit 9430507030c931d4edf2465e4411e43719c344be
Author: MrTchuss <mrtchuss@users.noreply.github.com>
Date:   Sat Mar 26 21:07:54 2016 +0100

    Retrieve user principal name from CCache file
    
    If needed, retrieve user and domaine information from KRB5 CCache file.
    This simplifies examples command-line, as user only needs to export
    KRB5CCNAME environment variable after a successful authentication using
    kinit and do not need to specify user principal name on command line:
    $ export KRB5CCNAME=/tmp/krb5cc_1000
    $ smbclient.py -k win2012-dc1.vulnerable.local

commit 04d392083a8621e1f81449f73599ec2238aaf1c6
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 25 23:01:47 2016 -0300

    If we cannot decode Unicode let's print the data w/o decoding
    
    * This could happen when SMB Reflecting against old OSes.

commit c6fb099ba27f978ab762226dffc688f034c3754c
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 25 22:59:41 2016 -0300

    If NT ERROR string is not found just print the error code

commit a71e6bb0f9b04251009f3b995571c03a1dfcb0f8
Merge: 6d42da9 ed375b9
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Mar 24 19:51:01 2016 -0300

    Merge pull request #142 from rrerolle/master
    
    SMB3.create: use proper method to determine SMB2 and SMB2Create headers sizes

commit ed375b97d19575970e6c1d873f28620238488053
Author: RÃ©mi RÃ©rolle <remi.rerolle@gmail.com>
Date:   Thu Mar 24 16:53:51 2016 +0100

    SMB3.create: use proper method to determine SMB2 and SMB2Create headers sizes
    
    This prevents from needing a commentary to explain what those hard-coded values
    stand for.

commit 6d42da9003d28bd6ab3446396c65d9f60de16848
Merge: 518abf3 df4c955
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Mar 23 14:31:00 2016 -0300

    Merge pull request #140 from rrerolle/master
    
    SMB3.create: define CreateContextsOffset and CreateContextsLength when applicable

commit df4c95522d406455011e9f77c699fb84db891d1d
Author: RÃ©mi RÃ©rolle <remi.rerolle@gmail.com>
Date:   Wed Mar 23 17:54:45 2016 +0100

    SMB3.create: define CreateContextsOffset and CreateContextsLength when applicable
    
    When providing createContexts in a SMB3 create call, the buffer is set
    accordingly, but not the offset and length fields. This causes the createContext
    data to be ignored by the server.
    
    This patch tries to fix this by specifying the offset and length. The offset is
    determined by adding the size of the SMB2 and CREATE_REQUEST headers to the
    name length.

commit 518abf375538f0ed80b84b95fa26e211f78bf80c
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 11 13:19:43 2016 -0300

    Reverting back previous commit. Problems with some Windows clients
    
    * More research needed. OSx clients now only works if GUEST connection set.

commit b05b4703e702a6e6c48b423d2a7fea05fdab3768
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 11 13:09:50 2016 -0300

    Setting GUEST flag only if username is 'GUEST'
    
    * This is OSx specific in order to make it work when an OSx client wants to log in with a username/password

commit 3e768cc89080a06b735eed05c0e36e354cd8a86e
Author: asolino <bethus@gmail.com>
Date:   Fri Mar 11 11:49:48 2016 -0300

    Clear NextEntryOffset when SL_RETURN_SINGLE_ENTRY is received
    
    * Addresses https://github.com/CoreSecurity/impacket/issues/136

commit 1f98352aa1b51048e55ea8ddfa356cdde1c30b06
Author: asolino <bethus@gmail.com>
Date:   Tue Mar 8 15:58:26 2016 -0300

    Fixing https://github.com/CoreSecurity/impacket/issues/135
    
    * LOG line left there just in case logging is active already.

commit 9494af8cd8bdb0eb44b20840aaf3f1b67dca49e1
Author: asolino <bethus@gmail.com>
Date:   Wed Mar 2 18:01:35 2016 -0300

    Better controls strip leading '/'/'\\' when running the server in Windows
    
    * Regardless of the share configured, it was always showing the root drive contents (when ran on Windows)

commit 682ce151ddda2f2fd713546cbbec2ce28f79d032
Author: asolino <bethus@gmail.com>
Date:   Mon Feb 29 16:59:04 2016 -0300

    Exposing SMBSERVER in SimpleSMBServer class
    
    * registerNamedPipe, unregisterNamedPipe and getRegisteredNamedPipes
    * Might be helpful if you want to create custom named pipes handlers thru the SimpleSMBServer

commit 1ef7978fe9d0d3baecb702ed2a77e55925e46821
Author: asolino <bethus@gmail.com>
Date:   Mon Feb 29 16:32:51 2016 -0300

    Replacing NTLMSSP_NEGOTIATE_NTLM2 for NTLMSSP_NEGOTIATE_EXTENDED_SESSIONSECURITY
    
    * Makes it easier to understand [MS-NLMP] when you're reading alongside our code

commit 79dda7fcbecb3e7d3e744ae5e4c181871f7ad212
Merge: e8dc587 2e914bb
Author: asolino <bethus@gmail.com>
Date:   Fri Feb 26 10:38:35 2016 -0300

    Merge branch 'gadio-master'

commit 2e914bbbf3cafcf82942a637111a4a39a81c9a81
Author: asolino <bethus@gmail.com>
Date:   Fri Feb 26 10:37:24 2016 -0300

    Changing -auth-level-pkt-privacy to -rpc-auth-level
    
    * By default it just let the runtime to decide what's best
    * Added option to enforce packet integrity as well

commit 49b9631104faa508e94496144b33771d462b3c89
Author: Gadi Oren <dbaspdp25g@snkmail.com>
Date:   Sun Feb 14 15:23:03 2016 -0500

    Allow setting packet privacy authentication level

commit e8dc587dab030787f2b2a23afebebae785e8018e
Author: asolino <bethus@gmail.com>
Date:   Wed Feb 3 11:29:23 2016 -0300

    Minor improvements
    
    1) When ran With no parameters, now it runs in reflection mode and dumps target's hashes
    2) When relaying to 127.0.0.1, it's ok not to have a username. Especially important for hot potato attack
    3) Better control of exceptions when authentication succeded

commit 22313cc590b33218a4344e7c7ea48983f00ba89f
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 28 19:07:39 2016 -0300

    Adjusting NegotiateFlags to [MS-NLMP] 2.2.2.5 description
    
    * Check out your code if you were using these flags since names got changed
      according to the standard

commit a358566c98010fc0acc0779fd87980ef4adaac93
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 27 18:08:26 2016 -0300

    Adding -just-dc-user switch to download just a single user data (DRSUAPI mode only)
    
    * Similar to @gentilkiwi's DCSync functionality
    E.g.
    python secretsdump.py Administrator:admin@172.16.123.1 -just-dc-user krbtgt
    
    Impacket v0.9.15-dev - Copyright 2002-2016 Core Security Technologies
    
    [*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
    [*] Using the DRSUAPI method to get NTDS.DIT secrets
    krbtgt:502:aad3b435b51404eeaad3b435b51404ee:bf11f756a7cd1a29a9abd8ccc918a805:::
    [*] Kerberos keys grabbed
    krbtgt:aes256-cts-hmac-sha1-96:44b77486dd383d7177207bb7393f4ec4176fb80be7dcf5c598221a7a039bc2e9
    krbtgt:aes128-cts-hmac-sha1-96:2eb877b16640e7f60adb362c8e482f11
    krbtgt:des-cbc-md5:4610ea7024fff562
    [*] Cleaning up...

commit 1645f43ccf676ddb234c231816bf22d5ceca3c61
Author: asolino <bethus@gmail.com>
Date:   Tue Jan 12 16:36:58 2016 -0300

    Upgrade Copyright

commit aa8bda15ebd49ce3aebb2691ccd1e8221aa7d885
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 11 18:29:46 2016 -0300

    Typo fix

commit 1cdc5ce8afff9236140edab1229a15e02cbf09d6
Author: asolino <bethus@gmail.com>
Date:   Mon Jan 11 18:12:15 2016 -0300

    Adding support for Win2016 TP4 in LOCAL or -use-vss mode
    
    The main things that changed when raw parsing the NTDS.DIT are:
    1. The encryptedPEK header changed from '\x02\x00\x00\x00' to '\x03\x00\x00\x00'. Instead of
       using MD5 / RC4 it now uses AES to decrypt the PEK lists. Right now I only support 1 PEK
       key until I can repro having more than a key on this OS. Maybe @s0crat can help here ;).
    2. The decrypted PEK list is different from previous versions and the PEK Key sits in the
       middle of the decrypted buffer. I still need to understand what the other bytes are for.
    3. When decrypting NTHashes and supplemental information, the structure header changes from
       '\x11\x00\x00\x00' to '\x13\x00\x00\x00'. Instead of using RC4 it now uses AES. The
       structure here is a little different too, whereas the buffer for decryption starts 4
       bytes after a similar buffer in pre Win2016 TP4.
    
    Lot's of testing needed. Later on I'll work on simplifying the code.
    
    * Big thanks to @gentilkiwi for telling me about the issue and also giving me important info to come up with the solution.
    * DRSUAPI mode (the default one) worked out of the box
    * Moved __descryptAES to CryptoCommon since it's used on a few more places

commit f33daa056fd7cee38c2d65fdb42624ecaae09704
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 7 13:11:55 2016 -0300

    Going back to dev version

commit 67fc19e9996148add1b1e2a8b912fe8c95b51692
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 7 12:35:14 2016 -0300

    Updated Changelog

commit 0d34fd9365765c8c1d25e77393646d91d84da28a
Author: asolino <bethus@gmail.com>
Date:   Thu Jan 7 11:12:01 2016 -0300

    Upcoming version

commit 8c04d9697939172c9159af92ddd0eded221f2106
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 14:08:30 2016 -0300

    Updating copyright notice. Welcome 2016

commit ac31fea5c1578e37eace0df83f1c2bf05350140e
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 13:25:31 2016 -0300

    Removing old DCERPC runtime files.
    
    * Scripts still using this old runtime should port to impacket.dcerpc.v5 classes
    * All examples should be using V5

commit 118688065e062e5f28307015d120b4ef4b1a3dd3
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 11:25:32 2016 -0300

    Moving KNOWN_UUIDS to epm.py before ditching the old dcerpc runtime

commit a4dc7d52f6ad3851ea29bbcf8938611df061eec1
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 11:21:47 2016 -0300

    Moving KNOWN_UUIDS to epm.py before ditching the old dcerpc runtime

commit 638a235b47157183cdc1cba940dfc9cb94c7fb28
Merge: 1140d51 e4d4863
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 10:28:54 2016 -0300

    Merge branch 'byt3bl33d3r-master'
    
    Thanks @byt3bl33d3r!

commit e4d4863430279b8b744e830a96bcddc8a0698562
Author: asolino <bethus@gmail.com>
Date:   Wed Jan 6 10:27:27 2016 -0300

    Grabbing and printing command output when using -c switch
    
    * Also removing temp file

commit 5c6a3aee8ca6e506d2f4f4ebfd3c0fc6693e7ac5
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Jan 5 19:28:04 2016 -0700

    added option to execute commands in smbrelayx.py

commit 1140d519495e6d797d40e2b6db206f02e683b7d0
Merge: 1ef6af5 cb69715
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Tue Jan 5 13:00:06 2016 -0300

    Merge pull request #123 from mubix/patch-1
    
    Add Domain Admins RID

commit cb697154c084c265ad9f9537c62590dd46e41e1b
Author: Rob Fuller <jd.mubix@gmail.com>
Date:   Tue Jan 5 10:47:20 2016 -0500

    Add Domain Admins RID
    
    Source: https://msdn.microsoft.com/en-us/library/cc223144.aspx

commit 1ef6af5ac2493a93bcaee42f2af79df39b98cf6c
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 17 16:40:09 2015 -0300

    Minor cosmetic changes

commit b4c43aba5cdb8edc21a046263eb902885bfdc547
Merge: 270dcce 88ccb48
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Dec 17 09:00:55 2015 -0300

    Merge pull request #120 from sjitech/master
    
    smbclient.py: "cd" command failed to enter JUNCTION or read-only direâ¦

commit 88ccb48f2758caf2ff6e145da5bab426ab588ea2
Author: q <osexp2003@gmail.com>
Date:   Thu Dec 17 19:20:16 2015 +0900

    smbclient.py: "cd" command failed to enter JUNCTION or read-only directory

commit 270dcce3f2ff50106adab3c7a299d8549f67112f
Merge: 0999641 08caa1d
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 15 12:02:45 2015 -0300

    Merge branch 'sjitech-master'

commit 08caa1d6ee153af83ab02b87ba017450a429a985
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 15 11:51:07 2015 -0300

    Small change to decide when to disconnect a DCE connection

commit 616bdf952d7cc299d1dd4585ed4b6452fcb7f8bc
Merge: 0999641 264ac83
Author: asolino <bethus@gmail.com>
Date:   Tue Dec 15 11:43:27 2015 -0300

    Merge branch 'master' of https://github.com/sjitech/impacket into sjitech-master

commit 264ac838c5c75a28cddaa5956c8e68fa419ff496
Author: q <osexp2003@gmail.com>
Date:   Tue Dec 15 09:50:05 2015 +0900

    let hept_lookup use existing SMB transport if specified, instead of always use TCP 135 port

commit 0999641aea3633c3a80407424178b2496ab4fc4f
Author: asolino <bethus@gmail.com>
Date:   Mon Dec 14 14:36:32 2015 -0300

    Extending NdTable's data to more than 16 properties
    
    * NdTable is an encoded table that represents the behavior of the default value of properties in a CIM class. ([MS-WMIO] Section 2.2.26
    * The implementation I had was limiting the amount of parameters to pack when marshalling a class/instance to 16.
    * Now it should support the amount of properties defined by the class.
    * I'm still not sure tho, the encoding I'm using is the right one. [MS-WMIO] does not specify this.
    * Found this while addressing https://github.com/CoreSecurity/impacket/issues/117

commit e13e0baa1ac9973eb4df85e6be0af2a2e975bdd3
Author: asolino <bethus@gmail.com>
Date:   Thu Dec 3 10:09:58 2015 -0300

    DCOM INTERFACE Connections are not reused by different threads
    
    * Reusing them could trigger out of sync issues. Instead, a new connection is created by each thread.
    * This aims to fix https://github.com/CoreSecurity/impacket/issues/114

commit 1f8370e56b01cb183dee03e2a150302810a81925
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 30 15:49:07 2015 -0300

    Applying @jammer3d patch to fix https://github.com/CoreSecurity/impacket/issues/108
    
    Thanks and sorry for the delay!

commit 5851bd0cb903a91db0db8d225ee85be8cf2b734d
Author: asolino <bethus@gmail.com>
Date:   Thu Nov 26 14:55:19 2015 -0300

    Applying @0xsauby fix for password with '@' to the rest of the example scripts

commit f1d5337aae359615aa891fa2f83d49ad349540de
Merge: 836463b 6913c13
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Thu Nov 26 14:48:46 2015 -0300

    Merge pull request #112 from 0xsauby/master
    
    Broken auth, thanks @0xsauby!

commit 6913c1327005cc49067f2974b9d7c95046d0d15a
Author: Saurabh Harit <0xsauby@users.noreply.github.com>
Date:   Fri Nov 20 02:52:20 2015 -0500

    Fixed the issue where a password with '@' breaks authentication
    
    Since impacket scripts use '@' as delimiter between the password and the IP address, a password with '@' (eg. 16char@Password) breaks the authentication.

commit 827a5594bf00ab54d447fc7b793c4165a15885c3
Author: Saurabh Harit <0xsauby@users.noreply.github.com>
Date:   Fri Nov 20 02:51:17 2015 -0500

    Fixed the issue where a password with '@' breaks authentication
    
    Since impacket scripts use '@' as delimiter between the password and the IP address, a password with '@' (eg. 16char@Password) breaks the authentication.

commit df661f4c145dbc3d861fce222d931446f602e8b6
Author: Saurabh Harit <0xsauby@users.noreply.github.com>
Date:   Fri Nov 20 02:48:27 2015 -0500

    Fixed the issue where a password with '@' breaks authentication
    
    Since impacket scripts use '@' as delimiter between the password and the IP address, a password with '@' (eg. 16char@Password) breaks the authentication.

commit 6e4a78a33d502ebd23fb5f6b27c281179a5d6fd1
Merge: 86c0743 97f0412
Author: 0xsauby <saurabh.harit@gmail.com>
Date:   Fri Nov 20 02:37:47 2015 -0500

    Merge branch 'master' of https://github.com/0xsauby/impacket

commit 86c07438310d360156d14c2c0edbd04dcd772531
Author: Saurabh Harit <0xsauby@users.noreply.github.com>
Date:   Fri Nov 20 02:19:15 2015 -0500

    Fixed the issue where a password with '@' breaks authentication
    
    Since impacket scripts use '@' as delimiter between the password and the IP address, a password with '@' (eg. 16char@Password) will break auth.

commit 97f0412f3e0a658703fd33e5dd6111d40cb191b4
Author: Saurabh Harit <0xsauby@users.noreply.github.com>
Date:   Fri Nov 20 02:19:15 2015 -0500

    Fixed the issue where the password with '@' breaks authentication
    
    Since impacket scripts use '@' as delimiter between the password and the IP address, a password with '@' (eg. 16char@Password) breaks the authentication.

commit 836463be6bf19c6e2207d054153570cb112ab42a
Author: asolino <bethus@gmail.com>
Date:   Wed Nov 4 11:40:24 2015 -0300

    Default `SMBConnection.readFile()` to a single SMB call attempt
    
    * That means it cannot be guaranteed all the bytes requested will be read
    * I'll leave it this way until I figure out some incompatibilities with other use cases (e.g. psexec)

commit f544da0e78af708e45c20af6ae7f450ed773e473
Merge: 3e5f763 1677bcf
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 18:54:02 2015 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit 3e5f763e55ed884e841aeeea93fbe277269e7123
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 18:49:35 2015 -0300

    SMBConnection.readFile() now tried to read the amount specified by bytesToRead parameter
    
    * Before, if `bytesToRead` was greater than the protocol's `MaxReadSize` buffer
    (dependant on the server's configuration), it would only read that amount of bytes.
    Now it will call `read_andx`() many times until it reached EOF or read all the bytes asked.
    * See https://github.com/CoreSecurity/impacket/issues/94

commit 1677bcfc7cdc1af264a2a970a9878063e95b8934
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 18:49:35 2015 -0300

    SMBConnection.readFile() now tried to read the amount specified by bytesToRead parameter
    
    * Before, if `bytesToRead` was greater than the protocol's `MaxReadSize` buffer
    (dependant on the server's configuration), it would only read that amount of bytes.
    Now it will call `read_andx`() many times until it reached EOF or read all the bytes asked.

commit 97cb9791326304d7ec6bd1d4c47a7df11950af75
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 18:35:40 2015 -0300

    Adding getIOCapabilities() method, used by SMBConnection object

commit ecb7981993066968d61907e5f723f449f378796e
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 12:27:45 2015 -0300

    No need to specify anything when calling getNTLMSSPType1
    
    * Less prone to encoding errors.

commit c960a8d031280cf07305bd3e28b1df7aec43e94f
Author: asolino <bethus@gmail.com>
Date:   Tue Nov 3 12:07:53 2015 -0300

    Encoding domain field using utf-16le, as specified in the flags field.
    
    * Fixes https://github.com/CoreSecurity/impacket/issues/107

commit 4da024267f99b20f853d771697c57580195b91e0
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 2 13:45:06 2015 -0300

    Fix for https://github.com/CoreSecurity/impacket/issues/106

commit 35ff60efb14d1259a250d766d7663a90e0419a54
Author: asolino <bethus@gmail.com>
Date:   Mon Nov 2 10:08:30 2015 -0300

    Extra checks when stripping leading '/'
    
    * Well.. let's verify there's a '/' there ;)

commit ad215d32df3ad21ebfa6086f20c236ecd17f3842
Merge: b6716a0 a45ff24
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 29 10:45:39 2015 -0300

    Merge branch 'scriptjunkie-ntlmv1fallback'
    
    Merging @scriptjunkie PR adding fallback parameter to SMB object. (See https://github.com/CoreSecurity/impacket/issues/102)
    
    thanks!

commit a45ff2426c39b9a90364bde02e40f2e36f369f21
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 29 09:46:23 2015 -0300

    Adding ntlmFallback parameter to SMBConnection.login()
    
    * If True it will try NTLMv1 authentication if NTLMv2 fails. Only available for SMBv1.
    * Defaults to True

commit 248aae3234d296605427000bd4d1beebd35f5022
Author: scriptjunkie <scriptjunkie@scriptjunkie.us>
Date:   Wed Oct 28 21:46:24 2015 -0500

    ntlmv2 enforcement option on SMB

commit b6716a0a164c1636fb578e6232320e903e1ab55d
Author: asolino <bethus@gmail.com>
Date:   Sun Oct 25 19:19:13 2015 -0300

    Cosmetic changes

commit 5842d99d7432df94f5adb006e09ab93485591d5e
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 22 15:17:53 2015 -0300

    Whenever -resumefile is specified, that filename is also used to keep updating the session state after resuming.
    
    * Why? If for some reason the connection is closed again (or you Ctr-C the script) the session
    state will be saved in the same file provided. So, in order to resume the session just execute
    the script again with the same parameters. Should be easier.

commit bc25c967d9f062a1445cfaa529286c1e32b187c7
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 21 15:16:16 2015 -0300

    Fixing raise misuse

commit f4be4a6844d04cd3d5a30e851469f5f0a639c881
Author: asolino <bethus@gmail.com>
Date:   Wed Oct 21 08:53:05 2015 -0300

    Raising exception instead of returning None

commit 72b4ca5fdf873d44298d08a0c279f62e56d61047
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 20 12:40:09 2015 -0300

    Removing +x perm

commit 1a525ebb86b09929f37dab85c9bd58fcf8e49e5e
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 20 11:16:50 2015 -0300

    Logging and exporting (optionally) captured NTLM/NTLMv2 encrypted hashes
    
    * Use -outputfile switch
    * Format is John the Ripper compatible
    * It will only log encrypted hashes after a successful authentication and before the actual attack (-e switch or default behaviour of dumping hashes).
    * Developed in the context of https://github.com/CoreSecurity/impacket/issues/100

commit d2abded84ae59594aaabf56311b91c36cd05ad42
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 13 16:34:15 2015 -0300

    Asks whether or not to keep the resume session file if you hit Ctrl-C during DRSUAPI

commit 004c350f2e704e92646bbc4e9b162cf42d42fce2
Merge: 5da9fae 0350006
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 13 14:13:15 2015 -0300

    Merging @s0crat PR #98 adding NTDS.DIT multiple PEK support (https://github.com/CoreSecurity/impacket/pull/98)
    
    Thanks Pierre!
    
    Merge branch 's0crat-master'

commit 03500067d36eac515282ea26748596b2f2b05018
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 13 14:12:05 2015 -0300

    Minor cosmetic changes.
    
    * Just to align existing coding convention

commit 39a0919143d4fc1452e47bfcffdec88acba2bd4b
Merge: 5da9fae 40d2e91
Author: asolino <bethus@gmail.com>
Date:   Tue Oct 13 12:52:07 2015 -0300

    Merge branch 'master' of https://github.com/s0crat/impacket into s0crat-master

commit 40d2e914bdf53a9914f8bd6ae49b57899550ad50
Author: unknown <ptaiani041812@FR09285928D.dsk.eur.msd.world.socgen>
Date:   Tue Oct 13 16:51:01 2015 +0200

    Add support for multiple password encryption keys (PEK)

commit 5da9fae9c0cf77a55e57b805ac79a33e206a1067
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 9 17:46:35 2015 -0300

    Adding queryInfo()
    
    * Queries basic info about an opened file descriptor

commit 8fb3768940e01e74c57274c1748375507905e3be
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 9 17:09:44 2015 -0300

    If UNC is specified in connectTree, we do nothing for SMB1 connections

commit 098296b4ef67fd9281a04f04a7ca7bee0adb8e4c
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 9 16:57:04 2015 -0300

    query_file_info() returns a buffer based on the fileInfoClass parameter
    
    * This is to match smb3.queryInfo()

commit b9b85004e17819fdf302e1177a46c791f09c5c81
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 5 15:32:00 2015 -0300

    Minor fixes for resume capability when using -use-vss flag

commit 18a3c42927dadeec90fc83dc55cfa8614b961fdb
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 5 15:18:19 2015 -0300

    NTDS.DIT resuming capability also works with output files
    
    * If you specified -o xxxx and you suspend the script, everything will be saved.
    * If executed against with -resumefile, the output files will be appended with the new data
    * At the end, you should have the complete set of data in the output files regardless of
      how many times you resumed the script. (assuming you're using the same parameters).
    * This commit is in the context of #85

commit bbff44d1fc555e2de2ffeef1e9f7bb89afd2946b
Author: asolino <bethus@gmail.com>
Date:   Mon Oct 5 09:18:16 2015 -0300

    Keep trying all the secret extraction approaches even if some of them fail.
    
    * You might be able to get hashes w/DRSUAPI and not being able to read SAM (e.g. using a DC machine account)

commit 10a5c954eea1f9c419ca5104f5619386fff7034c
Author: asolino <bethus@gmail.com>
Date:   Fri Oct 2 20:29:30 2015 -0300

    Adding Primary:CLEARTEXT Property from supplementalCredentials attribute
    
    * [MS-SAMR] 3.1.1.8.11.5
    * Available both for DRSUAPI / VSS
    * When using -o a '<outputname>.ntds.cleartext' file is created

commit ae5b1dce67a3d3171b198b769fd89dc7b33892af
Author: asolino <bethus@gmail.com>
Date:   Thu Oct 1 18:27:39 2015 -0300

    Adding resuming capability for NTDS.DIT dump (first try)
    
    * When dumping AD user's hashes/keys (DRSUAPI only) a session file will be created in the current directory
      having the latest SID successfuly processed. Filename is called `sessionresume_XXXXXXXX` (8 random chars)
    * If secretsdump finished succesfully, that file is automatically deleted
    * If the script is killed, or stopped (e.g. hitting Ctrl-C) that file will NOT be removed
    * You can resume the session by running secretsdump with the same parameters and adding the
    -resumefile <filename>parameter
    * You cannot disable secretsdump saving its state to a temporary file (would we want it?)
    * If you specify a resumefile for a different target, you're insane ;). I'm not checking that.
    * This commit is in the context of https://github.com/CoreSecurity/impacket/issues/85

commit c26f17fa00320cbd2ed7ea9fcefb3f0142aac8f4
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 28 12:24:02 2015 -0300

    Enabling dumping hashes/keys for WORKSTATION/SERVER/TRUST accounts by default
    
    * This was disabled in the past since I've got some decoding error reports. After
    all work in the NDR runtime I haven't seen any error again.
    * Please report an issue if some error pops up.

commit 02b083730bc207deacc939347b9495c297f7d14a
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 24 10:42:32 2015 -0300

    Adding debug message when connecting to the KDC

commit 9d4ea5f312229cc7bcb07ed4e674015a9fb261f7
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 23 11:01:33 2015 -0300

    Forgot to disconnect the portmap connection.
    
    * Should fix https://github.com/CoreSecurity/impacket/issues/93

commit 48a97f723a786fd3f0c65f921e9a6d40960e263b
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 23 11:00:30 2015 -0300

    Catching and showing error if lcd fails

commit 1a1e770bf89fac382195f308cdfb2a4daf76abf2
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 23 10:58:57 2015 -0300

    Adding cp437 encoding/decoding
    
    * Still not a final solution for will work much better on some foreign OSes

commit 2af5448b9b556e2071d01c507c2e0bdfe2e47883
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 22 21:43:45 2015 -0300

    Adjust referent data offset by 4
    
    * Since we're advancing 4 bytes first

commit fcbe4fd914250adf89d1d1bad178ae67e1de6a3e
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 18:01:28 2015 -0300

    Removing some debug info

commit e48e2d6c144c073706f9af12f569c0ac30dbf1b7
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 17:53:51 2015 -0300

    Explicitly changing the stdout encoding format if the script's output is redirected

commit 5ab22cf8c06b421f2518c571bad948170e2437c8
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 17:13:32 2015 -0300

    Trying give it a second try if there is a decoding issue happening
    
    * Especially important when dealing with international characters

commit c64a9c565f12668c523cf49e68195ea7445e0b3c
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 16:23:25 2015 -0300

    Using sys.getfilesystemencoding() instead of sys.encoding.stdin

commit b3b0407acb8bd1bf5b2584b782d2d5013a5cfcf6
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 16:09:34 2015 -0300

    Using sys.getfilesystemencoding() instead of sys.encoding.stdin
    
    * Works much better on Windows

commit fafbff2034c9930aaf1f9ea77521f6ccee3ae899
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 15:22:57 2015 -0300

    If the script's output is redirected

commit 1afb844b4b2460ecaf12c20bc99b36e8e6c82e98
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 14:12:33 2015 -0300

    Explicitly changing the stdout encoding format

commit 93b61a6c168daec0ca6dc6e761021ba5b3391612
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 14:06:38 2015 -0300

    Better way to detect no pwdLastSet was set

commit 594105211699835120b45bdcdc0335de96d02975
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 18 14:00:45 2015 -0300

    All files written are in utf-8 format.
    
    * Might have some consequences on Windows tho.

commit 879a2cf30bcf37632ad21eae76383dc935f88c83
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 17 18:32:52 2015 -0300

    Trying give it a second try if there is a decoding issue happening
    
    * Especially important when dealing with international characters

commit a893be5850b0abab92c9cb1493cc370550034dac
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 17 11:21:28 2015 -0300

    Adding optional -pwd-last-set switch for NTDS.DIT accounts output
    
    * Shows pwdLastSet attribute for each NTDS.DIT account. Doesn't apply to -outputfile data
    * Added a display options group as part of the scripts options (this will likely grow)
    * Some code simplicity change to cope with so many switches

commit 0524363e88f11355b974ebb66a7002bb7b8b3653
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 16 13:38:38 2015 -0300

    Applying same modifications as https://github.com/CoreSecurity/impacket/commit/1f3cbff8df56344ba4d5552b0ddb8f3cb095194d to goldenPac and raiseChild

commit 1f3cbff8df56344ba4d5552b0ddb8f3cb095194d
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 16 08:55:01 2015 -0300

    Fixed error when targeting a 2012R2 DC with AD Recycle Bin enabled
    
    * DRSGetNCChanges() was returning ERROR_REVISION_MISMATCH
    * Problem was in the dwFlagsExt and dwExtCaps of the DRSBind() method
    * Thanks @carnal0wnage for reporting and helping debugging this issue.

commit 8f209f0731b0dff06ab5eb725e53aa8f0562ed68
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 15 22:45:23 2015 -0300

    Adding more debug info to help diagnosing issues

commit 488fddd1221fcf454e8bced7c9d034a1a40945fb
Author: Or Dagmi <or@digmi.org>
Date:   Sat Sep 12 15:15:31 2015 +0300

    Adding ERP and Country elements to Beacon

commit d46cb154e8dd2c1028e717a2e77059605a2ecfeb
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 11 14:39:46 2015 -0300

    We have to add some SMB flags just in case the original client did not
    
    * Why? needed for avoiding INVALID_PARAMETER when calling FIND_FIRST2

commit 37ebbbbb7d219edc099ab77b62b7855d24868956
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 11 13:47:57 2015 -0300

    Testing all DCs in domain and adding forest's enterprise admin group inside PAC

commit 501482862c7c8d561b2ee28c309cccd12328e8b1
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 18:41:56 2015 -0300

    Code optimization
    
    * Taking advantage of previous NDR.fromString() work done (https://github.com/CoreSecurity/impacket/commit/da05308c042c737d64311c336382ae99b25da1a5)

commit 5c6df1b20a488ef80c6b40784aa784b96d343529
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 18:32:54 2015 -0300

    Looping over the GetNCChanges until there's not more data
    
    * This test could take a lot of time to complete, be aware

commit 3cfe3912159be7c938a5eccd3da112e6e127391a
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 17:31:39 2015 -0300

    Removing dup setArraySize() call

commit 6e25540f0d9e8a2ba875b5b0a37f677faf1ef25d
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 15:44:06 2015 -0300

    Code cleanup

commit c6d57a5aed6f3e8da119d2083a50d52762806ea1
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 12:44:16 2015 -0300

    Moving calcUnPackSize() into unpack()
    
    * Makes code way easier to read

commit da05308c042c737d64311c336382ae99b25da1a5
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 10 12:18:11 2015 -0300

    NDR fromString() now returning bytes processed
    
    * Instead of returning self. Makes things way easier. No need to have getFromStringSize() and arraySoFar.

commit 59af4903bc1ea3f1346a2fc6ea9177c85a8c68a6
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 8 20:36:07 2015 -0300

    Being consistent with what we put inside the try/except clauses

commit 6cebec00f7cf3f09d4112a8df5f021af7f912784
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 7 12:10:24 2015 -0300

    Adding TCPTransport test cases

commit 7c08162c4f508113eec10348c48caad5cad663a0
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 7 12:04:27 2015 -0300

    Adding NDR64 tests

commit 4c8470e20e74591e4478dd1327b720852bb76a1b
Author: asolino <bethus@gmail.com>
Date:   Mon Sep 7 12:00:00 2015 -0300

    Adding the NDR64 testcases. Working now

commit 9b1a71443267f561ecd581684ab8fcd51f2a23a4
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:28:28 2015 -0300

    Adding more test cases to this file

commit 9e98a6803ada9ff1aff3437c2bb8ae404b3de145
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:22:23 2015 -0300

    Wrong branch

commit 144c1f81f604b9c71f5429661c1ee790a8b28f93
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 31 09:19:23 2015 -0300

    Adding NDR64 tests

commit 39c641478d075021e4b3334672868c0a9daef850
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 30 23:52:36 2015 -0300

    NDR Runtime test cases

commit c0c233b17e8a8908cae013e7b9caaf685ee584fc
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 30 23:52:15 2015 -0300

    Adding new testcase for GetNCChanges

commit 7ee5bf3138f85a8b2c48c54742579371ab5fb45a
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 30 23:48:16 2015 -0300

    debug attribute not used anymore

commit 8a265c0c4885c8b5cd2d5b4f8465646e5ebbb68c
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 30 23:47:40 2015 -0300

    Removing some debug messages

commit 15d75ec8a315b0c2570b72a594fdb109fba50bc5
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 30 23:33:31 2015 -0300

    getArraySize() also used in NDRSTRUCT.fromString()

commit 8d53ff2b6aba4b829a0fabe34e73039145ca1c1e
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 19:44:24 2015 -0300

    Not counting arraySize when dealing with NDRUniConformantVaryingArray.
    
    * MaximumCount could be larger than ActualCount

commit ce404d4a791aec3e744fed9732f98a3a472af3df
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 17:44:11 2015 -0300

    With the new NDR runtime we don't need this workaround fix

commit 6dd24d89592e2691097540bf0aca05497332bcf3
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 17:33:39 2015 -0300

    Adding UNKNOWNDATA data type

commit fc2bdb8f3ba7f2d882cb9ea784d636f6715eeaa0
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 17:10:57 2015 -0300

    Enclosing more statements inside try clause

commit b14a7e35af95006d294f29400857a38e18df1c5b
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 16:59:52 2015 -0300

    Missed alignment before the size data

commit 95844c75b3a8aea1ad9a28c048a091b2c80195b3
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 16:22:32 2015 -0300

    Adding getArrayMaximumSize() as a way to manage those situations where MaximumCount != ActualCount

commit 2824cd79fff937c06d6306affb3dd6ee1fc9e188
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 14:24:04 2015 -0300

    Replacing code that is already in NDRCONSTRUCTEDTYPE.getArraySize()

commit abf6511655e5aa0562ab1f84621abb0a85ad355c
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 28 13:31:31 2015 -0300

    NDRUniConformantArray and NDRUniConformantVaryingArray don't unpack arraySize anymore
    
    * This will need to be done manually and later on update using setArraySize/getArraySize
    * Why? It is more straighforward since the arraySize in structures is always at the begining of
    the structure rather than before the array stream. We had to make some calculations that are prone
    to fail.
    Still not all test cases working tho.

commit 2362e6ae03aae5b3224960bece598d4810e0b73d
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 15:36:54 2015 -0300

    Leaving a single getData/fromString for most of the arrays

commit 8a8fa1691c79c3c6902b81a6a39de73f8de55da1
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 13:28:38 2015 -0300

    Added restrictions for packing/unpacking referent data from arrays

commit 74ced655f40729f9232f1715d4fb43d907e5f142
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 10:31:51 2015 -0300

    Aligning NDRUNION structure when packing/unpacking

commit de0807b5c0d942f86076a2d32d5a46e8fb98be3c
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 09:35:12 2015 -0300

    Adding getAlignment to SCMR handle structure

commit 51c7f2ab07f211fe149259a875645946e8b84454
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 26 08:57:15 2015 -0300

    Properly prepare the data buffer when dealing with a pointer to an array

commit 423645e04797e0e6a58c07029809b74f4d77f6fc
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 23:16:15 2015 -0300

    Checking arraySoFar inside NDRUniConformantVaryingArray.fromString()

commit 5acd135958aca30157394c7862f0b2656e232a18
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 22:00:59 2015 -0300

    Removing debug message

commit c303ab3ed85708eb1652576f20df0a0c4fca6589
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 21:42:00 2015 -0300

    Adding the now required getAlignment to string structures

commit 71fdd7e7eb313c00321b81b3d05c580c768223ad
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 19:15:45 2015 -0300

    Adding alignment for SAMR_HANDLE

commit 09c325bebd0b71b3bd0d80ea876497b83572b6f8
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 19:09:36 2015 -0300

    Code cleanup + NDRPOINTER strict alignment
    
    * There's some code I won't use for now. If I need it again, I'll rewrite

commit b57e4b515e3fcd1c84ac029aca0a6376d8f8c490
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 16:44:05 2015 -0300

    Code Cleanup

commit e3a6d266a650ceb7ba4ed89bdaaea32f67171027
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 16:30:45 2015 -0300

    Code cleanup
    
    * Removing fromStringOld and calculatePadOld
    * Moving calcPackSize and calcUnpackSize array stuff into NDRCONSTRUCTEDTYPE. Not ideal yet but much better
    than having it inside NDR

commit a50f7ff2f1028b1094dc74069f2df4c5da3342ef
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 16:17:22 2015 -0300

    Code cleanup
    
    * Moving isUnion()/isPointer() to NDRCONSTRUCTEDTYPES
    * Removing array packing from NDR.pack(), was already in NDRArray.pack()

commit e63345bc0cac03a1d70bfe8a4e9b480bd3cb00ee
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 16:12:47 2015 -0300

    Adding a NDRCONSTRUCTEDTYPE class
    
    * Helpful to better organize methods
    * NDR class is only meant for NDR primitive date types
    * Changes some interfaces data types from NDR->NDRSTRUCT

commit 72264b8b8a0c4016f1d12e620366756911288a1d
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 15:56:26 2015 -0300

    Moving NDRCALL down in the file

commit 8c4601c2708c4355eaf6074f0afcadb6f4a27e44
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 15:23:33 2015 -0300

    More padding adjustements
    
    * NDR trailing GAP padding disabling for now

commit 756043352acfd2d0b7dce9b5aa54179f918f489f
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 13:23:13 2015 -0300

    Forgot changing also the data available

commit f44a9eafaa165d8462073110ba192a4c704db3e9
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 13:16:31 2015 -0300

    Checking NULL Pointer correctly for NDR64

commit a1dfdbbf4b6edecd7cb5cc0b7fecead301f1a4a8
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 25 12:22:26 2015 -0300

    More code cleanup
    
    * Removed CONSISTENCYCHECK code
    * calculatePad redefined
    * NDR is our Primitive Data class
    * array pack/unpack moved to NDRArry.pack() NDRArray.unpack()
    * Alignment is being done only in the places needed
    * getDataArray renamed to getData
    * fromStringArray renamed to fromString
    * NDRPOINTER needs to align itself before moving on

commit 26e9d08e455e622bf0a25670d24ca4cfc70d19b7
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 24 18:42:44 2015 -0300

    Removing unused variables and code cleanup
    
    * self.data, self.rawData
    * switching to @staticmethod for isNDR, isPointer and isUnion
    * Removing some debug messages and changed expections

commit 5a81fa918322b1fb0a84b2fe11cff06ff77501bf
Author: asolino <bethus@gmail.com>
Date:   Tue Sep 8 17:58:38 2015 -0300

    Updated doc

commit de53731514e6d78dbdae4f2c35eac1e08950ceb0
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:24:41 2015 -0300

    Fixed typo

commit 8f2499e94a73be7148abf3f8d153c593bb4d9244
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 15:22:55 2015 -0300

    Disabling some test cases that are dangerous against a DC.
    
    Use them at your own risk.

commit 46c2dffbda9d83af9bc11f8d982bee5728bdfebd
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 14:30:40 2015 -0300

    NDR64 for drsuapi still not working

commit 9494c2693f7c5e3f5029791c4d8fc4c80222ebbe
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 14:27:01 2015 -0300

    Adding extra debug information

commit be5ad45851ced0859bbf6fa29bf69afa3bc0db73
Author: asolino <bethus@gmail.com>
Date:   Fri Sep 4 14:05:43 2015 -0300

    Checking DRSCrackNames's rItems status answer as well to verify everything is ok
    
    * Thanks @gentilkiwi for pointing this out

commit f8959be0354857e1658e34e183be05b04c4e49eb
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 3 20:37:19 2015 -0300

    Reliability fixes
    
    1) Using getDNSMachineName() instead of getMachineName() so we have higher chances to resolve the target machines
    2) If the ticket we're making golden doesn't have an ExtraSid already, we need to state ExtraSids are being present in validationInfo['Data']['UserFlags'].
    3) 'Administrator' is not always the name for S-1-5-21-domain-500. Shame on me and all non-us folks
    Thanks @gentilkiwi for your feedback!

commit 3062d8d44e07bec08ede11022815f961e1a46347
Author: asolino <bethus@gmail.com>
Date:   Thu Sep 3 18:55:37 2015 -0300

    Child domain to forest privilege escalation exploit
    
    This script implements a child-domain to forest privilege escalation
    as detailed by Sean Metcalf at https://adsecurity.org/?p=1640. We will
    be (ab)using the concept of Golden Tickets and ExtraSids researched and implemented
    by Benjamin Delpy (@gentilkiwi) in mimikatz (https://github.com/gentilkiwi/mimikatz).
    The idea of automating all these tasks came from @mubix.
    
    The workflow is as follows:
        Input:
            1) child-domain Admin credentials (password, hashes or aesKey) in the form of 'domain/username[:password]'i
               The domain specified MUST be the domain FQDN.
            2) Optionally a pathname to save the generated golden ticket (-w switch)
            3) Optionally a target to PSEXEC with Enterprise Admin privieleges to (-target-exec switch)
    
        Process:
            1) Find out where the child domain controller is located and get its info (via MS_NRPC)
            2) Find out what the forest FQDN is (via MS_NRPC)
            3) Get the forest's Enterprise Admin SID (via XXX)
            4) Get the child domain's krbtgt credentials (via MS_DRSR)
            5) Create a Golden Ticket specifying SID from 3) inside the KERB_VALIDATION_INFO's ExtraSids array
               and setting expiration 10 years from now
            6) Use the generated ticket to log into the forest and get the krbtgt/admin info
            7) If file was specified, save the golden ticket in ccache format
            8) If target was specified, a PSEXEC shell is launched
    
        Output:
            1) Forest's krbtgt/admin credentials
            2) A golden ticket saved in ccache for future fun and profit
            3) PSExec Shell with Enterprise Admin privileges at target-exec parameter.
    
    IMPORTANT NOTE: Your machine MUST be able to resolve all the domains from the child domain up to the
                    forest.

commit 81b92d4f3ce6308e45b5e40ab765575660a85cca
Author: asolino <bethus@gmail.com>
Date:   Wed Sep 2 17:01:21 2015 -0300

    Adding some Kerberos crypto constants

commit fd455a6baf1378e50434a1e1a755e981bd0b6f5e
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 31 17:14:38 2015 -0300

    Keep asking TGS until we get the one we want.
    
    * This should only happen when jumping from one domain to another.

commit d7a7950d972cf9721c03796094af7b015e3fc77d
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 27 13:35:15 2015 -0300

    Adding -just-dc and -just-dc-ntlm options
    
    * -just-dc -> Extract only NTDS.DIT data (NTLM hashes and Kerberos keys)
    * -just-dc-ntlm -> Extract only NTDS.DIT data (NTLM hashes only)
    * Fixes https://github.com/CoreSecurity/impacket/issues/84
    * Also fixed a silly logic check that was preventing to parse NTDS.DIT files after we added DRSUAPI

commit 745e6d5f681c5060ba5b8c0cdc0d1b1cc4dc8ab2
Author: asolino <bethus@gmail.com>
Date:   Thu Aug 27 10:47:09 2015 -0300

    DRSGetNCChanges only asks for the AD attributes we're interested in.
    
    * The attributes asked are:
     userPrincipalName(1.2.840.113556.1.4.656)
     sAMAccountName(1.2.840.113556.1.4.221)
     unicodePwd(1.2.840.113556.1.4.90)
     dBCSPwd(1.2.840.113556.1.4.55)
     ntPwdHistory(1.2.840.113556.1.4.94)
     lmPwdHistory(1.2.840.113556.1.4.160)
     supplementalCredentials(1.2.840.113556.1.4.125)
     objectSid(1.2.840.113556.1.4.146)
    * Lowers traffic generated
    * Helps minimizing parsing issues
    * Supposed to fix https://github.com/CoreSecurity/impacket/issues/83. Retest needed

commit e6ec7297eb4b4799a6e048222a7e27dc03a2d1fa
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 24 13:37:24 2015 -0300

    Added support for Windows 2003 DC
    
    * Turns out EXOP_REPL_SECRETS and in fact not supported in w2k3:
    <24> Section 4.1.10.1.3: The Replicate Single Object including Secret Data extended operation is supported by Windows Server 2008, Windows Server 2008 R2, Windows Server 2012, and Windows Server 2012 R2.
    * Forgot to add DRS_WRIT_REP to the ulFlags.
    These two changes made the trick!
    * Tested against Win2k3/Win2k8r2/Win2k12R2
    
    Big thanks to @gentilkiwi for pointing out this wasn't working and help finding possible solutions (e.g. the ulFlags issue).

commit 7b78da36b986f0ff33f1f0c9a212870196144cfa
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 23 17:39:36 2015 -0300

    Cracking users using their SIDs instead of their name.
    
    Why? There could be problems when dealing with a forest with multiple subdomains in there
    and referencing the accounts by names.
    Thanks @gentilkiwi for pointing this out!
    I haven't been able to test it but this should solve the problem.

commit 8865ea30f247547d30465a5958225ac71074f085
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 19 11:34:13 2015 -0300

    Not processing machines' accounts for now.

commit 5aeb8ed5bf624c83327445e9265371d0aa111861
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 17 20:29:02 2015 -0300

    Restrict the amount of data to dump when an unpacking expection is printed.
    
    * Handy when we're unpacking a huge buffer. (i.e. DRSGetNCChanges())

commit e514994de1a841358c8ff707e1600e3f9fd7ad63
Author: asolino <bethus@gmail.com>
Date:   Sat Aug 15 18:30:33 2015 -0300

    Disabling parsing rgValues (PREPLVALINF_ARRAY).
    
    * It was reported unpacking errors with that field. Since we don't use it,
      and it's the last pointer, we can discard unpacking it, until we figure
      out what's going on.

commit 8dd7e36e922e1f049163abcbed295dcee25cc4e2
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 14 14:41:00 2015 -0300

    Inside smb3.logoff() we clear the stuff we used in case we want to authenticate again
    within the same connection

commit c8a8e442cb1e24af0eb1ed88ed97b0cd55118e64
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 14 13:01:55 2015 -0300

    Changed requested permission when opening users
    
    * Now we ask for samr.MAXIMUM_ALLOWED so we get more information
    back in the samr.USER_INFORMATION_CLASS.UserAllInformation structure.
    * Fixes https://github.com/CoreSecurity/impacket/issues/81

commit c22b3f6958e02252d4a71eaad308fe661bb7a6ea
Merge: 66901e7 3dc9df2
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri Aug 14 11:38:43 2015 -0300

    Merge pull request #80 from byt3bl33d3r/master
    
    fixed __init__() error in smbrelayx.py and added .gitignore

commit 3dc9df20a6083cd9ce4e701c6024508fed116f14
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Fri Aug 14 15:50:34 2015 +0200

    fixed __init__() error in smbrelayx.py and added .gitignore

commit 66901e7dd81c9a9ca602438a1e7bafcee707a74d
Author: asolino <bethus@gmail.com>
Date:   Wed Aug 12 18:16:17 2015 -0300

    Adding support for CIM_ARRAY_STRING unpacking and...
    
    * Aiming at solving https://github.com/CoreSecurity/impacket/issues/79
    * ENCODED_STRING() now calculates the string length
    * Fix small typo with CIM_TYPE_ENUM.CIM_TYPE_UINT8 and CIM_TYPE_ENUM.CIM_TYPE_SINT8

commit b0294f3a1af46d307ba5c39d8da10dec384ceb33
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 11 15:30:30 2015 -0300

    Adding DRSVerifyName() test case

commit 008f3eafcd914ec97d8b7166af5ab15fbb4a29e8
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 11 15:27:11 2015 -0300

    Returning the string representation instead of the pyasn1 instance

commit 46448f9440a1ff68661737cccc8f2cadd648e113
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 10 20:02:24 2015 -0300

    Added 5.16.4 ATTRTYP-to-OID Conversion helper functions
    
    * EXOP_ERR.dump() now prints the hex number if no item is found

commit dbd7c993bf5fe9a681453c7f3abdd620d065f2ec
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 10 20:01:15 2015 -0300

    Initializing arrayPadding variable

commit 0f5f7ca3057a5b5bf8845f27b982fd7d5261b624
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 9 19:46:37 2015 -0300

    Change PAD patterns for debugging purposes

commit ec7688c3e14cdd96c8e0d125e092fe2f5917e04c
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 22:36:08 2015 -0300

    Unit tests now work if the target machine has many accounts available

commit 1bc241638d4d1a5b4a2abc00f9ca69b8df86f8c3
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 22:15:58 2015 -0300

    Removing unnecesary try: catch: clauses

commit 2f6911155e0a61744dc53dfd5627962db9af4b38
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 20:26:35 2015 -0300

    Adding EXOP_ERR Codes and adjusting DRS_MSG_GETCHGREPLY ulExtendedRet field
    
    * ulExtendedRet is now type EXOP_ERR so you can see the string result
    when you dump() the DRS_MSG_GETCHGREPLY union.

commit fb7e250d75c269ad1754bf5e52950bff5e9cdb64
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 20:11:12 2015 -0300

    Fixing hept_map() so it works in Windows 2003 AD
    
    Under Windows 2003 the Referent IDs cannot be random
    they must have specific values
    otherwise we get a rpc_x_bad_stub_data exception

commit e87b25f319553861d70c47a567565c38d5758bcd
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 17:19:09 2015 -0300

    Adding USER_SERVER_TRUST_ACCOUNT and USER_INTERDOMAIN_TRUST_ACCOUNT when listing target users

commit 116e8a5f457cf716fcfa2aa5e7786cdc52409575
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 17:06:34 2015 -0300

    Oops, forgot one comma!

commit 5abd32150fa2767543e6f5edc6a8b780052ce802
Author: asolino <bethus@gmail.com>
Date:   Fri Aug 7 16:55:39 2015 -0300

    DRSUAPI support for NTLM hashes history and Kerberos keys (Sup. info)  added

commit 506431dc1ed8fc052616149eda43a9f8f1e7916d
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 4 22:52:47 2015 -0300

    OldPwdHashes, when empty, are '', not None

commit 12e6ca483473f1596554b82135db125d17684642
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 4 08:12:46 2015 -0300

    Fixing typos in methods and variables

commit d194b86e8ab58725d7583b7677e00b5f12905799
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 4 08:03:05 2015 -0300

    Setting alignment explicitly for this array until we fix it elsewhere

commit 7fb4fe2b8b9af6de42402f5b2a40406262f060c4
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 4 03:03:05 2015 -0300

    Fixed typo in variable name

commit e5af7102ee145ba6e0977c24e32c572335d1f127
Author: asolino <bethus@gmail.com>
Date:   Tue Aug 4 02:45:16 2015 -0300

    Adding [MS-DRSR] DRSGetNCChanges approach to download users hashes
    
    * In a nutshell, we ask to replicate a single DSNAME instead of the whole NC.
    [MS-DRDS] "4.1.10.5 Server Behavior of the IDL_DRSGetNCChanges Method details"
    the steps you need to follow to be able to download a single DSNAME.
    Check also "4.1.10.5.12 ProcessFsmoRoleRequest"
    This approach works way faster than VSS and it's also a cleaner implementation.
    * Should work ok with pass-the-hash/ticket/keys
    * Pending history and Kerberos keys dump
    * Old VSS method is still available by using the -use-vss switch.
    
    A lot of testing needed!
    
    Kudos to Benjamin Delpy (@gentilkiwi) for publishing first his tool dsync which
    implements a similar approach (I think). Always rocking:
    https://github.com/gentilkiwi/kekeo/tree/master/dcsync

commit 455260e700e2469d66075849e87ee175b6d4517d
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 3 15:46:56 2015 -0300

    Adding get_session_key method to retrieve the session key from RPC runtime
    
    * This is used for example, by DRSUAPI to decrypt some secrets

commit d5cc2752da68228e24c16b7b0d52e26f77f6301a
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 3 09:41:47 2015 -0300

    Adding example for obtaining the target user's hash.

commit 5d1c29b91c191f629d2108caee75c98411ade44e
Author: asolino <bethus@gmail.com>
Date:   Mon Aug 3 09:40:35 2015 -0300

    Adding the ability to decrypt secret attributes

commit b4677668a28bf604dc914adcd6412f2b87a28e5b
Merge: bec9abc cf97e9d
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Sun Aug 2 17:21:42 2015 -0300

    Merge pull request #76 from Hexadite/raise_ioerror
    
    raise socket error instead of exception

commit bec9abc722afb9f071474e3a474f6490d8927700
Author: asolino <bethus@gmail.com>
Date:   Sun Aug 2 17:17:53 2015 -0300

    No need to align before unpacking array referents
    
    The alignment check is performed later in the process

commit cf97e9deda89207c60bdf323c0a77e4419ee3932
Author: Omri Kantor <Omri@hexadite.com>
Date:   Sun Aug 2 10:49:24 2015 +0300

    Exception is to general, should catch socket.error and couple it with additional information.

commit bd54fbfaf9946496082dd9c9581e6ec168a2b81c
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 31 19:51:55 2015 -0300

    Fixed linked list issue with NDR in REPLENTINFLIST.
    
    * Minor changes and typos from the standard document
    * DRSGetNCChanges() finally working great!

commit b24c039d4d8e0a84c5b84b82e6ca54dc5ba38429
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 31 19:42:03 2015 -0300

    Adding lcd (local Change Directory) command
    
    * Wondering why it wasn't there before

commit 21a94333c69737099e7551f7a8ca4fa888ee5597
Author: asolino <bethus@gmail.com>
Date:   Fri Jul 31 19:37:17 2015 -0300

    NDR performance improvements and alignment changes
    
    * Now we're counting the bytes we're advancing through the buffer at the same
      time we're unpacking data types, instead of packing the whole thing back to
      check its length. This should increase performance substantially, especially
      when dealing with big arrays of objects.
    * Fixed some alignment issues when dealing with arrays, especially with the
      size item that preceeds the array.
    Test cases are passing the same way before this commit. However we should
    test this a lot since screwing up with NDR alignment means an unpacking failure.
    Testing needed!

commit 8532e1ee7b28c58c308a5063f9f7792f42919264
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 29 21:32:34 2015 -0300

    Fixing some alignment issues in the NDR.
    
    * It was being triggered in high loaded arrays
    * There are still some issues pending to solve

commit 1fa4e23c0601edb61e28a50c1882e71c5c302688
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 27 20:53:04 2015 -0300

    Removing debug message

commit d724dd6bbf8d4ef46b924c284dc017109c8a662a
Merge: bdfc9d9 f181e6d
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 25 12:25:01 2015 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit bdfc9d9ac994e1be84bed8b9379b858b4a8b74b6
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 25 12:23:16 2015 -0300

    [MS-DRSR] Directory Replication Service DRSUAPI Interface implementation
    
    - Just starting
    - Test cases added as well

commit dee68bc06e2839e2d6c820d6cc4ace6de95545c1
Author: asolino <bethus@gmail.com>
Date:   Sat Jul 25 12:22:38 2015 -0300

    Adding ULARGE_INTEGER and PULARGE_INTEGER types

commit f181e6dc006f3f85bf5b971d51dbf70732e7200d
Author: 6e726d <6e726d@gmail.com>
Date:   Fri Jul 24 14:53:48 2015 -0300

    Extended present flags support on RadioTap class.
    
    - test_RadioTap.py PEP8 compliant.
    - Modified dot11.py to add support for extended present flags on the
    RadioTap class.
    - Added Radiotap extended present flags tests on test_RadioTap.py.

commit 67ff4f5ae3d5b60fc133d98c34e8523109809c7d
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 23 12:26:50 2015 -0300

    Don't call finish() when there are no instances created.

commit 2d189d58cc0aef1521d13bb4af8be16160ff0a6e
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 23 12:20:14 2015 -0300

    Cleaning up RemoteOperations() activities as well when job's done.

commit 322a3fdc2e4ad37098ce09a27d1a6cc11baa3e93
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 23 12:11:46 2015 -0300

    Dumping target's host hashes if -E switch not specified (only admin).
    
    Be sure secretsdump.py is present in the same directory as smbrelayx.py
    (default if the library is installed using `python setup.py install`).
    Have in mind you can put any code you want in the `doAttack.run()` method.

commit ebcbd20aefb6cab3f9e4afe333cee8e04b7485e6
Author: asolino <bethus@gmail.com>
Date:   Mon Jul 20 09:45:43 2015 -0300

    Added extra check when parsing FIND_FIRST2 responses
    
    - Samba 3.6.9 doesn't set record['NextEntryOffset'] to 0 for the last
    record. Don't know exactly why, 'cause [MS-CIFS] clearly states that:
    
    `NextEntryOffset: (4 bytes): This field contains the offset, in bytes, from this entry in the list to the next entry in the list. If there are no additional entries, the value MUST be zero (0x00000000).`
    
    Now we're checking we reached the end of the buffer, just in case.

commit 5adde556af86317cf8c80a33446fb27ef69ed9ff
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 16 19:38:54 2015 -0300

    Commands are now executed using ITaskSchedulerService interface
    
    * We were previously using ATSVC Interface
    * It now should work with Windows 2012 R2, fixing https://github.com/CoreSecurity/impacket/issues/70. We should test older Windows versions.

commit 3c78caaaf86dd4739e0a18ea6961c7c8c4340da3
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 16 18:59:20 2015 -0300

    Adding hSchRpcRegisterTask helper function
    
    - Fix the definition of PTASK_XML_ERROR_INFO

commit c2f3ca55d7436ddd2c9dfadbf11bf3e067fada04
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 15 19:30:48 2015 -0300

    Upgraded to DCERPC.v5 runtime and Kerberos support added.
    
    Still does not solve https://github.com/CoreSecurity/impacket/issues/70 tho.
    Most probably the atsvc interface is deprectated in Windows 2012 R2.
    We have to try now using ITaskSchedulerService.

commit 5f2ffd3ad6ed96242c4ee57403c7cc3607ec7964
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 15 19:29:48 2015 -0300

    [MS-TSCH] ITaskSchedulerService Interface implementation and test cases.

commit 271f1dc3945724eb992cb74452bb019b3ac2bf3b
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 15 19:29:07 2015 -0300

    Adding [MS-DTYP] 2.3.13 SYSTEMTIME

commit 41c1dcd7c0ec7808ef249c3f31b7e2bde5e7ace5
Author: asolino <bethus@gmail.com>
Date:   Wed Jul 15 19:28:41 2015 -0300

    Minor cosmetic changes

commit 6203d3fa1fc532b12c7409594c35b48d088bb85c
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 9 18:29:24 2015 -0300

    [MS-TSCH] SASec Interface implementation and test cases.
    
    ITaskSchedulerService left.

commit 3e1f7707677a95098c4e6426d726f2f8b98ed496
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 9 17:17:35 2015 -0300

    [MS-TSCH] ATSVC Interface implementation and test cases.
    
    For now just the ATSVC, now going for SASEC

commit 292621b1e807d3395021d88d66faac708fb3b4d8
Author: asolino <bethus@gmail.com>
Date:   Thu Jul 9 16:37:03 2015 -0300

    Capturing output from stderr as well.
    
    Applying patch from @sshock described in https://github.com/CoreSecurity/impacket/issues/73

commit 7ac7b28bff5865c47ea833812b9dbd6a65c2c3a4
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 30 15:30:58 2015 -0300

    Using self.get_target for DCOM StringBinding calculation.
    
    If we specify a FQDN as the target when initiating a DCOMConnection,
    we replace the aNetworkAddr with self.get_target(). This is to help resolving the target system name.

commit ee53b2a39052d79c2812f9712badb0eca452b348
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 26 14:19:16 2015 -0300

    Adding LOG.debug message for the string binding chosen

commit 04518d7ae183af04b65719ec5d5ab60f4ac5635b
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 26 14:15:18 2015 -0300

    Improved DCOM StringBinding calculation
    
    1) When we need to connect to an interface, a list of possible string bindings are sent. Now we're trying to match self.get_target() as much as possible.
    (e.g. self.get_target() is IPv6, then we'll try to get an IPv6 binding, etc)
    2) DCOMConnection.disconnect() now clears the INTERFACE.CONNECTION dictionary
    3) Minor cosmetic changes

commit 6e9024f6b165754b7d31cba27a4e3aa8fedb55e5
Author: asolino <bethus@gmail.com>
Date:   Fri Jun 26 11:49:20 2015 -0300

    Missed break would loop forever when passing a ticket for TDS auth

commit 8c094b79987401a850a03e9999753bc283dccae9
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 25 09:50:19 2015 -0300

    Adding eXecute permissions to the scripts, fixing https://github.com/CoreSecurity/impacket/issues/71

commit 5befbacb4f89fc1539b1fc9c4302ff777c26c770
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 24 18:02:34 2015 -0300

    Adding ULONG_PTR and DWORD_PTR data types

commit 6dfc966bf694e9ec80fab0a23ac01e150ff63b91
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 24 18:01:48 2015 -0300

    Adding debug message when fallbacking to RC4

commit 6ff37c74c975b6940a2dd81d8a57143c39b9fff2
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 24 18:01:07 2015 -0300

    Catching exceptions when login in.

commit b28a55bc4d65fc4da24701b13984ccf008c7b6ab
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 24 17:29:25 2015 -0300

    Adding Kerberos support to TDS (MSSQL)
    
    - Pass the hash/ticket/key support
    - mssqlclient.py: added -k, -aesKey flags

commit e66337e99e9668086b90039df5140b9439625249
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 16 18:55:16 2015 -0300

    Fixes queryFileInformation() bug for SMBServer (SMBv1)

commit 148c0debcc33ce2888b96d5049bb0a998cacc400
Merge: 8a1239f 7d2dbe5
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 16 16:46:30 2015 -0300

    Merge branch 'rdubourguais-master'
    
    Adding 'Flags management inside SMBv1 stack' and in particular allowing to have UNICODE support for SMBv1
    Thanks @rdubourguais!

commit 7d2dbe5044daa595a8067d002e7cf9f961968aaf
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 16 16:35:59 2015 -0300

    Fixing code for failed test cases for SMBv1
    
    1) test_smb.py: flags2 MUST include smb.SMB.FLAGS2_LONG_NAMES otherwise FIND_FIRST fails
    2) smb.py: check_dir(), remove() and rename() weren't having UNICODE support. Added.
    3) Replacing tabs for spaces

commit b6ea954cc3c9473b6c4100b9a63696903435bf37
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 14:45:35 2015 +0200

    bug fix: check version length before setting __server_os_* in smb.py

commit 7319e5fef6733c3a5f1277e01ba6aa45e58f4324
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 11:20:54 2015 +0200

    Will be managed during negotiation.

commit 2b0b994fddf825941f37391f14d756013dd73816
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 11:18:58 2015 +0200

    Remove duplicate code.

commit 57b119454ed604c2024db4143c1dabbf569721cd
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 11:16:27 2015 +0200

    small bug fix.

commit 328caf150446658ec2621e7a2cd28e6c39cc8da0
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 10:49:24 2015 +0200

    Improve SMB header's flags management and code refactoring

commit cd1d22f392d881b7a4917d16b0fdddf5583bd03e
Merge: cc96628 8a1239f
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Tue Jun 16 09:48:25 2015 +0200

    Merge remote-tracking branch 'upstream/master'

commit 8a1239fd8b7c123e2e743a33cfab3d1107b2b0e0
Author: asolino <bethus@gmail.com>
Date:   Mon Jun 15 20:22:34 2015 -0300

    Adding a new test suite for Unicode Support on SMB1
    
    Feature still not there but the idea is to implement it using manualNegotiate
    and setting the appropiate flags using SMBConnection.negotiateSession().
    Check https://github.com/CoreSecurity/impacket/issues/51 for details.

commit cc96628d0d94d230d67cbfbffc8f965ad44cccfc
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Mon Jun 15 19:37:20 2015 +0200

    Start unicode integration using self.__flags1 and self.__flags2.
    Removing talk* approach.

commit a345fc1c8c94499a455cf59b2c9b757a41aec60d
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Mon Jun 15 10:35:05 2015 +0200

    Bad attribute name fix.

commit 292960fe97a824ef76322eb6a54cc2083755f9c2
Merge: e3fe436 6bb86b2
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Mon Jun 15 10:30:49 2015 +0200

    merge master upstream.

commit 6bb86b28bba6ce2f0adc3a5e6d6398b48628a93d
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 14 17:47:08 2015 -0300

    Adding @rdubourguais getServer* methods
    
    1) SMBConnection: getServerOSMajor(), getServerOSMinor(), getServerOSBuild()
    2) smb.py and smb3.py related methods to support 1)

commit 675310a11bc3461676afbdc0e21e6d1e57d46dcc
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 14 17:18:20 2015 -0300

    Renaming method's parameter name
    
    data -> negoData

commit ed1d4792c34b1b317426fa013264a808c37fb93a
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 14 16:53:53 2015 -0300

    Detaching protocol version negotiation from SMBConnection constructor
    
    1) You must specify manualNegotiate = True when creating an SMBConnection
    2) Then call SMBConnection.negotiateSession() where you can specify dialect,
    flags and data.
    3) By default everything works the same.

commit 0632c8c48f074380b821202207d28bb52607c6d2
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 14 16:14:33 2015 -0300

    Log the AbstractSyntax when DCERPC Bind request fails

commit 695cbf7049a86e18744e946bac2f701e440c78c4
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 14 16:09:36 2015 -0300

    Porting remaining commands to Structure
    
    1) Added SMB_COM_CHECK_DIRECTORY structure
    2) check_dir(), remove(), rmdir() ported
    3) Removed unused __send_smb_packet()

commit e3fe436cc21b5921a130b088eea4e65d8d2cb0c9
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Fri Jun 12 20:55:07 2015 +0200

    small bug fix.

commit 60abf05d0e83478e14489712bc7949fefa92a8c4
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Fri Jun 12 20:42:53 2015 +0200

    bug fix (calling the wrong function)

commit efa78d6a616619c583aba9ee48c9dacaf39d96b1
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Fri Jun 12 20:35:49 2015 +0200

    adding isTalkingUnicode to smbconnection.py

commit e2512b9e96841a9bcdfc9089e3b528557a35416f
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Fri Jun 12 20:25:34 2015 +0200

    Allowing smbconnection to get the unicode configuration.

commit 25214231b1de8ab1fce6aff2b01cf754f0c05375
Author: rdubourguais <renaud.dubourguais@synacktiv.com>
Date:   Fri Jun 12 20:00:43 2015 +0200

    Start unicode integration inside SMBv1 stack.

commit e12685ebbdc69c67b0012277f44be4a71eb31b0f
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 11 19:53:31 2015 -0300

    Replacing tab for spaces

commit 299bb6a4d2b74dfd7e1acdb801561b9d9dc158ed
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 11 14:55:03 2015 -0300

    Merging patch by Renaud Dubourguais exposing SMBConnection.isSigningRequired()
    
    The meaning of it is self explanatory ;)

commit 16d5162795dd6cc2a1dfea37a6fc42c395524c0f
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 18:11:20 2015 -0300

    Adjusting test cases for success against a w2k8 DC

commit 457eee71facde00d311af8f6d762f2be969e27fb
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 18:09:58 2015 -0300

    Adjusting test cases for success against a w2k8 DC

commit 270aadd40132fb06b46a339332e590ab9f6f6198
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 17:57:42 2015 -0300

    Code cleanup and improvements
    
    Removed:
    * SMBPacket class
    * recv_packet(): not used anymore, replaced for recvSMB()
    * __raw_retr_file(): (SMB_COM_READ_ANDX should be used)
    * __raw_stor_file(): (SMB_COM_WRITE_ANDX should be used)
    * list_shared(): we list shares through DCERPC, not using the LANMAN approach anymore
    * copy(): not used inside the library
    
    Changed:
    * trans2() renamed to send_trans2()
    * send_trans2() ported to Structure, and proper reassembly in place
    * query_file_info() now uses send_trans2()
    * list_path() rewritten to use Structure, much easier to read.
    * all instances of recv_packet() changed to recvSMB()

commit 91113242b3f79f0399bfbae9a913d265319e28ca
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 17:55:49 2015 -0300

    A better way to test whether the target file is a directory
    
    And also works against an OSX Yosemite SMB Server

commit 8f3592c561452c7b60cf29cc0e8acf9a46cab455
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 17:52:29 2015 -0300

    Adding support for connecting to an OSX Yosemite SMB share.
    
    Yosemite's SMB implementation would complain if the following flags are not
    part of the protocol negotiation:
    FLAGS2_NT_STATUS
    FLAGS2_LONG_NAMES
    FLAGS2_UNICODE
    
    If the first nego packet does not have that, the connection is closed.
    We don't really want to announce UNICODE support for all servers (especially
    against a NT4/SMB1 server), so we're changing these flags only if the
    former flags were rejected.

commit c1e6887b0bebf4aa02c56f48896dbdab5e7939a2
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 9 17:44:32 2015 -0300

    Setting the minimum privileges to remove a file and directory
    
    Previous setting was broader, and was having issues against a OSX Server

commit a28d3d01921a58191d12e37a21fc0a66e696df63
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 7 23:00:13 2015 -0300

    Catching DCERPCException instead of Exception
    
    More realistic since we're then calling get_packet()

commit 0d9f1cec5c8c83377672fd9d1692a625a653c15c
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 7 22:42:07 2015 -0300

    Unifying DCERPC exceptions to impacket.dcerpc.v5.rpcrt.DCERPCException
    
    You should catch that one for all DCERPC related requests.

commit faac79a54ecd30c1d5804be3ebf2562713f255dc
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 7 20:34:25 2015 -0300

    Adding support for answering DCERPC NetrWkstaGetInfo calls
    
    Why? If you have a SMB Server and, at a client Windows, you execute
    `start \\host` from cmd.exe,  what happens is the client Windows
    not only connects to the SMB Server but also calls, via ncacn_np,
    the WKST DCERPC server NetrWkstaGetInfo function.
    
    If no WKST server is present no Windows Explorer window will pop up.
    
    Currently that's the only call supported, so some testing is
    needing to be sure it doesn't break cases where other calls are
    done (maybe OSX clients).

commit fb439fa9d06690a8f7a79b32429d9b84fae53ffc
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 7 20:31:25 2015 -0300

    Fixes DCERPC Server when a bind to an unknown UUID is requested.
    
    If we have a DCERPC Server bound to an specific UUID and a client
    requests binding to a different UUID (not registered) the server
    was launching an exception due to 'SecondaryAddrLen' not set.

commit 1418dd11c3eb09eca6b90a5680fe71840275a0f3
Author: asolino <bethus@gmail.com>
Date:   Sun Jun 7 20:28:58 2015 -0300

    Fix in SMBTreeConnectAndX_Data to support Samba's smbclient4
    
    Samba's smbclient4 behaves weird when connecting to a tree
    It specifies password len to be 0 when there's actually one NULL byte.
    We're taking care of that situation when acting as a SMB1 server.

commit fa63f520abc550811169d3a29183bdde31cf8acb
Author: asolino <bethus@gmail.com>
Date:   Thu Jun 4 10:21:07 2015 -0300

    Fixed issue https://github.com/CoreSecurity/impacket/issues/67. Thanks @MrTchuss

commit 1994a5c7626fb655bfdaaf328d13a813a42d23b5
Author: asolino <bethus@gmail.com>
Date:   Wed Jun 3 21:22:19 2015 -0300

    Code cleanup / switching to @staticmethod when suitable

commit b1eb2723646fd68c98d338dade72b9f3a7e9a5a5
Author: asolino <bethus@gmail.com>
Date:   Tue Jun 2 16:21:24 2015 -0300

    Fixing typos and indentation errors

commit 39fde4705c9eb77d9df6ac8123d08cf680a87661
Author: asolino <bethus@gmail.com>
Date:   Sat May 30 14:01:06 2015 -0300

    Fixes https://github.com/CoreSecurity/impacket/issues/66 reported by deniskhodus.
    
    We're now testing the `securityBindings` buffer is at least a two bytes long.
    This shouldn't happen in theory, but maybe there are a few remaining bytes
    left (probably padding bytes) in the last round of that loop.
    
    Maybe we should also check if there could be 3 or more bytes left on that buffer,
    but not long enough to fulfill a `SECURITYBINDING` structure.
    If so, then there will be an exception trying to build a `SECURITYBINDING`
    struct. However that error hasn't been reported.

commit 1bec6c9126705c27706c6a9cfffb10a49e782319
Merge: 8ab2079 6a88eb0
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Fri May 29 10:22:00 2015 -0300

    Merge pull request #64 from lgriner/master
    
    update setup.py: merging change from lgriner, thanks!

commit 6a88eb0720b659056855ecaac76c8b0a1a293c08
Author: Tyrannosaurus Vexed <leegriner@gmail.com>
Date:   Fri May 29 08:30:56 2015 -0400

    update setup.py
    
    typo in the shebang line

commit 8ab20793a00db9c64bbf90d3812d108b9d1ddcbf
Merge: 138b9a1 6085a1a
Author: asolino <bethus@gmail.com>
Date:   Thu May 28 14:21:34 2015 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit 138b9a16390d5f2d655f119b8ac0362e052bdabf
Author: asolino <bethus@gmail.com>
Date:   Thu May 28 14:10:20 2015 -0300

    Fixes NDRUNION unpacking inside a pointer to an array of union elements
    
    An example of such scenario is [MS-DHCPE], `R_DhcpEnumSubnetElementsV4` call
    (section 3.1.4.31).
    The returned element is a `LPDHCP_SUBNET_ELEMENT_INFO_ARRAY_V4`:
    ```
    typedef struct _DHCP_SUBNET_ELEMENT_INFO_ARRAY_V4 {
      DWORD NumElements;
    [size_is(NumElements)] LPDHCP_SUBNET_ELEMENT_DATA_V4 Elements;
    } DHCP_SUBNET_ELEMENT_INFO_ARRAY_V4,
    *LPDHCP_SUBNET_ELEMENT_INFO_ARRAY_V4;
    ```
    each element of that array is a union like this:
    ```
    && (DhcpIpRangesDhcpOnly <= (E)))?(0):(E))
    typedef struct _DHCP_SUBNET_ELEMENT_DATA_V4 {
      DHCP_SUBNET_ELEMENT_TYPE ElementType;
      [switch_is(ELEMENT_MASK(ElementType)), switch_type(DHCP_SUBNET_ELEMENT_TYPE)]
      union _DHCP_SUBNET_ELEMENT_UNION_V4 {
        [case(DhcpIpRanges)]
        DHCP_IP_RANGE* IpRange; [case(DhcpSecondaryHosts)]
        DHCP_HOST_INFO* SecondaryHost; [case(DhcpReservedIps)]
        DHCP_IP_RESERVATION_V4* ReservedIp; [case(DhcpExcludedIpRanges)]
        DHCP_IP_RANGE* ExcludeIpRange; [case(DhcpIpUsedClusters)]
        DHCP_IP_CLUSTER* IpUsedCluster;
      } Element;
    } DHCP_SUBNET_ELEMENT_DATA_V4, *LPDHCP_SUBNET_ELEMENT_DATA_V4;
    ```
    
    Trying to decode a structure like this would trigger an error.
    
    Main problem was the NDRUNION constructor was interpreting all the
    pointers inside the structure as NDR top level pointers, which is
    not always true (only true if UNION belongs to the NDRCALL directly).
    
    Changing this behaviour seems to fix this issue while mantaining
    the rest of the test cases working. More test is needed tho.

commit 6085a1a2a52a7247c1e9822d2abb66d6f3c81cb5
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed May 27 15:14:49 2015 -0300

    Update README.md

commit 9471616548bb6845c6e4a71ef174ec4f24b9c6e2
Merge: 6ef8ae6 e8253a6
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed May 27 12:27:41 2015 -0300

    Merge pull request #63 from CoolOppo/patch-1
    
    Syntax highlighting and copy-edited README, thanks mate!

commit e8253a62c78b1850ce91d7b8cd17b9c28a7abd0d
Author: CoolOppo <CoolOppo@users.noreply.github.com>
Date:   Tue May 26 21:53:47 2015 -0400

    Rename README to README.md
    
    This enables syntax-highlighting on GitHub.

commit 6a130cc05d4059efe87b55b6ad0aefa02547bcb6
Author: CoolOppo <CoolOppo@users.noreply.github.com>
Date:   Tue May 26 21:52:36 2015 -0400

    Syntax highlighting and copy-edited README

commit 6ef8ae60bb2d436175b0c125b8ab1abd2e1c6ca5
Author: asolino <bethus@gmail.com>
Date:   Tue May 26 19:41:31 2015 -0300

    Replacing decode('hex')/encode('hex')
    
    for binascii's hexlify/unhexlify, mainly because of http://bugs.python.org/issue7475
    and Python3 not having it.

commit 4e32a0d4983d7480e5fa94546ffbe5fc83ca88a0
Author: asolino <bethus@gmail.com>
Date:   Mon May 25 20:40:17 2015 -0300

    Removing some pyCharm's erros/warnings
    
    More scripts/libs changed. Hopefully doesn't break a thing. Test cases are passing

commit 0fc523de873f9f2085d90533d428a4f156a6d422
Author: asolino <bethus@gmail.com>
Date:   Mon May 25 20:37:57 2015 -0300

    The examples theme won't be applied if the init() function isn't called.
    
    In short, in every example you should do:
    import logging
    from impacket.examples import logger
    
    and later in main()
    
        # Init the example's logger theme
        logger.init()
    
    then you can write to the logger using:
    logging.info()
    logging.warning(),
    etc.

commit 0785c5afd30a23d6c622823d31f4391c18eb7e46
Author: asolino <bethus@gmail.com>
Date:   Sat May 23 18:31:08 2015 -0300

    Removing some pyCharm's erros/warnings
    
    Hopefully doesn't break a thing. Test cases are passing

commit dbcacbfaf12bba537f13330cf111cecb68b42da7
Author: asolino <bethus@gmail.com>
Date:   Sat May 23 17:23:36 2015 -0300

    Fixes https://github.com/CoreSecurity/impacket/issues/62
    
    Error on import cause by https://github.com/CoreSecurity/impacket/commit/8b8f8a694703858b217117cffad83c6a61b38065.
    Hopefully it's the only one.

commit 8b8f8a694703858b217117cffad83c6a61b38065
Author: asolino <bethus@gmail.com>
Date:   Sat May 23 11:56:59 2015 -0300

    Pyton imports fixups
    
    1) Removed unnecesary imports, avoid import * whenever possible
    2) Copyright updated
    3) Minor typos fixed
    4) File formats to Unix (LF)

commit b4f2d768f75b1836fca1452d8ed9dce349228917
Author: asolino <bethus@gmail.com>
Date:   Fri May 8 16:39:12 2015 -0300

    Changed unsupported mech type behaviour.
    
    If SMB client wants to do Kerberos or something we don't support, now we answer
    STATUS_MORE_PROCESSING_REQUIRED specifying the NTLM MechType again. Seems that's
    the right way to do it instead of answering STATUS_NOT_SUPPORTED.

commit 9c980a7304a423c8849d035db13badd28cc4fade
Author: asolino <bethus@gmail.com>
Date:   Tue May 5 19:07:39 2015 -0300

    Fix some typos

commit c6a6790c55b0b5e1b24eb136e07b971d165d438e
Author: asolino <bethus@gmail.com>
Date:   Mon May 4 14:11:04 2015 -0300

    New dev release...

commit 02b4ab82708bfefaa638e92d15aad5998026210c
Author: asolino <bethus@gmail.com>
Date:   Mon May 4 12:18:43 2015 -0300

    Changing version also at setup.py

commit 60a0c5b126a8a42121852de7ef5354beb8e631e3
Author: asolino <bethus@gmail.com>
Date:   Mon May 4 11:59:25 2015 -0300

    Adding Changelog and changing dev version to final.

commit a3b11bcef0c0ead6b7d844e0b2b94656453f58db
Author: asolino <bethus@gmail.com>
Date:   Sun May 3 22:23:18 2015 -0300

    Some corrections to make these tests to pass

commit 535a44f69b68062218b2dced82456ec93562f1a4
Author: asolino <bethus@gmail.com>
Date:   Sun May 3 22:01:59 2015 -0300

    Some corrections to make these tests to pass

commit 6fc56f05b9867db72f8e0ef32e888e883c924bf0
Author: asolino <bethus@gmail.com>
Date:   Fri May 1 18:53:22 2015 -0300

    `psexec.py` now defaults to executing cmd.exe if no command is specified
    
    I don't know why I didn't do this before but more than one of you
    fell on that little detail.
    There might be a reson tho :s.. testing needed!

commit 8a96b280c92020e8fafc034646f72ce515b81346
Author: asolino <bethus@gmail.com>
Date:   Fri May 1 16:43:24 2015 -0300

    Removing these files. Outdated

commit 9c85ee047a8be00ae22858b43bd13516a261e18a
Author: asolino <bethus@gmail.com>
Date:   Fri May 1 13:31:32 2015 -0300

    No need to encode the serviceName. It fails on some XP versions
    
    This was left from the old RPC runtime where we had to manually encode things.
    Now it's all handled by ndr.py

commit 352816b37f01e9d6240cc21753eb9336644e6199
Author: asolino <bethus@gmail.com>
Date:   Thu Apr 30 18:05:37 2015 -0300

    Adding log level message format and adding try/catch to fail gracefully
    
    Small fixes. Almost ready to tag new version

commit 925aa52c1640be19657f117ad9fb4534e9b16210
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 29 10:26:27 2015 -0300

    Added `from __future__ import with_statement` for older Python versions

commit 3f0585a2b832815daeeb03de5af9356fd2d81244
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 28 16:12:07 2015 -0300

    SMB2_QUERY_DIRECTORY and SMB.TRANS.FIND_FIRST2 information levels updated
    
    Plus now it returns STATUS_NOT_SUPPORTED (only in SMB2) if the level
    is not present.

commit 34a490e2a694c2636e2f83ef439aacc3129b2b51
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 28 11:12:41 2015 -0300

    SRVSServer.NetrShareGetInfo() fix when non existent share was sent.
    
    The SMBServer has a mini DCERPC server serving a minimal subset of
    [MS-SRVS] calls used by clients.
    The NetrShareGetInfo() method was assuming the share asked for
    information was always existing, something that could not be true.
    Calling, from the client, 'start \\smbserver\SHARE', and SHARE being
    non existant was triggering this problem.
    Now if the share doesn't exist the method returns WEE_NET_NAME_NOT_FOUND.

commit fde21c2b810db4efbdcb75ab7593664872677e4b
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 27 22:41:35 2015 -0300

    SPNEGO MechType check
    
    We now check the selected MechType is for NTLM auth. If not, we fail gracefully with STATUS_NOT_SUPPORTED

commit 816a950b2a94e66596fd1396cdf4ee9f6b6b0442
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 27 21:13:17 2015 -0300

    Updates to SMB2 Server
    
    1) We need to store the new filename inside the connData['OpenedFiles'] dictionary
    when renaming a file
    2) SMB2Lock wasn't unpacking correctly, producing an error.
    
    BTW, OSx SMB client implementation sucks.

commit 53306c9c8926cc67ebeb620dd27701ee85d4a80e
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 27 20:11:56 2015 -0300

    Updates to SMB2 Server
    
    1) Dummy SMB2_LOCK, SMB2_CANCEL added
    2) SMB2_FLUSH added
    3) SMB2_FILE_INTERNAL_INFO level added
    4) Getting fileID from previous compound request for all functions that apply
    5) Fixed path calculation when renaming a file outside the root tree dir
    
    Looks like it's working OK from Linux/Windows and OSX (guest login)

commit 94b141881bc076303ff6b7e635a807b37851b163
Author: asolino <bethus@gmail.com>
Date:   Sat Apr 25 16:58:36 2015 -0300

    Added SMBSERVER() support for renaming files/folders through SMB2_SET_INFO.
    
    This is what explorer uses when renaming files/folders.

commit 4c2e64ad3add7e40609834a7a8f046ca86304e56
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 24 18:42:12 2015 -0300

    Second round of logging change.
    Now there should be a single logger called 'impacket' the library uses.
    By default is has a NullHandler so nothing is printed, but messages are
    forwarded to the upstream logger.
    
    If you are a script using the library and want to set the root logger
    with a custom formatter, you can import impacket.examples.logger.
    
    After some testing I'll merge it into master

commit 7e99da87f92244fce5caa659bb122dfe2c4f4991
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 24 13:18:26 2015 -0300

    Adding debug parameter

commit 119e4438dd8227a138d5ecc2052646c3a81b9e4e
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 24 12:52:32 2015 -0300

    Changing logging mechanisms everywhere.
    Full details coming soon

commit 0730a3428af8bd1625a205420dbdc5e2af892bda
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 22 14:58:06 2015 -0300

        Playing with logging, trying to get to something useful to finally have a decent logging inside impacket.
    
        1) We basically define a logger called 'impacket' at the library's __init__, set out a NullHandler for it, and
    
        2) All the logging stuff in version.py removed
    
        With this we have a single logger called 'impacket' for the library.
    
        Now.. what about the example scripts?
    
        1) Move the impacket/logger.py to impacket/examples/logger.py, since this is something that is used just by the
    
        2) Example scripts should import that file in order for the library logs to be shown right (from impacket.examp
    
        For third-party developers that want to disable or change the logs generated by the library:
    
        1) They could, inside the scripts, logging.getLogger('impacket').disabled = True, or add handlers, or whatever.
    
        Testing needed..

commit c2b47d34365d81c8d7de1e445da3999ea2e8a342
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 22 14:49:19 2015 -0300

    Playing with logging, trying to get to something useful to finally have a decent logging inside impacket.
    
    1) We basically define a logger called 'impacket' at the library's __init__, set out a NullHandler for it, and assign a global variable LOG that will need to be imported from all the library modules. From now on, ALL library modules LOG through that variable. All modules should have 'from impacket import LOG'
    
    2) All the logging stuff in version.py removed
    
    With this we have a single logger called 'impacket' for the library.
    
    Now.. what about the example scripts?
    
    1) Move the impacket/logger.py to impacket/examples/logger.py, since this is something that is used just by the example modules (yeah, shouldn't be inside the library itself, but oh well). Inside logger.py, we modify the root logger and change the format of the messages (as set by @lanjelot). The root logger is held in a global variable called SLOG (scripts log?.. another ideas welcomed).
    
    2) Example scripts should import that file in order for the library logs to be shown right (from impacket.examples.logger import SLOG). Plus if they want to log themselves, they can use SLOG.
    
    For third-party developers that want to disable or change the logs generated by the library:
    
    1) They could, inside the scripts, logging.getLogger('impacket').disabled = True, or add handlers, or whatever.
    
    Testing needed..

commit 10c54429c22e0277934108b520684b24f3f60bc7
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 24 12:55:35 2015 -0300

    Fix SMBSERVER error when no challenge was set in config file.
    
    https://github.com/CoreSecurity/impacket/pull/57 added option for setting
    a custom challenge in SimpleSMBServer class. However, those modules that
    would instantiate an SMBSERVER directly (e.g. karmaSMB) would fail if the
    challenge option wasn't set.
    I've added a the default challenge to be 'A'*8 at the SMBSERVER class level.

commit 8b359e16252c59caec093e13cd76e906fd6f5c0f
Merge: dc1b648 3352733
Author: Alberto Solino <asolino@users.noreply.github.com>
Date:   Wed Apr 22 09:23:11 2015 -0300

    Merge pull request #57 from byt3bl33d3r/master
    
    Added option to set custom SMB challenge in smbserver.py

commit 3352733f434bff1f929f3bcc5135bdab9a769f60
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Wed Apr 22 07:38:36 2015 +0200

    added missing )

commit 4a54672034cc9a8ae1dec124d803292b6b6b67a9
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Wed Apr 22 07:37:11 2015 +0200

    modified comment

commit 028dcdb90cdcd78747d47a94ecdca86546e97867
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Apr 21 23:50:33 2015 +0200

    have no idea what i was thinking at the time

commit 9c7b50e34f5276332e632d5534da0a852b21e887
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Apr 21 22:45:51 2015 +0200

    corrected a comment

commit 7d532eef967666b4e11024efd7a74a12e809303a
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Apr 21 22:27:36 2015 +0200

    removed debug print statements

commit 73fdb533dd2835c2996e4d392384bde053a459c2
Author: byt3bl33d3r <byt3bl33d3r@gmail.com>
Date:   Tue Apr 21 22:25:40 2015 +0200

    added option to set smb challenge in smbserver.py

commit dc1b6487edb3a35284ce50ea6a9c47bd55aad69b
Author: asolino <bethus@gmail.com>
Date:   Tue Apr 21 12:57:10 2015 -0300

    Adding SMB2 support for karmaSMB
    
       The SMB2 support works with a caveat. If two different
       filenames at the same share are requested, the first
       one will work and the second one will not work if the request
       is performed right away. This seems related to the
       QUERY_DIRECTORY request, where we return the files available.
       In the first try, we return the file that was asked to open.
       In the second try, the client will NOT ask for another
       QUERY_DIRECTORY but will use the cached one. This time the new file
       is not there, so the client assumes it doesn't exist.
       After a few seconds, looks like the client cache is cleared and
       the operation works again. Further research is needed trying
       to avoid this from happening.

commit 809b2c89208d204bc6daf68500afebc665a33548
Merge: e961473 c7d1786
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 20 21:02:06 2015 -0300

    Merge branch 'master' of https://github.com/CoreSecurity/impacket

commit e96147381b170b701a2f82203214a3392ed88358
Author: asolino <bethus@gmail.com>
Date:   Mon Apr 20 20:57:57 2015 -0300

    Adding initial support for SMB2 (SMB 2.002) dialect. If not explicitly specified, it should all work still the same (SMB1).
    It can be tested running the smbserver.py example with the -smb2support parameter. Looks like it's working from
    Windows clients and Samba clients (Samba 4.2.x).
    A lot of testing needed!

commit c7d1786bc27f92186b41bafdd85bcd5cccdd783a
Author: asolino <bethus@gmail.com>
Date:   Fri Apr 17 15:35:10 2015 -0300

    Updated README

commit f0cf1be7b4ee64f0f3cd65d27df6af998d6e4b26
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 15 13:26:25 2015 -0300

    Replacing google.code links for github

commit 91763930805347767590d750d2a7681cd4b2861d
Author: asolino <bethus@gmail.com>
Date:   Wed Apr 15 13:17:34 2015 -0300

    Replacing google.code links

commit a186ff111d68237ef46e81ecaf83f85fed5e0aa4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 14 16:56:25 2015 +0000

    Adding S4U2Self structures

commit 8ab5bffc9487c129a217df47d78240da87100924
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 21:13:17 2015 +0000

    Adding keytype. Not documented by MSFT, but it's clearly the NTHASH
    0xffffff74:'rc4_hmac'

commit 4d6b5cebb82dbb6c7694ccea4616c3b43debd244
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 21:01:52 2015 +0000

    If we don't know the KeyType's string name, we just put its number

commit 04fd08a4a4269286b33a97dad97983350bc4b6e6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 19:53:09 2015 +0000

    Fixed a typo and clarified the examples

commit 1f377339ff4a00ae0b3ae923a812b3e7c5c19af6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 19:00:37 2015 +0000

    Adding -target-ip switch in case you cannot resolve it

commit 2961a45867f97529b8099647a72b93b85df7d1d9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 18:20:13 2015 +0000

    More checks to verify the target ETYPE is supported. The domain controller functional level might be another situation that can trigger AES not supported

commit c444e653f59720fbb2ebb3fec0ad37c352be3528
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 10 17:53:37 2015 +0000

    More checks to verify the target ETYPE is supported. This could be triggered on a Windows 2008 R2 SP1 (SP0 accepts AES).

commit 0c4fe32fb1969d3cf9fc1af5dac3612dff817b30
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 9 20:50:13 2015 +0000

    Synchronizing with impact's internal repo

commit a46cad19552a4fe72dfab31ba2dcbb6f1fb6f1ae
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 9 19:19:47 2015 +0000

    Adding more checks in case we get a KDC_ERR_ETYPE_NOSUPP error. We try to switch to RC4 and hope for the best

commit e78a860d38be3744b04aba7646ed0862b207d029
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 8 17:50:10 2015 +0000

    Updated description:
    
    # This script creates/removes a WMI Event Consumer/Filter and link
    # between both to execute Visual Basic based on the WQL filter
    # or timer specified.
    #
    # Author:
    #  beto (@agsolino)
    #
    # Example:
    #
    # write a file toexec.vbs the following:
    #       Dim objFS, objFile
    #       Set objFS = CreateObject("Scripting.FileSystemObject")
    #       Set objFile = objFS.OpenTextFile("C:\ASEC.log", 8, true)
    #       objFile.WriteLine "Hey There!"
    #       objFile.Close
    #
    #
    # then excute this script this way, VBS will be triggered once
    # somebody opens calc.exe:
    #
    #  wmipersist.py domain.net/adminuser:mypwd@targetHost install -name ASEC
    #   -vbs toexec.vbs
    #   -filter 'SELECT * FROM __InstanceCreationEvent WITHIN 5 WHERE TargetInstance
    #            ISA "Win32_Process" AND TargetInstance.Name = "calc.exe"'
    #
    # or, if you just want to execute the VBS every XXX milliseconds:
    #
    #  wmipersist.py domain.net/adminuser:mypwd@targetHost install -name ASEC
    #   -vbs toexec.vbs -timer XXX
    #
    # to remove the event:
    #       wmipersist.py domain.net/adminuser:mypwd@targetHost remove -name ASEC
    #
    # if you don't specify the password, it will be asked by the script.
    # domain is optional.
    #

commit 29ef8f394a3e340ca318d64bbee1f5dd5f8420d9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 8 17:45:34 2015 +0000

    Clarifications on the scope of the script

commit f4819fa9ba38c355d863838ec0b1ce9c29673242
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 7 13:25:11 2015 +0000

     This script creates/removes a WMI Event Consumer/Filter and link
     between both to execute Visual Basic based on the WQL filter specified.
    
     Example:
    
     write a file toexec.vbs the following:
            Dim objFS, objFile
            Set objFS = CreateObject("Scripting.FileSystemObject")
            Set objFile = objFS.OpenTextFile("C:\ASEC.log", 8, true)
            objFile.WriteLine "Hey There!"
            objFile.Close
    
    
     then excute this script this way, VBS will be triggered once
     somebody opens calc.exe:
    
      wmipersist.py domain.net/normaluser:mypwd@domain-dc install -name ASEC
       -vbs toexec.vbs
       -filter 'SELECT * FROM __InstanceCreationEvent WITHIN 5 WHERE TargetInstance
                ISA "Win32_Process" AND TargetInstance.Name = "calc.exe"'
    
     or, if you just want to execute the VBS every XXX milliseconds:
    
      wmipersist.py domain.net/normaluser:mypwd@domain-dc install -name ASEC
       -vbs toexec.vbs -timer XXX
    
     to remove the event:
            wmipersist.py domain.net/normaluser:mypwd@domain-dc remove -name ASEC

commit 82ec2f4f0d436626304416fb6efc3173a071f538
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 6 15:42:42 2015 +0000

       The idea of this script is to get a list of the sessions
       opened at the remote hosts and keep track of them.
       Coincidentally @mubix did something similar a few years
       ago so credit goes to him (and the script's name ;)).
       Check it out at https://github.com/mubix/netview
       The main difference with our approach is we keep
       looping over the hosts found and keep track of who logged
       in/out from remote servers. Plus, we keep the connections
       with the target systems and just send a few DCE-RPC packets.
    
       One VERY IMPORTANT thing is:
    
       YOU HAVE TO BE ABLE TO RESOLV THE DOMAIN MACHINES NETBIOS
       NAMES. That's usually solved by setting your DNS to the
       domain DNS (and the right search domain).
    
       Some examples of usage are:
    
       netview.py -target 192.168.1.10 beto
    
       This will show the sessions on 192.168.1.10 and will authenticate as 'beto'
       (password will be prompted)
    
       netview.py FREEFLY.NET/beto
    
       This will download all machines from FREEFLY.NET, authenticated as 'beto'
       and will gather the session information for those machines that appear
       to be up. There is a background thread checking aliveness of the targets
       at all times.
    
       netview.py -users /tmp/users -domainController freefly-dc.freefly.net -k FREEFLY.NET/beto
    
       This will download all machines from FREEFLY.NET, authenticating using
       Kerberos (that's why domainController parameter is needed), and filter
       the output based on the list of users specified in /tmp/users file.

commit 56727f344501fd4091aab1adf60dafef2c43f055
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 1 21:40:02 2015 +0000

    Adding pyasn1 as requirement

commit 0df6b23153648f24768c79e1dbc7b96a6c2e4c94
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 1 17:45:22 2015 +0000

    Fixed wrong definition for LPDWORD

commit 7c3ca072b5de80606edf753ac9eaec533f71780b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 1 17:18:28 2015 +0000

    Synchronizing with impact's internal repo

commit 03cfbd23f1681ed5354def0a1d7fc28e9717b94b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 1 17:04:23 2015 +0000

    Changing padding from 8 to 4, seems to be effective when using RPC_C_AUTHN_LEVEL_PKT_INTEGRITY and RPC_C_AUTHN_GSS_NEGOTIATE

commit 50b59ffcdf56e6ba88f77bafe40af096287e4b83
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 26 21:52:00 2015 +0000

    We're just showing that CCache file was used if debugging output is chosen. Hope it doesn't confuse ppl, but it's kind of annoying to get those messages all the time.

commit ff6a318df35004db8e4efcfc1bda7e49f3f118b6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 26 21:15:50 2015 +0000

    Adding -debug flag

commit 957ab8586419b7884e4ba5acf5f002e34cbc2de0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 24 22:29:29 2015 +0000

    Changed the who command so you can list the active sessions w/o the need of being Administrator. The whole trick was to use a different information level

commit 25188dad4ba894cf80061f794c96a0247cf32e92
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 20 19:46:52 2015 +0000

    Fixes kerberosLogin calling way

commit a4f6260676492ea196d675c1440d623e6404bf0d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 20 19:28:20 2015 +0000

    Typo

commit d5238f0817ca144f2a3f0074835ce94677c8dca6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 20 19:25:53 2015 +0000

    Adding small description when calling the scripts w/no arguments

commit 5a2a246f3da8d7d4d5977a10078dd3639a9489b0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 20 19:21:09 2015 +0000

    Adding TGT, TGS when receiving get_credentials() data

commit a64365dcba4b1ac8a0092616219406e1480790a5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 19 22:19:30 2015 +0000

    getCredentials() now returns more data

commit 0fcf9d3780e570e99a3bb1ed6001aca50acfed68
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 19 22:18:08 2015 +0000

    This changeset allows passing TGT/TGS tickets to the DCERPC runtime. Check krb5/ccache.py toTGT()/toTGS() methods to see what the expected format must be.
    Main changes were adding TGT/TGS to the getCredentials()/get_credentials() and set_credentials() methods in the smb*/dcerpc/rpcrt/dcomrt/transport* files.
    Testing needed!

commit 192ab359b4c84c9043588109583d2952f9882b87
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Mar 18 19:56:53 2015 +0000

    Adding the following types:
    LONG64, WORD, OBJECT_TYPE_LIST

commit 185bdbbb49875a7157d10bae67afac59818e50fb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 17 14:30:21 2015 +0000

    We extract the domain name from the authenticateMessage instead of the command line. This will increase the chances of success since request['LogonInformation']['LogonNetworkTransitive']['Identity']['LogonDomainName'] must match the authenticate['domain_name'] field.

commit 872c656a74d0c61fb2b2b6ed80ca9224ba31d663
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 17 12:54:34 2015 +0000

    Fixed a bug that would cause DCOMConnection.PINGTIMER to be set to None when there were already active connections.

commit 734fa44b90cbf4cea6c7824fb84a08626adab8c4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 16 16:45:07 2015 +0000

    removed traceback prints

commit 5ca4e2278008b1ceaa8f47eaf8a504cf3b455cfb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 13 05:40:10 2015 +0000

    Fixes LSA Secrets decryption on NT5 x64 systems as described by Sebastien Macke at https://www.trustwave.com/Resources/SpiderLabs-Blog/Dumping-LSA-Secrets-on-NT5-x64

commit 7f041090f35004022b4e5cb8ea0b34e13fa96b60
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 10 17:06:06 2015 +0000

    Adding support for CVE-2015-0005

commit f79acb0a3928ce76cab104815b241a47f926e054
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 10 17:01:55 2015 +0000

    Adding support for CVE-2015-0005

commit 84568806cb9e18d71647341a8b4b36ff3b4a24c6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 9 16:29:43 2015 +0000

    1) Fixing definitions for opnums 21/22 and 23
    2) IEnumWbemClassObject_Next lTimeout should be ULONG instead of LONG
    3) ExecNotificationQuery() result is casted to a IEnumWbemClassObject()

commit 1f2e2bc501643b4484de00ab825177882a76e1a4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Mar 8 14:35:28 2015 +0000

    Always comparing SPNs in uppercase

commit 5cbfd48e039a1f9ff87d75bcb2e9e4a4be2b0dfa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 7 22:40:43 2015 +0000

    Casting the return values for the methods called

commit f538b88a34ad56a3d24e665d369d26012fde1dc2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 7 22:18:40 2015 +0000

    Better error control

commit 7d6cf3f174497e1da584edf36f53f4acaff85965
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 5 15:42:51 2015 +0000

    Fixes an STATUS_INVALID_PARAMETER response against some Samba Servers

commit 49926d6e389b00625387b61a9772d938985e7fef
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Mar 4 19:12:10 2015 +0000

    Changing some default values for these strucs.. mimicking what Windows is returning back

commit d4c9d1a6314d4f971d4141fd037199728c16c4e4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 3 21:17:14 2015 +0000

    Adding a few structures and constants for the smbserver

commit d6d3f89f7c3a822e0e9c4f788a6d07eb8475759d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 24 15:16:54 2015 +0000

    Using PyCrypto's gcd implementation

commit 8596051e4bc2a23e3706362404b2381dd0f58846
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 18 19:59:33 2015 +0000

    Fixes https://code.google.com/p/impacket/issues/detail?id=53 reported by crlawrence. I applied the patch provided. Thanks!

commit 0ba062b88c607f1c6d82e19de9a715363348bd86
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 13 17:51:40 2015 +0000

    Unregistering commands we don't really need

commit 67b4e2d2ca3611b13d7dc5e0ad2efcd78a9c7b0f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 13 17:51:14 2015 +0000

    Adding unregisterSmbCommand(), unregisterNTTransaction(), unregisterTransaction2() and unregisterTransaction().
    Useful if you want to provide a constrainted SMB Server.
    Note that if the command asked by the client is not registered, the SMB Server will automatically return STATUS_NOT_IMPLEMENTED.

commit f96cae5f6f47ee4b5f71a1e73925d5b5a7992b26
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 13 16:19:28 2015 +0000

    Let's try to avoid allowing write requests from the client back to us
    not 100% bulletproof, plus also the client might be using other SMB
    calls (e.g. SMB_COM_WRITE)

commit f12a89c3656a7a490df201c4284d73e9ef03ca5f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 13 14:26:56 2015 +0000

    One important ToDo:
    
       [ ] Disable write request, now if the client tries to copy
           a file back to us, it will overwrite the files we're
           hosting. *CAREFUL!!!*

commit aed578854fff86653e4129c49d341d4a04c19784
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 13 13:45:29 2015 +0000

    Adding NETLOGON, SYSVOL shares (fakes), in case they are asked

commit 004371f5d04345bbb999c256a92973350b9d005f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 12 12:24:19 2015 +0000

    The idea of this script is to answer any file read request
    with a set of predefined contents based on the extension
    asked, regardless of the sharename and/or path.
    When executing this script w/o a config file the pathname
    file contents will be sent for every request.
    If a config file is specified, format should be this way:
       <extension> = <pathname>
    for example:
       bat = /tmp/batchfile
       com = /tmp/comfile
       exe = /tmp/exefile
    
    ToDo:
    [ ] A lot of testing needed under different OSes
    [X] It's not working for first level directories
        (e.g. \\IP\share\file) - DONE
    [ ] Add support for other SMB read commands. Right now just
        covering SMB_COM_NT_CREATE_ANDX
    
    I'm not sure how reliable this approach is, so I might ditch this in the future.. hopefully no!

commit ccc3f55f2aee09dade22513201e64c8c33a2879e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 11 21:42:06 2015 +0000

    Fixed bug in transaction hook functions

commit 67bdc297120c5f3c96ec5c0710aa90352cf75a74
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 21:10:55 2015 +0000

    Fixed wrong calling of SBMConnection.readFile()

commit 2f3e335f13e8a7bcfd929d1fd09691cc050e9e1e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 21:02:53 2015 +0000

    Adding kerberos test cases

commit 33e17a79e73f93b9a8c396d06b772ae4442eec33
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 20:59:12 2015 +0000

    From now on, when doing ncacn_np communications, we're not using transactions anymore, now calling directly to writeFile

commit 06b8b563e15553b2380a8462ecf7a09f690f6373
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 18:08:22 2015 +0000

    Adding Kerberos test_cases

commit feec49e6d4235256d6924e2ca390efdefb67e918
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 14:20:54 2015 +0000

    Better error checking for suplementalCredentials. It was failing on some old XP systems

commit 7634f3e526f5b0c1028914a227ef8395cf11606d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 9 13:47:50 2015 +0000

    If we receive KDC_ERR_ETYPE_NOSUPP, we give it another try using RC4 (if not
    used before) and hope for the best.
    Seems to be a decent way to make kerberos work against some old Windows XP
    boxes. Still having some problems at the DCERPC level tho.

commit aa048d45f15b5fc57a58f718f4776d56ccba7a09
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 8 22:07:23 2015 +0000

    If we receive KDC_ERR_ETYPE_NOSUPP, we give it another try using RC4 (if not used before) and hope for the best.
    Seems to be a decent way to make kerberos work against some old Windows XP boxes. Still having some problems at the DCERPC level tho.

commit be4980960c0b158b5e82f50fdc6ba9e2e30c90b5
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 8 00:17:37 2015 +0000

    When calculating the stringBinding.. convert what we receive to uppercase.

commit c39c79c889d861e2c670f0d1ae13587d1a380932
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 8 00:17:13 2015 +0000

    Trying to decode a KerberosError if it happens.. still not perfect.. we should interpret the krb5_blob here

commit 38a915a0541ff0c8edb2f28eb8bfc7f044378859
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Feb 7 23:51:38 2015 +0000

    Forgot one raise ;)

commit 9a9b40225276a0f19abf7a021f9218ff786b8aa8
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Feb 7 23:48:28 2015 +0000

    Attack might have worked, but when asking for the cifs TGS we get KDC_ERR_ETYPE_NOSUPP. If that happens, we try all over again using RC4

commit 2d119b71cee41eff851d374e1e1ea2b534559fbd
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Feb 7 22:40:50 2015 +0000

    Fixed typo

commit cc3e726c764519a52a8386226348cf9703e05d63
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 5 20:23:26 2015 +0000

    Replacing Crypto.Random.get_random_bytes for our own implementation

commit 1765c3984a0821ebccb3c31f6893680dac192c34
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 2 14:49:33 2015 +0000

    Kerberos support added

commit 1f6095f0133992a68f695066fbba80fd4ca926a5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 2 14:32:21 2015 +0000

    Removing traceback

commit 72fd4ec15aaac83932a960a282cae989b1f9cb5e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 2 14:31:39 2015 +0000

    GSSAPI_AES128 support

commit 0c4d21c073a665513e1abbff6264946023d1ba1f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 2 13:52:43 2015 +0000

    Credentials are now passed by command line, aligned with other scripts. You can still logoff/logon inside the mini shell tho.

commit 2d04544c44d5e0c7cd9fda43a237849757ccc8e9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 21:21:36 2015 +0000

    service install ported to the new dcerpc.v5

commit 32e10b80271185597a3ea4579787495b140c73ee
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 19:56:17 2015 +0000

    Add domain FDQN whenever possible

commit f2ff812d3b347d0ea4144fb5122fb99652d3d069
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 17:52:36 2015 +0000

     Adding support for pass the key

commit b3c614ab6b38ae6446fb898fd44a967ceedf4336
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 17:28:37 2015 +0000

    Adding support for pass the key

commit 27f0b5b43d7b970f84e2f7ddfac6e125e6fca834
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 17:19:12 2015 +0000

    This changeset adds support for Kerberos pass the key, originally implemented by Benjamin Delpy (@gentilkiwi) in mimikatz.

commit 2fd3bf2289f30d0cdf1c81cb930484b1f43d7240
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 00:18:21 2015 +0000

    Adding parsing of [MS-SAMR] 2.2.10 Supplemental Credentials Structures. I'm just grabbing the kerberos keys, just the "new" ones. I could grab the WDigest data... but still don't know how to use them effectively.
    How to use these kerberos keys?.. coming soon.

commit 20ea3c498546289378ab51f45cf54e2c395491d8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 30 00:06:38 2015 +0000

    Adding [MS-SAMR] 2.2.10 Supplemental Credentials Structures structure

commit 38c59dd9977c456daa1ac3054af601c31cadd1f5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 29 19:34:23 2015 +0000

    Adding capability to export to John The Ripper format files

commit 32ec8ab90fff2717ebeef33bdb25b1ada49b8315
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 27 15:10:29 2015 +0000

    Adding support for SMB Encryption. It will be used if the target server requires it either at session or share level using AES_CCM. Current stable pycrypto does NOT support this mode. For this feature to work you will need to download/compile and install the experimental version. Currently it is https://ftp.dlitz.net/pub/dlitz/crypto/pycrypto/pycrypto-2.7a1.tar.gz

commit e7ff108eced16286ceeb1c8c57845e08289e4819
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 23 12:54:36 2015 +0000

    Updated description

commit 51215ea8017dacc1d0617dc05243fe3271a56437
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 21 21:35:25 2015 +0000

    Ported to dcerpc.v5

commit bdaaf07616d6f954897a5056ca31444df3906a9b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 21 21:06:21 2015 +0000

    DCE [C706] MGMT Interface Implementation

commit 98b5269290487362e6cf02fdffcbe746672e90bf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 21 21:02:38 2015 +0000

    Ability to avoid checking errors in the DCE RPC answer (needed for mgmt interface)

commit 5fd8e8753dceaefe94cd54c5e54cc86fb8f9b395
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 21 20:34:15 2015 +0000

    Changing pad calculation for arrays when TS is NDR64

commit 90c38e248f7e111704375e71109fe2c7c21955cf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 20 23:35:57 2015 +0000

    Added deprecation warning message to all non dcerpc.v5 classes

commit 29d18e8cfde391cd5d5194bce5d236a585642425
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 20 22:53:16 2015 +0000

    Updated copyright

commit 6957420118347d698496e75ff47196d3c0fdc248
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 20 19:59:06 2015 +0000

    Removing -port parameter. Not needed

commit 3c2e430b6dd3e09305a892cf6718fda3a50dcecd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 20 17:12:26 2015 +0000

    1) kerberosv5.py: Fixing typo in error message
    2) smb.py: When building the principal name, the remote_name should be used instead of remote_host
    3) smb3.py: getaddrinfo should be done on the self._Connection['ServerIP'] variable

commit 15228f4563f24be92872faf99de5fc3f3204a4aa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 20 15:07:34 2015 +0000

    Adding get and put commands to the semi-interactive shell. You can include drive letters as destination pathnames as well. It'll use the drive letter as the share (plus '$') to connect to.

commit dd1500e65f457b15f9baa9545c073d153bde5e4a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 14 18:30:14 2015 +0000

    upgrading to dcerpc.v5

commit d7a4be2ef84a00c16e4be5b145184c304294112f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 14 18:26:53 2015 +0000

    Removing unnecesary imports

commit 14515391aa5b3ca8c24a5929373c72fd094e5636
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 14 18:25:56 2015 +0000

    Getting rid of the old dcerpc library.. now using dcerpc.v5

commit bbce63a34a6b14e434cb35d7e881f975ea10242a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 14 16:32:03 2015 +0000

    Clarifying target could be an IP address or targetName

commit b4cacea6afc6dc5c7e03aa4d55cf6520e21837b1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 13 21:01:41 2015 +0000

    Sending ServerName = '\x00' instead of NULL. Older Samba implementation fails to accept NULL as paramenter.

commit 747f8848beb43572a47826d53fbfabb117ac77c4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 12 14:22:33 2015 +0000

    1) Better error reporting when we cannot resolve a hostname and when domain is not specified
    2) Improved the way we calculate offsets inside authData for WRAP structure parsing

commit 6439379c7c24e72a67187a5b02035eff09bbc008
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 12 14:17:27 2015 +0000

    Added debug output flags. Nothing much is outputed now but migth be useful in the future

commit a5d7e7dad7b71aff82690e17588c3421b1ebf142
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 12 14:16:10 2015 +0000

    Since targets can be IP addresses or hostnames, I'm changing some internal variables/methods names to be consistent.

commit 107b3bc6a162e5494fb3242be06161fc6c92a68c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 21:55:22 2015 +0000

    Copyright update

commit 661145e669185f5baa255def308ac56b1896b81b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 21:52:47 2015 +0000

    Updated documentation about AES256-CTS-HMAC-SHA1-96.

commit 1334f7bd4b5b170c1300166c38f74bfd75224428
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 21:44:50 2015 +0000

    Enabling AES128-CTS-HMAC-SHA1-96 support for all Kerberos operations (including goldenPac.py). RC4 would be used only when hashes are specified or KDC_ERR_ETYPE_NOSUPP is returned when trying AES.

commit 17e23eaa527baa7a503a238505d032b3fafee9f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 20:50:32 2015 +0000

    GSS_Wrap and GSS_Unwrap for AES256.. finally.. closer we are..

commit 27bbf85a2d42f97adb3d0837a392fa8a4045cb0e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 00:11:07 2015 +0000

    Kerberos support added (incl. ccache)

commit ad1959a0258ad158a5234949aea57660757d2752
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 00:07:49 2015 +0000

    Kerberos support (incl. ccache)

commit 700bbb6d9f9d5b2198976367686c0645142b542b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 9 00:03:02 2015 +0000

    Kerberos support (incl. ccache) for psexec.
    
    jack:examples beto$ klist
    Credentials cache: FILE:/Users/beto/ccache
            Principal: normaluser7@FREEFLY.NET
    
      Issued                Expires               Principal
    Jan  8 20:11:32 2015  Jan  9 06:11:32 2015  krbtgt/FREEFLY.NET@FREEFLY.NET
    jack:examples beto$ python psexec.py -k -no-pass freefly.net/normaluser7@freefly-dc cmd.exe
    Impacket v0.9.13-dev - Copyright 2002-2015 Core Security Technologies
    
    Trying protocol 445/SMB...
    
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    [*] Requesting shares on freefly-dc.....
    [*] Found writable share ADMIN$
    [*] Uploading file oaZRkqjh.exe
    [*] Opening SVCManager on freefly-dc.....
    [*] Creating service gpvj on freefly-dc.....
    [*] Starting service gpvj.....
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    Using Kerberos Cache: /Users/beto/ccache
    [!] Press help for extra shell commands
    Using TGT from cache
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    Microsoft Windows [Version 6.1.7601]
    Copyright (c) 2009 Microsoft Corporation.  All rights reserved.
    
    C:\Windows\system32>whoami
    nt authority\system
    
    C:\Windows\system32>

commit 8953ece80adc91c3bc0bb5bee6c3c7e8c6afa129
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 23:26:02 2015 +0000

    We're forcing connectTree to use the target's IP address instead of its name. Might bring some issues.. not completely sure yet

commit fa6950ede474af5a4862d0b1c84d65d3bcae7bc9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 21:28:44 2015 +0000

    Adding -no-pass switch, uniform with the other scripts we're adding kerberos support to

commit ed89b315b74aa8a564ec6d27b0d5b5a0f922dce6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 21:24:29 2015 +0000

    removed import that was not used

commit 5b8e9981d929bc0ce2c59deaf95af497cb0ada8c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 21:22:41 2015 +0000

    Duplicate import

commit ebeacd25ca1a409c805b3b07281be60b9ac023a6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 21:18:27 2015 +0000

    Adding kerberos get/setter to the base transport class so we can do kerberos through the transport factory

commit 1d8f3a9a83a02092b75719d252ac29ca578dcdca
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 20:22:59 2015 +0000

    Better handling of NTLMAuthChallengeResponse.getData()/fromString(). Still not perfect since it's not possible to know whether the MIC field will be there or not w/o inspecting the Challenge message's AV PAIRS.

commit 5c6005027673c34101df58d18bfb44018453cde5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 16:17:55 2015 +0000

    Adding  getActiveConnections()

commit a170f7a02c1d65a506e0563655282e2841af5563
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 13:28:46 2015 +0000

    Added -dc-ip option, in case you want to target an specific domain controller or cannot resolve

commit 015c4efd28d960d9dbd2d0c6f5392368c3dac1af
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 8 00:57:32 2015 +0000

    1) Sequence number needs to be reseted when altering contexts
    2) Removing CCache status messages for RPC since it generates a lot of noise

commit 634aac146194c8076b2466c38e3811e56277e253
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 7 21:56:32 2015 +0000

    Happy new year :)

commit 5372825c7f4855f0d19ce7d7b25dccb388a66b04
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 7 21:56:08 2015 +0000

    Kerberos support for secretsdump.py. Matches the same usage of wmiexec.py (e.g. -no-pass switch)
    
    Examples:
    
    jack:impacket beto$ klist -v
    Credentials cache: FILE:/Users/beto/ccache
            Principal: Administrator@FREEFLY-2012R2.NET
        Cache version: 4
      KDC time offset: -1 second
    
    Server: krbtgt/FREEFLY-2012R2.NET@FREEFLY-2012R2.NET
    Client: Administrator@FREEFLY-2012R2.NET
    Ticket etype: arcfour-hmac-md5, kvno 2
    Ticket length: 1155
    Auth time:  Jan  7 18:43:10 2015
    End time:   Jan  8 04:43:08 2015
    Ticket flags: enc-pa-rep, pre-authent, initial, proxiable, forwardable
    Addresses: addressless
    
    jack:examples beto$ python secretsdump.py -k -no-pass FREEFLY-2012R2.NET/Administrator@FFLY-2012R2-DC
    Impacket v0.9.13-dev - Copyright 2002-2015 Core Security Technologies
    
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    [*] Service RemoteRegistry is in stopped state
    [*] Starting service RemoteRegistry
    [*] Target system bootKey: 0x22d7b24d8eb4032e9ba9baaf0f4f6b93
    [*] Dumping local SAM hashes (uid:rid:lmhash:nthash)
    Administrator:500:aad3b435b51404eeaad3b435b51404ee:ebd8ac3ca25e615c406c2c15b44a6ca6:::
    Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
    [*] Dumping cached domain logon information (uid:encryptedHash:longDomain:domain)
    [*] Dumping LSA Secrets
    [*] $MACHINE.ACC
    FREEFLY-2012R2\FFLY-2012R2-DC$:aad3b435b51404eeaad3b435b51404ee:0f88dee50c20e5a7c479df5c0ed94297:::
    [*] DefaultPassword
    (Unknown User):ROOT#123
    [*] DPAPI_SYSTEM
     0000   01 00 00 00 FC 8A 2B 5A  CE F6 FF 89 5D 0A C9 08   ......+Z....]...
     0010   62 60 22 29 D3 C0 19 41  B1 4D F7 B5 D7 68 72 75   b`")...A.M...hru
     0020   DE 37 EA 67 1B 20 FA D5  A8 1A F8 C1               .7.g. ......
    [*] NL$KM
     0000   9E B3 1A 1B C7 7F 28 87  9D D3 23 EB 9A 13 D6 FC   ......(...#.....
     0010   B8 E7 41 DE 8A F6 2B 4E  57 91 36 0D AD B5 39 8A   ..A...+NW.6...9.
     0020   86 4D D8 30 ED 0E 97 68  0B 0A 87 E5 D1 03 E5 8F   .M.0...h........
     0030   A2 ED 0C 75 C5 F3 DB 69  2C CD BB 1E 4C 82 C1 29   ...u...i,...L..)
    [*] Searching for NTDS.dit
    [*] Registry says NTDS.dit is at C:\Windows\NTDS\ntds.dit. Calling vssadmin to get a copy. This might take some time
    [*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
    [*] Searching for pekList, be patient
    [*] Pek found and decrypted: 0xe2f4cbb594d082e5ddc8bf0fb9892746
    [*] Reading and decrypting hashes from \\FFLY-2012R2-DC\ADMIN$\Temp\oBqCwVyB.tmp
    Administrator:500:aad3b435b51404eeaad3b435b51404ee:eba8ac3cb25e605c606b2c15b43a6ca6:::
    Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
    FFLY-2012R2-DC$:1001:aad3b435b51404eeaad3b435b51404ee:0f88def50c20e5a8c479df6c0ed94297:::
    krbtgt:502:aad3b435b51404eeaad3b435b51404ee:98fceba6f84d49a9837e6cf992c926ec:::
    FREEFLY-2012R2.NET\user1:1104:aad3b435b51404eeaad3b435b51404ee:2f5de3f35895d71d9cf16e52511cb692:::
    [*] Cleaning up...
    [*] Stopping service RemoteRegistry
    [*] Cleaning up...
    [*] Stopping service RemoteRegistry

commit b58f9379e50e0a3a7bdf80f73d09075b3371ed5f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 7 21:45:09 2015 +0000

    Kerberos support for wmiexec. It can use cached tickets or specified credentials.
    
    jack:examples beto$ kinit Administrator@FREEFLY-2012R2.NET
    Administrator@FREEFLY-2012R2.NET's Password:
    jack:examples beto$ klist -v
    Credentials cache: FILE:/Users/beto/ccache
            Principal: Administrator@FREEFLY-2012R2.NET
        Cache version: 4
      KDC time offset: -1 second
    
    Server: krbtgt/FREEFLY-2012R2.NET@FREEFLY-2012R2.NET
    Client: Administrator@FREEFLY-2012R2.NET
    Ticket etype: arcfour-hmac-md5, kvno 2
    Ticket length: 1155
    Auth time:  Jan  7 18:43:10 2015
    End time:   Jan  8 04:43:08 2015
    Ticket flags: enc-pa-rep, pre-authent, initial, proxiable, forwardable
    Addresses: addressless
    
    jack:examples beto$ python wmiexec.py -no-pass -k FREEFLY-2012R2.NET/Administrator@FFLY-2012R2-DC
    Impacket v0.9.13-dev - Copyright 2002-2014 Core Security Technologies
    
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    SMBv3.0 dialect used
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    Using Kerberos Cache: /Users/beto/ccache
    Using TGT from cache
    [!] Launching semi-interactive shell - Careful what you execute
    C:\>whoami
    freefly-2012r2\administrator
    
    C:\>

commit 83f871605ddd4f716ad4c1cdaf3293caabce4d00
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 7 21:42:36 2015 +0000

    Kerberos support for DCOM.

commit d9f6c98941c90dc3035c669c52df2cfa9d9c8e92
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 7 16:49:49 2015 +0000

    1) Replacing NTLM_AUTH_* for RPC_C_AUTHN_*
    2) String binding calculation now has in mind the target_ip can actually be a netbios name

commit 81598e19bc30274cd0e05102175bbc83ba343e60
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 6 19:26:15 2015 +0000

    More GSSAPI stuff. Right now, RPC SIGN/SEAL should be working for RC4. AES still not there

commit 6ce21783a4bb3ed018d56e7c5158aee3fe460551
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 4 21:52:54 2015 +0000

    typo in constant name (not value)

commit 41a2a0f64297c2cd4a6d75546cb5e1fb1f2591e4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 4 19:48:28 2015 +0000

    Support for RPC_C_AUTHN_LEVEL_PKT_PRIVACY for Kerberos. RC4 only so far

commit 17323a5f8d344a7abc96d28292b480bb1025b2cb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 22 21:01:34 2014 +0000

    Kerberos support for samrdump

commit ed1eaed9825a370df9c2d1c445f5949ff91c7cbf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 22 20:54:59 2014 +0000

    Adding RPC_C_AUTHN_GSS_NEGOTIATE support for DCERPC. Not yet functional, although I can now bind using Kerberos as SSP. Still needing to work on the authenticators for signing/sealing.

commit d3d623ffe70c3dc025820850863400fc3e41ec73
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 19 16:54:14 2014 +0000

    All domains in uppercase.. just in case

commit fd638816dff817d16bd567913bda46f28ce0eefe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 19 16:31:51 2014 +0000

    Adding -w ability to save the goldenPac y CCache format

commit 82fed57e303166408ad8613a7806ec170c57d784
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 19 16:30:58 2014 +0000

    Adjusting to new getKerberosTGT, getKerberosTGS output

commit db0c491213179798f309a619564083e8bdafc34a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 19 16:28:57 2014 +0000

    1) Better parsing of ETYPE_INFO and ETYPE2_INFO
    2) Better handling of etypes
    3) Support for writing CCache files

commit dd7516b9e36e754d7e8b6fa3def1134da69dc1bd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 20:06:15 2014 +0000

    opening the file with 'rb' for our Windows friends

commit 4386b864ba3845d1302c92f2454c8fbdba15694d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:44:13 2014 +0000

    Improved getMachineNameAndDomain() in case we can't get the data the normal way. Now it will try RPC against wkst. This is needed when authenticating using Kerberos.

commit 11a3ac8df300d13b4989b73e085641e447ef0fd1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:20:01 2014 +0000

    Disabling AES256/128 until I figure a bug out

commit 0e7f2bc32ad8528fb62b01c03b864aad2da6e7cb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 16:12:40 2014 +0000

    An example added for the -c flag

commit 4b54788c2b4c97aa59bcad8eeb6bf1936196d5fe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 16:09:06 2014 +0000

    1) kerberosLogin will never use cached tickets (useCache = False)
    2) Added -c flag, uploads a binary and executes it

commit 8d4fe046ebdd35fe038cc0d9c49863978ed3a924
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 21:33:33 2014 +0000

    My first take on Kerberos support for secretsdump.py.. Two ways to use it
    1) Have cached tickets in your ccache file (pointed by KRB5CCNAME). E.g.
        kinit beto@FREEFLY.NET (my password will be asked)
        klist -v
        secretsdump.py -k FREEFLY.NET/beto@FREEFLY-DC
    
    2) Use the specified command line credentials. e.g.
        secretsdump.py -k FREEFLY.NET/beto:myPassword@FREEFLY-DC

commit fe290c618005344a785f3b16c98ee507e9c5fa10
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 19:21:27 2014 +0000

    Printing out the domain+rid = userSid.. might be useful for some ppl

commit 0a84907c4562fcf2455ae0959bbb042256a11b2f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 16:44:10 2014 +0000

    Support for AES128 and AES256. If hashes are specified, RC4 will be choosen.

commit ed4e2c35d952bd526edec00e9f309c2f64b0e275
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 16:42:03 2014 +0000

    1) Now Kerberos should work with AES128 and AES256 as well.
    2) If there's a cache, it will look for valid credentials and use them if possible

commit 2c2ac326db71c9c118a2f6a2ba905e6b7439e03c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 15:14:51 2014 +0000

    Making it more general, not tied to RC4

commit 8cd229d7e6623004f76aa3c462062ac74026481c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 15 13:13:54 2014 +0000

    CCache initial implmententation.
    The idea is to be able to use the cached tickets to automatically log in. Still not activated.

commit 285aa21c4547c8cfad147c630828f3ccb80e9f39
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 12 14:12:38 2014 +0000

    Missing import (thanks juan!)

commit f37d3dc9613589a2274b1e5baec563ce0fc96284
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 12 00:48:26 2014 +0000

    Minor change, we don't really need to set the amount of groups staticaly :P

commit 3b7bce75e004346c0e7d5fcd7daa82a9fb2486af
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 12 00:44:34 2014 +0000

    More documentation for getGoldenPAC(), adjusted some values based on [MS-PAC] description.

commit c858ba572eb1b0fb7bd43b1ec7aa304a676efcfc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 19:31:27 2014 +0000

    Minor changes to the hashes code

commit 75dffd7619cd890faccd3178c13d4546a2a1e154
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 19:24:10 2014 +0000

    Hashes support for Kerberos (will only work when cipher == RC4)

commit 6d76dea61b8f634f1d80a412adbac784f01a90de
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 19:15:32 2014 +0000

    Hashes support added. This only works with RC4

commit 519060a53cbca0151f31651b14b339d7de07404b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 14:59:45 2014 +0000

    KERB_ERROR_DATA data type added

commit 4a4d053e0687eb696dd5cd432efb8c502cf700de
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 14:58:43 2014 +0000

    Requirement's update

commit d3cf806ca088a1719c6ee633e8e84e2d1d5daa00
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 14:51:20 2014 +0000

    Added commented lines for MD4 and CRC32 unkeyed checksums if somebody wants to use something different than RSA_MD5

commit fa55414498e00d8d607a3deeba16098cb4eab4ff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 11 13:28:47 2014 +0000

    If we receive a KRB_ERR_GENERIC error we try to extract the NT_ERROR from it.. might fail sometimes..

commit 8ddd84d0507fb2c53f6ba8d5cf5d9fdb7d588f1f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 19:31:58 2014 +0000

    Added smbconnection.getServerDNSDomainName()

commit 6a89785203bfc7af9f064592681514fae65af057
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 16:17:12 2014 +0000

    lcd fix in case os.chdir() fails, improvements to the TGS request

commit 43376416668bdcc6aaca8b31cdf691c2d4a25a04
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 14:41:52 2014 +0000

    PUT and GET weren't working. Hopefully now that's fixed. I wasn't starting the transferClient connection with the forged TGS ticket, and were using the normal user's credentials, hence getting an ACCESS_DENIED.

commit 0719d451b65c31903f878c15132910d649877ee9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 13:17:50 2014 +0000

    1) epm.hept_map doesn't work well against w2k03, so we're sticking to the ncacn_np stringBinding
    2) Minor cosmetic things

commit 5e9d7b0031e341a2df578ebd49e32d646fb93252
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 9 16:05:52 2014 +0000

    1) Added Kerberos support for SMB1
    2) When asking for a TGS for cifs service, domain is not needed, could potentially bring problems if the target includes the domain FQDN

commit d869a24fc49a0116cbc16de4d3d57638c4d935bb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 7 11:26:54 2014 +0000

    Fixes https://code.google.com/p/impacket/source/detail?r=1278

commit 23505695b153da6a683d81c86185383c3cbee798
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 7 11:25:32 2014 +0000

    Cannot execute as a script w/o this! ;)

commit d914b02710d0d3e6d5dbc57ef7fd4f066ebd4044
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 6 13:10:42 2014 +0000

    My take on MS14-068. Credit goes to @BiDOrD since he's got a PoC out first. Well done!

commit e9b4176f9c58e4617a70589861b97ea7e3e69350
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 6 06:05:11 2014 +0000

    1) kerberosLogin: now you can specify a TGT/TGS if you have one
    2) fix a bug in smb3 when calculating the signing key

commit 94bcf46ebebb100f06cd5c4831b05dde56ee37ea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 6 02:12:35 2014 +0000

    typo in AuthorizationData()

commit 166c7b0d364cae10e67816e78db9e6962eca5655
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 5 16:32:59 2014 +0000

    Removing debug dumps.

commit feb172ebc9bbd0da69870e9abf4062a840ec0215
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 5 12:45:37 2014 +0000

    Initial support for Kerberos (see previous commits for the libraries).
    From smb_client use:
    kerberos_login {domain/username,passwd} - logs into the current SMB connection using Kerberos. If no password specified, it'll be prompted. Use the DNS resolvable domain name
    
    It supports RC4 as of right now.

commit 7ed183aa48ced1e58581ece82cebcea12935ac6f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 5 12:43:45 2014 +0000

    1) Added kerberosLogin() to SMBConnection. Only SMB3 dialect supported so far
    2) Simplified Kerberos structs using dicts

commit 02ef6075f7c37da7239646f5dc63b65671854569
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 4 23:58:30 2014 +0000

    recv() doesn't always return the requested bytes :p

commit fe609d9444982d74e4b53d848962dd8729db2f60
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 4 21:35:43 2014 +0000

    Reverting previous accidental change to this file

commit b0fa3071d340083d291c33838e672d741c6495c0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 4 21:33:38 2014 +0000

    1) First attempt to support kerberos. Right now it's kerberosLogin(). Might be different in the future. Alpha code
    2) Start signing at the second packet sent (this is important for Kerberos signing)

commit 80faca5f6ea8ac62fffae6626abc47b3b4beb7a1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 4 21:31:44 2014 +0000

    Initial Kerberos implementation!
    asn1.py, types.py from https://github.com/mhorowitz/pykrb5 with some modifications
    crypto.py from XX
    Licenses should be OK

commit a023d3ffc6d879b2412c4ef485df7799194c2ddc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 13:43:31 2014 +0000

    Since share names can be UNC or just the name of the share, we should check them accordingly.

commit 8903e1211bbdf7424f902d588cf348832e9455b7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 24 13:53:18 2014 +0000

    adding a connectTree test case, with abs path and UNC path

commit 37af2379981a56d663010c2c96754566a0a61054
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 21 21:51:48 2014 +0000

    These fixes should allow using smbfs from Ubuntu to mount a share exported by the smbserver, e.g.:
    mount -t cifs //192.168.1.1/sharename /mnt
    
    1) Fix in the extended authentication mechanism, when a GSSAPI token is not received, and just a straight NTLMSSP structure.
    2) The smb.SMB_FIND_FILE_DIRECTORY_INFO structure wasn't completed when asking for a FindFirst2 with that level
    3) When calling NTCreateAndX, we weren't paying attention to GENERIC_READ and GENERIC_WRITE attributes

commit e9fb70adf5fc83470223d9fbf862b7667f940b6c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 17 18:31:29 2014 +0000

    switching to unicode before processing the actual command. This is needed in case directories/files are unicode encoded. Thanks renaud for the fix. This is part of the bigger https://code.google.com/p/impacket/issues/detail?id=51 issue

commit d746e86b8d51c74acbd851768fbcc03eeb49aff7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 15 23:09:31 2014 +0000

    Only parse the version field if we have some data. Just connected to a samba server and it is supporting SMB3, so this is not only Windows anymore. We should check in the future if Samba servers are returning something in the version field.

commit 2456145b8b7244ec7bc6231ca1c9414634ac7706
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 8 19:17:02 2014 +0000

    Clarifying one message..

commit 0ee8a7043414a015a2d9dbdc58c1729d1d6df6d5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 8 16:05:23 2014 +0000

    Fix trying to work correctly in the scenarios where NTDS.dit is not located in the default location.
    Thanks to mubix for pointing out the registry key to read for NTDS.dit location

commit df4d41c7fb5b56a0cb52408d2cee0534c197dc03
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 30 20:20:31 2014 +0000

    Fix for https://code.google.com/p/impacket/issues/detail?id=47 reported by carlruth

commit 9d9e3d73b23c688e411707898b695cf1c4370094
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 29 17:45:40 2014 +0000

    Fixes https://code.google.com/p/impacket/issues/detail?id=49 reported by mykesh

commit 2021a4072141aa4d1a2eb36003aa4c097e4b5d85
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 26 17:35:02 2014 +0000

    Fixes https://code.google.com/p/impacket/issues/detail?id=48 reported by Renaud

commit cc78dffc12384b7c13fa3bc921ac5e0f4e267acb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 26 17:33:53 2014 +0000

    Fixes https://code.google.com/p/impacket/issues/detail?id=48 reported by Renaud

commit aaf5ec1c266e5b444d15fec1fa363898af0de570
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 13 18:45:42 2014 +0000

    Typo when parsing the SMB2_SESSION_SETUP data.. It should be packet variable instead of ans!

commit 8115cff6e3d82bdda79e0b16b3e5b02bf5f6ed5c
Author: 6e726d@gmail.com <6e726d@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 3 00:15:29 2014 +0000

    Fixed minor bug when using -hashes parameter.

commit 2b6de58c7e7aac7858b33a0aba6b214963c5ccc1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 31 15:38:19 2014 +0000

    Temp fix for https://code.google.com/p/impacket/issues/detail?id=46 until we figure a better way to solve it.
    We're setting the Max*Size to min(0x100000, value-sent-from-server), which we know it works (Win7/8 sets it to 0x100000).
    In theory win8.1/2012R2 sets it to 0x800000 and for some reason the connection gets closed. However, my tests serves doesn't set the Max*Size to such big number, although a user reported it. More research needed.

commit a7672e4580c66242376045cbe2468b54be01a869
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 26 22:09:44 2014 +0000

     - Added file that contains pcap linktypes.

commit dc80285984cff34a988a34815902c0d256507f2c
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 26 20:30:07 2014 +0000

     - Moved pcap MAGIC outside the pcap header structure.

commit e672dc07950165b7a0f21198ae0415c6b32bcf9e
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 26 20:27:58 2014 +0000

     - Added frequency channel dictionary.

commit 6f94d4e43ebb697efb690bcc6684d50f6b010b11
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 17 16:21:37 2014 +0000

    Moving up to the next dev version

commit 5628648353a977a96c9f06b9dd2f39fc1512a3a6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 17 16:01:46 2014 +0000

    version change

commit b72c5eeea0b52fe1d9492c6ec2de4fcc4911f093
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 17 15:29:23 2014 +0000

    new version

commit 7075ae880609afb4598276dfbb86d358c60775ce
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 17 15:03:34 2014 +0000

    New features added

commit 893542cbce582b0c26ebdfd41a7e0db0849877d9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 26 13:54:47 2014 +0000

    Updating reference to testcases

commit 7d774b59a092340874ccfcbdebf19f62201625f5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 25 21:00:28 2014 +0000

    Bye bye

commit 82f4a4d4df76c5d0db6eecf8335acff5dff9e4e8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 25 20:58:48 2014 +0000

    You shouldn't be here

commit 669509ec11d07585f1ae2758f2128b14cc8fd1b5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 25 20:55:38 2014 +0000

    1) Moving SMB-RPC to SMB_RPC
    2) Changing inside dot11, test- for test_

commit e07ed49851310c75e3849a077e99b8a3d1656bfd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 23 18:14:15 2014 +0000

    Added command line arguments to set up a share. Now it should be really easy to launch an SMB server :)

commit 9065577d6b2cda0acb1a43441a87ca4c2a4dd68a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 11 15:36:00 2014 +0000

    1) smb.py: added SMB_COM_FLUSH structure
    2) smbserver.py: added SMB_COM_FLUSH command (not active yet)
    3) smbserver.py: added outputJohn call, everytime someone logs in, we output in John format the challenge/response, for further cracking

commit 9d74b68931e5cedb89dd2e9d0a3cbf2fc2d0205c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 19:46:08 2014 +0000

    No need to restrict the max packet size in Windows anymore :)

commit 1246c46784c92597bc89eaf01873fd677b0414a3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 19:33:13 2014 +0000

    infoRecord['EndOfFile'] can be zero, we gotta check that

commit 5b8d2dc2682c770514e27fe4b1e2ad3c1bdecc58
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 18:59:47 2014 +0000

    Adding config option to turn CAP_RPC_REMOTE_APIS on when negotiating the server's capabilities

commit e8453eb12d2ff450c67cb1c47f8a3086031a009e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 18:27:39 2014 +0000

    This changeset adds a minimalistic DCERPC server that is used by the smbserver.
    Why? With modern OSes connecting to the SMB server, you need to have a DCERPC server to serve MS-SRVS and MS-WKST (this last one for OSX clients, not yet implemented), otherwise they will NOT continue the connection.
    1) smbserver.py: added the SRVSServer class, that answers for NetrShareEnum(), NetrShareGetInfo() and NetrServerGetInfo() requests
    2) rpcrt.py: defines the basic DCERPCServer class, as the base class to be used for interfaces

commit b36eee904d2de9cbcdbb8e677101abd51b883460
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 18:09:57 2014 +0000

    Fixed hNetrServerGetInfo() when setting the now non existent InfoStruct field. Test cases updated as well

commit 67e3a13cfbf4824c4135b7df8dcd6fdf5489e0e7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 17:32:53 2014 +0000

    fixed NetrServerGetInfo() structure.

commit abb9d9bb05cf79cc3e3a019a0d11b60f83a2ff0a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 10 14:00:56 2014 +0000

    1) Docstrings added to SimpleSMBServer()
    2) Trans2/SMB_SET_FILE_END_OF_FILE_INFO now actually works, lseeking to the proposed allocated size
    3) I'm commenting  os.O_APPEND when opening a file, I think it is not needed and prevents 2) from working. Testing is needed

commit 48412a928c269325d0e473d23c9702f75aba2c38
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 9 17:07:34 2014 +0000

    Setting 127.0.0.1 as the address to bind and connect to the MS-SRVS server

commit a3ba4bbff2565734f0697d83546fcc41d32e5aa4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 9 16:51:07 2014 +0000

    1) Removed the smbserver directory
    2) Now a single smbserver.py example, that contains everything needed to run a simple SMB server and share files

commit a41382de3b12dbe1d0d4044db673716596021ffb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 9 16:49:43 2014 +0000

    1) smb.py: added CAP_RPC_REMOTE_APIS
    2) smbserver.py: Added SimpleSMBServer().. An easy way to launch a SMB Server and configure shares.
    3) smbserver.py: MaxMpxCount is set to 1 now, we don't want to deal with multiple connections from the same target.
    4) srvsvcserver.py: Now works with logger, some methods for processing config files refactored.
    5) srvsvcserver.py: Secondary address now points to \PIPE\srvsvc, this is needed to OSX clients.

commit 943286fa287203498dda1cab5da37aea52b49eec
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 5 22:28:55 2014 +0000

    Fix for https://code.google.com/p/impacket/issues/detail?id=44.
    SMB.retr_file() calls SMB.nt_create_andx() that was trying to open the file RW, which would trigger a problem when trying to read a file from a readonly share.
    I changed SMB.nt_create_andx() so it will accept an accessMask parameter (by default the same it was before, to minimize spash damage). SMB.retr_file() now calls nt_create_andx() with READ ONLY accessMask.

commit 99a3592eebc3a4e9827041ae4ec6891bb8fd4285
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 4 18:11:36 2014 +0000

    Stripping useless fstat() calls.

commit 92f1388318293ff2dfe4e2b3a6c46be932cf4f1c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 2 17:13:48 2014 +0000

    1) Added warning message when trying to CD to a directory
    2) StdErr is now also being included in the answer

commit f60357d512fda3b8f07da966be637cd69e357c76
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri May 23 18:51:05 2014 +0000

    Solving the same problem described at https://code.google.com/p/impacket/source/detail?r=1145&path=/trunk/examples/secretsdump.py, this time for esentutl.py

commit a0b82a054c53bdc3b54bb39461ea0d77a1b8800c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 19 14:57:30 2014 +0000

    Sync with Core's internal repository. Several fixes on nmb.py. This file should actually be rewritten, it's still using the old pysmb approach.

commit 77df3c13439869ede5b92bc9d035696634efb957
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 14 20:11:52 2014 +0000

    dcomrt: added set_objRef()
    wmi.py: added IWbemClassObject.SpawnInstance() and IWbemClassObject.marshalMe() (the method's naming convention is intentional :) ). PutInstance() and DeleteInstance() seems to be working well

commit 3a397dcdfef1dbbeab1c8de6abe69f1563cacf36
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 12 19:59:38 2014 +0000

    Fixed bug triggered when maxRid was a multiple of SIMULTANEOUS (thanks mubix!)

commit 3c79905a1ad4b24809791219a8a7fb4667b3cf27
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 11 22:59:12 2014 +0000

    type of default share parameter (should be ADMIN$ instead of C$)

commit ce015b25f3e14a6f5062438d57bae9ca56085838
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 7 19:03:42 2014 +0000

    Waiting for the thread to finish.

commit 2e9e0f3988e1bd934b259f3c036f5e93feb3a9c6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 4 22:49:02 2014 +0000

    1) Changes in the .py initial comments
    2) comev.py: Added specific IID used to self the request to
    3) dcomrt: Now we parse and store the minimum auth level required for the interface, used later when binding against it

commit b59b696c5c641b04309a607901c4d21d264b6908
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 17 15:20:44 2014 +0000

    Added -nooutput switch. You won't get the output of the command, but at the same time it doesn't open a connection against 445 for reading it (plus doesn't write any files at the target). Only works when specifying the command to execute through command line

commit 6214791a1257ebbef100ac665be7ce8099047be4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 20:33:05 2014 +0000

    Fixed https://code.google.com/p/impacket/issues/detail?id=42 reported by mubix.
    This is not the best solution so far, but until I figured out where OrderedDict is installed on different Python flavors i'm using this approach.
    I'm also applying the same fix for the ESE database parser that also uses OrderedDict. (used by secretsdump.py and esentutl.py)

commit b731389fe61b77f67ad7ee05ac3dbb769b256ec7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 18:35:19 2014 +0000

    Removing traceback and exception messages

commit c4421dac880966683df5fa4ad67b8325f5d0a50b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 17:59:24 2014 +0000

    Adding propset ID

commit 1cfe0970213c06e576fb70385b24d3be01a93c23
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 17:57:44 2014 +0000

    Reverting previous changeset

commit 78845a0c2d0b4ef3a5d6667df26737872ecc5fae
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 17:48:38 2014 +0000

    Adding propset Id

commit ace7aa33ae2bef083371071ac1ab0a283e488fa6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 16 17:46:10 2014 +0000

     A similar approach to smbexec but executing commands through WMI.
     Main advantage here is it runs under the user (has to be Admin)
     account, not SYSTEM, plus, it doesn't generate noisy messages
     in the event log that smbexec.py does when creating a service.
     Drawback is it needs DCOM, hence, I have to be able to access
     DCOM ports at the target machine.

commit e0bbf550c6c6a8ac21463bc66fe4342fcdb1ff04
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 15 16:57:22 2014 +0000

    Just a cosmetic fix so column separators are printed the same way as headers

commit b5aba39e3351d5720ec989aa1d2ab0c8fd1a43a9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 14 20:40:31 2014 +0000

    Getting better..
    1) Changes on names for structures (all upper case) from all the WMIO part
    2) Now we're generating the methods for a class or instance on the fly, whenever they are called (check the ExecMethod example)
    3) wmiquery.py updates

commit 040a723ba0aee4278d26f43cf0361b0ce2e18b99
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 11 21:14:11 2014 +0000

    DCOMConnection by default doesn't launch an OxidResolver thread. Not needed in most of the cases. Wmiquery.py needs it ;)

commit b85197c12afdfe8e8d72cdfacae618995c7183a7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Apr 11 21:12:39 2014 +0000

    More advance.. ExecQuery is starting to work. When calling GetObject, it will dynamically create the methods :)

commit 430b46ef3b25c6584a6931b6d50c49b4c12b3abf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 9 20:42:50 2014 +0000

    Updates for testcases to work with DCOMConnection

commit 21365a76e4c20f83609e8ed2d69d3ee084e54200
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 9 20:07:23 2014 +0000

    typo on one method's name, it should be test_hSamrQueryDisplayInformation()

commit 431bce6543e5b2309872a851f04cb1c7852fd32d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 9 19:54:21 2014 +0000

    1) Implemented DCOMConnection() to encapsulate all the initial DCE/RPC connectivity
    2) Implemented a ping mechanism to mantain the objects alive in the target servers

commit 54af60449015e51786a5846042a34cb8c021a514
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 9 19:50:43 2014 +0000

    1) Adding support for CimTypeEnum.CIM_TYPE_OBJECT
    2) Fixed some typos on structure/methods definition

commit dc66234b2b9440bc8535c78b2986e7d957c958d4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 8 15:05:39 2014 +0000

    Fix for https://code.google.com/p/impacket/issues/detail?id=41

commit 7c5cc44207cf805662be55e19f14180b5cce9b95
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 7 17:02:18 2014 +0000

    Ability to specify an oxid when creating an interface

commit fa863a80fec27afb9e56de4ee8675286192103f3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 7 16:38:42 2014 +0000

    dcomrt.py: dcomrt now uses a single connection and performs alter_ctx to switch between rpc bindings instead of creating a new connection for each request. Big boost in performance.
    wmiquery.py: RemRelease shouldn't be done against the WBemObject, but against the Enumerator one

commit 8e523b437db038e028d7bb8e8e5b8ebf38793653
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 6 22:06:36 2014 +0000

    Missed RemRelease for the iWbemServices instance

commit 45511be2193ab29f078cf805f9301684204042a4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 6 20:54:40 2014 +0000

    wmi.py: methods for parsing the class for later use
    wmiquery.py: script to test wmiqueries easily ;)

commit 040da58b3dd115d7b1eb77b37cffc1d6664914c4
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Apr 5 19:27:43 2014 +0000

    Now method parameters are parsed/printed when calling GetObject

commit a86fde1a4cd01aff38f16d6e0ad41ebd9922b5a7
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Apr 5 16:11:38 2014 +0000

    Improvements to getProperties() and getValues()

commit 925e3f80776fbe96b34d880440d9ef907e4d6b42
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Apr 5 16:10:59 2014 +0000

    Setting up a high timeout for requests

commit 4ffcdf840c1337e53451abed2515acca2ff3bb3c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Apr 5 01:47:54 2014 +0000

    [WMI-IO] is ugly.. but anyways.. almost there.. There are some errors triggered that I still gotta find the solution for.
    the updated testcase output is promising :)

commit f651ad06cef4b6ffe429c0085f45432761e67015
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 23:56:25 2014 +0000

    Adding the [MS_WMIO] part

commit d6c7c28f2c5065807a0cf83be1f8882cb151cfc5
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 21:11:56 2014 +0000

    test cases for wmi.py

commit d9a9cbbd7923fdee76b85c79f6a1f4afb97f9b29
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 21:10:41 2014 +0000

    [MS-WMI], just starting

commit b4461fa7bdeb8775aa63cf835a626d2812e28bbb
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 19:23:40 2014 +0000

    INTERFACE.process_interface(): iPid and Oxid is not present inside a OBJREF_CUSTOM

commit 4d1eb6191e1a08931486d528f7a79f0336d28bea
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 19:12:55 2014 +0000

    Adding PPMInterfacePointer()

commit 12570727931db2b1854728c37f7c927506c583bd
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 17:02:09 2014 +0000

    When calling alter_ctx we must update the ctx for the subsequent calls

commit df25a527624d30b917cbc50cef2a783dab1c5354
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 16:48:49 2014 +0000

    Fixed wrong constant value for DOMAIN_GROUP_RID_CONTROLLERS

commit 7e2f8a437156e417937ad28ad80d72839bebcd80
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 3 15:01:43 2014 +0000

    Added 2.2.32 LPCSTR

commit 78fb61599b2db8c8c4976764fc13afb7e3efabd5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 1 18:58:56 2014 +0000

    Just changing some variable names

commit 2e91ea1e1674a86b7e907c06af15e1c281d6f4ec
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 1 18:57:56 2014 +0000

    Added:
    1) IDispatch::GetIDsOfNames()
    2) IDispatch::Invoke()
    3) ITypeInfo::GetNames()
    4) ITypeInfo::GetTypeComp()

commit 3cb52bcae189e09d5547c86c39c15ecdb348889e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 1 14:19:29 2014 +0000

    Added:
    1) SamrLookupNamesInDomain/hSamrLookupNamesInDomain
    2) SamrLookupIdsInDomain/hSamrLookupIdsInDomain
    
    Test cases also included

commit 18b92f63f4ae04c9ded1f38d25cb895ec3578752
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 29 23:53:10 2014 +0000

    fromStringReferents() and fromStringReferent() now returns the amount of bytes they consumed. This makes it easier to update where we are reading at the packet buffer, instead of calling getDataReferent/s() methods, saving some time and making it more efficient.

commit 43df600cec844470ace66905f507f102f78b2ed2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 28 20:55:07 2014 +0000

    Added ability to not align an Union in between the tag and the data itself. This is not the ideal solution, but I can't understand how pads are calculated there. More research needed, but for now the dcom runtime is back working.

commit 88e72104ae7db9fde13c13bd3646e67a092597d3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 28 19:25:43 2014 +0000

    Reverting the change in alignment I did before. It breaks my test cases (just figured when dumping the responses), but reverting back brings other problems to the dcomrt. So... everything works except dcom, which is brand new.. so can't be still used until I figure things out.

commit 7e23ae31b009a658a728c92401020bc998df5b5e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 28 19:24:17 2014 +0000

    Comenting one request that doesn't work (was commented before)

commit d8da122268142ae7c05bb8b31c7e9ac121d564a0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 28 19:20:01 2014 +0000

    Uncommented all the dump() calls. This is an extra check to verify the data comes/is parsed the right way.
    
    When running these testcases, save the output to a file (or /dev/null) so you can see the normal test case output

commit 1de7787b0d2a6c73b0a7b5401a0741aefc156b66
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 27 15:50:35 2014 +0000

    1) Added 'default' clause for NDRUNIONs
    2) Changed the alignment calculations for NDR32 in NDRUNIONS

commit b2155a2eef33273e4d70aaf1326b240f77cb0a2b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 23:54:19 2014 +0000

    1) Added ITypeInfo::GetFuncDesc()
    2) Finished ITypeInfo::GetTypeAttr()

commit 5bdc9cb3a0ede74af566ae13563a7113bbdd9c04
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 23:53:02 2014 +0000

    We don't want an extra CRLF when dumping enums

commit 376efb9462255275ec9e8cb96972d39c40c63ea6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 23:01:39 2014 +0000

    RemoteGetClassObject() now returns an IRemUnknown2

commit 669813e55d830bd9b68da4e82d74536801960bdb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 22:53:16 2014 +0000

    Bye

commit b25baab9cd7077d30dc28c195e3aaf31f5e746e6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 22:53:00 2014 +0000

    Added test case for RemoteGetClassObject()

commit 9e03d5d3cf66caca6790ac145814e243f13c4ee3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 22:51:44 2014 +0000

    RemoteGetClassObject() now working

commit f50c86d9930e304646824aaa6f0ff7ce02b794fc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 19:33:57 2014 +0000

    New name, since we changed the module as well

commit 72ab89dccba6897f489e9e09702dac1f9ad2e236
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 19:33:25 2014 +0000

    Test cases more organized.. only using the helper classes/methods

commit 80265aa1c9da1916f031f9e369c1dfdb7882df29
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 19:20:56 2014 +0000

    1) self.__marshalled_iid not needed anymore.
    2) fixed IIDs in comev

commit 358f82afd6d001368ee886f25e929bb205e49e6b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 18:50:40 2014 +0000

    1) Added IObjectExporter::ResolveOxid(), IObjectExporter::SimplePing(), IObjectExporter::ComplexPing(), IObjectExporter::ServerAlive(), IObjectExporter::ResolveOxid2(), IObjectExporter::ServerAlive2()
    2) Added IActivation::RemoteActivation()
    3) Added IRemoteSCMActivator::RemoteGetClassObject(): Still not working

commit 2847a229267bb460efb1b7af36e780207de8ca9e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 18:45:56 2014 +0000

    Moved some definitions into the class constructors in order to get away the forward reference need

commit 2b4b6c5be0c60c6420db60a0f25ff2d8523b691d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 00:37:06 2014 +0000

    Added targetIP to the INTERFACE constructor. This is needed for now, when parsing the stringBindinds in order to connect to the right machine

commit eb94713d28584cb99b50c736705b34f64845928d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 25 00:36:11 2014 +0000

    Added get_rpc_transport()

commit 9023cfd7046cc3b338535e91836e0afeb197c1f4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 22:23:58 2014 +0000

    Adding dcom directory to the install path

commit c31b00a7407410bdb8515e9e3faec90c739c2c62
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 22:22:54 2014 +0000

    Stuff with various test cases while I develop the dcom runtime

commit 28cbc46779011d5c56937d5a00bdfc7f67e5dd39
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 22:19:59 2014 +0000

    Bye

commit 388c8fd730bc061348de5ae22b62eb4045131d9d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 22:19:07 2014 +0000

    DCOM Interfaces implemented (not complete).. Further testing needed, still way to go

commit 16c2781cbc2fe415591977a54aa54ec1f6c27573
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 22:15:31 2014 +0000

    If it cannot find the module in the current directory, try the subdirectories

commit 70c75f245984909e232378e027dd08e9c3535dea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 21:56:40 2014 +0000

    Moving it to a different name. DCOM runtime

commit 7a69be9bb22b4410b5afcb5a2b0fcb4e1021e251
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 24 21:36:59 2014 +0000

    More data types added

commit 55faa58b91e2b2ced18aa0256ed3c07940da0d7b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 22 04:20:29 2014 +0000

    1) More dcom stuff
    2) added BSTR to dtypes

commit 44aafc96d933a121ce8d1451ec1ed6c3231a8445
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 21 19:35:48 2014 +0000

    Added an extra check trying to find the right error code when something goes wrong

commit 1d2a92e181d8ed1e72157f3eee7c8705df6fb420
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 21 19:35:03 2014 +0000

    Adding SHORT type

commit c96c2c08749a548fba869f2d870b3126ec95f580
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 21 14:49:10 2014 +0000

    Fixed bug in getServiceAccount() method. It wasn't using the parameter received pointing to the serviceName to get the running user from, instead it was using self.__serviceName!

commit acc0d50ae130c2c2409cdcd4798452ff6966c793
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 20 21:34:34 2014 +0000

    more stuff on the DCOM saga.. still way behind doing something useful.. but getting closer

commit 6d04c633259124e7e2a485afc369b397ca00122a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 18 15:18:21 2014 +0000

    1) Added ability to specify an UUID inside the RPC Header (needed for DCOM)
    2) Whenever there's an RPC Error, it will look at HRESULT errors when printing the exception

commit e0ba0fb3b856b335947022a005b87ddb3863dac2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 18 15:16:54 2014 +0000

    HRESULT Errors from [MS-ERREF].

commit f631e988934d8ca1d67bf58e2c0f691ecbe084ff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 18 15:15:22 2014 +0000

    Added LONGLONG

commit 31b4fac3a448cbd67f4ce5a8a9650ba936842c05
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 8 16:48:26 2014 +0000

    Adjusting some data types

commit b5140ea1261ea64a21d570c3dd36e6aa71d82734
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 4 19:00:45 2014 +0000

    Fix for https://code.google.com/p/impacket/issues/detail?id=39. Under Windows 2000, the NoLMHash registry key does not exist, and we weren't catching an exception under that situation. Should work now.

commit b262d7e8747a7e10390789525f6e4b9101db3db0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 27 19:33:36 2014 +0000

    Fixed typo in hSamrEnumerateUsersInDomain(), the userAccountControl parameter was not being included in the DCE call

commit 35c4edbc74dbceadc708a3abff82380afaa2135a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 26 16:20:19 2014 +0000

    Fix for https://code.google.com/p/impacket/issues/detail?id=38&thanks=38&ts=1393431491
    
    The lpClassIn buffer must be completed both at the MaximumCount and MaximumLength level, in order to work on WinXP

commit ddf21422925b068aa2519117b7e9e0cca6b7e09a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 20 16:06:30 2014 +0000

    Added some try: except: clauses when parsing ntds.dit, since based on feedback from a user, when dumping a huge amount of accounts (over 1MM) there are some rows that might be corrupted, hence triggering a decoding error. This fix will report that problem and let the script to continue running.

commit bcfcf50ccdff1f3e165801b629c4d7dc59a16c02
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 17 20:27:11 2014 +0000

    Sync with CORE internal repository

commit 79442b597d1dbd30057f3a45b90fd619af750788
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 17 20:23:22 2014 +0000

    Sync with CORE internal repository

commit d806d50191a0a97c8bc17b8779caf9315d1621b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 17 17:56:43 2014 +0000

    Sync with CORE internal repository

commit f7d9b6bbe6bdd1baa66febedd9f9fcadcefd5d4c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 12 16:39:51 2014 +0000

    If we cannot open the SCMR, let's raise an exception so the target file uploaded is removed

commit 12202d942e9e1c488ff0c6e69ea546220890eb8f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 11 15:13:03 2014 +0000

    Whenever we detect the target system has signature required, we print a warning message stating the attack will fail

commit eb07deaf0ddb21ce990a24376b0bbba0aa780bb7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 3 16:19:04 2014 +0000

    Updated home URL

commit 0a230f6097c8ab7fb1adebf505a12e28b8eac544
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 3 15:52:45 2014 +0000

    Typo at ScmReplyInfoData()

commit 5800faa508d9654ab1dae5b0a01f17184c239a3b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 3 02:28:10 2014 +0000

    Replacing evals() with getattr() :)

commit a5c52d22a9391cbb530b307b730c068efad56562
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 2 20:45:10 2014 +0000

    dcom test cases so far

commit cf101a0c378780ba4c340693f2b58ca72ebeb409
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 2 20:44:43 2014 +0000

    [MS-DCOM] Interface Implementation, just starting, way long to go.

commit 6b9d77576cdc5e1984432b73b054c564f28c0f0a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Feb 2 20:41:25 2014 +0000

    Forgot to marshal the referents for the Type1Serialization

commit 65049cdd1614f9140ca586716fa3fd8d2125a142
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Feb 1 18:06:37 2014 +0000

    Adding [MS-RPCE] 2.2.6 Type Serialization Version 1

commit d970afc2fe558f56adeb59f9da89320e5d5a4e54
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Feb 1 18:04:33 2014 +0000

    Adding HRESULT

commit 0cb3ac833c2feefac3569e57dbb85a0c52821c42
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 30 17:00:04 2014 +0000

    We're adding the UDP Transport back.. not yet fully functional

commit f81e61a94520680b35e237ce0ec7ff6c27d222dc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 30 16:59:20 2014 +0000

    Moving to next version 0.9.12-dev

commit 0d7f0f2710f16537c80b7679f75f0af3650e87f2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 22:01:46 2014 +0000

    We'll be storing testcases inside /usr/share/doc/impacket

commit d04394011056e1c99c4faefef105f7ea769f83ea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 21:00:37 2014 +0000

    Adding testcases to the source distribution

commit fbef39b5ef354e4b6b604a0298a81376a5519c7e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 20:22:33 2014 +0000

    Added setSessionKey(), we'll need it in the near future

commit 439791f587d58cfb5903956a853ed7d9f197f711
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 19:58:16 2014 +0000

    SMBConnection.listShares() ported to the new rpcrt

commit 5e31023011b49da2699a2eb6621d7053f15a5523
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 19:38:32 2014 +0000

    Another place to find ordereddict just in case it's not present

commit 42eb8721fca32b39004f56e02d5fe6cd38be405f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 19:00:46 2014 +0000

    Added experimental for some features

commit cb1b2e5a8bf51bdf61b5305a6ade8b9b38f7025b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 17:51:05 2014 +0000

    minor changes

commit 40b9cfab1e12c4ec211ede68a3936cf23edb7524
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 17:41:25 2014 +0000

    Typo with numberings

commit 7b6a75d913d686330fff041e5022d0ab30a69bab
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 17:40:19 2014 +0000

    Updated changelog

commit 9d504f8b5c486714a2c4e69d680bad623f05f90c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 27 14:24:59 2014 +0000

    No need to declare ndr.*

commit 753ca996807cead7e696c00d13abc952e8517056
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 25 22:38:46 2014 +0000

    Updated

commit a92d9dfa01db679fcf085bc7ff480b9b41459224
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 25 19:04:39 2014 +0000

    Wrong array set.. defaulting to RPC_UNICODE_STRING

commit 1d487efd944e296bdeb35bd444abe0a70c63adb6
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 25 18:38:23 2014 +0000

    1) Added more helper functions
    2) Checking whether NULL strings were sent to the helper functions

commit bf681a5ada6c018a37913fc9302b7863a64b3ec2
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 25 17:47:06 2014 +0000

    Adding LOCALTransport()

commit e2c10ac619c1bae5cb73bba6575f349aea2438e5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 22 20:08:04 2014 +0000

    dcerpc.v5 must be installed

commit 6fc2a346facc69fe01209034075fc7dc91b1b5bd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 21 20:58:34 2014 +0000

    ntfs-read: stripping CRLF
    registry-read: forgot #!/usr/bin/python at the beginning

commit 0aa53f2175d1335f7431b7ad2824487512125a89
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 21 20:46:43 2014 +0000

    In preparation for new version

commit 4f522b22d0afd1e5e73c788de11c87f84a83e5ec
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 21 20:45:51 2014 +0000

    Stripping CRLF

commit 3f2237c3fa658331c13a1806b864fa07e78023b1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 21 20:40:06 2014 +0000

    Not needed anymore

commit 8763dbb2fa26d7c0e2f1927a122c6c28ed8dc359
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 21 19:44:16 2014 +0000

    Cosmetic changes

commit cbd52b52efb71862c13834b3b67c351ff31f2d10
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 20 14:13:58 2014 +0000

    test cases updated

commit eccfeb32cfd1abcd75f605a4c3a89f054c75f89b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 19 14:25:32 2014 +0000

    Ported to the new RPC runtime

commit 349116e6960275079d4dc753ffa833351ca3ef4b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 19 14:17:01 2014 +0000

    Notes added

commit bf1f93000a9f40c61e5c8377d9f25d5fa4d08050
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 19 13:56:06 2014 +0000

    Added checkNullString() to some helper functions to make it easier for the caller to consume them

commit b444686f028acbc6a2b7da585d5341af3658b50c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 19 13:55:08 2014 +0000

    Some helper functions added for nrpc

commit ec0ccde4985d143bd4d5c9c3b1b273fd8b807ecf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 15 15:14:46 2014 +0000

    Helper functions for wkst + updated testcases

commit 62de6d31c2e072a94c1ab428bcc678205fc13319
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 15 03:21:05 2014 +0000

    1) helper functions added
    2) smbclient updated to use the helper functions

commit 850b6c7e3b8a7f5f344b4478117256335009038e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 14 22:15:30 2014 +0000

    Migrated to the helpers I just committed

commit 18fde7133d7c2329a858a7bf29187264bd64f68c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 14 22:08:43 2014 +0000

    Helper functions!

commit 94227f56a1bc9ed58f3efd7dc2acade54d83e5d4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 14 18:55:39 2014 +0000

    Helper functions for LSAT

commit 34451db6b8ab07967215688b9d62028cedbc4d53
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 14 17:12:31 2014 +0000

    Helper functions in place.. done!

commit 7ce38023e8a70d995c58ff9b16140b29d4d57f97
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 14 01:38:30 2014 +0000

    1) [MS-RRP] finished.. just need the helper functions
    2) Added another derefference to ndr setitem to help setting NULL pointers for RPC_UNICODE_STRING like structs

commit b568b5ada2b7cfe6729c640e7f931a082f916dfe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 13 15:26:42 2014 +0000

    More work on RPC_UNICODE_STRING

commit 3bf1172426be13b8c0c1e72aa723276329cf720a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 13 15:26:01 2014 +0000

    SAMPR_ULONG_ARRAY was wrongly defined

commit fce7bafadde72b567cd8dc733b86ff554ffd88f9
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 19:27:07 2014 +0000

    [MS-RRP] Interface Implementation. Not yet finished

commit abe6deddb89cbe4d3a92c488133a18789a2d3a5b
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 18:40:15 2014 +0000

    RPC_UNICODE_STRING() dump method is actually needed :s

commit b177e2b6bc955394b88ecae7864f97da5996c6fa
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 18:04:34 2014 +0000

    A much simpler RPC_UNICODE_STRING

commit 1d6263f59d4213ac3b7b66b39f54aec2538b1567
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 17:39:22 2014 +0000

    NDRBOOLEAN now prints True, False when dumping its contents

commit 35fe0f3ab4c3e45e0de9b06579faf73779b00156
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 16:04:21 2014 +0000

    Adding some more data types

commit a3fc72eeaafe7955dfc33a51b99efaabf3cfc25f
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 13:38:58 2014 +0000

    Moving the SMB-RPC test cases to a different directory

commit df18d1b0427c0d43bd6814636b7f6505e1f726f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 11 00:14:14 2014 +0000

    Added OPNUMS dictionaries

commit ed8aae1deadb585256c9d87407c3a6776c80c5b0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 22:27:02 2014 +0000

    Forgot to comment the tracebacks

commit 041c53a0f77084a4baca91d1ef896166f23432e7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 22:21:13 2014 +0000

    Migrated to the new RPC Runtime

commit d23a5aa6685e891bed0af40b46e3ac06415bf8a3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 21:53:59 2014 +0000

    Not needed anymore

commit aef50c4edd28c6d979dd49665ee43b108d64143a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 21:51:47 2014 +0000

    Adapted to the new RPC runtime

commit 258481c96bc4cdbbd69323d4dd8e6af0409b3ed0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 16:29:15 2014 +0000

    Updated test case + fix response structure for NetrUseEnum()

commit f650500fadbc5f4dba7cc64317e5424a14e25a3b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 15:30:00 2014 +0000

                # The RPC server MUST ensure that the RPC_C_AUTHN_NETLOGON security provider
                # (as specified in [MS-RPCE] section 2.2.1.1.7) and at least
                # RPC_C_AUTHN_LEVEL_PKT_INTEGRITY authentication level (as specified in
                # [MS-RPCE] section 2.2.1.1.8) are used in this RPC message.
                # Otherwise, the RPC server MUST return STATUS_ACCESS_DENIED.

commit 0180f6afd880e18a7dd481005ede320dac38b697
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 15:03:36 2014 +0000

    calls made to SamrSetDSRMPassword using NCACN_IP_TCP are rejected with RPC_S_ACCESS_DENIED.

commit 5d6eef41744b7f744e4907640ee7c0cf2eaa28a6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 14:57:41 2014 +0000

    NDRPOINTERNULL must be created again based on the NDR transfer syntax in use

commit 4bc2b68c6aee5c59b8be818a0cc5bc8c5805ab7f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 14:16:23 2014 +0000

    Moving some methods to the base class

commit bf980c3240553701d5d389a762cbc9025fe3ee2c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 10 13:48:41 2014 +0000

    Change in MSRPCBindAck base class

commit a3c810cd852ba1d9d29452c1b883c5e94f0cf9c6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 23:25:44 2014 +0000

    Updated to the new RPC Runtime

commit 4496a4658fd2651902564804b614d03023a1cb90
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 19:17:14 2014 +0000

    Ported to the new RPC runtime

commit 7f431841b60bdfcb09112db784072e0643ecb644
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 19:12:51 2014 +0000

    Same functionality as before, but ported to the new RPC runtime

commit 98b07863670ebc3c4201c48070f5e0fb7483b8e1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 18:46:43 2014 +0000

    Typo

commit e74e6e9d548c40f2ffde50afe8ff6749a0c18440
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 17:35:50 2014 +0000

    Bye bye.. we don't want you anymore.. replaced by nrpc.py

commit 3ad62a7d37994c82c0156637ca6639189e73c50e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 16:17:48 2014 +0000

    Enabled the TCPTransport testcase

commit a539ce6209d65e5f5b8409467a800a2c6832e84c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 16:11:21 2014 +0000

    We should respect the transfer_syntax previously choosen when doing an alter_ctx

commit 0a138a62127e4a56950fc97b45686529f082ca0c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 15:21:39 2014 +0000

    NETLOGON RPC_C_AUTHN_LEVEL_PKT_PRIVACY and RPC_C_AUTHN_LEVEL_PKT_INTEGRITY support. Right now just supporting RC4, not AES.

commit 01f134ed25eeebe2d81029c0cb7eddc972390971
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 9 15:20:45 2014 +0000

    SIGN() and SEAL() refactored so it makes it easier for users to consume these functions

commit 9f9db801214048c5754578c61e27d73b2f564a0b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 8 16:34:29 2014 +0000

    1) Fixed typos on som calls reponse's structures
    2) Added a dictionary with the opnums and their structures

commit d33a5c8ce7c562202e18ab58612d91aa4fc863f5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 8 14:54:02 2014 +0000

    changeTransferSyntax() needs to recreate some data types whenever we change to NDR64

commit 57cf1ce036c4b2dad503321548a9e869a4b07d73
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 8 12:35:19 2014 +0000

    Added NDR64 tests.. still some failing

commit 2f033cdb65078933b7f5290a8b0b1537c06b0c76
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 8 12:18:42 2014 +0000

    The alignment saga continues

commit dfff6f25e92da505d6ee671c43aed727c031d626
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 7 20:08:28 2014 +0000

    More alignment stuff + fix in nrpc DsrGetForestTrustInformation()

commit ca1d78743f10f9ffe194a15477aadbd867ddbd93
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 7 17:27:42 2014 +0000

    More padding and alignment stuff, in preparation for NDR64.

commit b5f65486bfb6747633c806697893ab1c08d25af3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 7 15:47:25 2014 +0000

    Forgot to change the call to NDR.getData()

commit 044653431fa9884b65f809a048f840cd979df8d8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 6 22:02:40 2014 +0000

    Fixed bug inside fromString when NDRUniConformantArray and NDRHYPER was present.
    This code wasn't working:
    from impacket.dcerpc.v5.ndr import *
    from impacket.dcerpc.v5.dtypes import *
    from impacket.winregistry import hexdump
    
    class Puta(NDRSTRUCT):
        structure = (
            ('Nose1', NDRLONG),
            ('Nose2', NDRLONG),
            ('Nose3', NDRLONG),
        )
    
    class Conformant(NDRSTRUCT):
        structure = (
            ('Item1', ULONG),
            ('Item2', USHORT),
            ('Item3', NDRSHORT),
            ('Item35', Puta),
            ('Item4', NDRUniConformantArray),
        )
    
    
    kk = Conformant()
    kk['Item1'] = 0xaa
    kk['Item2'] = 0xbb
    kk['Item3'] = 0xcc
    kk['Item4'] = ['a']
    kk.dump()
    
    hexdump(str(kk))
    nn = Conformant(str(kk))
    nn.dump()

commit 37bf2aad330ab2b6c4ea579db74d627aeaf40051
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 6 20:40:58 2014 +0000

    Getting rid of unnecesary align attributes

commit 0989d49f1d2eab4ca479b243073752cf0fcf8872
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 6 19:25:04 2014 +0000

    ept_lookup_handle_t redefinition plus simpler way to represent arrays

commit de18fe12b7df30a8c473b4529b1a2a6906abfd0e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 6 16:32:19 2014 +0000

    NDRSTRUCT data type created

commit 6876b8c3a76275ba8a3c89805e6769495d334d0e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 6 14:25:57 2014 +0000

    NDRCall -> NDRCALL
    NDRPointer -> NDRPOINTER
    NDRPointerNULL -> NDRPOINTERNULL
    NDRUnion -> NDRUNION
    
    dtypes.py now imports the datatypes directly

commit d2e796761834e4f2231361f1fc2d1759cb295e7f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 28 02:50:59 2013 +0000

    More NDR64

commit 14da66783f222f28fd9d5aec7fd33156f83310fe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 28 02:38:47 2013 +0000

    A much better RPC_SID using NDRUniConformantArray

commit 011d7be60495f4db72e5c8b2bc50bf1346901476
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 23:52:24 2013 +0000

    More NDR64 stuff.. not there yet :s

commit 2c4e5b65f93a800ffd1bc5d24efd509c010a653f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 22:29:12 2013 +0000

    Fixed bug when not initializing array items with the isNDR64 parameter

commit 57a8209546b2b0c76094b241b52ad3789a164a7a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 21:26:55 2013 +0000

    Better worked out the ARRAYs unpacking

commit 6009570a47dc81417f5eec5998889b3e16c4be63
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 18:37:31 2013 +0000

    More NDR64 work

commit 60aaf5cec4f0337378c6a07fc91862b967c3894c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 15:54:49 2013 +0000

    Added password command, so the users can change their passwords easily

commit 537f7850692fc5baccfb00f79ef37f77164d5c98
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 27 15:54:14 2013 +0000

    hashes support for hSamrUnicodeChangePasswordUser2() when changing passwords

commit 6a64046123c7669e8b3e9e703ee17befc18c25d5
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 26 16:41:55 2013 +0000

    Some updates related to NDR64, not ready yet

commit d4de2e49e2172f9667e03e4d453b96e5e933babb
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 26 13:56:47 2013 +0000

    Helper functions finished

commit a84ff937822b134e1849fb4a0afdaca14f376218
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 25 07:15:12 2013 +0000

    some helper functions added, more to go

commit 95e7501dd6af9a94aa5a08b562d7be065340d58e
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 22:40:35 2013 +0000

    More reliability

commit 617162125fa8b2c0e1c41763aa4f5391d14106e1
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 21:48:49 2013 +0000

    Wrong NDR type for some fields

commit 48769da4e195bf9a93f10b01d91f2d5bef411ed9
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 19:31:03 2013 +0000

    Fix problem when setting a NULL pointer for an RPC_UNICODE_STRING

commit 58384e1949eedb2a5d7b4b1f5fdcadb8f778f518
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 19:30:33 2013 +0000

    STRING changed for LPWSTR

commit 3bd8921848fd93036207baac17657ceafbe69933
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 19:29:53 2013 +0000

    Fixups

commit cf1168f665a822aa465366ff1e7e3efbd0640480
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 19:20:20 2013 +0000

    PSTRING not needed

commit ce37270597e3ce6f12260dcfc8206c6c3a3be5b4
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 24 19:19:58 2013 +0000

    Fix 8s for FIXED_ARRAY

commit 58253332de23bbb92179026e4000d20b89dda3f3
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 23 20:11:38 2013 +0000

    [MS-NRPC] Interface implementation + testcases... a few still to be solved

commit edd23dfb4119c55a13ef4cb80ae60fedeea38921
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 23 18:29:15 2013 +0000

    PSTRING replaced just for STRING

commit 0e46b5146373fea0d03562a15966d40aec13b269
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 22 20:50:42 2013 +0000

    The *Change*Password* methods are creating a temp account to play with the passwords

commit a41d2a9650f796d8b316bbea5428c43906f6e4c5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 22:02:25 2013 +0000

    I created primitive data types with signed / unsigned types.. and changed all the interfaces.. It should reflect what the docs say

commit 15ff10843ba8a985d91c8fb6c53e548d9795c8ad
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 20:56:09 2013 +0000

    Added more calls

commit 12d033e275d4a8d8cfe0d3d46001f103d7966565
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 19:51:38 2013 +0000

    1) No more UNIQUE_RPC_UNICODE_STRING
    2) RPC_UNICODE_STRING Length/MaximumLength put in the right order
    3) RPC_UNICODE_STRING generates a random ReferentID

commit 331106482a18b82d74c75361e468b24ec61b8337
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 19:41:15 2013 +0000

    I don't need these files here anymore

commit 6855b6e1ee35e000b68cd1f26a81c80d193aa20c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 19:38:08 2013 +0000

    MS-LSAT Inteface Implementation + test cases

commit 6b2950480a7d643b2c9400f50d4f2baf44c67305
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 18:11:31 2013 +0000

    Moving RPC_UNICODE_STRING_ARRAY to samr.py, small changes on lsad.py

commit dc5038c765af160fc94a966a782b0481fa0012d7
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 02:25:42 2013 +0000

    Added more tests

commit 060984cb55ec1d79105b6ab1b1f06d39450fb263
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 02:25:11 2013 +0000

    Slightly changes to make it more general

commit cc5ff3a8d5d974dafcce3adea8786fa83f617d74
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 00:15:51 2013 +0000

    Fixed testcase when closing my pipe

commit 2f791e4dc4f506ee198ac7b911c60d039c7f1915
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 00:15:24 2013 +0000

    Commented resp.dump()

commit 24a719a1c593cd369c089d4e37ee6d580b79ff8c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 20 00:11:14 2013 +0000

     aimed at testing just the DCERPC engine, not the particular
     endpoints (we should do specific tests for endpoints)
     here we're using EPM just beacuse we need one, and it's the
     easiest one

commit 77f7efee37b209d708b5ccac911316f29e40cdfb
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 19 23:58:05 2013 +0000

    Modified some test cases to be more general and not dependants of the targets configuration

commit 99881090ed9ee2682284a6ee1dea264f6dc7d984
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 19 23:31:29 2013 +0000

    MS-LSAD partial implementation + testcases

commit 08b18a117d7e6c6d460faf887efae4683a35a916
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 19 21:30:58 2013 +0000

    Added PLARGE_INTEGER and LPSTR

commit a36ccf071408c97d64045e6e16f2c71c9d9c4041
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 19 20:48:48 2013 +0000

    Fixed a bug when trying to pack/unpack a pointer to a pointer of an array (yes :s ). This code wasn't working:
    from impacket.dcerpc.v5.ndr import *
    from impacket.dcerpc.v5.dtypes import *
    from impacket.winregistry import hexdump
    
    class PLPBYTE(NDRPointer):
        referent = (
            ('Data', LPBYTE),
        )
    
    class Conformant(NDR):
        structure = (
            ('Item1', NDRLONG),
            ('Item2', NDRLONG),
            ('Item3', NDRLONG),
            ('Array', PLPBYTE),
        )
    
    class Puta(NDRCall):
        structure = (
            ('Nose1', NDRLONG),
            ('LaCuestion', Conformant),
            ('Nose2', NDRLONG),
        )
    
    kk = Puta()
    kk['Nose1'] = 1
    kk['Nose2'] = 0xffffffff
    kk['LaCuestion']['Item1'] = 1
    kk['LaCuestion']['Item2'] = 2
    kk['LaCuestion']['Item3'] = 3
    kk['LaCuestion']['Array'] = list('BETOBETO')
    
    kk.dumpRaw()
    hexdump(str(kk))
    
    nn = Puta(str(kk))
    nn.dumpRaw()

commit ba8c62a7fe5f81c31d94dbce7ae06a4daed0baf4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 19 19:00:29 2013 +0000

    Added support for [C706] 14.3.7.1 and 14.3.7.2

commit 18b98a496def8c265ff6a6a63147652f8178ff1d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 17 22:46:17 2013 +0000

    Finished.. only helper functions left to do in the future

commit f60c95aea8e7bc5bf5a432033d68a1251e9c103b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 17 22:45:11 2013 +0000

    Added LUID

commit 814ca693838cb24f7571e4c9e4ec35b5dd27798c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 16 21:45:16 2013 +0000

    [MS-SRVS] Interface implementation + testcases
    
    Not finished yet

commit b137c471c39bae4711b3ce1b06a73498e21253f0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 16 21:43:15 2013 +0000

    Added 2.2.26 LMSTR

commit f2586cb8cd6308c6ca7fdd0a1b82942ec3c08424
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 16 21:42:49 2013 +0000

    When the pointer is NULL, just print NULL ;)

commit 03791ebf59d0559dcc76dd359c42ce1b013f3ce8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 16 19:21:49 2013 +0000

    Forgot to add the pad to the soFarItems

commit 427bdf028028b7f8bb11eee6a1965bfb529c4634
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 13 20:25:27 2013 +0000

    1) Added ability to specify the transfer_syntax when binding. NDR64 still not fully supported but this is useful for some stuff
    2) Fixed a bug when reporting an exception when binding

commit c87d8f394e1f1f703ccf00662bb9abd1b23d359a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 13 20:06:53 2013 +0000

    [MS-WKST] Interface implementation + testcases

commit 45e0e5576f472852cb6219f9c0c1d1d741d2caf8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 22:07:06 2013 +0000

    1) Target's data is taken from a single file. Easier for changing configuration
    2) Added TCPTransport test for all testcases

commit d5763bb77e7c7d2bed2a5218e82ad0451c248cbd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 22:04:21 2013 +0000

    1) More padding fixes :s
    2) NDRUnion should behave similar to an NDRCall. The pointers there should be top level pointers if the Union is part of the main NDR call structure. This could be done more clean, work to do.

commit 9dcee30aa41c00da7a731adde1c71d1941fc170a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 22:02:45 2013 +0000

    class LPLONG added

commit ffe83685fb5873da93d9550f9424789606cefd16
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 22:02:29 2013 +0000

    Changes to the exception handler based on previous commit

commit e144c2dd86d0206dc16efc00d3f7df3372730aeb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 22:01:54 2013 +0000

    If we cannot unpack the error packet, we just call the exception with the error_code

commit 727d747c8b2a73bcb429d2659f53cae94d5a6e9f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 12 00:45:47 2013 +0000

    fixed typo for ncacn_ip_tcp

commit 97e632e0a8dac20b2fc196bbbdb64e914f2c9c17
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 11 23:50:32 2013 +0000

    Final calls added.. all SAMR calls in place. In the future we should craft some helper functions to make it easier to use the calls. See testcases for example of use

commit 30f896fbf8d2730732b70f1d558e91cb9efe3837
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 11 23:49:12 2013 +0000

    1) __setitem__ set on those classes that calculate the length of a string or array so everything is recalculated when packing
    2) fix on getData where soFar was wrongly calculated

commit 61379744c8c81ab2074b2ba3ae333fd83d416a6f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 11 23:48:15 2013 +0000

    1) __setitem__ set on those classes that calculate the length of a string or array so everything is recalculated when packing
    2) Added ACL()/PACL() and SECURITY_DESCRIPTOR()/PSECURITY_DESCRIPTOR()

commit 456f370f3ed339e7a7e4d7fc2d527ec56486706b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 21:11:46 2013 +0000

    Based on previous commit, on those places where the NDRUnion tag is different from NDRSHORT, we gotta declare it

commit 76166893f141cfc2001ff5a940c80fc85b664bc4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 21:11:08 2013 +0000

    1) Making it cleaner the way we carry the bytes already processed for pad calculation
    2) NDRUnion default tag now is NDRSHORT
    2) NDRUnion default tag now is NDRSHORT

commit a16238259a75d8a92816847a0f1e2ba42c4c3137
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:20:54 2013 +0000

    Updated test case

commit 2d75c98ebb8f8fa89ca64df1a109982c4e3efed1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:20:16 2013 +0000

    Updated test cases

commit f9769af25980c88a44d3a14e78f33c38d6983eaa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:19:24 2013 +0000

    Items reorganization + more calls.. close to finish

commit f77e5c528ae35f5d66fbadcafba6495b074bb16f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:18:08 2013 +0000

    changing getData(), fromString() according to previous changeset

commit 60a38cb5312b5cc724d64a52d454829214520596
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:16:52 2013 +0000

    changed fromString(), getData() according to previous changeset

commit fcd9755f00febdd999b5f38f830058e6a13cac98
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 10 20:15:31 2013 +0000

    getData() and fromString() now received a soFar variable that specified the bytes processed so far so PAD can be calculated over the ENTIRE octet stream

commit b9a89791b6f4fd08bde5046b881ce1660f1b720d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 20:58:09 2013 +0000

    Added
    1) SamrDeleteUser
    2) SamrDeleteAlias
    3) SamrDeleteGroup
    4) SamrGetMembersInGroup
    5) SamrRemoveMemberFromGroup
    6) SamrAddMemberToGroup

commit e2c2f4efba187e4c6486236caa3f365a7344179c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 17:24:10 2013 +0000

    Fixed bug when encryption/integrity was used

commit f5273bda186d6d6286ebb402debea2215149675c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 17:19:03 2013 +0000

    Fixed bug when encryption/integrity was used

commit 23de460767e55df02b321a63a38798c462f94b02
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 17:01:00 2013 +0000

    STR() added

commit 9b9d2be372bdfe99831972b0833bed912d10ad7c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 17:00:34 2013 +0000

    NDRENUM() added

commit d85273cd9df4bcc618bcd9a1f976ccf1b3300c8f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 17:00:18 2013 +0000

    Python 2.7 backport for Python 3.x enum data type

commit 0f5d93acde107526e5bc162af090b9f6b2454a03
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 16:59:21 2013 +0000

    Loooots of new calls added.. still more to go

commit 1e6794fd547eda8b2ba0870a97eea4a819f60b7a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 7 16:58:44 2013 +0000

    updated testcases

commit 7bf3f47525b76dce5ae2d4ba1683280e8ade73ab
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:55:49 2013 +0000

    samr test cases I have so far

commit 31e2229cfadba0502d7978c6606b6fdb1c27bd2f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:53:19 2013 +0000

    Changes in NDRUnion impacted test cases

commit f54dcca791fca9fa926c9dac19d6e89262498acc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:52:15 2013 +0000

    Samr implementation from scratch.. just starting

commit bb982afe1bdabfa6f63fe1edb978481aad6b9a99
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:51:12 2013 +0000

    I finally understood the difference between RPC_UNICODE_STRING and LPWSTR, setting up the right values here

commit 4164d32b4f1fecfa26c520532ff30f3b460834d8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:50:15 2013 +0000

    1) Moved Common data types to dtypes.py
    2) NDRUnion SwitchValue not needed anymore
    3) Added align for NDRSMALL
    4) setitem can now assign NDR classes if they are similar
    5) NDRCall.getData() and NDRCall.fromString() now also call getDataReferent() and fromStringReferent() (not sure about this, testing needed)

commit 9e8f7eae7077060362f1080f61f8ee3a912beee0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 5 22:46:57 2013 +0000

    Added more data definitions from [MS-DTYP]
    1) RPC_SID
    2) ACCESS_MASK
    3) RPC_UNICODE_STRING
    4) WSTR

commit 4b3ecf24b6c7e72b5161519d343b97634a803213
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 4 20:47:18 2013 +0000

    Opps.. first line dissapeared somehow

commit b8edb894bd29d75b02c15bae25cd1c72ad8d7b3a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 4 20:36:13 2013 +0000

    Since rpcrt is now handling some exceptions, the right one to catch here is rpc_s_access_denied

commit 0e9de8a1c24321b1dbd305fd5408c394591c42c2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 4 20:14:44 2013 +0000

    1) hept_lookup() helper function added
    2) removed exception messages that are handled by rpcrt
    3) fixed PrintStringBinding()

commit f8f4a77e4e1cf792d099290732373da3b7462e96
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 4 20:12:45 2013 +0000

    Added DCERPCException()

commit 310d0ca1fe6dacf02e4aecf6d329fa14267a0a30
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 3 22:34:27 2013 +0000

    UUID/PUUID types added

commit 42bb487432bfdd56604021fe9386f00c0b29a945
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 3 22:34:03 2013 +0000

    Endpoint mapper implementation for the new dcerpc v5

commit 7ce09112b76a4a4de3844fe6073bc118b39bc4fe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 3 22:29:46 2013 +0000

    More errors that can be triggered inside the rpc runtime

commit d6706d9fb0a5509fe29e3fa3f00adb8763eaeb5a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 3 22:29:04 2013 +0000

    UUID is MSRPC_UUID_SCMR

commit e01dcf408fbbc58f954a92ca61874b4dfbcce955
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 3 15:24:09 2013 +0000

    ErrorCode is not always the return code status.. so, we're just grabbing the last 4 bytes of the answer

commit 9656bed16d40134a01e4dc82f03072bcccf41b43
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 2 23:18:43 2013 +0000

    1) Fixing calculation of array items when packing (len(itemn.getDataReferent(''))
    2) Setting up default alignment to 4 (let's see if it works... testcases good so far)

commit 17c57ff592d57f1c94ec9e3aa8da539e1a89a97c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 2 21:04:19 2013 +0000

    More padding issues solved (hopefuly) inside arrays encoding/decoding

commit 92978fceb2e05b939e52f216a7b1bc6f28cc2e4b
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 2 00:33:16 2013 +0000

    Cosmetic changes

commit bc0359470bcda6f94415e4a870e1da2c63985b89
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 2 00:02:12 2013 +0000

    SCMR errors taken out.. now they are grabbing everything from impacket.system_errors.py

commit 796e6525779cd0f2e8e4770f8be6bdbf577b654f
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 1 23:44:48 2013 +0000

    SYSTEM Errors from [MS-ERREF].

commit 3159f7bcb115b595709e0588cfbdea7cb69d673b
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 1 22:58:16 2013 +0000

    propset ID

commit fc71e1f88f831668d5eb6e02ada3f75911dd8289
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 1 22:54:44 2013 +0000

    1)Better default parameters for the SCMR helpers
    2)Changed Exception name to DCERPCSessionError

commit de5d1fcdaa392f6820cca5e6c7a6dd281426f59f
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 1 21:01:00 2013 +0000

    Fixed NDRArray.dump() for fields that are not a list

commit 3b4370546261441707080bd6daeac403580bb698
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 29 23:00:19 2013 +0000

    1) All helper methods start with h<method>
    2) No more need of a SCMRDceRpc class
    3) Requests are handled by rpcrt.request()
    4) SessionError exception returns the packet for further inspection

commit 2069e1a07cb5367c0e4334a26fd2c9116399f38a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 29 22:58:40 2013 +0000

    1) Added request() method
    2) Transfer syntax is now stored for later use

commit 07e4c0368c271a474a46f7de646e5b436b3c42e4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 28 17:11:24 2013 +0000

    Based on https://code.google.com/p/impacket/issues/detail?id=34, added password history dump (for NTDS.DIT) based on lanjelot's patch. Thanks mate!

commit d08c9c6a13a95858cd3a2ca3ac09bb0d588ac617
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 21:27:08 2013 +0000

    Changing SVCCTLSessionError for SCMRSessionError

commit cefac1e8f3e766bc86013924293c72a577ca58b0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 20:56:53 2013 +0000

    Changing NDRPointerNULL() for NULL, easier to read

commit ec4bbb24630df2833ee398d3e0b86fca3e48446f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 20:53:36 2013 +0000

    NULL = NDRPointerNULL()

commit 4d0a3b24efabcfa5f892deb56d7de58d7cc1993e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 19:26:14 2013 +0000

    Getting rid of isNDRCall, and adding topLevel parameter just for NDRPointers

commit 4e74593cae241194e254aa5e878a6bca4a6a3a23
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 05:11:23 2013 +0000

    Importing from v5

commit b4e05b5ad1d8f665d54b9a3a833bff498c10c3fd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 05:08:15 2013 +0000

    Importing from rcprt.py

commit a5b54adba5502f2adf87c931dde40c17a1d1e1aa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 05:03:36 2013 +0000

    Adding rpcrt.py (old dcerpc.py) + transport.py.
    
    Modifying the rest of the sources

commit 674d74852eb15c6e61b1ef95ea1b7aca685ee43e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:43:39 2013 +0000

    Adding headers

commit 964982e3f8b599780c13ee2c5ef594485fe63318
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:41:57 2013 +0000

    dcerpc.v5.scmr test cases

commit 44a2edea5da666c641effda4db97320a3548e45f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:38:38 2013 +0000

    Changing imports to point to dcerpc.v5

commit 441edf6d6542944ba2431f63befca363bf69ab3c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:34:06 2013 +0000

    This is the right name for [MS-SCMR]

commit 00513e1732e77ce224126c2e8815d7e32e2eb8bc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:32:59 2013 +0000

    Bye Bye

commit 73dddeb365ca59fed31e9f1fddab695561b16586
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:28:36 2013 +0000

    Adding the files i'm playing with here. Again, no more development in impacket/dcerpc

commit d57847b4f75a8ad0818190a141e7afc0784bcd6e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 27 04:26:09 2013 +0000

    Moving experimental to dcerpc.v5
    
    I'll be working here from now on.. Not touching impacket/dcerpc anymore.
    
    Too many changes going on!

commit 7a03cfa6ec6d67cd98fc53b4f681af9e035abfd7
Author: aurelianocalvo <aurelianocalvo@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 26 17:50:36 2013 +0000

    Changed the appearance of self.child().__str__() to str(self.child()) in order to show child packets that did not implement __str__

commit 60a757e29e5046ed22bdbbfa2bc301154d0deb6a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 22 21:58:48 2013 +0000

    Changed the Pointers stuff based on previous commit on ndr.
    
    Plus, for svcctl added:
    1) RQueryServiceLockStatusW
    2) RStartServiceW

commit ffdc8e1f5d1f36aa8f5e9324d2249b609d443c1f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 22 21:57:47 2013 +0000

    Chaging the NDRPointer referent name to 'Pointer', trying to make it easier for coders to understand dereferencing.. we'll see.

commit 82a9940a50cb4353ecc49673814af87a97a7a714
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 22 21:31:45 2013 +0000

    Fixed padding for Arrays

commit 876ec9c525a9cf5a3ca82a98d19a0efa90bb268b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 22 02:39:24 2013 +0000

    Fixed ChangeServiceConfigW()

commit 02108d261c7c1cd2bd52665074509ce10a02f9cd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 22 01:01:10 2013 +0000

    These are interfaces i'm playing with the new ndr engine so I don't mess up the current ones. This directory will be removed once they are ready.

commit eaceacad99382ea14f88bf0ed89a36f4349a3407
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 21 22:17:36 2013 +0000

    1) RPC_UNICODE_STRING now accepts regular strings, and takes care of encoding/decoding them
    2) More NDRPointer optimization to make it work when receiving/sending NULL pointers
    3) Fixed wrong UNICODE_STRING() base class (it should be NDR, not NDRPointer)

commit ea7137d818bcd55d420b43912c9c68616cb1eb78
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 21 14:06:59 2013 +0000

    Removed debug message

commit f5c860da186aca978ad3cc5e2c07d95966fdf52a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 21 13:40:42 2013 +0000

    Adjusting NDRPointer, when it's null, depending on whether we're under NDR64 or not

commit 8364edb2529e4430e42b083c7bcf83c4683dc9c0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 21 00:13:14 2013 +0000

    edefined UNIQUE_RPC_UNICODE_STRING for consistency.. Yes.. we will need to do a ['Data']['Data'] to assign a value, but it actually makes sense.
    Added check inside NDRPointer if we receive a NULL Pointer, so we don't keep unpacking the rest.
    Added consistency check, which bassically does, for every struct unpacked, checks if the packing matches the original data. Just for debugging purposes (turned on now).
    netlogon changes based on ndr.py changes.
    
    Don't use netlogon.. I'm using it to test ndr.py

commit 9f69c9927716b8a0c7f09df97437c5e1768567c2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 20 02:12:42 2013 +0000

    Okey.. We're getting closer.. although this might not work.
    I'm taking out the embeeded pointers and top level pointers. According to [C-706], top level pointers are the ones that are in a DCE Call (and their referents are NOT represented later), whereas the other pointers are embedded pointers (with deffer the representation).
    
    So.. in order to make it easy to define NDR types, i'm creating a single class NDRPointer, which will act different when it is part of a DCE Call or it's inside a structure/array/etc.
    
    We'll see.. wort case, we come back to the previous revision

commit 72bcfb39195501a50b0ccac56256618aee77b829
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 19 21:40:52 2013 +0000

    getDataReferent must return the actual data even if there's nothing to process
    added PNDRUniConformantVaryingArray()

commit fe655e46f81416a0a35bc898a2befc83bab30a1e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 19 14:48:45 2013 +0000

    Based on feedback from Renaud Dubourguais we're changing some behaviour when retrieving/storing files, allowing to set th
    e share access mode, aiming at making this change dialect independent. This involves:
    
    1) smbconnection: changed getFile() and putFile(), adding a shareAccessMode parameter
    2) smb3.py: changed retrieveFile(), storeFile(), adding a shareAccessMode parameter
    3) smb.py: changed nt_create_andx(), retr_file(), stor_file(), stor_file_nonraw() adding a shareAccesMode, and using nt_create_andx as the way to open the files, so we keep the same shareAccesMode flags across the different dialects.
    
    Functionality shouldn't change if no shareAccessMode flags are specified

commit 4082fd1d312ccff27207ef6dd7ee2193c094d724
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Nov 18 16:12:05 2013 +0000

    Fixed arrays marshaling/unmarshaling where the referent data was not processed

commit b8be1d76ea90e9b191a11d52e0e5112aa2289b70
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 18:52:42 2013 +0000

    PNL_SITE_NAME_ARRAY is a toplevelpointer

commit 9576e329b05e454223127aef201967bf5dceb6d3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 18:52:14 2013 +0000

    Still have to solve the situation of nested arrays with referent data. Leaving it commented for now

commit 76cef7696e8ff4e455c697a8b5cecd4b12cfb571
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 18:24:59 2013 +0000

    Removed debug msg

commit 6cfdb9f99fd8429bfde18a25d76b206216f5c7e5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 17:56:55 2013 +0000

    LPWSTR2 is actually a PRPC_UNICODE_STRING. Still, [MS-DTYP] contradicts other documents describing such structures. Hence, there might be changes in the future until I figure out of things actually are :s

commit b091961a9e78278d688dbb2cb93c6ae92232aff9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 17:45:31 2013 +0000

    Redefinition of RPC_UNICODE_STRING, UNIQUE_RPC_UNICODE_STRING

commit e383907b462c1bb2e3a6fc1ba56786fe8705f159
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 16:39:00 2013 +0000

    Fixed bad definition of NDRPointerNULL

commit 8040cb5997f82b4ff8ce145bc8fec9f09223173e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 15:55:38 2013 +0000

    Added NDRCall(). This should be the base class for every DCERPC structure call. Still testing

commit cb1095ac0c0e76921ecdc8270f4c9ebf3c183c62
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 15:11:42 2013 +0000

    Minimal changes.. still pending managing the representation of referents correctly, according to [C706], 14.3.12.3 Algorithm for Deferral of Referents

commit a44f796a67d8fd5566b1ea858a222b32387a4046
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 16 01:27:52 2013 +0000

    Better handling of arrays and referent's data

commit 3b4b460ec1a509010d163b67922770c18f8afd9d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 15 21:13:07 2013 +0000

    Continuing with r992, testing the new NDR lib. Still lots to do

commit 1c4689255c92242c77f5730313c6b939b4003a35
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 14 21:45:52 2013 +0000

    Since I added this a few days ago, I'm experimenting with NDR inside this interface. Marshalling gets much simpler.

commit ec52aa727309b57648097749658d0c795c199d62
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 14 21:45:00 2013 +0000

    [C706] Transfer NDR Syntax initial implementation.
    Needed for so long. The objective is these classes to be the foundation for all NDR encodings. ndrutils will be gone eventually. Testing needed

commit b7964844564f51f2aceb5903e08cff7546110f8e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 12 16:26:58 2013 +0000

    Don't stop at the first share w/o write permissions. keep trying

commit 02120781d31f8305da8178d4907308040a4d4880
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Nov 10 23:01:51 2013 +0000

    Updated test cases.. dummy passwords for my lab

commit 9c235ca5360212ed9438ff8a3094caad5a33694b
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Nov 10 22:38:49 2013 +0000

    Added NetrLogonGetCapabilities(), NetrLogonGetDomainInfo() (not finished yet)

commit 1e416549b281072ba332a2485be0aa6685742560
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Nov 10 20:47:57 2013 +0000

    More changes here. I'm adapting the code so another SSP (netlogon) is supported by the dcerpc runtime. Still work to be done (not working at the moment), but shouldn't interfere with WINNT SSP at all (crossing fingers)

commit 092d41aa15c26745bf4790df231f03c8012968cf
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Nov 10 20:46:19 2013 +0000

    Added ComputeNetlogonCredentialAES(), ComputeSessionKeyAES(), ComputeNetlogonSignatureAES(), encryptSequenceNumberAES(), decryptSequenceNumberAES(), SIGN(), SEAL(), UNSEAL().
    
    In short, all the cryptographic operations for netlogon SSP should be there. Now we gotta test them more

commit b9ada53288be978faeda630d4fbd6c6ef0f49f9c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 9 22:47:13 2013 +0000

    Moving some crypto stuff into netlogon. They shouldn't be used by anyone else, so it makes sense to be just inside netlogon

commit 5e7d57d87410efe2134d665406dc8131a93a8b36
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 9 21:24:21 2013 +0000

    Only the first 8 bytes are the ones that matter

commit 79793bf9156feb01090cb34636e4a29b01565fdf
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 9 21:18:52 2013 +0000

    Added getSSPType1(), SIGN() and deriveSequenceNumber(). I'm not sure this will be here in the future since this is the netlogon SSP

commit fa985fffcce27a7891385b9812ea155928e27881
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 9 21:17:30 2013 +0000

    Added encryptSequenceNumberRC4() decryptSequenceNumberRC4()

commit ec14f20550f688d922d3f6739c155a36ee9d758d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 8 19:16:04 2013 +0000

    Adding some structures and functions for the NETLOGON security provider. Still not used

commit 50e5f50df0fe7471ed01a7d49c7215fff1ed58ef
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 8 19:13:10 2013 +0000

    Big changes on DCERPC Runtime, aiming at making it more flexible for future stuff to be added.
    
    dcerpc.py:
    1) Security Provides and Auth Levels added
    2) Changed most of the structures in such a way that they work not only for creating packets, but for parsing packets (before it was just one way).
    3) MSRPCArray() and MSRPCNamedArray() moved to samr
    4) SEC_TRAILER() structure added, following the recommendations of [MS-RPCE]
    5) Calling to SEAL/SIGN changed, isDCE not available anymore
    
    ntlm.py:
    1) DCERPC_NTLM* structures are gone. Didn't make any sense in the context of ntlm.py. Now ntlm.py crafts the same structures
    regardless of who's calling them (smb or dcerpc), and it's up to the caller to treat them in their language. This is aimed at making ntlm.py as general as possible as a security provider
    2) the isDCE argument for various functions is removed. Not needed anymore, based on 1). Special attention should be kept for thos using getNTLMSSPType1(),getNTLMSSPType3(),MAC(),SEAL() and SIGN() in their implementations since the amount of parameters changed
    
    srvsvcserver.py:
    1) ntlm.DCERPC_NTLMAuthHeader not available anymore, replaced by SEC_TRAILER()
    
    test_ntlm.py:
    1) Changed SEAL() call since isDCE is not there anymore

commit cacffb703830b9f1f5cacf9d0596fed64aa9b356
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 8 18:57:30 2013 +0000

    Test cases for the DCERPC runtime.

commit adba0fb24ffc5a0967f603ec461d34169f4ca11c
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 8 18:55:58 2013 +0000

    We don't need this anymore

commit e3859e47443be9d41213d94c1cbd91ef4bc2c298
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 8 17:42:11 2013 +0000

    More test cases added. Except for the named pipes methods exposed by smbConnection, we're testing the rest of the methods, for each dialect we support

commit 1141246543e176de67413c53ee0a61d08ce4c782
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 7 22:20:26 2013 +0000

    MSRPCNameArray() and MSRPCArray() are only used here. Soon to be erased from dcerpc.py

commit 989f6b17f550b0404e9005c4b2b531a45a4174bb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 7 21:45:38 2013 +0000

    Added ::: at the end of the credentials grabbed so it's compatible with ophcrack

commit 44ec59cc26aec6d4b4bd5e53efdb667dd5f24bfb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 7 21:21:13 2013 +0000

    No need to send isDCE parameter. It will be deprecated soon

commit 25c451cd577bcd1f8f607600e2a3d0baf51c5acb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 7 21:10:06 2013 +0000

    Don't fail if we don't have a smb.log

commit ff1bfc86fcb3a686d63ff5bd724b3d705af43189
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 7 20:46:16 2013 +0000

    Removed raise when an exception is triggered

commit 147791a176454e280efdd0d816e701e80c6d72ed
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 6 16:40:15 2013 +0000

    Auth levels should actually be here, not inside ntlm.py

commit e79fafc5af03f4bf90134804879ad47927fcda53
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Nov 6 00:37:41 2013 +0000

    Adding set_auth_type() for future use

commit e36492a489756bf1a84981b5b463924e4d581d19
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 23:47:41 2013 +0000

    Changed NETLOGONServerGetTrustInfoResponse(), in particular PNL_GENERIC_RPC_DATA. I'm still not sure it's right since I can't get enough tests yet.

commit 5c2bf2b500495e0a1d6e26c4189bb40b9f10be7a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 23:38:21 2013 +0000

    using commonHdr instead of structure, easier to include in other structures

commit e4772b97bd07e2d37830073a2c31cb3c6459f9e1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 23:32:12 2013 +0000

    MACHINE.ACC secrets printed out much better.. including the machine name and domain whenever it's possible

commit d14765341a7edfaeeee3b0bd99af94b6c81fd633
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 21:49:35 2013 +0000

    Added NetrServerPasswordGet()

commit 78b1b7cc0cb54bf4b536c1be875c7df3dfabd63b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 21:03:34 2013 +0000

    Added NetrServerGetTrustInfo()

commit c1b4688f02368d9e22d9090687a086b1e6a3e7a8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Nov 5 20:54:58 2013 +0000

    Added [MS-SAMR] Section 2.2.11.1.1

commit cd3b3db7679700e3e2999d45dd3504ac3f0eea77
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Nov 4 21:00:50 2013 +0000

    updated KNOWN_PROTOCOLS

commit f25c099fae201e78f876fa068d4b713192c1f4fa
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 2 20:59:37 2013 +0000

    Added NetrShareGetInfo().
    Removed unnecessary structures.. moved soon to be removed functions to the end of the file

commit 7ea54718cd2165b8431a0d4f769dcb01835fedff
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 2 19:55:57 2013 +0000

    All structs from srvsvc.py that were removed copied here. They are still being used. I'll port this whole file later

commit 7b6a63f81cd8bc7c500b940a72b3bcda64d6f597
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 2 19:20:02 2013 +0000

    get_share_enum_1() stuff removed. Just left it calling NetrShareEnum for compatibility reasons. Might be out soon. Use NetrShareEnum() instead.

commit df5b504beadc5d9f957eb9e27108f4552b66bebd
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Nov 2 19:04:20 2013 +0000

    Changed my mind.. strings returned are UNICODE (NULL terminated). It's up for the client to decode them. Mainly to maintain same behaviour of other functions

commit d44e3e0b6f371af5ea4db3af42ef1caaac4ee1e1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 23:23:22 2013 +0000

    smbconnection.listShared() now uses NetrEnumShares(). Changed smbclient.py to reflect that change (difference is unicode decode is not needed)

commit 4eed74ea83cda3fc1a512005a1c4a20f025b7a6d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 23:18:57 2013 +0000

    Added NetrShareEnum(). get_share_enum_1() going away soon. Don't use it anymore

commit d90de89bd072975cfe93a9b7fb2052285db8f5a8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 21:29:19 2013 +0000

    Added who commands, which calls NetrSessionEnum()

commit b8deea30fb4d783d2c2834e663e7a852d980b9d9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 21:25:17 2013 +0000

    Added:
    1) SRVSVCSessionError()
    2) NetrSessionEnum()
    plus minor cosmetic things

commit 73ad64af2fee827d268c94ac97d0c0d858afec6b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 21:08:43 2013 +0000

    Forgot to increment self['Data'] for deferred fields

commit 45c53c718ff3f035f361a5d905152f6609615877
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 20:43:05 2013 +0000

    First try for a generic NDRArray.. I'm sure it'll change in the future

commit a52b612c65af81d8641a049bf701e17ec0513fbe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 20:27:45 2013 +0000

    Opps.. forgot the enclosing bracket :-o

commit 62ba258015d265b394e8b4847a231c1d2f168d4e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 20:27:01 2013 +0000

    Fixed indentation bug for extra items created on the fly

commit 1976d4eda35d23167c5c1fe8d3f486009d72d380
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 1 15:38:33 2013 +0000

    MACHINE.ACC converted to nthash :)

commit 1936ea0e495e59ee14c00a82528fe7038bbaf73e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 31 21:37:41 2013 +0000

    Added:
    1) DsrGetDcSiteCoverageW
    2) DsrGetSiteName
    3) DsrNetrGetAnyDCName
    4) NetrGetDCName

commit c6e47f4573e2dfb9a11cefac89fdd276396f5707
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 31 20:11:36 2013 +0000

    [MS-NRPC] Netlogon interface implementation. Just starting...

commit 437935cf9a3a59a333c9344b3294bbbaeb246fe4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 31 20:09:40 2013 +0000

    [MS-NRPC] Section 3.1.4.3.2, which adds:
    1) ComputeNetlogonCredential()
    2) ComputeSessionKeyStrongKey()

commit 51208f4ed3b6927c34d40ed76823877e0d2a51d7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 29 16:04:19 2013 +0000

    Added get_dce_rpc() method to the DCERPCTransport. Now clients don't need to cast a transport to a DCERPC_v5 or V4. That is handled by this method.
    I'm changing the examples to reflect this move.

commit 080a149e3f9c4b24401eda27a3c7e58888c26048
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 29 14:33:35 2013 +0000

    Added documentation

commit 37a1759b9bca718e7876040c43fbcdc4be350037
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 28 22:31:50 2013 +0000

    Extra logging info just to let know we're trying to grab the ntds.dit (if found)

commit 32f742404ac405ac09447e62daf40942575c6c2f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 28 16:06:41 2013 +0000

    Added a first try for autocomplete inside the minishell

commit 9d423f2a39b44f321149e0f1ede628613d537cff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 26 18:03:01 2013 +0000

    Removed raise used for debugging, and a bogus bootKey

commit 9270216e926c36632e97918e0850fcbbadaf6c6d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 26 16:58:45 2013 +0000

    Performs various techniques to dump hashes from the remote machine without executing any agent there.
    For SAM and LSA Secrets (including cached creds) we try to read as much as we can from the registry
    and then we save the hives in the target system (%SYSTEMROOT%\\Temp dir) and read the rest of the data from there.
    For NTDS.dit, we have to extract NTDS.dit via vssadmin executed with the smbexec approach. It's copied on the temp dir and parsed remotely.
    The scripts initiates the services required for its working if they are not available (e.g. Remote Registry, even if it is disabled). After the work is done, things are restored to the original state.

commit f91ad83aeb355434227f97eeac2c226e9400cb6c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 25 22:24:58 2013 +0000

    1) NDRConformantVaryingArray added to ndrutils
    2) LsarQuerySecret, LsarRetrievePrivateData, LsarOpenSecret added to lsarpc
    3) Fixed tab spacing and documentation

commit aa191e23e803db4f4c0e9ebafdd7883172b8034b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 25 19:25:57 2013 +0000

    Added
    1) LsarOpenAccount
    2) LsarCreateAccount
    3) LsarDeleteObject
    4) LsarSetSystemAccessAccount

commit 63818a88f173466afea659c88f2ab292ab2a3f12
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 25 18:12:18 2013 +0000

    Removed debug msg

commit c1be1c7fdfc09f3a761cdce5c75dc7b64c96878d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 25 17:32:06 2013 +0000

    LsarLookupNames2's answer now correctly parser, I had to redefine RPC_UNICODE_STRING as well

commit b56b881e716e2c934087ee9750a4976141f6493b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 25 17:29:05 2013 +0000

    Indentation spaces weren't followed when dumping internal structures of a structure

commit c0f175cce939d8dfd1cd6a0ba014885aa6f8aac9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 24 22:01:24 2013 +0000

    Adjusting parameters based on previous LsarOpenPolicy2 change

commit fd3526a40c952c500dd9d14b3ef9ebccfdd0aa77
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 24 21:59:44 2013 +0000

    Implemented LsarLookupNames2().. still need to parse the answer.
    LsaOpenPolicy2 parameter's names changed, so it better reflect what [MS-LSAT] specifies

commit 0e0c326474c906b15c45241f08819fddca68dca9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 24 21:55:09 2013 +0000

    RPC_UNICODE_STRING implementation with structure.. Needs lots of testing

commit b4f486c5d23e30c14faee1d015735e8c48ed18f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 24 15:52:44 2013 +0000

    Better error handling.

commit b6248aa9fb9d0bda70cd7b28699f40df1a11eb85
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 21:30:20 2013 +0000

    command parameter is not used anymore

commit 976263d0d44b02d54e55abd21364c7d43fc43a39
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 20:52:44 2013 +0000

    For local users, we gotta prepend '.\\'

commit cee60979b35bfa3aaf68a8f7b9146533e95ba042
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 19:57:14 2013 +0000

    Added information when CREATE and CHANGE are executed

commit 85b47bbb6a64b7db9e67afdca1b8e99a99b9212b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 19:36:58 2013 +0000

    Now you can specify username and password when changing service's configuration

commit f1fe308178d15737c85caea682f8fe120e1623b6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 19:25:03 2013 +0000

    1) get_session_key now returns the right session key.
    2) Now all the packets going out request NT ERROR Codes

commit 72a97411b6227312bc8a260c52e6e751ab7eef14
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 19:22:38 2013 +0000

    Compatibility for old SMB servers (NT 4)

commit ce199039001cb1b48425860e8774370fbc580bff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 18:52:52 2013 +0000

    Added getSessionKey() method.. It will still not work for SMBv1 protocol

commit 18c036d70811cc21e4ca684f9dc268ee4d6b07ba
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 18:51:32 2013 +0000

    Added ability to change username and password for the service. However, special attention should be kept by the caller. Read the method's documentation

commit 9b0c2dc60dc4f36ba1f0915442305afe818c8456
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 18:43:33 2013 +0000

    Added [MS-LSAD] Section 5.1.2 / 5.1.3 functions

commit 210cfae6ff0703451a05517e47c62a17c32c49fe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 22 15:17:19 2013 +0000

    Extended support for ChangeServiceConfigW().. I still gotta find out how to set a password for a service account. That is pending.
    On services.py, I added the change option

commit a722444cd69fa4a38585f504babddc3c0ce02d05
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 21 14:59:17 2013 +0000

    Fix for issue 33. The fix works with implementations that send the information elements out of order.

commit 9f317adbe1b4c8d0abc56589d95a0a1d0942f871
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 21 14:24:40 2013 +0000

    Removed debug message

commit 3f8f52023dcbba06a4bb143fd52010ebe3faedfc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 21 14:12:45 2013 +0000

    Better handling for KeyboardInterrupt. Service name and output files still static until we're sure we're cleaning everything up.

commit ef7c685d260e9fd9afb9ebb6abd4ce83f301c2c1
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 20 21:21:59 2013 +0000

    On the first run, it takes a while the remote target to start executing the job so I'm setting this sleep.. I don't like sleeps.. but this is just an example Best way would be to check the task status before attempting to read the file

commit 179ea7b157ca5d5256c627ef32b52ea1d93f62ca
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 20 20:24:25 2013 +0000

    Protocol specification not needed anymore.. it'll try the list it already has

commit 081badd2443d782cfa06bb1bdd5572914ba08a83
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 20 02:14:24 2013 +0000

    Updated documentation

commit 00a9cb4f5583bc10081266c33112709a0a8c1cc6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 22:52:08 2013 +0000

    Better error checking, adjusted to logging functionality

commit 623b9b7c8d77a00c3837d08df8784c5742d5183a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 22:20:12 2013 +0000

    Implemented SessionError so clients can use this Exception regardless of the underlying SMB version used.

commit dc0ab1c89806878b6493449c521a2346ffaea419
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 22:19:37 2013 +0000

    Removed NT errors from that code and using nt_errors.py instead. SessionError is changed to align it to smb3, smbconnection. Now we only rely on NT Errors. Pending task is to remove all the errors from the library.

commit 94e4196d3caa9b7254e6fad7bbb576c7d3c782f6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 20:07:42 2013 +0000

    Change in SMBFindFileFullDirectoryInfo UnicodeStructure, no need to have 'u'.. changing to ':'

commit 93e7c20c459f6a960f6cadc1466537cb9db0366a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 20:06:11 2013 +0000

    when doing ls, it now prints a ls -la like format

commit 26c469e6eaed89f2de204e7f5da92b14d43c669b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 19 17:56:27 2013 +0000

    Inside listPath, now we ask for FILE_FULL_DIRECTORY_INFORMATION so we can fill all the SharedFile structure, compatible with SMBv1 behaviour

commit 9f786f56ae77da0f7b07b558d2efcf06a4502830
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 18 18:18:22 2013 +0000

    Some improvements in the login parameters. Now DOMAIN/Username is the way to pass data. If no passwd is specified, it is prompted

commit a4d54fc34412ad81749dabe1d86401e61a4e9361
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 18 16:37:48 2013 +0000

    No need to do JobEnum

commit c2cf296566e46fff9a86a39344bd0ee899e2dd37
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:35:14 2013 +0000

    Not used anymore

commit c199697ac7e99846b96665b219db2357b36608d6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:33:41 2013 +0000

    Not used anymore

commit caf4d50a96c935a371765c74b4cf8b235286d740
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:33:07 2013 +0000

    Not used anymore

commit 676039848f72e3b68f925f543a5715681fda521d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:32:12 2013 +0000

    Not used anymore

commit 5eeeb4cf235b8cdb6886b40619b2880a1aff60cb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:21:17 2013 +0000

    Changed command line.. -windows-auth is enough to specify windows auth will be used (no need to put True)

commit 0cba1fd3cea3baaab2fb6bb2190a9e00c4436002
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:17:03 2013 +0000

    Not used anymore

commit e740dd58689f387e0928ee8a4475905ceee6a078
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 20:08:15 2013 +0000

    [MS-RDPBCGR] and [MS-CREDSSP] partial implementation just to reach CredSSP auth. This example test whether an account is valid on the target host.

commit 6cb08415db19af2229d4cce8c7e2e3e6f88b7a4f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 19:55:31 2013 +0000

    Removed the protocols options from the command line. It will try both 445 and 139

commit 09d7258b60835d003295361e1c0975a54e26fad3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 19:47:55 2013 +0000

    replaced for atexec.py

commit 82a8581bb80e99da3e3997e8e57643f62812447f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 19:44:40 2013 +0000

    This example executes a command on the target machine through the Task Scheduler service. Returns the output of such command

commit 1d2b85c92a9cbe96320873e229e232b44733b31f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 17 14:52:08 2013 +0000

    Increasing timeout for SMB connections to 60 seconds

commit d32080ea629f0b1fd1b803cbf59d4b517d7fc8f8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 21:58:09 2013 +0000

    Indentation when printing values

commit 2f153458b9433e37354e97a1881f4ef010daae86
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 21:45:46 2013 +0000

    Better handling for NULL strings

commit c8ec0b91f64920398283fd16108ae93beb535abf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 18:59:29 2013 +0000

    change in logging mode

commit 1e931f59bc5e7e27cc0e4af0c7e16648056979fb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 18:58:06 2013 +0000

    logging mode changed

commit ac4582c270dfa18976030546f599bda08315e891
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 18:56:55 2013 +0000

    Logging goes to stdout

commit ca02edf74bb14f44404cf5a2303741b2b9f36f32
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 17:39:24 2013 +0000

    findKey does not log error anymore if a key is not found.. just returns None

commit ce254ac72b26533676e8a4a6169e6ee8cb230709
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 15 14:11:20 2013 +0000

    Fix a bug in walk when specifing a key that has no more childrens to walk

commit fedbf75ecdb311da7ad3d6b9b2c3d64a362dcb37
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 14 06:06:58 2013 +0000

    Fix in printValue for values REG_NONE

commit e7623de969153d7f5745d0443479cd999537a89f
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 14 05:37:51 2013 +0000

    Moving the file parameter to positional arguments

commit c811f3412ed80873421bff73a06abf4ac21dc4f3
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 13 20:04:29 2013 +0000

    When creating a new service, by default it won't be interactive. New serviceType parameter added

commit 57e5c2e620a15a697a77045864f1e1a859120484
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 13 18:08:19 2013 +0000

    Next version will be 0.9.11, not there yet

commit b3a057abef6331e83bd6ba170fcdbc65fc0bea7f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 20:09:14 2013 +0000

    if conversion fails, hashed should be assigned inside the except clause

commit fe5cf512e0473440805b4bfdddb93e9e2a297202
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 19:50:39 2013 +0000

    typo

commit c380fd947592b9e22c1ebf928ce7f6bfaa90d40d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 19:37:56 2013 +0000

    if conversion fails, hashed should be assigned inside the except clause

commit c12776ab36cc6aa3c38dc95ec1a1d914588f83db
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 19:01:43 2013 +0000

    Allows DCERPC transport to get the credentials of an already passed smbConnection

commit f30407f8dea1051d01acb98b06ad7651a85d1864
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 17:51:26 2013 +0000

    Updated example

commit 6396f7508602d78cf819643963ee95b88bbdba1d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 17:40:54 2013 +0000

    Added SchRpcRun() and NetrJobDel()

commit 93325adb8af2925bf8b026d89e698f39b721f52b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 15:49:32 2013 +0000

    Now the ESENT_DB class accepts a remote file object, which is similar to a
    regular filename, but could be remote. It's up to the caller to send an object that
    will behave as a regular file.

commit 32980416f212ad9e65c45e0926ef972992ca6260
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 13:42:50 2013 +0000

    No need for that try: pass at the __del__ method

commit 6eab200c0822badddf5ecca69d92a33e83ccdbc6
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 10 00:00:28 2013 +0000

    Now the Registry class accepts a remote file object, which is similar to a regular filename, but could be remote

commit 6e2059a5ad626d7b1e5c7c7ec40d6ce8cf60ba2b
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 9 22:22:22 2013 +0000

    Moving an annoying message to be displayed just in debug mode

commit 1efd12623632f676fe5242fe0b02f911256348ef
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 8 23:07:29 2013 +0000

    Removed unused lines

commit 0f8a2e3cd074a6b8d01848a3166ae329458a964b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 8 20:17:58 2013 +0000

    Example to use the Extensive Storage Library (ese.py).
    Allows dumping catalog, pages and tables.

commit e934123a90df1bd65c7c3f031aeec51c5e7ad345
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 8 20:14:38 2013 +0000

    Microsoft Extensive Storage Engine parser, just focused on trying to parse NTDS.dit files (not meant as a full parser, although it might work)
    Based on the excellent paper by Joachim Metz
    http://forensic-proof.com/wp-content/uploads/2011/07/Extensible-Storage-Engine-ESE-Database-File-EDB-format.pdf

commit b1d45d5937c9744eba037a12b85d51c52d5d5218
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 5 23:14:18 2013 +0000

    Changed dump() method. Now it tried to print the structure based on the original definition, instead of printing the items in whatever order

commit 4fc6803cd0d89bc1ed5ec2e36d02adb3e6b9f9fc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 1 20:45:30 2013 +0000

    changes to documentation

commit ffbb0d20624efad3056b110c1b4b05a89bd305c0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 24 17:02:12 2013 +0000

    Added walk option

commit 4f1a66f4829acad851feb8ddf2ca78141c73dd14
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 24 17:01:08 2013 +0000

    Added ability to walk recursively from a key path

commit d74f54cd4d884f1756a4ed62acebb49863a44449
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 23:25:25 2013 +0000

    Fixed bug that was getting 2 bytes short out of a value

commit 83edd0f1f5a3127ff1822b7eba1689e711658147
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 23:13:54 2013 +0000

    Adding support for the default value in a key

commit f7d705ad1de0ef2f6586ace1f3ff02f2aabbcabd
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 22:34:53 2013 +0000

    Finally.. If no password is specified, it is asked to the user.. so you don't populate your history with passwords ;)

commit 18b581f6be1e5d7ac8b228e28ee2fcc45500dd8d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 22:05:37 2013 +0000

    Added ChangeServiceConfigW(). Right now it just allows to change the serviceType. That's all we need for now

commit e78d0dcb2f478b2ca3a34026dad95c0165a1ce7d
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 21:55:16 2013 +0000

    typo

commit 95994c660dc6b8d6c12e2d393ca767c31b647757
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 21:54:20 2013 +0000

    stripped debug output

commit 7092c2431a9cb53194eaf23dace3ee621f9d5df9
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 23 21:53:42 2013 +0000

    forgot to set the variable that states an smb connection was provided, so the connection is not close when finishing the RPC usage

commit adaf46a2ae5445ad91ba1fd4ac2688c2aa39e935
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Sep 22 22:38:58 2013 +0000

    add the possibility to specify an connection already in place for a SMBTransport

commit f6d39cbb2fd8b683c610b19f9e5055cd16741d1a
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Sep 21 17:47:15 2013 +0000

    Added regGetClassInfo()

commit f2514421e7769dc0f0f41d76073dcc8c7a7bacb9
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 20 19:25:11 2013 +0000

    Added regSaveKey()

commit 92bd98ee6d2acc2e10ff6cf6ee043430ea8a4509
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 20 15:19:24 2013 +0000

    Example for windows registry reader.. you will need a registry file (you can grab it with ntfs-read)

commit 4e09877e7fce12a235cfefa29be227a1cf7e7da8
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 20 15:18:26 2013 +0000

    A Windows Registry Parser Library

commit 2100194333f13bb4d976387d6408d572799a28ec
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 16 17:43:01 2013 +0000

    Added PYTHONPATH var to runalltestcases.sh

commit 6d1784bf620cb167a4e0e0e68a026204f046eadb
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Sep 14 01:35:24 2013 +0000

    1) Depending on CD or GET or HEXDUMP, autocompletion will return either just files or directories
    2) Right after starting minishell, the root directory is cached for autocompletion

commit fd757133ce8703858e5330a0dec35888fd17eb50
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Sep 14 01:13:07 2013 +0000

    1) INODE.walk() doesn't print the results anymore.. it just returns a list of entries. Up to the caller
    2) FileAttributes better printed
    3) Simplification of the CD method
    4) Now, after a CD, it caches the entries of the new directory for TAB completion
    5) get/cat/hexview all call the same method

commit 23ac6774a7ce97aeedae92e0227f6f7f249119bd
Author: bethus <bethus@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 13 20:25:12 2013 +0000

    An ugly implementation of ntfs so you could read an ntfs volume.. just for fun.. interesting for grabbing files that are locked by the OS ( guess what files ;) )

commit 248b642929910dd48dd06bc6857e7bdf481d826c
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 5 15:37:45 2013 +0000

     * Moving EAPOL, EAP and WPS decoders to ImpactDecoder to break cyclic dependency.
     * Adding copyright header to new files.

commit a3385a444e0006605ab9f105c3729c8f6a49bf71
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 5 15:36:22 2013 +0000

    Infers the PYTHONPATH to run the tests

commit 244a6d4b9528940d2d3eb7795e0fc225603cd811
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 5 14:16:40 2013 +0000

    Copyright notices for new things

commit e521d145bd7e2e3d53bffe8f6554a7c5109d9d55
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 3 19:48:13 2013 +0000

    Plug-in decoders for eap and wps.

commit 53203f53438fe6445b59877856ef6aa9481d6337
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 3 19:21:43 2013 +0000

    ProtocolPackets for eap and wps. Including some basic tests.

commit cccbc59423696f7ef2b5b1d24b2c9c626dd21aef
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 3 19:20:50 2013 +0000

    Fixing PYTHON PATH in .pydevproject

commit bb539d0f3970bae3978fbc6cff4dbbaafc0a575a
Author: aurelianocalvo@gmail.com <aurelianocalvo@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 3 18:17:39 2013 +0000

    Adding pydev project information

commit 6d0f9bd293f755dc67da3768d1012ab9b30a13f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 15 21:31:37 2013 +0000

    TDS/SSL support should work now. Automatically detected by the library.

commit eb8b7fd30ea5d41652305edb09d4fdea6384e738
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 15 15:08:39 2013 +0000

    Initial SSL support for TDS. This is needed if the target SQL Server is configured with Force Encryption == Yes

commit 60151cf14ec7ad7add8a33b10bfdc199e2ad7c8d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 5 22:25:53 2013 +0000

    Adding third argument to ConfigParset.set() method.. Looks like it's needed on some Python versions.

commit 65abbc7f44f90d53a7b52b1d4bd721faf3a0a35b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 28 21:17:46 2013 +0000

    Sync with CORE internal repository

commit be0851486c6793909fd50ce8216a85167de55b36
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 28 16:37:56 2013 +0000

    Sync with CORE internal repository

commit f1d8f3e8365eedf46680166eb29e21d154cbeee7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 28 16:13:29 2013 +0000

    Sync with CORE internal repository

commit f0a06a147bac3e8bae19db4b1e24e71be893427f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 19 16:15:32 2013 +0000

    Just in case an *SMBSERVER is sent, let's get rid of it and put the remote_host address

commit 62cce192d3e86c73319f613ed11f33f250aff62c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 18 18:48:16 2013 +0000

    Fix for http://code.google.com/p/impacket/issues/detail?id=29

commit 1861c4f23e6f20f13fe723ab051fdb819aa08715
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 14 14:47:15 2013 +0000

    Fixes wrong decription in parameters

commit 994a5b70ef13aa9de142c63b7d2d313d960c4aa1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri May 31 15:53:50 2013 +0000

    fixing typos and escape characters for \x00.. as reported at http://code.google.com/p/impacket/issues/detail?id=27

commit 9d2c14e0d7943988b0b3698eef13c337473477e0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 29 00:38:30 2013 +0000

    dded option -c that would upload a file and execute it. Testing needed

commit 8fa4eec76b15e29d5a442026e5e4067c1c43dd09
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri May 17 19:30:16 2013 +0000

    Fix a bug in polling_read that would make the function to wait indefinitely given some circumstances.
    Fix proposed by akfullfo, check: http://code.google.com/p/impacket/issues/detail?id=26

commit c75eaebdb31e5a69f5a7c4506a00de559c587d0b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 14 23:03:31 2013 +0000

    Not using *SMBSERVER anymore, instead, using the host IP address

commit 6beb278713a767e655cb3f3f8e237d4fb679ef11
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 14 23:00:48 2013 +0000

    Fixed bug that would send *SMBSERVER when connecting against a Windows machine with SMB1 only, and also specifying remoteName = '*SMBSERVER' when calling SMBConnection. This usually shouldn't happen but I'm sure there are still old code out there specifying *SMBSERVER as the remote name. In fact, smbclient.py does that (my faul )

commit c6c1ccd2916c2019840e06a8db3c0ca281246819
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 13 18:16:52 2013 +0000

    VLAN tagging (IEEE 802.1Q and 802.1ad) support for ImpactPacket.
    This basically merges the patches and unit test sent by dan.pisi.
    
    Check http://code.google.com/p/impacket/issues/detail?id=24 for more details.

commit 70757ee97c21708b451a3179bec846fd2e81c980
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 6 16:58:09 2013 +0000

    Going back again to a development version

commit 1305350d688868a0872339ad82c0c1870636ee9b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 6 16:05:14 2013 +0000

    Updates version number before releasing

commit 01c3a1fd37c0ce18510ebdc5dc877062d670f83c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 5 20:56:20 2013 +0000

    Moving the debug message to the handler constructor so we don't log it for every request.

commit d0c8b4c377cfbc520781708a5b156dc394d211ee
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 5 15:39:19 2013 +0000

    Fixes on NTLMAuthNegotiate to better handle situations where VERSION field is sent by the client, plus correctly setting the right flags if hostname and domain are provided.

commit b4827384cd8293ed52714eca0674568cf2a4f224
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat May 4 21:44:22 2013 +0000

    Removed debug message

commit d7b174c447e0d109eee71a4fed8217c9ae3895b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat May 4 21:42:48 2013 +0000

    Now we also bind to HTTP and relay those credentials to whatever target specified

commit cf7841b35bb430a7d921a6a12fb6cb206de2f33c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 1 00:14:12 2013 +0000

    We were logging the wrong target IP when saying whether or not authentication worked.

commit 6f5a4d096e1cc4ffe3ef6491fd8490e399597b3c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 1 00:04:16 2013 +0000

    We don't need this anymore

commit fb40ee51eaf31c86fa5255aebd9c10eda39d9509
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 1 00:02:40 2013 +0000

    And moving it here

commit 7b64e4b469444169b80200770208c0509eca3f9c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 30 23:57:09 2013 +0000

    We don't need to have this script on a separate directory anymore

commit c292f77e8bda178309eef0223c0210e2f982e8ef
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 30 23:56:37 2013 +0000

    Getting rid of the need of a smb.conf file. We're setting the required configuration parameters programmatically

commit ed906102e8a9cbcbccd2667a99d59b6782f5abeb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 30 19:17:17 2013 +0000

    Some extra fields completed

commit 8a56382f413b7b21e707ae661d75adb79a9da24e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 30 15:47:36 2013 +0000

    correct the name of the package

commit d9c62492d54c72a706d0c746d799041e5cdf7342
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 30 14:59:50 2013 +0000

    Clarified requirements

commit 9c6af7834f54fa6ffcffe61be173979aa6cca6ac
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 29 16:27:45 2013 +0000

    Another alternative to psexec. Less capabilities but might work on tight AV environments.

commit 92e6b8b734321f960986420aa3d957a4856a929e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 25 22:07:46 2013 +0000

    Fixup imports, requiring it comes from impacket

commit 4da7746638dfe67b22c13860d3a78690d8255028
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 24 02:19:13 2013 +0000

    class.__str__ calls class.getData(), hence, changing stuff must happen there.

commit 82a14b22366c6881c7bbf35a1f69761b3b58895c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 16 17:52:48 2013 +0000

    Added impacket.examples so the installation script install all the required files

commit 8b6e35460f8890c514e5564a79035acf630f9db0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 9 18:40:15 2013 +0000

    Changed smbconnection so it automatically detects what SMB version is supported on the other side, instead of doing the old try: except: workaround that would take longer against servers supporting only SMBv1.
    See [MS-SMB2] section 1.7.
    
    In order to do this we had to craft the SMB_NEGOTIATION packet at the SMBConnection level, and then pass the NetBIOSSession to the smb3/smb layer.

commit 743b55c75dc7b20a02e00a854fe6031e3d82abd2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 9 14:11:32 2013 +0000

    Fix a typo in set_icmp_gwaddr() as reported by dirdi.

commit aa89d7717e5eebe87aadeab321393a9c90d0a587
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 8 21:09:46 2013 +0000

    Replace the reserved field expecting just zero values, to expect anything.. in any case we're not using them.. and some random smb servers might return non zero values

commit 6a84516583ccf5dbc78e5b33ff3bec67bf301ee6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Dec 30 16:31:08 2012 +0000

    Fixed os.mkdir() not being inside a try/catch .. Triggering an un handled exception when trying to create a directory inside a readonly filesystem (for example)

commit 1ec29aa5df9d7081fa823329fe7c7780c7b7147d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 20 19:05:51 2012 +0000

    domain was missing when setting credentials for a DCERPC call

commit fac965731a328741ae34053bcec9c9c1561bf99f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Dec 15 23:37:44 2012 +0000

    Fixes bug reported by Renaud Dubourguais that would make the domain/lmhash/nthash to be discarded when calling this method

commit 369dd3b69733ea6c6703c535162c5e8a27ffe5c5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 4 15:58:37 2012 +0000

    Missing space in EncryptionKey generation, it should be 'ServerIn \x00'.
    
    Reported by Amir Sela

commit 3fb6b86693d472761ff5ef667b5a970d0bcdc712
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 22 14:42:26 2012 +0000

    Don't try to read a 0 bytes file if we alreay know so..

commit 87c96be3e4a6e440c612c551d070d1d8b7aae3d8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 22 14:41:12 2012 +0000

    Log the exception instead of printing it out

commit 8b881cef15ff61e4171700d48cecc936de470cdc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Nov 19 16:54:24 2012 +0000

    When answering a CREATE_DIRECTORY request, check it starts with '/' before stripping it.

commit 2adb9e477f6c065618e264db73403206ba4b4ef2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 22 16:55:10 2012 +0000

    Fixes http://code.google.com/p/impacket/issues/detail?id=20

commit 1907cc7a8072c7326d6a8584aa09a01bb69b97c8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Oct 7 15:32:34 2012 +0000

    SMBBackwardCompatibilityTransport needs the pipe to connect to

commit b01a6ece417fbb81f1e8d55a041263b933631361
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 6 22:18:17 2012 +0000

    No more share list through LANMAN.. now using RPC by default

commit 15de0e039b118b33d52daf804667f341fd5bc283
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 6 22:10:44 2012 +0000

    Unicode support for smbserver.
    It will advertise itself supporting Unicode, but should also work if the client does not.
    Still pending testing

commit 4037a5bd2f830545dba2ad6383b5dd0b2cd3a97c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Oct 6 19:00:11 2012 +0000

    In REFLECTION mode, downgrade to standard security. This seems to be more effective on certain OS versions

commit b9507e47b5c3b68b637ad526c714098eb0ab86e8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 4 20:33:24 2012 +0000

    Deny anonymous logon on standard security auth too

commit a298b54ce99605ae3e69eb62a94343b485a70997
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 4 20:28:50 2012 +0000

    _dialects_data['Payload'] = '' moved up 'cause it's needed in case there's an encrption key

commit 67f7f4fec04f6f6e5a774dad7b78618e39b29d1d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 4 16:15:23 2012 +0000

    1) Fixup imports
    2) Send LOGON_FAILURE if the client attempts to connect as anonymous

commit 0eca55ea429e918c46447c24c30555bdec54dc26
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 3 19:05:34 2012 +0000

    Imports fixup

commit 4dced7beb8359b9088f9cce3c5667c2b056bcc7b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 19 20:47:41 2012 +0000

    Fixes http://code.google.com/p/impacket/issues/detail?id=19.
    
    I think I found a clever way to detect whether the data sent is standard security or extended security w/o checking the SMB Flags

commit 7e1d1d2288ed352ea93cebe32cb7896b5911d068
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 13 22:06:16 2012 +0000

    Missing setting the ChallengeLength when accepting standard security/no encryption key authentication.
    
    Fixes: http://code.google.com/p/impacket/issues/detail?id=17

commit 3450e59a2d4297dd5851ca7af95c5e4f67b6a72c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 13 14:39:12 2012 +0000

    Checking data received trying to detect the connection is closed and not throwing an exception

commit 81e603ef6da9fad9c669a2689773b40c667a24cd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 10 21:31:21 2012 +0000

    Changing the scope of the classes' attributes to make it easier subclassing

commit e610e70aa25047294e99c2fa48734117f85e73c8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 10 19:40:25 2012 +0000

    Fixed http://code.google.com/p/impacket/issues/detail?id=14 .
    There were other instances where id() was used in this way.. provoking an overflow.

commit 2a8b58cf02fd7fd4a24c2adf1cd9198f88555802
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 7 15:15:43 2012 +0000

    Although [MS-CIFS] defines SMB_COM_WRITE_ANDXas:
    
    SMB_Parameters{
    [..]
    Reserved;
    DataLength;
    DataOffset; -> Offset from the begining of the SMB Packet to the data
    OffsetHigh (optional);
    }
    
    SMB_Data
    {
    USHORT ByteCount;
    Bytes
    {
    UCHAR Pad;
    UCHAR Data[DataLength];
    }

commit f825155642e7a3cb77270fbb981a4f3cd3295ff1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 6 22:46:08 2012 +0000

    Fixes http://code.google.com/p/impacket/issues/detail?id=13 reported by Bryan.
    socket should use send(), not write().

commit 02c3d7b75151d8fa8c8ca2d59a4d3029513672b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 6 04:26:22 2012 +0000

    Reading the StdErr pipe using readFile() now.. Makes it work

commit e4ea903f3d7782f1b085baa181fd93e2bc3bee3f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 6 04:02:02 2012 +0000

    ChallengeLength must be treated different depending on extended security on/off:
    
    ChallengeLength (1 byte): When the CAP_EXTENDED_SECURITY bit is set, the server MUST set this value to zero and clients MUST ignore this value.
    
    and when CAP_EXTENDED_SECURITY is not set:
    ChallengeLength (1 byte): This field MUST be 0x00 or 0x08. The length of the random challenge used in challenge/response authentication. If the server does not support challenge/response authentication, this field MUST be 0x00. This field is often referred to in older documentation as EncryptionKeyLength.

commit e6a9c5cd3c84dc839844835d476cc4e527870805
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 6 03:06:04 2012 +0000

    We're not relying on client's capabilities based on the negotiate packet, but still looking at the Flags2 to decide whether or not extended security is supported.
    Fixes http://code.google.com/p/impacket/issues/detail?id=12 reported by Bryan

commit 5a8a6d1f2d4b749d23f30de8f6e08e7dcf39ca3a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 4 02:03:28 2012 +0000

    Adding tests for all dialects

commit 9e276c18b0f0355453f0243500a96a7e9f983574
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 4 01:33:09 2012 +0000

    typo

commit 031fc5e25415e23c520c0772facd3e3332ad0c85
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 4 01:27:34 2012 +0000

    Completing some aliases

commit f999d5336588bb2bf371a2ef8e3ca4b00c607cff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 30 20:25:03 2012 +0000

    When a stringbinding returned by the portmapper has '0.0.0.0' we should replace it by the servers IP address

commit 0306a10d24bba2cb0adb13317f6a6e37579b7834
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 28 12:39:56 2012 +0000

    If login is unsuccessful, clean all the internal variables in case user wants to authenticate again within the same connection

commit 1938dcf0d6fff52d10d861b9f8508704c4ff4ce0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 22:10:06 2012 +0000

    Initialization of self._NetBIOSSession to None. Important if something goes wrong before the connection is made

commit 7909c3292033a174ce2136c49b26fe6fc85b96bc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 22:09:27 2012 +0000

    global dialect variable added, once the first SMB connection is made, we hold the chosen dialect there, speeds up the process for w2k and xp

commit 53dfafc0f5ea2c26fd1f8c70cbd1b11262325d75
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 19:11:12 2012 +0000

    Test case for SMBConnection, still lots to do to test things right

commit 41623744c5373f19cd30b5f04631492e60d98d55
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 19:09:24 2012 +0000

    Porting smbclient to SMBConnection methods

commit f5eb286882f29d8d8950cb9aabda0314642b6212
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 18:24:22 2012 +0000

    Ported to the SMBConnection concept. Much simpler and SMB version independent. It will pick the best SMB Version when connecting

commit 633127140d6b642012bd0f1503e7d32fc0b67277
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 18:21:24 2012 +0000

    1) SMBTransport now uses SMBConnection methods.
    For backward compatibility it will try to detect if a SMBServer (not SMBConnection) was sent as parameter and will return a SMBBackwardCompatibilityTransport() (old behaviour).
    2) Exporting a method preferred_dialect() if you want to specify the specific SMB dialect you wanna use

commit 94bdb870f064d700df56df720e8be6e8c28b6d2c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 18:18:10 2012 +0000

    This helper library now works with the SMBConnection methods. If for some reason it receives an SMBServer as parameter, it will convert it to a SMBConnection

commit a10e5f8f2953d54df068700249a2d887b2707a3f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 18:16:21 2012 +0000

    Just a clarification

commit ef081f731119e9edc1789157754836a75447fa10
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 17:00:28 2012 +0000

    1) Allow an existing connection to be sent to the constructor
    2) writeNamedPipe uses writeFile instead of TransactNamedPipe()

commit 86fbb1e8b240acb4ac03cfe0efa25f879f5e2bb5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 25 16:59:02 2012 +0000

    waitAnswer on write()

commit 4f0f4e5fb00f7780234caa54300b90c727df09bc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 22:05:24 2012 +0000

    setTimeout() added

commit ec3581c8963d21bf086218ecea67d85a982f708d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 20:32:19 2012 +0000

    1) openFile opens the file for READ/WRITE by default
    2) Fixed bug in writeNamedPipe()

commit 570bb2414f4dce34befd6a3ab9b6c2bad2754ea6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 19:56:58 2012 +0000

    1) Added transactNamedPipeRecv()
    2) Fixed bug in openFile

commit 658d9e787ea6c6df3b31d2c499d394a83865f40c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 18:33:02 2012 +0000

    1) Added rename()
    2) Added readNamedPipe()
    3) Added writeNamedPipe()
    4) Fixed transactNamedPipe()
    5) Added listShares()

commit d15a11c2784fe07a548f2756801e39e47bd34f0c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 18:30:59 2012 +0000

    replace should be done against old_path and new_path

commit 5d75ab67bb8478fcb36d090b201da5c55e4ea7f5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 18:23:35 2012 +0000

    1) Added SMB_SET_INFO
    2) Added rename() higher level function

commit 95f2c02d09e6b82c994b504d6c3d717e23a06d5e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 17:06:06 2012 +0000

    WaitNamedPipe now accepts timeout

commit b39527293d16d6f579545bc7d2a9b4f6c87e2c57
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 16:53:51 2012 +0000

    we call writeFile for SMB/1/2/3 instead of write_andx. We have to take care of the amount of data that can be written if signing is enabled

commit 4405cdc180322b639a2ed321cba110552b95479b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 16:52:58 2012 +0000

    writeFile() added

commit 6dd5cd7b505b289476b8b039948a03c23d0906bb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 16:52:38 2012 +0000

    writeFile() added

commit b08c37bb71e270c238831aa520a8888b0c716413
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 20 00:50:45 2012 +0000

    Removing a debug msg

commit 57e0a87d503c3ae73950d1a110cbb8c253a5ba05
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 19 23:32:25 2012 +0000

    First version of smbconnection, not yet finished:
    # Wrapper class for SMB1/2/3 so it's transparent for the client.
    # You can still play with the low level methods (version dependant)
    # by calling getSMBServer()

commit a50394e80333328045e685b2894cc4ef554b569d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 19 23:14:12 2012 +0000

    1) preferredDialect added to the SMB3 class.__init__. Allowing to select an specific dialect to use
    2) getDialect() added
    3) backward alias get_server_os added
    4) del() added

commit 84670d2a2fbfc11802100874fa089902dc87033d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 19 23:11:47 2012 +0000

    getDialect() added
    replacing '/' for '\\' for all the functions that deal with pathnames

commit d12d7196ec4bbd9eacc7fd1b71a2f1187d3fd5c3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 21:31:43 2012 +0000

    Sign also for SMB2_DIALECT_002

commit 6f0791509e6cfd3f0f5c9a50d467294cb09d978e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 14:06:40 2012 +0000

    Added useTimeout() and remove()

commit d43162f9f393cced45a340f7a0e983992c2dd749
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 13:38:59 2012 +0000

    NT_STATUS errors are now STATUS errors

commit ae5194fc8966b6cae54d2211af96c5e8d176dd0e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 13:30:38 2012 +0000

    Removing all the spnego stuff and importing spnego.py

commit 1cadbcad06a2214757563b63133323dd911cb82d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 13:29:45 2012 +0000

    Using spnego.py instead of smb.py for the spnego functions

commit 59f47b2ccba857adafce903069e5ce0658a5787a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 13:20:52 2012 +0000

    Using spnego.py instead of smb.py for the spnego functions

commit 677f737261c5f5310368d53de6d2bc46d2668d67
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 01:39:04 2012 +0000

    SMB3 signing now working if the server enforces it. The rest of the key derivations are also calculated, needed whenever we implement encryption

commit 1954029cdffc1e30fcad39e1ccdd37de95377837
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 17 01:04:03 2012 +0000

    Extra crypto stuff needed for SMB3 signing and encryption:
    #   RFC 4493 implementation (http://www.ietf.org/rfc/rfc4493.txt)
    #   RFC 4615 implementation (http://www.ietf.org/rfc/rfc4615.txt)
    #
    #   NIST SP 800-108 Section 5.1, with PRF HMAC-SHA256 implementation
    #   (http://tools.ietf.org/html/draft-irtf-cfrg-kdf-uses-00#ref-SP800-108)
    #

commit 5c63d6be065faca3c1c3eb98a1ea88762173369f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 16 19:18:18 2012 +0000

    connect tree path must have be UNC like for Windows 8 to like it

commit 3f7e5da9a98d2dd7e5bcd97e7e7405311bcb47f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 16 00:29:15 2012 +0000

    StructureSize must be 25 for SessionSetup, if we want Windows 8 to be happy.
    
    So far it can authenticate.. still pending all the new SMB3 signing stuff

commit f69673c59696528d072b98336284fa5a96fb3a31
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 23:52:50 2012 +0000

    Putting all this stuff separate. we should take it all of from smb.py (not yet)

commit 964d3f208c4f729d6002e7d4845894db5e898344
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 22:57:06 2012 +0000

    Updated info

commit 80b5580dfa9a79e686d7f023aa3284e7d6feaaaf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 22:53:45 2012 +0000

    1) Added waitNamedPipe()

commit 93026c2982de8fbbfe89e5809ed67c66a7ac39f9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 21:49:44 2012 +0000

    Forgot to remove the other pair of the share inside self._Session['TreeConnectTable']

commit fb55dac69082c68f0f36246e7162443d1c2f8654
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 20:01:43 2012 +0000

    1) oopps! forgot to deep copy the TREE_CONNECT, OPEN and FILE dicts
    2) set_timeout() added
    3) working on nt_create_andx when cmd is sent

commit 0fc0a1fda1ea0c7d642add524229dc71146a77f9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 18:08:21 2012 +0000

    1) Added stor_file()
    For testing purposes.. smbclient should work with SMB2/3 with you change the do_open() to:
            self.smb = smb3.SMB3(remote_name, host, sess_port=int(port))

commit b24b15a99358f4d8baa2649588767f0cd8103576
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 17:21:26 2012 +0000

    1) Added SMB_QUERY_INFO call
    2) Added retr_file()
    3) Added open_andx() in the backward compatibility section

commit 0b253b8509b42c525250157ac444fe5eeee86493
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 17:15:57 2012 +0000

    when retrieving a file, don't create the file with a full pathname, just in the current dir.

commit 538a0bb17a51c2401c2e443d76c237273f0a2a3f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 15:05:11 2012 +0000

    When doing CD, check the directory actually exists

commit 202b0ef4139c412cf2b1d1d91281f24ed2284014
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 13:58:01 2012 +0000

    One more use of ntpath

commit 5615c25457f8fd6d1cde6a691cb82d871ca1df5a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 03:26:29 2012 +0000

    1) Added mkdir(), rmdir()
    2) If connecting to a tree that is already connected, don't connect again, just return the treeId

commit 67597966608afb38a00cf319e52d67f90e48fef1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 03:07:45 2012 +0000

    Using ntpath to join directories, much safer and clean

commit f927429eddb2ba18114a1f47bae592be8826ce3f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 01:22:04 2012 +0000

    Added list_path()

commit 275c011a4542c1e6b0e0b3b64a32367bdb5628a9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 15 00:53:32 2012 +0000

    SMBFindFileNamesInfo() has now a UnicodeType as well

commit d123563013e08c8be3316126ccbe5dabe39f8ff1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 14 23:47:36 2012 +0000

    1) Added isGuestSession()
    2) Added getServerIP()
    3) Backward compatible list_shared(), connect_tree, get_remote_host

commit 19840a88b2db384394de4dbc387fc886f8b79817
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 14 23:21:48 2012 +0000

    Initial implementation of SMB version 2 and 3 protocol [MS-SMB2].
    1) Signing support for SMB2 done (SMB3 not yet, as well as encryption)
    2) Commands implemented:
    SMB2_NEGOTIATE
    SMB2_SESSION_SETUP
    SMB2_LOGOFF
    SMB2_TREE_CONNECT
    SMB2_TREE_DISCONNECT
    SMB2_CREATE
    SMB2_CLOSE
    SMB2_FLUSH
    SMB2_READ
    SMB2_WRITE
    SMB2_LOCK
    SMB2_IOCTL
    SMB2_CANCEL
    SMB2_ECHO
    SMB2_QUERY_DIRECTORY
    3 left to go.
    3) DCERPC over SMB2 should work, if you change smb.SMB for smb3.SMB3 in transport (and import smb3)
    
    We'll do a SMB protocol factory in the future to make it all transparent to the user.

commit 2552e57fed56433c141fa77b9d98bb8e011d88b8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 14 22:49:24 2012 +0000

    Added TransactNamedPipeRecv() to smb.py as it's being used by transport.py. This is to isolate anything related to SMB1 from the DCERPC layer... (guess why? :P )

commit 0d76f992ce02c3e8500bd60f6f4f6c065a922e93
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 13 18:44:04 2012 +0000

    Forgot to remove the higher bits on the lower side of length field

commit 6b0b2eec7fd2c841b8d2f6f79d1b4be740ba24a8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 13 17:01:23 2012 +0000

    For NETBIOS_SESSION_MESSAGE the size of the message is 3 bytes long, using the flags byte

commit 04f6b3256049183b1150943f428507ae883a5291
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 11 16:49:49 2012 +0000

    Just ordering the imports

commit 68a36eb68a578ee1d88bcacaf5722da3b1188458
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 9 16:56:32 2012 +0000

    Binary compiled with VC2008 so it can work on Windows 2000 boxes

commit a1329d587172dba033653da58e7975772cd03872
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 9 16:54:12 2012 +0000

    Sleeps while waiting for the pipe to be ready. Set a max tries of 50

commit f5c72ebb022f3095508b86041baf1181ccacf6dc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 9 16:21:28 2012 +0000

    Increased the amount of bytes substracted for chunk_size to make it safer, doesn't look like it was enough for Windows 2000

commit 17870a41e3657b38ce220cabd1c7732991c96e8c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 7 14:30:07 2012 +0000

    If we know the serverName, use it for the path to the service, if not, just stick 127.0.0.1 and hope for the best.

commit 9ab7ae576e5bdbed7e2ce72f99279e3192fc6f00
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 6 21:49:56 2012 +0000

    Added -file option.. allowing to upload an specific RemComSVC compatible file

commit c6a052224f6d1130ff93bdc485c067935b9209e8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 4 19:36:18 2012 +0000

    Now it also print the Interface Provider (the exe/dll file holding the typedef)

commit 9dc37f96af6b6fa4eeb001b24837528aaa041ef8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Aug 4 19:35:30 2012 +0000

    Updated KNOWN_UUIDS

commit d578b42a1c9d8b860b7d7cd54157776c4999811e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 3 14:01:11 2012 +0000

    A few more UUIDS

commit 4b0ff106fd3eb21ea6a7e80d569689abb4e794cd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Aug 2 12:16:43 2012 +0000

    More updates on the KNOWN_PROTOCOL dict

commit b3eb3eaf9ab6df033015ddef038c08df16fd33a4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 1 19:28:52 2012 +0000

    A much better way to show and endpoint mapper output (IMHO). Now grouped by the Interface IDs

commit be278a142fcc1c4845c6cdd191db2861806e8bb4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 1 17:55:02 2012 +0000

    It now shows the protocol associated with the Interfase ID, if possible

commit 8b10b7920c2bebec6d6b3b4c24190e7a9e5c22bd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 1 17:52:49 2012 +0000

    Added KNOWN_PROTOCOLS dictionary.. I parsed all the Windows Protocol Specification looking for the UUIDs used. This could be helpful when reading a portmap output

commit 703a6815cf20652364bcde87c6e8e597eadb3f86
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 31 22:05:14 2012 +0000

    A simpler and faster version of rpcdump, using the new lookup call

commit 182545a341cb4bbfc35f8ff48966360ee7dd757a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 31 18:32:59 2012 +0000

    pump up version to 1.0-dev

commit 8eff6ce2722924c527796a555a8773c4b8090da2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 31 17:27:56 2012 +0000

    Forgot to remove forcing inquireType to be all endpoints.. now it honors the method parameter

commit 437091d68db03d1216f7f939ee2f69ba09f146b8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 30 23:40:39 2012 +0000

    PrintStringBinding() method added.. basically same code we had before but converted to Structure like code

commit 66793d1f1f7a53ce735f008e88377e49f55be54e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 30 22:15:28 2012 +0000

    Added portmap lookup function using Structure. It can work as a general portmapper, or just to find specific interfaces/objects.
    But most important, it doesn't grab records one at a time (as the previous implementation), but get them all and the parses the results. Way faster than before.
    Old code left there for backward compatibility.
    Still gotta finishing printing friendly the results

commit f8dcd5514a23eb4a9e47ee8c628b6ff4c9294161
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 30 19:54:19 2012 +0000

    Some clarification comments based on [MS-RPCE]

commit ac130e8bf0bf0b7bf98e7618d9f4420f9fd537b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 26 22:18:33 2012 +0000

    1) Fix bug when passing hashes, there weren't being converted to binary hence it wasn't working

commit 7e422881d578484d94b9ee05d46e3a0f5f504990
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 24 16:43:04 2012 +0000

    [MC-SQLR] example. Retrieves the instances names from the target host

commit 2e692c3cfb4105811e066983049ba71c3baf5a1f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 23 18:05:18 2012 +0000

    Added commands to the shell:
    1) lcd {path}                 - changes the current local directory to {path}
    2) enable_xp_cmdshell         - you know what it means
    3) disable_xp_cmdshell        - you know what it means
    4) xp_cmdshell {cmd}          - executes cmd using xp_cmdshell
    5) ! {cmd}                    - executes a local shell cmd
    
    Just to show what can be done..

commit 6c37c911075b748d97b0f6852e52930ed6c55237
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 23 17:59:25 2012 +0000

    1) Changed printRows, now it mimics what a osql client does ( I don't know if I like it more or less)
    2) ENVCHANGE now specifies what changed (DATABASE, PACKET SIZE, ETC)
    3) Added new types, dates should be shown well now.. decimal as well. Only important one left is SQLVariant

commit 47f51877eaa8367f5af2e2623b147564ab1390be
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 22 18:20:28 2012 +0000

    Now it shows TDS_NUMERICNTYPE most of the times :)

commit 1a0ed117f1a08b98d356a32508303d9beb99b144
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 23:08:49 2012 +0000

    Added -file option to specify a file with commands

commit 6a8373c79501f89febe82bbb1ae02ed2dd6af4f7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 22:56:55 2012 +0000

    Fixed bug in NTEXTTYPE, weren't adding the right amount of bytes to advance in the buffer (2 instead of 4)

commit 7c45e66a86fc174a2c8fe6856ead554b537c4a18
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 22:42:28 2012 +0000

    Added TDS_NUMERICNTYPE parse in parseRow(), still have to print it the right way. Now just printing a warning message

commit 8dde582908d9db9d1cff5cc09d3ba84574cff9e0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 21:38:10 2012 +0000

    Don't get into the SQL Shell if auth failed

commit 205135a8bb8a1c403b89eb18189f71b1c06165ad
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 01:44:01 2012 +0000

    self.colMeta must be clean every time we parse colMetaData

commit 644c6cb52ba8d4d6b1abf410ec3c55c238e14cf6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 01:21:29 2012 +0000

    TDS_NUMERICNTYPE size is just 1 byte (inside parseRow)

commit 73fa99559391f2cde06fad1e7b8a807823e8833d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 00:09:28 2012 +0000

    GUIDs can be NULL :s

commit 89484cdfe2f90874eee7fb383a70cd1260891ffd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 21 00:04:43 2012 +0000

    Added TDS_RETURNSTATUS_TOKEN and TDS_DONEPROC_TOKEN

commit dfeaa4e75ad891560abf5e189da072b85541db41
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 23:53:06 2012 +0000

    Support for TDS_GUIDTYPE in parseRow

commit 9c52f905279db165969d8204705b2bd472f322a1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 23:40:40 2012 +0000

    Oops.. w/o printing the error

commit c2594c95f2c03736bec07a1635a011fb9c35abe7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 23:39:51 2012 +0000

    Don't exit if something goes wrong

commit cba4a5862e5d1703071e7742f267f7d2713c4fc6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 20:53:05 2012 +0000

    Windows auth by default is False

commit 931a714a65d6b3973e6f5bb7cc303eccab936d00
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 20:51:48 2012 +0000

    A simple MSSQL client

commit 6a741a350aeeb321e258ffbcb500521ca1c19a7c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 20 20:50:25 2012 +0000

    Initial implementations of the TDS protocol so we can talk with a target MSSQL Server.
    It supports MSSQL and Windows Auth.
    See the mssqlclient.py under the examples

commit 1dca21e47ca242c584cc099a17a948912a2da023
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 18 13:13:22 2012 +0000

    Updated setup.py

commit 7bbd07faa998cf279a6e6af21ec48a0ef29be425
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 18 13:11:10 2012 +0000

    Clarifications on the need of using the srvsvcserver

commit 0b71d0e80de3e72f2b4ed537060ab717d0d409f6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 15 19:25:01 2012 +0000

    Support for large files in READ_ANDX and WRITE_ANDX

commit 08ea2274a7043b62d778a8e32867dd3a1a8b9492
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 15 06:26:46 2012 +0000

    Added -file command line option allowing to specify a file with commands to execute. E.g.
    cat > cmds.txt
    open 192.168.53.146
    login user1 pwd1
    shares
    use admin$
    cd Web
    cd Wallpaper
    ls
    put myfile
    
    python smbclient.py -file cmds.txt

commit 0e862171aa7c401e5deea0016bb3f53e40c853a7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 15 03:00:54 2012 +0000

    Exposing a getShare() method used by psexec

commit 9f0021ff277f08daf6000943060e92e2dc13abff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 15 02:59:58 2012 +0000

    Ability to download/upload files from the shell session. Could be kind of confusing at first but I'm sure it's gonna be useful to somebody :P

commit 66db493223f9d27b431dd0f1975569748d0b6874
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 14 23:53:54 2012 +0000

    Now smbrelayx uses serviceinstall helper library... Much simpler

commit 5d74ec93796baf422c47f36993804cb3635ec2dc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 14 23:07:54 2012 +0000

    IPv6 ping example

commit c9b8411586d2cf3e89c5188cbb2c694c7aabe7a7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 14 15:54:14 2012 +0000

    Under some circumstances, opening multiple simultaneous connections to the target host might make the server to reset some of them. Looks like opening them sequentialy solves this problem. I added a lock on each thread so once they release the lock lets the next one opening the next connection. This seems to solve this rare issue

commit da57bdc4d5b33997a54e4f9560513573a2f3cfb9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 13 19:40:41 2012 +0000

    Added a RemoteShell class that allows implementing some commands on top of the shell being running (currently only lcd and '!').
    
    Better control of some error situations.

commit 0863f23a244526343ed26134537eb0d2899f1d19
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 12 16:33:04 2012 +0000

    Don't fail if we don't specify a credentials file (we're not using it right now)

commit 26515dd76df20cc1fb657d0d76650f5bfa0033ea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 12 16:22:04 2012 +0000

    In the situation where something fails inside a try:.. finally will get the wrong tid, setting to the correct one

commit 97817fc1d10e9a20a1a09a58459cc09d756fc1b1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 23:54:59 2012 +0000

    1) Parameters are parsed with argparse
    2) Added domain and hashes support

commit c987cf7d1439aa8b40244368defd2b64309500e5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 19:39:46 2012 +0000

    Removed debug msg

commit 8bf973f914effc1e54aebc613fa663398c3a2a21
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 19:39:14 2012 +0000

    1) Parameters are parsed with argparse
    2) Added domain and hashes support

commit 02f502b266739ea475f76780863bd3cb9c0fc70b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 19:12:55 2012 +0000

    1) Parameters are parsed with argparse
    2) Added domain and hashes support

commit 5405bb444113dc330f5c418f399d3dd34fd7f74e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 17:51:30 2012 +0000

    1) Catches exception when connecting and exiting gracefully
    2) Threads honor the destination port given by the user (either 445 or 139)

commit 0e181e400b9b5166eba966f8ab376b7ec209a358
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:55:44 2012 +0000

    Showing help by default

commit 7c1e7b40efeacc760652d2078af0b8f2e1f8baa5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:48:20 2012 +0000

    Showing help by default. Default transport is 445/SMB

commit 4120e1178808a316b838cda27ff66e50363f721c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:45:20 2012 +0000

    Showing help by default. Default transport is 445/SMB

commit 557943ab22f83f9b473cce92373fba41bfbc571f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:42:50 2012 +0000

    Showing help by default. Default transport is 135/TCP

commit 3bc1bfe317a76317b02c277d3dc91ebd0a0001b1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:37:01 2012 +0000

    psexec like example using RemComSvc (https://github.com/kavika13/RemCom)

commit 0ab8226c9b412926420f7f3858e015c3ebc3bc6a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 11 16:34:47 2012 +0000

    These are helpers to be used by the examples provided.
    
    remcomsvc: delivers the binary of the remcomsvc to be used for remote execution
    serviceinstall: helper to install/uninstall services

commit cc630748b93c49ad0f3c3b43c3e9d8850d903f8c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 10 14:16:54 2012 +0000

    Added domain and hashes support

commit 821cef87b7f4faae3480143606fe31cee2ce4f1a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 10 14:09:48 2012 +0000

    Added domain and hashes support

commit f45d28d4cdae235f9aa7e4aef6a56e24740e5c05
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 10 13:58:10 2012 +0000

    Added domain and hashes support

commit 2c8a5bf41302e6289d0ea3c2fb803da8eadf847c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 8 22:19:26 2012 +0000

    Remaining was wrongly calculated.. the original buffer's size must be there (I had to substract the 2 additional bytes when sending in pipe_mode)

commit c8a651797e44c6f359c03c1af97d2d11a5f605ef
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 8 21:38:17 2012 +0000

    1) MaxBufferSize now set to the recommended by MS-CIFS (61440)
    2) Implemented WaitNamedPipe call
    3) write_andx now supports a write_pipe_mode that requires sticking to MaxBufferSizes besides the capabilities set by the server

commit c6c6a0cd3cee8f64ac5f664d8fbaf2a3deba1bdc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 8 04:44:34 2012 +0000

    Fixing padding calculation for NT Transact

commit 734b5cdfd032f25a6f2b6f68c93306efa2cc7d8a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 6 20:36:54 2012 +0000

    1) Putting deprecation warnings on __raw_retr_file and __raw_stor_file methods
    2) Raw methods eliminated from stor_file() and retr_file()

commit 53847d097ca8047e4edc20cf415bb5b8b917c23e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 4 19:49:59 2012 +0000

    Added SMB_FIND_FILE_NAMES_INFO info level to findfirst2

commit 9a2fa5c2424c1df9e9d16d50808a220ee877e1c8
Author: jigermano@gmail.com <jigermano@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 3 20:46:35 2012 +0000

    Added partial support for TCP SACK (support for 1 block only)

commit 5f5bd8b07f486a87aacb014a36e01ab5edae5c92
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 29 19:16:11 2012 +0000

    Service Type can be many types

commit f3b3017e7c6c257c5e98693f39dd0c0738a98644
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 26 16:55:13 2012 +0000

    1) Added use_timeout() context_manager method.
    2) Added deprecation warning for tree_connect(), clients should use tree_connect_andx()

commit 59b931d373e1325ee75e3bdc5fe91bd9f582e12c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 26 12:59:30 2012 +0000

    Better error support and status reporting

commit 99fa62bc2dd7fd2c90a08b7b73eff34472d9f81e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 26 00:42:49 2012 +0000

    No need to have a '-m' switch.. can be infered whether or not a host is specified.

commit c03b0707aa22f7dc690b292daf16dfaaeb36da86
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 26 00:31:18 2012 +0000

    Better error support and status reporting

commit a9a0586fe2a765eb0642eac81cea8bd328036dca
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 24 21:27:07 2012 +0000

    1) Added create service option
    2) Arguments' parsing now handled by argparse

commit 5aeb21bf41771586f3434dc57bc3c3793ee5cd31
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 24 19:39:05 2012 +0000

    Using argparse for program's argument parsing

commit 29c06e14650c5b3b69388691196a3191abb7dc50
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 24 06:21:25 2012 +0000

    1) Added reflection mode, to relay credentials to the caller host (fixed in MS08-068)
    2) Program arguments now handled by argparse

commit b236b79627b09b189e55f31ca47a83e4bc204a4b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 24 06:17:30 2012 +0000

    Added version file used by the examples

commit 1bcc9010136d3d71f46827baff19e9566b9fe285
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 23 22:17:33 2012 +0000

    Parses a pcap file or sniffes traffic from the net and checks the SMB structs for errors.  Log the error packets in outFile. Still lots to do

commit 55feb029a413ea5de9b68ce50611f18e77838a9e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 23 22:09:30 2012 +0000

    Prints whether or not a USER or GUEST session (SFS) was granted

commit 4b5a523d6f8690f018ce30bea8e72e10d30889f8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 23 22:07:40 2012 +0000

    Added LsarLookupSids3() call

commit b65d75c3950776f9949276e40aa60044b498effb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 23 22:06:10 2012 +0000

    Added rpc_fault_cant_perform DCERPC error

commit 91cdd87c4a7d290d35a85c970bf50f484d0c7f08
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 22 23:33:36 2012 +0000

    I just saw an answer from a server that doesn't have the reserved field in zero (contrary to the protocol specification). Since it's not used, we're just letting the structure to hold whatever value is received.

commit 7ddb494c04ce2867c333d48829c9751358775f4c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 21 18:50:46 2012 +0000

    At logoff, receive the servers's answer and clear the uid field, in case client wants to login again using the same connection

commit 255f7a802a05182b044b95a7c34fb873df518439
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 21 15:39:40 2012 +0000

    If we change to a different share, clear the pwd local variable

commit abf579ccd0a288ca780a23c0434e84814cf8c114
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 15 20:00:07 2012 +0000

    Added get_timeout() method to the SMB class

commit 5b6667f4a198e3114cbf14fe9cac4c9b74db6e61
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 9 05:45:33 2012 +0000

    Fix typo on all SMBSessionSetupAndX* definition. Unicode ('u') must be used instead of NDR ('w').

commit 61c7a29157fd2d2ab3683f63112e32285f1de8a5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 2 01:22:08 2012 +0000

    Just making the example to work

commit d13b6c58b49fa0e55129baa37f04eecadb222f18
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 2 00:33:57 2012 +0000

    Removed parsing data inside the payload of a SMBNTLMDialect_Data(). I added this in revision 294, but triggers an exception on some weird Windows configurations. ServerName is grabbed later on at the login stage, in a much safer way.

commit 509aa4bd585289ce69887c6b455c4304e3fea7e2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri May 25 05:17:13 2012 +0000

    1) Missing '<' in LSARPCLookupSids'd LookupLevel Field
    2) Added LSARPCLookupSids3 structure

commit 357c11ec7f02310f42832275587c7e763b1cbe2b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 13:56:36 2012 +0000

    Example now grabs the Scheduled tasks through SchRpcEnumTasks(), much better since it will grab them all (contrary to the old NetrJobEnum() ). Example yet not fully functional, just committing for backup

commit 7bae66d5edf82ca2860bf01d7fc3197066a9cd8d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 13:51:39 2012 +0000

    1) Fixed bug in MSRPCBindAck when SecondaryAddrLen is 0, SecondaryAddr should be optional
    2) When doing alter_ctx, keep track of the previous callid

commit 1ac3783599ac71e3581909630c14312c9ae42e91
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 04:01:28 2012 +0000

    if SMBTransport.disconnect() is called, and no previous smbserver was provided to the transport, clear self.__smb_server, in case a new SMBTransport.connect() is wanted

commit 82a21e94a7409fc136d61181b3821f8c05ab5887
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 03:28:17 2012 +0000

    Added Method SchRpcEnumTasks()

commit e778256d6514680657aedd4d6b48bb90b754e327
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 01:12:17 2012 +0000

    Example for the ATSVC dcerpc methods. So far it:
    1) Creates an schedule task
    2) Enums the tasks created for the user

commit ee81a9c3a21fb65525c7632df507437ee710060a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 22 01:10:13 2012 +0000

    First implementation of the ATSVC ([MS-TSCH]) methods:
    1) NetrJobAdd()
    2) NetrJobEnum()

commit 7a78b6a41bfcb235c723ee1dbc42ea1889e2d012
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 20 23:16:59 2012 +0000

    Small example for SPOOLSS, now it's only enumerating printers (Level1)

commit 7d526a6140f299897359bb5583f121477d6021a8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 20 23:12:24 2012 +0000

    1) Adding SPOOLSS UUID
    2) EnumPrinters now returns data

commit 73a44c7e5c5c25a82fd569790667042398d600ff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 13 17:39:57 2012 +0000

    We're not updating the Changelog anymore.. google code can do that :)

commit 6c3c1cbf475b3ad5ca64fa69243b304d869f0172
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 13 17:32:45 2012 +0000

    update

commit 060964bc775b7279d3d8b1b582329de84075c06e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 13 17:05:16 2012 +0000

    1) Added support for shell commands thru '!'
    2) Share's list first done through SRVSVC, if it fails, falls back to LANMAN

commit 3422aaa3e82c71c31d28e11ec1293d5a80026a39
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 13 01:53:42 2012 +0000

    Small fix on negTokenResp when parsing negResults with no extra data

commit 97f0b6d1b777a2d6c8322afdb7f70e032096b2b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun May 13 01:51:25 2012 +0000

    SPNEGO test case. We should add more tests in here

commit 2a9ab2071c5f7551f175e8fb35b2f917f2694182
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat May 12 18:58:59 2012 +0000

    Adapting smbrelayx to svcctl exception handling previously committed

commit c578f9fc2dd64122dce69b66b831528112078a29
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat May 12 18:31:15 2012 +0000

    Added the ability to use external srvsvc dcerpc server. Disabled by default. Uncomment lines in simple_server.py to test it.

commit 7165090b7860d4e0201e4a2364d1eb7d8799e8a0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat May 12 18:29:18 2012 +0000

    A minimalist DCE RPC Server, just for the purpose (for now)
    of making smbserver to work better with Windows 7, when being asked
    for shares

commit bdb995f37fb25866479a3b09c2241d37f4fdc21f
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu May 10 02:00:56 2012 +0000

    In the context of issue 7 reported by oss@divinehawk.com, we fixed TCP parser to avoid get stuck while parsing TCP options.
    Also we added a testcase to support this case.

commit cd7c71fa7bab0c374e2248ffce77b3fb6cf59c33
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 9 23:17:25 2012 +0000

    If CAP_LARGE_WRITE or CAP_LARGE_READ are enabled and the communication is not signed, we increase the buffers for read and write to speed up performance.

commit 26e70b4cd86b64e7eea35a3f313148b2ba556980
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 18:53:28 2012 +0000

    Ability to resume an enumusers call if many entries are returned

commit 19482fe37e4a7d931846c284b612829557750b1b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 18:37:57 2012 +0000

    Changing permissions when opening target LsaR

commit 134a29978dde25e959599f054c1c0becc0ded477
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 18:26:07 2012 +0000

    Where there are many users in the target machine, there should be a way to continue the search. Added that possibility to the enumusers() method.

commit 19ddf71ec1f88fafc02eacf7b14f9f113f603cb3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 13:21:28 2012 +0000

    RefId random value CANNOT include 0

commit c06870d0a8739e08338c63be0642cf3dc829bccd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 13:21:02 2012 +0000

    1) Fixed padding issue in DOMAIN_INFORMATION
    2) doRequest now checks whenever the DCE call triggered an error by default (some functions explicitly set is to False)
    3) RefId random value CANNOT include 0

commit b49cf12f72f8ae1efe9eb62ae2fd8ac142362313
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 04:06:37 2012 +0000

    Now it does bruteforce. MaxRid parameter sent thru command line.

commit 877c89e7a436c84d98cf1315e85091bd718d0bfb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 04:03:09 2012 +0000

    1) alignment in LsaLookupSid struct not needed
    2) Better handling for LSARPCLookupSidsResponse.formatDict() when some of the answers are NULL pointers (e.g. some SIDs NOT_MAPPED).
    
    That whole LSARPCLookupSidsResponse.formatDict() should be rewritten.. I don't like the way it was implemented.

commit 4549684a78288bbb9cbd968ae3de7b801f5a1180
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 00:36:42 2012 +0000

    First implementation of lookupsid brute forcing.. still not bruteforcing a thing ;)..

commit 8d926970b6e7ead17dce9abebb7387895c16ef38
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 7 00:35:02 2012 +0000

    1) Added LSARPCSessionError Exception, still left to print the NT Status code
    2) Added LsarQueryInformationPolicy2 call

commit 646a668790e44aada75a810f1db22d28f7efdee3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 1 23:20:26 2012 +0000

    UUIDs for each endpoint now in readable form

commit b12247b9147c2ae92e1fb8c248ea52fb4afff5f7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 1 23:11:16 2012 +0000

    Avoid opening a dummy servicename when asking for LIST action

commit a481520586f586184a08b898be6d5d2f2b299415
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 29 21:39:46 2012 +0000

    Setting svn:keywords "Id" on all files

commit dfbfabf0c55227790eaf04e9f2b6fb8d3b51e10e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 29 21:30:27 2012 +0000

    Copyright update

commit 4538240fcce1e32e878147f30296efabd5e3d7a0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 29 21:04:38 2012 +0000

    Copyright updates

commit 086817b3fc0aa8ac1180a4b17acbf0168eeab403
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Apr 29 20:41:05 2012 +0000

    1) Added capability to get the SID Type when parsing lookupSid response (thanks lanjelot!)
    2) Fixed a padding issue when parsing the odd domainnames

commit abe7b092e7182a62a2be0e69bc0c92c5893705bf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 17 13:07:49 2012 +0000

    doRequest now throws an SVCCTLSessionError Exception when the RPC call fails, dumping the right error.
    This means all the exposed function will throw an Exception when an error is found.

commit 78c8f005522e9ba8d2a979f997292e6dbdcecae0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 12 21:51:26 2012 +0000

    Removed debug message

commit 1552df235136b657d10c939b1830b5f35e5076a7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 12 20:55:38 2012 +0000

    Fixed wrong detection of an existing smb_server, resulting in disconnecting it when disconnect() was called

commit 1fdd49d8566542cc5b199bf25992a6df1f56082f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 9 19:46:31 2012 +0000

    Adding the ability to set up transport's connection timeouts programmatically

commit 8d0deabb2600b9d4eaa1b62ae1616377c09abd4f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 9 19:15:10 2012 +0000

    Fixed previous smb.py commit bug in set_flags()

commit 5f75480b08545c2fe81b57e6949a4d4cb44f7c7e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 9 19:03:32 2012 +0000

    Fixes bug introduced in previous version triggered when targeting port 139

commit 8ac46fec6b5c302430bcee8ac1f1a7a69915d57d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 9 16:41:09 2012 +0000

    Added set_flags() and and get_flags() methods for the SMB class

commit 9d27274a2ad0f8395bb04c055b23119339e558b8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 8 21:48:29 2012 +0000

    Merge from Impact Engineering team changes to Impacket

commit 9f31cc6e39782887f0207337f1b67a67f2b9ae10
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 8 15:08:20 2012 +0000

    select_poll can be configured from SMBSERVERHandler()

commit a40db80c8cf1aa89d1578b02b151cc2b2ba19523
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 8 11:56:29 2012 +0000

    Simpler way to switch between select_poll mode and normal mode, in the __read function. Applying patch from Martin.

commit 0f8c83b083f4ce7a3641f543fd75144ed0842245
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 8 11:44:42 2012 +0000

    Fixed bug when handling old MSRPCHeader packets.. Now it should work with both versions

commit 1034ff6dea7744f2f8862bb66efa286647b589b3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 5 18:51:07 2012 +0000

    Fixed '=' for '=='.. dumb me :p

commit 5ab9271061e922f03ee27211ee62c17ce14facdb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 5 16:20:54 2012 +0000

    Added select_poll option, another way to make select of a socket

commit ee77f56d253bc9f2ab75858a368aec60b0195398
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 3 03:19:35 2012 +0000

    Added SMB_FIND_FILE_ID_BOTH_DIRECTORY_INFO and SMB_FIND_FILE_ID_FULL_DIRECTORY_INFO information level support for findfirst2

commit 5ed088613abbe491818bc8b468b7f522afd3733b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 3 01:51:57 2012 +0000

    Removed debug message and converted received share to uppercase

commit 1fed9fa238e5d148c815b363ec3bd9496deccc54
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 3 01:30:43 2012 +0000

    Added LanMan NetShareGetInfo call

commit 831c73f10758dad019cf0d518086cf1e936832d0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 22:10:54 2012 +0000

    Added support for extended reponses when client does a treeconnectandx

commit e78e84e44c39526a1a4791fc7bbb2cb637ad2209
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 22:09:43 2012 +0000

    Added SMBTreeConnectAndXExtendedResponse_Parameters structure

commit 5362f5f1ed0c42c529aec4d8d4773465fe23b383
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 20:47:21 2012 +0000

    Added SMBNtCreateAndXExtendedResponse_Parameters structure

commit 6734830b7ec96f024464c42431e991f92ed5a171
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 15:31:47 2012 +0000

    Added SRVSVCServerInfo101 and SRVSVCServerpInfo101 structures

commit 0ebf3d59f2f522ad9e7044ec79d3e69c4f239fa4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 14:04:17 2012 +0000

    Added support for LANMAN SMBNetServerGetInfo

commit 9046ab3d1548abb8cea24c8b8e2202d7d0630a2f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 14:03:26 2012 +0000

    Added SMBNetServerGetInfoResponse and SMBNetServerInfo1 structures

commit 9918b7b8fcbcbfaed493cf778fecf37b9bce11be
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 03:21:04 2012 +0000

    Minor changes on SRVSVCShareEnumStruct and SRVSVCNetrShareEnum1_answer setting some default values

commit f729ccdb964777e9ddf783e2b68356cbeb2fa4c3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 2 02:53:15 2012 +0000

    Small change to SRVSVCNetrShareEnum structure so it gets easier to parse an
    incoming request

commit 5fe0da82664d4b691c0bb23d8b1a00d0a7392b34
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 1 22:01:53 2012 +0000

    Small change to SRVSVCNetrShareEnum structure so it gets easier to parse an incoming request

commit 0d23860f1c95abdf58014d587407c955a590261e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 1 15:02:47 2012 +0000

    registerNamedPipe() receives an address instead of a socket. Socket is created/connected once a NTCreateAndX request is received.

commit 2643fab7d0c54ffe4d63b6d0f865f0a00130a11e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 1 14:15:27 2012 +0000

    Added transactNamedPipe() to smbserver

commit 979bc8c47b009ae9bc51ad4da461755c98608dc4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 1 14:11:35 2012 +0000

    Setting some default values for structures

commit 66868d46aec642b7744873a76f57b6bc8f1c4f4e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 29 17:49:25 2012 +0000

    1) Updated NT Error Messages strings.
    2) Changed SessionError Exception message format
    3) Changed SmbPacket (old version) structure to it also grabs the reserved field that is part of the NT Error Code

commit 1e5ee07ea0e380cb1bda83c0c13251551c0bbfdb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 28 23:18:03 2012 +0000

    Implemented registerNamedPipe() allowing to register NamedPipes (e.g. srvsvc) to a socket. Currently implemented in smbComRead/Andx, smbComWrite/Andx and NTCreateAndX (still pending transactions). Every read/write request will be sent to the registered socket, allowing to have a third party RPC Server answering those requests.

commit 88874e6765f8daba569247f83020e4309721bf74
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 28 13:03:35 2012 +0000

    Fixed bug where lm/nt hashes were cleared before sending the for authentication, actually breaking it. Thanks Bernardo for reporting this!

commit 19e479923c82f2f1e7a71180ccbc79f6af816a94
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 27 22:07:41 2012 +0000

    Fixes Issue: http://code.google.com/p/impacket/issues/detail?id=9
    
    Thanks to thebigguy.co.uk

commit b69f4d483e58d633142f33a2271c6576b6980417
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 27 20:59:10 2012 +0000

    Support for argument passing for StartServiceW(). Testing still needed

commit 7082864e8b863a16c005106915803d1cda36621f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 20:48:46 2012 +0000

    Added downgrade exception if Samba is also detected. If not some of those OSes, then raise the exception

commit 72e3e163603147323c7ab0e34a5ca5fddc8f835c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 20:39:08 2012 +0000

    Added doesSupportNTLMv2(). Now just downgrading to NTLMv1 whenever we find a target Windows 2000 (I gotta test Samba)

commit ef28649f3567ae74939da603a3987771ff3924b8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 20:38:00 2012 +0000

    When authenticating, now asks the higher transport about whether or not to use NTLMv2 (through self._transport.doesSupportNTLMv2()). This is the best effort we can do against old Windows systems (and probably Samba)

commit c69fe6587ac7de25ac63ee2dc08750ba47e6e91d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 20:35:32 2012 +0000

    Adding doesSupportNTLMv2() method so underlying RPC instances can ask for it when authenticating. Right now it would work only for SMB Transports since there is the only place we can figure out this setting.

commit 7a2c8c494691a6f3f089ff7780001a0c0f4f1d4b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 20:34:26 2012 +0000

    Using NTLMv2/V1 can now be set programmatically

commit 4a5b87d308d5e7c19e434cf94ccefbc2d7a4970b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 18:21:21 2012 +0000

    Using NTLMv2/V1 can now be set programmatically

commit 968b81c5c0b323a699ddd59f4228c4d5b4e201c5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 18:10:02 2012 +0000

    A few NT error codes added

commit e7d01b5b59b9dc8508afb21d97eebfbaaaa78253
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 24 18:09:43 2012 +0000

    Using NTLMv2/V1 can now be set programmatically

commit 4b7633fbb9b7242a883f37beeb29175c6b6c60f3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 23 21:24:33 2012 +0000

    If the server received a NetBios Session Request, it will answer with a NETBIOS_SESSION_POSITIVE_RESPONSE, meaning now this could be use in port 139 as well.

commit c7f4fdbfca6ea22398e6fffa743177de128afe95
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 23 15:13:44 2012 +0000

    Initial lsarpc implementation by Pablo

commit bf0225f6ef9d472481b7a39558b9aaac7c467a4f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 17 16:50:00 2012 +0000

    More custom settings if run on a win32 platform

commit 73ad20bb4ff2026866ee4237a9a79d89a2c21188
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 17 15:59:41 2012 +0000

    FIND_NEXT was missing a trailing NULL byte in the filename

commit 8abbe4b2ddd61263f758b67fbb67bd9879efbb72
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 16 20:37:47 2012 +0000

    Tweaked some methods to handle being used from a win32 platform

commit 87a412f8693da7662ed54a90ed2ff198d9480d17
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 16 19:43:40 2012 +0000

    Ability to specify and already crafted configParser

commit e7a2b6afe0cd794ce8fa38103fe053b38b9005b4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 16 15:02:22 2012 +0000

    If destination port SMB_SESSION_PORT and remote name *SMBSERVER, we're changing it to its IP address

commit 9df080feb015120c6b113bb18a28740ce81863c7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 15 21:48:05 2012 +0000

    If destination port != 139, don't use *SMBSERVER 'cause it will ask for the target netbios name, and that takes time when it's not really needed.

commit 65ea16a332a38574d4abfa82fc63e35765aad5ac
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 15 21:37:33 2012 +0000

    1) Added pipe disconnected NT error
    2) Fixed bug in TransactNamedPipe() when parsing the answer

commit 5e020bb6da9ce2891d29e41167420552bd4e6005
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 14 22:31:40 2012 +0000

    Fixed an error in StartServiceW() introduced in r455. Falling back to the original structure. Still doesn't parse commands, that's pending.

commit 60b871c3f573a92835f22a15e5d1cd56e9417333
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 13 22:04:26 2012 +0000

    GetMembersInAlias() now working.. needs some testing.. Interesting data in the answer['EnumerationBuffer'].

commit a91cc8b42a46aa749348fe5978963c9a17963311
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 13 20:10:03 2012 +0000

    fromCanonical method added to SAMR_RPC_SID() to simplify SIDs manipulation.
    
    e.g:
    
    sid = samr.SAMR_RPC_SID()
    sid.fromCanonical('S-1-5-4')
    str(sid)

commit 96521603a1ec1b616f76718f1641cb56437e5e82
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 13 19:22:55 2012 +0000

    Added:
    1) OpenAlias
    2) GetMembersInAlias
    3) SID Parsing and canonical printing
    
    Still need to be tested

commit dd7bb98ca08c8f1c4e776c8008d50fa50dbdd3e7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 13 13:55:02 2012 +0000

    Quick and dirty fix so it now supports bash like history (using cmd.Cmd)

commit 2965bb784992e62640b4304a6a113d5e8fb4ec6d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 22:34:23 2012 +0000

    Support for multiple answers for NetrWkstaTransportEnum()

commit 404d6b3d4b34c6992a0e108ace824a62ef65c079
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 22:33:32 2012 +0000

    Support for more than 1 item in the answer array (sometimes it happens, especially with w2k machines)

commit 33fbce54e6733ec28e055b6d25d95765696e8df2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 21:56:15 2012 +0000

    Forcing smbclient to use tree_connect_andx

commit 69d95c5a927354e50f6c04c3c61144162205d8c3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 21:34:54 2012 +0000

    Small script to test wkssvc.py

commit e7f4988c49c327b917207766aef9f065571410c0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 21:22:19 2012 +0000

    First implementation of Workstation Service. Implemented NetrWkstaTransportEnum() for retrieving target systems MAC address and Interface Information

commit e023c89b103c60f181e241c147df2929bed1bbcd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 17:31:30 2012 +0000

    Added EnumerateAliasesInDomain(). For now it returns a list of dcerpc.MSRPCArray
    
    We should port those NDR funtions to structure in the future

commit 836c36aa5a7aa3b5e68cea630411ab18bcd931e8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Feb 10 16:06:14 2012 +0000

    adding a self.rawData variable that hold the original buffer sent to Structure, so it can be used inside the structs to calculate lengths.

commit 48f5eb3cbc5031fe9947cbbed4f152119d8c1f64
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 26 15:19:46 2012 +0000

    Not retrieving the Strings if the call returned an error. It's caller's reponsibility to check that result as well whenever printing the data returned.

commit 44e06db64aa1881c2228a5a8be69d950c3a8ac20
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 26 13:22:26 2012 +0000

    Sometime the difference between bytesNeeded and the actual packet is less than 6, it's safer to go just for len(ans)

commit b594ba55562acb7fed3ad49ac4a147fef5ceb62a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 24 18:38:42 2012 +0000

    CONFIG option finished

commit a18479949db001252395a4232f7da0991c462a96
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 24 18:38:14 2012 +0000

    Added QueryServiceConfigW(), should work now.. testing needed.

commit e4638262d85e3e2f0e5a23811e08a68f4010c876
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 23 00:47:43 2012 +0000

    Added CONFIG option. Not yet functional, just used for triggering and debugging QueryServiceConfigW()

commit a1b9eccec6d5dbd21a7e6e8d65b35f3efd040044
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 23 00:30:26 2012 +0000

    More on QueryServiceConfigW().. still a lot of work to do.

commit 066d2fea0b9e9564e4f4da84547b81c6a9430b12
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jan 22 23:18:51 2012 +0000

    Initial version of QueryServiceConfigW.. It parses well the response data, except the QUERY_SERVICE_CONFIGW structure. Not yet ready for use

commit 09f522823ffa381764334b7ee3ccfd0a1d1e267a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 21 22:29:08 2012 +0000

    1) Added SVCCTLRQueryServiceStatus and QueryServiceStatus from Bernardo patches
    2) Fixed wrong StartServiceW opnum number from Bernardo patches
    3) Some work pending on StartServiceW handling arguments

commit fd639af8ce97f7ae56a4098db0c67c857a5116b2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 21 22:21:43 2012 +0000

    Added STATUS option

commit fe6d3957a0a159b099a29dfea151f5f3a3cfb418
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jan 21 22:11:40 2012 +0000

    Ok... more on EnumServices:
    1) StringsOffset does not belong to SVCCTLServiceStatus
    2) BytesNeeded was in the wrong position within SVCCTLREnumServicesStatusWResponse
    3) The returned buffer contains TWO pointers to the strings DisplayName and ServiceName

commit 8ade7964491f46abb6f27ec5483bb7e3db73300b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 20 20:07:33 2012 +0000

    Fixed bug in EnumServicesStatusW().. Figure out previous DontKnow field is actually the offset within the packet where the service's string is hold.

commit d36ea1de33324039c1e01d3a7f054776131f2ee5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 20 18:37:20 2012 +0000

    Merging Bernardo fix for services.py

commit 54668a8ba512a8c7baada71cf51c0b0409eed50d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jan 20 18:33:25 2012 +0000

    Merging fixes by Bernardo... StopService() now returns SVCCTLServiceStatus.

commit 610d0d200e1fd092e19c72d01cc7c5c17a341cf7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 19 22:28:06 2012 +0000

    1. DCE Fragmentation reassembly added to recv()
    2. Added checks to ask the upper layer for more bytes in case we haven't received a full RPC Packet (especially important for TCP/UDP transports)

commit ad4cb4896a7bfb72695336c268ef340ce6bcfe9b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 19 22:26:32 2012 +0000

    Added the ability to LIST services... just specify a random servicename...

commit 68e30891ebc28a92375b183ac5d11d3e94142121
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 19 21:34:23 2012 +0000

    Adding an option to recv to request 'count' amount of bytes. Especially important for TCP transports where we cannot know how many bytes we're receiving

commit 819096c7b0fe9cb7fd393d09509932dd9c42f8bd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jan 19 16:58:59 2012 +0000

    Second round for EnumServicesStatus().. it's now functional, but requires DCERPC reassembly

commit 811ff57d633b01b13c6d014f22d6eb3421c51da7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jan 18 20:34:26 2012 +0000

    Adding an option to transport.recv() to keep asking for packets.. needed if we need to reassembly fragmented RPC

commit 6a47304a3eb59ef2af247d11766d211f9f9bbe15
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 17 22:20:50 2012 +0000

    First round of EnumServicesStatus().. not yet functional.. gotta figure the packet out..

commit 9650b60e8ada4b4141092b22d79b8207f9120418
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 17 19:55:01 2012 +0000

    Fixed padding issue on WINREGOpenKey

commit 6df23f5f54abc2ae3b3494f2c9e6c32b381009ac
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jan 3 15:07:44 2012 +0000

    For backward compatibility, when no server_name or domain we will return '' instead of None

commit 9ea71ed53154e47466536b7747a479d927429963
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 22:56:16 2011 +0000

    If *SMBSERVER is sent as remote_name, we will try to get the remote NETBIOS name(via a getnodestatus) to help succeed the connection. If unsuccesful, we go with*SMBSERVER and hope for the best

commit 8e93819290d9d1d1d4b371dd30d0d84f948dbf5a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 22:55:02 2011 +0000

    timeout variable wrongly passed to the underlying NetBIOS layer

commit fd0285a615693077a2ae105bd8cf102cf1b9eb90
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 22:51:37 2011 +0000

    Fixed wrong padding calculation on a BindACK packet after the secondary address answer

commit 84656f1fad43c2e7107367f14cb6c33c3a2aef55
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 22:50:14 2011 +0000

    Removed since it has been replaced the old dcerpc.py

commit a46b751075de7737e99a39c9d9fe5b4c5ff6c580
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 20:04:24 2011 +0000

    Removing bogus test credentials :-|

commit 941269eeb02531ae6270846441bffd74d0f90426
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 20:03:24 2011 +0000

    Adjusted to work with latest dcerpc.py

commit 3840a4393ac93fa61ab2336913c1ce18f5b22f94
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 19:30:37 2011 +0000

    A basic implementation of the SMB Relay attack first published by cDc

commit fae2eaa80c2ff2c4cf66eaf7a06bd7bc595b10b4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 19:18:10 2011 +0000

    SMB Server example

commit a82203d1a25905ce736b0d80f5bc737454b0a493
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 18:29:13 2011 +0000

    A basic SMB Server implementation in Python

commit 22fbf53c239f3efc4ab74aa4ead09452ac2ae99b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 18:12:07 2011 +0000

    Using the new DCERPC.py library from now on.. supporting all flavors of NTLM (including fragmentation and encryption).
    This update BREAKS backward compatibility with the old dcerpc.py

commit 612a245c4bbb615bbad65663001b63fc332d5b23
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 18:09:55 2011 +0000

    Reverting previous commit and going back to revision r428.

commit 5a095bd87576872804a2288ab2e3f5912069f76a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 18:06:02 2011 +0000

    Reverting previous commit and going back to revision r428.

commit e4dc6ca3e090b681b6abc02579ea007ed700c680
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 26 17:56:50 2011 +0000

    an SMB Server implementation in python

commit 1982fc10440104ca78c15b92ca372a792a7a45d8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Dec 23 21:31:41 2011 +0000

    Fixed alter_ctx handling. It wasn't honoring the right ctx when issuing the next bind call.

commit 1f9b1c0239ffd0fb1df18a070e4a44b515081066
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 22 21:15:17 2011 +0000

    Building an old MSRPCHeader() for backward compatibility

commit 27286086447143d0d24b2ec76ae79b4748d3b46e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 22 21:08:01 2011 +0000

    Leaving MSRPC_NOTAFRAG flag for backward compatibility

commit 7adefefcbceb6c53aa490d7f91743c37c8ec58e7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 22 12:18:06 2011 +0000

    RawCall class now belongs to this file

commit 5c8327672666d1e9136280fc9316fdc4f792f127
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Dec 19 20:25:36 2011 +0000

    Improved get_server_name() and get_server_domain(). It now gets the info regardless of successful logon

commit 9e353a0eaf3b9577b3da08d38752bb6d71f97e86
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 15 22:16:30 2011 +0000

    Due to different dialects interpretation of MaxRawSize, we're limiting it to 0xffff

commit b073736474fb6fd7c0c1cb241e65a9b31f2ab99f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Dec 15 19:23:19 2011 +0000

    Don't break login method if hashes are sent in binary form.

commit ced703fcac8daa349597d1054c127b4790bbe1e2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 14 20:00:36 2011 +0000

    fix in uuid import forcing it to use the impacket one.

commit 9e5c9ece19837a1fdee0af5571ba66dedcf00771
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 4 19:57:22 2011 +0000

    1) Fix a bug when bogus_binds was selected (lack of a tuple)
    2) Now the bogus_binds UUIDs are randomly generated

commit aa24cdc737717404f90eaac4ce67b7ef0e4f64ed
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 4 12:34:31 2011 +0000

    A better way to solve the Deprecation warning issue in structure.

commit a1c557fb97f81b4ab28d7c9a4e3fdfabfe2dda5e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 4 03:24:32 2011 +0000

    Fixes the 'DeprecationWarning: struct integer overflow masking is deprecated'
    error produced calling to id().
    More important now that python aborts when such error happens.

commit 2a47ee73bdc9af8ed4b3cb6bed9adfc01a50cc04
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 4 02:54:30 2011 +0000

    Fixed MSRPC packets __init__() when initializing structs with receiving data

commit d321dbb664b1fe576522b1ff387662327bb62c5e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 3 23:10:04 2011 +0000

    Added NetprNameCanonicalize() call

commit cce536b773f6a7136293f4a827507bc6003d2a83
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 3 22:46:30 2011 +0000

    Added NetrRemoteTOD() call

commit c39b6c4693fd5c56a4582de775a5406488f15b12
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 20 21:40:09 2011 +0000

    isValidAnswer should check if the error received is a NT one

commit 25f37aa73fc16921b8db4a36a681d6680eaaecd1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 20 21:34:15 2011 +0000

    Fixed list_path so it now:
    1) Reassemblies transactions
    2) If FIND_FIRST doesn't return all the data, call FIND_NEXT

commit 695e1404d51b68535fb9c2ba9d92f8509e94fa7a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 5 20:12:53 2011 +0000

    dcerpc/dcerpc missing in the import sections, making some methods to fail

commit bdaa265cf5ee47022518d71420177e78f0bdd455
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 30 18:22:40 2011 +0000

    If ServerName not available when logging in, set it as Unavailable

commit 9a87a5be79348727b19056a29746bd073d151921
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 30 18:09:52 2011 +0000

    Storing server's information before sending the AUTH package

commit 075edfacf82f04a06f70265df0b25df6140ae70a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 30 17:59:27 2011 +0000

    If we created the SMB connection, we close it, otherwise that's up for the caller

commit 7058c2d9aa546d1896123659cdfeb7c39b166071
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 28 23:18:52 2011 +0000

    Lowering connect timeouts to 10 seconds

commit 9f80410c2c3a35b51e1cabf6621d8cd4b04186d9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 28 23:16:22 2011 +0000

    Replace debug stuff in signSMB with original code

commit 64f84b7b07dd35353f1e89517959a5dad47e5a3f
Author: pditincho@gmail.com <pditincho@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 8 21:15:21 2011 +0000

    Addition of support for scoped addresses. Addition of test case for scoped addresses.

commit 2371d945ade3d210553d3d76e27ab5ba0f2aaae1
Author: pditincho@gmail.com <pditincho@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 8 21:02:29 2011 +0000

    Bugfix - Constructor of IP6_Address now accepts a unicode string as a text representation, apart from just a regular string.

commit c6d0dccedae2911cf9bdc99ca48be859dc289d01
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 12 18:29:38 2011 +0000

    1. Added flags and packet types according to the standard
    2. InterfaceId is gonne, now we handle the uuids using uuid lib
    3. Added more rejection error codes
    4. Fix typo on SupportedVersions MSRPCBindNack struct
    5. Fix not checking reject reasons for bogus binds

commit ddf962fc7e0a5531388411aa9c5efc2374bb7e94
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 27 21:41:33 2011 +0000

    Remove the self._uid if the login was unsuccessful so we can try another login in the same existing connection

commit 13d082eabcd5221bd8140f28c78d64a178408512
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 27 00:49:32 2011 +0000

    Typo :)

commit ff25c78aa9823f38cd02346c713f99a44814e249
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 27 00:46:37 2011 +0000

    1. Fixups imports
    2. SVCCTLRespDeleteServiceHeader should be based on ImpactPacket.Header

commit e9968ab3e92c3c2e97e0200b02d4bd4591f53441
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 25 22:15:32 2011 +0000

    New dcerpc structures.
    1. All packets are Structures (no more ImpactPacket)
    2. Support SIGN/SEAL for all NTLM flavors
    3. Fixed bugs on fragmentation, now should work fine
    4. Fixed bugs on bogus_binds (doesn't throw error for the bogus binds)
    
    If you want to use this, overwrite the current dcerpc.py with this one.
    
    After further testing i'm replacing current dcerpc.py with this version.

commit 9ecb66eb02b43938886d643a2b3578b21f06befd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 25 19:57:38 2011 +0000

    Fixed the testcase with the new parameters to SEAL and SIGN

commit cad13332e6383535f464f1d8011e2958209239f7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 25 19:22:09 2011 +0000

    The special case for anonymous login was taken outside KXKEY.

commit a347c8992f898f3c59ac4d4df2f16d603e1bd582
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 25 19:11:29 2011 +0000

    1. Changed SEAL parameters, we need two instances of the packet, since encrypt and sign for NTLMv2 uses different information
    2. Special case in KXKEY when no password is set

commit 23f42eba04fbcf9ff80085662983cd1651974ede
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 25 02:42:08 2011 +0000

    Flags are maintained all over the session

commit 97a89e6ee430d1cb7e3fa28de716aa7e42a21281
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 23 19:26:10 2011 +0000

    Changes on the tests. The tests are actually giving OK results

commit 9cb0f1c55f11e750dcd202121ce90d1da3034acc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 23 19:25:32 2011 +0000

    More changes to SEAL/SIGN.. still not used and still not working (it only works on NTLMv1)

commit 00ba16dfcc3d142d387d644b4bd53c146895145b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 22 16:23:23 2011 +0000

    Check and report Bind errors except for the bogus ones

commit 5d91ed204df1814fe4a9217af1b871ebd5893ab7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 21 20:36:08 2011 +0000

    Small example to start/stop/delete remote services via svcctl

commit e5a2a308fdecdd3128d5c7012842e8acf5ad6409
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 21 20:29:46 2011 +0000

    Fixed typo in ACCESS_DENIED

commit c8b90a528dd363536dbf0cae22901a0c9cf64f64
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 19:30:07 2011 +0000

    OpenServiceA function added

commit 11a1db04bb96c9967f6559977c99161e073e3551
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 19:18:06 2011 +0000

    Changed 'w' for NDRString*W to make it easier to use. *W() functions expect unicode data

commit 65399eb5c22f9d575cf809a738bd91e674582778
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 19:16:58 2011 +0000

    NDRStringW and NDRUniqueStringW structures added

commit f9c0dc81b620f0444ba84ad155291e4c075c595e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 15:13:15 2011 +0000

    Removed checking for error in doRequest.. that's up for the client

commit 4d522e77e873212e3c836835a106c64fccdce744
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 14:05:00 2011 +0000

    SERVICE_INTERACTIVE_PROCESS flag added to CreateServiceW

commit 2bbc6ee6bd7d514b6bbbd6ec7bfb3905b0cbcdb5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 19 14:00:14 2011 +0000

    Added SVCCTL CloseServiceHandle(), OpenSCManagerW(), CreateServiceW(), StartServiceW(), OpenServiceW(), StopService() and DeleteService().
    Similar functionality was already in place, but now all with Structure (plus fixes some bugs).

commit 0bed17270e8963cecf7f53e7a2ec9fb542783c36
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 17 23:12:05 2011 +0000

    SHARED_DISK_HIDDEN type added

commit 89d4f53e287bebdd18d014a64059866fedd4be3f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 17 22:25:48 2011 +0000

    default port changed to 445
    increase timeout to 10 seconds

commit 5c96547e6fda093623ebf5a4e9d9b97d2a6f7df3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 17 17:39:56 2011 +0000

    Added isGuestSession() method.

commit ab8fb8a56dfe365e6ce49ed67c3273cb2cf6fa73
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 15 23:51:39 2011 +0000

    Added get_encryption_key() method

commit 8ef53d95f1bf71800e4a14183ad44bd7db13b054
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 15 18:42:58 2011 +0000

    Fixed NTLMAuthChallenge in the situation I sent TargetInfoFields not as a structure but just as pure data

commit ba643c0a4190e241284ad572a26a96758d9b29ca
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 13 21:17:30 2011 +0000

    TRANS2_SET_PATH_INFORMATION structure added

commit 2a7a537a1c4635a5e79e5031de356a5d06af9898
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 12 23:16:15 2011 +0000

    Fix in SessionSetup structure to be able to unpack it

commit 267633f25d61f4399973b3d1d7a318daeb6d29c6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 12 16:44:54 2011 +0000

    NetShareInfo structs added, for later use of list_shared()

commit 9ce99b85e62986e3c5609fa1d64219fb4e2edd3c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 12 13:38:24 2011 +0000

    Added Transaction_SData structure

commit 28658628b8fb55072a62897de48c0d20b901dc13
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 12 12:08:35 2011 +0000

    SMB_QUERY_FILE_EA_INFO structure added

commit 96f9507e6039ad20bc83f3785b85c01a2b00c509
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 12 00:44:34 2011 +0000

    Added SMB_SET_FILE_BASIC_INFO and SMB_SET_FILE_END_OF_FILE_INFO structures

commit 8647dd74c9cc328c6951fc39b6cdebf21562c0fe
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 9 21:54:07 2011 +0000

    Added TRANS2_FIND_NEXT2 and SMB_COM_TRANSACTION2_SECONDARY structs

commit 68093fcc22a51aedfa0c98f96b07d9aa2c44b788
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 9 00:04:22 2011 +0000

    Changed *Time fileds for CreateAndXParameters to 'q' size

commit 87b3471cca4c2cbcf0e08be743312eff6942844a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 7 17:37:04 2011 +0000

    TRANS2_SET_FILE_INFORMATION structures added.

commit 5e55c844cdd65caeb170f94cf858cfede19273f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 7 15:36:29 2011 +0000

    SMB_COM_DELETE and SMB_COM_DELETE_DIRECTORY structures added

commit 39bd64942a2eaa424f7165bbfb084c55c7eefb50
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 7 13:26:51 2011 +0000

    Fix typo for smb.FILE_SUPERSEDE

commit 4ff68ca41698372a84a9b7f7dbca461494202c25
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 6 16:23:17 2011 +0000

    1. SMBWrite and SMBWriteAndX structures

commit 42aea7797cfa7bc8743842a7957c9b2e885e61f7
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 5 22:28:01 2011 +0000

    1. More structures added, no functionality changed

commit 97e3bc463c2da534e5f09c0ab5ce56225f9db371
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 5 02:13:41 2011 +0000

    1. Added SMBReadAndX_Parameters2 structure

commit c1a18064572ddd85b6064f9dea89dd68d9f73670
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 5 00:55:54 2011 +0000

    1. Added structures for SMB_COM_QUERY_INFORMATION2 (0x23)

commit 988e3b5ec5f4b866bfbdbd0cce4ecece55ac70ea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 4 20:55:37 2011 +0000

    1. Added constants and structures for various transaction functions

commit e29f3ada2a03872d87902023d1c2bd30d5ab37b0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 4 00:51:18 2011 +0000

    1. Added SMB_FILE_ATTRIBUTES
    2. Added QUERY_INFORMATION levels
    3. File System Attributes
    4. QUERY_FS Information Levels
    5. SMB_COM_QUERY_INFORMATION

commit 613b3c71c737a5eabcf1f3a65c6267c57fe0f08e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jul 3 20:20:48 2011 +0000

    Structures added:
    1. SMBTreeConnectAndXResponse_Parameters
    2. SMBTreeConnectAndXResponse_Data
    3. SMB_COM_TRANSACTION2
    4. SMB_COM_ECHO
    
    SMB_COM_LOGOFF flags

commit 4cc88d332266c57083de3229d2a08cd4e1cd8949
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 2 19:09:09 2011 +0000

    Comment for TREE_CONNECT_ANDX

commit 521d30f9805b9f4ad63a0b4e3d1517a78dba10e3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 2 18:55:53 2011 +0000

    Added support to parse SPNEGO structures if acting as a server

commit 9c46f8b4d515a4c649b3333bf3786a23fa2a4d43
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 2 18:55:20 2011 +0000

    1. Version and MIC now handled in NTLMChallengeResponse
    2. NTLMChallengeResponse.fromString() now work as expected

commit 65b58a498afa49613db2a917b1484d3bea0cdb13
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 2 00:00:56 2011 +0000

    NetBIOSTcpSession also accepts connections already established

commit b0a20ceea688f22996a0cd6dde20a4c3216cc1a2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 2 00:00:10 2011 +0000

    SPNEGO now decodes MechTokens if available

commit c42ef0d35b129550a6441d8fe65e00096780abff
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 1 23:59:02 2011 +0000

    AuthChallenge.getData() wasn't returning any data ;)

commit 9b57d86b7d9ad2e54ac79527fe8ac72ebcfefd69
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 30 21:49:46 2011 +0000

    isDCE instead of struct_type... more descriptive

commit 969a1d2c63364382e02f2cf370b9e2e657aba5f6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 29 15:19:16 2011 +0000

    get_server_name() now works for extended and non extended session security

commit fad6e704d83ac071ab70316df4e550329a3fd59e
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 29 14:47:54 2011 +0000

    If port 445 and remote_name == '*SMBSERVER' -> remote_name = remote_host

commit 75402b57d8766e474807a78e791fb98a140c48aa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 29 14:19:49 2011 +0000

    Updated the testcases based on previous commit changes

commit 3a595b57ba6cb288aee22402115852d3e17fcebc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 29 14:19:06 2011 +0000

    Changes to SEAL, MAC, and SIGN to adapt them to DCE Signing

commit 5899837dfe0d347ac1e0fc3e1b052a6350e54ee5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 27 19:31:24 2011 +0000

    Adjusting the data received based on previous commit. Now it does getData()

commit 382d4324d29026bb2cdf880b8755121a0ade29c6
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 27 19:30:23 2011 +0000

    1. Added classes for DCERPC_NTLMMessageSignature
    2. Commented exportedSessionKey key weakening, that shouldn't be needed (I'm leaving that on until further testing)
    3. MAC() now received a parameter to construct the right structure if DCE is underway
    4. MAC() returns the structure instead of the data

commit 0c2880a76b4f911841b449a93ce4352a30e4f6cc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 02:28:13 2011 +0000

    Done.. all the sealing/signing tests are working now.. Time to put it working in real world

commit 7d4602c1800c5a0a48d089f52cd219daa7720d3d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 02:23:44 2011 +0000

    handle_seal should be used for message signing if also sealed. Yes.. confusing.. but that's what the documentation says..

commit 5d8bc3a42c3df577d88478a7237bd530ff3a14c1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 01:01:45 2011 +0000

    Since SEAL does SIGN as well, we should set the right keys and handlers for both situations

commit c76276300efa58eab916943b026c059723f9275b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 01:01:01 2011 +0000

    Still working

commit 2c350d6dfadf6f81571620a4cdd8edc5eefa09fc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 00:52:51 2011 +0000

    those damn magic constants must be asciiz

commit a79ab822c4441f05f6afef7faac8d72f58ac9471
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 25 00:51:23 2011 +0000

    Still working on this

commit 0efd5976665a79e63bbd71fdead0e7056bd07d14
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 23:23:49 2011 +0000

    keyExchangeKey should be available even if no KeyExchange is performed

commit 7685479e4479f2a47f858e07937e7bc7592f409b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 23:08:26 2011 +0000

    Adding the sealing/signing stuff tests. Not yet finished

commit 757093d2deac88388b13dde779de2fb80fb2c134
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 23:07:55 2011 +0000

    Added exportedSessionKey to KeyExchangeKey if no KEY_EXCH set. Double check this with tests

commit fbeb4b66b487f75ca33fca3b14c18d781a66b147
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 23:03:47 2011 +0000

    Added functions for the ongoing sealing/signing stuff:
    MAC()
    SEAL()
    SIGN()
    SIGNKEY()
    SEALKEY()

commit a1f700b7b684bf66ad78f339910551b1c175c598
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 22:59:07 2011 +0000

    Left some commented lines for the ongoing work of supporting signing and sealing with all the NTLM* flavors

commit 6ed442d36e5c4c0aee3c7b8c5a75f818103eb4af
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 22:56:26 2011 +0000

    Lowering the timeout value in case the target host dies in the middle of the connection

commit e212f513ec24c44da2fbfa81a4a5bcc96f6d450b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 24 15:40:57 2011 +0000

    1. Moved all the NTLMSSP logic into ntlm.py where they belong.
    2. Created high level functions getNTLMSSPType1 and getNTLMSSPType3 that are used by smb now (and in the future dcerpc)

commit 37eeabe4d230bca843c0f1f9e1e34fac6c963223
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 23:05:33 2011 +0000

    Checking of more flags in place. Next step is to take all the NTLMSSP out to ntlm where it should belong so other modules (e.g. dcerpc) can use the same code

commit ae79e43b7d846de8c67a1f1e5d467388bc5e49d4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 22:23:57 2011 +0000

    Adding domain to get_credentials and all the instances of login

commit fb1fc0b4e7b7b493add39dcc84d08ae260875648
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 21:34:36 2011 +0000

    MessageSignature structures for future use on signing and sealing

commit 5763b0c41a2a4f06ffec272ce8df7df0b42876f8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 20:54:38 2011 +0000

    Adding domain to set_credentials and SMBTransport

commit 8dc369897c4eaeae226e6a1818ab44ea52c5e166
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 20:15:28 2011 +0000

    Adding domain to set_credentials and SMBTransport

commit 65c78e6d46c8dc6fefc19b39113a036d50016db8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 17:31:50 2011 +0000

    Changed all instances of AF_INET for a getaddrinfo() so we can handle IPv6 addresses

commit 88f886a362518a70018719192f8f97226df32ed5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 23 14:20:18 2011 +0000

    1. Removed md5, no longer needed
    2. Added verification of the returned flags when negotiating capabilities, so the right encryption key is generated (128, 56 or 40 bit)

commit 5fa8d125620a5812314a55bb77474ff9a1e35382
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 22:17:22 2011 +0000

    0008-Add-opdump-a-tool-for-scanning-for-operations and
    0009-opdump-handle-closed-connections-properly from Catalin.
    Thanks!

commit f6e953b9414452624435c2f3d89c94911d084cc4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 22:15:20 2011 +0000

    0007-Add-ifmap-a-tool-for-scanning-for-listening-DCERPC from Catalin

commit 84b0e4aa38d66ac55635ad34698835de0146c731
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:56:24 2011 +0000

    0006-Implement-Remote-Management-Interface-in-particular from Catalin

commit 4aff752ffb544b91087625f3647625a15db3ac47
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:52:31 2011 +0000

    0004-Make-an-Exception-subclass-specific-to-dcerpc-for-ex and
    0005-Fix-parsing-of-the-BindAck-response-and-check-result from Catalin

commit dbb6ee5415ee1999cea0eb1b19dcb5af0f5545cf
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:36:20 2011 +0000

    Accidentally committed this. Reverting back. Still pending solving the issue of establishing a good connection against newer OSes where *SMBSERVER doesn't work anymore. In any case, I don't think this is the right place to patch tihs.

commit 5f5f170fe35c02aa6d0b6b27d1408419c5e82897
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:15:43 2011 +0000

    0003-Add-some-more-UUID-parsing-formatting-helpers from Catalin

commit f4c271a9616ee6aff88b0dc0d7b255f9419f6199
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:12:25 2011 +0000

    0002-Move-KNOWN_UUIDS-to-module-scope-so-other-modules-ca from Catalin

commit fe139b2ef4d323e9ddc9c3134ce2b769e92aedbc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 21:07:04 2011 +0000

    0001-Fix-some-typos-in-the-KNOWN_UUIDS-list.patch from Catalin

commit 8e3c1cf68bdd5c53c61b4e80c44e1d1205eac1b5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 20:13:00 2011 +0000

    1. Share's comments (remarks) were not aligned with the sharename

commit 4935f064c9862c5b62e3868ec9394b1498d1f5b5
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 19:40:05 2011 +0000

    ntlm USE_NTLMv2 back to True
    2. neg_session must use self._dialects_parameters['Capabilities'] to decide extended security

commit e5ffe53c4f5b10af9b31569908fe3bd293fd0e7d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 18:53:01 2011 +0000

    Clarifications to run the tests right

commit 1feb7e9c15f1867fd68351f70522406e373dd191
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 18:50:49 2011 +0000

    Signature related stuff.
    Added the aTime to the av_pairs if not received by the server (old Windows)

commit 25a4110d0229fab8e6d6c0649352716f9184ac5c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 14:36:00 2011 +0000

    Support for SPN name validation added

commit 3a83810cf7072eb3064bfff699aa937bc33864a8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 14:16:07 2011 +0000

    Now the library signs SMB if it is ENFORCED by the server (Local Security Policy -> Local Policies -> Security Options -> Digitally sign communications (always))

commit cceb77a570548c175e31b29c224b783285b1c9ea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 14:11:11 2011 +0000

    Fixed setting the right values for the computeReponse* response

commit 6d2611f2aea73f3889a9df01cc49b403fa7de57a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 13:36:49 2011 +0000

    This was the problem why NTLM2 wasn't working. Now all the auth methods work

commit cfc32b8a328e04eb08495d9509713c98d8c3aca1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 12:33:38 2011 +0000

    Changed the arguments for computeResponse* based on the changed previously made

commit 49b24eac42d3fc5d479050e798a52388e5aff191
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 01:51:04 2011 +0000

    SMB Signature is working.. verified. I'll keep it disabled tho.

commit 6c6e96f623e412f6953cf12026ccaf58aaf59517
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 22 01:18:33 2011 +0000

    1. Ok.. almost done with the NTLM saga. Depending on the USE_NTLMv2 global variable, when calling computeResponse, it will either go to NTLMv1 or NTLMv2 (and calculate the different values depending on the flags set, eg: NTLM2). There's an special case when authentication doesn't work against a Win7 and it is when using NTLMv1 with extended security, I guess that has to do with the fact that the other side is expecting NTLMv2 instead of NTLM2. Further research is necesary (if someone knows this let me know).
    2. SMB signing is now working but disabled. It will be enabled in the future only if the target requires it (win 2008)

commit b8549c9a6330e6dbd02cc4c50e1afa0185d93005
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 21 23:20:16 2011 +0000

    Fixed minor things.

commit ced6159a7055ca68a093591a7a42dee724a60be2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 21 22:45:34 2011 +0000

    1. Checked everything with the MS-NLMP examples. Just one (4.2.2.2.2 with LM_KEY) to fix (not a big deal actually)
    2. Added the USE_NTLMv2 global variable to ntlm.py since that's not something to be negotiated by the client/server
    3. computeResponseNTLMv2 changed to computeResponseNTLM2 (better name, reflecting what's going on actually).
    4. Commented out a lot of things on NTLMAuthChallengeResponse.fromString(). I don't think we need it, but left there just in case (too much for today)

commit 633c27fd6d7de150b381929a2b919a6237870c77
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 21 22:38:34 2011 +0000

    added serverName with the AVPAIRS in there

commit a9a26927311e9c8f471348e0de01cb4e0aea0167
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 21 22:36:27 2011 +0000

    Test case based on MS-NLMP, section 4 - Protocol Examples

commit 5dd17c26469761865b318ace90e310ff491de8a0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 20 22:49:17 2011 +0000

    Just commented the signature check. SingSMB is correct, the problem seems to be when generating the encryptedRandomSessionKey. Maybe KXKEY is not doing things right. Gotta research more

commit 3e2c341125f177e39b3cfb6909b0f66c65d587f1
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 20 21:58:07 2011 +0000

    1. Added more stuff for SMB signing. Still not activated since it's not yet working

commit 4e5c71b6ff81bab243b7bf209a7293ab5d23afd3
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 22:07:56 2011 +0000

    1. *_Data structures base class must be Structure (it was working anyways, just for the fact of putting things right)
    2. rename() and mkdir() now uses Structure. Added classes for those and changed functions

commit f8ed3e7fec1dd144be99ca1bc43f7fd89501be10
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 21:26:49 2011 +0000

    LogOffAndX now with structure

commit 56b827e6f6be16a24bac7237b22d9d58d51c86b2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 21:14:03 2011 +0000

    Removed unused function __decode_smb

commit 258624b87c93504e8c962b07d9847d1adbe4198c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 21:06:15 2011 +0000

    1. Removed TRANSHeader class, replaced with structure
    2. Removed use of TRANSHeader in dcerpc/transport, replaced with SMBTransactionResponse_Parameters structure
    3. Created SMBTransaction* structures in smb.py
    4. Changed TransactNamedPipe to use the new structs

commit ef72ba9a2a82ba580cd1200520c4415e7f4a31d4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 01:43:40 2011 +0000

    1. Implemented SMB_COM_TRANSACTION using structure
    2. Changed send_trans to do so
    3. Removed __trans. Old and useless
    4. Removed __browse_servers, browse_domains and browse_servers_for_domain. Those methods didn't work, and, besides, should be implemented in SRVSVC (setting a ODO there)

commit 68fcb42731637069c641de1244cb98a63166361d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 00:28:20 2011 +0000

    SMB_COM_CLOSE with structure now

commit e067cae466bec2ab0e9126254f4c11528f9b4c8c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 19 00:09:23 2011 +0000

    stor_file now uses write_andx with structure. Still left stor_file_raw

commit a774d94fc22a13a912a84c3d16cb482ac0ae4a07
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 22:39:52 2011 +0000

    One NT Error added

commit 0fd5072ec1671f8cbd7287c7baa2141e152cf644
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 22:36:30 2011 +0000

    Variable initialization missed

commit d45e7a5fcddc308e092a5c1a24ea3cf3a0b340ae
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 22:27:14 2011 +0000

    1. Removed NTLMDialect class. Now replaced by _ntlm_dialect_parameters and _ntlm_dialect_data (all with structure)
    2. Changed all references of _ntlm_dialect to the proper new schema
    3. Added parsing of ServerName and DomainName in SMBDialectData. Extra careful data might not be there (e.g. some Unix systems)
    4. Updated the get_server_time method now using _ntlm_dialect_parameters

commit e45987be77ad5c44677205b92e9a4e5c90295b9b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 18:22:02 2011 +0000

    removed set_key_odd_parity. Not used at all

commit 5c711c2e20d337feb25ac5f196de07f38fa45ff2
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 18:16:00 2011 +0000

    Some beautifying of the source code.

commit 840cbd614195d3ed53ce7a91b96d2816524e0828
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 17:02:31 2011 +0000

    If hashes were passed to a dcerpc transport, now pass the hash is going to be performed as well (only in NTLMv1 as this is the only auth supported by dcerpc)

commit b06f86f6ec492fc59acdc3fa8cdc93a8da857053
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 00:54:10 2011 +0000

    Fixed correctly handling NULL sessions in extended mode

commit 32799720ab604db2a86d5428fcbc276f0f38b135
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 18 00:38:13 2011 +0000

    Fixed correctly handling NULL sessions in login_standard

commit a503056226a222db1a7d8eee40892a7d4d9238c9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 22:55:44 2011 +0000

    1. Removed the SMBExtended class. That shouldn't have ever been there.

commit 2a72b1bb7056626cdfba62c1f631f502546d5b3a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 22:50:41 2011 +0000

    1. Removed login_pass_the_hash and login_plaintext_password functions. No longer needed
    2. Turned on by default extended_security. Now the library tries by default to connect to the targets using extended security and NTLMv2.

commit a5ff88db15debdb2c3668192710f5f2c601d721a
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 22:48:07 2011 +0000

    1. Added some NT Errors since we get those ones when using extended security
    2. self._dialect_data to be the default in the future, still most of the code using self._ntlm_dialect
    3. Remove an assert since now we do NTLMv2
    4. Session key generation for NTLMv1 now in place
    5. Reorganized code in login_extended
    6. login() now goes to either login_standard or login_extended, and passes the hash right away to both functions.

commit b50d20cdfe81306623e3377103545506c636b4e4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 22:42:19 2011 +0000

    1. NTLMv1 (simplified) algorithm written. It actually calls some of the previous functions.
    2. Minor changes to functions names

commit 18c6bac732bfbc141f6759db15783d3a313ce717
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 19:59:19 2011 +0000

    1. Changed NewSMBPacket structure so it now has the SecurityFeatures (signing) field (in preparation for SMB signing)
    2. Added SMB_SIGNING constants
    3. Added singSMB(), does nothing now

commit efed798f2058074eb638d6c79efe8ae9dc789221
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 19:54:57 2011 +0000

    1. Making pass the hash work with NTLMv2 - done

commit afe54eff4dae3c2d3a1dca34257612d4487febe4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 17:08:26 2011 +0000

    1. Now the client requests KEY EXCHANGE and INFO TARGET (the later needed for NTLMv2)
    2. Added the logic to call the KEY EXCHANGE functions previously committed to ntlm.py

commit b21111af0fa0f3b89f56e49d469e071a39615ec0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 17:06:54 2011 +0000

    1. NTLMAuthChallenge now correctly handles servers that don't send Version Information
    2. NTLMSSP_KEY_EXCHANGE now supported. Key is calculated and send to the target Server
    3. Generate a FILETIME structure if the server doesn't send one, to complete NTLMv2 auth.

commit c9dbcb85617853952cbef5456874686bf43aade8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 02:22:05 2011 +0000

    1. Completed the NTLMv2 support when extended security is used. Still not default.

commit ca6e0be0a36a4a0999bd5586fcbc1e9a96f8b4ab
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 17 02:15:43 2011 +0000

    1. Minor fixes on AV_PAIR so unpack/pack works well
    2. Fixed the NTLMv2 algorithm, now it works.

commit 861befa380623e13ebe7ebb2e11293c74f2d6f66
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 16 23:14:33 2011 +0000

    Added handling of NTLMv2 (still not working) when treating extended_security

commit 127dfa5ea29c06c3218237e6e5eb9368c0adcd4b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 16 23:12:22 2011 +0000

    Extra verifications just in case there's no TargetInfoFields in the packet

commit cab17fe14299108b156cc5be2cac6de5b15c17b9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 16 23:09:20 2011 +0000

    1. Added AV_PARIS structure
    2. Added handling of AV_PAIRS to NTLMAuthHeader
    3. Added NTLMv2 algorithm (still not working)

commit a072ed355cd3e08b18651a609706d8fad0192afa
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 16 19:19:49 2011 +0000

    Completed the NTLMAuthChallenge structure. We need some items there to do NTLMv2

commit 6e06bed8f7cf8c1e0aa43184ac23d3eb6581fb76
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 15 22:26:10 2011 +0000

    Defined TypesMech to map string names to UUIDs

commit c07fa29622702e85e44fdf6777aadd5a4f4557bc
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 15 17:39:50 2011 +0000

    binascii.crc32() can return negative numbers, they must be properly packed as integer (not unsigned integer)
    
    also changed to integer (instead of long) so in 64 bits platforms they are still packed as 32 bits

commit 10c548427896cf75765b715d957ed838e69c9324
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 15 02:17:00 2011 +0000

    1. Fixed the INVALID_PARAMETER issue.. the Uid was missing from the previous packet. All done.. but still disabled until further testing is done.

commit 5faa5c8864d6fa09e87f52c24fc793045ba86326
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 15 01:20:02 2011 +0000

    1. Implemented SPNEGO_NegTokenResp()
    2. Fixed bug on SMBSessionSetupAndX_Extended_Data SecurityBlobLength calculation
    3. Added SMBSessionSetupAndX_Extended_Response structures
    
    Still all the new stuff is disabled. Pending figuring out why the server is responding with INVALID_PARAMETER when sending the last NegTokenResp. Could be a flags problem.

commit 5ecff4660a1eb2ce7c114ca6d73b476dcb4ab5eb
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 14 21:47:47 2011 +0000

    1. Added SMB FLAGS and FLAGS2
    2. Changed existing ones (LONG_FILENAME and USE_NT_ERRORS) to (LONG_NAMES and NT_STATUS) per specification's document

commit cb6cac766a59ab16627aa11d468ccadee83d57b0
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 14 20:51:48 2011 +0000

    More stuff on extended security:
    
    1) Completed the NegTokenInit with the mechToken
    2) Started working on the login_extended, one packet more to go

commit 210fc6633f6efabb8d8c06b5002e56ad42864aea
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 14 14:38:17 2011 +0000

    In preparation for Extended Security authentication support:
    1) Added GSS-API structures and functions
    2) Added SPNEGO structures, now it supports NegTokenInit

commit 355df3118e1456e97a6df3dabc70a321f60fd94b
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 12 22:11:06 2011 +0000

    In preparation for Extended Security authentication support:
    1) Added Extended Security structures
    2) neg_session can be set to request Extended Security
    3) Non extended security structures created and parsed, although NTLMDialect is still used overall (to maintain compatibility)
    4) login_extended defined, but yet implemented (it shouldn't reach that code ever)

commit cf1da46024be44937939551469f7d475ccdef47c
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 12 00:36:19 2011 +0000

    Flags doesn't exist, it's Flags1

commit dd7c6862d2062e57d7a569823976fe3686ac2d4d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Jun 12 00:27:38 2011 +0000

    SMB neg_session now uses NewSMBPacket

commit 900977fba358a311abc285d5f8d8e03def493604
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 23:39:34 2011 +0000

    Added info command to display results for NetrServerGetInfo

commit e0ffd4153127fa5b495cde48b3f0089850c50ed8
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 23:31:48 2011 +0000

    Added support for NetrServerGetInfo(Level2)

commit 72887f78b45c52af3ce0b539fc5ffd075b4741bd
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 22:33:16 2011 +0000

    List of shares now uses srvsvc

commit 0f776b019359dfcde29617800d372e8ffc8cdeed
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 22:28:54 2011 +0000

    Added the ability to specify an already connected SMB session to the transport avoiding creating an extra connection

commit ae61854b6ca0b974908b6f37acb6efb352335c7f
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 22:16:06 2011 +0000

    Copyright change

commit 32e61e8b683dba375703e1cc4663f46d35ed14f4
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 22:07:52 2011 +0000

    Added get_remote_host method

commit 980dd754cfa1e4577366b4f73e2ddb70a321de31
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 21:53:52 2011 +0000

    Added support to specify the remote_name via the open command (from Vista on, *SMBSERVER doesn't work anymore)

commit 38e79050a88e3fc7fe147cdece674d2de29459cc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jun 11 20:55:59 2011 +0000

    Added support for NetrShareEnum(Level1) and NetrShareGetInfo(Level2)

commit efc2bb662d71ff720af4c1fe8076844fbe82f378
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 8 02:37:58 2011 +0000

    Updated maintainer info

commit a11cc11a999c1fcc21a0a8b32fd452cb6b9b4395
Author: pditincho@gmail.com <pditincho@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 1 15:10:32 2011 +0000

    Addition of test suites for IP6_Address, IP6 and ICMP6. Several bugfixes and typographic corrections.

commit 98ed9275de29d22a47ae9e395cd6c2de849ad7b4
Author: pditincho@gmail.com <pditincho@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu May 26 14:48:34 2011 +0000

    Addition of support for IP6, ICMP6 and NDP packets. Addition of IP6_Address helper class.

commit f3fb8846cb816e9632aee58755de7df38d7191c9
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 10 16:35:15 2011 +0000

    No need to change flags when asking for shares, reverting back to the ones we had before

commit a70de4de81bcf9280af9c32e15b3289d0688e83d
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 10 16:33:06 2011 +0000

    Added support to specify domain when loggin in

commit ad26f3ae9bc87399bf25742dde35e12290e7a0db
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 10 16:30:35 2011 +0000

    Added support to specify domain when loggin in

commit b8b355c79f7625ebe59dc94235151762be3d23dc
Author: bethus@gmail.com <bethus@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Feb 8 01:46:25 2011 +0000

    Support for NULL login (just put login)
    Now it correctly handles open {host,port}

commit 2153773af3c0854ee22533bbda69438183adedee
Author: jigermano@gmail.com <jigermano@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 2 21:26:56 2011 +0000

    Issue 3: Bad SessionError message
    Issue 4: Copy with smb doesn't work
    Issue 5: Reference to an undefine ERRBROWSE
    Issue 6: wrong exceptions being raised

commit 1648086471439876f38bbb3a8f980b7e28c04d4b
Author: jigermano@gmail.com <jigermano@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 2 21:19:50 2011 +0000

    Fix Issue 2: NTLMAuthHeader should be used for DCE/RPC only, forgot a simple unittest checking the headers

commit f8cc713efe46088bce166b47d377493144964595
Author: jigermano@gmail.com <jigermano@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 2 21:10:49 2011 +0000

    Fix Issue 2: NTLMAuthHeader should be used for DCE/RPC only

commit f70f0604a21bd1faad2f5ba06d2f95e56ed126ae
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jan 24 14:39:58 2011 +0000

    at some point in time NTLM Auth and Encryption got broken when synchin stuff
    from Core's trunk. This commit fixes it, and adds something else, which we
    are not 100% sure, but works: data in a DCERPC packet can't be empty, we
    add 4 bytes when it is.

commit c346847c1ac68e99f1883576b2cc81070795a550
Author: gmoreira@gmail.com <gmoreira@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 18 17:56:45 2010 +0000

    a method for returning the reserved TCP header nibble was added

commit dd48420a715d807cebd1101ccf2c146e7c6aa3c5
Author: gmoreira@gmail.com <gmoreira@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Nov 4 19:33:46 2010 +0000

    We modify RadioTap class to improve performance creating RadioTapField array at static time.

commit f180573798c8862202e189596345c7f7e1496e80
Author: gmoreira@gmail.com <gmoreira@gmail.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Aug 3 16:05:15 2010 +0000

    Update to Core impact internal repository

commit d0a276794aa53c96a8d32068c3e2e3084bc3eff5
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 8 17:48:44 2010 +0000

    * Fixed keymanager problem in decoders
    * Fixed address place where the BSSID address was used. The BSSID address place is based on fromDS and toDS.
    * Fixed test-WEPDecoder.py, it used the incorrect address to add the key in the keymanager.
    * Tidy up Dot11DataDecoder, replaced individual frame control (Dot11) field setters (set_QoS, set_Addr4, set_privateFrame).
      Instead we pass through set_dot11_hdr method the Dot11 object, it's the frame control object.

commit bfb585ad64c5505b52dec4a7d8e7357269e7953e
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri May 21 14:09:39 2010 +0000

    Added DHCP INFORM contstant.

commit 7caeb7d0b1a5e99ca36e59e254ef33eef7c94d78
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 4 12:58:54 2010 +0000

    * Bugfixed in TCP encoder. get_th_flags is reading header size part too.
    * A Testcases added to check this and other methods.

commit 5cba79ba68676d1624568c01d8f556ffa920d85c
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 29 17:54:02 2010 +0000

    in the changeset [238], we made the mistake of using the packet total size instead of header size.

commit d8956789b8c1f07e5c058b5e0539080504fb8599
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 29 14:20:54 2010 +0000

    Bugfixed in RadioTap protocol encoder. The Radiotap header length wasn't updated when the packet was created from scratch or modifying by adding or removing fields to it.
    Also added a method to read the header length

commit e6e9d640b0bb5af81e9a2379540050c272edebcd
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 28 20:38:18 2010 +0000

    When we were creating a RadioTap packet from scratch, the constructor was calling to set_present method that was renamed to be private.

commit b6b1f1564a217d48c4c9ed754f4c18cae1723280
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 22 17:48:33 2010 +0000

     - Added DNS decoder and part of the encoder.

commit d89d0e603cc21c498538e46bcb619d8ff3e99b69
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Mar 18 06:00:22 2010 +0000

    We facilitate the way that we do the auto checksum calculation in the IP class, the checksum is setted at 0x0000 internally in get_packet before doing the calculation. Before, this task, should be done manually by the user being prone to a mistake in the order they are calling set_ip_sum and set auto_checksum doing the calculation was not made or was made incorrectly.
    Added the reset_ip_sum method to IP class.

commit 552df832a919b3d36e3975a9b1e3d0416e53b3db
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 16 17:17:34 2010 +0000

    in changeset [229] We change bit endianess on getter/setter of managemenet authentication sequence but we missed to change related testcase.

commit d080f08afdb946badbff117603af439b3a868a10
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Mar 16 17:15:11 2010 +0000

    Moved ProtocolPacket from dot11 to ImpactPacket so it can be used directly by the rest of the protocol classes from impacket without having to import dot11

commit ecdc4214281da7f2f009736bd05a75c47d0ca061
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Mar 15 18:07:06 2010 +0000

    ImpacketException should inherit from Exception.

commit 2bb809f7cd1a85e21f8d98275864d8105375517e
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Mar 6 02:25:52 2010 +0000

    Added get method in DHCP class for get DHCP options values

commit 463ec8c8d6e0aa38cc3cbc6ccdd67d60382b8e99
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Mar 5 17:25:25 2010 +0000

    Bugfix in UDP class, self.parent() is a method not a attribute.

commit b8e58bf7dbc75079ba190d241f89b6205e17fadf
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Mar 3 18:17:02 2010 +0000

    Change bit endianess on getter/setter of authentication sequence.

commit 89331db947818d34f17862101cdba8678f4696fe
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Mar 3 18:03:21 2010 +0000

    In changeset [138] we introduced a bug on structure in unpack method that override fields dictionary when added inputData element.
    Fixed

commit 8c3a4400f57f0246e8fc520949ffd2ac352548a8
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 24 20:27:00 2010 +0000

     - Typo where are you!!

commit 09739d97c6a069a2352f1b3c8bab2a66e4dd17d5
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 24 20:10:22 2010 +0000

     - Changed some ugly param names i put on the last commit

commit 4e8939e68a8c4034ae5b978b162cc16de19ae0ae
Author: 6e726d <6e726d@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Feb 24 16:03:04 2010 +0000

     - Added Reason Codes Constants
     - Added Auth Algorithm Constants
     - Added Status Codes Constants

commit f56b2b39e78b59c7d32d816a384dcc0ea3d2c20c
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Feb 15 19:57:27 2010 +0000

     - Added Authentication Management Frame.
     - Added Association Request Management Frame.
     - Added Association Response Management Frame.
     - Added Disassociation Management Frame.
     - Added Reassociation Request Management Frame.
     - Added Reassociation Response Management Frame.

commit 30bb3a3de4d0a5565879b999b5626fd1da1d8ec0
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 8 18:32:43 2009 +0000

    Merged WEPIntermediate branch to added WEP Encryption/Decryption into trunk

commit 0634b5d0844f365f4870382c81ff32292bfb4f88
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 8 15:34:45 2009 +0000

    In changeset [216] we included by mistake not yet finalized changes

commit db7bcb672f0045011afeaf8e8ef1d767d484411e
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 8 15:08:45 2009 +0000

    In changeset [214], we forgot to modify exception text

commit 25e0a383fbaf0d48254724e1f8a9b42c27cfb39f
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 8 15:01:21 2009 +0000

    Bugfix: in IP datagrams, when decoding, checksum shouldn't be modified

commit 02043439eb3f0369e1ace9ecdf889fe79c240be5
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 8 14:31:48 2009 +0000

    Bug fixes in SNAP decoding

commit d8b9daa83c0cf99a0ebf1d94d17b4485f928877a
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 28 15:32:50 2009 +0000

    path for IP Options up to 40 bytes, submitted by George.Khoury@viasat.com

commit e8290f3d08fc61e090b39ae6f30b5cded3bb9e61
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 28 15:32:02 2009 +0000

    added warning message when no crypto library is available

commit 3f2f9a79deee7f4e85dae6768adf0c3601141a30
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 28 15:22:39 2009 +0000

    small change in LICENSE

commit 703a6ee5f23496c135ba4c5ed085096681720cf9
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Oct 28 15:19:25 2009 +0000

    small fix to define POW as None when Crypto is not found and POW is not found

commit 33665a133d4faf9ef3df2f60c1829a58a15a4891
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 27 00:01:05 2009 +0000

    Fixed Typo: We forget to fix the testcases and Dot11 class

commit 50766729edf752417fe1e40728058248abf335ef
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 26 19:30:08 2009 +0000

    Fixed typo.

commit bd3de5f0f630572906db133bf8afbbe329871a63
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 15 04:38:03 2009 +0000

    Fixes in Dot11ManagementDeauthentication:
    * We incorrectly defined this as inheriting from Dot11ManagementFrame instead of ProtocolPacket.
    * We also forget the code to create a Dot11ManagementDeauthentication packet from scratch.

commit d8b30f309b599ce3dce65b235ad6358928ca2cc9
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 8 19:47:20 2009 +0000

    Added management deauthentication frame.

commit af9652a8bc3b6d4ebf6546f358a56cc802ee9b92
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 21 16:07:46 2009 +0000

    Fixed bug on RSN element parse.
    Modify test cases to work with modification on vendor specific element parser.

commit 494452cd934aa41b2ffcf810dd30cff1acb24af9
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 11 20:30:59 2009 +0000

    Added getter/setter of RSN Element.

commit d6b635d2e9b7a1f5ad78750a100275f1c13fd0a7
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 11 15:19:26 2009 +0000

    reverse and not engineering

commit 196935cc79f8da355eac496dca7637db30402bb9
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 11 15:06:01 2009 +0000

    Typo

commit 7117ecdd2b0f694c71998a042cada5a493672453
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Sep 11 14:50:57 2009 +0000

    Added capabilities bitmap.

commit b012389f6e44c6d45f65d51c3c52896116c1d8e0
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 8 22:21:32 2009 +0000

    Merge with some bug fixing.

commit b866316784725ef860f3ad93a5e790f99a6ec09e
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Sep 3 18:38:57 2009 +0000

    + Added 802.11 ProbeResponse testcase.
    + Add script to run all testcases in win32 host.

commit 652f0dc53fe18461490505558935b7600802dab9
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 2 22:20:36 2009 +0000

    dot11.py: Added classes to decode ProbeRequest and ProbeResponse dot11 Management frames.
    ImpactDecoder.py: + Fixed bug in RadioTap flag field when it's zero
                      + Added decoder for ProbeRequest and ProbeResponse dot11 Management frames.
    test-FrameManagementProbeRequest.py: Added testcases for ProbeRequest dot11 Management frames

commit 7afd005e5c438565b5eeec1ef3f2cbc4698cf23a
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 2 22:07:32 2009 +0000

    Fixed ident issues

commit d39a3e5831c64f97787a16c9dd5f1110d48a1b5a
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 1 19:19:41 2009 +0000

    Modified encryption handling to support keys

commit 8e2ecfb445118b37e3e23a2835a35b073e138790
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Sep 1 15:49:06 2009 +0000

    Modified python executable path.

commit 0892e8d9068c163752b408643bfe188b63b062bb
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 31 18:56:09 2009 +0000

    I miss the method of the instance. :S

commit bb850e8f3ba1e884be214e4744316c70e783034b
Author: narrowmind <narrowmind@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 26 19:02:04 2009 +0000

    Added Dot11ControlDecoder.

commit 35fbfc0a11b051e6f25d513d5ce95a3b235f6c93
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 9 00:30:59 2009 +0000

    Improvements in Management helper classes.
    Added vendor-specific getter/setter methods

commit 25d157b19acde9c3f81ccd93325cb6732bdc5f78
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Aug 5 03:30:53 2009 +0000

    Improved Dot11 Management classes generalizing to the rest of the subtypes.
    Added base methods to delete elements, add/replace elements, etc.
    Added SSID and Supported Rates setters
    Added DS_Parameter_Set getter/setter

commit add55052f3638ae0b679651fd6b6c4ce629e8606
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 3 12:46:19 2009 +0000

    Deleted RadioTap unused private methods

commit 4ff8a1ec46a94ef79d980f39f97461ff87c8cbbe
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 3 04:57:44 2009 +0000

    Added getters methods for SSID and Supported Rates.
    An update related to previously commit is included in this changeset.

commit 920990bca217b2c30e79ca49491b126a9a56ce63
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Aug 3 01:48:37 2009 +0000

    All dot11 packets have no FCS. This depends on the flag FCS_at_end in RadioTap protocol. In this changeset we handle these cases.

commit cd1569719eb463ef5d09871429baefdbc1c9a169
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 2 22:33:03 2009 +0000

    Updating of imports

commit 2a03e7a7747a6b4ca6d85d9045656b056825402d
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 2 22:16:21 2009 +0000

    Added an hierarchical updating packets mechanism.
    A packet is the body of the immediately superior packet, if it has a parent, within the hierarchy. If a package is changed, this must be reflected on the packages above.

commit 4f2bc706ecbc9c22734f8bf14b4f1cc5c068371f
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 2 00:45:30 2009 +0000

    Started writing the Management Class, its testcase and decoder.

commit fe3c7c9717a0909190212692ba511da9416394e4
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sun Aug 2 00:15:38 2009 +0000

    Added long_long data type setter and getter to PacketBuffer class

commit 9c4498b4a49081581735c1657ce1d0d8c9fc7201
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 31 04:35:47 2009 +0000

    Completed RadioTap Protocol testcases and several fixes

commit 2640bba58c03ed9611de10856cc2c84b4661d7f4
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 31 01:32:52 2009 +0000

    Fixes in channel field. A test was added for this field in the RadioTap testcase.

commit c0b8d0f5d0c5663d5b0dfb13c7943c7f85737184
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 30 15:05:49 2009 +0000

    Added method to decoder base class for get a particular protocol

commit 792e8d98de3f4a6ccf34e88d143116685900e10e
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 29 02:01:15 2009 +0000

    Fixes in RadioTap decoder. Added testcase for RadioTap decoder

commit c76d8911a399831612f345a56c8072a21657a841
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 29 00:21:29 2009 +0000

    Add xchannel field setter's test in testcase

commit 83ab182957402b93c076ea29cbc562512c92e971
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jul 29 00:13:57 2009 +0000

    Added all the RadioTap field. Lack of testcases for this field.

commit 9b50a93f0163d7d38aee2b86c44808943b90fa8a
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jul 28 13:44:45 2009 +0000

    Rewrite of RadioTap class

commit 6f4ea36d14c35ea3bcdfcc9916dd56c72eff5bba
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 25 15:00:40 2009 +0000

    This was a pending change, was confusing and redundant that each class has the length of header and tail.

commit 2fc8c24fd7db418b43d09a6119ecbeca940b983a
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 25 14:33:06 2009 +0000

    The AbstractDot11 class was renamed to more appropiate name because it is no longer an abstract class, nor is it only for dot11

commit 0471f55bcffa48852f439a647c904973c0767745
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 24 14:08:52 2009 +0000

    Added getter/setter methods for flags and rate RadioTap fields

commit 43247fbf27ec69dc86e711858cc869d131385599
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 24 13:43:15 2009 +0000

    We unified format conversion to __set_field_from_string and __get_field_as_string

commit fbc6ebad062200ec76a43cb397f971087c395193
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 24 13:27:57 2009 +0000

    Deleted some lost lines

commit 50ef64c41e165f494fa0062d37b5e4a8c108b45b
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 23 23:27:20 2009 +0000

    Modified __get_field_position for return the field length too.
    Add unset_field method and tested in RadioTap testcase

commit 3528204d5ba5602908556bb7268d39737c2efef0
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 23 13:32:43 2009 +0000

    * Fixes with RadioTap header size when add a field
    * Improvements in the dot11 base class (AbstractDot11)
    * add unset_field method

commit 7b8a099cf185605d28f9838326d9c35c54125a3c
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 23 05:14:49 2009 +0000

    Advancing in the RadioTap class construction

commit 13284061dd19951bf49e14d6fe221ee6769360b4
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 6 01:51:39 2009 +0000

    renamed to more suitable name

commit 59380c7778154f49f523b23da1978a3a38403908
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jul 6 01:43:33 2009 +0000

    Added methods to handle WEP/WPA/WPA2 fields and their respective TestCases

commit 9fed0dea96a80ab60f601caa7f80d30d216638e7
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 4 22:37:05 2009 +0000

    Added test to check if get_packet() return the correct WEP Data content

commit 1416fe53d08a9ded0b7c284005c1e59aeba57472
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 4 22:25:39 2009 +0000

    Fixes in dot11 decoders. In this context, a testcase was added

commit 51d6333234ac5f9c95fad2b650ace13eaff479eb
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Sat Jul 4 22:22:53 2009 +0000

    removed debug line

commit ec8ef633bf852d5f0d25828706b09fb23e2aab5a
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 3 03:33:47 2009 +0000

    Completed WEP testcase

commit 41cf5524a15336accec29ff72439710445868ed9
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jul 3 03:31:40 2009 +0000

    Fixes handling tail frame part. Fixes in WEP frames

commit e77f9e457e60b44de754704a7afb0b4cbf7baf70
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 30 03:49:08 2009 +0000

    Updated WEP/WPA/WPA2 classes
    Outlined WEP/WPA/WPA2 decoders

commit 639ca77ed412935de1d7de383abbda887a43db56
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 30 02:16:13 2009 +0000

    Data Frames and WEP updated

commit 473306c15334f6560010ad30e5867a362e3f5781
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 29 11:57:59 2009 +0000

    *Adjustments to new class design.

commit 01f2a0561fbc00932554ef61cb38272d043a1d04
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 24 02:25:15 2009 +0000

    changed to use asserts unittest for this check

commit 8d3614b0953a29da856584e35a61383a181d4643
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 22 05:12:10 2009 +0000

    Outlined of decoders. Although not tested

commit 0f2777aaa1c01b2d8fa150d08b95e29a857bf3e6
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 22 05:08:53 2009 +0000

    * New design, rewritten a lot of the code.
    * Separated DataAddr4 and DataQoS from Data.
    * Adapted testcases for Dot11 and Dot11DataFrame
    * Added LLC Header class
    * Added SNAP Header class

commit bd6dcc8325fa6b5797e2f6d524c0a0a9374ccab2
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 22 04:53:59 2009 +0000

    Was separated from Header class all the protocol layers logic to ProtocolLayer class and now Header inherits from this too. This does not affect the rest of the code
    Dot11 needs inherit only the ProtocolLayer stuff.

commit 242128b7f4cb37cef8051cec1614b13d232d8cba
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 9 05:50:53 2009 +0000

    Some fixes for CFEndCFACK and PSPoll. There is still an error to fix

commit 81e5e4055bf0b220be1d86e5a04bfa908ec395da
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 9 05:47:42 2009 +0000

    This comment is no longer valid

commit 39a4fb47bc5fb310a5b8abfe8e985906e685059c
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 9 05:46:15 2009 +0000

    we must keep in mind that comments about AID (Association ID) field

commit cd35a20e77471de8d0214a5f27901d834be47003
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 9 02:55:56 2009 +0000

    Frame Control PS-Poll has AID field, and not DURATION

commit c9749f220972b5a83c6fcca3dc67f43f8097c26a
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Jun 9 02:41:31 2009 +0000

    Removed trailing word "field" from each method name

commit 80469292e1c1a980f948df498e1178b5d048cd24
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 8 20:08:29 2009 +0000

    reordered ECN responder, and added some debug prints (commented out)

commit 8d7df3253e211fcbc6037cbfc1986e63207f158b
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 8 19:26:52 2009 +0000

    removed some unused stuff

commit 7cdfaebd08c69fc8a89f8457af61e9d483141a1d
Author: gera@corest.com <gera@corest.com@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Jun 8 19:13:09 2009 +0000

    added --help parameter

commit 92e98fbe63ae414cecca1fa9a02bb96ab6496654
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 20:26:48 2009 +0000

    added PcapFile.reset()

commit 79de6f63eafbab6cae83214acbfe08a97d50c5ee
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 19:33:31 2009 +0000

    added class PcapFile. it can be used to read and write pcap files

commit 0e13dfc4d916ea7209e3fda9beaf9cb380d70e2c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 19:33:05 2009 +0000

    @classmethod
    Structure.fromFile(aFile)

commit e68a9ac853ab93d15cb21afd4a6167ce4fc90f2a
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 19:17:00 2009 +0000

    Added partial support for IEEE 802.11 Network packet codecs

commit 30095536e4486b89c15f96882d9591f93cc96d13
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 18:55:05 2009 +0000

    simple label rename

commit 959631877489c85ca271b2adb6a861c62ed7d85d
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 16:17:19 2009 +0000

    bug fix: when packing "=" fields, "&" couldn't be used inside the code because "&" type specifier had precendence over "&"

commit 4a5fd5c368cb0b55def853b7158bb9bb23fd0688
Author: gmoreira <gmoreira@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jun 4 16:16:27 2009 +0000

    new test, example of how to pack and unpack bitfields

commit a6225280737ce006d7e1c7e6c116b6db47ee2143
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 19 15:55:04 2009 +0000

    documentation fix

commit 2c74f0520b26fcd4699d9b07745700544bf23fb9
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 12 22:39:54 2009 +0000

    added fault nmapOSDB pointing to /usr/share/nmap/nmap-os-db

commit 44d1b6289013abac10065e9083c221a8f0dcea3c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 12 22:30:22 2009 +0000

    renamed wpad option to 'proxy-autoconfig'

commit 55e978a741f5431648f21bd187f98a435d26c65c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 12 21:10:19 2009 +0000

    added more options

commit a5bec1ba0ddfe992ce8eeb52961170cf574f5dfc
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 11 16:19:10 2009 +0000

    more dhcp options

commit 12c817ccac608f9d9288ebf4a89a4a5843c66e4e
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu May 7 21:18:16 2009 +0000

    added some more options
    decoding requested options too

commit 8dbe021b3b1d653a8926e16883450df5827504d2
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu May 7 16:13:02 2009 +0000

    typo

commit 1b3d4607155f65afac2a47c7a45c3d1bb574b091
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu May 7 16:11:13 2009 +0000

    added command line argument -d to specify the nmap-os-db file

commit 934278323ff7dc2a38705e58c80aa8f66f6ad59c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed May 6 15:30:12 2009 +0000

    some refactoring, and added udp cmd packets, can be used like:
    
    echo cmd:exit | nc -u 192.168.66.254 12345

commit 336d2e8a25fcff64de10c39a0c62ff2226690aa2
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 30 21:29:16 2009 +0000

    added some DHCP options, more to come

commit aef20feb75d89ba55ecaf05e56878567c73c2c46
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 30 18:02:18 2009 +0000

    bug fix/improvement: self can be used in pack/unpack code for _ fields

commit 20726853474ad24a26594896977f9c71cd6afc29
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 22:23:51 2009 +0000

    proxy-autodiscovery is not a dhcp option, it's a parameter-request-list entry

commit 7d0f0968bfb801285a17fd75f3cf6a868c89ec99
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 22:20:02 2009 +0000

    can unpack options, and more options have names

commit 8c440da211b7b504c86ce52aedd0d29cda256bad
Author: lskladnik <lskladnik@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 21:26:10 2009 +0000

    Applied some fixes from Impact trunk.

commit 779940396f50dd8aac691e1230cf5928ae6f1063
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 21:09:25 2009 +0000

    unpacking of chaddr's length is now magic :)

commit 410c7008c9ad590bfcaa066eb8778542a9e66856
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 21:06:40 2009 +0000

    propper packing and unpacking of dhcp packets...
    unpacking of chaddr's length is not magic :(

commit 63f1e7351f8f97b37f8adcd8adbdef41d1570de7
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 20:51:49 2009 +0000

    fixed something on the structure for proper unpacking

commit 6cfd19ad51531ded058791c7f840da97b1900ff7
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 20:51:28 2009 +0000

    fixed a bug in calcUnpackSize() for '_' fields
    added some more debug info when .debug != false

commit 20cf2b995e45ec87aacef2ec3af5cdcfe60f5c32
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 20:31:51 2009 +0000

    fixed a bug when unpacking '_' fields

commit 4dccb28bcc52997a91f3011d9fabfd42f0cd2858
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 18:43:29 2009 +0000

    DHCP cheap implementation

commit 72bf82b859b948842c705d295526074166d404ca
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 16:27:38 2009 +0000

    parser for .pcap capture files

commit 2befae75032065e766c69970cbc7ec48c1c8ee4b
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 29 16:27:29 2009 +0000

    no real changes`

commit 3fa7ba9ba2a0db667a6c174c01e40763c2f82601
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 28 19:55:46 2009 +0000

    an EthernetPacket can have just Data() inside, if this is the case,
    it should not ask the ether_type to the Data(), but instead use what's
    set in itself

commit 76228245df30d855b0c20e38e6fc520f73a9b30c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 28 19:06:19 2009 +0000

    default argument for msg in dump()

commit 979465e306d897f3f28a34d172c989a0455d47b3
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Apr 28 19:06:10 2009 +0000

    bug fix, uuid was set instead of objuuid

commit 41847ccf70b337c31206b7e7a1c1a8da18c68060
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 23 20:43:13 2009 +0000

    added impact compatibility

commit fffd897ec720ee11ca3eff026b682a3ad4d01b9b
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 23 20:02:50 2009 +0000

    fixed ClosedTCPResponder and added it to the list of responders
    
    initial seq number for TCPResponders is now according to the generator

commit 1704aedb569e93458af486e35bb176b75d7bd1bf
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 20 21:17:19 2009 +0000

    # [x] TCP RST data checksum (RD)
    
    I forgot this test before, now we are really done

commit 6f798462f84f2b9a3949697e8f7a5ae784a2d892
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 20 21:16:34 2009 +0000

    small module to compensate crc32

commit 21fde00a304ca7784be72f593eda3c41982a9e2b
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:28:59 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [x] Returned probe IP total length value (RIPL)
    # [x] Returned probe IP ID value (RID)
    # [x] Integrity of returned probe IP checksum value (RIPCK)
    # [x] Integrity of returned probe UDP checksum (RUCK)
    # [x] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct
    
    and we are done!

commit c32a707b4821d6960b93d3b7d37e0374c1ed947a
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:23:49 2009 +0000

    modified a little bit how default options are handlded

commit ed262c24999ca451c0b72da949396685e456eb48
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:23:02 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [x] Returned probe IP total length value (RIPL)
    # [x] Returned probe IP ID value (RID)
    # [x] Integrity of returned probe IP checksum value (RIPCK)
    # [x] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit dae8dc625f9f5b43a17b24f532cf83ec9725fce3
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:18:52 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [x] Returned probe IP total length value (RIPL)
    # [x] Returned probe IP ID value (RID)
    # [x] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit 1f06a057216ba6f881a7520d462889c86b6c8d64
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:05:23 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [x] Returned probe IP total length value (RIPL)
    # [x] Returned probe IP ID value (RID)
    # [ ] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit f51f3777f97f60e40d25d9d97db1b533ab0ff04b
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:03:31 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [x] Returned probe IP total length value (RIPL)
    # [ ] Returned probe IP ID value (RID)
    # [ ] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit 291fdb9ca7a08cc92d26a9ee8a58af24d65b433f
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 20:00:24 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [x] Unused port unreachable field nonzero (UN)
    # [ ] Returned probe IP total length value (RIPL)
    # [ ] Returned probe IP ID value (RID)
    # [ ] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit e1b8d774498052bb800a76726e58fce6693bceea
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 19:52:31 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [x] IP total length (IPL)
    # [ ] Unused port unreachable field nonzero (UN)
    # [ ] Returned probe IP total length value (RIPL)
    # [ ] Returned probe IP ID value (RID)
    # [ ] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit 0b62023ac0808c713b114b553a6cd49a13724c1d
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 19:35:16 2009 +0000

    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)
    # [ ] IP total length (IPL)
    # [ ] Unused port unreachable field nonzero (UN)
    # [ ] Returned probe IP total length value (RIPL)
    # [ ] Returned probe IP ID value (RID)
    # [ ] Integrity of returned probe IP checksum value (RIPCK)
    # [ ] Integrity of returned probe UDP checksum (RUCK)
    # [ ] Integrity of returned UDP data (RUD)
    # [-] ??? (TOS) Type of Service
    # [-] ??? (RUL) Length of return UDP packet is correct

commit f32434874b4f021c91d09970c6ae08aa40449464
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 19:34:48 2009 +0000

    first tests on NMAP2UDPResponder
    # U1()
    # [x] Responsiveness (R)
    # [x] IP don't fragment bit (DF)
    # [x] IP initial time-to-live (T)

commit 8dabad50e2b2cb50760355671e11eac5f22ba3b3
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 18:58:48 2009 +0000

    added UDPResponder, ClosedUDPResponder and OpenUDPResponder... all working :)

commit 3eca8d639abe21d325894c976be0c125c358d442
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 18:43:29 2009 +0000

    initAnswer() --> buildAnswer()

commit 497d95c90b0d8bf18bd80c55641dbf1737a4ac1e
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Apr 16 18:36:05 2009 +0000

    refactored a little bit:
    
        moved initAnswer() to the top class (Responder) and
        added the logic to initAnswer() -> sendPacket() to Responder.process()
    
        The open ports are now a list of ports, and only Machine knows about it
        Closed ports are not listed, are those not open

commit 1295ddabec5e130e1d4d94af3c86e0a78a3bdc19
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 23:18:07 2009 +0000

    marked a few more things done (they were done before, just not marked)

commit 832d3466ed2d0e1fa83dcc4b9bca208e0609d048
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:59:28 2009 +0000

    not randomizing the delta for stdDev

commit e5e61030944018d3e274151386291847dc18569e
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:52:11 2009 +0000

    # [x] IP ID sequence generation algorithm on ICMP messages (II)
    # [x] Shared IP ID sequence Boolean (SS)

commit c5efeea3751abfba64b03e279b6563c33201ffba
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:28:16 2009 +0000

    # [x] IP Type of Service (TOSI)

commit f34a8edbc5da9c56958287687287e535b8fea1b9
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:19:49 2009 +0000

    # [x] ICMP response code (CD)

commit 7b9e9248270aee95fdb9ff2b8987d68b16242b73
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:08:38 2009 +0000

    # [x] ICMP Sequence number (SI)

commit 23fba4a4d8c056519e0d2bf45af8613508a8f1ee
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 22:01:52 2009 +0000

    some safe checking on unsupported on IE(DFI) and IE(DLI)
    we should do this on every other option

commit bc9521c8df4ead35b661585f2a175b1818ef6bab
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 21:53:23 2009 +0000

    +# [x] IP Data Length (DLI)

commit d95ae313fd5c0bc7400a8464e71e165c22ef8f64
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 21:49:00 2009 +0000

    # IE()
    # [x] Responsiveness (R)
    # [x] Don't fragment (ICMP) (DFI)
    # [x] IP initial time-to-live (T)
    # [x] IP initial time-to-live guess (TG)

commit 31c0a58064441d017cc2be1ab8f25f5e2ef9d8ce
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 21:45:27 2009 +0000

    Improved a lot GCD, ISR and SP emulation!!!
    
    thanks to talking to aureliano we realized that if sequence numbers are
    generated on Timer events, then, the numbers are incremented only at this events
    and it doesn't matter how close we are sampling to the event, so we don't have
    to roung to the closes integer, but rather truncate to the previous

commit 383e915315c45681b70eb4aa6e4b7ee6cc4de7d2
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 19:40:31 2009 +0000

    +# [x] IP ID sequence generation algorithm (TI)
    +#   [x] Z  - All zeros
    +#   [x] RD - Random: It increments at least once by at least 20000.
    +#   [x] RI - Random positive increments. Any (delta_i > 1000, and delta_i % 256 != 0) or (delta_i > 256000 and delta_i % 256 == 0)

commit 5d8ea44b720a92f68b274f2716f2d7335292c8c5
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 19:39:37 2009 +0000

    fixed initial window size. it was fixed 0, and then, it was not hex encoeded

commit 6461e0937fbbbb24fe66a2f1293252a271f61dda
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 19:29:08 2009 +0000

    removed some void __init__()s
    bugfix: making a copy of the fingerprint from the machine, otherwise subsequent changes affect all references to the fingerprint (all SEQn where sharing and changing the same fingerprint)
    changed how test SP (stdDev) is computed and used. Now we are trying adding a random value

commit 08ce67bbe54e9002369d076cf7ba4a19acc3af89
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 19:26:18 2009 +0000

    set_ts_echo() was not working... at all

commit fc404cbd26ed65a40676ba3053ac10c3b833e6dd
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 16:43:44 2009 +0000

     # [ ] IP ID sequence generation algorithm (TI)
     +#   [+] Z  - All zeros
     +#   [+] RD - Random: It increments at least once by at least 20000.
     +#   [-] Hex Value - fixed IP ID
     +#   [+] RI - Random positive increments. Any (delta_i > 1000, and delta_i % 256 != 0) or (delta_i > 256000 and delta_i % 256 == 0)
     +#   [x] BI - Broken increment. All delta_i % 256 = 0 and all delta_i <= 5120.
     +#   [x] I - Incremental. All delta_i < 10
     +#   [x] O - (Ommited, the test does not show in the fingerprint). None of the other
    
    I also added simplifyFinerprints() which simplifies them by leaving only the first option when there are more than one (separated by | in the fingerprint file)

commit b9c705f8af50cfef3307f58f5749ee96a48e96ab
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 16:04:40 2009 +0000

    Added DF, MF and RF to the __str__ of IP packets
    Added ece and cwr to the __str__ of TCP packets

commit 81e730b94183f9dff86a75af4e2811a553033741
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:52:27 2009 +0000

    a few bugs introduced in the latest commit

commit cf55eb8068859f947404759ab639d0f7ff06df4d
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:46:37 2009 +0000

     # All Probes
    +# [|] SEQ
    +# [x] OPS
    +# [x] WIN
    
     # All Tests
    
     # SEQ()
    +# [x] TCP ISN sequence predictability index (SP)
    +# [x] TCP ISN greatest common divisor (GCD)
    +# [x] TCP ISN counter rate (ISR)
     # [ ] IP ID sequence generation algorithm (TI)
    +#   [ ] Z  - All zeros
    +#   [ ] RD - Random: It increments at least once by at least 20000.
    +#   [ ] Hex Value - fixed IP ID
    +#   [ ] RI - Random positive increments. Any (delta_i > 1000, and delta_i % 256 != 0) or (delta_i > 256000 and delta_i % 256 == 0)
    +#   [ ] BI - Broken increment. All delta_i % 256 = 0 and all delta_i <= 5120.
    +#   [ ] I - Incremental. All delta_i < 10
    +#   [ ] O - (Ommited, the test does not show in the fingerprint). None of the other
    +# [x] TCP timestamp option algorithm (TS)
    +#   [x] U - unsupported (don't send TS)
    +#   [x] 0 - Zero
    +#   [x] 1 - 0-5.66 (2 Hz)
    +#   [x] 7 - 70-150 (100 Hz)
    +#   [x] 8 - 150-350 (200 Hz)
    +#   [x]   - avg_freq = sum(TS_diff/time_diff) . round(.5 + math.log(avg_freq)/math.log(2)))
    +#           time_diff = 0.11 segs
     # OPS()
    +# [x] TCP options (O, O1-O6)
     # WIN()
    +# [x] TCP initial window size (W, W1-W6)
     # ECN, T1-T7
    +# [x] TCP options (O, O1-O6)
    +# [x] TCP initial window size (W, W1-W6)
    +# [ ] IP Type of Service (TOSI)
    +# [ ] ICMP Sequence number (SI)
    +# [ ] IP Data Length (DLI)
    +# [ ] ??? (TOS) Type of Service
    +# [ ] ??? (RUL) Length of return UDP packet is correct

commit 8305242cdcfe47d33fd78e3d70211b82d2557f8c
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:43:52 2009 +0000

    More complete:
    
    +# All Probes
    +# [ ] SEQ
    +# [ ] OPS
    +# [ ] WIN
    +# [x] T1
    +# [x] T2
    +# [x] T3
    +# [x] T4
    +# [x] T5
    +# [x] T6
    +# [x] T7
    +# [ ] IE
    +# [x] ECN
    +# [ ] U1
    +
    +# All Tests
    +
    +# SEQ()
    +# [ ] TCP ISN sequence predictability index (SP)
    +# [ ] TCP ISN greatest common divisor (GCD)
    +# [ ] TCP ISN counter rate (ISR)
    +# [ ] IP ID sequence generation algorithm (TI)
    +# [ ] IP ID sequence generation algorithm (CI)
    +# [-] IP ID sequence generation algorithm (II)
    +# [ ] Shared IP ID sequence Boolean (SS)
    +# [ ] TCP timestamp option algorithm (TS)
    +# OPS()
    +# [+] TCP options (O, O1-O6)
    +# WIN()
    +# [+] TCP initial window size (W, W1-W6)
    +# ECN, T1-T7
    +# [+] TCP options (O, O1-O6)
    +# [+] TCP initial window size (W, W1-W6)
    +# [x] Responsiveness (R)
    +# [x] IP don't fragment bit (DF)
    +# [x] IP initial time-to-live (T)
    +# [x] IP initial time-to-live guess (TG)
    +# [x] Explicit congestion notification (CC)
    +# [x] TCP miscellaneous quirks (Q)
    +# [x] TCP sequence number (S)
    +# [x] TCP acknowledgment number (A)
    +# [x] TCP flags (F)
    +# [ ] TCP RST data checksum (RD)
    +# IE()
    +# [ ] Responsiveness (R)
    +# [ ] Don't fragment (ICMP) (DFI)
    +# [ ] IP initial time-to-live (T)
    +# [ ] IP initial time-to-live guess (TG)
    +# [ ] ICMP response code (CD)
    +# [ ] ??? (TOSI)
    +# [ ] ??? (SI)
    +# [ ] ??? (DLI)
    +# U1()
    +# [ ] Responsiveness (R)
    +# [ ] IP don't fragment bit (DF)
    +# [ ] IP initial time-to-live (T)
    +# [ ] IP initial time-to-live guess (TG)
    +# [ ] IP total length (IPL)
    +# [ ] Unused port unreachable field nonzero (UN)
    +# [ ] Returned probe IP total length value (RIPL)
    +# [ ] Returned probe IP ID value (RID)
    +# [ ] Integrity of returned probe IP checksum value (RIPCK)
    +# [ ] Integrity of returned probe UDP checksum (RUCK)
    +# [ ] Integrity of returned UDP data (RUD)
    +# [ ] ??? (TOS)
    +# [ ] ??? (RUL)
    +

commit 4cd4227c484e8015ea2eaaeed5aeba8f7128eaa7
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:42:31 2009 +0000

    a bugfix, the this fix was ported to the orignal impact module

commit dab1808ee5fca4b042fe464abb3df39d5ffbdbff
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:40:14 2009 +0000

    This version answers ECN probes, although it's composing answers as
    it will be for any other probe. It still laks a few tests though,
    and all the SEQ(), IE() and U1()

commit 1dbf41b102a43b51b6346bd6f69e54ad8ab1de46
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Apr 15 15:38:50 2009 +0000

    nmapAnswreingMachine.py is a tool to impersonate any stack for nmap's -O (OS fingerprint) option. It only supports nmap's second generation fingerprint DB
    
    os_ident.py is a modification of the IMPACT module, we take some classes defining the probe packets from it. We may want to trim this file before releasing

commit e843556daf05270e672418058b31cc4e133fb49e
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 19 16:05:31 2009 +0000

    Fixing a bug reported by Bernd Deichmann <bd@deichmann-edv.de>.
    On some cards, and for some packets, extra data comes after the full packet.
    This fix uses the length in the IP header to cut the payload to its real length

commit b695aeed9526c3cfd5bf54c672ddfb9e3d7cb129
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 1 19:54:40 2008 +0000

    changelong for last commit

commit 0c44c61ea526515943946cc2fea0be000905344a
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Aug 1 19:48:10 2008 +0000

    fix to TCP.get_echo_ts() submitted by Tom Coote

commit 984c3b4d62f9f80dd9f67531e6d64e2ca4167d16
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 3 20:53:08 2006 +0000

    fixed bug in display_time (reported by grutz _at_ jingojango.net)
    cleaned up code using display_time

commit a951dea81b4ea743f7882cf3d29f156b77130f20
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Sep 25 15:33:59 2006 +0000

    fixed setup.py where doc files were installed on usr/bin
    replaced @ in changelog with _at_, as some people are archiving packages on websites were spammers can crawl them

commit 9a2571ef2a09b21aa29ed6356323a1beac5e0b43
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 6 15:54:08 2006 +0000

    __socket changes by buk

commit 43c482ef63a473cfd659ef0aad0bfe210228bf78
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Jun 28 14:57:03 2006 +0000

    fixed syntax error

commit f7196438bee94f3f6f9af23bdbccc225df2be10d
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Jun 23 18:33:29 2006 +0000

    fixed TCP.get_th_sum() bug reported by ranusy@gmail.com

commit 01b882774af2d070d1397077bc41f91168425a71
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 30 15:51:10 2006 +0000

    samr: Python 2.4 raises an exception where python 2.0 didn't. We need to
            catch it
    printer: RawCall() no more, now self.dce.call()

commit 65a98cfef8de4e62123c0e3a4b72b26a106b0330
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 23 22:26:51 2006 +0000

    retabbed

commit 2df6998ef99838e4b5f2bd73e6e8dc36c199613f
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue May 23 21:19:26 2006 +0000

    copyrights

commit 65be005f641a9e9337aa668122e8e97875388d21
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 22 22:19:58 2006 +0000

    new files aded

commit 01c4a4d45cce4c97c4d4353a6204d050473d41bb
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 22 22:16:38 2006 +0000

    new examples to show newer features

commit 2ce42b2faf6cd602eca47bd8fd4f8d4ca71d7576
Author: gera <gera@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon May 22 22:16:15 2006 +0000

    Lots of changes.
    SMB rewriten using Structure, added hashes authentication chainable
    commands, lots of commands, etc.
    DCERPC cleaned up, added authentication and encryption, fragmentation
    and more things

commit 2722624bc190069d4da0a4e62c136a665514001c
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 3 15:52:03 2006 +0000

    New release

commit f0bacb04cf69d120d6fc85a77b75218633b2c960
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 3 15:49:23 2006 +0000

    Fixed byte ordering bug when using IP_HDRINCL in BSD systems (patch supplied by ginga@ginganet.org).

commit 83e7538d2bdc2f4568e363c4d958ebd41347cffb
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Apr 3 15:20:34 2006 +0000

    Fixes bug when parsing ARP packets

commit 8c4a96e91e896752636772c9943004e978c9370e
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Sep 21 19:07:55 2005 +0000

    removed old import

commit 5202a11373dc03e683a7d37d4e7a1bfbb09586d0
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 28 21:06:24 2005 +0000

    fixed bug in set_icmp_nextmtu()

commit f90e0848d3d6ffc2ebb44171699c0776e8213a07
Author: max <max@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Jul 28 20:41:59 2005 +0000

    fixed icmp unreachable bug

commit 2a1e35ed7421a061fce93d3c215051721e06c526
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 26 20:55:01 2004 +0000

    *** empty log message ***

commit f3c4b05728ed50c863548ff99a01e47b03206c5f
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Feb 26 20:54:45 2004 +0000

    Fixed as_{hrd,pro} methods to not invoke the tolist method, because they were being called with array objects as input, and anyway it wasn't necessary to call that method for what they did.

commit f9c57d8cec1569c56b99fcb4da4e6d5d19d67759
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:27:57 2003 +0000

    Fixed URL

commit 4511c3234966206b2b0ce0596b5be4fbf0d24d21
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:26:31 2003 +0000

    -

commit 890d9bf3e07197b17494e1f24399d2e2911a29c3
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:26:22 2003 +0000

    Bumped version number.

commit 32ba2a07db8f251fb30eb2db05d21ff01fe13cef
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:25:26 2003 +0000

    -

commit eeb648a333040b28beff2c4e4c3715ba3f2c202f
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 16 17:23:42 2003 +0000

    Fixed wrong indentation that was causing fragmentation to go wrong.

commit 7dc3c77d4ecf6f90d91a82867b45e18e12df9c87
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 23:42:47 2003 +0000

    Bumped version number.

commit 6d86749f2e6ab3cff8d92a36415978a9729c2bcc
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 23:42:15 2003 +0000

    -

commit f86b8cc26460451cc6d723b47419d5dc8f3b265a
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Wed Dec 10 23:41:43 2003 +0000

    (DCERPC_v4.bind): support idempotent flag.
    (DCERPC_v4.send): reduced fragment size to avoid IP fragmentation on links with MTU = 1500. Added a method that allows the caller to configure this size.

commit 6d2b1a19aae53d438cbd5c3cbb05485b77705ed5
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 2 22:42:55 2003 +0000

    Updates.

commit faa6d8b3020e4f62e97cbdc532b0f23565e8f2b0
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Dec 2 22:42:48 2003 +0000

    DCERPC_v4.bind: made self.__bind protected
    DCERPC_v4.send: fragment outgoing packets.

commit 4c35168a0e3781430054ee4b6fd7ab5521b7fd39
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 28 15:39:11 2003 +0000

    Include ChangeLog in packet.

commit 37ab5e554ebe47d88cc987012dcddc59038f6147
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 28 15:38:39 2003 +0000

    Initial revision.

commit c19c79f07308e57f65ab7d7009b721c192abbae6
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 28 15:32:56 2003 +0000

    Fixed self.bind variable having the same name than a method.
    Thanks Python for being so stupidily untyped :)

commit 4415e5a3183a85e378336095564377ec567a934f
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 14 21:26:07 2003 +0000

    Properly support Unicode input.

commit 227c6bd63e676f3e9880f9310714ec3e0d34f71c
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 14 21:01:43 2003 +0000

    Bumped version number.

commit 3a02cd9550a0769747ddac039c38fde45999f972
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Nov 14 21:00:56 2003 +0000

    Properly support Unicode.

commit e58c84a2359197b30ba3d289ecbe09d9e0fb5d04
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 31 21:16:50 2003 +0000

    Bumped version to 0.9.3.

commit 5eafe72c26521b087899ab82771bdcdb160d70de
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 31 21:14:21 2003 +0000

    Fixed offset of handle in SVCCTLRespCreateServiceHeader.

commit 6dc9e592612796254188d8a88d863e511ad8aff5
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 21:05:16 2003 +0000

    Bumped version number to 0.9.2.

commit 45883a7afa48292323ea97da8c20dc9bf1707eee
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 21:03:08 2003 +0000

    Initial revision.

commit 611348de29fe4a3c6f9d2cef10b5c602455860bf
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 21:02:20 2003 +0000

    Fixed output formatting.

commit c273b0e33f6395231d69c8ec91a7ae45e571ce06
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 20:52:12 2003 +0000

    Added missing imports.

commit 26fdc3e16117b1b8d3ab2c3578d35dc49d81cf08
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 19:50:38 2003 +0000

    s/from impact/from impacket/

commit 324fb1078105cf2c2353ae4e9d3a42e61a6a507e
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 19:50:29 2003 +0000

    s/from impact/from impacket/.
    Protected socket.settimeout calls within a try/except block.

commit aab39d6c42dd8881248af555ddf44c7732316152
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 19:30:24 2003 +0000

    Initial revision.

commit 7065ab5979b28c5d1631bae361193f187bcf1637
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Tue Oct 28 18:45:51 2003 +0000

    Added missing imports.

commit 84b82fae4e2c736680630ef0fe9841d7bf29a3f6
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 17:46:46 2003 +0000

    Removed remaining HTML markup.

commit f9882d7bc39547c63ee12714ebe93bfbf72818a1
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 17:46:03 2003 +0000

    Initial revision.

commit cc494bc3d23ab5ce2f86ffe32f27ef3c534ad334
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 17:37:16 2003 +0000

    Bumped version number to 0.9.1.

commit 3402b5675834ee3498be3dd2b8006b5d68923d84
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 17:36:57 2003 +0000

    Changed source license to Apache.

commit 1dba4c20e0d47ec614521e251d072116f75f3ef8
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 27 17:33:42 2003 +0000

    Added Pysmb license.

commit dd89f918ddb0123fcd5262dbc3b1a1c6138cd90e
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 24 20:21:30 2003 +0000

    Added LICENSE.

commit 28aab9a98188adfde10c6642de2c4ea6afee660e
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 24 20:21:14 2003 +0000

    Added README and LICENSE to the binary distribution.

commit 1e1b77896b50062974fb29c68aa3c06b8c3dcdff
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 24 20:20:38 2003 +0000

    Initial revision.

commit c359ea340099a315d6886f06530268282eccfa17
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Fri Oct 24 17:52:06 2003 +0000

    Global rename from conspired to impacket.

commit a9aef3b4d58c5b41baa50b4fd35b68ba08f28677
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 23 19:26:16 2003 +0000

    Updated to reflect very minor changes in the Pcapy API.

commit 330218aa4ce9557a28f35cb4e96d630e4129cc12
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 23 19:25:49 2003 +0000

    Updated contact info.

commit 4ac639ef9ad58abad029f445a3261a8382a298d6
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 20 22:04:52 2003 +0000

    Added documentation.
    Fixed catch of the mysterious PcapError exception.

commit b9bc816237a9de20a64c0119f1ee5c86ad4ab213
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Mon Oct 20 15:49:43 2003 +0000

    Split pcap capture files into smaller ones, one for each TCP connection found in the original.

commit 2d9bee978cb19f79739597b08d4d593700a9e3a8
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 9 17:50:36 2003 +0000

    Include examples and this very file into source distributions.

commit 60b31ed69f794478c4d8ce3b4d63ef0d7d28d3f8
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 9 17:47:05 2003 +0000

    s/disectors/dissectors/

commit 6d01f6287c209bc1e406b0a03c4ff49520cfed9e
Author: jkohen <jkohen@ad9a8d78-5211-11de-8950-a5d9c972bc64>
Date:   Thu Oct 9 17:40:37 2003 +0000

    Initial revision
