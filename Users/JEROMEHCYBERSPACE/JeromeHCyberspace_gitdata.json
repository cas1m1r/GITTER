{
  "logs": [
    "/home/cas1m1r/GITTER/Users/JEROMEHCYBERSPACE/JeromeHCyberspace.git.Webhook-to-Email"
  ],
  "username": "JeromeHCyberspace",
  "repos": {
    "Webhook-to-Email": {
      "commits": [
        "02f02f2dfc38ca87ea7c7aedc266f070ec64ba29",
        "869f1566f37a22bed76e50b14550613e9d08d0d9",
        "deaa2fb67fba0da732ef1a607df8b36dec6f8390",
        "9c2660484305b9ad78335d1a379e65be9a562e44",
        "",
        ""
      ],
      "files": [
        "SANDBOX/Webhook-to-Email",
        "\u251c\u2500\u2500 app.json",
        "\u251c\u2500\u2500 composer.json",
        "\u251c\u2500\u2500 composer.lock",
        "\u251c\u2500\u2500 LICENSE",
        "\u251c\u2500\u2500 post_install.php",
        "\u251c\u2500\u2500 README.md",
        "\u2514\u2500\u2500 webhook.php",
        "",
        "0 directories, 7 files",
        ""
      ],
      "branches": [
        "* master",
        ""
      ],
      "changes": {
        "02f02f2dfc38ca87ea7c7aedc266f070ec64ba29": [
          "commit 02f02f2dfc38ca87ea7c7aedc266f070ec64ba29",
          "Author: JeromeHCyberspace <82894766+JeromeHCyberspace@users.noreply.github.com>",
          "Date:   Wed Mar 23 09:58:06 2022 -0400",
          "",
          "    fix typo",
          "",
          "diff --git a/post_install.php b/post_install.php",
          "index e3e2ec2..3c1f283 100644",
          "--- a/post_install.php",
          "+++ b/post_install.php",
          "@@ -8,8 +8,8 @@ Scroll down, then add your email (same value from before in environment variable",
          " ",
          " Now in game set your Webhook URL to the following value: <span id='webhook_url'></span>",
          " <script>",
          "-document.getElementById('webhook_url').innerHTML = window.location.href.replace('/postinstall.php', '/webhook.php');",
          "+document.getElementById('webhook_url').innerHTML = window.location.href.replace('/post_install.php', '/webhook.php');",
          " </script>",
          " <br><br>",
          " ----------------<br>",
          "-To prevent these webhook notification emails from going to spam, click \"SEND TEST WEBHOOK\" in HCS settings page. Open your spam folder, find the email you just received, and click \"Not Spam\" - and for good measure, consider adding that address to your contact list.",
          "\\ No newline at end of file",
          "+To prevent these webhook notification emails from going to spam, click \"SEND TEST WEBHOOK\" in HCS settings page. Open your spam folder, find the email you just received, and click \"Not Spam\" - and for good measure, consider adding that address to your contact list.",
          ""
        ],
        "869f1566f37a22bed76e50b14550613e9d08d0d9": [
          "commit 869f1566f37a22bed76e50b14550613e9d08d0d9",
          "Author: JeromeHCyberspace <82894766+JeromeHCyberspace@users.noreply.github.com>",
          "Date:   Wed Mar 23 09:57:24 2022 -0400",
          "",
          "    fix typo",
          "",
          "diff --git a/app.json b/app.json",
          "index a925a66..1d47fe8 100644",
          "--- a/app.json",
          "+++ b/app.json",
          "@@ -6,6 +6,6 @@",
          "       \"papertrail\",",
          "       \"mailgun\"",
          "     ],",
          "-    \"success_url\": \"/postinstall.php\"",
          "+    \"success_url\": \"/post_install.php\"",
          "   }",
          "-  ",
          "\\ No newline at end of file",
          "+  ",
          ""
        ],
        "deaa2fb67fba0da732ef1a607df8b36dec6f8390": [
          "commit deaa2fb67fba0da732ef1a607df8b36dec6f8390",
          "Author: JeromeHCyberspace <82894766+JeromeHCyberspace@users.noreply.github.com>",
          "Date:   Wed Mar 23 09:55:15 2022 -0400",
          "",
          "    Init",
          "",
          "diff --git a/README.md b/README.md",
          "new file mode 100644",
          "index 0000000..59b6541",
          "--- /dev/null",
          "+++ b/README.md",
          "@@ -0,0 +1,8 @@",
          "+This app will receive webhooks from HCS and send the contents to you in an email.",
          "+",
          "+Deploy to Heroku using the below button. When prompted to in the deploy process, put in your email address you wish to receive webhook notifications to in the environment variable YOUR_EMAIL.",
          "+",
          "+[![Deploy](https://www.herokucdn.com/deploy/button.png)](https://heroku.com/deploy)",
          "+",
          "+After deploy, follow \"post install\" instructions.",
          "+",
          "diff --git a/app.json b/app.json",
          "new file mode 100644",
          "index 0000000..a925a66",
          "--- /dev/null",
          "+++ b/app.json",
          "@@ -0,0 +1,11 @@",
          "+{",
          "+    \"env\": {",
          "+      \"YOUR_EMAIL\": \"\"",
          "+    },",
          "+    \"addons\": [",
          "+      \"papertrail\",",
          "+      \"mailgun\"",
          "+    ],",
          "+    \"success_url\": \"/postinstall.php\"",
          "+  }",
          "+  ",
          "\\ No newline at end of file",
          "diff --git a/composer.json b/composer.json",
          "new file mode 100644",
          "index 0000000..a9fa86a",
          "--- /dev/null",
          "+++ b/composer.json",
          "@@ -0,0 +1,6 @@",
          "+{",
          "+    \"require\": {",
          "+      \"php\": \"^7.3.8\",",
          "+      \"phpmailer/phpmailer\": \"^6.5\"",
          "+    }",
          "+}",
          "\\ No newline at end of file",
          "diff --git a/composer.lock b/composer.lock",
          "new file mode 100644",
          "index 0000000..12fd847",
          "--- /dev/null",
          "+++ b/composer.lock",
          "@@ -0,0 +1,99 @@",
          "+{",
          "+    \"_readme\": [",
          "+        \"This file locks the dependencies of your project to a known state\",",
          "+        \"Read more about it at https://getcomposer.org/doc/01-basic-usage.md#installing-dependencies\",",
          "+        \"This file is @generated automatically\"",
          "+    ],",
          "+    \"content-hash\": \"9d0ede4800dd16beb401f5a59062e1e0\",",
          "+    \"packages\": [",
          "+        {",
          "+            \"name\": \"phpmailer/phpmailer\",",
          "+            \"version\": \"v6.6.0\",",
          "+            \"source\": {",
          "+                \"type\": \"git\",",
          "+                \"url\": \"https://github.com/PHPMailer/PHPMailer.git\",",
          "+                \"reference\": \"e43bac82edc26ca04b36143a48bde1c051cfd5b1\"",
          "+            },",
          "+            \"dist\": {",
          "+                \"type\": \"zip\",",
          "+                \"url\": \"https://api.github.com/repos/PHPMailer/PHPMailer/zipball/e43bac82edc26ca04b36143a48bde1c051cfd5b1\",",
          "+                \"reference\": \"e43bac82edc26ca04b36143a48bde1c051cfd5b1\",",
          "+                \"shasum\": \"\"",
          "+            },",
          "+            \"require\": {",
          "+                \"ext-ctype\": \"*\",",
          "+                \"ext-filter\": \"*\",",
          "+                \"ext-hash\": \"*\",",
          "+                \"php\": \">=5.5.0\"",
          "+            },",
          "+            \"require-dev\": {",
          "+                \"dealerdirect/phpcodesniffer-composer-installer\": \"^0.7.0\",",
          "+                \"doctrine/annotations\": \"^1.2\",",
          "+                \"php-parallel-lint/php-console-highlighter\": \"^0.5.0\",",
          "+                \"php-parallel-lint/php-parallel-lint\": \"^1.3.1\",",
          "+                \"phpcompatibility/php-compatibility\": \"^9.3.5\",",
          "+                \"roave/security-advisories\": \"dev-latest\",",
          "+                \"squizlabs/php_codesniffer\": \"^3.6.2\",",
          "+                \"yoast/phpunit-polyfills\": \"^1.0.0\"",
          "+            },",
          "+            \"suggest\": {",
          "+                \"ext-mbstring\": \"Needed to send email in multibyte encoding charset or decode encoded addresses\",",
          "+                \"hayageek/oauth2-yahoo\": \"Needed for Yahoo XOAUTH2 authentication\",",
          "+                \"league/oauth2-google\": \"Needed for Google XOAUTH2 authentication\",",
          "+                \"psr/log\": \"For optional PSR-3 debug logging\",",
          "+                \"stevenmaguire/oauth2-microsoft\": \"Needed for Microsoft XOAUTH2 authentication\",",
          "+                \"symfony/polyfill-mbstring\": \"To support UTF-8 if the Mbstring PHP extension is not enabled (^1.2)\"",
          "+            },",
          "+            \"type\": \"library\",",
          "+            \"autoload\": {",
          "+                \"psr-4\": {",
          "+                    \"PHPMailer\\\\PHPMailer\\\\\": \"src/\"",
          "+                }",
          "+            },",
          "+            \"notification-url\": \"https://packagist.org/downloads/\",",
          "+            \"license\": [",
          "+                \"LGPL-2.1-only\"",
          "+            ],",
          "+            \"authors\": [",
          "+                {",
          "+                    \"name\": \"Marcus Bointon\",",
          "+                    \"email\": \"phpmailer@synchromedia.co.uk\"",
          "+                },",
          "+                {",
          "+                    \"name\": \"Jim Jagielski\",",
          "+                    \"email\": \"jimjag@gmail.com\"",
          "+                },",
          "+                {",
          "+                    \"name\": \"Andy Prevost\",",
          "+                    \"email\": \"codeworxtech@users.sourceforge.net\"",
          "+                },",
          "+                {",
          "+                    \"name\": \"Brent R. Matzelle\"",
          "+                }",
          "+            ],",
          "+            \"description\": \"PHPMailer is a full-featured email creation and transfer class for PHP\",",
          "+            \"support\": {",
          "+                \"issues\": \"https://github.com/PHPMailer/PHPMailer/issues\",",
          "+                \"source\": \"https://github.com/PHPMailer/PHPMailer/tree/v6.6.0\"",
          "+            },",
          "+            \"funding\": [",
          "+                {",
          "+                    \"url\": \"https://github.com/Synchro\",",
          "+                    \"type\": \"github\"",
          "+                }",
          "+            ],",
          "+            \"time\": \"2022-02-28T15:31:21+00:00\"",
          "+        }",
          "+    ],",
          "+    \"packages-dev\": [],",
          "+    \"aliases\": [],",
          "+    \"minimum-stability\": \"stable\",",
          "+    \"stability-flags\": [],",
          "+    \"prefer-stable\": false,",
          "+    \"prefer-lowest\": false,",
          "+    \"platform\": {",
          "+        \"php\": \"^7.3.8\"",
          "+    },",
          "+    \"platform-dev\": [],",
          "+    \"plugin-api-version\": \"2.1.0\"",
          "+}",
          "diff --git a/post_install.php b/post_install.php",
          "new file mode 100644",
          "index 0000000..e3e2ec2",
          "--- /dev/null",
          "+++ b/post_install.php",
          "@@ -0,0 +1,15 @@",
          "+Now you need to configure mailgun.<br><br>",
          "+",
          "+In Heroku, click \"Resources\" and then click Mailgun.<br><br>",
          "+",
          "+In Mailgun, click SENDING, then click DOMAINS, then click the sandbox domain they provided you.<br><br>",
          "+",
          "+Scroll down, then add your email (same value from before in environment variable YOUR_EMAIL) to \"Authorized Recipients\". This will send you a verification email that MAY go to spam. Click the link in the verification email.<br><br>",
          "+",
          "+Now in game set your Webhook URL to the following value: <span id='webhook_url'></span>",
          "+<script>",
          "+document.getElementById('webhook_url').innerHTML = window.location.href.replace('/postinstall.php', '/webhook.php');",
          "+</script>",
          "+<br><br>",
          "+----------------<br>",
          "+To prevent these webhook notification emails from going to spam, click \"SEND TEST WEBHOOK\" in HCS settings page. Open your spam folder, find the email you just received, and click \"Not Spam\" - and for good measure, consider adding that address to your contact list.",
          "\\ No newline at end of file",
          "diff --git a/webhook.php b/webhook.php",
          "new file mode 100644",
          "index 0000000..39359d2",
          "--- /dev/null",
          "+++ b/webhook.php",
          "@@ -0,0 +1,46 @@",
          "+<?php",
          "+use PHPMailer\\PHPMailer\\PHPMailer;",
          "+use PHPMailer\\PHPMailer\\SMTP;",
          "+use PHPMailer\\PHPMailer\\Exception;",
          "+if(!isset($_POST['raw_data'])) {",
          "+    //Not receiving a webhook",
          "+    die;",
          "+}",
          "+",
          "+require 'vendor/autoload.php';",
          "+",
          "+$mail = new PHPMailer(true);",
          "+",
          "+try {",
          "+    //Server settings",
          "+    $mail->SMTPDebug = SMTP::DEBUG_SERVER;                      //Enable verbose debug output",
          "+    $mail->isSMTP();                                            //Send using SMTP",
          "+    $mail->Host       = $_ENV['MAILGUN_SMTP_SERVER'];           //Set the SMTP server to send through",
          "+    $mail->SMTPAuth   = true;                                   //Enable SMTP authentication",
          "+    $mail->Username   = $_ENV['MAILGUN_SMTP_LOGIN'];            //SMTP username",
          "+    $mail->Password   = $_ENV['MAILGUN_SMTP_PASSWORD'];         //SMTP password",
          "+    $mail->SMTPSecure = PHPMailer::ENCRYPTION_STARTTLS;            //Enable implicit TLS encryption",
          "+    $mail->Port       = $_ENV['MAILGUN_SMTP_PORT'];             //TCP port to connect to; use 587 if you have set `SMTPSecure = PHPMailer::ENCRYPTION_STARTTLS`",
          "+",
          "+    //Recipients",
          "+    $mail->setFrom('hcs.notifications@'.$_ENV['MAILGUN_DOMAIN'], 'HCS Notifications');",
          "+    $mail->addAddress($_ENV['YOUR_EMAIL']);              ",
          "+",
          "+    //Content",
          "+    $mail->isHTML(true);                                  //Set email format to HTML",
          "+    ",
          "+    $mail->Subject = 'New Event: '.ucwords(str_replace(\"_\",\" \",$_POST['raw_data']['action_type']));",
          "+",
          "+    //HTML email",
          "+    $mail->Body    = $_POST['raw_data']['event_html'];",
          "+",
          "+    //Raw text email, for email clients that don't support HTML",
          "+    $mail->AltBody = strip_tags($_POST['raw_data']['event_html']).\"\\n\\nURL: https://hackcyber.space/events.php?search=\".$_POST['raw_data']['id'];",
          "+",
          "+    $mail->send();",
          "+    error_log('Message has been sent');",
          "+} catch (Exception $e) {",
          "+    error_log(\"Message could not be sent. Mailer Error: {$mail->ErrorInfo}\");",
          "+}",
          "+",
          "+?>",
          "\\ No newline at end of file",
          ""
        ],
        "9c2660484305b9ad78335d1a379e65be9a562e44": [
          "commit 9c2660484305b9ad78335d1a379e65be9a562e44",
          "Author: JeromeHCyberspace <82894766+JeromeHCyberspace@users.noreply.github.com>",
          "Date:   Wed Mar 23 09:54:32 2022 -0400",
          "",
          "    Initial commit",
          "",
          "diff --git a/LICENSE b/LICENSE",
          "new file mode 100644",
          "index 0000000..2f4ba7f",
          "--- /dev/null",
          "+++ b/LICENSE",
          "@@ -0,0 +1,21 @@",
          "+MIT License",
          "+",
          "+Copyright (c) 2022 JeromeHCyberspace",
          "+",
          "+Permission is hereby granted, free of charge, to any person obtaining a copy",
          "+of this software and associated documentation files (the \"Software\"), to deal",
          "+in the Software without restriction, including without limitation the rights",
          "+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell",
          "+copies of the Software, and to permit persons to whom the Software is",
          "+furnished to do so, subject to the following conditions:",
          "+",
          "+The above copyright notice and this permission notice shall be included in all",
          "+copies or substantial portions of the Software.",
          "+",
          "+THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR",
          "+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,",
          "+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE",
          "+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER",
          "+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,",
          "+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE",
          "+SOFTWARE.",
          ""
        ]
      }
    },
    "remote": "https://github.com/JeromeHCyberspace/Webhook-to-Email"
  }
}