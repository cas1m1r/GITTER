======================: FILES :======================
======================: README CONTENT :======================
# Botnet Detection Engine
A Flow-based Botnet Detection Engine; as a Proof-of-Concept application of a Bio-Optimised Machine Learning Models.

## Getting Started

This is a prototype ML-enabled Flow-based Botnet Detection Engine, with Graphical User Interface, ideally positioned at the Network Edge.

Intended to be ran on a gateway-connected (network edge) switch, with port mirroring enabled (SPAN) to allow the detector PC to collect all network flows.

### Dependencies
	- git-lfs
	- python3
		- pandas
		- scikit-learn(version 0.22.1)
		- websocket-client
		- coverage
	- argus-server (server and client)
	- nodejs
	- npm
		- electron
		- ws

These can be installed with the provided setup script.

### Installing

Clone this repository:
```
git clone https://www.github.com/NorthOfNull/BotnetDetectionEngine
```

In the cloned repository, a setup script is provided in order to check for and install the dependencies required for program execution:
```
chmod +x setup.sh
sudo ./setup.sh
```


## Running the Botnet Detection Engine

A simple bash script is provided in order to run the flow collection and processing programs, which will then feed the flow information to the Botnet Detection Engine script:
```
./run.sh
```

### Usage
```
usage: botnet_detection_engine.py [-h] [-g] [-l] [-d] [-r READ]

The Botnet Detection Engine. GUI and logging is enabled by default.

optional arguments:
  -h, --help            show this help message and exit
  -g, --no-gui          Disables GUI.
  -l, --no-log          Disables alert and flow logging to file.
  -d, --debug           Enable verbose debugging output.
  -r READ, --read READ  Read from '.pcap' or Network Flow file.
```

### Testing
Includes black and white box unit testing, with testing coverage reports for internal modules.
```
./test.sh
```

====================== GIT HISTORY: ======================
e4d00e1 HEAD@{0}: clone: from https://github.com/NorthOfNull/BotnetDetectionEngine
commit e4d00e185929fa46d8facc5fcdd07c4dcf31857b
Author: NorthOfNull <58570583+NorthOfNull@users.noreply.github.com>
Date:   Sun Apr 18 20:18:30 2021 +0100

    Update Detector.py

commit 7b87ff907c192d5d9c49115221712661f0fdcbd2
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Sun Jun 7 23:17:44 2020 +0100

    Activity graph x-axis display limit bug fix via recursive function

commit 37115cdf995f8fe7bd39b26479262c4f90964cad
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Thu Jun 4 12:46:51 2020 +0100

    Removed logging output

commit e9c5b8fe0b6bea82a5559f490c197f3742875563
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Wed Jun 3 19:45:31 2020 +0100

    Alert page alert p text fade in on update fix

commit 199461bcc4d464d31860afc3d7e133e03675dd65
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Thu May 28 02:58:26 2020 +0100

    Added detector documentation

commit 499f46ac8d76ac5add3e1eac831360421ea7a8e5
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Thu May 28 02:42:23 2020 +0100

    Cleanup

commit 0fd931aa4483ae95b934d5a838554db81029a64b
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Wed May 27 21:58:29 2020 +0100

    Finished Testing

commit 4ab2b63113e6dc52258b8a737ff9d6ed03cfa30f
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Wed May 27 21:57:32 2020 +0100

    Finished testing and documentation

commit eab0ad93a6b0924f466e48a43aaac9d261f4c3b0
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Wed May 27 08:11:44 2020 +0100

    Comments

commit a0923bd7ee9f60ef653c89b28a001c8de42dacc7
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Wed May 27 08:09:14 2020 +0100

    Testing updates

commit d4e86eb59e52c6a032020bbbc40964ad361deea8
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Wed May 27 05:33:21 2020 +0100

    Updated readme

commit 8c11df2e53cdebf1ddd803e8cedffd4cbb29e769
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Fri May 22 23:26:58 2020 +0100

    Updated readme

commit 7d648a3143ce966b972907178f087fd4c6f31631
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Fri May 22 23:16:45 2020 +0100

    Updated readme and setup script

commit 996fcb19c5c9851786f3df460c2e4f7411327134
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Fri May 22 23:03:02 2020 +0100

    Added models

commit ceb6355ed2b2e40203855bcc48a0d5b4bce61612
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Fri May 22 23:00:43 2020 +0100

    Updated

commit 6d11e09a3d92fdfee7883c3c6ad84233f4941a88
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Fri May 22 22:58:41 2020 +0100

    Removed Models

commit 6adf01d6d8ab4b626db21741e3663c4cf48c0337
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Fri May 22 22:56:39 2020 +0100

    Updated gitattributes

commit bc64f6d19bba7c33b30f7c323681dbb8eedca864
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Fri May 22 21:50:57 2020 +0100

    Removed unused models

commit 46640a48f34852581cf51b62789cd7c4709bc518
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Fri May 22 21:44:08 2020 +0100

    Updated setup script

commit c6704cd9e78d213c26b1f2823ab1e343ba076d62
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Mon May 18 02:52:06 2020 +0100

    Added activity graph functionality & testing & cleanup of other functionality

commit ae7750787092b7953e6c15ec7f0cc2dc36ea7c09
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Mon May 11 23:12:17 2020 +0100

    Updated docstrings

commit 0e70459689886dbea7a21fcd5e460ddfc345ec97
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Sun May 10 01:37:18 2020 +0100

    GUI Updates and cleanup

commit f7a908052be895fb663375c0826beb3f5505d1e2
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Tue May 5 22:21:45 2020 +0100

    Cleanup

commit 94de6c8057a2baed26cd8cdcdb6c2bc519a6d195
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Tue May 5 22:16:47 2020 +0100

    Cleanup

commit b2b99714aac54bd7842bd0fa50d25bf8626ac622
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Tue May 5 22:14:45 2020 +0100

    Updated package.json

commit 39b9f1a27ac52ac17159be16c84b7370ac541e7b
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Tue May 5 20:34:09 2020 +0100

    Unittestig refactoring and cleanup

commit ee2c348e22002132869351bf596430036662ce34
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Mon May 4 22:44:09 2020 +0100

    Added testing_alerts.binetflow

commit 993baffae8041021124546bcfd6b778592aafec7
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Mon May 4 22:29:01 2020 +0100

    Updated setup script

commit 1479bdc3a1c0eafb5792fdbda707d5471292aef2
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Mon May 4 22:12:55 2020 +0100

    Updated .gitignore

commit 846ebab168e387ca4f2c0c7c8f2a40f36447c40a
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Mon May 4 22:10:57 2020 +0100

    Unit testing updates

commit 57a22db70a60c99abe081a6f4bc6b00170c9b91a
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Mon May 4 22:07:10 2020 +0100

    Added models and unit tests

commit cd60e35ec9eb6f58c73236778384b064e2d14687
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Mon May 4 22:03:23 2020 +0100

    Added models

commit 3cba7c0a7fb43dbe723e6becf9f29a2422aba687
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Thu Apr 23 22:51:16 2020 +0100

    Cleanup

commit 4d0b9d872fbeebc5e5ffcce8d78d1953b133ac1a
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Thu Apr 23 22:49:54 2020 +0100

    Subprocess group killing fixed

commit da39e3075439907c2cacf6c1464c53632fde17e2
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Thu Apr 23 22:47:58 2020 +0100

    Cleanup

commit 7890375802445b930f740ece6ddda5e1300c5d47
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Thu Apr 23 22:47:16 2020 +0100

    Change to ensure that they GUI does not start when reading in a file

commit 0a672ac6b9ba13a63800acc99c78723a2369bbbc
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Thu Apr 16 01:14:29 2020 +0100

    Cleanup

commit 5be5d732c34bd6e5bf31173a42b755583f56d1da
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Thu Apr 16 01:11:50 2020 +0100

    Updated gitignore

commit 457080629e8fc128eb5752fdd19b7088a0c38421
Merge: 4aeff99 2377bd0
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Thu Apr 16 01:08:02 2020 +0100

    Merge branch 'master' of https://www.github.com/NorthOfNull/BotnetDetectionEngine

commit 4aeff998b97c08d120cc88416f589a00fb061680
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Thu Apr 16 01:04:31 2020 +0100

    Init testing

commit fd7a1c001ec83335b5666e74ff6c6b78a8aaf5a3
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Thu Apr 16 01:04:01 2020 +0100

    Updated nodejs electron dependencies

commit 190f14a8fabd4f11695895ac1b068fa8c1f1dc0f
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Thu Apr 16 01:03:13 2020 +0100

    Run script refactoring

commit 104a24bfaf046c58f1c471c77e9c3221c3e38dec
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Thu Apr 16 01:02:39 2020 +0100

    Fixed reconnect func

commit b38a6b62261fcdf251958a3666c39427b58d4218
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Thu Apr 16 01:01:38 2020 +0100

    Added model prediction function

commit b2f8d535951b1d67395c7ac29e8cb0e6bc674ae4
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Thu Apr 16 01:01:06 2020 +0100

    Fixed variable names

commit 246e08c1dd95154d1450a260e26a9c50bd5499e8
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Thu Apr 16 01:00:38 2020 +0100

    Added flow feature extraction and prediction capability

commit 7416b56fb8cc1c707c47b0c53c64008d057c9d02
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Thu Apr 16 00:58:23 2020 +0100

    Added sleep delay to account for electron opening delays

commit 8f7c27a825119df6cd09a86739610c78b6c7cfa4
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Wed Apr 15 21:11:39 2020 +0100

    Subprocess killing changed back to normal behaviour (without os.killpg)

commit 7a6e4892cc5789f962516d610ba2efb22b2ca230
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Wed Apr 15 20:57:13 2020 +0100

    Todo comments added to flow_feature_exclusion

commit cf76a03c8ee868a6e4d153ed39c4ddd9002a3582
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Wed Apr 15 20:51:36 2020 +0100

    Fixed string decode operation

commit 2377bd09bf12e455ae9cc21ac40114732aab1393
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Wed Apr 15 11:57:11 2020 +0100

    Unittesting test

commit e907d86f410c88ff38139a75de34f03a288bdee6
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Tue Apr 14 01:06:51 2020 +0100

    Argparse option cleanup

commit 8b4b4e2682c070467a16162467b1ebfe4e06540c
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Tue Apr 14 01:05:19 2020 +0100

    Updated README.md

commit 5d7833bdbcd84a504b81d619525e475ebbf1af47
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Tue Apr 14 00:53:56 2020 +0100

    Added process_flow function to allow flows to be correctly formatted, ready for prediciton by the models

commit 3e5df9fd7d5a6e26a14bb2173a8c98c1810a568c
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Tue Apr 14 00:52:30 2020 +0100

    Refactored subprocess handling; added support for reading and processing .pcap data or just reading from network flow csv files

commit 73f5831ef8a5def80c21f9e5db4ced4d24c99bda
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Tue Apr 14 00:50:51 2020 +0100

    Updated model loading behaviour to correctly report loading_status to the Detector

commit 84717baf401806b7dbe09dfa0f68bbf9846e6582
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Tue Apr 14 00:49:14 2020 +0100

    Argparse update; added new argument options (debug and read file)

commit c4047bd7467aa96c2f7ca9fe56cb9ad44a669b6e
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Tue Apr 14 00:22:14 2020 +0100

    Command line argument restructure

commit dfc117c365df02ab6a30c456c1a20c32e6918c36
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Mon Apr 13 19:37:37 2020 +0100

    Websocket Client rename

commit cc9751e46c5dc3beb19c225bef965fb341144b7c
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Thu Apr 9 21:18:50 2020 +0100

    Updated README

commit 5e49ac8c95816c481d3b087a928ba8d821a430fd
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Thu Apr 9 21:14:38 2020 +0100

    Finished architecture restructure

commit fb919cd63af43a5639a2a3effdb6e1e70e6e1dd6
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Wed Apr 1 06:30:35 2020 +0100

    Script extension correction

commit c29dbad23b4166d80687d883dfa7a54069bf435f
Author: NorthOfNull <58570583+NorthOfNull@users.noreply.github.com>
Date:   Wed Apr 1 06:28:58 2020 +0100

    Update README.md

commit 2baa51b3f143c967ede0622ba0c5e4bf3613388d
Author: NorthOfNull <58570583+NorthOfNull@users.noreply.github.com>
Date:   Wed Apr 1 06:28:33 2020 +0100

    Update README.md

commit 6ac265e9450865678b1b766c80f1ecf4df5574e3
Author: NorthOfNull <58570583+NorthOfNull@users.noreply.github.com>
Date:   Wed Apr 1 06:28:10 2020 +0100

    Update README.md

commit 1ee976e62d92697b3af9d398f7e7cc50e834abcf
Author: NorthOfNull <58570583+NorthOfNull@users.noreply.github.com>
Date:   Wed Apr 1 06:27:31 2020 +0100

    Update readme.md

commit 89435da9729cad86d0d8ee6f3ff255c68ec17805
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Wed Apr 1 06:26:08 2020 +0100

    Added inital alert logging to file functionality

commit 36cf0dd38a804e385678b08138fcb4244ac1b0db
Author: NorthOfNull <58570583+NorthOfNull@users.noreply.github.com>
Date:   Mon Mar 16 17:49:34 2020 +0000

    Update README.md

commit 6fec3097b08e06bb9746949cf2371e7b5920686f
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Mon Mar 16 17:48:07 2020 +0000

    Updated 'run.sh' script with cmd line arg handling and Updated 'README.md'

commit 79d7ad05c5fce92835ceb11061468b550b940904
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Sun Mar 15 20:47:54 2020 +0000

    Initial Command Line Argument support added

commit cbe7d2163b1c8d7b33db7846ddb60c3eb3d080c2
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Fri Mar 13 00:46:58 2020 +0000

    Sniffer updates, main electron process and renderer updates and testing for the inter-class communication

commit 23ac20b001606e1d0f42cc4a4e90837f4dd46bf8
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Sun Feb 16 13:06:46 2020 +0000

    Added netflow sniffer module

commit c07defc34aa7bfbc7579fed2bc1dd9f5bc5baa8d
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Fri Feb 14 02:12:20 2020 +0000

    TODO - Inital page rendering ipc api requests

commit a9ba22336599740dceeb1f33b5d3b52e7befd407
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Fri Feb 14 02:02:40 2020 +0000

    Module refactoring and data controller integration testing

commit 77d3505136fa701f097478698d39f79fd9cf66cc
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Sat Feb 1 20:26:42 2020 +0000

    Websocket implementation from detection engine to electron renderer

commit c5a0f0478fb319bff5d274979e407726f3841b10
Author: NorthOfNull <kyle.fryer71@gmail.com>
Date:   Fri Jan 24 18:34:58 2020 +0000

    Packet sniffing pipeline setup for processing in the python script

commit 7400f40e294a064cb97593516097ba6d2abea4e8
Author: NorthOfNull <58570583+NorthOfNull@users.noreply.github.com>
Date:   Wed Jan 15 12:10:53 2020 +0000

    Update README.md

commit 84b995342fe409c067c40787f88cbfee5afa0a75
Author: NorthOfNull <58570583+NorthOfNull@users.noreply.github.com>
Date:   Wed Jan 15 12:09:41 2020 +0000

    Update README.md

commit c1ece89bd1bebdecb3573794c91717eaa1ac3b3c
Author: NorthOfNull <58570583+NorthOfNull@users.noreply.github.com>
Date:   Wed Jan 15 12:07:45 2020 +0000

    Update README.md

commit b40793d4657beb7f5771deb5e8d5cf53418213a7
Author: NorthOfNull <58570583+NorthOfNull@users.noreply.github.com>
Date:   Wed Jan 15 12:07:16 2020 +0000

    Initial README.md Draft

commit 52c53424da8fddf690967ea2a6afcb0e143ceab8
Author: NorthOfNull <58570583+NorthOfNull@users.noreply.github.com>
Date:   Wed Jan 15 11:56:19 2020 +0000

    Initial commit
